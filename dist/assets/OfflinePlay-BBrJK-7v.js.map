{"version":3,"file":"OfflinePlay-BBrJK-7v.js","sources":["../../src/game/types.ts","../../src/game/aroundTheClock.ts","../../src/game/cricket.ts","../../src/game/shanghai.ts","../../src/game/halveIt.ts","../../src/game/highLow.ts","../../src/game/killer.ts","../../src/game/baseball.ts","../../src/game/golf.ts","../../src/game/ticTacToe.ts","../../src/game/scamFivesSevens.ts","../../src/game/americanCricket.ts","../../src/components/ui/GameHeaderBar.tsx","../../src/components/matchControlAdapters.ts","../../src/logic/matchActions.ts","../../src/components/OfflinePlay.tsx"],"sourcesContent":["export type DartMult = \"S\" | \"D\" | \"T\";\nexport type Dart = { mult: DartMult; num: number } | { bull: 25 | 50 };\n\nexport type DoublePracticeState = {\n  targetIndex: number; // 0..20 for D1..D20 then 21 for DBULL\n  completed: boolean;\n};\n\nexport const DOUBLE_PRACTICE_TARGETS: Array<{\n  label: string;\n  score: number;\n  isBull?: boolean;\n}>[] = [] as any;\n\nexport const DOUBLE_PRACTICE_ORDER: {\n  label: string;\n  score: number;\n  isBull?: boolean;\n}[] = [\n  ...Array.from({ length: 20 }, (_, i) => ({\n    label: `D${i + 1}`,\n    score: (i + 1) * 2,\n  })),\n  { label: \"DBULL\", score: 50, isBull: true },\n];\n\nexport function isDoubleHit(value: number, targetIdx: number): boolean {\n  const t = DOUBLE_PRACTICE_ORDER[targetIdx];\n  return !!t && value === t.score;\n}\n\nexport function parseManualDart(input: string): number | null {\n  const t = input.trim().toUpperCase();\n  if (!t) return null;\n  if (t === \"50\" || t === \"BULL\" || t === \"DBULL\" || t === \"IBULL\") return 50;\n  if (t === \"25\" || t === \"OBULL\") return 25;\n  const m = t.match(/^(S|D|T)?\\s*(\\d{1,2})$/);\n  if (!m) return null;\n  const mult = (m[1] || \"S\") as \"S\" | \"D\" | \"T\";\n  const num = parseInt(m[2], 10);\n  if (num < 1 || num > 20) return null;\n  const multVal = mult === \"S\" ? 1 : mult === \"D\" ? 2 : 3;\n  return num * multVal;\n}\n\n// Parse a detailed dart string like \"T20\", \"D16\", \"S5\", \"25\", \"50\", \"BULL\", returning a structured Dart.\nexport function parseDartDetailed(input: string): Dart | null {\n  const t = input.trim().toUpperCase();\n  if (!t) return null;\n  if (\n    t === \"50\" ||\n    t === \"BULL\" ||\n    t === \"DBULL\" ||\n    t === \"IBULL\" ||\n    t === \"INNER BULL\" ||\n    t === \"INNER_BULL\"\n  )\n    return { bull: 50 };\n  if (t === \"25\" || t === \"OBULL\" || t === \"OUTER BULL\" || t === \"BULL25\")\n    return { bull: 25 };\n  const m = t.match(/^(S|D|T)?\\s*(\\d{1,2})$/);\n  if (!m) return null;\n  const mult = (m[1] || \"S\") as DartMult;\n  const num = parseInt(m[2], 10);\n  if (num < 1 || num > 20) return null;\n  return { mult, num };\n}\n\n// Convert autoscore ring+sector data into a structured Dart\n// ring: 'MISS'|'SINGLE'|'DOUBLE'|'TRIPLE'|'BULL'|'INNER_BULL'\n// sector: 1..20 for numbered segments; null/undefined for bull/miss\nexport function ringSectorToDart(\n  ring?: string,\n  sector?: number | null,\n): Dart | null {\n  if (!ring || ring === \"MISS\") return null;\n  if (ring === \"BULL\") return { bull: 25 };\n  if (ring === \"INNER_BULL\") return { bull: 50 };\n  if (typeof sector === \"number\" && sector >= 1 && sector <= 20) {\n    const mult: DartMult =\n      ring === \"DOUBLE\" ? \"D\" : ring === \"TRIPLE\" ? \"T\" : \"S\";\n    return { mult, num: sector };\n  }\n  return null;\n}\n","export type ATCState = {\n  target: number; // 1..20 then 25 (outer bull) then 50 (inner)\n  finished: boolean;\n};\n\nexport const ATC_ORDER: number[] = [\n  ...Array.from({ length: 20 }, (_, i) => i + 1),\n  25,\n  50,\n];\n\nexport function nextTarget(current: number): number | null {\n  const idx = ATC_ORDER.indexOf(current);\n  if (idx < 0) return ATC_ORDER[0];\n  if (idx >= ATC_ORDER.length - 1) return null;\n  return ATC_ORDER[idx + 1];\n}\n\nexport function isCorrectHit(value: number, target: number): boolean {\n  return value === target;\n}\n","export type CricketMark = 0 | 1 | 2 | 3;\nexport type CricketNumber = 15 | 16 | 17 | 18 | 19 | 20 | 25; // 25 is bull (outer+inner)\n\nexport type CricketState = {\n  // marks per number\n  marks: Record<CricketNumber, CricketMark>;\n  // accumulated points when opponent hasn't closed a number\n  points: number;\n};\n\nexport const CRICKET_NUMBERS: CricketNumber[] = [20, 19, 18, 17, 16, 15, 25];\n\nexport function createCricketState(): CricketState {\n  const marks: any = {};\n  CRICKET_NUMBERS.forEach((n) => {\n    marks[n] = 0;\n  });\n  return { marks, points: 0 };\n}\n\n// Apply a single dart to a player's cricket state\n// Returns deltaPoints scored on this dart\nexport function applyCricketDart(\n  state: CricketState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n  opponentClosed: (n: CricketNumber) => boolean = () => false,\n): number {\n  // Map autoscore terms to logical hits\n  let num: CricketNumber | null = null;\n  let hits = 0;\n  if (\n    ring === \"BULL\" ||\n    ring === \"INNER_BULL\" ||\n    value === 25 ||\n    value === 50\n  ) {\n    num = 25;\n    hits = ring === \"INNER_BULL\" || value === 50 ? 2 : 1;\n  } else if (\n    typeof sector === \"number\" &&\n    (sector as number) >= 15 &&\n    (sector as number) <= 20\n  ) {\n    num = sector as CricketNumber;\n    if (ring === \"TRIPLE\") hits = 3;\n    else if (ring === \"DOUBLE\") hits = 2;\n    else hits = 1;\n  } else if (value) {\n    // Fallback when only numeric score provided (manual): infer by divisibility\n    const cand: CricketNumber[] = [20, 19, 18, 17, 16, 15];\n    for (const c of cand) {\n      if (value === c) {\n        num = c;\n        hits = 1;\n        break;\n      }\n      if (value === c * 2) {\n        num = c;\n        hits = 2;\n        break;\n      }\n      if (value === c * 3) {\n        num = c;\n        hits = 3;\n        break;\n      }\n    }\n    if (!num && (value === 25 || value === 50)) {\n      num = 25;\n      hits = value === 50 ? 2 : 1;\n    }\n  }\n  if (!num) return 0;\n\n  const before = state.marks[num];\n  const remainToClose = Math.max(0, 3 - before);\n  const toApply = Math.min(remainToClose, hits);\n  const overflow = Math.max(0, hits - toApply);\n  // Increase marks up to 3\n  const after = (before + toApply) as CricketMark;\n  state.marks[num] = after > 3 ? 3 : after;\n\n  // Overflow counts as points only if opponent hasn't closed this number and number is not bull (bull scores too per standard rules when opponent open)\n  let points = 0;\n  if (overflow > 0 && !opponentClosed(num)) {\n    if (num === 25) {\n      // Overflow on bull: each extra hit beyond 3 adds 25 or 50 depending on which ring hit overflowed; approximate as 25 per hit except inner counts double. We don't know exact ring for overflow; assume 25 per extra except when ring provided as INNER_BULL and overflow>0.\n      if (ring === \"INNER_BULL\") points += 50 * overflow;\n      else points += 25 * overflow;\n    } else {\n      points += num * overflow;\n    }\n  }\n\n  state.points += points;\n  return points;\n}\n\nexport function hasClosedAll(state: CricketState): boolean {\n  return CRICKET_NUMBERS.every((n) => (state.marks[n] || 0) >= 3);\n}\n\nexport function cricketWinner(\n  self: CricketState,\n  opponents: CricketState[],\n): boolean {\n  // Win when all closed and you have >= opponents' points\n  if (!hasClosedAll(self)) return false;\n  const maxOppPoints = Math.max(0, ...opponents.map((o) => o.points));\n  return self.points >= maxOppPoints;\n}\n","export type ShanghaiRound =\n  | 1\n  | 2\n  | 3\n  | 4\n  | 5\n  | 6\n  | 7\n  | 8\n  | 9\n  | 10\n  | 11\n  | 12\n  | 13\n  | 14\n  | 15\n  | 16\n  | 17\n  | 18\n  | 19\n  | 20;\n\nexport type ShanghaiState = {\n  round: ShanghaiRound;\n  score: number;\n  finished: boolean;\n  shanghaiAchieved: boolean; // single+double+triple of target in same 3-dart turn\n  turnHits: { singles: number; doubles: number; triples: number };\n};\n\nexport function createShanghaiState(): ShanghaiState {\n  return {\n    round: 1,\n    score: 0,\n    finished: false,\n    shanghaiAchieved: false,\n    turnHits: { singles: 0, doubles: 0, triples: 0 },\n  };\n}\n\nexport function getRoundTarget(state: ShanghaiState): number {\n  return state.round;\n}\n\n// Apply one dart; returns points scored on this dart\nexport function applyShanghaiDart(\n  state: ShanghaiState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n): number {\n  if (state.finished) return 0;\n  const target = getRoundTarget(state);\n  let points = 0;\n  if (typeof sector === \"number\" && sector === target) {\n    if (ring === \"TRIPLE\") {\n      points = target * 3;\n      state.turnHits.triples++;\n    } else if (ring === \"DOUBLE\") {\n      points = target * 2;\n      state.turnHits.doubles++;\n    } else if (ring === \"SINGLE\") {\n      points = target * 1;\n      state.turnHits.singles++;\n    }\n  } else if (\n    !sector &&\n    (value === target || value === target * 2 || value === target * 3)\n  ) {\n    // manual numeric entry fallback\n    if (value === target * 3) {\n      points = target * 3;\n      state.turnHits.triples++;\n    } else if (value === target * 2) {\n      points = target * 2;\n      state.turnHits.doubles++;\n    } else if (value === target) {\n      points = target;\n      state.turnHits.singles++;\n    }\n  }\n  state.score += points;\n  return points;\n}\n\n// Call at end of 3-dart turn; advances round and checks Shanghai\nexport function endShanghaiTurn(state: ShanghaiState) {\n  if (!state.finished) {\n    if (\n      state.turnHits.singles > 0 &&\n      state.turnHits.doubles > 0 &&\n      state.turnHits.triples > 0\n    ) {\n      state.shanghaiAchieved = true;\n      state.finished = true;\n      return;\n    }\n    const next = (state.round + 1) as ShanghaiRound;\n    if (next > 20) {\n      state.finished = true;\n    } else {\n      state.round = next;\n    }\n  }\n  // reset per-turn hits\n  state.turnHits = { singles: 0, doubles: 0, triples: 0 };\n}\n","export type HalveItTarget =\n  | { kind: \"ANY_NUMBER\" }\n  | { kind: \"DOUBLE\"; num: number }\n  | { kind: \"TRIPLE\"; num: number }\n  | { kind: \"BULL\" }\n  | { kind: \"NUMBER\"; num: number };\n\nexport type HalveItState = {\n  stage: number;\n  targets: HalveItTarget[];\n  score: number;\n  finished: boolean;\n  hitThisRound: boolean;\n};\n\nexport function createDefaultHalveIt(): HalveItState {\n  const targets: HalveItTarget[] = [\n    { kind: \"NUMBER\", num: 20 },\n    { kind: \"DOUBLE\", num: 16 },\n    { kind: \"TRIPLE\", num: 14 },\n    { kind: \"NUMBER\", num: 19 },\n    { kind: \"BULL\" },\n    { kind: \"ANY_NUMBER\" },\n  ];\n  return { stage: 0, targets, score: 0, finished: false, hitThisRound: false };\n}\n\nexport function getCurrentHalveTarget(\n  state: HalveItState,\n): HalveItTarget | null {\n  return state.targets[state.stage] || null;\n}\n\nexport function applyHalveItDart(\n  state: HalveItState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n): number {\n  if (state.finished) return 0;\n  const t = getCurrentHalveTarget(state);\n  if (!t) return 0;\n  let scored = 0;\n  switch (t.kind) {\n    case \"NUMBER\": {\n      if (typeof sector === \"number\" && sector === t.num) {\n        if (ring === \"TRIPLE\") scored = t.num * 3;\n        else if (ring === \"DOUBLE\") scored = t.num * 2;\n        else if (ring === \"SINGLE\") scored = t.num;\n      } else if (\n        !sector &&\n        (value === t.num || value === t.num * 2 || value === t.num * 3)\n      ) {\n        scored = value;\n      }\n      if (scored > 0) state.hitThisRound = true;\n      break;\n    }\n    case \"DOUBLE\": {\n      if ((ring === \"DOUBLE\" && sector === t.num) || value === t.num * 2) {\n        scored = t.num * 2;\n        state.hitThisRound = true;\n      }\n      break;\n    }\n    case \"TRIPLE\": {\n      if ((ring === \"TRIPLE\" && sector === t.num) || value === t.num * 3) {\n        scored = t.num * 3;\n        state.hitThisRound = true;\n      }\n      break;\n    }\n    case \"BULL\": {\n      if (\n        ring === \"BULL\" ||\n        ring === \"INNER_BULL\" ||\n        value === 25 ||\n        value === 50\n      ) {\n        scored = ring === \"INNER_BULL\" || value === 50 ? 50 : 25;\n        state.hitThisRound = true;\n      }\n      break;\n    }\n    case \"ANY_NUMBER\": {\n      // any valid score counts\n      if (value > 0) {\n        scored = value;\n        state.hitThisRound = true;\n      }\n      break;\n    }\n  }\n  state.score += scored;\n  return scored;\n}\n\nexport function endHalveItTurn(state: HalveItState) {\n  if (state.finished) return;\n  if (!state.hitThisRound) {\n    state.score = Math.floor(state.score / 2);\n  }\n  state.hitThisRound = false;\n  state.stage += 1;\n  if (state.stage >= state.targets.length) state.finished = true;\n}\n","export type HighLowState = {\n  round: number;\n  score: number;\n  target: \"HIGH\" | \"LOW\";\n  finished: boolean;\n};\n\nexport function createHighLow(): HighLowState {\n  return { round: 1, score: 0, target: \"HIGH\", finished: false };\n}\n\nexport function applyHighLowDart(\n  state: HighLowState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n): number {\n  if (state.finished) return 0;\n  // For simplicity: when target is HIGH, count only scores >= 20 (any ring) and bull as 50\n  // When LOW, count only scores <= 10 (any ring) and bull does not count\n  let scored = 0;\n  if (state.target === \"HIGH\") {\n    if (ring === \"INNER_BULL\") scored = 50;\n    else if (typeof sector === \"number\") {\n      const mult = ring === \"TRIPLE\" ? 3 : ring === \"DOUBLE\" ? 2 : 1;\n      const v = sector * mult;\n      if (sector >= 20) scored = v;\n    } else {\n      // manual numeric fallback\n      if (value >= 40) scored = value;\n    }\n  } else {\n    if (typeof sector === \"number\") {\n      const mult = ring === \"TRIPLE\" ? 3 : ring === \"DOUBLE\" ? 2 : 1;\n      const v = sector * mult;\n      if (sector <= 10) scored = v;\n    } else {\n      if (value > 0 && value <= 30) scored = value;\n    }\n  }\n  state.score += scored;\n  return scored;\n}\n\nexport function endHighLowTurn(state: HighLowState) {\n  if (state.finished) return;\n  state.round += 1;\n  if (state.round > 10) {\n    state.finished = true;\n    return;\n  }\n  state.target = state.target === \"HIGH\" ? \"LOW\" : \"HIGH\";\n}\n","export type KillerState = {\n  number: number; // assigned sector 1..20\n  lives: number; // start with 3\n  isKiller: boolean; // became killer by hitting own double\n  eliminated: boolean;\n};\n\nexport function createKillerState(assigned: number, lives = 3): KillerState {\n  return { number: assigned, lives, isKiller: false, eliminated: false };\n}\n\n// Assign unique random numbers (1..20) to each player id\nexport function assignKillerNumbers<T extends string>(\n  playerIds: T[],\n): Record<T, number> {\n  const pool = Array.from({ length: 20 }, (_, i) => i + 1);\n  const res: any = {};\n  for (const id of playerIds) {\n    // pick a random remaining number\n    const idx = Math.floor(Math.random() * pool.length);\n    const num = pool.splice(idx, 1)[0];\n    res[id] = num;\n  }\n  return res;\n}\n\n// Apply a single dart in Killer context.\n// Returns an object describing outcomes: becameKiller, victimId (if hit), livesRemoved\nexport function applyKillerDart(\n  selfId: string,\n  states: Record<string, KillerState>,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n): { becameKiller: boolean; victimId?: string; livesRemoved?: number } {\n  const me = states[selfId];\n  if (!me || !sector || !ring) return { becameKiller: false };\n  // Becoming killer: hit your own DOUBLE only\n  if (!me.isKiller && ring === \"DOUBLE\" && sector === me.number) {\n    me.isKiller = true;\n    return { becameKiller: true };\n  }\n  // Self-hit penalty: killer hitting own double loses a life\n  if (me.isKiller && ring === \"DOUBLE\" && sector === me.number) {\n    me.lives = Math.max(0, me.lives - 1);\n    if (me.lives === 0) me.eliminated = true;\n    return { becameKiller: false, victimId: selfId, livesRemoved: 1 };\n  }\n  // If already killer, hitting opponents' doubles/triples removes lives\n  if (me.isKiller && (ring === \"DOUBLE\" || ring === \"TRIPLE\")) {\n    const victimId = Object.keys(states).find(\n      (pid) =>\n        pid !== selfId &&\n        !states[pid].eliminated &&\n        states[pid].number === sector,\n    );\n    if (victimId) {\n      const victim = states[victimId];\n      const delta = ring === \"TRIPLE\" ? 2 : 1;\n      victim.lives = Math.max(0, victim.lives - delta);\n      if (victim.lives === 0) victim.eliminated = true;\n      return { becameKiller: false, victimId, livesRemoved: delta };\n    }\n  }\n  return { becameKiller: false };\n}\n\nexport function killerWinner(\n  states: Record<string, KillerState>,\n): string | null {\n  const alive = Object.entries(states).filter(\n    ([, st]) => !st.eliminated && st.lives > 0,\n  );\n  if (alive.length === 1) return alive[0][0];\n  return null;\n}\n","export type BaseballInning = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\n\nexport type BaseballState = {\n  inning: BaseballInning;\n  score: number;\n  dartsThisInning: number;\n  finished: boolean;\n};\n\nexport function createBaseball(): BaseballState {\n  return { inning: 1, score: 0, dartsThisInning: 0, finished: false };\n}\n\n// Each inning, only the inning number scores; hits count 1, double 2, triple 3 runs (no bull scoring)\nexport function applyBaseballDart(\n  state: BaseballState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\",\n  sector?: number | null,\n): number {\n  if (state.finished) return 0;\n  let runs = 0;\n  if (typeof sector === \"number\" && sector === state.inning) {\n    if (ring === \"TRIPLE\") runs = 3;\n    else if (ring === \"DOUBLE\") runs = 2;\n    else runs = 1;\n  } else if (\n    !sector &&\n    (value === state.inning ||\n      value === state.inning * 2 ||\n      value === state.inning * 3)\n  ) {\n    runs = value === state.inning * 3 ? 3 : value === state.inning * 2 ? 2 : 1;\n  }\n  state.score += runs;\n  state.dartsThisInning += 1;\n  if (state.dartsThisInning >= 3) {\n    const next = (state.inning + 1) as BaseballInning;\n    if (next > 9) state.finished = true;\n    else {\n      state.inning = next;\n      state.dartsThisInning = 0;\n    }\n  }\n  return runs;\n}\n","export type GolfHole =\n  | 1\n  | 2\n  | 3\n  | 4\n  | 5\n  | 6\n  | 7\n  | 8\n  | 9\n  | 10\n  | 11\n  | 12\n  | 13\n  | 14\n  | 15\n  | 16\n  | 17\n  | 18;\n\n// Simple darts golf: each hole targets a predefined number (map); par is 2 throws; score is number of darts used to hit the target ring.\n// For simplicity, we count a hole complete on first valid hit (single/double/triple of the target), score increments by darts used.\n\nexport const GOLF_TARGETS: Record<GolfHole, number> = {\n  1: 5,\n  2: 20,\n  3: 1,\n  4: 18,\n  5: 4,\n  6: 13,\n  7: 6,\n  8: 10,\n  9: 15,\n  10: 2,\n  11: 17,\n  12: 3,\n  13: 19,\n  14: 7,\n  15: 16,\n  16: 8,\n  17: 11,\n  18: 14,\n};\n\nexport type GolfState = {\n  hole: GolfHole;\n  strokes: number;\n  dartsThisHole: number;\n  finished: boolean;\n};\n\nexport function createGolf(): GolfState {\n  return { hole: 1, strokes: 0, dartsThisHole: 0, finished: false };\n}\n\nexport function applyGolfDart(\n  state: GolfState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\",\n  sector?: number | null,\n): boolean {\n  if (state.finished) return false;\n  const target = GOLF_TARGETS[state.hole];\n  state.dartsThisHole += 1;\n  const hit =\n    (typeof sector === \"number\" &&\n      sector === target &&\n      (ring === \"SINGLE\" || ring === \"DOUBLE\" || ring === \"TRIPLE\")) ||\n    (!sector &&\n      (value === target || value === target * 2 || value === target * 3));\n  if (hit) {\n    state.strokes += state.dartsThisHole;\n    // advance to next hole\n    const next = (state.hole + 1) as GolfHole;\n    if (next > 18) state.finished = true;\n    else {\n      state.hole = next;\n      state.dartsThisHole = 0;\n    }\n    return true;\n  }\n  // If not finished and took 3 darts, score 3 and advance hole\n  if (state.dartsThisHole >= 3) {\n    state.strokes += 3;\n    const next = (state.hole + 1) as GolfHole;\n    if (next > 18) state.finished = true;\n    else {\n      state.hole = next;\n      state.dartsThisHole = 0;\n    }\n  }\n  return false;\n}\n","export type TicCell = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8;\n\n// Map grid cells to targets: center uses Bull; edges/corners use numbers.\nexport const TTT_TARGETS: Record<\n  TicCell,\n  { type: \"NUM\" | \"BULL\"; num?: number }\n> = {\n  0: { type: \"NUM\", num: 20 },\n  1: { type: \"NUM\", num: 19 },\n  2: { type: \"NUM\", num: 18 },\n  3: { type: \"NUM\", num: 17 },\n  4: { type: \"BULL\" },\n  5: { type: \"NUM\", num: 16 },\n  6: { type: \"NUM\", num: 15 },\n  7: { type: \"NUM\", num: 14 },\n  8: { type: \"NUM\", num: 13 },\n};\n\nexport type TicTacToeState = {\n  board: Array<\"X\" | \"O\" | null>;\n  turn: \"X\" | \"O\";\n  finished: boolean;\n  winner: \"X\" | \"O\" | \"Draw\" | null;\n};\n\nexport function createTicTacToe(): TicTacToeState {\n  return {\n    board: Array(9).fill(null),\n    turn: \"X\",\n    finished: false,\n    winner: null,\n  };\n}\n\nfunction checkWin(board: Array<\"X\" | \"O\" | null>): \"X\" | \"O\" | \"Draw\" | null {\n  const lines = [\n    [0, 1, 2],\n    [3, 4, 5],\n    [6, 7, 8],\n    [0, 3, 6],\n    [1, 4, 7],\n    [2, 5, 8],\n    [0, 4, 8],\n    [2, 4, 6],\n  ];\n  for (const [a, b, c] of lines) {\n    if (board[a] && board[a] === board[b] && board[a] === board[c])\n      return board[a] as \"X\" | \"O\";\n  }\n  if (board.every((c) => c)) return \"Draw\";\n  return null;\n}\n\nexport function tryClaimCell(\n  state: TicTacToeState,\n  cell: TicCell,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n): boolean {\n  if (state.finished || state.board[cell]) return false;\n  const tgt = TTT_TARGETS[cell];\n  let ok = false;\n  if (tgt.type === \"BULL\")\n    ok =\n      ring === \"BULL\" || ring === \"INNER_BULL\" || value === 25 || value === 50;\n  else if (tgt.type === \"NUM\" && typeof tgt.num === \"number\") {\n    if (typeof sector === \"number\" && sector === tgt.num) ok = true;\n    else if (\n      !sector &&\n      (value === tgt.num || value === tgt.num * 2 || value === tgt.num * 3)\n    )\n      ok = true;\n  }\n  if (!ok) return false;\n  state.board[cell] = state.turn;\n  const w = checkWin(state.board);\n  if (w) {\n    state.finished = true;\n    state.winner = w;\n    return true;\n  }\n  state.turn = state.turn === \"X\" ? \"O\" : \"X\";\n  return true;\n}\n","/**\n * Scam, Fives, and Sevens game logic\n * All three follow a similar score-race pattern:\n * - Players accumulate scores\n * - Only certain numbers count\n * - First to reach target wins\n */\n\n// SCAM/SCUM - Hit targets 1â†’20â†’Bull in sequence\nexport interface ScamState {\n  targetIndex: number; // 0-20 for numbers 1-20, 21 for bull (25/50)\n  darts: number;\n  finished: boolean;\n}\n\nexport function createScamState(): ScamState {\n  return {\n    targetIndex: 0,\n    darts: 0,\n    finished: false,\n  };\n}\n\nexport const SCAM_TARGETS = [\n  1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 25,\n];\nexport const SCAM_TARGET_NAMES = [\n  \"1\",\n  \"2\",\n  \"3\",\n  \"4\",\n  \"5\",\n  \"6\",\n  \"7\",\n  \"8\",\n  \"9\",\n  \"10\",\n  \"11\",\n  \"12\",\n  \"13\",\n  \"14\",\n  \"15\",\n  \"16\",\n  \"17\",\n  \"18\",\n  \"19\",\n  \"20\",\n  \"Bull\",\n];\n\nexport function getScamTarget(state: ScamState): number {\n  return SCAM_TARGETS[state.targetIndex];\n}\n\nexport function addScamAuto(\n  state: ScamState,\n  value: number,\n  ring?: string,\n): ScamState {\n  if (state.finished) return state;\n\n  const target = getScamTarget(state);\n  const targetHit =\n    (ring === \"SINGLE\" && value === target) ||\n    (ring === \"DOUBLE\" && value === target) ||\n    (ring === \"TRIPLE\" && value === target) ||\n    (ring === \"INNER_BULL\" && target === 25);\n\n  if (!targetHit) return state;\n\n  // Hit! Move to next target\n  const newIndex = state.targetIndex + 1;\n  const finished = newIndex >= SCAM_TARGETS.length;\n\n  return {\n    targetIndex: newIndex,\n    darts: state.darts + 1,\n    finished,\n  };\n}\n\nexport function addScamNumeric(state: ScamState, value: number): ScamState {\n  // For manual input, assume single ring hit\n  return addScamAuto(state, value, \"SINGLE\");\n}\n\nexport function resetScam(): ScamState {\n  return createScamState();\n}\n\n// FIVES - Only multiples of 5 count (5,10,15,20,25,50)\nexport interface FivesState {\n  score: number;\n  darts: number;\n  finished: boolean;\n  target: number; // default 50\n}\n\nexport function createFivesState(target: number = 50): FivesState {\n  return {\n    score: 0,\n    darts: 0,\n    finished: false,\n    target,\n  };\n}\n\nexport const FIVES_VALID_NUMBERS = [5, 10, 15, 20, 25, 50];\n\nexport function isFivesValid(value: number): boolean {\n  return FIVES_VALID_NUMBERS.includes(value);\n}\n\nexport function addFivesAuto(\n  state: FivesState,\n  value: number,\n  _ring?: string,\n): FivesState {\n  if (state.finished) return state;\n\n  // Only multiples of 5 count\n  if (!isFivesValid(value)) {\n    return { ...state, darts: state.darts + 1 };\n  }\n\n  const newScore = state.score + value;\n  const finished = newScore >= state.target;\n\n  return {\n    score: finished ? state.target : newScore,\n    darts: state.darts + 1,\n    finished,\n    target: state.target,\n  };\n}\n\nexport function addFivesNumeric(state: FivesState, value: number): FivesState {\n  return addFivesAuto(state, value, \"SINGLE\");\n}\n\nexport function resetFives(target: number = 50): FivesState {\n  return createFivesState(target);\n}\n\n// SEVENS - Only multiples of 7 count (7,14,21)\nexport interface SevensState {\n  score: number;\n  darts: number;\n  finished: boolean;\n  target: number; // default 70\n}\n\nexport function createSevensState(target: number = 70): SevensState {\n  return {\n    score: 0,\n    darts: 0,\n    finished: false,\n    target,\n  };\n}\n\nexport const SEVENS_VALID_NUMBERS = [7, 14, 21];\n\nexport function isSevensValid(value: number): boolean {\n  return SEVENS_VALID_NUMBERS.includes(value);\n}\n\nexport function addSevensAuto(\n  state: SevensState,\n  value: number,\n  _ring?: string,\n): SevensState {\n  if (state.finished) return state;\n\n  // Only multiples of 7 count\n  if (!isSevensValid(value)) {\n    return { ...state, darts: state.darts + 1 };\n  }\n\n  const newScore = state.score + value;\n  const finished = newScore >= state.target;\n\n  return {\n    score: finished ? state.target : newScore,\n    darts: state.darts + 1,\n    finished,\n    target: state.target,\n  };\n}\n\nexport function addSevensNumeric(\n  state: SevensState,\n  value: number,\n): SevensState {\n  return addSevensAuto(state, value, \"SINGLE\");\n}\n\nexport function resetSevens(target: number = 70): SevensState {\n  return createSevensState(target);\n}\n","export type AmCricketMark = 0 | 1 | 2 | 3;\nexport type AmCricketNumber = 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 25;\n\nexport type AmCricketState = {\n  marks: Record<AmCricketNumber, AmCricketMark>;\n  points: number;\n};\n\nexport const AM_CRICKET_NUMBERS: AmCricketNumber[] = [\n  20, 19, 18, 17, 16, 15, 14, 13, 12, 25,\n];\n\nexport function createAmCricketState(): AmCricketState {\n  const marks: any = {};\n  AM_CRICKET_NUMBERS.forEach((n) => {\n    marks[n] = 0;\n  });\n  return { marks, points: 0 };\n}\n\nexport function applyAmCricketDart(\n  state: AmCricketState,\n  value: number,\n  ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n  sector?: number | null,\n  opponentClosed: (n: AmCricketNumber) => boolean = () => false,\n): number {\n  let num: AmCricketNumber | null = null;\n  let hits = 0;\n  if (\n    ring === \"BULL\" ||\n    ring === \"INNER_BULL\" ||\n    value === 25 ||\n    value === 50\n  ) {\n    num = 25;\n    hits = ring === \"INNER_BULL\" || value === 50 ? 2 : 1;\n  } else if (typeof sector === \"number\" && sector >= 12 && sector <= 20) {\n    num = sector as AmCricketNumber;\n    if (ring === \"TRIPLE\") hits = 3;\n    else if (ring === \"DOUBLE\") hits = 2;\n    else hits = 1;\n  } else if (value) {\n    for (const c of [20, 19, 18, 17, 16, 15, 14, 13, 12] as AmCricketNumber[]) {\n      if (value === c) {\n        num = c;\n        hits = 1;\n        break;\n      }\n      if (value === c * 2) {\n        num = c;\n        hits = 2;\n        break;\n      }\n      if (value === c * 3) {\n        num = c;\n        hits = 3;\n        break;\n      }\n    }\n    if (!num && (value === 25 || value === 50)) {\n      num = 25;\n      hits = value === 50 ? 2 : 1;\n    }\n  }\n  if (!num) return 0;\n\n  const before = state.marks[num];\n  const toClose = Math.max(0, 3 - before);\n  const toApply = Math.min(toClose, hits);\n  const overflow = Math.max(0, hits - toApply);\n  const after = (before + toApply) as AmCricketMark;\n  state.marks[num] = after > 3 ? 3 : after;\n\n  let points = 0;\n  if (overflow > 0 && !opponentClosed(num)) {\n    if (num === 25) {\n      if (ring === \"INNER_BULL\") points += 50 * overflow;\n      else points += 25 * overflow;\n    } else {\n      points += (num as number) * overflow;\n    }\n  }\n  state.points += points;\n  return points;\n}\n\nexport function hasClosedAllAm(state: AmCricketState): boolean {\n  return AM_CRICKET_NUMBERS.every((n) => (state.marks[n] || 0) >= 3);\n}\n","import type { ReactNode } from \"react\";\n\n// Glassy sticky header bar used across Offline and Online match UIs for visual parity\nexport default function GameHeaderBar({\n  left,\n  right,\n  className = \"\",\n  sticky = true,\n}: {\n  left: ReactNode;\n  right?: ReactNode;\n  className?: string;\n  sticky?: boolean;\n}) {\n  return (\n    <div\n      className={`${sticky ? \"sticky top-0\" : \"\"} card relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm ${className}`}\n    >\n      <div className=\"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent\" />\n      <div className=\"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap\">\n        {left} ðŸŽ¯\n      </div>\n      <div className=\"flex items-center gap-1 flex-wrap justify-end\">\n        {right}\n      </div>\n    </div>\n  );\n}\n","// Small adapter helpers to convert generic MatchControls onAddVisit callbacks to the local handlers\nexport function makeOnlineAddVisitAdapter(\n  submitVisitManual: (v: number) => void,\n) {\n  return (score: number, _darts: number) => {\n    submitVisitManual(score);\n  };\n}\n\nexport function makeOfflineAddVisitAdapter(\n  commitManualVisitTotal: (v: number) => boolean,\n) {\n  return (score: number, _darts: number) => {\n    commitManualVisitTotal(score);\n  };\n}\n","import type { Actions as MatchActions } from \"../store/match.js\";\n\nexport type UnifiedMatchActions = {\n  addVisit: (score: number, darts?: number, meta?: any) => void;\n  undoVisit: () => void;\n  nextPlayer: () => void;\n  endLeg: (score?: number) => void;\n  endGame: () => void;\n};\n\nexport function createOnlineMatchActions(args: {\n  match: MatchActions;\n  sendState: () => void;\n  submitVisitManual?: (v: number) => void;\n}): UnifiedMatchActions {\n  const { match, sendState, submitVisitManual } = args;\n  return {\n    addVisit: (score: number, darts = 3, meta?: any) => {\n      // Prefer the manual submit helper when available as it computes double/finish meta\n      if (submitVisitManual) {\n        submitVisitManual(score);\n        return;\n      }\n      try {\n        match.addVisit(score, darts, meta);\n      } catch (e) {\n        match.addVisit(score, darts);\n      }\n      try {\n        sendState();\n      } catch (e) {}\n    },\n    undoVisit: () => {\n      match.undoVisit();\n      try {\n        sendState();\n      } catch (e) {}\n    },\n    nextPlayer: () => {\n      match.nextPlayer();\n      try {\n        sendState();\n      } catch (e) {}\n    },\n    endLeg: (score?: number) => {\n      if (typeof score === \"number\") match.endLeg(score);\n      else match.endLeg(0);\n      try {\n        sendState();\n      } catch (e) {}\n    },\n    endGame: () => {\n      match.endGame();\n      try {\n        sendState();\n      } catch {}\n    },\n  };\n}\n\nexport function createOfflineMatchActions(args: {\n  match: MatchActions;\n  commitManualVisitTotal?: (v: number) => boolean;\n  endTurn?: (nextRemaining: number) => void;\n}): UnifiedMatchActions {\n  const { match, commitManualVisitTotal, endTurn } = args;\n  return {\n    addVisit: (score: number, darts = 3, meta?: any) => {\n      if (commitManualVisitTotal) {\n        commitManualVisitTotal(score);\n        return;\n      }\n      try {\n        match.addVisit(score, darts, meta);\n      } catch {\n        match.addVisit(score, darts);\n      }\n    },\n    undoVisit: () => {\n      match.undoVisit();\n    },\n    nextPlayer: () => {\n      if (endTurn) {\n        try {\n          endTurn(0);\n        } catch {\n          match.nextPlayer();\n        }\n      } else {\n        match.nextPlayer();\n      }\n    },\n    endLeg: (score?: number) => {\n      if (typeof score === \"number\") match.endLeg(score);\n      else match.endLeg(0);\n    },\n    endGame: () => {\n      match.endGame();\n    },\n  };\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { suggestCheckouts, sayScore } from \"../utils/checkout.js\";\nimport { useUserSettings } from \"../store/userSettings.js\";\nimport { useToast } from \"../store/toast.js\";\nimport CameraTile from \"./CameraTile.js\";\nimport CameraView from \"./CameraView.js\";\nimport React, { memo } from \"react\";\nconst MemoCameraView: any = memo(CameraView as any);\nimport { broadcastMessage } from \"../utils/broadcast.js\";\nimport { getUserCurrency, formatPriceInCurrency } from \"../utils/config.js\";\nimport { bumpGameMode } from \"../store/profileStats.js\";\nimport { getPreferredUserName } from \"../utils/userName.js\";\nimport { getApiBaseUrl } from \"../utils/api.js\";\nimport {\n  DOUBLE_PRACTICE_ORDER,\n  isDoubleHit,\n  parseManualDart,\n} from \"../game/types.js\";\nimport { openMatchWindow } from \"../utils/matchWindow.js\";\nimport { ATC_ORDER } from \"../game/aroundTheClock.js\";\nimport {\n  createCricketState,\n  applyCricketDart,\n  CRICKET_NUMBERS,\n  hasClosedAll as cricketClosedAll,\n} from \"../game/cricket.js\";\nimport {\n  createShanghaiState,\n  applyShanghaiDart,\n  endShanghaiTurn,\n} from \"../game/shanghai.js\";\nimport {\n  createDefaultHalveIt,\n  getCurrentHalveTarget,\n  applyHalveItDart,\n  endHalveItTurn,\n} from \"../game/halveIt.js\";\nimport {\n  createHighLow,\n  applyHighLowDart,\n  endHighLowTurn,\n} from \"../game/highLow.js\";\nimport {\n  createKillerState,\n  assignKillerNumbers,\n  applyKillerDart,\n  killerWinner,\n  KillerState,\n} from \"../game/killer.js\";\nimport { createBaseball, applyBaseballDart } from \"../game/baseball.js\";\nimport { createGolf, applyGolfDart } from \"../game/golf.js\";\nimport { createTicTacToe, tryClaimCell, TTT_TARGETS } from \"../game/ticTacToe.js\";\nimport {\n  createScamState,\n  addScamAuto,\n  addScamNumeric,\n  resetScam,\n  SCAM_TARGET_NAMES,\n  createFivesState,\n  addFivesAuto,\n  addFivesNumeric,\n  resetFives,\n  createSevensState,\n  addSevensAuto,\n  addSevensNumeric,\n  resetSevens,\n} from \"../game/scamFivesSevens.js\";\nimport {\n  createAmCricketState,\n  applyAmCricketDart,\n  AM_CRICKET_NUMBERS,\n  hasClosedAllAm,\n} from \"../game/americanCricket.js\";\nimport ResizableModal from \"./ui/ResizableModal.js\";\nimport MatchStartShowcase from \"./ui/MatchStartShowcase.js\";\nimport { useAudit } from \"../store/audit.js\";\nimport GameHeaderBar from \"./ui/GameHeaderBar.js\";\nimport PauseQuitModal from \"./ui/PauseQuitModal.js\";\nimport ScoreNumberPad from \"./ui/ScoreNumberPad.js\";\nimport { useMatchControl } from \"../store/matchControl.js\";\nimport { formatAvg } from \"../utils/stats.js\";\nimport GameScoreboard, { type PlayerStats } from \"./scoreboards/GameScoreboard.js\";\nimport MatchControls from \"./MatchControls.js\";\nimport { makeOfflineAddVisitAdapter } from \"./matchControlAdapters.js\";\nimport {\n  createOfflineMatchActions,\n  UnifiedMatchActions,\n} from \"../logic/matchActions.js\";\nimport { useMatch } from \"../store/match.js\";\nimport { useOfflineGameStats } from \"./scoreboards/useGameStats.js\";\nimport { freeGames, premiumGames } from \"../utils/games.js\";\n\nconst aiLevels = [\"Easy\", \"Medium\", \"Hardened\"];\n\ntype PendingAutoVisit = {\n  visitTotal: number;\n  darts: number;\n  preRemaining: number;\n  remaining: number;\n  doubleAttempts: number;\n  finished: boolean;\n  doubleWindow: boolean;\n  highestCheckout?: number | null;\n  announced?: boolean;\n};\n\nconst BOARD_CLEAR_GRACE_MS = 6500;\n\nfunction clamp(val: number, min: number, max: number) {\n  return Math.max(min, Math.min(max, val));\n}\n\nfunction aiVisitScore(remaining: number, level: string): number {\n  let target = 0;\n  if (level === \"Easy\") {\n    const candidates = [22, 26, 41, 45, 60];\n    target = candidates[Math.floor(Math.random() * candidates.length)];\n  } else if (level === \"Medium\") {\n    target = Math.round(clamp(60 + (Math.random() * 30 - 15), 30, 100));\n  } else {\n    target = Math.round(clamp(80 + (Math.random() * 20 - 10), 50, 120));\n  }\n  if (remaining <= 0) return 0;\n  if (target > remaining) {\n    const safe = [100, 85, 81, 60, 57, 45, 41, 26, 22, 20, 1].find(\n      (v) => v <= remaining,\n    );\n    return safe ?? 0;\n  }\n  return target;\n}\n\nfunction X01RulesPopup({ onClose }: { onClose: () => void }) {\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50\">\n      <div className=\"card max-w-lg w-full relative\">\n        <button\n          className=\"absolute top-2 right-2 btn px-2 py-1\"\n          onClick={onClose}\n        >\n          Close âœ•\n        </button>\n        <h3 className=\"text-xl font-bold mb-2\">X01 Rules & Regulations ðŸ“–</h3>\n        <ul className=\"list-disc pl-5 text-left mb-2\">\n          <li>Double In: Start scoring only after hitting a double.</li>\n          <li>\n            Double Out: Finish the game by hitting a double to reach exactly\n            zero.\n          </li>\n          <li>\n            Best Of: Play a set number of legs, winner is first to reach\n            majority.\n          </li>\n          <li>First To: Play until a player reaches a set number of legs.</li>\n          <li>\n            No Cheating: All scores must be valid, no manual score changes\n            mid-leg.\n          </li>\n          <li>\n            Competitive Standard: Follow latest WDF/PDC rules for match play.\n          </li>\n        </ul>\n        <p className=\"text-sm text-slate-600\">\n          For full details, see official darts governing body rules.\n        </p>\n      </div>\n    </div>\n  );\n}\n\nconst API_URL = getApiBaseUrl();\n\nexport default function OfflinePlay({ user }: { user: any }) {\n  const {\n    offlineLayout,\n    favoriteDouble,\n    callerEnabled,\n    callerVoice,\n    callerVolume,\n    speakCheckoutOnly,\n    rememberLastOffline,\n    setLastOffline,\n    autoStartOffline,\n    cameraScale,\n    setCameraScale,\n    cameraAspect = \"wide\",\n    setCameraAspect,\n    cameraFitMode = \"fill\",\n    setCameraFitMode,\n    cameraEnabled,\n    textSize,\n    boxSize,\n    autoscoreProvider,\n    autoCommitMode = \"wait-for-clear\",\n    matchType = \"singles\",\n    setMatchType,\n    teamAName = \"Team A\",\n    setTeamAName,\n    teamBName = \"Team B\",\n    setTeamBName,\n  } = useUserSettings();\n  const manualScoring = autoscoreProvider === \"manual\";\n  const cameraToolbarVisible = cameraEnabled && !manualScoring;\n  const waitForBoardClear =\n    cameraEnabled && !manualScoring && autoCommitMode !== \"immediate\";\n  const [selectedMode, setSelectedMode] = useState<string>(\"X01\");\n  const [x01Score, setX01Score] = useState(501);\n  const [ai, setAI] = useState(\"None\");\n  const [showRules, setShowRules] = useState(false);\n  const [inMatch, setInMatch] = useState(false);\n  const [playerScore, setPlayerScore] = useState(x01Score);\n  const [aiScore, setAiScore] = useState(x01Score);\n  const [_onDouble, setOnDouble] = useState(false);\n  const [showWinPopup, setShowWinPopup] = useState(false);\n  // Match format: First-to selector and leg counters\n  const [firstTo, setFirstTo] = useState<number>(1);\n  const [playerLegs, setPlayerLegs] = useState<number>(0);\n  const match = useMatch();\n  const [showStartShowcase, setShowStartShowcase] = useState(false);\n  const startedShowcasedRef = useRef(false);\n  const [aiLegs, setAiLegs] = useState<number>(0);\n  // Placeholder for unified offline actions; once commitManualVisitTotal/endTurn defined, we'll assign\n\n  const [pendingLegWinner, setPendingLegWinner] = useState<\n    \"player\" | \"ai\" | null\n  >(null);\n  const [doubleDarts, setDoubleDarts] = useState(1);\n  const [checkoutDarts, setCheckoutDarts] = useState(1);\n  const [legStats, setLegStats] = useState<\n    {\n      winner: \"player\" | \"ai\";\n      doubleDarts: number;\n      checkoutDarts: number;\n      winnerDarts: number;\n      doublesAtt?: number;\n      doublesHit?: number;\n    }[]\n  >([]);\n  // New: pre-game adjustable AI delay (ms)\n  const [aiDelayMs, setAiDelayMs] = useState<number>(2000);\n  const toast = useToast();\n  // New: match popup state\n  const [showMatchModal, setShowMatchModal] = useState(false);\n  const [showQuitPause, setShowQuitPause] = useState(false);\n  const [showQuitConfirm, setShowQuitConfirm] = useState(false);\n  const [quitVotes, setQuitVotes] = useState({\n    player: false,\n    opponent: false,\n  });\n  const setPaused = useMatchControl((s: any) => s.setPaused);\n  const paused = useMatchControl((s: any) => s.paused);\n  const pauseEndsAt = useMatchControl((s: any) => s.pauseEndsAt);\n  const [showPauseMenu, setShowPauseMenu] = useState(false);\n  const [pauseNow, setPauseNow] = useState(Date.now());\n\n  // Tick the pause countdown timer every 500ms while paused\n  useEffect(() => {\n    if (!paused || !pauseEndsAt) return;\n    const t = setInterval(() => setPauseNow(Date.now()), 500);\n    return () => clearInterval(t);\n  }, [paused, pauseEndsAt]);\n\n  // Auto-unpause when timer expires\n  useEffect(() => {\n    if (paused && pauseEndsAt && Date.now() >= pauseEndsAt) {\n      setPaused(false, null);\n    }\n  }, [paused, pauseEndsAt, pauseNow, setPaused]);\n\n  // Signal the app shell to go full-screen on mobile while in-game\n  useEffect(() => {\n    if (inMatch) {\n      document.documentElement.setAttribute('data-ndn-ingame', 'true');\n    } else {\n      document.documentElement.removeAttribute('data-ndn-ingame');\n    }\n    return () => {\n      document.documentElement.removeAttribute('data-ndn-ingame');\n    };\n  }, [inMatch]);\n\n  useEffect(() => {\n    const onQuit = () => {\n      setShowMatchModal(false);\n      setInMatch(false);\n      setShowQuitPause(false);\n    };\n    try {\n      window.addEventListener(\"ndn:match-quit\" as any, onQuit as any);\n    } catch {}\n    return () => {\n      try {\n        window.removeEventListener(\"ndn:match-quit\" as any, onQuit as any);\n      } catch {}\n    };\n  }, []);\n  // Mirror Online layout defaults when in modern layout, otherwise keep classic feel\n  const [maximized, setMaximized] = useState(true);\n  const [fitAll, setFitAll] = useState(false);\n  // React to layout changes at runtime\n  useEffect(() => {\n    setMaximized(true);\n    setFitAll(false);\n  }, [offlineLayout]);\n  useEffect(() => {\n    if (cameraFitMode !== \"fit\") {\n      setCameraFitMode(\"fit\");\n    }\n  }, [cameraFitMode, setCameraFitMode]);\n  const [fitScale, setFitScale] = useState(1);\n  const [_fitOverflowing, setFitOverflowing] = useState(false);\n  const [isPlayerTurn, setIsPlayerTurn] = useState(true);\n  const [isMobileScreen, setIsMobileScreen] = useState(\n    () => typeof window !== \"undefined\" && window.innerWidth < 768,\n  );\n  const [mobileCameraOpen, setMobileCameraOpen] = useState(false);\n\n  // Mobile camera drawer close behavior: Escape key and swipe-down gesture.\n  useEffect(() => {\n    if (!mobileCameraOpen) return;\n    const onKeyDown = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") setMobileCameraOpen(false);\n    };\n    window.addEventListener(\"keydown\", onKeyDown);\n    return () => window.removeEventListener(\"keydown\", onKeyDown);\n  }, [mobileCameraOpen]);\n\n  const drawerDragRef = useRef<{ startY: number; curY: number; active: boolean }>(\n    { startY: 0, curY: 0, active: false },\n  );\n  const drawerRootRef = useRef<HTMLDivElement | null>(null);\n  const onDrawerPointerDown = useCallback((e: React.PointerEvent) => {\n    drawerDragRef.current = {\n      startY: e.clientY,\n      curY: e.clientY,\n      active: true,\n    };\n    drawerRootRef.current?.setPointerCapture(e.pointerId);\n  }, []);\n  const onDrawerPointerMove = useCallback((e: React.PointerEvent) => {\n    const st = drawerDragRef.current;\n    if (!st.active) return;\n    st.curY = e.clientY;\n  }, []);\n  const onDrawerPointerEnd = useCallback(() => {\n    const st = drawerDragRef.current;\n    if (!st.active) return;\n    st.active = false;\n    const dy = st.curY - st.startY;\n    if (dy > 70) setMobileCameraOpen(false);\n  }, []);\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    const handleResize = () => setIsMobileScreen(window.innerWidth < 768);\n    handleResize();\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n  useEffect(() => {\n    if (!isMobileScreen) {\n      setMobileCameraOpen(false);\n    }\n  }, [isMobileScreen]);\n  useEffect(() => {\n    const handleOpenManager = () => setShowCameraManager(true);\n    window.addEventListener(\"ndn:open-camera-manager\", handleOpenManager);\n    return () =>\n      window.removeEventListener(\"ndn:open-camera-manager\", handleOpenManager);\n  }, []);\n  // Per-dart input and stats\n  const [playerDartPoints, setPlayerDartPoints] = useState<number>(0);\n  const [dpIndex, setDpIndex] = useState<number>(0); // 0..20 (DBULL at 20)\n  const [dpHits, setDpHits] = useState<number>(0);\n  // Around the Clock (offline practice)\n  const [atcIndex, setAtcIndex] = useState<number>(0);\n  const [atcHits, setAtcHits] = useState<number>(0);\n  // Practice mode states\n  const [cricket, setCricket] = useState(createCricketState());\n  const [shanghai, setShanghai] = useState(createShanghaiState());\n  const [halve, setHalve] = useState(createDefaultHalveIt());\n  const [highlow, setHighlow] = useState(createHighLow());\n  const [_practiceTurnDarts, setPracticeTurnDarts] = useState<number>(0);\n  // Phase 1 practice modes\n  const [b27Stage, setB27Stage] = useState<number>(1);\n  const [b27Score, setB27Score] = useState<number>(27);\n  const [_b27Darts, setB27Darts] = useState<number>(0);\n  const [b27Hits, setB27Hits] = useState<number>(0);\n  const [b27Finished, setB27Finished] = useState<boolean>(false);\n  const [cuRound, setCuRound] = useState<number>(1);\n  const [cuScore, setCuScore] = useState<number>(0);\n  const [_cuDarts, setCuDarts] = useState<number>(0);\n  const cuMaxRounds = 8;\n  const [hsRound, setHsRound] = useState<number>(1);\n  const [hsScore, setHsScore] = useState<number>(0);\n  const [_hsDarts, setHsDarts] = useState<number>(0);\n  const hsMaxRounds = 10;\n  const [lsRound, setLsRound] = useState<number>(1);\n  const [lsScore, setLsScore] = useState<number>(0);\n  const [_lsDarts, setLsDarts] = useState<number>(0);\n  const lsMaxRounds = 10;\n  const [co170Rem, setCo170Rem] = useState<number>(170);\n  const [co170Darts, setCo170Darts] = useState<number>(0);\n  const [co170Attempts, setCo170Attempts] = useState<number>(0);\n  const [co170Successes, setCo170Successes] = useState<number>(0);\n  const [co121Rem, setCo121Rem] = useState<number>(121);\n  const [co121Darts, setCo121Darts] = useState<number>(0);\n  const [co121Attempts, setCo121Attempts] = useState<number>(0);\n  const [co121Successes, setCo121Successes] = useState<number>(0);\n  const [trebleTarget, setTrebleTarget] = useState<number>(20);\n  const [trebleHits, setTrebleHits] = useState<number>(0);\n  const [trebleDarts, setTrebleDarts] = useState<number>(0);\n  const [trebleMaxDarts, setTrebleMaxDarts] = useState<number>(30);\n  const [trebleFinished, setTrebleFinished] = useState<boolean>(false);\n  // Phase 2 states\n  const [baseball, setBaseball] = useState(createBaseball());\n  const [golf, setGolf] = useState(createGolf());\n  const [ttt, setTTT] = useState(createTicTacToe());\n  const [amCricket, setAmCricket] = useState(createAmCricketState());\n  // Killer (hotseat) state\n  const [killerPlayers, setKillerPlayers] = useState<\n    Array<{ id: string; name: string }>\n  >([\n    { id: \"p1\", name: \"Player 1\" },\n    { id: \"p2\", name: \"Player 2\" },\n  ]);\n  const [killerStates, setKillerStates] = useState<Record<string, KillerState>>(\n    {},\n  );\n  const [killerAssigned, setKillerAssigned] = useState<Record<string, number>>(\n    {},\n  );\n  const [killerSetupDone, setKillerSetupDone] = useState<boolean>(false);\n  const [killerTurnIdx, setKillerTurnIdx] = useState<number>(0);\n  const [killerDarts, setKillerDarts] = useState<number>(0);\n  const [killerWinnerId, setKillerWinnerId] = useState<string | null>(null);\n  const [killerLastEvent, setKillerLastEvent] = useState<string>(\"\");\n  // Scam/Scum state\n  const [scam, _setScam] = useState(createScamState());\n  const [scamPlayer, setScamPlayer] = useState(createScamState());\n  // Fives state\n  const [fives, _setFives] = useState(createFivesState(50));\n  const [fivesPlayer, setFivesPlayer] = useState(createFivesState(50));\n  // Sevens state\n  const [sevens, _setSevens] = useState(createSevensState(70));\n  const [sevensPlayer, setSevensPlayer] = useState(createSevensState(70));\n  const [playerDartsThrown, setPlayerDartsThrown] = useState<number>(0);\n  const [playerLastDart, setPlayerLastDart] = useState<number>(0);\n  const [playerVisitDarts, setPlayerVisitDarts] = useState<number>(0);\n  const [playerVisitStart, setPlayerVisitStart] = useState<number>(x01Score);\n  const [playerVisitSum, setPlayerVisitSum] = useState<number>(0);\n  const [playerLastVisitScore, setPlayerLastVisitScore] = useState<\n    number | null\n  >(null);\n  const [playerVisitDartsAtDouble, setPlayerVisitDartsAtDouble] =\n    useState<number>(0);\n  const lastBounceMissTsRef = useRef<number>(0);\n  const lastVisitDartsRef = useRef<number>(0);\n  const playerScoreRef = useRef<number>(playerScore);\n  const playerVisitDartsRef = useRef<number>(playerVisitDarts);\n  const playerVisitSumRef = useRef<number>(playerVisitSum);\n  const playerVisitStartRef = useRef<number>(playerVisitStart);\n  const playerVisitDartsAtDoubleRef = useRef<number>(playerVisitDartsAtDouble);\n\n  useEffect(() => {\n    playerScoreRef.current = playerScore;\n  }, [playerScore]);\n  useEffect(() => {\n    playerVisitDartsRef.current = playerVisitDarts;\n  }, [playerVisitDarts]);\n  useEffect(() => {\n    playerVisitSumRef.current = playerVisitSum;\n  }, [playerVisitSum]);\n  useEffect(() => {\n    playerVisitStartRef.current = playerVisitStart;\n  }, [playerVisitStart]);\n  useEffect(() => {\n    playerVisitDartsAtDoubleRef.current = playerVisitDartsAtDouble;\n  }, [playerVisitDartsAtDouble]);\n  const [aiCountdownMs, setAiCountdownMs] = useState<number>(0);\n  const _aiTimerRef = useRef<number | null>(null);\n  const [aiDartsThrown, setAiDartsThrown] = useState<number>(0);\n  const [aiLastDart, setAiLastDart] = useState<number>(0);\n  const [aiVisitSum, setAiVisitSum] = useState<number>(0);\n  const [aiVisitDarts, setAiVisitDarts] = useState<number>(0);\n  const [aiLastVisitScore, setAiLastVisitScore] = useState<number | null>(null);\n  const [aiVisitDartsAtDouble, setAiVisitDartsAtDouble] = useState<number>(0);\n  // Doubles attempts/hits\n  const [playerDoublesAtt, setPlayerDoublesAtt] = useState<number>(0);\n  const [playerDoublesHit, setPlayerDoublesHit] = useState<number>(0);\n  const [aiDoublesAtt, setAiDoublesAtt] = useState<number>(0);\n  const [aiDoublesHit, setAiDoublesHit] = useState<number>(0);\n  // Match-long totals for averages\n  const [totalPlayerDarts, setTotalPlayerDarts] = useState<number>(0);\n  const [totalAiDarts, setTotalAiDarts] = useState<number>(0);\n  const [totalPlayerPoints, setTotalPlayerPoints] = useState<number>(0);\n  const [totalAiPoints, setTotalAiPoints] = useState<number>(0);\n  // Power scoring and checkout highs\n  const [player180s, setPlayer180s] = useState<number>(0);\n  const [player140s, setPlayer140s] = useState<number>(0);\n  const [player100s, setPlayer100s] = useState<number>(0);\n  const [ai180s, setAi180s] = useState<number>(0);\n  const [ai140s, setAi140s] = useState<number>(0);\n  const [ai100s, setAi100s] = useState<number>(0);\n  const [playerHighestCheckout, setPlayerHighestCheckout] = useState<number>(0);\n  const [aiHighestCheckout, setAiHighestCheckout] = useState<number>(0);\n  const [checkoutPrompt, setCheckoutPrompt] = useState<{\n    remaining: number;\n    routes: string[];\n  } | null>(null);\n  const [checkoutPopupOpen, setCheckoutPopupOpen] = useState<boolean>(false);\n  // End-of-match summary modal\n  const [showMatchSummary, setShowMatchSummary] = useState<boolean>(false);\n  // Manual correction input for offline (matches CameraView UX)\n  const [manualBox, setManualBox] = useState<string>(\"\");\n  const [manualTextarea, setManualTextarea] = useState<string>(\"\");\n  const [manualPlayerScoreInput, setManualPlayerScoreInput] =\n    useState<string>(\"\");\n  const [manualOpponentScoreInput, setManualOpponentScoreInput] =\n    useState<string>(\"\");\n  const [manualPlayerLegsInput, setManualPlayerLegsInput] =\n    useState<string>(\"\");\n  const [manualOpponentLegsInput, setManualOpponentLegsInput] =\n    useState<string>(\"\");\n  const [legOverrideConfirm, setLegOverrideConfirm] = useState<{\n    target: \"player\" | \"ai\";\n    value: number;\n    stage: 1 | 2;\n  } | null>(null);\n  const [showCameraManager, setShowCameraManager] = useState<boolean>(false);\n  const [dartCounts, setDartCounts] = useState<Record<string, number>>({});\n  const [awaitingBoardClear, setAwaitingBoardClear] = useState<boolean>(false);\n  const pendingVisitRef = useRef<PendingAutoVisit | null>(null);\n  const pendingVisitTimerRef = useRef<ReturnType<typeof setTimeout> | null>(\n    null,\n  );\n\n  const clearPendingVisitTimer = useCallback(() => {\n    const timer = pendingVisitTimerRef.current;\n    if (timer) {\n      clearTimeout(timer);\n      pendingVisitTimerRef.current = null;\n    }\n  }, []);\n\n  const updateCheckoutPrompt = useCallback(\n    (remaining: number) => {\n      if (remaining > 0 && remaining <= 60) {\n        const routes = suggestCheckouts(remaining, favoriteDouble);\n        setCheckoutPrompt({ remaining, routes });\n        setCheckoutPopupOpen(true);\n      } else {\n        setCheckoutPrompt(null);\n        setCheckoutPopupOpen(false);\n      }\n    },\n    [favoriteDouble],\n  );\n\n  const finalizeQuitMatch = useCallback(() => {\n    try {\n      broadcastMessage({ type: \"quit\" });\n    } catch {}\n    setShowMatchModal(false);\n    setInMatch(false);\n    setShowQuitPause(false);\n    setShowQuitConfirm(false);\n    setQuitVotes({ player: false, opponent: false });\n  }, []);\n\n  useEffect(() => {\n    if (!showQuitConfirm) return;\n    if (quitVotes.player && quitVotes.opponent) {\n      finalizeQuitMatch();\n    }\n  }, [finalizeQuitMatch, quitVotes, showQuitConfirm]);\n\n  const speakAutoVisit = useCallback(\n    (pending: PendingAutoVisit) => {\n      if (!callerEnabled) return;\n      const speaker = getPreferredUserName(user, \"Player\");\n      try {\n        sayScore(\n          speaker,\n          pending.visitTotal,\n          Math.max(pending.remaining, 0),\n          callerVoice,\n          { volume: callerVolume, checkoutOnly: speakCheckoutOnly },\n        );\n      } catch {}\n    },\n    [callerEnabled, callerVoice, callerVolume, speakCheckoutOnly, user],\n  );\n\n  const commitPendingVisit = useCallback(\n    (\n      pending: PendingAutoVisit,\n      _trigger: \"immediate\" | \"event\" | \"timeout\",\n    ) => {\n      setAwaitingBoardClear(false);\n      const {\n        visitTotal,\n        darts,\n        preRemaining,\n        remaining,\n        doubleAttempts,\n        finished,\n        doubleWindow,\n        highestCheckout,\n      } = pending;\n\n      if (!finished) {\n        setPlayerScore(remaining);\n        playerScoreRef.current = remaining;\n      } else {\n        setPlayerScore(0);\n        playerScoreRef.current = 0;\n        if (typeof highestCheckout === \"number\" && highestCheckout > 0) {\n          setPlayerHighestCheckout((h) => Math.max(h, highestCheckout));\n        }\n      }\n\n      setPlayerLastVisitScore(visitTotal);\n\n      if (visitTotal === 180) setPlayer180s((n) => n + 1);\n      else if (visitTotal >= 140) setPlayer140s((n) => n + 1);\n      else if (visitTotal >= 100) setPlayer100s((n) => n + 1);\n\n      if (doubleWindow && doubleAttempts > 0) {\n        setPlayerDoublesAtt((a) => a + doubleAttempts);\n        if (finished) setPlayerDoublesHit((h) => h + 1);\n      }\n\n      if (!pending.announced) speakAutoVisit(pending);\n\n      try {\n        useAudit.getState().recordVisit(\"offline-x01\", darts, visitTotal, {\n          preRemaining,\n          postRemaining: finished ? 0 : remaining,\n          finish: finished,\n          bust: false,\n        });\n      } catch {}\n\n      try {\n        match.addVisit(visitTotal, darts, { visitTotal });\n        if (finished) match.endLeg(preRemaining);\n      } catch {}\n\n      if (finished) {\n        setPendingLegWinner(\"player\");\n        setShowWinPopup(true);\n      }\n\n      endTurn(finished ? 0 : remaining);\n\n      setPlayerVisitSum(0);\n      playerVisitSumRef.current = 0;\n      setPlayerVisitDarts(0);\n      playerVisitDartsRef.current = 0;\n      setPlayerVisitDartsAtDouble(0);\n      playerVisitDartsAtDoubleRef.current = 0;\n    },\n    [\n      endTurn,\n      setPlayerHighestCheckout,\n      setPendingLegWinner,\n      setPlayerScore,\n      setPlayerLastVisitScore,\n      setPlayerVisitSum,\n      setPlayerVisitDarts,\n      setPlayerVisitDartsAtDouble,\n      setShowWinPopup,\n      setPlayer180s,\n      setPlayer140s,\n      setPlayer100s,\n      setPlayerDoublesAtt,\n      setPlayerDoublesHit,\n      speakAutoVisit,\n    ],\n  );\n\n  const finalizePendingVisit = useCallback(\n    (trigger: \"event\" | \"timeout\") => {\n      const pending = pendingVisitRef.current;\n      if (!pending) return;\n      pendingVisitRef.current = null;\n      clearPendingVisitTimer();\n      commitPendingVisit(pending, trigger);\n    },\n    [clearPendingVisitTimer, commitPendingVisit],\n  );\n\n  const queuePendingVisit = useCallback(\n    (pending: PendingAutoVisit) => {\n      // Do not announce immediately; let commitPendingVisit handle it after board clear\n      // speakAutoVisit(pending);\n      pendingVisitRef.current = { ...pending, announced: false };\n      setAwaitingBoardClear(true);\n      clearPendingVisitTimer();\n      pendingVisitTimerRef.current = setTimeout(\n        () => finalizePendingVisit(\"timeout\"),\n        BOARD_CLEAR_GRACE_MS,\n      );\n    },\n    [clearPendingVisitTimer, finalizePendingVisit], // speakAutoVisit removed from deps\n  );\n\n  useEffect(() => {\n    if (!waitForBoardClear) return;\n    const handler = () => finalizePendingVisit(\"event\");\n    window.addEventListener(\"ndn:darts-cleared\", handler as EventListener);\n    return () =>\n      window.removeEventListener(\"ndn:darts-cleared\", handler as EventListener);\n  }, [waitForBoardClear, finalizePendingVisit]);\n\n  useEffect(() => {\n    if (!waitForBoardClear) finalizePendingVisit(\"timeout\");\n  }, [waitForBoardClear, finalizePendingVisit]);\n\n  useEffect(() => () => clearPendingVisitTimer(), [clearPendingVisitTimer]);\n\n  useEffect(() => {\n    if (playerVisitDarts === 0) {\n      try {\n        window.dispatchEvent(\n          new CustomEvent(\"ndn:darts-cleared\", {\n            detail: { source: \"offline-play\", ts: Date.now() },\n          }),\n        );\n      } catch {}\n      lastBounceMissTsRef.current = 0;\n    }\n    lastVisitDartsRef.current = playerVisitDarts;\n  }, [playerVisitDarts]);\n\n  const humanName = getPreferredUserName(user, \"Player 1\");\n  const aiDisplayName = ai === \"None\" ? \"Player 2\" : ai;\n  const currentThrowerName = isPlayerTurn ? humanName : aiDisplayName;\n  const opponentName = isPlayerTurn ? aiDisplayName : humanName;\n  const currentThrowerLegs = isPlayerTurn ? playerLegs : aiLegs;\n  const opponentLegs = isPlayerTurn ? aiLegs : playerLegs;\n\n  // Call all game stat hooks unconditionally at component level (React hooks rules)\n  const statsX01 = useOfflineGameStats(\n    \"X01\" as any,\n    playerScore,\n    aiScore,\n    playerLegs,\n    aiLegs,\n    playerLastDart,\n    aiLastDart,\n    playerVisitSum,\n    aiVisitSum,\n    playerLastVisitScore,\n    aiLastVisitScore,\n    playerVisitDarts,\n    aiVisitDarts,\n    playerDoublesHit,\n    playerDoublesAtt,\n    aiDoublesHit,\n    aiDoublesAtt,\n    legStats,\n    isPlayerTurn,\n    ai,\n    x01Score,\n  );\n  const statsCricket = useOfflineGameStats(\n    \"Cricket\" as any,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    cricket,\n  );\n  const statsShanghai = useOfflineGameStats(\n    \"Shanghai\" as any,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    isPlayerTurn,\n    ai,\n    undefined,\n    cricket,\n    shanghai,\n  );\n  const statsKiller = useOfflineGameStats(\n    \"Killer\" as any,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    undefined,\n    killerPlayers,\n    killerStates,\n    killerAssigned,\n    killerTurnIdx,\n  );\n  const statsScam = useOfflineGameStats(\"Scam\" as any);\n  const statsFives = useOfflineGameStats(\"Fives\" as any);\n  const statsSevens = useOfflineGameStats(\"Sevens\" as any);\n\n  const scoreboardPlayers = useMemo(() => {\n    switch (selectedMode) {\n      case \"Cricket\":\n        return statsCricket;\n      case \"Shanghai\":\n        return statsShanghai;\n      case \"Killer\":\n        return statsKiller;\n      case \"Scam\":\n        return statsScam;\n      case \"Fives\":\n        return statsFives;\n      case \"Sevens\":\n        return statsSevens;\n      default:\n        return statsX01;\n    }\n  }, [\n    selectedMode,\n    statsCricket,\n    statsShanghai,\n    statsKiller,\n    statsScam,\n    statsFives,\n    statsSevens,\n    statsX01,\n  ]);\n  const scoreboardMatchScore =\n    selectedMode === \"X01\" ? `${playerLegs}-${aiLegs}` : undefined;\n\n  const activeScoreboardStats = useMemo(() => {\n    const list = statsX01 || [];\n    const playerResolvedLastScore =\n      playerVisitDarts > 0\n        ? playerVisitSum\n        : (playerLastVisitScore ?? playerLastDart);\n    const aiResolvedLastScore =\n      aiVisitDarts > 0 ? aiVisitSum : (aiLastVisitScore ?? aiLastDart);\n    if (list.length === 0) {\n      return {\n        name: isPlayerTurn ? humanName : aiDisplayName,\n        isCurrentTurn: true,\n        legsWon: isPlayerTurn ? playerLegs : aiLegs,\n        score: isPlayerTurn ? playerScore : aiScore,\n        lastScore: isPlayerTurn ? playerResolvedLastScore : aiResolvedLastScore,\n      } as PlayerStats;\n    }\n    return list.find((player) => player.isCurrentTurn) ?? list[0];\n  }, [\n    statsX01,\n    isPlayerTurn,\n    humanName,\n    aiDisplayName,\n    playerLegs,\n    aiLegs,\n    playerScore,\n    aiScore,\n    playerVisitDarts,\n    playerVisitSum,\n    playerLastVisitScore,\n    playerLastDart,\n    aiVisitSum,\n    aiLastVisitScore,\n    aiLastDart,\n    aiVisitDarts,\n  ]);\n\n  const singlePlayerScoreboard: PlayerStats[] = useMemo(() => {\n    if (!activeScoreboardStats) return [];\n    const {\n      matchAvg: _matchAvg,\n      allTimeAvg: _allTimeAvg,\n      ...rest\n    } = activeScoreboardStats;\n    return [\n      { ...rest, matchAvg: undefined, allTimeAvg: undefined } as PlayerStats,\n    ];\n  }, [activeScoreboardStats]);\n\n  const inactivePlayerName = isPlayerTurn ? aiDisplayName : humanName;\n  const activePlayerName =\n    activeScoreboardStats?.name ?? (isPlayerTurn ? humanName : aiDisplayName);\n  const activeRemaining = isPlayerTurn ? playerScore : aiScore;\n  const activeLastScore = isPlayerTurn\n    ? playerVisitDarts > 0\n      ? playerVisitSum\n      : (playerLastVisitScore ?? playerLastDart)\n    : aiVisitDarts > 0\n      ? aiVisitSum\n      : (aiLastVisitScore ?? aiLastDart);\n\n  // Compute live running 3-dart average including the current visit (per-throw live update)\n  const currentPlayer = match.players?.[match.currentPlayerIdx];\n  let totalScored = 0;\n  let totalDarts = 0;\n  if (currentPlayer && currentPlayer.legs && currentPlayer.legs.length > 0) {\n    for (const leg of currentPlayer.legs) {\n      if (Array.isArray(leg.visits)) {\n        for (const v of leg.visits) {\n          totalScored += v.score || 0;\n          totalDarts += v.darts || 0;\n        }\n      }\n    }\n  }\n  const runningScored = totalScored + (playerVisitSum || 0);\n  const runningDarts = totalDarts + (playerVisitDarts || 0);\n  const _runningAvg = runningDarts > 0 ? (runningScored / runningDarts) * 3 : 0;\n\n  const formatDartCount = useCallback((count: number) => {\n    const safe = Math.max(0, Math.min(99, Math.round(count || 0)));\n    return safe.toString();\n  }, []);\n\n  const recordDart = useCallback((mode: string, count = 1) => {\n    if (!mode || count <= 0) return;\n    setDartCounts((prev) => ({\n      ...prev,\n      [mode]: (prev[mode] || 0) + count,\n    }));\n  }, []);\n\n  const resetDartCount = useCallback((mode: string) => {\n    if (!mode) return;\n    setDartCounts((prev) => {\n      if (prev[mode] === undefined) return prev;\n      return { ...prev, [mode]: 0 };\n    });\n  }, []);\n\n  const _activeModeDarts = dartCounts[selectedMode] || 0;\n\n  const parseManualScoreOverride = (value: string): number | null => {\n    if (!value.trim()) return null;\n    const parsed = Number(value);\n    if (!Number.isFinite(parsed)) return null;\n    return clamp(Math.round(parsed), 0, x01Score);\n  };\n\n  const parseManualLegsOverride = (value: string): number | null => {\n    if (!value.trim()) return null;\n    const parsed = Number(value);\n    if (!Number.isFinite(parsed)) return null;\n    return Math.max(0, Math.round(parsed));\n  };\n\n  const cancelPendingAutoVisit = useCallback(() => {\n    if (pendingVisitRef.current) {\n      pendingVisitRef.current = null;\n    }\n    clearPendingVisitTimer();\n    setAwaitingBoardClear(false);\n  }, [clearPendingVisitTimer]);\n\n  const applyPlayerScoreOverride = useCallback(\n    (nextScore: number) => {\n      const safeScore = clamp(nextScore, 0, x01Score);\n      cancelPendingAutoVisit();\n      setPlayerScore(safeScore);\n      playerScoreRef.current = safeScore;\n\n      const nextVisitStart = safeScore === 0 ? x01Score : safeScore;\n      setPlayerVisitStart(nextVisitStart);\n      playerVisitStartRef.current = nextVisitStart;\n\n      setPlayerVisitSum(0);\n      playerVisitSumRef.current = 0;\n      setPlayerVisitDarts(0);\n      playerVisitDartsRef.current = 0;\n      setPlayerVisitDartsAtDouble(0);\n      playerVisitDartsAtDoubleRef.current = 0;\n\n      setPlayerLastVisitScore(null);\n      setPlayerLastDart(0);\n      setPlayerDartPoints(0);\n      lastBounceMissTsRef.current = 0;\n\n      if (safeScore === 0) {\n        setPendingLegWinner(\"player\");\n        setShowWinPopup(true);\n      } else {\n        setPendingLegWinner(null);\n        setShowWinPopup(false);\n      }\n    },\n    [\n      cancelPendingAutoVisit,\n      setPlayerScore,\n      x01Score,\n      setPlayerVisitStart,\n      setPlayerVisitSum,\n      setPlayerVisitDarts,\n      setPlayerVisitDartsAtDouble,\n      setPlayerLastVisitScore,\n      setPlayerLastDart,\n      setPlayerDartPoints,\n      setPendingLegWinner,\n      setShowWinPopup,\n    ],\n  );\n\n  const handleManualScoreOverride = (target: \"player\" | \"ai\") => {\n    const source =\n      target === \"player\" ? manualPlayerScoreInput : manualOpponentScoreInput;\n    const parsed = parseManualScoreOverride(source);\n    if (parsed === null) {\n      toast(`Enter a number between 0 and ${x01Score}`, {\n        type: \"error\",\n        timeout: 2500,\n      });\n      return;\n    }\n    if (target === \"player\") {\n      applyPlayerScoreOverride(parsed);\n      setManualPlayerScoreInput(\"\");\n      return;\n    } else {\n      setAiScore(parsed);\n      setAiVisitSum(0);\n      setAiVisitDarts(0);\n      setAiLastVisitScore(null);\n      setAiVisitDartsAtDouble(0);\n      setAiLastDart(0);\n      setManualOpponentScoreInput(\"\");\n    }\n    setPendingLegWinner(null);\n    setShowWinPopup(false);\n  };\n\n  const applyManualLegOverride = useCallback(\n    (target: \"player\" | \"ai\", value: number) => {\n      if (target === \"player\") {\n        setPlayerLegs(value);\n        setManualPlayerLegsInput(\"\");\n      } else {\n        setAiLegs(value);\n        setManualOpponentLegsInput(\"\");\n      }\n      setPendingLegWinner(null);\n      setShowWinPopup(false);\n    },\n    [\n      setAiLegs,\n      setManualOpponentLegsInput,\n      setManualPlayerLegsInput,\n      setPendingLegWinner,\n      setPlayerLegs,\n      setShowWinPopup,\n    ],\n  );\n\n  const handleManualLegsOverride = (target: \"player\" | \"ai\") => {\n    const source =\n      target === \"player\" ? manualPlayerLegsInput : manualOpponentLegsInput;\n    const parsed = parseManualLegsOverride(source);\n    if (parsed === null) {\n      toast(\"Enter a non-negative whole number for legs\", {\n        type: \"error\",\n        timeout: 2500,\n      });\n      return;\n    }\n    setLegOverrideConfirm({ target, value: parsed, stage: 1 });\n  };\n\n  const handleLegOverrideYes = useCallback(() => {\n    setLegOverrideConfirm((prev) => {\n      if (!prev) return prev;\n      if (prev.stage === 1) return { ...prev, stage: 2 };\n      applyManualLegOverride(prev.target, prev.value);\n      return null;\n    });\n  }, [applyManualLegOverride]);\n\n  const handleLegOverrideNo = useCallback(() => {\n    setLegOverrideConfirm(null);\n  }, []);\n\n  useEffect(() => {\n    if (!legOverrideConfirm) return;\n    const handleKey = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") {\n        event.preventDefault();\n        handleLegOverrideNo();\n      }\n    };\n    window.addEventListener(\"keydown\", handleKey);\n    return () => window.removeEventListener(\"keydown\", handleKey);\n  }, [handleLegOverrideNo, legOverrideConfirm]);\n\n  // Button size classes for toolbar buttons\n  const getButtonSizeClasses = (size: string) => {\n    switch (size) {\n      case \"small\":\n        return \"px-1.5 py-0.5 text-xs\";\n      case \"large\":\n        return \"px-3 py-1 text-sm\";\n      default:\n        return \"px-2 py-0.5 text-sm\";\n    }\n  };\n  const buttonSizeClass = getButtonSizeClasses(textSize);\n  // Fit-all scaling measurement\n  const scrollerRef = useRef<HTMLDivElement | null>(null);\n  const contentRef = useRef<HTMLDivElement | null>(null);\n  const headerBarRef = useRef<HTMLDivElement | null>(null);\n  // Match format controls (offline only): First to N or Best of N with editable count\n  const [formatType, setFormatType] = useState<\"first\" | \"best\">(\"first\");\n  const [formatCount, setFormatCount] = useState<number>(1);\n  const formatRef = useRef<HTMLDivElement | null>(null);\n  // Keep internal required wins (firstTo) in sync with format selection\n  useEffect(() => {\n    const n = Math.max(1, Math.floor(Number(formatCount) || 1));\n    const wins = formatType === \"first\" ? n : Math.max(1, Math.ceil(n / 2));\n    setFirstTo(wins);\n  }, [formatType, formatCount]);\n  useEffect(() => {\n    if (!fitAll) {\n      setFitScale(1);\n      setFitOverflowing(false);\n      return;\n    }\n    const measure = () => {\n      const scroller = scrollerRef.current;\n      const content = contentRef.current;\n      if (!scroller || !content) return;\n      // Available size excludes the sticky header inside the scroller\n      const headerH = headerBarRef.current\n        ? headerBarRef.current.getBoundingClientRect().height\n        : 0;\n      const availH = Math.max(0, scroller.clientHeight - headerH - 6); // small breathing room\n      const availW = Math.max(0, scroller.clientWidth - 8);\n      // Measure the content size without scale\n      const rect = content.getBoundingClientRect();\n      const currentScale = fitScale || 1;\n      const naturalHeight = rect.height / currentScale;\n      const naturalWidth = rect.width / currentScale;\n      // Compute scale to fit both height and width\n      const scaleH = availH > 0 ? availH / naturalHeight : 1;\n      const scaleW = availW > 0 ? availW / naturalWidth : 1;\n      const next = Math.min(1, Math.max(0.5, Math.min(scaleH, scaleW)));\n      const scaledHeight = naturalHeight * next;\n      const overflowing = availH > 0 && scaledHeight - availH > 1;\n      setFitOverflowing(overflowing);\n      setFitScale(next);\n    };\n    measure();\n    const RO: any = (window as any).ResizeObserver;\n    const ro = RO ? new RO(() => measure()) : null;\n    ro && scrollerRef.current && ro.observe(scrollerRef.current as any);\n    ro && contentRef.current && ro.observe(contentRef.current as any);\n    window.addEventListener(\"resize\", measure);\n    return () => {\n      window.removeEventListener(\"resize\", measure);\n      try {\n        ro && scrollerRef.current && ro.unobserve(scrollerRef.current as any);\n      } catch {}\n      try {\n        ro && contentRef.current && ro.unobserve(contentRef.current as any);\n      } catch {}\n    };\n  }, [fitAll, fitScale]);\n\n  // Auto-start handler (from Home or other tabs)\n  useEffect(() => {\n    const onAuto = (e: any) => {\n      const m = e?.detail?.mode as string | undefined;\n      if (!m) return;\n      setSelectedMode(m);\n      // For Double Practice we could load a specific flow. For now, we just open the X01-like modal with immediate start.\n      startMatch();\n    };\n    window.addEventListener(\"ndn:auto-start\", onAuto as any);\n    return () => window.removeEventListener(\"ndn:auto-start\", onAuto as any);\n  }, []);\n\n  // Accept demo parameters to preconfigure format and starting score before auto-start\n  useEffect(() => {\n    const onFmt = (e: any) => {\n      const t = e?.detail?.formatType;\n      const c = e?.detail?.formatCount;\n      const s = e?.detail?.startScore;\n      if (t === \"first\" || t === \"best\") setFormatType(t);\n      if (typeof c === \"number\" && isFinite(c))\n        setFormatCount(Math.max(1, Math.floor(c)));\n      if (typeof s === \"number\" && isFinite(s))\n        setX01Score(Math.max(1, Math.floor(s)));\n    };\n    window.addEventListener(\"ndn:offline-format\", onFmt as any);\n    return () => window.removeEventListener(\"ndn:offline-format\", onFmt as any);\n  }, []);\n\n  // Auto-start last offline match when opening this tab, if enabled\n  useEffect(() => {\n    if (!autoStartOffline) return;\n    // Kick off a match after initial render for a smooth modal open\n    const id = setTimeout(() => startMatch(), 50);\n    return () => clearTimeout(id);\n  }, [autoStartOffline]);\n\n  // Drive AI countdown and perform AI visit when countdown elapses\n  useEffect(() => {\n    if (!showMatchModal || isPlayerTurn || ai === \"None\" || aiCountdownMs <= 0)\n      return;\n    let raf: number;\n    let last = performance.now();\n    const tick = (now: number) => {\n      const dt = now - last;\n      last = now;\n      setAiCountdownMs((prev) => {\n        const next = prev - dt;\n        if (next <= 0) {\n          // Execute AI visit per dart (up to 3 darts or until finish/bust)\n          let visitDarts = 0;\n          let visitTotal = 0;\n          let remaining = aiScore;\n          setAiVisitDarts(0);\n          while (visitDarts < 3 && remaining > 0) {\n            const targetVisit = aiVisitScore(remaining, ai);\n            // break target into up to 3 darts (roughly 20 per dart for easy split)\n            const dart = clamp(\n              targetVisit - visitDarts * 20,\n              0,\n              Math.min(60, remaining),\n            );\n            const after = remaining - dart;\n            setAiLastDart(dart);\n            setAiDartsThrown((d) => d + 1);\n            setTotalAiDarts((d) => d + 1);\n            if (after < 0) {\n              // bust: revert to remaining before visit\n              remaining = aiScore;\n              setAiVisitSum(0);\n              setAiVisitDartsAtDouble(0);\n              visitTotal = 0;\n              setAiLastVisitScore(0);\n              setAiVisitDarts(0);\n              break;\n            }\n            // Only add points after confirming not a bust\n            visitTotal += dart;\n            setAiVisitSum((s) => s + dart);\n            setTotalAiPoints((p) => p + dart);\n            // Track darts at double window\n            const preRem = remaining;\n            const postRem = after;\n            if (preRem > 50 && postRem <= 50) setAiVisitDartsAtDouble(1);\n            else if (preRem <= 50) setAiVisitDartsAtDouble((c) => c + 1);\n            remaining = after;\n            visitDarts += 1;\n            setAiVisitDarts(visitDarts);\n            if (remaining === 0) break;\n          }\n          setAiScore(remaining);\n          if (remaining === 0) {\n            // Power score classification\n            if (visitTotal === 180) setAi180s((n) => n + 1);\n            else if (visitTotal >= 140) setAi140s((n) => n + 1);\n            else if (visitTotal >= 100) setAi100s((n) => n + 1);\n            // Highest checkout\n            const checkout = aiScore;\n            if (checkout <= 170)\n              setAiHighestCheckout((h) => Math.max(h, checkout));\n            // Doubles attempts/hit if finished from <= 50\n            if (aiScore <= 50) {\n              setAiDoublesAtt(\n                (a) =>\n                  a + (aiVisitDartsAtDouble > 0 ? aiVisitDartsAtDouble : 1),\n              );\n              setAiDoublesHit((h) => h + 1);\n            }\n            setAiLastVisitScore(visitTotal);\n            setAiVisitSum(0);\n            setAiVisitDartsAtDouble(0);\n            setAiVisitDarts(0);\n            // AI won the leg\n            setPendingLegWinner(\"ai\");\n            setShowWinPopup(true);\n          }\n          // If AI did not finish, but threw 3 darts this visit, classify power score and reset visit sum\n          if (remaining > 0 && visitDarts >= 3) {\n            if (visitTotal === 180) setAi180s((n) => n + 1);\n            else if (visitTotal >= 140) setAi140s((n) => n + 1);\n            else if (visitTotal >= 100) setAi100s((n) => n + 1);\n            setAiLastVisitScore(visitTotal);\n            setAiVisitSum(0);\n            setAiVisitDartsAtDouble(0);\n            setAiVisitDarts(0);\n          }\n          // Hand turn back to player\n          setAiVisitDarts(0);\n          setIsPlayerTurn(true);\n          return 0;\n        }\n        return next;\n      });\n      raf = requestAnimationFrame(tick);\n    };\n    raf = requestAnimationFrame(tick);\n    return () => cancelAnimationFrame(raf);\n  }, [showMatchModal, isPlayerTurn, ai, aiScore]);\n\n  useEffect(() => {\n    if (!match.inProgress) return;\n    if (startedShowcasedRef.current) return;\n    setShowStartShowcase(true);\n    startedShowcasedRef.current = true;\n  }, [match.inProgress]);\n\n  function startMatch() {\n    setInMatch(true);\n    setPlayerScore(x01Score);\n    playerScoreRef.current = x01Score;\n    setAiScore(x01Score);\n    setOnDouble(false);\n    setShowMatchModal(true);\n    setIsPlayerTurn(true);\n    setPlayerDartPoints(0);\n    setPlayerDartsThrown(0);\n    setPlayerLastDart(0);\n    setPlayerVisitDarts(0);\n    playerVisitDartsRef.current = 0;\n    setPlayerVisitStart(x01Score);\n    setPlayerVisitSum(0);\n    setPlayerLastVisitScore(null);\n    setPlayerVisitDartsAtDouble(0);\n    setAiCountdownMs(0);\n    setAiDartsThrown(0);\n    setAiLastDart(0);\n    setAiVisitSum(0);\n    setAiVisitDarts(0);\n    setAiLastVisitScore(null);\n    setPendingLegWinner(null);\n    // When starting a brand-new match from menu, reset legs\n    setPlayerLegs(0);\n    setAiLegs(0);\n    setLegStats([]);\n    // Reset Treble Practice session state when starting a new match\n    setTrebleHits(0);\n    setTrebleDarts(0);\n    setTrebleFinished(false);\n    // Reset match-long totals\n    setTotalPlayerDarts(0);\n    setTotalAiDarts(0);\n    setTotalPlayerPoints(0);\n    setTotalAiPoints(0);\n    setPlayer180s(0);\n    setPlayer140s(0);\n    setPlayer100s(0);\n    setAi180s(0);\n    setAi140s(0);\n    setAi100s(0);\n    setPlayerHighestCheckout(0);\n    setAiHighestCheckout(0);\n    setPlayerDoublesAtt(0);\n    setPlayerDoublesHit(0);\n    setAiDoublesAtt(0);\n    setAiDoublesHit(0);\n    resetDartCount(\"X01\");\n    // Sync required wins from current format selection\n    const n = Math.max(1, Math.floor(Number(formatCount) || 1));\n    setFirstTo(formatType === \"first\" ? n : Math.max(1, Math.ceil(n / 2)));\n    if (rememberLastOffline) {\n      try {\n        setLastOffline({\n          mode: selectedMode,\n          x01Start: x01Score,\n          firstTo,\n          aiLevel: ai,\n        });\n      } catch {}\n    }\n    // Initialize the global match store for live 3-dart averages and stats tracking\n    const humanName = getPreferredUserName(user, \"You\");\n    // If AI is enabled, always initialize a 2-player match so the scoreboard\n    // can render both the human and the AI bot.\n    const aiName = ai !== \"None\" ? `AI (${ai})` : \"Opponent\";\n    const players = [humanName, aiName];\n    match.newMatch(players, x01Score, `offline-${Date.now()}`);\n\n    // Keep matches in the current window (disable match pop-out).\n    // Request fullscreen instead (best effort; browsers require a user gesture).\n    try {\n      const el = document.documentElement as any;\n      if (el?.requestFullscreen) {\n        void el.requestFullscreen();\n      } else if ((document as any).body?.requestFullscreen) {\n        void (document as any).body.requestFullscreen();\n      }\n    } catch {}\n  }\n\n  function startNextLeg() {\n    setPlayerScore(x01Score);\n    playerScoreRef.current = x01Score;\n    setAiScore(x01Score);\n    setOnDouble(false);\n    setCheckoutPrompt(null);\n    setCheckoutPopupOpen(false);\n    setShowMatchModal(true);\n    setIsPlayerTurn(true);\n    setPlayerDartPoints(0);\n    setPlayerDartsThrown(0);\n    setPlayerLastDart(0);\n    setPlayerVisitDarts(0);\n    playerVisitDartsRef.current = 0;\n    setPlayerVisitStart(x01Score);\n    setPlayerVisitSum(0);\n    playerVisitStartRef.current = x01Score;\n    playerVisitSumRef.current = 0;\n    setPlayerLastVisitScore(null);\n    setPlayerVisitDartsAtDouble(0);\n    playerVisitDartsAtDoubleRef.current = 0;\n    playerVisitDartsAtDoubleRef.current = 0;\n    setAiCountdownMs(0);\n    setAiDartsThrown(0);\n    setAiLastDart(0);\n    setAiVisitSum(0);\n    setAiVisitDarts(0);\n    setAiLastVisitScore(null);\n    setPendingLegWinner(null);\n  }\n\n  // --- Offline per-dart helpers ---\n  function endTurn(nextRemaining: number) {\n    updateCheckoutPrompt(nextRemaining);\n    setPlayerVisitDarts(0);\n    playerVisitDartsRef.current = 0;\n    setPlayerVisitStart(nextRemaining === 0 ? x01Score : nextRemaining);\n    playerVisitStartRef.current =\n      nextRemaining === 0 ? x01Score : nextRemaining;\n    setPlayerVisitDartsAtDouble(0);\n    playerVisitDartsAtDoubleRef.current = 0;\n    if (ai !== \"None\") {\n      setIsPlayerTurn(false);\n      setAiCountdownMs(aiDelayMs);\n    } else {\n      setAiCountdownMs(0);\n      setIsPlayerTurn(true);\n    }\n  }\n\n  function applyDartValue(dart: number) {\n    if (waitForBoardClear && pendingVisitRef.current) {\n      if (!awaitingBoardClear) setAwaitingBoardClear(true);\n      toast(\"Remove your darts before starting the next throw\", {\n        type: \"info\",\n        timeout: 1800,\n      });\n      return;\n    }\n    recordDart(\"X01\");\n    const currentScore = playerScoreRef.current;\n    const currentVisitDarts = playerVisitDartsRef.current;\n    const currentVisitSum = playerVisitSumRef.current;\n    const currentVisitStart = playerVisitStartRef.current;\n    const currentVisitDartsAtDouble = playerVisitDartsAtDoubleRef.current;\n    const remaining = currentScore - dart;\n    const newVisitDarts = currentVisitDarts + 1;\n\n    setPlayerLastDart(dart);\n    setPlayerDartsThrown((d) => d + 1);\n    setTotalPlayerDarts((d) => d + 1);\n\n    if (remaining < 0) {\n      try {\n        const preRemaining = currentScore;\n        const postRemaining = currentVisitStart;\n        useAudit.getState().recordVisit(\"offline-x01\", newVisitDarts, 0, {\n          preRemaining,\n          postRemaining,\n          bust: true,\n          finish: false,\n        });\n      } catch {}\n      setPlayerScore(currentVisitStart);\n      playerScoreRef.current = currentVisitStart;\n\n      if (currentScore <= 50) {\n        const attemptsThisVisit = (currentVisitDartsAtDouble || 0) + 1;\n        setPlayerDoublesAtt((a) => a + attemptsThisVisit);\n      }\n\n      if (callerEnabled) {\n        try {\n          sayScore(\n            getPreferredUserName(user, \"Player\"),\n            0,\n            Math.max(currentVisitStart, 0),\n            callerVoice,\n            { volume: callerVolume, checkoutOnly: speakCheckoutOnly },\n          );\n        } catch {}\n      }\n\n      setPlayerLastVisitScore(0);\n      setPlayerDartPoints(0);\n      setPlayerVisitSum(0);\n      playerVisitSumRef.current = 0;\n      setPlayerVisitDartsAtDouble(0);\n      playerVisitDartsAtDoubleRef.current = 0;\n      endTurn(currentVisitStart);\n      return;\n    }\n\n    setPlayerScore(remaining);\n    playerScoreRef.current = remaining;\n\n    setPlayerVisitDarts(newVisitDarts);\n    playerVisitDartsRef.current = newVisitDarts;\n    const newVisitSum = currentVisitSum + dart;\n    setPlayerVisitSum(newVisitSum);\n    playerVisitSumRef.current = newVisitSum;\n\n    setTotalPlayerPoints((p) => p + dart);\n    setPlayerDartPoints(0);\n\n    const preRemaining = currentScore;\n    const postRemaining = remaining;\n    const startedDoubleWindow = preRemaining > 50 && postRemaining <= 50;\n    const stillInDoubleWindow = preRemaining <= 50;\n    if (startedDoubleWindow) {\n      setPlayerVisitDartsAtDouble(1);\n      playerVisitDartsAtDoubleRef.current = 1;\n    } else if (stillInDoubleWindow) {\n      setPlayerVisitDartsAtDouble((c) => c + 1);\n      playerVisitDartsAtDoubleRef.current =\n        (currentVisitDartsAtDouble || 0) + 1;\n    }\n\n    const doubleAttemptsNow = playerVisitDartsAtDoubleRef.current || 0;\n    const inDoubleWindow = preRemaining <= 50;\n    const attemptsForVisit = inDoubleWindow\n      ? Math.max(doubleAttemptsNow, Math.min(newVisitDarts, 3))\n      : 0;\n\n    if (remaining === 0) {\n      const pending: PendingAutoVisit = {\n        visitTotal: newVisitSum,\n        darts: newVisitDarts,\n        preRemaining: currentScore,\n        remaining: 0,\n        doubleAttempts: attemptsForVisit,\n        finished: true,\n        doubleWindow: inDoubleWindow,\n        highestCheckout: currentVisitStart <= 170 ? currentVisitStart : null,\n      };\n      if (waitForBoardClear) {\n        queuePendingVisit(pending);\n      } else {\n        commitPendingVisit(pending, \"immediate\");\n      }\n      return;\n    }\n\n    if (newVisitDarts >= 3) {\n      const pending: PendingAutoVisit = {\n        visitTotal: newVisitSum,\n        darts: newVisitDarts,\n        preRemaining: currentScore,\n        remaining,\n        doubleAttempts: attemptsForVisit,\n        finished: false,\n        doubleWindow: inDoubleWindow,\n        highestCheckout: null,\n      };\n      if (waitForBoardClear) {\n        queuePendingVisit(pending);\n      } else {\n        commitPendingVisit(pending, \"immediate\");\n      }\n      return;\n    }\n  }\n\n  function addDartNumeric() {\n    const dart = clamp(Math.round(Number(playerDartPoints) || 0), 0, 60);\n    applyDartValue(dart);\n  }\n\n  function commitManualVisitTotal(rawTotal: number): boolean {\n    if (!Number.isFinite(rawTotal)) return false;\n\n    const visitStart = playerVisitStartRef.current;\n    const liveScore = playerScoreRef.current;\n    const existingDarts = playerVisitDartsRef.current;\n    const existingSum = playerVisitSumRef.current;\n    const hadPartialVisit = existingDarts > 0 || existingSum > 0;\n\n    if (hadPartialVisit) {\n      setPlayerScore(visitStart);\n      playerScoreRef.current = visitStart;\n      setPlayerVisitDarts(0);\n      playerVisitDartsRef.current = 0;\n      setPlayerVisitSum(0);\n      playerVisitSumRef.current = 0;\n      setPlayerVisitDartsAtDouble(0);\n      playerVisitDartsAtDoubleRef.current = 0;\n      setPlayerLastDart(0);\n      setPlayerDartPoints(0);\n      setPlayerDartsThrown((d) => Math.max(0, d - existingDarts));\n      setTotalPlayerDarts((d) => Math.max(0, d - existingDarts));\n      setTotalPlayerPoints((p) => Math.max(0, p - existingSum));\n      lastBounceMissTsRef.current = 0;\n    }\n\n    const preRemaining = hadPartialVisit ? visitStart : liveScore;\n    const checkoutCap = preRemaining <= 170 ? 170 : 180;\n    const total = clamp(Math.round(rawTotal), 0, checkoutCap);\n    const remaining = preRemaining - total;\n    const checkoutDartsUsed = clamp(Math.round(checkoutDarts || 0), 0, 3);\n    const doubleDartsUsed = clamp(Math.round(doubleDarts || 0), 0, 3);\n    const visitDarts = remaining === 0 ? checkoutDartsUsed : 3;\n\n    recordDart(\"X01\", visitDarts);\n    setPlayerDartsThrown((d) => d + visitDarts);\n    setTotalPlayerDarts((d) => d + visitDarts);\n    setPlayerVisitDarts(visitDarts);\n    playerVisitDartsRef.current = visitDarts;\n    setPlayerVisitSum(total);\n    playerVisitSumRef.current = total;\n    setPlayerLastVisitScore(total);\n\n    if (total === 180) setPlayer180s((n) => n + 1);\n    else if (total >= 140) setPlayer140s((n) => n + 1);\n    else if (total >= 100) setPlayer100s((n) => n + 1);\n\n    if (remaining < 0) {\n      if (callerEnabled) {\n        try {\n          sayScore(humanName, 0, Math.max(visitStart, 0), callerVoice, {\n            volume: callerVolume,\n            checkoutOnly: speakCheckoutOnly,\n          });\n        } catch {}\n      }\n      try {\n        useAudit.getState().recordVisit(\"offline-x01\", visitDarts, 0, {\n          preRemaining,\n          postRemaining: visitStart,\n          bust: true,\n          finish: false,\n        });\n      } catch {}\n      setPlayerScore(visitStart);\n      playerScoreRef.current = visitStart;\n      setPlayerLastVisitScore(0);\n      setPlayerVisitSum(0);\n      playerVisitSumRef.current = 0;\n      setPlayerVisitDarts(0);\n      playerVisitDartsRef.current = 0;\n      setPlayerVisitDartsAtDouble(0);\n      playerVisitDartsAtDoubleRef.current = 0;\n      // Update global match state so live averages and stats update\n      try {\n        match.addVisit(0, visitDarts);\n      } catch {}\n      endTurn(visitStart);\n      return true;\n    }\n\n    setPlayerScore(remaining);\n    playerScoreRef.current = remaining;\n    setTotalPlayerPoints((p) => p + total);\n\n    if (callerEnabled) {\n      try {\n        sayScore(humanName, total, Math.max(remaining, 0), callerVoice, {\n          volume: callerVolume,\n          checkoutOnly: speakCheckoutOnly,\n        });\n      } catch {}\n    }\n\n    if (remaining === 0) {\n      setPlayerDoublesAtt((a) => a + doubleDartsUsed);\n      setPlayerDoublesHit((h) => h + 1);\n      setPlayerVisitDartsAtDouble(doubleDartsUsed);\n      playerVisitDartsAtDoubleRef.current = doubleDartsUsed;\n    } else if (preRemaining <= 50) {\n      setPlayerDoublesAtt((a) => a + 3);\n    }\n\n    if (remaining === 0) {\n      if (preRemaining <= 170)\n        setPlayerHighestCheckout((h) => Math.max(h, preRemaining));\n      setCheckoutPrompt(null);\n      setCheckoutPopupOpen(false);\n      try {\n        useAudit.getState().recordVisit(\"offline-x01\", visitDarts, total, {\n          preRemaining,\n          postRemaining: 0,\n          finish: true,\n          bust: false,\n        });\n      } catch {}\n      // Update global match state for finish\n      try {\n        match.addVisit(total, visitDarts);\n        match.endLeg(preRemaining);\n      } catch {}\n      setPendingLegWinner(\"player\");\n      setShowWinPopup(true);\n      setPlayerVisitDarts(0);\n      playerVisitDartsRef.current = 0;\n      setPlayerVisitSum(0);\n      playerVisitSumRef.current = 0;\n      setPlayerVisitDartsAtDouble(0);\n      playerVisitDartsAtDoubleRef.current = 0;\n      return true;\n    }\n\n    try {\n      useAudit.getState().recordVisit(\"offline-x01\", visitDarts, total, {\n        preRemaining,\n        postRemaining: remaining,\n        finish: false,\n        bust: false,\n      });\n    } catch {}\n    // Update global match state so live averages update after every 3 darts\n    try {\n      match.addVisit(total, visitDarts);\n    } catch {}\n    endTurn(remaining);\n    setPlayerVisitSum(0);\n    playerVisitSumRef.current = 0;\n    setPlayerVisitDarts(0);\n    playerVisitDartsRef.current = 0;\n    setPlayerVisitDartsAtDouble(0);\n    playerVisitDartsAtDoubleRef.current = 0;\n    return true;\n  }\n\n  // Once local commit and endTurn functions are defined, create the unified offline actions wrapper\n  const matchActions: UnifiedMatchActions = createOfflineMatchActions({\n    match,\n    commitManualVisitTotal,\n    endTurn,\n  });\n\n  // Optional: Add a full-visit total (0-180) input for quick entry like \"93\"\n  const [visitTotalInput, setVisitTotalInput] = useState(\"\");\n  const [quickScoreInput, setQuickScoreInput] = useState(\"\");\n  const quickScoreInputRef = useRef<HTMLInputElement | null>(null);\n  const handleVisitTotalChange = (val: string) => {\n    setVisitTotalInput(val);\n  };\n  const addVisitTotal = () => {\n    const val = parseInt(visitTotalInput, 10);\n    if (isNaN(val) || val < 0 || val > 180) {\n      alert(\"Enter a number 0-180 for visit total\");\n      return;\n    }\n    if (val > 180) {\n      alert(\"Enter a number 0-180 for visit total\");\n      return;\n    }\n    const maxAllowed = playerScoreRef.current <= 170 ? 170 : 180;\n    const bounded = clamp(Math.round(val), 0, maxAllowed);\n    if (val > maxAllowed) {\n      toast(`Visit totals cannot exceed ${maxAllowed}.`, {\n        type: \"info\",\n        timeout: 2200,\n      });\n    }\n    if (commitManualVisitTotal(bounded)) {\n      setVisitTotalInput(\"\");\n    }\n  };\n\n  const clearCurrentVisit = useCallback(() => {\n    if (pendingVisitRef.current) {\n      pendingVisitRef.current = null;\n      clearPendingVisitTimer();\n      setAwaitingBoardClear(false);\n    }\n    const visitDarts = playerVisitDartsRef.current;\n    const visitTotal = playerVisitSumRef.current;\n    const visitStart = playerVisitStartRef.current;\n    if (visitDarts === 0 && visitTotal === 0) return;\n    setPlayerScore(visitStart);\n    playerScoreRef.current = visitStart;\n    setPlayerVisitDarts(0);\n    playerVisitDartsRef.current = 0;\n    setPlayerVisitSum(0);\n    playerVisitSumRef.current = 0;\n    setPlayerVisitDartsAtDouble(0);\n    playerVisitDartsAtDoubleRef.current = 0;\n    setPlayerLastDart(0);\n    setPlayerDartPoints(0);\n    setPlayerDartsThrown((d) => Math.max(0, d - visitDarts));\n    setTotalPlayerDarts((d) => Math.max(0, d - visitDarts));\n    setTotalPlayerPoints((p) => Math.max(0, p - visitTotal));\n    lastBounceMissTsRef.current = 0;\n  }, [clearPendingVisitTimer]);\n\n  useEffect(() => {\n    const onClearRequest = (evt: Event) => {\n      const detail = (evt as CustomEvent)?.detail;\n      if (!detail || detail?.source === \"offline-play\") return;\n      clearCurrentVisit();\n    };\n    window.addEventListener(\n      \"ndn:clear-visit-request\",\n      onClearRequest as EventListener,\n    );\n    return () =>\n      window.removeEventListener(\n        \"ndn:clear-visit-request\",\n        onClearRequest as EventListener,\n      );\n  }, [clearCurrentVisit]);\n\n  // --- Double Practice helpers ---\n  function addDpValue(val: number) {\n    recordDart(\"Double Practice\");\n    const dart = clamp(Math.round(val || 0), 0, 60);\n    setPlayerLastDart(dart);\n    setPlayerDartsThrown((d) => d + 1);\n    setTotalPlayerDarts((d) => d + 1);\n    if (isDoubleHit(dart, dpIndex)) {\n      const nextHits = dpHits + 1;\n      setDpHits(nextHits);\n      setDpIndex((i) => Math.min(20, i + 1));\n      // End when DBULL (index 20) is hit\n      if (nextHits >= 21) {\n        setPendingLegWinner(\"player\");\n        setShowWinPopup(true);\n      }\n    }\n    setPlayerDartPoints(0);\n  }\n  function addDpNumeric() {\n    addDpValue(Number(playerDartPoints));\n  }\n  function addDpManual() {\n    const v = parseManualDart(manualBox);\n    if (v == null) {\n      alert(\"Enter like D16, 50, 25, T20\");\n      return;\n    }\n    addDpValue(v);\n    setManualBox(\"\");\n  }\n\n  // Bob's 27\n  function addB27Auto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    if (b27Finished) return false;\n    recordDart(\"Bob's 27\");\n    const target = b27Stage;\n    const hit =\n      (ring === \"DOUBLE\" && sector === target) ||\n      (!ring && value === target * 2);\n    if (hit) setB27Hits((h) => h + 1);\n    setB27Darts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        const totalHits = b27Hits + (hit ? 1 : 0);\n        if (totalHits > 0) setB27Score((s) => s + totalHits * target * 2);\n        else setB27Score((s) => s - target * 2);\n        const next = target + 1;\n        setB27Stage(next);\n        setB27Hits(0);\n        if (next > 20) setB27Finished(true);\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n  function addB27Numeric() {\n    addB27Auto(Math.max(0, playerDartPoints | 0));\n    setPlayerDartPoints(0);\n  }\n  function resetB27() {\n    setB27Stage(1);\n    setB27Score(27);\n    setB27Darts(0);\n    setB27Hits(0);\n    setB27Finished(false);\n    resetDartCount(\"Bob's 27\");\n  }\n\n  // Count-Up / High Score / Low Score\n  function addCountUpAuto(value: number): boolean {\n    recordDart(\"Count-Up\");\n    setCuScore((s) => s + Math.max(0, value | 0));\n    setCuDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        setCuRound((r) => r + 1);\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n  function addHighScoreAuto(value: number): boolean {\n    recordDart(\"High Score\");\n    setHsScore((s) => s + Math.max(0, value | 0));\n    setHsDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        setHsRound((r) => r + 1);\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n  function addLowScoreAuto(value: number): boolean {\n    recordDart(\"Low Score\");\n    setLsScore((s) => s + Math.max(0, value | 0));\n    setLsDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        setLsRound((r) => r + 1);\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n\n  // Checkout routines (double out)\n  function applyCheckout(\n    rem: number,\n    setRem: (n: number) => void,\n    darts: number,\n    setDarts: (f: (n: number) => number) => void,\n    setAttempts: (f: (n: number) => number) => void,\n    setSuccesses: (f: (n: number) => number) => void,\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    dartsUsed = 1,\n  ) {\n    const next = rem - value;\n    if (next < 0) {\n      // bust: ignore progress during attempt\n    } else if (next === 0) {\n      if (ring === \"DOUBLE\" || ring === \"INNER_BULL\") {\n        setSuccesses((s) => s + 1);\n        setAttempts((a) => a + 1);\n        setDarts(() => 0);\n        setRem(rem); // caller will reset to initial value right after\n        return;\n      }\n      setRem(next);\n    } else {\n      setRem(next);\n    }\n    setDarts((d) => {\n      const nd = d + dartsUsed;\n      if (nd >= 3) {\n        setAttempts((a) => a + 1);\n        return nd % 3;\n      }\n      return nd;\n    });\n  }\n  function addCo170Auto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    dartsUsed = 1,\n  ): boolean {\n    recordDart(\"Checkout 170\");\n    applyCheckout(\n      co170Rem,\n      setCo170Rem,\n      co170Darts,\n      setCo170Darts,\n      setCo170Attempts,\n      setCo170Successes,\n      value,\n      ring,\n      dartsUsed,\n    );\n    if (co170Darts + 1 >= 3) setCo170Rem(170);\n    return true;\n  }\n  function addCo121Auto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    dartsUsed = 1,\n  ): boolean {\n    recordDart(\"Checkout 121\");\n    applyCheckout(\n      co121Rem,\n      setCo121Rem,\n      co121Darts,\n      setCo121Darts,\n      setCo121Attempts,\n      setCo121Successes,\n      value,\n      ring,\n      dartsUsed,\n    );\n    if (co121Darts + 1 >= 3) setCo121Rem(121);\n    return true;\n  }\n  function addCoManual(is170: boolean) {\n    const v = parseManualDart(manualBox);\n    if (v == null) {\n      alert(\"Enter like T20, D16, 25, 50\");\n      return;\n    }\n    const t = manualBox.trim().toUpperCase();\n    const isDouble =\n      t.startsWith(\"D\") ||\n      t === \"50\" ||\n      t === \"BULL\" ||\n      t === \"DBULL\" ||\n      t === \"IBULL\" ||\n      t.includes(\"INNER\");\n    if (is170) addCo170Auto(v, isDouble ? \"DOUBLE\" : undefined);\n    else addCo121Auto(v, isDouble ? \"DOUBLE\" : undefined);\n    setManualBox(\"\");\n  }\n  function resetCo170() {\n    setCo170Rem(170);\n    setCo170Darts(0);\n    setCo170Attempts(0);\n    setCo170Successes(0);\n    resetDartCount(\"Checkout 170\");\n  }\n  function resetCo121() {\n    setCo121Rem(121);\n    setCo121Darts(0);\n    setCo121Attempts(0);\n    setCo121Successes(0);\n    resetDartCount(\"Checkout 121\");\n  }\n\n  // Treble practice\n  function addTrebleAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    if (trebleFinished) return false;\n    recordDart(\"Treble Practice\");\n    const isHit =\n      (ring === \"TRIPLE\" && sector === trebleTarget) ||\n      (!ring && value === trebleTarget * 3);\n    if (isHit) setTrebleHits((h) => h + 1);\n    setTrebleDarts((d) => {\n      const nd = d + 1;\n      // Auto-rotate target every 3 darts among T20â†’T19â†’T18\n      if (nd % 3 === 0 && [20, 19, 18].includes(trebleTarget)) {\n        const cycle = [\"T20\", \"T19\", \"T18\"];\n        const idx = cycle.indexOf(`T${trebleTarget}`);\n        const next = cycle[(idx + 1) % cycle.length];\n        setTrebleTarget(Number(next.replace(\"T\", \"\")));\n      }\n      // End session at configured throws\n      if (trebleMaxDarts > 0 && nd >= trebleMaxDarts) setTrebleFinished(true);\n      return nd;\n    });\n    return true;\n  }\n  function resetTreble() {\n    setTrebleHits(0);\n    setTrebleDarts(0);\n    setTrebleFinished(false);\n    resetDartCount(\"Treble Practice\");\n  }\n\n  // Baseball\n  function addBaseballAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Baseball\");\n    setBaseball((prev) => {\n      const cp = { ...prev };\n      applyBaseballDart(cp as any, value, ring as any, sector);\n      return cp;\n    });\n    return true;\n  }\n  function resetBaseball() {\n    setBaseball(createBaseball());\n    resetDartCount(\"Baseball\");\n  }\n\n  // Golf\n  function addGolfAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Golf\");\n    setGolf((prev) => {\n      const cp = { ...prev };\n      applyGolfDart(cp as any, value, ring as any, sector);\n      return cp;\n    });\n    return true;\n  }\n  function resetGolf() {\n    setGolf(createGolf());\n    resetDartCount(\"Golf\");\n  }\n\n  // Tic Tac Toe\n  function addTttAuto(\n    cell: number,\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Tic Tac Toe\");\n    setTTT((prev) => {\n      const cp = { ...prev, board: [...prev.board] as any };\n      tryClaimCell(cp as any, cell as any, value, ring as any, sector);\n      return cp;\n    });\n    return true;\n  }\n  function resetTtt() {\n    setTTT(createTicTacToe());\n    resetDartCount(\"Tic Tac Toe\");\n  }\n\n  // American Cricket\n  function addAmCricketAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"American Cricket\");\n    setAmCricket((prev) => {\n      const cp = { ...prev, marks: { ...prev.marks } };\n      applyAmCricketDart(cp as any, value, ring as any, sector, () => false);\n      return cp;\n    });\n    return true;\n  }\n  function resetAmCricket() {\n    setAmCricket(createAmCricketState());\n    resetDartCount(\"American Cricket\");\n  }\n\n  // --- Around the Clock helpers ---\n  function addAtcValue(\n    val: number,\n    ring?: \"MISS\" | \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Around the Clock\");\n    const target = ATC_ORDER[atcIndex];\n    let hit = false;\n    if (\n      typeof sector === \"number\" &&\n      sector === target &&\n      (ring === \"SINGLE\" || ring === \"DOUBLE\" || ring === \"TRIPLE\")\n    )\n      hit = true;\n    if (target === 25 && (ring === \"BULL\" || val === 25)) hit = true;\n    if (target === 50 && (ring === \"INNER_BULL\" || val === 50)) hit = true;\n    if (!hit) {\n      // Fallback by value only\n      if (val === target || val === target * 2 || val === target * 3)\n        hit = true;\n    }\n    if (hit) {\n      const newHits = atcHits + 1;\n      setAtcHits(newHits);\n      setAtcIndex((i) => i + 1);\n      return true;\n    }\n    return true;\n  }\n  function addAtcNumeric() {\n    addAtcValue(Math.max(0, playerDartPoints | 0));\n    setPlayerDartPoints(0);\n  }\n  function addAtcManual() {\n    const v = parseManualDart(manualBox);\n    if (v == null) {\n      alert(\"Enter like T20, D5, 25, 50\");\n      return;\n    }\n    addAtcValue(v);\n    setManualBox(\"\");\n  }\n\n  // --- Cricket helpers (solo practice) ---\n  function addCricketAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Cricket\");\n    setCricket((prev) => {\n      const copy = { ...prev, marks: { ...prev.marks } };\n      applyCricketDart(copy as any, value, ring, sector, () => false);\n      return copy;\n    });\n    setPracticeTurnDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) return 0;\n      return nd;\n    });\n    return true;\n  }\n  function addCricketNumeric() {\n    addCricketAuto(Math.max(0, playerDartPoints | 0));\n    setPlayerDartPoints(0);\n  }\n\n  // --- Shanghai helpers ---\n  function addShanghaiAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Shanghai\");\n    setShanghai((prev) => {\n      const copy = { ...prev, turnHits: { ...prev.turnHits } };\n      applyShanghaiDart(copy as any, value, ring, sector);\n      return copy;\n    });\n    setPracticeTurnDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        setShanghai((prev) => {\n          const cp = { ...prev, turnHits: { ...prev.turnHits } };\n          endShanghaiTurn(cp as any);\n          return cp;\n        });\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n  function addShanghaiNumeric() {\n    addShanghaiAuto(Math.max(0, playerDartPoints | 0));\n    setPlayerDartPoints(0);\n  }\n\n  // --- Halve It helpers ---\n  function addHalveAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"Halve It\");\n    setHalve((prev) => {\n      const copy = { ...prev, targets: [...prev.targets] };\n      applyHalveItDart(copy as any, value, ring, sector);\n      return copy;\n    });\n    setPracticeTurnDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        setHalve((prev) => {\n          const cp = { ...prev, targets: [...prev.targets] };\n          endHalveItTurn(cp as any);\n          return cp;\n        });\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n  function addHalveNumeric() {\n    addHalveAuto(Math.max(0, playerDartPoints | 0));\n    setPlayerDartPoints(0);\n  }\n\n  // --- High-Low helpers ---\n  function addHighLowAuto(\n    value: number,\n    ring?: \"SINGLE\" | \"DOUBLE\" | \"TRIPLE\" | \"BULL\" | \"INNER_BULL\",\n    sector?: number | null,\n  ): boolean {\n    recordDart(\"High-Low\");\n    setHighlow((prev: any) => {\n      const copy = { ...prev };\n      applyHighLowDart(copy as any, value, ring, sector);\n      return copy;\n    });\n    setPracticeTurnDarts((d) => {\n      const nd = d + 1;\n      if (nd >= 3) {\n        setHighlow((prev: any) => {\n          const cp = { ...prev };\n          endHighLowTurn(cp as any);\n          return cp;\n        });\n        return 0;\n      }\n      return nd;\n    });\n    return true;\n  }\n  function addHighLowNumeric() {\n    addHighLowAuto(Math.max(0, playerDartPoints | 0));\n    setPlayerDartPoints(0);\n  }\n\n  function parseManualBox(): number | null {\n    const t = manualBox.trim().toUpperCase();\n    if (!t) return null;\n    if (t === \"50\" || t === \"BULL\" || t === \"DBULL\" || t === \"IBULL\") return 50;\n    if (t === \"25\" || t === \"OBULL\") return 25;\n    const m = t.match(/^(S|D|T)?\\s*(\\d{1,2})$/);\n    if (!m) return null;\n    const mult = (m[1] || \"S\") as \"S\" | \"D\" | \"T\";\n    const num = parseInt(m[2], 10);\n    if (num < 1 || num > 20) return null;\n    const multVal = mult === \"S\" ? 1 : mult === \"D\" ? 2 : 3;\n    return num * multVal;\n  }\n\n  function addManual() {\n    const val = parseManualBox();\n    if (val == null) {\n      alert(\"Enter like T20, D16, 5, 25, 50\");\n      return;\n    }\n    applyDartValue(val);\n    setManualBox(\"\");\n  }\n\n  function addManualTextarea() {\n    const lines = manualTextarea\n      .trim()\n      .split(\"\\n\")\n      .map((l) => l.trim())\n      .filter((l) => l);\n    if (lines.length === 0) return;\n    for (const line of lines) {\n      const val = parseManualDart(line);\n      if (val == null) {\n        alert(`Invalid score: ${line}`);\n        return;\n      }\n      applyDartValue(val);\n    }\n    setManualTextarea(\"\");\n  }\n\n  function replaceLast() {\n    if (playerVisitDarts === 0) return;\n    // Rewind one dart: approximate by adding back last dart into score\n    setPlayerScore((s) => s + playerLastDart);\n    setPlayerVisitDarts((d) => Math.max(0, d - 1));\n  }\n\n  function replaceLastManual() {\n    const val = parseManualBox();\n    if (val == null) {\n      alert(\"Enter like T20, D16, 5, 25, 50\");\n      return;\n    }\n    if (playerVisitDarts === 0) {\n      addManual();\n      return;\n    }\n    // Rewind last then apply\n    const rewind = playerLastDart;\n    setPlayerScore((s) => s + rewind);\n    setPlayerVisitDarts((d) => Math.max(0, d - 1));\n    // Apply new value in next microtask to ensure state has updated\n    setTimeout(() => applyDartValue(val), 0);\n    setManualBox(\"\");\n  }\n\n  function _playerThrow(points: number) {\n    const newScore = playerScore - points;\n    if (newScore < 0) {\n      setPlayerScore(playerScore); // bust\n      return;\n    }\n    setPlayerScore(newScore);\n    if (newScore === 0) {\n      setPendingLegWinner(\"player\");\n      setShowWinPopup(true);\n    }\n    setOnDouble(newScore <= 40 && newScore % 2 === 0);\n  }\n\n  function _aiTurn() {\n    // This is now automated inside the modal turn loop\n  }\n\n  function _handleBust() {\n    setPlayerScore(playerScore); // bust, score unchanged\n    setOnDouble(false);\n  }\n\n  function handleWinPopupSubmit() {\n    const winner = pendingLegWinner ?? \"player\";\n    // Approximate per-leg doubles attempts: if winner is player and they finished from <=50, attempts were counted in playerVisitDartsAtDouble; otherwise leave undefined\n    const legDoublesAtt =\n      winner === \"player\"\n        ? playerVisitDartsAtDouble || undefined\n        : aiVisitDartsAtDouble || undefined;\n    const legDoublesHit = 1;\n    const winnerDarts = winner === \"player\" ? playerDartsThrown : aiDartsThrown;\n    setLegStats([\n      ...legStats,\n      {\n        winner,\n        doubleDarts,\n        checkoutDarts,\n        winnerDarts,\n        doublesAtt: legDoublesAtt,\n        doublesHit: legDoublesHit,\n      },\n    ]);\n    setShowWinPopup(false);\n    // Increment legs for the winner\n    let p = playerLegs;\n    let a = aiLegs;\n    if (pendingLegWinner === \"player\") p += 1;\n    else if (pendingLegWinner === \"ai\") a += 1;\n    setPlayerLegs(p);\n    setAiLegs(a);\n    setPendingLegWinner(null);\n    // Check if match is over\n    if (p >= firstTo || a >= firstTo) {\n      // End of match: close modal back to menu state\n      // Record per-game-mode result (local-only demo)\n      try {\n        bumpGameMode(selectedMode, winner === \"player\");\n      } catch {}\n      // Persist match stats (all-time / rolling averages)\n      try {\n        match.endGame();\n      } catch {}\n      setShowMatchModal(false);\n      setInMatch(false);\n      // Reset leg-specific stats for next match but keep the summary list visible\n      setPlayerScore(x01Score);\n      setAiScore(x01Score);\n      setShowMatchSummary(true);\n      return;\n    }\n    // Otherwise, start the next leg immediately\n    startNextLeg();\n  }\n\n  const supportsQuickScore = ![\"Killer\", \"Tic Tac Toe\"].includes(\n    selectedMode,\n  );\n  useEffect(() => {\n    if (isMobileScreen || !supportsQuickScore || !showMatchModal) return;\n    quickScoreInputRef.current?.focus();\n  }, [isMobileScreen, supportsQuickScore, showMatchModal, selectedMode]);\n  const commitQuickScore = () => {\n    const parsed = Number(quickScoreInput);\n    if (!Number.isFinite(parsed)) return;\n    const value = Math.max(0, Math.round(parsed));\n\n    switch (selectedMode) {\n      case \"Double Practice\":\n        addDpValue(value);\n        break;\n      case \"Around the Clock\":\n        addAtcValue(value);\n        break;\n      case \"Cricket\":\n        addCricketAuto(value);\n        break;\n      case \"Shanghai\":\n        addShanghaiAuto(value);\n        break;\n      case \"Halve It\":\n        addHalveAuto(value);\n        break;\n      case \"High-Low\":\n        addHighLowAuto(value);\n        break;\n      case \"Bob's 27\":\n        addB27Auto(value);\n        break;\n      case \"Count-Up\":\n        addCountUpAuto(value);\n        break;\n      case \"High Score\":\n        addHighScoreAuto(value);\n        break;\n      case \"Low Score\":\n        addLowScoreAuto(value);\n        break;\n      case \"Checkout 170\":\n        addCo170Auto(value, undefined, 3);\n        break;\n      case \"Checkout 121\":\n        addCo121Auto(value, undefined, 3);\n        break;\n      case \"Treble Practice\":\n        addTrebleAuto(value);\n        break;\n      case \"Baseball\":\n        addBaseballAuto(value);\n        break;\n      case \"Golf\":\n        addGolfAuto(value);\n        break;\n      case \"American Cricket\":\n        addAmCricketAuto(value);\n        break;\n      case \"Scam\":\n        recordDart(\"Scam\");\n        setScamPlayer(addScamNumeric(scamPlayer, value));\n        break;\n      case \"Fives\":\n        recordDart(\"Fives\");\n        setFivesPlayer(addFivesNumeric(fivesPlayer, value));\n        break;\n      case \"Sevens\":\n        recordDart(\"Sevens\");\n        setSevensPlayer(addSevensNumeric(sevensPlayer, value));\n        break;\n      default:\n        return;\n    }\n\n    setQuickScoreInput(\"\");\n  };\n  const isFreeSelected = freeGames.includes(selectedMode as any);\n  const lockedPremium = !isFreeSelected && !(user?.fullAccess || user?.admin);\n\n  // no external overlay: we render the match modal as absolute inset-0 inside this card\n\n  return (\n    <div className={`${inMatch ? '' : 'card '}ndn-game-shell ndn-page relative overflow-hidden md:overflow-hidden overflow-y-auto${inMatch ? ' ndn-ingame-active' : ''}`}>\n      {showStartShowcase && (\n        <MatchStartShowcase\n          players={(match.players || []) as any}\n          user={user}\n          onDone={() => setShowStartShowcase(false)}\n        />\n      )}\n      {!inMatch && (\n      <h2 className=\"text-3xl font-bold text-brand-700 mb-4 ndn-section-title\">\n        Offline Mode ðŸŽ¯{\" \"}\n        {offlineLayout === \"classic\" ? (\n          <span className=\"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle\">\n            Classic layout\n          </span>\n        ) : (\n          <span className=\"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle\">\n            Modern layout\n          </span>\n        )}\n      </h2>\n      )}\n      <div className=\"ndn-shell-body\">\n        <div className=\"mb-4 flex flex-col gap-3\">\n          <select\n            onPointerDown={(e) => {\n              (e as any).stopPropagation();\n            }}\n            onMouseDown={(e) => {\n              e.stopPropagation();\n            }}\n            onTouchStart={(e) => {\n              (e as any).stopPropagation?.();\n            }}\n            className=\"input w-full\"\n            value={selectedMode}\n            onChange={(e) => setSelectedMode(e.target.value)}\n          >\n            {freeGames.map((mode: any) => (\n              <option key={mode} value={mode}>\n                {mode}\n              </option>\n            ))}\n            {premiumGames.map((mode: any) => (\n              <option\n                key={mode}\n                value={mode}\n                disabled={!(user?.fullAccess || user?.admin)}\n              >\n                {mode} {user?.fullAccess || user?.admin ? \"\" : \"(Premium)\"}\n              </option>\n            ))}\n          </select>\n\n          {selectedMode === \"Treble Practice\" ? (\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end\">\n              <div className=\"sm:col-span-1\">\n                <label className=\"font-semibold\">Throws per game</label>\n                <input\n                  className=\"input w-full\"\n                  type=\"number\"\n                  min={3}\n                  step={3}\n                  value={trebleMaxDarts}\n                  onChange={(e) =>\n                    setTrebleMaxDarts(\n                      Math.max(3, Math.floor(Number(e.target.value) || 30)),\n                    )\n                  }\n                />\n              </div>\n\n              <div className=\"sm:col-span-2 text-xs text-slate-300\">\n                Target cycles T20&rarr;T19&rarr;T18 every 3 darts. Game ends after\n                the selected number of throws.\n              </div>\n\n\n            </div>\n          ) : null}\n          {!user?.fullAccess && (\n            <div className=\"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2\">\n              <span>ðŸ”’</span>\n              <span>\n                Only X01 and Double Practice are free. Advanced modes (Killer,\n                Cricket, Shanghai, etc.) require PREMIUM.\n              </span>\n            </div>\n          )}\n          {selectedMode === \"X01\" && (\n            <>\n              <label className=\"font-semibold mt-2\">\n                Enter starting score (1-1001):\n              </label>\n              <input\n                className=\"input w-full\"\n                type=\"number\"\n                min={1}\n                max={1001}\n                value={x01Score}\n                onChange={(e) => setX01Score(Number(e.target.value))}\n              />\n              <label className=\"font-semibold mt-2\">Play against AI bot?</label>\n              <select\n                onPointerDown={(e) => {\n                  (e as any).stopPropagation();\n                }}\n                onMouseDown={(e) => {\n                  e.stopPropagation();\n                }}\n                onTouchStart={(e) => {\n                  (e as any).stopPropagation?.();\n                }}\n                className=\"input w-full\"\n                value={ai}\n                onChange={(e) => setAI(e.target.value)}\n              >\n                <option value=\"None\">None</option>\n                {aiLevels.map((level) => (\n                  <option key={level} value={level}>\n                    {level}\n                  </option>\n                ))}\n              </select>\n              {ai !== \"None\" && (\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2\">\n                  <div className=\"sm:col-span-2\">\n                    <label className=\"font-semibold\">\n                      AI throw delay (seconds)\n                    </label>\n                    <input\n                      className=\"input w-full\"\n                      type=\"number\"\n                      min={0.5}\n                      max={10}\n                      step={0.5}\n                      value={aiDelayMs / 1000}\n                      onChange={(e) =>\n                        setAiDelayMs(Math.round(Number(e.target.value) * 1000))\n                      }\n                    />\n                  </div>\n                  <div className=\"text-sm text-slate-300\">\n                    Controls how long the AI waits before its visit.\n                  </div>\n                </div>\n              )}\n              <button className=\"btn mt-2\" onClick={() => setShowRules(true)}>\n                X01 Rules & Regulations! ðŸ“–\n              </button>\n            </>\n          )}\n          {selectedMode === \"Double Practice\" && (\n            <div className=\"mt-2 text-brand-600\">\n              Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and\n              X01 settings don't apply.\n            </div>\n          )}\n        </div>\n        {!inMatch && (\n          <button\n            className=\"btn\"\n            disabled={lockedPremium}\n            title={lockedPremium ? \"PREMIUM required for this mode\" : \"\"}\n            onClick={startMatch}\n          >\n            Start Match ðŸš€\n          </button>\n        )}\n        {/* Match Modal with turn-by-turn flow */}\n        {showMatchModal && (\n          <div className=\"absolute inset-0 z-[1000]\">\n            <ResizableModal\n              storageKey=\"ndn:modal:offline-match\"\n              className=\"w-full h-full ndn-modal-tight relative flex flex-col overflow-hidden\"\n              fullScreen={true}\n              defaultWidth={1100}\n              defaultHeight={720}\n              minWidth={720}\n              minHeight={480}\n              maxWidth={1600}\n              maxHeight={1200}\n              initialFitHeight\n            >\n              {/* â”€â”€ Pause Glass Overlay â€” blocks all interaction while paused â”€â”€ */}\n              {paused && pauseEndsAt && (() => {\n                const rem = Math.max(0, pauseEndsAt - pauseNow);\n                const mm = Math.floor(rem / 60000).toString().padStart(2, \"0\");\n                const ss = Math.floor((rem % 60000) / 1000).toString().padStart(2, \"0\");\n                const started = useMatchControl.getState().pauseStartedAt ?? pauseNow;\n                const total = Math.max(1, pauseEndsAt - started);\n                const pct = Math.max(0, Math.min(100, Math.round((1 - rem / total) * 100)));\n                return (\n                  <div className=\"absolute inset-0 z-[200] backdrop-blur-sm bg-black/60 flex items-center justify-center pointer-events-auto\">\n                    <div className=\"rounded-3xl border border-amber-400/30 bg-slate-900/95 p-8 text-white shadow-2xl max-w-md w-full mx-4\">\n                      <div className=\"flex flex-col items-center gap-4\">\n                        <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-amber-500/20 text-3xl\">â¸</div>\n                        <div className=\"text-lg font-bold text-amber-100\">Match Paused</div>\n                        <div className=\"text-4xl font-extrabold tabular-nums tracking-wider text-amber-100\">{mm}:{ss}</div>\n                        <div className=\"w-full h-2 rounded-full bg-white/10 overflow-hidden\">\n                          <div className=\"h-2 rounded-full bg-amber-400 transition-all duration-500\" style={{ width: `${pct}%` }} />\n                        </div>\n                        <div className=\"text-xs text-amber-200/60\">Resuming automatically when timer expires</div>\n                        <button\n                          type=\"button\"\n                          className=\"btn bg-emerald-600 hover:bg-emerald-700 px-6 py-2 text-sm font-semibold\"\n                          onClick={() => setPaused(false, null)}\n                        >\n                          â–¶ Resume Match\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                );\n              })()}\n              {/* Header bar with visible mode and actions; sheen is clipped to this area */}\n              <div className=\"h-full min-h-0 flex flex-col\">\n                <div\n                  className=\"min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 -ml-2 sm:-ml-3\"\n                  style={{\n                    overflowY: \"auto\",\n                    willChange: \"scroll-position\",\n                    transform: \"translateZ(0)\",\n                    WebkitOverflowScrolling: \"touch\",\n                    contain: \"layout style\",\n                  }}\n                  ref={(el) => {\n                    (scrollerRef as any).current = el;\n                  }}\n                >\n                  <div\n                    ref={(el) => {\n                      (headerBarRef as any).current = el;\n                    }}\n                  >\n                    <GameHeaderBar\n                      className=\"w-full\"\n                      left={\n                        <>\n                          <span className=\"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs\">\n                            Game Mode\n                          </span>\n                          <span className=\"font-medium whitespace-nowrap\">\n                            {selectedMode}\n                            {selectedMode === \"X01\" ? ` / ${x01Score}` : \"\"}\n                          </span>\n                          <span className=\"opacity-80 whitespace-nowrap\">\n                            First to {firstTo} Â· Legs {playerLegs}-{aiLegs}\n                          </span>\n                          <span\n                            className={`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${offlineLayout === \"modern\" ? \"bg-emerald-500/15 text-emerald-200 border-emerald-400/30\" : \"bg-white/10 text-white/70 border-white/20\"}`}\n                          >\n                            {offlineLayout === \"modern\"\n                              ? \"Modern layout\"\n                              : \"Classic layout\"}\n                          </span>\n                        </>\n                      }\n                      right={\n                        <>\n                          <button\n                            className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                            onClick={() => {\n                              try {\n                                setShowMatchModal(false);\n                                setInMatch(false);\n                              } catch {}\n                              try {\n                                useMatchControl.getState().setPaused(false, null);\n                              } catch {}\n                            }}\n                            title=\"Return to Offline setup\"\n                          >\n                            Return\n                          </button>\n                          <button\n                            className=\"btn btn--ghost px-3 py-1 text-sm\"\n                            title={fitAll ? \"Actual Size\" : \"Fit All\"}\n                            onClick={() => setFitAll((v) => !v)}\n                          >\n                            {fitAll ? \"Actual Size\" : \"Fit All\"}\n                          </button>\n                          {/* Maximize now only affects browser fullscreen via the FULL button elsewhere; keep this as a no-op toggle to avoid confusion */}\n                          <button\n                            className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                            onClick={() => {\n                              startMatch();\n                            }}\n                          >\n                            Restart\n                          </button>\n                          <button\n                            className=\"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm\"\n                            onClick={() => setShowQuitPause(true)}\n                          >\n                            Quit\n                          </button>\n                        </>\n                      }\n                    />\n                  </div>\n                  {showQuitPause && (\n                    <PauseQuitModal\n                      onClose={() => setShowQuitPause(false)}\n                      onQuit={() => {\n                        finalizeQuitMatch();\n                      }}\n                      onPause={(minutes: any) => {\n                        const endsAt = Date.now() + minutes * 60 * 1000;\n                        try {\n                          setPaused(true, endsAt);\n                          broadcastMessage({\n                            type: \"pause\",\n                            pauseEndsAt: endsAt,\n                            pauseStartedAt: Date.now(),\n                          });\n                        } catch {}\n                        setShowQuitPause(false);\n                      }}\n                    />\n                  )}\n                  {showQuitConfirm && (\n                    <div className=\"fixed inset-0 z-[170] flex items-center justify-center bg-black/70 p-4\">\n                      <ResizableModal\n                        storageKey=\"ndn:modal:offline-quit-confirm\"\n                        className=\"w-full relative\"\n                        defaultWidth={460}\n                        defaultHeight={320}\n                        minWidth={360}\n                        minHeight={260}\n                        maxWidth={720}\n                        maxHeight={520}\n                        initialFitHeight\n                      >\n                        <h3 className=\"text-lg font-bold mb-2\">\n                          Confirm Quit (Both Players)\n                        </h3>\n                        <p className=\"text-sm text-slate-200 mb-4\">\n                          Both players must accept to end the match. If either\n                          player wants to continue, the match will keep going.\n                        </p>\n                        <div className=\"grid gap-2\">\n                          <button\n                            className={`btn w-full ${quitVotes.player ? \"bg-emerald-600 hover:bg-emerald-700\" : \"bg-slate-700 hover:bg-slate-800\"}`}\n                            onClick={() =>\n                              setQuitVotes((prev) => ({\n                                ...prev,\n                                player: true,\n                              }))\n                            }\n                          >\n                            {getPreferredUserName(user, \"Player 1\")} Accepts\n                          </button>\n                          <button\n                            className={`btn w-full ${quitVotes.opponent ? \"bg-emerald-600 hover:bg-emerald-700\" : \"bg-slate-700 hover:bg-slate-800\"}`}\n                            onClick={() =>\n                              setQuitVotes((prev) => ({\n                                ...prev,\n                                opponent: true,\n                              }))\n                            }\n                          >\n                            {ai === \"None\" ? \"Opponent\" : `${ai} AI`} Accepts\n                          </button>\n                          <button\n                            className=\"btn bg-rose-600 hover:bg-rose-700 w-full\"\n                            onClick={() => {\n                              setQuitVotes({ player: false, opponent: false });\n                              setShowQuitConfirm(false);\n                            }}\n                          >\n                            Continue Match\n                          </button>\n                        </div>\n                      </ResizableModal>\n                    </div>\n                  )}\n                  {selectedMode === \"X01\" &&\n                    checkoutPopupOpen &&\n                    checkoutPrompt && (\n                      <div\n                        className=\"fixed inset-0 z-[160] flex items-center justify-center bg-black/70 p-4\"\n                        onClick={() => setCheckoutPopupOpen(false)}\n                      >\n                        <div\n                          className=\"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl\"\n                          onClick={(e) => e.stopPropagation()}\n                          onKeyDown={(e) => {\n                            if (e.key === \"Enter\" || e.key === \"Escape\") {\n                              e.preventDefault();\n                              setCheckoutPopupOpen(false);\n                            }\n                          }}\n                          tabIndex={-1}\n                        >\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <div className=\"text-xs uppercase tracking-wide text-emerald-200/70\">\n                                Checkout box\n                              </div>\n                              <div className=\"text-2xl font-bold text-emerald-100\">\n                                {checkoutPrompt.remaining} left\n                              </div>\n                            </div>\n                            <button\n                              className=\"btn btn--ghost px-3 py-1 text-sm\"\n                              onClick={() => setCheckoutPopupOpen(false)}\n                            >\n                              Close\n                            </button>\n                          </div>\n                          <div className=\"mt-3 space-y-3\">\n                            <div>\n                              <div className=\"text-xs text-white/60 mb-1\">\n                                Darts used at double\n                              </div>\n                              <div className=\"flex gap-2\">\n                                {[0, 1, 2, 3].map((n) => (\n                                  <button\n                                    key={`double-${n}`}\n                                    className={`btn px-3 py-1 text-sm ${doubleDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                                    onClick={() => setDoubleDarts(n)}\n                                  >\n                                    {formatDartCount(n)}\n                                  </button>\n                                ))}\n                              </div>\n                            </div>\n                            <div>\n                              <div className=\"text-xs text-white/60 mb-1\">\n                                Darts at checkout\n                              </div>\n                              <div className=\"flex gap-2\">\n                                {[0, 1, 2, 3].map((n) => (\n                                  <button\n                                    key={`checkout-${n}`}\n                                    className={`btn px-3 py-1 text-sm ${checkoutDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                                    onClick={() => setCheckoutDarts(n)}\n                                  >\n                                    {formatDartCount(n)}\n                                  </button>\n                                ))}\n                              </div>\n                            </div>\n                            {checkoutPrompt.routes.length > 0 && (\n                              <div>\n                                <div className=\"text-xs text-emerald-200/80 mb-1\">\n                                  Suggested checkout\n                                </div>\n                                <div className=\"space-y-1\">\n                                  {checkoutPrompt.routes.map((route) => (\n                                    <div\n                                      key={route}\n                                      className=\"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold\"\n                                    >\n                                      {route}\n                                    </div>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n                            <div className=\"pt-2 flex justify-end\">\n                              <button\n                                className=\"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm\"\n                                onClick={() => setCheckoutPopupOpen(false)}\n                              >\n                                Enter\n                              </button>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    )}\n                  <div\n                    ref={(el) => {\n                      (contentRef as any).current = el;\n                    }}\n                    className=\"will-change-transform\"\n                    style={\n                      fitAll\n                        ? {\n                            transform: `scale(${fitScale})`,\n                            transformOrigin: \"top left\",\n                            width: \"100%\",\n                            fontSize: `${Math.max(0.8, Math.min(1, fitScale))}em`,\n                          }\n                        : undefined\n                    }\n                  >\n                    <h3 className=\"text-xl font-bold mb-2 mt-1 leading-tight\">\n                      {selectedMode === \"X01\"\n                        ? \"X01 Match âš”ï¸\"\n                        : `${selectedMode} âš”ï¸`}\n                    </h3>\n                    <div className=\"flex items-center gap-2 mb-2 text-xs flex-wrap\">\n                      <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                        Mode: {selectedMode}\n                      </span>\n                      <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                        Start: {x01Score}\n                      </span>\n                      <div\n                        ref={formatRef}\n                        className=\"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10\"\n                      >\n                        <span>Format:</span>\n                        {(() => {\n                          const disabled =\n                            playerScore !== x01Score ||\n                            aiScore !== x01Score ||\n                            playerVisitDarts > 0;\n                          const pillCls = `pill ${disabled ? \"opacity-50 cursor-not-allowed\" : \"cursor-pointer\"} `;\n                          return (\n                            <div className=\"flex items-center gap-2\">\n                              <div className=\"flex items-center gap-1\">\n                                <button\n                                  type=\"button\"\n                                  className={`${pillCls} ${formatType === \"first\" ? \"pill--filled\" : \"pill--ghost\"}`}\n                                  onClick={() => {\n                                    if (!disabled) setFormatType(\"first\");\n                                  }}\n                                  title=\"First to N\"\n                                >\n                                  First to\n                                </button>\n                                <button\n                                  type=\"button\"\n                                  className={`${pillCls} ${formatType === \"best\" ? \"pill--filled\" : \"pill--ghost\"}`}\n                                  onClick={() => {\n                                    if (!disabled) setFormatType(\"best\");\n                                  }}\n                                  title=\"Best of N (wins = ceil(N/2)\"\n                                >\n                                  Best of\n                                </button>\n                              </div>\n                              <input\n                                className={`input w-16 text-center ${disabled ? \"opacity-50\" : \"\"}`}\n                                type=\"number\"\n                                min={1}\n                                step={1}\n                                value={formatCount}\n                                onChange={(e) =>\n                                  setFormatCount(\n                                    Math.max(\n                                      1,\n                                      Math.floor(Number(e.target.value) || 1),\n                                    ),\n                                  )\n                                }\n                                disabled={disabled}\n                                title={\n                                  formatType === \"first\"\n                                    ? \"First to N\"\n                                    : \"Best of N (wins = ceil(N/2))\"\n                                }\n                              />\n                            </div>\n                          );\n                        })()}\n                      </div>\n                      <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                        Legs: {playerLegs}â€“{aiLegs}\n                      </span>\n                      {/* Move match type and team names to the right of Legs for a single-row header */}\n                      <div className=\"ml-auto flex items-center gap-1 text-[10px] flex-wrap\">\n                        <span className=\"opacity-70\">Match</span>\n                        <select\n                          className={`input input-compact font-bold ${buttonSizeClass}`}\n                          value={matchType}\n                          onChange={(e) =>\n                            setMatchType(\n                              e.target.value as \"singles\" | \"doubles\",\n                            )\n                          }\n                        >\n                          <option value=\"singles\">Singles</option>\n                          <option value=\"doubles\">Doubles</option>\n                        </select>\n                        <input\n                          className={`input ${buttonSizeClass} w-[7.5rem]`}\n                          value={teamAName}\n                          onChange={(e) => setTeamAName(e.target.value)}\n                          placeholder=\"Team A\"\n                        />\n                        <span className=\"opacity-50\">vs</span>\n                        <input\n                          className={`input ${buttonSizeClass} w-[7.5rem]`}\n                          value={teamBName}\n                          onChange={(e) => setTeamBName(e.target.value)}\n                          placeholder=\"Team B\"\n                        />\n                      </div>\n                    </div>\n                    {/* â”€â”€ Pause Pill â”€â”€ */}\n                    <div className=\"flex items-center gap-3 mb-2 relative\">\n                      {!paused ? (\n                        <button\n                          type=\"button\"\n                          className=\"inline-flex items-center gap-1.5 rounded-full border border-amber-400/40 bg-amber-500/15 px-3 py-1 text-xs font-semibold text-amber-100 hover:bg-amber-500/25 transition\"\n                          onClick={() => setShowPauseMenu((v) => !v)}\n                        >\n                          <span>â¸</span>\n                          <span>Pause</span>\n                        </button>\n                      ) : (\n                        <button\n                          type=\"button\"\n                          className=\"inline-flex items-center gap-1.5 rounded-full border border-emerald-400/40 bg-emerald-500/15 px-3 py-1 text-xs font-semibold text-emerald-100 hover:bg-emerald-500/25 transition\"\n                          onClick={() => setPaused(false, null)}\n                        >\n                          <span>â–¶</span>\n                          <span>Resume</span>\n                        </button>\n                      )}\n                      {paused && pauseEndsAt && (() => {\n                        const rem = Math.max(0, pauseEndsAt - pauseNow);\n                        const mm = Math.floor(rem / 60000).toString().padStart(2, \"0\");\n                        const ss = Math.floor((rem % 60000) / 1000).toString().padStart(2, \"0\");\n                        return (\n                          <span className=\"inline-flex items-center gap-1.5 rounded-full border border-amber-400/30 bg-amber-600/90 px-3 py-1 text-xs font-bold text-black tabular-nums tracking-wide\">\n                            â± {mm}:{ss}\n                          </span>\n                        );\n                      })()}\n                      {showPauseMenu && !paused && (\n                        <div className=\"absolute left-0 top-full mt-1 z-50 rounded-lg border border-slate-600 bg-slate-800 shadow-lg p-2 flex flex-col gap-1 min-w-[140px]\">\n                          <div className=\"text-[10px] uppercase tracking-wide text-slate-400 px-2 mb-1\">Pause for</div>\n                          {[1, 2, 3, 4, 5].map((m) => (\n                            <button\n                              key={m}\n                              type=\"button\"\n                              className=\"w-full text-left rounded px-3 py-1.5 text-sm hover:bg-slate-700 transition\"\n                              onClick={() => {\n                                const endsAt = Date.now() + m * 60 * 1000;\n                                setPaused(true, endsAt);\n                                try { broadcastMessage({ type: \"pause\", pauseEndsAt: endsAt, pauseStartedAt: Date.now() }); } catch {}\n                                setShowPauseMenu(false);\n                              }}\n                            >\n                              {m} minute{m > 1 ? \"s\" : \"\"}\n                            </button>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                    {/* â”€â”€ Pause Countdown Dialogue â”€â”€ */}\n                    {paused && pauseEndsAt && (() => {\n                      const rem = Math.max(0, pauseEndsAt - pauseNow);\n                      const mm = Math.floor(rem / 60000).toString().padStart(2, \"0\");\n                      const ss = Math.floor((rem % 60000) / 1000).toString().padStart(2, \"0\");\n                      const started = useMatchControl.getState().pauseStartedAt ?? pauseNow;\n                      const total = Math.max(1, pauseEndsAt - started);\n                      const pct = Math.max(0, Math.min(100, Math.round((1 - rem / total) * 100)));\n                      return (\n                        <div className=\"mb-3 rounded-2xl border border-amber-400/30 bg-amber-500/10 p-4 text-white\">\n                          <div className=\"flex items-center justify-between gap-4\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-amber-500/20 text-lg\">â¸</div>\n                              <div>\n                                <div className=\"text-sm font-semibold text-amber-100\">Match Paused</div>\n                                <div className=\"text-xs text-amber-200/80\">Resuming automatically when timer expires</div>\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"text-2xl font-bold tabular-nums tracking-wider text-amber-100\">{mm}:{ss}</div>\n                              <div className=\"text-[10px] text-amber-200/60 uppercase tracking-wide\">remaining</div>\n                            </div>\n                          </div>\n                          <div className=\"mt-3 h-2 w-full overflow-hidden rounded-full bg-white/10\">\n                            <div className=\"h-2 rounded-full bg-amber-400 transition-all duration-500\" style={{ width: `${pct}%` }} />\n                          </div>\n                          <div className=\"mt-2 flex justify-end\">\n                            <button\n                              type=\"button\"\n                              className=\"btn px-3 py-1 text-xs bg-emerald-600 hover:bg-emerald-700\"\n                              onClick={() => setPaused(false, null)}\n                            >\n                              â–¶ Resume now\n                            </button>\n                          </div>\n                        </div>\n                      );\n                    })()}\n                    {selectedMode !== \"X01\" ? (\n                      <div className=\"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2\">\n                        {selectedMode === \"Double Practice\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                              <span className=\"opacity-80\">Current Target</span>\n                              <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold\">\n                                {DOUBLE_PRACTICE_ORDER[dpIndex]?.label || \"â€”\"}\n                              </span>\n                            </div>\n                            {/* Large counter moved to the camera column to allow the preview to be raised and enlarged */}\n                          </>\n                        )}\n                        {selectedMode === \"Around the Clock\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                              <span className=\"opacity-80\">Current Target</span>\n                              <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold\">\n                                {ATC_ORDER[atcIndex] === 25\n                                  ? \"25 (Outer Bull)\"\n                                  : ATC_ORDER[atcIndex] === 50\n                                    ? \"50 (Inner Bull)\"\n                                    : ATC_ORDER[atcIndex] || \"â€”\"}\n                              </span>\n                            </div>\n                            {/* Large counter moved to the camera column to allow the preview to be raised and enlarged */}\n                          </>\n                        )}\n                        {selectedMode === \"Cricket\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 mb-1\">\n                              Cricket â€” Close 20â€“15 and Bull; overflow scores\n                              points\n                            </div>\n                            <div className=\"grid grid-cols-7 gap-1 text-center text-[11px] mb-2\">\n                              {CRICKET_NUMBERS.map((n) => (\n                                <div\n                                  key={n}\n                                  className=\"p-1 rounded bg-slate-800/50 border border-slate-700/50\"\n                                >\n                                  <div className=\"opacity-70\">\n                                    {n === 25 ? \"Bull\" : n}\n                                  </div>\n                                  <div className=\"font-semibold\">\n                                    {Math.min(3, cricket.marks?.[n] || 0)} / 3\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                            <div className=\"text-sm\">\n                              Points:{\" \"}\n                              <span className=\"font-semibold\">\n                                {cricket.points}\n                              </span>\n                            </div>\n                            {cricketClosedAll(cricket) && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={() => {\n                                    setCricket(createCricketState());\n                                    setPracticeTurnDarts(0);\n                                    resetDartCount(\"Cricket\");\n                                  }}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Shanghai\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                              <span>Round</span>\n                              <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold\">\n                                {shanghai.round}\n                              </span>\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {shanghai.score}\n                            </div>\n                            {shanghai.finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={() => {\n                                    setShanghai(createShanghaiState());\n                                    setPracticeTurnDarts(0);\n                                    resetDartCount(\"Shanghai\");\n                                  }}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Halve It\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                              <span>Stage</span>\n                              <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold\">\n                                {halve.stage + 1}/{halve.targets.length}\n                              </span>\n                            </div>\n                            <div className=\"text-sm\">\n                              Target:{\" \"}\n                              <span className=\"font-semibold\">\n                                {(() => {\n                                  const t = getCurrentHalveTarget(halve);\n                                  if (!t) return \"â€”\";\n                                  if (t.kind === \"ANY_NUMBER\") return \"Any\";\n                                  if (t.kind === \"BULL\") return \"Bull\";\n                                  if (\n                                    t.kind === \"DOUBLE\" ||\n                                    t.kind === \"TRIPLE\" ||\n                                    t.kind === \"NUMBER\"\n                                  )\n                                    return `${t.kind} ${(t as any).num}`;\n                                  return \"â€”\";\n                                })()}\n                              </span>\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {halve.score}\n                            </div>\n                            {halve.finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={() => {\n                                    setHalve(createDefaultHalveIt());\n                                    setPracticeTurnDarts(0);\n                                    resetDartCount(\"Halve It\");\n                                  }}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"High-Low\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">\n                              Round {highlow.round} Â· Target {highlow.target}\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {highlow.score}\n                            </div>\n                            {highlow.finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={() => {\n                                    setHighlow(createHighLow());\n                                    setPracticeTurnDarts(0);\n                                    resetDartCount(\"High-Low\");\n                                  }}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Bob's 27\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                              <span>Target</span>\n                              <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold\">\n                                D{b27Stage}\n                              </span>\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {b27Score}\n                            </div>\n                            {b27Finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={resetB27}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Count-Up\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">\n                              Round {cuRound}/8\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {cuScore}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"High Score\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">\n                              Round {hsRound}/10\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {hsScore}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Low Score\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">\n                              Round {lsRound}/10\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              Score: {lsScore}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Checkout 170\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">\n                              Remaining\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {co170Rem}\n                            </div>\n                            <div className=\"text-xs text-slate-400 mt-1\">\n                              Attempts: {co170Attempts} Â· Successes:{\" \"}\n                              {co170Successes}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Checkout 121\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">\n                              Remaining\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {co121Rem}\n                            </div>\n                            <div className=\"text-xs text-slate-400 mt-1\">\n                              Attempts: {co121Attempts} Â· Successes:{\" \"}\n                              {co121Successes}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Treble Practice\" && (\n                          <>\n                            <div className=\"flex items-center justify-between gap-4\">\n                              <div>\n                                <div className=\"text-xs text-slate-600\">\n                                  Treble Target: T{trebleTarget}\n                                </div>\n                                <div className=\"text-3xl font-extrabold tracking-tight\">\n                                  Hits: {trebleHits}\n                                </div>\n                              </div>\n                              <div className=\"flex items-center gap-2 flex-wrap\">\n                                <label className=\"text-sm\">Target</label>\n                                <div className=\"inline-flex items-center gap-1\">\n                                  {[20, 19, 18].map((n) => (\n                                    <button\n                                      key={`tpick-header-${n}`}\n                                      className={`btn px-2 py-0.5 text-xs ${trebleTarget === n ? \"bg-emerald-600/30 border border-emerald-400/30\" : \"\"}`}\n                                      onClick={() => setTrebleTarget(n)}\n                                    >\n                                      T{n}\n                                    </button>\n                                  ))}\n                                </div>\n                                <span className=\"opacity-60 text-xs\">or</span>\n                                <select\n                                  className=\"input w-24\"\n                                  value={trebleTarget}\n                                  onChange={(e) =>\n                                    setTrebleTarget(\n                                      parseInt(e.target.value, 10),\n                                    )\n                                  }\n                                >\n                                  {Array.from(\n                                    { length: 20 },\n                                    (_, i) => i + 1,\n                                  ).map((n) => (\n                                    <option key={n} value={n}>\n                                      {n}\n                                    </option>\n                                  ))}\n                                </select>\n                                <button\n                                  className=\"btn px-3 py-1 text-sm\"\n                                  onClick={resetTreble}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Baseball\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">Inning</div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {baseball.inning}\n                            </div>\n                            <div className=\"text-sm\">\n                              Score:{\" \"}\n                              <span className=\"font-semibold\">\n                                {baseball.score}\n                              </span>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Golf\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">Hole</div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {golf.hole}\n                            </div>\n                            <div className=\"text-sm\">\n                              Strokes:{\" \"}\n                              <span className=\"font-semibold\">\n                                {golf.strokes}\n                              </span>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Tic Tac Toe\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">Turn</div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {ttt.turn}\n                            </div>\n                            {ttt.finished && (\n                              <div className=\"mt-1 text-xs\">\n                                Winner: {ttt.winner || \"â€”\"}\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Scam\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">Target</div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {SCAM_TARGET_NAMES[scam.targetIndex]}\n                            </div>\n                            <div className=\"text-sm\">\n                              Progress:{\" \"}\n                              <span className=\"font-semibold\">\n                                {scam.targetIndex + 1}/\n                                {SCAM_TARGET_NAMES.length}\n                              </span>\n                            </div>\n                            {scam.finished && (\n                              <div className=\"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200\">\n                                ðŸŽ‰ Finished in {scam.darts} darts!\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Fives\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">Score</div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {fives.score}/{fives.target}\n                            </div>\n                            <div className=\"text-sm\">\n                              Darts:{\" \"}\n                              <span className=\"font-semibold\">\n                                {fives.darts}\n                              </span>\n                            </div>\n                            {fives.finished && (\n                              <div className=\"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200\">\n                                âœ“ Reached {fives.target}!\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Sevens\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600\">Score</div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {sevens.score}/{sevens.target}\n                            </div>\n                            <div className=\"text-sm\">\n                              Darts:{\" \"}\n                              <span className=\"font-semibold\">\n                                {sevens.darts}\n                              </span>\n                            </div>\n                            {sevens.finished && (\n                              <div className=\"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200\">\n                                âœ“ Reached {sevens.target}!\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"American Cricket\" && (\n                          <>\n                            <div className=\"text-xs text-slate-600 mb-1\">\n                              Close 20â€“12 and Bull; overflow scores points\n                            </div>\n                            <div className=\"grid grid-cols-10 gap-1 text-center text-[11px] mb-2\">\n                              {AM_CRICKET_NUMBERS.map((n) => (\n                                <div\n                                  key={n}\n                                  className=\"p-1 rounded bg-slate-800/50 border border-slate-700/50\"\n                                >\n                                  <div className=\"opacity-70\">\n                                    {n === 25 ? \"Bull\" : n}\n                                  </div>\n                                  <div className=\"font-semibold\">\n                                    {Math.min(3, amCricket.marks?.[n] || 0)} / 3\n                                  </div>\n                                </div>\n                              ))}\n                            </div>\n                            <div className=\"text-sm\">\n                              Points:{\" \"}\n                              <span className=\"font-semibold\">\n                                {amCricket.points}\n                              </span>\n                            </div>\n                            {hasClosedAllAm(amCricket) && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={resetAmCricket}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Killer\" && (\n                          <>\n                            {!killerSetupDone ? (\n                              <div className=\"text-xs text-slate-600\">\n                                Setup players and assign numbers\n                              </div>\n                            ) : (\n                              <>\n                                <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                                  <span>Turn</span>\n                                  <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold\">\n                                    {killerPlayers[killerTurnIdx]?.name || \"â€”\"}\n                                  </span>\n                                </div>\n                                <div className=\"text-3xl font-extrabold tracking-tight\">\n                                  {killerWinnerId\n                                    ? `${killerPlayers.find((p) => p.id === killerWinnerId)?.name || \"Winner\"} Wins`\n                                    : killerLastEvent || \"Ready\"}\n                                </div>\n                              </>\n                            )}\n                          </>\n                        )}\n                      </div>\n                    ) : offlineLayout === \"modern\" ? (\n                      <div className=\"space-y-3 mb-2\">\n                        {!manualScoring ? (\n                          <>\n                            <div className=\"flex items-center flex-wrap gap-1.5 mt-1\">\n                              <div className=\"ml-auto flex items-center gap-1 text-[10px]\">\n                                <span className=\"opacity-70\">Cam</span>\n                                <button\n                                  className={`btn ${buttonSizeClass}`}\n                                  onClick={() =>\n                                    setCameraScale(\n                                      Math.max(\n                                        0.5,\n                                        Math.round((cameraScale - 0.05) * 100) /\n                                          100,\n                                      ),\n                                    )\n                                  }\n                                >\n                                  âˆ’\n                                </button>\n                                <span\n                                  className={`btn ${buttonSizeClass} min-w-[2.5rem] text-center`}\n                                >\n                                  {Math.round(cameraScale * 100)}%\n                                </span>\n                                <button\n                                  className={`btn ${buttonSizeClass}`}\n                                  onClick={() =>\n                                    setCameraScale(\n                                      Math.min(\n                                        1.25,\n                                        Math.round((cameraScale + 0.05) * 100) /\n                                          100,\n                                      ),\n                                    )\n                                  }\n                                >\n                                  +\n                                </button>\n                                <span className=\"opacity-50\">|</span>\n                                <button\n                                  className={`btn ${buttonSizeClass}`}\n                                  title=\"Toggle fit/fill\"\n                                  onClick={() =>\n                                    setCameraFitMode(\n                                      cameraFitMode === \"fill\" ? \"fit\" : \"fill\",\n                                    )\n                                  }\n                                >\n                                  {cameraFitMode === \"fill\" ? \"Fill\" : \"Fit\"}\n                                </button>\n                                <span className=\"opacity-50\">|</span>\n                                <button\n                                  className={`btn ${buttonSizeClass}`}\n                                  title=\"Toggle camera aspect\"\n                                  onClick={() =>\n                                    setCameraAspect(\n                                      cameraAspect === \"square\"\n                                        ? \"wide\"\n                                        : \"square\",\n                                    )\n                                  }\n                                >\n                                  {cameraAspect === \"square\"\n                                    ? \"Square\"\n                                    : \"Wide\"}\n                                </button>\n                              </div>\n                            </div>\n                            <div className=\"relative\">\n                              <div className=\"flex flex-col gap-3 md:flex-row md:items-start md:gap-4 lg:grid lg:grid-cols-[minmax(0,1fr)_380px] lg:gap-4\">\n                                <div className=\"flex-1 min-w-0 space-y-2.5\">\n                                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                                    {selectedMode === \"X01\" ? (\n                                      <>\n                                        <div\n                                          data-testid=\"offline-current-shooter\"\n                                          className=\"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm\"\n                                        >\n                                          <div className=\"text-xs uppercase tracking-wide text-white/50\">\n                                            Current Shooter\n                                          </div>\n                                          <div className=\"mt-1 flex items-center gap-4\">\n                                            <div className=\"text-xl font-semibold text-white\">\n                                              {activePlayerName}\n                                            </div>\n                                            <div className=\"ml-auto text-sm text-slate-300\">\n                                              3-Dart Avg (Live)\n                                            </div>\n                                          </div>\n                                          <div className=\"mt-3 grid grid-cols-2 gap-3 text-sm text-white/80\">\n                                            <div>\n                                              <div className=\"text-xs uppercase tracking-wide text-white/40\">\n                                                Remaining\n                                              </div>\n                                              <div className=\"font-mono text-lg text-white\">\n                                                {activeRemaining}\n                                              </div>\n                                            </div>\n                                            <div>\n                                              <div className=\"text-xs uppercase tracking-wide text-white/40\">\n                                                Last Dart\n                                              </div>\n                                              <div className=\"font-mono text-lg text-white\">\n                                                {activeLastScore || 0}\n                                              </div>\n                                            </div>\n                                            <div>\n                                              <div className=\"text-xs uppercase tracking-wide text-white/40\">\n                                                Match Legs\n                                              </div>\n                                              <div className=\"font-semibold text-white\">\n                                                {playerLegs}-{aiLegs}\n                                              </div>\n                                            </div>\n                                            <div>\n                                              <div className=\"text-xs uppercase tracking-wide text-white/40\">\n                                                Next Up\n                                              </div>\n                                              <div className=\"font-medium text-white\">\n                                                {inactivePlayerName}\n                                              </div>\n                                            </div>\n                                          </div>\n                                        </div>\n\n                                        <div className=\"space-y-3\">\n                                          <div\n                                            data-testid=\"offline-live-avg\"\n                                            className=\"rounded-xl bg-slate-900/60 border border-white/10 p-3 text-white/80\"\n                                          >\n                                            <div className=\"text-xs uppercase tracking-wide text-white/40\">\n                                              3-Dart Avg (Live)\n                                            </div>\n                                            <div className=\"mt-1 text-lg font-semibold\">\n                                              {formatAvg(\n                                                match.players?.[\n                                                  match.currentPlayerIdx\n                                                ]?.currentThreeDartAvg ?? 0,\n                                              )}\n                                            </div>\n                                          </div>\n\n                                          <div\n                                            data-testid=\"offline-player-stats\"\n                                            className=\"rounded-lg border p-3 bg-slate-900/50 border-white/10 text-white/80\"\n                                          >\n                                            <div className=\"text-xs uppercase tracking-wide text-white/40\">\n                                              You\n                                            </div>\n                                            <div className=\"mt-2 text-sm\">\n                                              <div>\n                                                Legs Won:{\" \"}\n                                                <span className=\"font-semibold\">\n                                                  {playerLegs}\n                                                </span>\n                                              </div>\n                                              <div>\n                                                Score:{\" \"}\n                                                <span className=\"font-mono\">\n                                                  {activeRemaining}\n                                                </span>\n                                              </div>\n                                              <div>\n                                                Last Score:{\" \"}\n                                                <span className=\"font-mono\">\n                                                  {activeLastScore || 0}\n                                                </span>\n                                              </div>\n                                            </div>\n                                          </div>\n                                        </div>\n                                      </>\n                                    ) : (\n                                      <div className=\"md:col-span-2 rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm\">\n                                        <div className=\"text-xs uppercase tracking-wide text-white/50\">\n                                          Scoreboard\n                                        </div>\n                                        <div className=\"mt-3\">\n                                          <GameScoreboard\n                                            gameMode={selectedMode as any}\n                                            players={scoreboardPlayers}\n                                            matchScore={scoreboardMatchScore}\n                                          />\n                                        </div>\n                                      </div>\n                                    )}\n                                  </div>\n\n                                  {(selectedMode as any) === \"X01\" && (\n                                    <div className=\"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm\">\n                                      <div className=\"text-xs uppercase tracking-wide text-white/50\">\n                                        Manual Scoreboard Override\n                                      </div>\n                                      <p className=\"mt-1 text-xs text-white/40\">\n                                        Adjust the live totals if a dart was\n                                        misread. Values are clamped between 0\n                                        and {x01Score}.\n                                      </p>\n                                      <div className=\"mt-2.5 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm\">\n                                        <div className=\"space-y-3\">\n                                          <div className=\"text-sm font-semibold text-white\">\n                                            {humanName}\n                                          </div>\n                                          <div className=\"space-y-2\">\n                                            <label className=\"text-xs uppercase tracking-wide text-white/50\">\n                                              Commit Visit\n                                            </label>\n                                            <div className=\"flex flex-wrap items-center gap-2\">\n                                              <MatchControls\n                                                inProgress={true}\n                                                startingScore={x01Score}\n                                                onAddVisit={makeOfflineAddVisitAdapter(\n                                                  commitManualVisitTotal,\n                                                )}\n                                                quickButtons={[\n                                                  180, 140, 100, 60,\n                                                ]}\n                                                onNextPlayer={() =>\n                                                  matchActions?.nextPlayer()\n                                                }\n                                                onEndLeg={() => {\n                                                  /* End leg handled via commitManualVisitTotal / addVisitTotal */\n                                                }}\n                                                onUndo={() => {\n                                                  /* offline undo not implemented here; optionally reset pending visit */\n                                                }}\n                                                showDartsSelect={true}\n                                              />\n                                            </div>\n                                          </div>\n                                          <div className=\"space-y-2\">\n                                            <label className=\"text-xs uppercase tracking-wide text-white/50\">\n                                              Legs Override\n                                            </label>\n                                            <div className=\"flex flex-wrap items-center gap-2\">\n                                              <input\n                                                className=\"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40\"\n                                                type=\"number\"\n                                                min={0}\n                                                value={manualPlayerLegsInput}\n                                                onChange={(e) =>\n                                                  setManualPlayerLegsInput(\n                                                    e.target.value,\n                                                  )\n                                                }\n                                                onKeyDown={(e) => {\n                                                  if (e.key === \"Enter\")\n                                                    handleManualLegsOverride(\n                                                      \"player\",\n                                                    );\n                                                }}\n                                                placeholder={`${playerLegs}`}\n                                              />\n                                              <button\n                                                className=\"btn px-3 py-1 text-sm\"\n                                                onClick={() =>\n                                                  handleManualLegsOverride(\n                                                    \"player\",\n                                                  )\n                                                }\n                                              >\n                                                Set\n                                              </button>\n                                            </div>\n                                          </div>\n                                        </div>\n                                        <div className=\"space-y-3\">\n                                          <div className=\"text-sm font-semibold text-white\">\n                                            {aiDisplayName}\n                                          </div>\n                                          <div className=\"space-y-2\">\n                                            <label className=\"text-xs uppercase tracking-wide text-white/50\">\n                                              Three Dart Edit\n                                            </label>\n                                            <div className=\"flex flex-wrap items-center gap-2\">\n                                              <input\n                                                className=\"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40\"\n                                                type=\"number\"\n                                                min={0}\n                                                max={x01Score}\n                                                value={manualOpponentScoreInput}\n                                                onChange={(e) =>\n                                                  setManualOpponentScoreInput(\n                                                    e.target.value,\n                                                  )\n                                                }\n                                                onKeyDown={(e) => {\n                                                  if (e.key === \"Enter\")\n                                                    handleManualScoreOverride(\n                                                      \"ai\",\n                                                    );\n                                                }}\n                                                placeholder={`${aiScore}`}\n                                              />\n                                              <button\n                                                className=\"btn px-3 py-1 text-sm\"\n                                                onClick={() =>\n                                                  handleManualScoreOverride(\n                                                    \"ai\",\n                                                  )\n                                                }\n                                              >\n                                                Set\n                                              </button>\n                                            </div>\n                                          </div>\n                                          <div className=\"space-y-2\">\n                                            <label className=\"text-xs uppercase tracking-wide text-white/50\">\n                                              Legs Override\n                                            </label>\n                                            <div className=\"flex flex-wrap items-center gap-2\">\n                                              <input\n                                                className=\"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40\"\n                                                type=\"number\"\n                                                min={0}\n                                                value={manualOpponentLegsInput}\n                                                onChange={(e) =>\n                                                  setManualOpponentLegsInput(\n                                                    e.target.value,\n                                                  )\n                                                }\n                                                onKeyDown={(e) => {\n                                                  if (e.key === \"Enter\")\n                                                    handleManualLegsOverride(\n                                                      \"ai\",\n                                                    );\n                                                }}\n                                                placeholder={`${aiLegs}`}\n                                              />\n                                              <button\n                                                className=\"btn px-3 py-1 text-sm\"\n                                                onClick={() =>\n                                                  handleManualLegsOverride(\"ai\")\n                                                }\n                                              >\n                                                Set\n                                              </button>\n                                            </div>\n                                          </div>\n                                        </div>\n                                      </div>\n                                    </div>\n                                  )}\n                                </div>\n\n                                <div className=\"hidden lg:flex lg:flex-col lg:gap-3 min-w-0\">\n                                  <div className=\"rounded-2xl overflow-hidden bg-black border border-white/10\">\n                                    {cameraEnabled ? (\n                                      <CameraView\n                                        scoringMode={\n                                          selectedMode === \"X01\"\n                                            ? \"x01\"\n                                            : \"custom\"\n                                        }\n                                        showToolbar={cameraToolbarVisible}\n                                        immediateAutoCommit\n                                        cameraAutoCommit=\"camera\"\n                                        onAddVisit={makeOfflineAddVisitAdapter(\n                                          commitManualVisitTotal,\n                                        )}\n                                        onAutoDart={() => {\n                                          /* Camera owns commits; parent handles manual flow when needed */\n                                        }}\n                                      />\n                                    ) : (\n                                      <div className=\"p-4 text-sm text-slate-200 text-center\">\n                                        Camera disabled\n                                      </div>\n                                    )}\n                                  </div>\n                                  <GameScoreboard\n                                    gameMode={selectedMode as any}\n                                    players={singlePlayerScoreboard}\n                                    matchScore={`${playerLegs}-${aiLegs}`}\n                                  />\n                                </div>\n                              </div>\n\n                              <div className=\"md:hidden\">\n                                <GameScoreboard\n                                  gameMode={selectedMode as any}\n                                  players={singlePlayerScoreboard}\n                                  matchScore={`${playerLegs}-${aiLegs}`}\n                                />\n                              </div>\n\n                              {isMobileScreen && cameraEnabled && (\n                                <div className=\"flex items-center gap-2 mt-2 md:hidden\">\n                                  <button\n                                    className=\"btn rounded-full border border-white/20 bg-white/10 px-4 py-2 text-sm text-white\"\n                                    onClick={() =>\n                                      setMobileCameraOpen((v) => !v)\n                                    }\n                                  >\n                                    {mobileCameraOpen ? \"Hide Camera\" : \"Show Camera\"}\n                                  </button>\n                                  <span className=\"text-xs text-white/60\">\n                                    {mobileCameraOpen\n                                      ? \"Swipe down / tap outside to close\"\n                                      : \"Opens as a bottom drawer\"}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          </>\n                        ) : (\n                          <div className=\"card\">\n                            <div className=\"text-sm font-semibold mb-1\">\n                              Manual scoring active\n                            </div>\n                            <div className=\"text-xs opacity-70\">\n                              Camera previews are disabled. Use the manual entry\n                              controls below to record your turn.\n                            </div>\n                          </div>\n                        )}\n                        {isMobileScreen && cameraEnabled && mobileCameraOpen && (\n                          <div className=\"fixed inset-0 z-[120] md:hidden\">\n                            <button\n                              type=\"button\"\n                              className=\"absolute inset-0 bg-black/55\"\n                              onClick={() => setMobileCameraOpen(false)}\n                              aria-label=\"Close camera drawer\"\n                            />\n                            <div className=\"absolute left-0 right-0 bottom-0\">\n                              <div className=\"mx-auto w-full max-w-[520px]\">\n                                <div\n                                  ref={drawerRootRef}\n                                  className=\"rounded-t-[26px] border-t border-l border-r border-white/10 bg-slate-950/95 shadow-2xl overflow-hidden\"\n                                  onClick={(e) => e.stopPropagation()}\n                                >\n                                  <div\n                                    className=\"flex items-center justify-between px-4 py-3 border-b border-white/10\"\n                                    onPointerDown={onDrawerPointerDown}\n                                    onPointerMove={onDrawerPointerMove}\n                                    onPointerUp={onDrawerPointerEnd}\n                                    onPointerCancel={onDrawerPointerEnd}\n                                  >\n                                    <div className=\"flex items-center gap-2\">\n                                      <div className=\"h-1.5 w-10 rounded-full bg-white/20\" />\n                                      <span className=\"text-sm font-semibold text-white\">\n                                        Board Camera\n                                      </span>\n                                    </div>\n                                    <button\n                                      type=\"button\"\n                                      className=\"btn btn--ghost px-3 py-1 text-sm\"\n                                      onClick={() => setMobileCameraOpen(false)}\n                                    >\n                                      Close\n                                    </button>\n                                  </div>\n                                  <div className=\"p-3\">\n                                    <div className=\"relative w-full overflow-hidden rounded-2xl bg-black border border-white/10\">\n                                      <div className=\"absolute inset-0\">\n                                        <CameraView\n                                          scoringMode=\"x01\"\n                                          showToolbar={cameraToolbarVisible}\n                                          immediateAutoCommit\n                                          cameraAutoCommit=\"camera\"\n                                          onAddVisit={makeOfflineAddVisitAdapter(\n                                            commitManualVisitTotal,\n                                          )}\n                                          onAutoDart={(_value, _ring, _info) => {\n                                            // Camera owns commits for X01; parent should not applyDartValue to avoid duplicates.\n                                          }}\n                                        />\n                                      </div>\n                                      <div className=\"pt-[56.25%]\" />\n                                    </div>\n                                    <div className=\"mt-3 text-xs text-white/70 flex items-center justify-between\">\n                                      <span>{currentThrowerName}</span>\n                                      <span>\n                                        Legs {currentThrowerLegs} Â· Opp {opponentLegs}\n                                      </span>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2 items-stretch min-w-0\">\n                        <div className=\"flex items-stretch justify-center md:px-3 min-w-0\">\n                          <div className=\"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full\">\n                            <div className=\"text-xs text-slate-600 flex items-center justify-between\">\n                              <span className=\"opacity-80\">You Remain</span>\n                              {isPlayerTurn ? (\n                                <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold\">\n                                  THROWING\n                                </span>\n                              ) : (\n                                <span className=\"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold\">\n                                  WAITING TO THROW\n                                </span>\n                              )}\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {playerScore}\n                            </div>\n                            <div className=\"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden\">\n                              <div\n                                className=\"h-full bg-emerald-400/70\"\n                                style={{\n                                  width: `${Math.max(0, Math.min(100, (1 - playerScore / x01Score) * 100))}%`,\n                                }}\n                              />\n                            </div>\n                            <div className=\"text-sm mt-1 opacity-90\">\n                              Last dart:{\" \"}\n                              <span className=\"font-semibold\">\n                                {playerLastDart}\n                              </span>\n                            </div>\n                            <div className=\"text-sm opacity-90\">\n                              Last score:{\" \"}\n                              <span className=\"font-semibold\">\n                                {playerVisitDarts > 0\n                                  ? playerVisitSum\n                                  : (playerLastVisitScore ?? playerLastDart)}\n                              </span>\n                            </div>\n                            <div className=\"text-sm opacity-90\">\n                              3-Dart Avg:{\" \"}\n                              <span className=\"font-semibold\">\n                                {totalPlayerDarts > 0\n                                  ? (\n                                      (totalPlayerPoints / totalPlayerDarts) *\n                                      3\n                                    ).toFixed(1)\n                                  : \"0.0\"}\n                              </span>\n                            </div>\n                            <div className=\"text-xs opacity-70 flex items-center gap-2\">\n                              <span>Darts thrown: {playerDartsThrown}</span>\n                              <span\n                                className=\"inline-flex items-center gap-1\"\n                                aria-label=\"Visit darts\"\n                              >\n                                {[0, 1, 2].map((i) => (\n                                  <span\n                                    key={i}\n                                    className={`w-2 h-2 rounded-full ${i < playerVisitDarts ? \"bg-emerald-400\" : \"bg-white/20\"}`}\n                                  ></span>\n                                ))}\n                              </span>\n                            </div>\n                            <div className=\"text-xs opacity-80 mt-1\">\n                              Doubles:{\" \"}\n                              <span className=\"font-semibold\">\n                                Att {playerDoublesAtt} Â· Hit {playerDoublesHit}\n                              </span>\n                            </div>\n                            {playerScore <= 170 &&\n                              playerScore > 0 &&\n                              (() => {\n                                const sugs = suggestCheckouts(\n                                  playerScore,\n                                  favoriteDouble,\n                                );\n                                const first = sugs[0] || \"â€”\";\n                                return (\n                                  <div className=\"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm\">\n                                    <span className=\"opacity-70\">Checkout</span>\n                                    <span className=\"font-semibold\">\n                                      {first}\n                                    </span>\n                                  </div>\n                                );\n                              })()}\n                          </div>\n                          {/* Match summary (offline) */}\n                          <div\n                            className={`mt-2 ${boxSize === \"small\" ? \"p-2\" : boxSize === \"large\" ? \"p-4\" : \"p-3\"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${textSize === \"small\" ? \"text-xs\" : textSize === \"large\" ? \"text-base\" : \"text-sm\"}`}\n                          >\n                            <div className=\"font-semibold mb-2\">\n                              Match Summary\n                            </div>\n                            {(() => {\n                              // In offline X01, player is vs AI or practice\n                              const currentThrower = isPlayerTurn\n                                ? getPreferredUserName(user, \"You\")\n                                : ai === \"None\"\n                                  ? \"â€”\"\n                                  : `${ai} AI`;\n                              const currentRemaining = isPlayerTurn\n                                ? playerScore\n                                : ai === \"None\"\n                                  ? 0\n                                  : aiScore;\n                              const lastScoreDisplay = isPlayerTurn\n                                ? playerVisitDarts > 0\n                                  ? playerVisitSum\n                                  : (playerLastVisitScore ?? playerLastDart)\n                                : aiVisitDarts > 0\n                                  ? aiVisitSum\n                                  : (aiLastVisitScore ?? aiLastDart);\n                              const dartsThrown = isPlayerTurn\n                                ? playerDartsThrown\n                                : aiDartsThrown;\n                              const scored =\n                                x01Score -\n                                (isPlayerTurn\n                                  ? playerScore\n                                  : ai === \"None\"\n                                    ? x01Score\n                                    : aiScore);\n                              const avg3 =\n                                dartsThrown > 0\n                                  ? (scored / dartsThrown) * 3\n                                  : 0;\n                              const matchScore = `${playerLegs}-${aiLegs}`;\n                              const bestLegText =\n                                legStats.length > 0\n                                  ? `${Math.min(...legStats.map((l) => l.doubleDarts + (l.checkoutDarts || 0))) || 0} darts`\n                                  : \"â€”\";\n                              return (\n                                <div className=\"grid grid-cols-2 gap-y-1\">\n                                  <div className=\"opacity-80\">\n                                    Current score\n                                  </div>\n                                  <div className=\"font-mono text-right\">\n                                    {matchScore}\n                                  </div>\n                                  <div className=\"opacity-80\">\n                                    Current thrower\n                                  </div>\n                                  <div className=\"text-right font-semibold text-lg\">\n                                    {currentThrower}\n                                  </div>\n                                  <div className=\"opacity-80\">\n                                    Score remaining\n                                  </div>\n                                  <div className=\"text-right font-mono font-bold text-xl\">\n                                    {currentRemaining}\n                                  </div>\n                                  <div className=\"opacity-80\">3-dart avg</div>\n                                  <div className=\"text-right font-mono\">\n                                    {avg3.toFixed(1)}\n                                  </div>\n                                  <div className=\"opacity-80\">Last score</div>\n                                  <div className=\"text-right font-mono\">\n                                    {lastScoreDisplay}\n                                  </div>\n                                  <div className=\"opacity-80\">Best leg</div>\n                                  <div className=\"text-right\">\n                                    {bestLegText}\n                                  </div>\n                                </div>\n                              );\n                            })()}\n                          </div>\n                          <div className=\"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full\">\n                            <div className=\"text-xs flex items-center justify-between opacity-80\">\n                              <span>\n                                {ai === \"None\" ? \"Opponent\" : `${ai} AI`} Remain\n                              </span>\n                              {!isPlayerTurn ? (\n                                <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold\">\n                                  THROWING\n                                </span>\n                              ) : (\n                                <span className=\"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold\">\n                                  WAITING TO THROW\n                                </span>\n                              )}\n                            </div>\n                            <div className=\"text-3xl font-extrabold tracking-tight\">\n                              {ai !== \"None\" ? aiScore : \"N/A\"}\n                            </div>\n                            {ai !== \"None\" && (\n                              <div className=\"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden\">\n                                <div\n                                  className=\"h-full bg-fuchsia-400/70\"\n                                  style={{\n                                    width: `${Math.max(0, Math.min(100, (1 - aiScore / x01Score) * 100))}%`,\n                                  }}\n                                />\n                              </div>\n                            )}\n                            <div className=\"text-sm mt-1 opacity-90\">\n                              Last dart:{\" \"}\n                              <span className=\"font-semibold\">\n                                {ai === \"None\" ? 0 : aiLastDart}\n                              </span>\n                            </div>\n                            <div className=\"text-sm opacity-90\">\n                              Last score:{\" \"}\n                              <span className=\"font-semibold\">\n                                {ai === \"None\"\n                                  ? \"â€”\"\n                                  : aiVisitDarts > 0\n                                    ? aiVisitSum\n                                    : (aiLastVisitScore ?? aiLastDart)}\n                              </span>\n                            </div>\n                            <div className=\"text-sm opacity-90\">\n                              3-Dart Avg:{\" \"}\n                              <span className=\"font-semibold\">\n                                {ai !== \"None\"\n                                  ? totalAiDarts > 0\n                                    ? (\n                                        (totalAiPoints / totalAiDarts) *\n                                        3\n                                      ).toFixed(1)\n                                    : \"0.0\"\n                                  : \"â€”\"}\n                              </span>\n                            </div>\n                            {ai !== \"None\" && (\n                              <div className=\"text-xs opacity-70\">\n                                Darts thrown: {aiDartsThrown}\n                              </div>\n                            )}\n                            {ai !== \"None\" && (\n                              <div className=\"text-xs opacity-80 mt-1\">\n                                Doubles:{\" \"}\n                                <span className=\"font-semibold\">\n                                  Att {aiDoublesAtt} Â· Hit {aiDoublesHit}\n                                </span>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    )}\n                    {/* Turn area */}\n                    {selectedMode !== \"X01\" ? (\n                      <div className=\"space-y-2\">\n                        <div className=\"font-semibold\">{\n                          selectedMode === \"Double Practice\" ? \"Double Practice\" :\n                          selectedMode === \"Around the Clock\" ? \"Around the Clock\" :\n                          selectedMode === \"Cricket\" ? \"Cricket\" :\n                          selectedMode === \"Shanghai\" ? `Shanghai â€” Round ${shanghai.round}` :\n                          selectedMode === \"Halve It\" ? `Halve It â€” Round ${halve.stage + 1}` :\n                          selectedMode === \"High-Low\" ? `High-Low â€” Round ${highlow.round}` :\n                          selectedMode === \"Bob's 27\" ? `Bob's 27 â€” D${b27Stage}` :\n                          selectedMode === \"Count-Up\" ? `Count-Up â€” Round ${cuRound}/${cuMaxRounds}` :\n                          selectedMode === \"High Score\" ? `High Score â€” Round ${hsRound}/${hsMaxRounds}` :\n                          selectedMode === \"Low Score\" ? `Low Score â€” Round ${lsRound}/${lsMaxRounds}` :\n                          selectedMode === \"Checkout 170\" ? \"Checkout 170\" :\n                          selectedMode === \"Checkout 121\" ? \"Checkout 121\" :\n                          selectedMode === \"Treble Practice\" ? `Treble Practice â€” T${trebleTarget}` :\n                          selectedMode === \"Baseball\" ? `Baseball â€” Inning ${baseball.inning}` :\n                          selectedMode === \"Golf\" ? `Golf â€” Hole ${golf.hole}` :\n                          selectedMode === \"Tic Tac Toe\" ? \"Tic Tac Toe\" :\n                          selectedMode === \"American Cricket\" ? \"American Cricket\" :\n                          selectedMode === \"Killer\" ? \"Killer\" :\n                          selectedMode === \"Scam\" ? \"Scam\" :\n                          selectedMode === \"Fives\" ? \"Fives\" :\n                          selectedMode === \"Sevens\" ? \"Sevens\" :\n                          \"Your Turn\"\n                        }</div>\n                        <div className=\"flex flex-col gap-4\">\n                          <div className=\"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start\">\n                            <div className=\"col-span-12 md:col-span-4 space-y-3\">\n                              <div className=\"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg\">\n                        {selectedMode === \"Double Practice\" && (\n                          <>\n                            <div className=\"font-semibold\">\n                              Target:{\" \"}\n                              <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                                {DOUBLE_PRACTICE_ORDER[dpIndex]?.label || \"â€”\"}\n                              </span>\n                            </div>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  onAutoDart={(value, ring) => {\n                                    if (\n                                      ring === \"DOUBLE\" ||\n                                      ring === \"INNER_BULL\"\n                                    ) {\n                                      const hit = isDoubleHit(value, dpIndex);\n                                      if (hit) {\n                                        const nh = dpHits + 1;\n                                        const ni = dpIndex + 1;\n                                        setDpHits(nh);\n                                        setDpIndex(ni);\n                                        if (nh >= DOUBLE_PRACTICE_ORDER.length)\n                                          setTimeout(() => {\n                                            setDpHits(0);\n                                            setDpIndex(0);\n                                          }, 250);\n                                        return true;\n                                      }\n                                    }\n                                    return false;\n                                  }}\n                                  immediateAutoCommit\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-col gap-2\">\n                              <div className=\"flex items-center gap-2\">\n                                <input\n                                  className=\"input w-24\"\n                                  type=\"number\"\n                                  min={0}\n                                  max={60}\n                                  value={playerDartPoints}\n                                  onChange={(e) =>\n                                    setPlayerDartPoints(\n                                      Number(e.target.value || 0),\n                                    )\n                                  }\n                                  onKeyDown={(e) => {\n                                    if (e.key === \"Enter\") addDpNumeric();\n                                  }}\n                                />\n                                <button\n                                  className=\"btn px-3 py-1 text-sm\"\n                                  onClick={addDpNumeric}\n                                >\n                                  Add Dart\n                                </button>\n                              </div>\n                              <div className=\"flex items-center gap-2\">\n                                <input\n                                  className=\"input w-44\"\n                                  placeholder=\"Manual (D16, 50, 25, T20)\"\n                                  value={manualBox}\n                                  onChange={(e) => setManualBox(e.target.value)}\n                                  onKeyDown={(e) => {\n                                    if (e.key === \"Enter\") addDpManual();\n                                  }}\n                                />\n                                <button\n                                  className=\"btn px-3 py-1 text-sm\"\n                                  onClick={addDpManual}\n                                >\n                                  Add\n                                </button>\n                              </div>\n                            </div>\n                            <div className=\"text-xs text-slate-300\">\n                              Progress: {dpHits} of 21\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Around the Clock\" && (\n                          <>\n                            <div className=\"font-semibold\">\n                              Target:{\" \"}\n                              <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                                {ATC_ORDER[atcIndex] === 25\n                                  ? \"25 (Outer Bull)\"\n                                  : ATC_ORDER[atcIndex] === 50\n                                    ? \"50 (Inner Bull)\"\n                                    : ATC_ORDER[atcIndex] || \"â€”\"}\n                              </span>\n                            </div>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addAtcValue(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addAtcNumeric();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addAtcNumeric}\n                              >\n                                Add Dart\n                              </button>\n                            </div>\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-44\"\n                                placeholder=\"Manual (T20, D5, 25, 50)\"\n                                value={manualBox}\n                                onChange={(e) => setManualBox(e.target.value)}\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addAtcManual();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addAtcManual}\n                              >\n                                Add\n                              </button>\n                            </div>\n                            {atcHits >= ATC_ORDER.length && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={() => {\n                                    setAtcHits(0);\n                                    setAtcIndex(0);\n                                    resetDartCount(\"Around the Clock\");\n                                  }}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Cricket\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addCricketAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addCricketNumeric();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addCricketNumeric}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setCricket(createCricketState());\n                                  setPracticeTurnDarts(0);\n                                  resetDartCount(\"Cricket\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Shanghai\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addShanghaiAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addShanghaiNumeric();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addShanghaiNumeric}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setShanghai(createShanghaiState());\n                                  setPracticeTurnDarts(0);\n                                  resetDartCount(\"Shanghai\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Halve It\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addHalveAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addHalveNumeric();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addHalveNumeric}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setHalve(createDefaultHalveIt());\n                                  setPracticeTurnDarts(0);\n                                  resetDartCount(\"Halve It\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"High-Low\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addHighLowAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addHighLowNumeric();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addHighLowNumeric}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setHighlow(createHighLow());\n                                  setPracticeTurnDarts(0);\n                                  resetDartCount(\"High-Low\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Bob's 27\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addB27Auto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex flex-wrap items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addB27Numeric();\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={addB27Numeric}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetB27}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Count-Up\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any) => addCountUpAuto(value)}\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    addCountUpAuto(playerDartPoints);\n                                    setPlayerDartPoints(0);\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  addCountUpAuto(playerDartPoints);\n                                  setPlayerDartPoints(0);\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setCuRound(1);\n                                  setCuScore(0);\n                                  setCuDarts(0);\n                                  resetDartCount(\"Count-Up\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Round {cuRound}/{cuMaxRounds}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"High Score\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any) =>\n                                    addHighScoreAuto(value)\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    addHighScoreAuto(playerDartPoints);\n                                    setPlayerDartPoints(0);\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  addHighScoreAuto(playerDartPoints);\n                                  setPlayerDartPoints(0);\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setHsRound(1);\n                                  setHsScore(0);\n                                  setHsDarts(0);\n                                  resetDartCount(\"High Score\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Round {hsRound}/{hsMaxRounds}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Low Score\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any) => addLowScoreAuto(value)}\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={0}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    addLowScoreAuto(playerDartPoints);\n                                    setPlayerDartPoints(0);\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  addLowScoreAuto(playerDartPoints);\n                                  setPlayerDartPoints(0);\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setLsRound(1);\n                                  setLsScore(0);\n                                  setLsDarts(0);\n                                  resetDartCount(\"Low Score\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Round {lsRound}/{lsMaxRounds}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Checkout 170\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any) =>\n                                    addCo170Auto(\n                                      value,\n                                      ring === \"MISS\" ? undefined : ring,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"text\"\n                                placeholder=\"Manual (D16, T20)\"\n                                value={manualBox}\n                                onChange={(e) => setManualBox(e.target.value)}\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addCoManual(true);\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => addCoManual(true)}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetCo170}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Remaining: {co170Rem} Â· Attempts: {co170Attempts}{\" \"}\n                              Â· Successes: {co170Successes}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Checkout 121\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any) =>\n                                    addCo121Auto(\n                                      value,\n                                      ring === \"MISS\" ? undefined : ring,\n                                    )\n                                  }\n                                  onAddVisit={makeOfflineAddVisitAdapter(\n                                    commitManualVisitTotal,\n                                  )}\n                                  onEndLeg={(s?: number) =>\n                                    matchActions.endLeg(s)\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"text\"\n                                placeholder=\"Manual (D16, T20)\"\n                                value={manualBox}\n                                onChange={(e) => setManualBox(e.target.value)}\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") addCoManual(false);\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => addCoManual(false)}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetCo121}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Remaining: {co121Rem} Â· Attempts: {co121Attempts}{\" \"}\n                              Â· Successes: {co121Successes}\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Treble Practice\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addTrebleAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"text\"\n                                placeholder=\"Manual (T20)\"\n                                value={manualBox}\n                                onChange={(e) => setManualBox(e.target.value)}\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    const v = parseManualDart(manualBox);\n                                    if (v != null)\n                                      addTrebleAuto(v, undefined, undefined);\n                                    setManualBox(\"\");\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  const v = parseManualDart(manualBox);\n                                  if (v != null)\n                                    addTrebleAuto(v, undefined, undefined);\n                                  setManualBox(\"\");\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Hits: {trebleHits} Â· Misses:{\" \"}\n                              {Math.max(0, trebleDarts - trebleHits)} Â· Darts:{\" \"}\n                              {trebleDarts}\n                              {trebleMaxDarts > 0 ? `/${trebleMaxDarts}` : \"\"}\n                            </div>\n                            {trebleFinished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                Completed!{\" \"}\n                                <button\n                                  className=\"ml-2 underline\"\n                                  onClick={resetTreble}\n                                >\n                                  Reset\n                                </button>\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Baseball\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addBaseballAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetBaseball}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Golf\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addGolfAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetGolf}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Tic Tac Toe\" && (\n                          <>\n                            <div className=\"grid grid-cols-3 gap-1 mb-2\">\n                              {Array.from({ length: 9 }, (_, i) => i).map(\n                                (cell) => (\n                                  <button\n                                    key={cell}\n                                    className={`h-16 rounded-xl border ${ttt.board[cell] ? \"bg-emerald-500/20 border-emerald-400/30\" : \"bg-slate-800/50 border-slate-700/50\"}`}\n                                    onClick={() => {\n                                      if (ttt.finished || ttt.board[cell])\n                                        return;\n                                      // One-tap claim attempt using autoscore last dart; fallback: prompt numeric\n                                      // For simplicity here, we use a no-op value and rely on next autoscore dart; as a usable fallback, open a numeric prompt\n                                      const promptVal = Number(\n                                        prompt(\n                                          \"Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)\",\n                                        ) || 0,\n                                      );\n                                      const ring =\n                                        promptVal % 3 === 0\n                                          ? \"TRIPLE\"\n                                          : promptVal % 2 === 0\n                                            ? \"DOUBLE\"\n                                            : \"SINGLE\";\n                                      const tcell = cell as unknown as\n                                        | 0\n                                        | 1\n                                        | 2\n                                        | 3\n                                        | 4\n                                        | 5\n                                        | 6\n                                        | 7\n                                        | 8;\n                                      const tgt = TTT_TARGETS[tcell];\n                                      const num =\n                                        tgt.type === \"BULL\"\n                                          ? null\n                                          : tgt.num || null;\n                                      addTttAuto(\n                                        tcell,\n                                        promptVal,\n                                        ring as any,\n                                        num as any,\n                                      );\n                                    }}\n                                  >\n                                    {ttt.board[cell] || \"\"}\n                                  </button>\n                                ),\n                              )}\n                            </div>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(_value: any, _ring: any, _info: any) => {\n                                    // Attempt to claim the currently tapped-looking cell not tracked; as a simple flow, map by round-robin preference or let user click a cell button above.\n                                    // No-op here; primary interaction is via buttons with prompt for now.\n                                  }}\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetTtt}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"American Cricket\" && (\n                          <>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, info: any) =>\n                                    addAmCricketAuto(\n                                      value,\n                                      (ring === \"MISS\"\n                                        ? undefined\n                                        : ring) as any,\n                                      info?.sector ?? null,\n                                    )\n                                  }\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={resetAmCricket}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                          </>\n                        )}\n                        {selectedMode === \"Scam\" && (\n                          <>\n                            <div className=\"font-semibold\">\n                              Target:{\" \"}\n                              <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                                {SCAM_TARGET_NAMES[scamPlayer.targetIndex]}\n                              </span>\n                            </div>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, _info: any) => {\n                                    const r =\n                                      ring === \"MISS\" ? undefined : ring;\n                                    recordDart(\"Scam\");\n                                    setScamPlayer(\n                                      addScamAuto(scamPlayer, value, r as any),\n                                    );\n                                    return true;\n                                  }}\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={1}\n                                max={25}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    recordDart(\"Scam\");\n                                    setScamPlayer(\n                                      addScamNumeric(\n                                        scamPlayer,\n                                        playerDartPoints,\n                                      ),\n                                    );\n                                    setPlayerDartPoints(0);\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  recordDart(\"Scam\");\n                                  setScamPlayer(\n                                    addScamNumeric(\n                                      scamPlayer,\n                                      playerDartPoints,\n                                    ),\n                                  );\n                                  setPlayerDartPoints(0);\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setScamPlayer(resetScam());\n                                  resetDartCount(\"Scam\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            {scamPlayer.finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                ðŸŽ‰ Finished in {scamPlayer.darts} darts!\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Fives\" && (\n                          <>\n                            <div className=\"font-semibold\">\n                              Score:{\" \"}\n                              <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                                {fivesPlayer.score}/{fivesPlayer.target}\n                              </span>\n                            </div>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, _info: any) => {\n                                    recordDart(\"Fives\");\n                                    setFivesPlayer(\n                                      addFivesAuto(\n                                        fivesPlayer,\n                                        value,\n                                        ring as any,\n                                      ),\n                                    );\n                                    return true;\n                                  }}\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={5}\n                                max={50}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    recordDart(\"Fives\");\n                                    setFivesPlayer(\n                                      addFivesNumeric(\n                                        fivesPlayer,\n                                        playerDartPoints,\n                                      ),\n                                    );\n                                    setPlayerDartPoints(0);\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  recordDart(\"Fives\");\n                                  setFivesPlayer(\n                                    addFivesNumeric(\n                                      fivesPlayer,\n                                      playerDartPoints,\n                                    ),\n                                  );\n                                  setPlayerDartPoints(0);\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setFivesPlayer(\n                                    resetFives(fivesPlayer.target),\n                                  );\n                                  resetDartCount(\"Fives\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:{\" \"}\n                              {fivesPlayer.darts}\n                            </div>\n                            {fivesPlayer.finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                âœ“ Reached {fivesPlayer.target} in{\" \"}\n                                {fivesPlayer.darts} darts!\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Sevens\" && (\n                          <>\n                            <div className=\"font-semibold\">\n                              Score:{\" \"}\n                              <span className=\"px-2 py-0.5 rounded-full bg-white/10 border border-white/10\">\n                                {sevensPlayer.score}/{sevensPlayer.target}\n                              </span>\n                            </div>\n                            {cameraEnabled && (\n                              <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                <CameraView\n                                  scoringMode=\"custom\"\n                                  showToolbar={cameraToolbarVisible}\n                                  immediateAutoCommit\n                                  onAutoDart={(value: any, ring: any, _info: any) => {\n                                    recordDart(\"Sevens\");\n                                    setSevensPlayer(\n                                      addSevensAuto(\n                                        sevensPlayer,\n                                        value,\n                                        ring as any,\n                                      ),\n                                    );\n                                    return true;\n                                  }}\n                                />\n                              </div>\n                            )}\n                            <div className=\"flex items-center gap-2\">\n                              <input\n                                className=\"input w-24\"\n                                type=\"number\"\n                                min={7}\n                                max={21}\n                                value={playerDartPoints}\n                                onChange={(e) =>\n                                  setPlayerDartPoints(\n                                    Number(e.target.value || 0),\n                                  )\n                                }\n                                onKeyDown={(e) => {\n                                  if (e.key === \"Enter\") {\n                                    recordDart(\"Sevens\");\n                                    setSevensPlayer(\n                                      addSevensNumeric(\n                                        sevensPlayer,\n                                        playerDartPoints,\n                                      ),\n                                    );\n                                    setPlayerDartPoints(0);\n                                  }\n                                }}\n                              />\n                              <button\n                                className=\"btn px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  recordDart(\"Sevens\");\n                                  setSevensPlayer(\n                                    addSevensNumeric(\n                                      sevensPlayer,\n                                      playerDartPoints,\n                                    ),\n                                  );\n                                  setPlayerDartPoints(0);\n                                }}\n                              >\n                                Add Dart\n                              </button>\n                              <button\n                                className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                onClick={() => {\n                                  setSevensPlayer(\n                                    resetSevens(sevensPlayer.target),\n                                  );\n                                  resetDartCount(\"Sevens\");\n                                }}\n                              >\n                                Reset\n                              </button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              Valid scores: 7, 14, 21 Â· Darts:{\" \"}\n                              {sevensPlayer.darts}\n                            </div>\n                            {sevensPlayer.finished && (\n                              <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                âœ“ Reached {sevensPlayer.target} in{\" \"}\n                                {sevensPlayer.darts} darts!\n                              </div>\n                            )}\n                          </>\n                        )}\n                        {selectedMode === \"Killer\" && (\n                          <>\n                            {!killerSetupDone ? (\n                              <div className=\"space-y-2\">\n                                <div className=\"font-semibold\">Players</div>\n                                <div className=\"space-y-1\">\n                                  {killerPlayers.map((p, idx) => (\n                                    <div\n                                      key={p.id}\n                                      className=\"flex items-center gap-2\"\n                                    >\n                                      <input\n                                        className=\"input\"\n                                        value={p.name}\n                                        onChange={(e) => {\n                                          const name = e.target.value;\n                                          setKillerPlayers((list) =>\n                                            list.map((it, i) =>\n                                              i === idx ? { ...it, name } : it,\n                                            ),\n                                          );\n                                        }}\n                                      />\n                                      <button\n                                        className=\"btn px-2 py-1\"\n                                        onClick={() =>\n                                          setKillerPlayers((list) =>\n                                            list.filter((_, i) => i !== idx),\n                                          )\n                                        }\n                                        disabled={killerPlayers.length <= 2}\n                                      >\n                                        Remove\n                                      </button>\n                                    </div>\n                                  ))}\n                                </div>\n                                <div className=\"flex items-center gap-2\">\n                                  <button\n                                    className=\"btn px-2 py-1\"\n                                    onClick={() =>\n                                      setKillerPlayers((list) => {\n                                        const id = `p${list.length + 1}`;\n                                        return [\n                                          ...list,\n                                          {\n                                            id,\n                                            name: `Player ${list.length + 1}`,\n                                          },\n                                        ];\n                                      })\n                                    }\n                                  >\n                                    Add Player\n                                  </button>\n                                  <button\n                                    className=\"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1\"\n                                    onClick={() => {\n                                      if (killerPlayers.length < 2) {\n                                        alert(\"Need at least 2 players\");\n                                        return;\n                                      }\n                                      const ids = killerPlayers.map(\n                                        (p) => p.id,\n                                      );\n                                      const assigned = assignKillerNumbers(ids);\n                                      const initStates: Record<\n                                        string,\n                                        KillerState\n                                      > = {};\n                                      ids.forEach((id) => {\n                                        initStates[id] = createKillerState(\n                                          assigned[id],\n                                        );\n                                      });\n                                      setKillerAssigned(assigned);\n                                      setKillerStates(initStates);\n                                      setKillerTurnIdx(0);\n                                      setKillerDarts(0);\n                                      setKillerWinnerId(null);\n                                      setKillerLastEvent(\"Assigned numbers\");\n                                      setKillerSetupDone(true);\n                                    }}\n                                  >\n                                    Assign Numbers & Start\n                                  </button>\n                                </div>\n                              </div>\n                            ) : (\n                              <div className=\"space-y-3\">\n                                {/* Turn indicator + dart count */}\n                                <div className=\"flex items-center justify-between text-xs mb-1\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <span className=\"opacity-60\">Turn:</span>\n                                    <span className=\"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 font-bold\">\n                                      {killerPlayers[killerTurnIdx]?.name || \"â€”\"}\n                                    </span>\n                                  </div>\n                                  <div className=\"flex items-center gap-1\">\n                                    <span className=\"opacity-60\">Dart</span>\n                                    <span className=\"font-mono font-bold\">{killerDarts + 1}/3</span>\n                                  </div>\n                                </div>\n                                <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                                  {killerPlayers.map((p) => {\n                                    const st = killerStates[p.id];\n                                    const num = killerAssigned[p.id];\n                                    const isTurn = p.id === killerPlayers[killerTurnIdx]?.id;\n                                    return (\n                                      <div\n                                        key={p.id}\n                                        className={`p-2 rounded-xl border ${\n                                          st?.eliminated\n                                            ? \"opacity-50 border-red-500/40 bg-red-500/10\"\n                                            : isTurn\n                                              ? \"border-emerald-400/50 bg-emerald-500/10 ring-1 ring-emerald-400/30\"\n                                              : \"border-slate-700/50 bg-slate-800/50\"\n                                        }`}\n                                      >\n                                        <div className=\"flex items-center justify-between text-xs\">\n                                          <div className=\"font-semibold\">\n                                            {p.name}\n                                            {isTurn && <span className=\"ml-1 text-emerald-300\">â—€</span>}\n                                          </div>\n                                          <div\n                                            className={`text-[10px] px-1.5 py-0.5 rounded ${st?.isKiller ? \"bg-purple-500/20 text-purple-200 border border-purple-400/30\" : \"bg-slate-600/30 text-slate-300\"}`}\n                                          >\n                                            {st?.isKiller\n                                              ? \"ðŸ—¡ Killer\"\n                                              : \"Not Killer\"}\n                                          </div>\n                                        </div>\n                                        <div className=\"mt-1 text-lg font-extrabold tracking-tight\">\n                                          D{num}\n                                        </div>\n                                        <div className=\"text-sm\">\n                                          Lives:{\" \"}\n                                          <span className=\"font-semibold\">\n                                            {\"â¤ï¸\".repeat(st?.lives ?? 0)}\n                                            {(st?.lives ?? 0) === 0 && \"ðŸ’€\"}\n                                          </span>\n                                        </div>\n                                        {/* Hit / Miss pills */}\n                                        {!st?.eliminated && !killerWinnerId && (\n                                          <div className=\"mt-2 flex items-center gap-1.5\">\n                                            <button\n                                              className=\"px-2.5 py-1 rounded-full text-[11px] font-semibold bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 hover:bg-emerald-500/30 transition-colors disabled:opacity-40\"\n                                              disabled={!!killerWinnerId}\n                                              onClick={() => {\n                                                if (killerWinnerId) return;\n                                                const cur = killerPlayers[killerTurnIdx];\n                                                if (!cur) return;\n                                                setKillerStates((prev) => {\n                                                  const copy: Record<string, KillerState> = {};\n                                                  Object.keys(prev).forEach((k) => (copy[k] = { ...prev[k] }));\n                                                  const res = applyKillerDart(cur.id, copy, \"DOUBLE\", num);\n                                                  if (res.becameKiller)\n                                                    setKillerLastEvent(`${cur.name} became a Killer!`);\n                                                  else if (res.victimId) {\n                                                    if (res.victimId === cur.id)\n                                                      setKillerLastEvent(`${cur.name} hit own D${num}! Lost a life`);\n                                                    else {\n                                                      const v = killerPlayers.find((pp) => pp.id === res.victimId);\n                                                      setKillerLastEvent(`${cur.name} hit ${v?.name}'s D${killerAssigned[res.victimId!]} (-${res.livesRemoved} life)`);\n                                                    }\n                                                  } else\n                                                    setKillerLastEvent(\"No effect\");\n                                                  const win = killerWinner(copy);\n                                                  if (win) setKillerWinnerId(win);\n                                                  return copy;\n                                                });\n                                                setKillerDarts((d) => {\n                                                  const nd = d + 1;\n                                                  if (nd >= 3) {\n                                                    let next = killerTurnIdx;\n                                                    for (let i = 1; i <= killerPlayers.length; i++) {\n                                                      const idx = (killerTurnIdx + i) % killerPlayers.length;\n                                                      const pid = killerPlayers[idx].id;\n                                                      const pst = killerStates[pid];\n                                                      if (pst && !pst.eliminated && pst.lives > 0) {\n                                                        next = idx;\n                                                        break;\n                                                      }\n                                                    }\n                                                    setKillerTurnIdx(next);\n                                                    return 0;\n                                                  }\n                                                  return nd;\n                                                });\n                                              }}\n                                            >\n                                              Hit D{num}\n                                            </button>\n                                            <button\n                                              className=\"px-2.5 py-1 rounded-full text-[11px] font-semibold bg-slate-600/30 text-slate-300 border border-slate-500/30 hover:bg-slate-600/40 transition-colors disabled:opacity-40\"\n                                              disabled={!!killerWinnerId}\n                                              onClick={() => {\n                                                if (killerWinnerId) return;\n                                                setKillerLastEvent(\"Miss â€” no effect\");\n                                                setKillerDarts((d) => {\n                                                  const nd = d + 1;\n                                                  if (nd >= 3) {\n                                                    let next = killerTurnIdx;\n                                                    for (let i = 1; i <= killerPlayers.length; i++) {\n                                                      const idx = (killerTurnIdx + i) % killerPlayers.length;\n                                                      const pid = killerPlayers[idx].id;\n                                                      const pst = killerStates[pid];\n                                                      if (pst && !pst.eliminated && pst.lives > 0) {\n                                                        next = idx;\n                                                        break;\n                                                      }\n                                                    }\n                                                    setKillerTurnIdx(next);\n                                                    return 0;\n                                                  }\n                                                  return nd;\n                                                });\n                                              }}\n                                            >\n                                              Miss\n                                            </button>\n                                          </div>\n                                        )}\n                                      </div>\n                                    );\n                                  })}\n                                </div>\n                                {cameraEnabled && (\n                                  <div className=\"rounded-2xl overflow-hidden bg-black\">\n                                    <CameraView\n                                      scoringMode=\"custom\"\n                                      showToolbar={cameraToolbarVisible}\n                                      immediateAutoCommit\n                                      onAutoDart={(value: any, ring: any, info: any) => {\n                                        if (killerWinnerId) return false;\n                                        const r =\n                                          ring === \"MISS\" ? undefined : ring;\n                                        const sector = info?.sector ?? null;\n                                        const cur =\n                                          killerPlayers[killerTurnIdx];\n                                        if (!cur) return false;\n                                        setKillerStates((prev) => {\n                                          const copy: Record<\n                                            string,\n                                            KillerState\n                                          > = {};\n                                          Object.keys(prev).forEach(\n                                            (k) => (copy[k] = { ...prev[k] }),\n                                          );\n                                          const res = applyKillerDart(\n                                            cur.id,\n                                            copy,\n                                            r as any,\n                                            sector,\n                                          );\n                                          if (res.becameKiller)\n                                            setKillerLastEvent(\n                                              `${cur.name} became a Killer`,\n                                            );\n                                          else if (res.victimId) {\n                                            const v = killerPlayers.find(\n                                              (p) => p.id === res.victimId,\n                                            );\n                                            setKillerLastEvent(\n                                              `${cur.name} hit ${v?.name}'s ${killerAssigned[res.victimId]} (${res.livesRemoved} life${(res.livesRemoved || 0) > 1 ? \"s\" : \"\"})`,\n                                            );\n                                          } else\n                                            setKillerLastEvent(\"No effect\");\n                                          // Check winner\n                                          const win = killerWinner(copy);\n                                          if (win) setKillerWinnerId(win);\n                                          return copy;\n                                        });\n                                        setKillerDarts((d) => {\n                                          const nd = d + 1;\n                                          if (nd >= 3) {\n                                            // advance to next alive\n                                            let next = killerTurnIdx;\n                                            for (\n                                              let i = 1;\n                                              i <= killerPlayers.length;\n                                              i++\n                                            ) {\n                                              const idx =\n                                                (killerTurnIdx + i) %\n                                                killerPlayers.length;\n                                              const pid = killerPlayers[idx].id;\n                                              const st = killerStates[pid];\n                                              if (\n                                                st &&\n                                                !st.eliminated &&\n                                                st.lives > 0\n                                              ) {\n                                                next = idx;\n                                                break;\n                                              }\n                                            }\n                                            setKillerTurnIdx(next);\n                                            return 0;\n                                          }\n                                          return nd;\n                                        });\n                                        return true;\n                                      }}\n                                    />\n                                  </div>\n                                )}\n                                <div className=\"flex items-center gap-2\">\n                                  <input\n                                    className=\"input w-40\"\n                                    placeholder=\"Manual (D16, T5)\"\n                                    value={manualBox}\n                                    onChange={(e) =>\n                                      setManualBox(e.target.value)\n                                    }\n                                    onKeyDown={(e) => {\n                                      if (e.key === \"Enter\") {\n                                        if (killerWinnerId) return;\n                                        const t = manualBox\n                                          .trim()\n                                          .toUpperCase();\n                                        const m = t.match(\n                                          /^(S|D|T)?\\s*(\\d{1,2})$/,\n                                        );\n                                        if (!m) {\n                                          setManualBox(\"\");\n                                          return;\n                                        }\n                                        const mult = (m[1] || \"S\") as\n                                          | \"S\"\n                                          | \"D\"\n                                          | \"T\";\n                                        const num = parseInt(m[2], 10);\n                                        const ring =\n                                          mult === \"D\"\n                                            ? \"DOUBLE\"\n                                            : mult === \"T\"\n                                              ? \"TRIPLE\"\n                                              : \"SINGLE\";\n                                        const cur =\n                                          killerPlayers[killerTurnIdx];\n                                        setKillerStates((prev) => {\n                                          const copy: Record<\n                                            string,\n                                            KillerState\n                                          > = {};\n                                          Object.keys(prev).forEach(\n                                            (k) => (copy[k] = { ...prev[k] }),\n                                          );\n                                          const res = applyKillerDart(\n                                            cur.id,\n                                            copy,\n                                            ring as any,\n                                            num,\n                                          );\n                                          if (res.becameKiller)\n                                            setKillerLastEvent(\n                                              `${cur.name} became a Killer`,\n                                            );\n                                          else if (res.victimId) {\n                                            const v = killerPlayers.find(\n                                              (p) => p.id === res.victimId,\n                                            );\n                                            setKillerLastEvent(\n                                              `${cur.name} hit ${v?.name}'s ${killerAssigned[res.victimId]} (${res.livesRemoved} life${(res.livesRemoved || 0) > 1 ? \"s\" : \"\"})`,\n                                            );\n                                          } else\n                                            setKillerLastEvent(\"No effect\");\n                                          const win = killerWinner(copy);\n                                          if (win) setKillerWinnerId(win);\n                                          return copy;\n                                        });\n                                        setManualBox(\"\");\n                                        setKillerDarts((d) => {\n                                          const nd = d + 1;\n                                          if (nd >= 3) {\n                                            let next = killerTurnIdx;\n                                            for (\n                                              let i = 1;\n                                              i <= killerPlayers.length;\n                                              i++\n                                            ) {\n                                              const idx =\n                                                (killerTurnIdx + i) %\n                                                killerPlayers.length;\n                                              const pid = killerPlayers[idx].id;\n                                              const st = killerStates[pid];\n                                              if (\n                                                st &&\n                                                !st.eliminated &&\n                                                st.lives > 0\n                                              ) {\n                                                next = idx;\n                                                break;\n                                              }\n                                            }\n                                            setKillerTurnIdx(next);\n                                            return 0;\n                                          }\n                                          return nd;\n                                        });\n                                      }\n                                    }}\n                                  />\n                                  <button\n                                    className=\"btn px-3 py-1 text-sm\"\n                                    onClick={() => {\n                                      // Skip to next alive player\n                                      let next = killerTurnIdx;\n                                      for (\n                                        let i = 1;\n                                        i <= killerPlayers.length;\n                                        i++\n                                      ) {\n                                        const idx =\n                                          (killerTurnIdx + i) %\n                                          killerPlayers.length;\n                                        const pid = killerPlayers[idx].id;\n                                        const st = killerStates[pid];\n                                        if (\n                                          st &&\n                                          !st.eliminated &&\n                                          st.lives > 0\n                                        ) {\n                                          next = idx;\n                                          break;\n                                        }\n                                      }\n                                      setKillerTurnIdx(next);\n                                      setKillerDarts(0);\n                                    }}\n                                  >\n                                    Next Player\n                                  </button>\n                                  <button\n                                    className=\"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm\"\n                                    onClick={() => {\n                                      // Reset Killer\n                                      setKillerStates({});\n                                      setKillerAssigned({});\n                                      setKillerSetupDone(false);\n                                      setKillerTurnIdx(0);\n                                      setKillerDarts(0);\n                                      setKillerWinnerId(null);\n                                      setKillerLastEvent(\"\");\n                                    }}\n                                  >\n                                    Reset\n                                  </button>\n                                </div>\n                                {killerWinnerId && (\n                                  <div className=\"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block\">\n                                    Winner:{\" \"}\n                                    {\n                                      killerPlayers.find(\n                                        (p) => p.id === killerWinnerId,\n                                      )?.name\n                                    }{\" \"}\n                                    <button\n                                      className=\"ml-2 underline\"\n                                      onClick={() => {\n                                        setKillerStates({});\n                                        setKillerAssigned({});\n                                        setKillerSetupDone(false);\n                                        setKillerTurnIdx(0);\n                                        setKillerDarts(0);\n                                        setKillerWinnerId(null);\n                                        setKillerLastEvent(\"\");\n                                      }}\n                                    >\n                                      Play Again\n                                    </button>\n                                  </div>\n                                )}\n                              </div>\n                            )}\n                          </>\n                        )}\n                              </div>\n                            </div>\n\n                            <div className=\"col-span-12 md:col-span-4 space-y-3\">\n                              <div className=\"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg\">\n                                <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                                  <div className=\"rounded-lg bg-black/30 px-2 py-1\">\n                                    <div className=\"uppercase tracking-wide text-white/50\">\n                                      {selectedMode === \"Double Practice\" ? \"Target\" :\n                                       selectedMode === \"Around the Clock\" ? \"Target\" :\n                                       selectedMode === \"Cricket\" ? \"Marks\" :\n                                       selectedMode === \"Shanghai\" ? \"Score\" :\n                                       selectedMode === \"Halve It\" ? \"Score\" :\n                                       selectedMode === \"High-Low\" ? \"Score\" :\n                                       selectedMode === \"Bob's 27\" ? \"Score\" :\n                                       selectedMode === \"Count-Up\" ? \"Score\" :\n                                       selectedMode === \"High Score\" ? \"Score\" :\n                                       selectedMode === \"Low Score\" ? \"Score\" :\n                                       selectedMode === \"Checkout 121\" ? \"Remaining\" :\n                                       selectedMode === \"Checkout 170\" ? \"Remaining\" :\n                                       selectedMode === \"Treble Practice\" ? \"Target\" :\n                                       selectedMode === \"Baseball\" ? \"Score\" :\n                                       selectedMode === \"Golf\" ? \"Strokes\" :\n                                       selectedMode === \"Tic Tac Toe\" ? \"Board\" :\n                                       selectedMode === \"American Cricket\" ? \"Points\" :\n                                       selectedMode === \"Killer\" ? \"Lives\" :\n                                       selectedMode === \"Scam\" ? \"Progress\" :\n                                       selectedMode === \"Fives\" ? \"Score\" :\n                                       selectedMode === \"Sevens\" ? \"Score\" :\n                                       \"Current\"}\n                                    </div>\n                                    <div className=\"text-lg font-bold text-white\">\n                                      {selectedMode === \"Double Practice\" ? (DOUBLE_PRACTICE_ORDER[dpIndex]?.label || \"Done\") :\n                                       selectedMode === \"Around the Clock\" ? (\n                                         ATC_ORDER[atcIndex] === 25 ? \"Bull\" :\n                                         ATC_ORDER[atcIndex] === 50 ? \"D-Bull\" :\n                                         ATC_ORDER[atcIndex] || \"Done\"\n                                       ) :\n                                       selectedMode === \"Cricket\" ? (cricket.marks ? Object.values(cricket.marks).reduce((a: number, b: number) => a + b, 0) : 0) :\n                                       selectedMode === \"Shanghai\" ? shanghai.score :\n                                       selectedMode === \"Halve It\" ? halve.score :\n                                       selectedMode === \"High-Low\" ? highlow.score :\n                                       selectedMode === \"Bob's 27\" ? b27Score :\n                                       selectedMode === \"Count-Up\" ? cuScore :\n                                       selectedMode === \"High Score\" ? hsScore :\n                                       selectedMode === \"Low Score\" ? lsScore :\n                                       selectedMode === \"Checkout 121\" ? co121Rem :\n                                       selectedMode === \"Checkout 170\" ? co170Rem :\n                                       selectedMode === \"Treble Practice\" ? `T${trebleTarget}` :\n                                       selectedMode === \"Baseball\" ? baseball.score :\n                                       selectedMode === \"Golf\" ? golf.strokes :\n                                       selectedMode === \"Tic Tac Toe\" ? \"â€”\" :\n                                       selectedMode === \"American Cricket\" ? (amCricket.points ?? 0) :\n                                       selectedMode === \"Killer\" ? \"â€”\" :\n                                       selectedMode === \"Scam\" ? `${scamPlayer.targetIndex}/${21}` :\n                                       selectedMode === \"Fives\" ? fivesPlayer.score :\n                                       selectedMode === \"Sevens\" ? sevensPlayer.score :\n                                       activeRemaining}\n                                    </div>\n                                  </div>\n                                  <div className=\"rounded-lg bg-black/30 px-2 py-1\">\n                                    <div className=\"uppercase tracking-wide text-white/50\">\n                                      {selectedMode === \"Double Practice\" ? \"Hits\" :\n                                       selectedMode === \"Around the Clock\" ? \"Progress\" :\n                                       selectedMode === \"Cricket\" ? \"Points\" :\n                                       selectedMode === \"Shanghai\" ? \"Round\" :\n                                       selectedMode === \"Halve It\" ? \"Round\" :\n                                       selectedMode === \"High-Low\" ? \"Round\" :\n                                       selectedMode === \"Bob's 27\" ? \"Doubles hit\" :\n                                       selectedMode === \"Count-Up\" ? \"Round\" :\n                                       selectedMode === \"High Score\" ? \"Round\" :\n                                       selectedMode === \"Low Score\" ? \"Round\" :\n                                       selectedMode === \"Checkout 121\" ? \"Darts left\" :\n                                       selectedMode === \"Checkout 170\" ? \"Darts left\" :\n                                       selectedMode === \"Treble Practice\" ? \"Hits\" :\n                                       selectedMode === \"Baseball\" ? \"Inning\" :\n                                       selectedMode === \"Golf\" ? \"Hole\" :\n                                       selectedMode === \"Tic Tac Toe\" ? \"Turn\" :\n                                       selectedMode === \"American Cricket\" ? \"Marks\" :\n                                       selectedMode === \"Killer\" ? \"Players\" :\n                                       selectedMode === \"Scam\" ? \"Darts\" :\n                                       selectedMode === \"Fives\" ? \"Target\" :\n                                       selectedMode === \"Sevens\" ? \"Target\" :\n                                       \"3-dart avg\"}\n                                    </div>\n                                    <div className=\"text-lg font-bold text-emerald-300\">\n                                      {selectedMode === \"Double Practice\" ? `${dpHits}/${DOUBLE_PRACTICE_ORDER.length}` :\n                                       selectedMode === \"Around the Clock\" ? `${atcHits}/${ATC_ORDER.length}` :\n                                       selectedMode === \"Cricket\" ? cricket.points :\n                                       selectedMode === \"Shanghai\" ? `${shanghai.round}/7` :\n                                       selectedMode === \"Halve It\" ? `${halve.stage + 1}` :\n                                       selectedMode === \"High-Low\" ? `${highlow.round}` :\n                                       selectedMode === \"Bob's 27\" ? b27Hits :\n                                       selectedMode === \"Count-Up\" ? `${cuRound}/${cuMaxRounds}` :\n                                       selectedMode === \"High Score\" ? `${hsRound}/${hsMaxRounds}` :\n                                       selectedMode === \"Low Score\" ? `${lsRound}/${lsMaxRounds}` :\n                                       selectedMode === \"Checkout 121\" ? Math.max(0, 6 - co121Attempts * 3 - co121Darts) :\n                                       selectedMode === \"Checkout 170\" ? Math.max(0, 6 - co170Attempts * 3 - co170Darts) :\n                                       selectedMode === \"Treble Practice\" ? `${trebleHits} / ${trebleDarts}` :\n                                       selectedMode === \"Baseball\" ? `${baseball.inning}/9` :\n                                       selectedMode === \"Golf\" ? `${golf.hole}/18` :\n                                       selectedMode === \"Tic Tac Toe\" ? ttt.turn :\n                                       selectedMode === \"American Cricket\" ? (amCricket.marks ? Object.values(amCricket.marks).reduce((a: number, b: number) => a + b, 0) : 0) :\n                                       selectedMode === \"Killer\" ? killerPlayers.length :\n                                       selectedMode === \"Scam\" ? scamPlayer.darts :\n                                       selectedMode === \"Fives\" ? fivesPlayer.target :\n                                       selectedMode === \"Sevens\" ? sevensPlayer.target :\n                                       _runningAvg.toFixed(1)}\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg\">\n                                <div className=\"text-xs uppercase tracking-wide text-white/50 mb-1\">\n                                  Scoreboard\n                                </div>\n                                <GameScoreboard\n                                  gameMode={selectedMode as any}\n                                  players={scoreboardPlayers}\n                                  matchScore={scoreboardMatchScore}\n                                />\n                                {supportsQuickScore && (\n                                  <div className=\"mt-3 rounded-xl border border-white/10 bg-black/20 p-3\">\n                                    <div className=\"text-xs uppercase tracking-wide text-white/50\">\n                                      Quick score\n                                    </div>\n                                    <div className=\"mt-2 flex items-center gap-2\">\n                                      <input\n                                        ref={quickScoreInputRef}\n                                        className=\"input w-24 text-center\"\n                                        type=\"number\"\n                                        inputMode=\"numeric\"\n                                        value={quickScoreInput}\n                                        onChange={(e) =>\n                                          setQuickScoreInput(e.target.value)\n                                        }\n                                        onKeyDown={(e) => {\n                                          if (e.key === \"Enter\")\n                                            commitQuickScore();\n                                        }}\n                                        readOnly={isMobileScreen}\n                                      />\n                                      <button\n                                        className=\"btn px-3 py-1 text-sm\"\n                                        onClick={commitQuickScore}\n                                      >\n                                        Add\n                                      </button>\n                                    </div>\n                                    <ScoreNumberPad\n                                      className=\"mt-2 scale-90 origin-top-left\"\n                                      value={quickScoreInput}\n                                      onChange={setQuickScoreInput}\n                                      onSubmit={commitQuickScore}\n                                      label=\"\"\n                                      helperText={\n                                        isMobileScreen\n                                          ? \"Tap the pad to enter the score.\"\n                                          : \"Type numbers or tap the pad, then Enter.\"\n                                      }\n                                    />\n                                  </div>\n                                )}n                               </div>\n                            </div>\n\n                            <div className=\"col-span-12 md:col-span-4\">\n                              <div className=\"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg\">\n                                <div className=\"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm\">\n                                  <span>Board camera</span>\n                                  {!cameraEnabled && (\n                                    <span className=\"text-amber-300 font-semibold\">\n                                      Camera disabled\n                                    </span>\n                                  )}\n                                </div>\n                                {cameraEnabled ? (\n                                  <div className=\"bg-black aspect-video max-h-[30vh] md:max-h-[420px]\">\n                                    <MemoCameraView\n                                      scoringMode=\"custom\"\n                                      showToolbar={false}\n                                      immediateAutoCommit\n                                      onAutoDart={() => false}\n                                    />\n                                  </div>\n                                ) : (\n                                  <div className=\"p-4 text-sm text-slate-200/80\">\n                                    Enable the camera to keep the board visible\n                                    while you score.\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-2\">\n                        <div className=\"font-semibold\">Your Turn</div>\n                        <div className=\"flex flex-col gap-4\">\n                          <div className=\"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start\">\n                            <div className=\"col-span-12 md:col-span-4 space-y-3\">\n                              <div className=\"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg\">\n                                <div className=\"text-xs uppercase tracking-wide text-white/50 mb-2\">\n                                  Visit total\n                                </div>\n                                <div className=\"flex flex-wrap items-center gap-2\">\n                                  <input\n                                    className=\"input w-28\"\n                                    type=\"number\"\n                                    min={0}\n                                    max={playerScore <= 170 ? 170 : 180}\n                                    placeholder=\"0â€“180\"\n                                    value={visitTotalInput}\n                                    onChange={(e) =>\n                                      handleVisitTotalChange(e.target.value)\n                                    }\n                                    onKeyDown={(e) => {\n                                      if (e.key === \"Enter\") addVisitTotal();\n                                    }}\n                                  />\n                                  <button\n                                    className=\"btn px-4 py-1 text-sm\"\n                                    onClick={addVisitTotal}\n                                    title=\"Commit a full 3-dart total like 93\"\n                                  >\n                                    Commit Visit\n                                  </button>\n                                </div>\n                                <div className=\"mt-3\">\n                                  <ScoreNumberPad\n                                    value={visitTotalInput}\n                                    onChange={handleVisitTotalChange}\n                                    onSubmit={addVisitTotal}\n                                    helperText=\"Tap numbers then Enter to commit the visit total.\"\n                                  />\n                                </div>\n                              </div>\n                            </div>\n\n                            <div className=\"col-span-12 md:col-span-4 space-y-3\">\n                              <div className=\"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg\">\n                                <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                                  <div className=\"rounded-lg bg-black/30 px-2 py-1\">\n                                    <div className=\"uppercase tracking-wide text-white/50\">\n                                      Current score\n                                    </div>\n                                    <div className=\"text-lg font-bold text-white\">\n                                      {activeRemaining}\n                                    </div>\n                                  </div>\n                                  <div className=\"rounded-lg bg-black/30 px-2 py-1\">\n                                    <div className=\"uppercase tracking-wide text-white/50\">\n                                      3-dart avg\n                                    </div>\n                                    <div className=\"text-lg font-bold text-emerald-300\">\n                                      {_runningAvg.toFixed(1)}\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                              <div className=\"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg\">\n                                <div className=\"text-xs uppercase tracking-wide text-white/50 mb-1\">\n                                  Scoreboard\n                                </div>\n                                <GameScoreboard\n                                  gameMode={selectedMode as any}\n                                  players={singlePlayerScoreboard}\n                                  matchScore={scoreboardMatchScore}\n                                />\n                              </div>\n                            </div>\n\n                            <div className=\"col-span-12 md:col-span-4\">\n                              <div className=\"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg\">\n                                <div className=\"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm\">\n                                  <span>Board camera</span>\n                                  {!cameraEnabled && (\n                                    <span className=\"text-amber-300 font-semibold\">\n                                      Camera disabled\n                                    </span>\n                                  )}\n                                </div>\n                                {cameraEnabled ? (\n                                  <div className=\"bg-black aspect-video max-h-[30vh] md:max-h-[420px]\">\n                                    <MemoCameraView\n                                      scoringMode=\"custom\"\n                                      showToolbar={false}\n                                      immediateAutoCommit\n                                      onAutoDart={() => false}\n                                    />\n                                  </div>\n                                ) : (\n                                  <div className=\"p-4 text-sm text-slate-200/80\">\n                                    Enable the camera to keep the board visible\n                                    while you score.\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n\n                          <div className=\"text-xs text-slate-300\">\n                            Tip: Tap numbers then Enter to commit a 3-dart\n                            visit.\n                          </div>\n                        </div>\n                        {/* Scorecard only (camera sidebar removed for wider layout) */}\n                        <div className=\"flex flex-col gap-3 min-h-0 flex-1 text-[14px]\">\n                          <div\n                            className=\"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm\"\n                            style={{\n                              willChange: \"scroll-position\",\n                              transform: \"translateZ(0)\",\n                              WebkitOverflowScrolling: \"touch\",\n                            }}\n                          ></div>\n                        </div>\n                        {/* Camera view for Cricket auto-scoring */}\n                        {(selectedMode as any) === \"Cricket\" &&\n                          cameraEnabled && (\n                            <div className=\"rounded-2xl overflow-hidden bg-black\">\n                              <CameraView\n                                scoringMode=\"custom\"\n                                showToolbar={cameraToolbarVisible}\n                                immediateAutoCommit\n                                onAutoDart={(value: any, ring: any, info: any) => {\n                                  if (value > 0) {\n                                    const r =\n                                      ring === \"MISS\" ? undefined : ring;\n                                    addCricketAuto(\n                                      value,\n                                      r as any,\n                                      info?.sector ?? null,\n                                    );\n                                    return true;\n                                  }\n                                }}\n                              />\n                            </div>\n                          )}\n                        {(selectedMode as any) === \"Shanghai\" && (\n                          <>\n                            <GameScoreboard\n                              gameMode=\"Shanghai\"\n                              players={statsShanghai}\n                            />\n                          </>\n                        )}\n                        {/* Camera view for Shanghai auto-scoring */}\n                        {(selectedMode as any) === \"Shanghai\" &&\n                          cameraEnabled && (\n                            <div className=\"rounded-2xl overflow-hidden bg-black\">\n                              <CameraView\n                                scoringMode=\"custom\"\n                                showToolbar={cameraToolbarVisible}\n                                immediateAutoCommit\n                                onAutoDart={(value: any, ring: any, info: any) => {\n                                  if (value > 0) {\n                                    const r =\n                                      ring === \"MISS\" ? undefined : ring;\n                                    addShanghaiAuto(\n                                      value,\n                                      r as any,\n                                      info?.sector ?? null,\n                                    );\n                                    return true;\n                                  }\n                                }}\n                              />\n                            </div>\n                          )}\n                        {(selectedMode as any) === \"Killer\" && (\n                          <>\n                            <GameScoreboard\n                              gameMode=\"Killer\"\n                              players={statsKiller}\n                            />\n                          </>\n                        )}\n                        {(selectedMode as any) === \"Scam\" && (\n                          <>\n                            <GameScoreboard\n                              gameMode=\"Scam\"\n                              players={statsScam}\n                            />\n                          </>\n                        )}\n                        {/* Camera view for Scam auto-scoring */}\n                        {(selectedMode as any) === \"Scam\" && cameraEnabled && (\n                          <div className=\"rounded-2xl overflow-hidden bg-black\">\n                            <CameraView\n                              scoringMode=\"custom\"\n                              showToolbar={cameraToolbarVisible}\n                              immediateAutoCommit\n                              onAutoDart={(value: any, ring: any, _info: any) => {\n                                if (value > 0) {\n                                  setScamPlayer(\n                                    addScamAuto(scamPlayer, value, ring as any),\n                                  );\n                                  return true;\n                                }\n                              }}\n                            />\n                          </div>\n                        )}\n                        {(selectedMode as any) === \"Fives\" && (\n                          <>\n                            <GameScoreboard\n                              gameMode=\"Fives\"\n                              players={statsFives}\n                            />\n                          </>\n                        )}\n                        {/* Camera view for Fives auto-scoring */}\n                        {(selectedMode as any) === \"Fives\" && cameraEnabled && (\n                          <div className=\"rounded-2xl overflow-hidden bg-black\">\n                            <CameraView\n                              scoringMode=\"custom\"\n                              showToolbar={cameraToolbarVisible}\n                              immediateAutoCommit\n                              onAutoDart={(value: any, ring: any, _info: any) => {\n                                if (value > 0) {\n                                  setFivesPlayer(\n                                    addFivesAuto(\n                                      fivesPlayer,\n                                      value,\n                                      ring as any,\n                                    ),\n                                  );\n                                  return true;\n                                }\n                              }}\n                            />\n                          </div>\n                        )}\n                        {(selectedMode as any) === \"Sevens\" && (\n                          <>\n                            <GameScoreboard\n                              gameMode=\"Sevens\"\n                              players={statsSevens}\n                            />\n                          </>\n                        )}\n                        {/* Camera view for Sevens auto-scoring */}\n                        {(selectedMode as any) === \"Sevens\" &&\n                          cameraEnabled && (\n                            <div className=\"rounded-2xl overflow-hidden bg-black\">\n                              <CameraView\n                                scoringMode=\"custom\"\n                                showToolbar={cameraToolbarVisible}\n                                immediateAutoCommit\n                                onAutoDart={(value: any, ring: any, _info: any) => {\n                                  if (value > 0) {\n                                    setSevensPlayer(\n                                      addSevensAuto(\n                                        sevensPlayer,\n                                        value,\n                                        ring as any,\n                                      ),\n                                    );\n                                    return true;\n                                  }\n                                }}\n                              />\n                            </div>\n                          )}\n                      </div>\n                    )}\n                    <div className=\"h-1\" />\n                  </div>\n                </div>\n              </div>\n            </ResizableModal>\n          </div>\n        )}\n        {showRules && <X01RulesPopup onClose={() => setShowRules(false)} />}\n        {/* Frosted overlay when selecting premium mode without access */}\n        {lockedPremium && (\n          <div className=\"absolute inset-0 z-40 flex items-center justify-center\">\n            <div className=\"absolute inset-0 backdrop-blur-sm bg-slate-900/40\" />\n            <div className=\"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center\">\n              <div className=\"text-3xl mb-2\">ðŸ”’</div>\n              <div className=\"font-semibold\">Premium mode locked</div>\n              <div className=\"text-sm text-slate-200/80\">\n                Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai,\n                and more.\n              </div>\n              <button\n                onClick={async () => {\n                  try {\n                    const res = await fetch(\n                      `${API_URL}/api/stripe/create-checkout-session`,\n                      {\n                        method: \"POST\",\n                        headers: { \"Content-Type\": \"application/json\" },\n                        body: JSON.stringify({ email: user?.email }),\n                      },\n                    );\n                    const data = await res.json();\n                    if (data.ok && data.url) {\n                      window.location.href = data.url;\n                      if (data.development) {\n                        toast(\n                          \"Opened Stripe test checkout (development mode)\",\n                          { type: \"info\", timeout: 3000 },\n                        );\n                      }\n                    } else if (data.error === \"STRIPE_NOT_CONFIGURED\") {\n                      toast(\n                        \"Premium purchases are not available in this development environment. Please visit the production site to upgrade.\",\n                        { type: \"error\", timeout: 4000 },\n                      );\n                    } else {\n                      toast(\n                        \"Failed to create checkout session. Please try again.\",\n                        { type: \"error\", timeout: 4000 },\n                      );\n                    }\n                  } catch (err) {\n                    toast(\"Error creating checkout. Please try again.\", {\n                      type: \"error\",\n                      timeout: 4000,\n                    });\n                  }\n                }}\n                className=\"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold\"\n              >\n                Upgrade to PREMIUM Â·{\" \"}\n                {formatPriceInCurrency(getUserCurrency(), 5)}\n              </button>\n            </div>\n          </div>\n        )}\n        {showCameraManager && typeof document !== \"undefined\"\n          ? createPortal(\n              <div\n                className=\"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4\"\n                onClick={() => setShowCameraManager(false)}\n              >\n                <ResizableModal\n                  storageKey=\"ndn:modal:offline-camera-manager\"\n                  className=\"relative\"\n                  defaultWidth={640}\n                  defaultHeight={520}\n                  minWidth={480}\n                  minHeight={420}\n                  maxWidth={1200}\n                  maxHeight={900}\n                  initialFitHeight\n                  onClose={() => setShowCameraManager(false)}\n                >\n                  <div\n                    className=\"space-y-3\"\n                    onClick={(e) => e.stopPropagation()}\n                  >\n                    <div className=\"flex items-center justify-between gap-3\">\n                      <div>\n                        <div className=\"text-xs uppercase tracking-wide text-white/50\">\n                          Camera Devices\n                        </div>\n                        <div className=\"text-xl font-semibold text-white mt-1\">\n                          Manage Offline Camera Feeds\n                        </div>\n                      </div>\n                      <button\n                        className=\"btn bg-slate-800 hover:bg-slate-700 text-white\"\n                        onClick={() => setShowCameraManager(false)}\n                      >\n                        Close\n                      </button>\n                    </div>\n                    <CameraTile\n                      fill\n                      user={user}\n                      playerScore={playerScore}\n                      aiScore={aiScore}\n                      x01Score={x01Score}\n                      inMatch={inMatch}\n                      showWinPopup={showWinPopup}\n                      pendingLegWinner={pendingLegWinner}\n                      playerDartsThrown={playerDartsThrown}\n                      aiDartsThrown={aiDartsThrown}\n                      totalPlayerDarts={totalPlayerDarts}\n                      totalAiDarts={totalAiDarts}\n                      totalPlayerPoints={totalPlayerPoints}\n                      totalAiPoints={totalAiPoints}\n                      player180s={player180s}\n                      player140s={player140s}\n                      player100s={player100s}\n                      ai180s={ai180s}\n                      ai140s={ai140s}\n                      ai100s={ai100s}\n                      playerHighestCheckout={playerHighestCheckout}\n                      aiHighestCheckout={aiHighestCheckout}\n                      onClose={() => setShowCameraManager(false)}\n                      onOpen={() => setShowCameraManager(true)}\n                      layout={offlineLayout}\n                    />\n                  </div>\n                </ResizableModal>\n              </div>,\n              document.body,\n            )\n          : null}\n        {legOverrideConfirm && typeof document !== \"undefined\"\n          ? createPortal(\n              (() => {\n                const { target, value, stage } = legOverrideConfirm;\n                const targetName =\n                  target === \"player\" ? humanName : aiDisplayName;\n                const currentLegs = target === \"player\" ? playerLegs : aiLegs;\n                return (\n                  <div\n                    className=\"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4\"\n                    onClick={handleLegOverrideNo}\n                  >\n                    <ResizableModal\n                      storageKey=\"ndn:modal:offline-leg-override\"\n                      className=\"relative\"\n                      defaultWidth={360}\n                      defaultHeight={240}\n                      minWidth={280}\n                      minHeight={200}\n                      maxWidth={420}\n                      maxHeight={360}\n                      initialFitHeight\n                      onClose={handleLegOverrideNo}\n                    >\n                      <div\n                        className=\"space-y-3 max-w-[18rem] mx-auto\"\n                        onClick={(e) => e.stopPropagation()}\n                      >\n                        <div>\n                          <div className=\"text-xs uppercase tracking-wide text-white/50\">\n                            Step {stage} of 2\n                          </div>\n                          <div className=\"text-xl font-semibold text-white mt-1\">\n                            Override legs?\n                          </div>\n                        </div>\n                        <div className=\"text-sm text-slate-200 leading-relaxed\">\n                          {stage === 1 ? (\n                            <>\n                              Set {targetName}&apos;s legs to{\" \"}\n                              <span className=\"font-semibold text-white\">\n                                {value}\n                              </span>\n                              ? Confirm to continue.\n                            </>\n                          ) : (\n                            <>\n                              Final confirmation: set {targetName}&apos;s legs\n                              to{\" \"}\n                              <span className=\"font-semibold text-white\">\n                                {value}\n                              </span>\n                              . Select{\" \"}\n                              <span className=\"font-semibold text-emerald-200\">\n                                Yes\n                              </span>{\" \"}\n                              to apply immediately.\n                            </>\n                          )}\n                        </div>\n                        <div className=\"rounded-xl bg-black/40 border border-white/10 p-3 text-sm\">\n                          <div className=\"text-xs uppercase tracking-wide text-white/50 mb-1\">\n                            Current legs\n                          </div>\n                          <div className=\"text-base font-semibold text-white\">\n                            {currentLegs}\n                          </div>\n                        </div>\n                        <div className=\"flex items-center justify-end gap-2 pt-2\">\n                          <button\n                            className=\"btn bg-rose-600 hover:bg-rose-700 text-white\"\n                            onClick={handleLegOverrideNo}\n                          >\n                            No\n                          </button>\n                          <button\n                            className=\"btn bg-emerald-600 hover:bg-emerald-700 text-white\"\n                            onClick={handleLegOverrideYes}\n                          >\n                            Yes\n                          </button>\n                        </div>\n                      </div>\n                    </ResizableModal>\n                  </div>\n                );\n              })(),\n              document.body,\n            )\n          : null}\n        {showWinPopup && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]\">\n            <ResizableModal\n              storageKey=\"ndn:modal:offline-win\"\n              className=\"w-full relative\"\n              defaultWidth={420}\n              defaultHeight={360}\n              minWidth={360}\n              minHeight={300}\n              maxWidth={800}\n              maxHeight={700}\n              initialFitHeight\n            >\n              <h3 className=\"text-lg font-bold mb-2\">Leg Won!</h3>\n              <div className=\"mb-2 text-sm text-slate-200\">\n                Average:{\" \"}\n                <span className=\"font-mono\">\n                  {formatAvg(\n                    match.players?.[match.currentPlayerIdx]\n                      ?.currentThreeDartAvg ?? 0,\n                  )}\n                </span>\n              </div>\n              <div className=\"grid gap-3 text-sm\">\n                <div>\n                  <div className=\"text-xs text-white/60 mb-1\">\n                    Darts used at double\n                  </div>\n                  <div className=\"flex gap-2\">\n                    {[0, 1, 2, 3].map((n) => (\n                      <button\n                        key={`win-double-${n}`}\n                        className={`btn px-3 py-1 text-sm ${doubleDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                        onClick={() => setDoubleDarts(n)}\n                      >\n                        {formatDartCount(n)}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n                <div>\n                  <div className=\"text-xs text-white/60 mb-1\">\n                    Darts at checkout\n                  </div>\n                  <div className=\"flex gap-2\">\n                    {[0, 1, 2, 3].map((n) => (\n                      <button\n                        key={`win-checkout-${n}`}\n                        className={`btn px-3 py-1 text-sm ${checkoutDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                        onClick={() => setCheckoutDarts(n)}\n                      >\n                        {formatDartCount(n)}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-1 gap-2 mt-2\">\n                <button className=\"btn w-full\" onClick={handleWinPopupSubmit}>\n                  Submit\n                </button>\n                <button\n                  className=\"btn bg-emerald-600 hover:bg-emerald-700 w-full\"\n                  onClick={() => {\n                    setShowWinPopup(false);\n                    startMatch();\n                  }}\n                >\n                  Rematch\n                </button>\n                <button\n                  className=\"btn bg-slate-700 hover:bg-slate-800 w-full\"\n                  onClick={() => {\n                    setShowWinPopup(false);\n                    setShowMatchModal(false);\n                    setInMatch(false);\n                  }}\n                >\n                  Back to Menu\n                </button>\n              </div>\n            </ResizableModal>\n          </div>\n        )}\n        {showMatchSummary && (\n          <div className=\"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]\">\n            <ResizableModal\n              storageKey=\"ndn:modal:offline-summary\"\n              className=\"w-full relative\"\n              defaultWidth={820}\n              defaultHeight={520}\n              minWidth={600}\n              minHeight={400}\n              maxWidth={1400}\n              maxHeight={1000}\n              initialFitHeight\n            >\n              <h3 className=\"text-xl font-extrabold mb-2\">Match Summary</h3>\n              <div className=\"text-xs opacity-80 mb-3\">\n                {selectedMode} Â· {x01Score} start Â· First to {firstTo}\n              </div>\n              {(() => {\n                const player3da =\n                  totalPlayerDarts > 0\n                    ? (totalPlayerPoints / totalPlayerDarts) * 3\n                    : 0;\n                const playerBest = (() => {\n                  const darts = legStats\n                    .filter(\n                      (l) =>\n                        l.winner === \"player\" &&\n                        typeof l.winnerDarts === \"number\",\n                    )\n                    .map((l) => l.winnerDarts);\n                  if (!darts.length) return \"â€”\";\n                  return `${Math.min(...darts)} darts`;\n                })();\n                const playerWorst = (() => {\n                  const darts = legStats\n                    .filter(\n                      (l) =>\n                        l.winner === \"player\" &&\n                        typeof l.winnerDarts === \"number\",\n                    )\n                    .map((l) => l.winnerDarts);\n                  if (!darts.length) return \"â€”\";\n                  return `${Math.max(...darts)} darts`;\n                })();\n                const playerPct =\n                  playerDoublesAtt > 0\n                    ? Math.round((playerDoublesHit / playerDoublesAtt) * 100)\n                    : 0;\n\n                const ai3da =\n                  totalAiDarts > 0 ? (totalAiPoints / totalAiDarts) * 3 : 0;\n                const aiBest = (() => {\n                  const darts = legStats\n                    .filter(\n                      (l) =>\n                        l.winner === \"ai\" && typeof l.winnerDarts === \"number\",\n                    )\n                    .map((l) => l.winnerDarts);\n                  if (!darts.length) return \"â€”\";\n                  return `${Math.min(...darts)} darts`;\n                })();\n                const aiWorst = (() => {\n                  const darts = legStats\n                    .filter(\n                      (l) =>\n                        l.winner === \"ai\" && typeof l.winnerDarts === \"number\",\n                    )\n                    .map((l) => l.winnerDarts);\n                  if (!darts.length) return \"â€”\";\n                  return `${Math.max(...darts)} darts`;\n                })();\n                const aiPct =\n                  aiDoublesAtt > 0\n                    ? Math.round((aiDoublesHit / aiDoublesAtt) * 100)\n                    : 0;\n\n                return (\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                    <div className=\"p-3 rounded-2xl glass border border-white/10\">\n                      <div className=\"text-sm font-semibold mb-1\">\n                        {getPreferredUserName(user, \"You\")}\n                      </div>\n                      <div className=\"text-3xl font-extrabold\">\n                        {playerLegs}\n                      </div>\n                      <div className=\"text-xs opacity-80\">Legs Won</div>\n                      <div className=\"mt-3 grid grid-cols-2 gap-2 text-sm\">\n                        <div>\n                          <span className=\"opacity-70\">Final 3DA</span>\n                          <div className=\"font-semibold\">\n                            {player3da.toFixed(1)}\n                          </div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Darts At Double</span>\n                          <div className=\"font-semibold\">\n                            {playerDoublesAtt}\n                          </div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Double %</span>\n                          <div className=\"font-semibold\">{playerPct}%</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Best Dart Leg</span>\n                          <div className=\"font-semibold\">{playerBest}</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Worst Dart Leg</span>\n                          <div className=\"font-semibold\">{playerWorst}</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">180's Hit</span>\n                          <div className=\"font-semibold\">{player180s}</div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"hidden md:flex items-center justify-center\">\n                      <div className=\"text-4xl font-black\">\n                        {playerLegs} â€“ {aiLegs}\n                      </div>\n                    </div>\n                    <div className=\"p-3 rounded-2xl glass border border-white/10\">\n                      <div className=\"text-sm font-semibold mb-1\">\n                        {ai === \"None\" ? \"Opponent\" : `${ai} AI`}\n                      </div>\n                      <div className=\"text-3xl font-extrabold\">{aiLegs}</div>\n                      <div className=\"text-xs opacity-80\">Legs Won</div>\n                      <div className=\"mt-3 grid grid-cols-2 gap-2 text-sm\">\n                        <div>\n                          <span className=\"opacity-70\">Final 3DA</span>\n                          <div className=\"font-semibold\">\n                            {ai3da.toFixed(1)}\n                          </div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Darts At Double</span>\n                          <div className=\"font-semibold\">{aiDoublesAtt}</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Double %</span>\n                          <div className=\"font-semibold\">{aiPct}%</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Best Dart Leg</span>\n                          <div className=\"font-semibold\">{aiBest}</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">Worst Dart Leg</span>\n                          <div className=\"font-semibold\">{aiWorst}</div>\n                        </div>\n                        <div>\n                          <span className=\"opacity-70\">180's Hit</span>\n                          <div className=\"font-semibold\">{ai180s}</div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                );\n              })()}\n              <div className=\"mt-4\">\n                <div className=\"text-sm font-semibold mb-2\">Legs Timeline</div>\n                <div className=\"flex flex-wrap gap-2\">\n                  {legStats.map((leg, i) => (\n                    <div\n                      key={i}\n                      className={`px-3 py-1 rounded-full border text-xs ${leg.winner === \"player\" ? \"bg-emerald-500/15 border-emerald-400/30\" : \"bg-fuchsia-500/15 border-fuchsia-400/30\"}`}\n                    >\n                      Leg {i + 1}:{\" \"}\n                      {leg.winner === \"player\"\n                        ? \"You\"\n                        : ai === \"None\"\n                          ? \"Opp\"\n                          : \"AI\"}{\" \"}\n                      Â· Dbl {formatDartCount(leg.doubleDarts)} Â· CO{\" \"}\n                      {formatDartCount(leg.checkoutDarts || 0)}\n                    </div>\n                  ))}\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 gap-2 mt-4\">\n                <button\n                  className=\"btn bg-slate-700 hover:bg-slate-800\"\n                  onClick={() => setShowMatchSummary(false)}\n                >\n                  Close\n                </button>\n                <button\n                  className=\"btn bg-emerald-600 hover:bg-emerald-700\"\n                  onClick={() => {\n                    setShowMatchSummary(false);\n                    startMatch();\n                  }}\n                >\n                  Rematch\n                </button>\n              </div>\n            </ResizableModal>\n          </div>\n        )}\n        {legStats.length > 0 && (\n          <div className=\"mt-4\">\n            <h4 className=\"font-semibold mb-2\">Leg Stats</h4>\n            <ul>\n              {legStats.map((leg, i) => (\n                <li key={i}>\n                  Leg {i + 1}: Double darts: {formatDartCount(leg.doubleDarts)},\n                  Checkout darts: {formatDartCount(leg.checkoutDarts || 0)}\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n\n        {/* Phone camera overlay removed per UX preference; use header badge preview only */}\n      </div>\n    </div>\n  );\n}\n"],"names":["DOUBLE_PRACTICE_ORDER","_","i","isDoubleHit","value","targetIdx","t","parseManualDart","input","mult","num","ATC_ORDER","CRICKET_NUMBERS","createCricketState","marks","n","applyCricketDart","state","ring","sector","opponentClosed","hits","cand","c","before","remainToClose","toApply","overflow","after","points","hasClosedAll","createShanghaiState","getRoundTarget","applyShanghaiDart","target","endShanghaiTurn","next","createDefaultHalveIt","getCurrentHalveTarget","applyHalveItDart","scored","endHalveItTurn","createHighLow","applyHighLowDart","v","endHighLowTurn","createKillerState","assigned","lives","assignKillerNumbers","playerIds","pool","res","id","idx","applyKillerDart","selfId","states","me","victimId","pid","victim","delta","killerWinner","alive","st","createBaseball","applyBaseballDart","runs","GOLF_TARGETS","createGolf","applyGolfDart","TTT_TARGETS","createTicTacToe","checkWin","board","lines","a","b","tryClaimCell","cell","tgt","ok","w","createScamState","SCAM_TARGETS","SCAM_TARGET_NAMES","getScamTarget","addScamAuto","newIndex","finished","addScamNumeric","resetScam","createFivesState","FIVES_VALID_NUMBERS","isFivesValid","addFivesAuto","_ring","newScore","addFivesNumeric","resetFives","createSevensState","SEVENS_VALID_NUMBERS","isSevensValid","addSevensAuto","addSevensNumeric","resetSevens","AM_CRICKET_NUMBERS","createAmCricketState","applyAmCricketDart","toClose","hasClosedAllAm","GameHeaderBar","left","right","className","sticky","jsxs","jsx","makeOfflineAddVisitAdapter","commitManualVisitTotal","score","_darts","createOfflineMatchActions","args","match","endTurn","darts","meta","MemoCameraView","memo","CameraView","aiLevels","BOARD_CLEAR_GRACE_MS","clamp","val","min","max","aiVisitScore","remaining","level","candidates","X01RulesPopup","onClose","API_URL","getApiBaseUrl","OfflinePlay","user","offlineLayout","favoriteDouble","callerEnabled","callerVoice","callerVolume","speakCheckoutOnly","rememberLastOffline","setLastOffline","autoStartOffline","cameraScale","setCameraScale","cameraAspect","setCameraAspect","cameraFitMode","setCameraFitMode","cameraEnabled","textSize","boxSize","autoscoreProvider","autoCommitMode","matchType","setMatchType","teamAName","setTeamAName","teamBName","setTeamBName","useUserSettings","manualScoring","cameraToolbarVisible","waitForBoardClear","selectedMode","setSelectedMode","useState","x01Score","setX01Score","ai","setAI","showRules","setShowRules","inMatch","setInMatch","playerScore","setPlayerScore","aiScore","setAiScore","_onDouble","setOnDouble","showWinPopup","setShowWinPopup","firstTo","setFirstTo","playerLegs","setPlayerLegs","useMatch","showStartShowcase","setShowStartShowcase","startedShowcasedRef","useRef","aiLegs","setAiLegs","pendingLegWinner","setPendingLegWinner","doubleDarts","setDoubleDarts","checkoutDarts","setCheckoutDarts","legStats","setLegStats","aiDelayMs","setAiDelayMs","toast","useToast","showMatchModal","setShowMatchModal","showQuitPause","setShowQuitPause","showQuitConfirm","setShowQuitConfirm","quitVotes","setQuitVotes","setPaused","useMatchControl","s","paused","pauseEndsAt","showPauseMenu","setShowPauseMenu","pauseNow","setPauseNow","useEffect","onQuit","maximized","setMaximized","fitAll","setFitAll","fitScale","setFitScale","_fitOverflowing","setFitOverflowing","isPlayerTurn","setIsPlayerTurn","isMobileScreen","setIsMobileScreen","mobileCameraOpen","setMobileCameraOpen","onKeyDown","e","drawerDragRef","drawerRootRef","onDrawerPointerDown","useCallback","onDrawerPointerMove","onDrawerPointerEnd","handleResize","handleOpenManager","setShowCameraManager","playerDartPoints","setPlayerDartPoints","dpIndex","setDpIndex","dpHits","setDpHits","atcIndex","setAtcIndex","atcHits","setAtcHits","cricket","setCricket","shanghai","setShanghai","halve","setHalve","highlow","setHighlow","_practiceTurnDarts","setPracticeTurnDarts","b27Stage","setB27Stage","b27Score","setB27Score","_b27Darts","setB27Darts","b27Hits","setB27Hits","b27Finished","setB27Finished","cuRound","setCuRound","cuScore","setCuScore","_cuDarts","setCuDarts","cuMaxRounds","hsRound","setHsRound","hsScore","setHsScore","_hsDarts","setHsDarts","hsMaxRounds","lsRound","setLsRound","lsScore","setLsScore","_lsDarts","setLsDarts","lsMaxRounds","co170Rem","setCo170Rem","co170Darts","setCo170Darts","co170Attempts","setCo170Attempts","co170Successes","setCo170Successes","co121Rem","setCo121Rem","co121Darts","setCo121Darts","co121Attempts","setCo121Attempts","co121Successes","setCo121Successes","trebleTarget","setTrebleTarget","trebleHits","setTrebleHits","trebleDarts","setTrebleDarts","trebleMaxDarts","setTrebleMaxDarts","trebleFinished","setTrebleFinished","baseball","setBaseball","golf","setGolf","ttt","setTTT","amCricket","setAmCricket","killerPlayers","setKillerPlayers","killerStates","setKillerStates","killerAssigned","setKillerAssigned","killerSetupDone","setKillerSetupDone","killerTurnIdx","setKillerTurnIdx","killerDarts","setKillerDarts","killerWinnerId","setKillerWinnerId","killerLastEvent","setKillerLastEvent","scam","_setScam","scamPlayer","setScamPlayer","fives","_setFives","fivesPlayer","setFivesPlayer","sevens","_setSevens","sevensPlayer","setSevensPlayer","playerDartsThrown","setPlayerDartsThrown","playerLastDart","setPlayerLastDart","playerVisitDarts","setPlayerVisitDarts","playerVisitStart","setPlayerVisitStart","playerVisitSum","setPlayerVisitSum","playerLastVisitScore","setPlayerLastVisitScore","playerVisitDartsAtDouble","setPlayerVisitDartsAtDouble","lastBounceMissTsRef","lastVisitDartsRef","playerScoreRef","playerVisitDartsRef","playerVisitSumRef","playerVisitStartRef","playerVisitDartsAtDoubleRef","aiCountdownMs","setAiCountdownMs","aiDartsThrown","setAiDartsThrown","aiLastDart","setAiLastDart","aiVisitSum","setAiVisitSum","aiVisitDarts","setAiVisitDarts","aiLastVisitScore","setAiLastVisitScore","aiVisitDartsAtDouble","setAiVisitDartsAtDouble","playerDoublesAtt","setPlayerDoublesAtt","playerDoublesHit","setPlayerDoublesHit","aiDoublesAtt","setAiDoublesAtt","aiDoublesHit","setAiDoublesHit","totalPlayerDarts","setTotalPlayerDarts","totalAiDarts","setTotalAiDarts","totalPlayerPoints","setTotalPlayerPoints","totalAiPoints","setTotalAiPoints","player180s","setPlayer180s","player140s","setPlayer140s","player100s","setPlayer100s","ai180s","setAi180s","ai140s","setAi140s","ai100s","setAi100s","playerHighestCheckout","setPlayerHighestCheckout","aiHighestCheckout","setAiHighestCheckout","checkoutPrompt","setCheckoutPrompt","checkoutPopupOpen","setCheckoutPopupOpen","showMatchSummary","setShowMatchSummary","manualBox","setManualBox","manualTextarea","setManualTextarea","manualPlayerScoreInput","setManualPlayerScoreInput","manualOpponentScoreInput","setManualOpponentScoreInput","manualPlayerLegsInput","setManualPlayerLegsInput","manualOpponentLegsInput","setManualOpponentLegsInput","legOverrideConfirm","setLegOverrideConfirm","showCameraManager","dartCounts","setDartCounts","awaitingBoardClear","setAwaitingBoardClear","pendingVisitRef","pendingVisitTimerRef","clearPendingVisitTimer","timer","updateCheckoutPrompt","routes","suggestCheckouts","finalizeQuitMatch","broadcastMessage","speakAutoVisit","pending","speaker","getPreferredUserName","sayScore","commitPendingVisit","_trigger","visitTotal","preRemaining","doubleAttempts","doubleWindow","highestCheckout","h","useAudit","finalizePendingVisit","trigger","handler","humanName","aiDisplayName","currentThrowerName","currentThrowerLegs","opponentLegs","statsX01","useOfflineGameStats","statsCricket","statsShanghai","statsKiller","statsScam","statsFives","statsSevens","scoreboardPlayers","useMemo","scoreboardMatchScore","activeScoreboardStats","list","playerResolvedLastScore","aiResolvedLastScore","player","singlePlayerScoreboard","_matchAvg","_allTimeAvg","rest","inactivePlayerName","activePlayerName","activeRemaining","activeLastScore","currentPlayer","totalScored","totalDarts","leg","runningScored","runningDarts","_runningAvg","formatDartCount","count","recordDart","mode","prev","resetDartCount","parseManualScoreOverride","parsed","parseManualLegsOverride","cancelPendingAutoVisit","nextScore","safeScore","nextVisitStart","handleManualScoreOverride","applyManualLegOverride","handleManualLegsOverride","handleLegOverrideYes","handleLegOverrideNo","handleKey","event","buttonSizeClass","size","scrollerRef","contentRef","headerBarRef","formatType","setFormatType","formatCount","setFormatCount","formatRef","wins","measure","scroller","content","headerH","availH","availW","rect","currentScale","naturalHeight","naturalWidth","scaleH","scaleW","scaledHeight","overflowing","RO","ro","onAuto","m","startMatch","onFmt","raf","last","tick","now","dt","visitDarts","targetVisit","dart","d","p","preRem","postRem","checkout","aiName","players","el","startNextLeg","nextRemaining","rawTotal","visitStart","liveScore","existingDarts","existingSum","hadPartialVisit","checkoutCap","total","checkoutDartsUsed","doubleDartsUsed","matchActions","visitTotalInput","setVisitTotalInput","quickScoreInput","setQuickScoreInput","quickScoreInputRef","handleVisitTotalChange","addVisitTotal","maxAllowed","bounded","clearCurrentVisit","onClearRequest","evt","detail","addDpValue","nextHits","addDpNumeric","addDpManual","addB27Auto","hit","nd","totalHits","addB27Numeric","resetB27","addCountUpAuto","r","addHighScoreAuto","addLowScoreAuto","applyCheckout","rem","setRem","setDarts","setAttempts","setSuccesses","dartsUsed","addCo170Auto","addCo121Auto","addCoManual","is170","isDouble","resetCo170","resetCo121","addTrebleAuto","cycle","resetTreble","addBaseballAuto","cp","resetBaseball","addGolfAuto","resetGolf","addTttAuto","resetTtt","addAmCricketAuto","resetAmCricket","addAtcValue","newHits","addAtcNumeric","addAtcManual","addCricketAuto","copy","addCricketNumeric","addShanghaiAuto","addShanghaiNumeric","addHalveAuto","addHalveNumeric","addHighLowAuto","addHighLowNumeric","handleWinPopupSubmit","winner","legDoublesAtt","legDoublesHit","winnerDarts","bumpGameMode","supportsQuickScore","commitQuickScore","lockedPremium","freeGames","MatchStartShowcase","premiumGames","Fragment","ResizableModal","mm","ss","started","pct","PauseQuitModal","minutes","endsAt","route","disabled","pillCls","cricketClosedAll","formatAvg","GameScoreboard","MatchControls","_value","_info","first","currentThrower","currentRemaining","lastScoreDisplay","dartsThrown","avg3","matchScore","bestLegText","l","nh","ni","info","promptVal","tcell","isTurn","cur","k","pp","win","pst","name","it","ids","initStates","ScoreNumberPad","data","formatPriceInCurrency","getUserCurrency","createPortal","CameraTile","stage","targetName","currentLegs","player3da","playerBest","playerWorst","playerPct","ai3da","aiBest","aiWorst","aiPct"],"mappings":"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"}