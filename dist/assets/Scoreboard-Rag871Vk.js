import{j as e,e as P}from"./index-qEtc2rT9.js";import{a as T}from"./match-DaK2nqvI.js";import{f as N}from"./stats-X3jz_E9o.js";import{r as S,l as W}from"./ui-CuWypN7C.js";import{u as A}from"./pendingVisit-BbRXmIZs.js";import"./vendor-D3F3s8fL.js";function O(){const[i,u]=S.useState(0),[p,D]=S.useState(3),{players:l,currentPlayerIdx:x,addVisit:C,undoVisit:k,endLeg:f,nextPlayer:w,endGame:R,inProgress:y,startingScore:b,bestLegThisMatch:j}=T(),M=A(s=>s.entries);return l[x],e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2 card",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Score Input"}),y?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-32",type:"number",value:i,onChange:s=>u(parseInt(s.target.value||"0")),placeholder:"Score"}),e.jsxs("select",{className:"input",value:p,onChange:s=>D(parseInt(s.target.value)),children:[e.jsx("option",{value:1,children:"1 dart"}),e.jsx("option",{value:2,children:"2 darts"}),e.jsx("option",{value:3,children:"3 darts"})]}),e.jsx("button",{className:"btn",onClick:()=>{const s=l[x],t=s.legs[s.legs.length-1],a=t?t.totalScoreRemaining:b,n=Math.max(0,a-(Number.isFinite(i)?i:0));C(i,p),u(0),n===0?f(i):w()},children:"Add Visit"}),e.jsx("button",{className:"px-3 py-2 rounded-xl border border-slate-200",onClick:()=>k(),title:"Undo",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"btn",onClick:()=>{f(i),u(0)},children:["End Leg (Checkout ",i||0,")"]}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>w(),children:"Next Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{try{const s={ts:Date.now(),players:l.map(t=>{const a=t.legs.reduce((c,m)=>{c.points+=m.totalScoreStart-m.totalScoreRemaining;const d=(m.visits||[]).reduce((r,o)=>r+(o.darts||0)-(o.preOpenDarts||0),0);return c.darts+=d,c},{points:0,darts:0}),n=a.darts,h=n>0?a.points/n*3:0;return{id:t.id,name:t.name,legsWon:t.legsWon,dartsThrown:n,avg:Math.round(h*100)/100}}),winner:l.reduce((t,a)=>a.legsWon>(t?.legsWon||0)?a:t,l[0])?.name};try{localStorage.setItem("ndn_last_match",JSON.stringify(s))}catch{}}catch{}P(l),R()},children:"End Game"})]})]}):e.jsx("p",{className:"text-slate-600",children:"No game in progress."}),e.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map((s,t)=>{const a=s.legs[s.legs.length-1],n=a?a.totalScoreRemaining:b,h=s.legs.reduce((d,r)=>{d.points+=r.totalScoreStart-r.totalScoreRemaining;const o=(r.visits||[]).reduce((v,g)=>v+(g.darts||0)-(g.preOpenDarts||0),0);return d.darts+=o,d},{points:0,darts:0}),c=h.darts,m=c>0?h.points/c*3:0;return e.jsxs("div",{className:`card glass ${t===x?"ring-2 ring-brand-400":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsxs("span",{className:"badge",children:["Legs Won: ",s.legsWon]})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),t===x&&e.jsx("div",{className:"flex items-center justify-center gap-2 mt-1","aria-label":"Visit status for current player",children:[0,1,2].map(d=>{const r=M[d],o=!r,v=!!r&&(typeof r.value=="number"?r.value>0:!0),g=o?"bg-gray-400/70":v?"bg-emerald-400":"bg-rose-500";return e.jsx("span",{className:`w-2.5 h-2.5 rounded-full shadow ${g}`},d)})}),e.jsx("div",{className:"text-2xl font-bold",children:n}),e.jsx("div",{className:"h-1 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-n/b)*100))}%`}})})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Darts"}),e.jsx("div",{className:"text-2xl font-bold",children:c})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg"}),e.jsx("div",{className:"text-2xl font-bold",children:N(m)})]})]})]},s.id)})}),j&&e.jsxs("div",{className:"mt-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsx("strong",{children:"Best Leg (this match):"})," Player ",l.find(s=>s.id===j.playerId)?.name," in ",j.darts," darts"]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Legs Summary"}),e.jsx("div",{className:"space-y-3",children:l.map(s=>e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 border border-slate-200",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Completed Legs: ",s.legs.filter(t=>t.finished).length]}),!y&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-white border",children:[e.jsx("div",{className:"text-slate-500",children:"Best 3-Dart"}),e.jsx("div",{className:"font-semibold",children:N(s.bestThreeDartAvg)})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-white border",children:[e.jsx("div",{className:"text-slate-500",children:"Worst 3-Dart"}),e.jsx("div",{className:"font-semibold",children:N(s.worstThreeDartAvg)})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-white border",children:[e.jsx("div",{className:"text-slate-500",children:"Best 9-Dart (fewest darts)"}),e.jsx("div",{className:"font-semibold",children:s.bestNineDart?`${s.bestNineDart.darts} darts`:"—"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-white border",children:[e.jsx("div",{className:"text-slate-500",children:"Best Checkout"}),e.jsx("div",{className:"font-semibold",children:s.bestCheckout??"—"})]})]})]},s.id))})]})]})}export{O as default};
//# sourceMappingURL=Scoreboard-Rag871Vk.js.map
