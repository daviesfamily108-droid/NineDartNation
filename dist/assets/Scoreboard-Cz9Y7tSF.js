import{j as e,e as M}from"./index-DebnqEpH.js";import{u as D}from"./match-DtNynpCT.js";import{f as V}from"./stats-X3jz_E9o.js";import{M as W}from"./MatchControls-BMQ9huJO.js";import{u as E}from"./pendingVisit-CMrULENC.js";import"./vendor-D3F3s8fL.js";import"./ui-CuWypN7C.js";function k({matchActions:i}={}){const{players:d,currentPlayerIdx:g,addVisit:y,undoVisit:w,endLeg:f,nextPlayer:b,endGame:S,inProgress:j,startingScore:u,bestLegThisMatch:p}=D(),N=E(s=>s.entries);d[g];function P(){try{const s={ts:Date.now(),players:d.map(t=>{const r=t.legs.reduce((o,n)=>{o.points+=n.totalScoreStart-n.totalScoreRemaining;const c=(n.visits||[]).reduce((a,m)=>a+(m.darts||0)-(m.preOpenDarts||0),0);return o.darts+=c,o},{points:0,darts:0}),l=r.darts,x=l>0?r.points/l*3:0;return{id:t.id,name:t.name,legsWon:t.legsWon,dartsThrown:l,avg:Math.round(x*100)/100}}),winner:d.reduce((t,r)=>r.legsWon>(t?.legsWon||0)?r:t,d[0])?.name};try{localStorage.setItem("ndn_last_match",JSON.stringify(s))}catch{}}catch{}M(d),(i?.endGame??S)()}return e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3",children:e.jsxs("div",{className:"col-span-2 card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Score Input"}),j?e.jsx(W,{inProgress:j,startingScore:u,pendingEntries:N,onAddVisit:(s,t)=>{const r=d[g],l=r.legs[r.legs.length-1];let n=(l?l.totalScoreRemaining:u)-(typeof s=="number"?s:0);(!Number.isFinite(n)||n<0)&&(n=0),i?.addVisit?i.addVisit(s,t):y(s,t),n===0?i?.endLeg?i.endLeg(s):f(s):(i?.nextPlayer??b)()},onUndo:()=>(i?.undoVisit??w)(),onEndLeg:s=>{(i?.endLeg??f)(s??0)},onNextPlayer:()=>(i?.nextPlayer??b)(),onEndGame:P,quickButtons:[180,140,100,60]}):e.jsx("p",{className:"text-slate-600",children:"No game in progress."}),e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:d.map((s,t)=>{const r=s.legs[s.legs.length-1],l=r?r.totalScoreRemaining:u,x=s.legs.reduce((c,a)=>{c.points+=a.totalScoreStart-a.totalScoreRemaining;const m=(a.visits||[]).reduce((h,v)=>h+(v.darts||0)-(v.preOpenDarts||0),0);return c.darts+=m,c},{points:0,darts:0}),o=x.darts,n=o>0?x.points/o*3:0;return e.jsxs("div",{className:`card glass transition-shadow transition-all duration-150 ease-out ${t===g?"ring-2 ring-brand-400":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold",children:s.name}),e.jsxs("span",{className:"badge w-32 justify-center",children:["Legs Won: ",s.legsWon]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-1 h-3 w-full","aria-hidden":!0,children:[0,1,2].map(c=>{const a=t===g?N[c]:null,m=!a,h=!!a&&(typeof a.value=="number"?a.value>0:!0),R=`visit-dot ${t===g&&!m&&h?"active":"inactive"} ${m?"bg-gray-400/60":h?"bg-emerald-400":"bg-rose-500"}`;return e.jsx("span",{className:R},c)})}),e.jsx("div",{className:"text-2xl font-bold",children:l}),e.jsx("div",{className:"h-1 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70 transition-all duration-200 ease-out",style:{width:`${Math.max(0,Math.min(100,(1-l/u)*100))}%`}})})]}),e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Darts"}),e.jsx("div",{className:"text-xl font-bold",children:o})]}),e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg"}),e.jsx("div",{className:"text-xl font-bold",children:V(n)})]})]})]},s.id)})}),p&&e.jsxs("div",{className:"mt-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsx("strong",{children:"Best Leg (this match):"})," Player ",d.find(s=>s.id===p.playerId)?.name," in ",p.darts," darts"]})]})})}export{k as default};
//# sourceMappingURL=Scoreboard-Cz9Y7tSF.js.map
