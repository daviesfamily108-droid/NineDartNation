import{a2 as u,j as e,a as d}from"./index-CP7CtXfW.js";import{r}from"./ui-DwoKAdU7.js";import"./vendor-D3F3s8fL.js";function v({user:o}){const b=u(o?.email),[a,j]=r.useState(null),[l,c]=r.useState(""),[m,n]=r.useState("");async function x(){try{const s=await d("/readyz");j(await s.json())}catch{}}if(r.useEffect(()=>{x();const s=setInterval(x,5e3);return()=>clearInterval(s)},[]),!b)return e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Ops"}),e.jsx("div",{children:"Restricted"})]});async function h(s){n("");try{const t=await d("/api/admin/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:s,requesterEmail:o?.email})}),i=await t.json();!t.ok||!i?.ok?n(i?.error||"Failed"):n(`Maintenance ${s?"enabled":"disabled"}`)}catch{n("Network error")}}async function p(){n("");const s=l.trim();if(s)try{const t=await d("/api/admin/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,requesterEmail:o?.email})}),i=await t.json();!t.ok||!i?.ok?n(i?.error||"Failed"):n("Announcement broadcasted"),c("")}catch{n("Network error")}}return e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Ops"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Readiness"}),e.jsxs("div",{className:"text-sm",children:["HTTP:"," ",e.jsx("span",{className:`font-semibold ${a?.ok?"text-emerald-300":"text-rose-300"}`,children:String(!!a?.ok)})]}),e.jsxs("div",{className:"text-sm",children:["WS:"," ",e.jsx("span",{className:`font-semibold ${a?.ws?"text-emerald-300":"text-rose-300"}`,children:String(!!a?.ws)})]}),e.jsxs("div",{className:"text-sm",children:["Clients:"," ",e.jsx("span",{className:"font-semibold",children:a?.clients??0})]}),e.jsxs("div",{className:"text-sm",children:["Rooms: ",e.jsx("span",{className:"font-semibold",children:a?.rooms??0})]}),e.jsxs("div",{className:"text-sm",children:["Heap Used:"," ",e.jsxs("span",{className:"font-semibold",children:[a?.mem?Math.round(a.mem.heapUsed/1024/1024):0," MB"]})]})]}),e.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Maintenance"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn",onClick:()=>h(!0),children:"Enable"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>h(!1),children:"Disable"})]})]}),e.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Announcement"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input flex-1",placeholder:"Message to broadcast",value:l,onChange:s=>c(s.target.value)}),e.jsx("button",{className:"btn",onClick:p,children:"Send"})]})]})]}),m&&e.jsx("div",{className:"text-xs mt-2",children:m}),e.jsx("div",{className:"text-xs opacity-70 mt-2",children:"âœ… Clustering enabled! For 1.5k+ concurrent users, deploy behind a reverse proxy (NGINX/Cloudflare) with sticky sessions for WebSockets. Set NODE_WORKERS environment variable to control worker count."})]})}export{v as default};
//# sourceMappingURL=OpsDashboard-PbTAYTMy.js.map
