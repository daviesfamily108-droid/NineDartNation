import{j as e,u as nl,i as rl,e as al,k as il,l as ll,m as Fs,n as It,o as Zn,p as Hs,M as ol,r as za,q as Jn,t as Xa,R as nt,P as qa,C as L,G as rt,v as cl,w as dl,h as ul,x as ml,y as xl}from"./index-C2BGSqtj.js";import{r}from"./ui-Cl5S-Tv0.js";import{u as Ve,P as hl}from"./PauseOverlay-BO8SIMKQ.js";import{S as fl}from"./ScoreNumberPad-CBAXjrqq.js";import{f as pl}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const at=[...Array.from({length:20},(n,i)=>({label:`D${i+1}`,score:(i+1)*2})),{label:"DBULL",score:50,isBull:!0}];function Qa(n,i){const o=at[i];return!!o&&n===o.score}function Bt(n){const i=n.trim().toUpperCase();if(!i)return null;if(i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL")return 50;if(i==="25"||i==="OBULL")return 25;const o=i.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!o)return null;const h=o[1]||"S",c=parseInt(o[2],10);return c<1||c>20?null:c*(h==="S"?1:h==="D"?2:3)}const te=[...Array.from({length:20},(n,i)=>i+1),25,50],or=[20,19,18,17,16,15,25];function er(){const n={};return or.forEach(i=>{n[i]=0}),{marks:n,points:0}}function bl(n,i,o,h,c=()=>!1){let m=null,p=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)m=25,p=o==="INNER_BULL"||i===50?2:1;else if(typeof h=="number"&&h>=15&&h<=20)m=h,o==="TRIPLE"?p=3:o==="DOUBLE"?p=2:p=1;else if(i){const ue=[20,19,18,17,16,15];for(const Ce of ue){if(i===Ce){m=Ce,p=1;break}if(i===Ce*2){m=Ce,p=2;break}if(i===Ce*3){m=Ce,p=3;break}}!m&&(i===25||i===50)&&(m=25,p=i===50?2:1)}if(!m)return 0;const H=n.marks[m],it=Math.max(0,3-H),ke=Math.min(it,p),j=Math.max(0,p-ke),Re=H+ke;n.marks[m]=Re>3?3:Re;let G=0;return j>0&&!c(m)&&(m===25?o==="INNER_BULL"?G+=50*j:G+=25*j:G+=m*j),n.points+=G,G}function gl(n){return or.every(i=>(n.marks[i]||0)>=3)}function tr(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function vl(n){return n.round}function jl(n,i,o,h){if(n.finished)return 0;const c=vl(n);let m=0;return typeof h=="number"&&h===c?o==="TRIPLE"?(m=c*3,n.turnHits.triples++):o==="DOUBLE"?(m=c*2,n.turnHits.doubles++):o==="SINGLE"&&(m=c*1,n.turnHits.singles++):!h&&(i===c||i===c*2||i===c*3)&&(i===c*3?(m=c*3,n.turnHits.triples++):i===c*2?(m=c*2,n.turnHits.doubles++):i===c&&(m=c,n.turnHits.singles++)),n.score+=m,m}function Nl(n){if(!n.finished){if(n.turnHits.singles>0&&n.turnHits.doubles>0&&n.turnHits.triples>0){n.shanghaiAchieved=!0,n.finished=!0;return}const i=n.round+1;i>20?n.finished=!0:n.round=i}n.turnHits={singles:0,doubles:0,triples:0}}function sr(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function rr(n){return n.targets[n.stage]||null}function yl(n,i,o,h){if(n.finished)return 0;const c=rr(n);if(!c)return 0;let m=0;switch(c.kind){case"NUMBER":{typeof h=="number"&&h===c.num?o==="TRIPLE"?m=c.num*3:o==="DOUBLE"?m=c.num*2:o==="SINGLE"&&(m=c.num):!h&&(i===c.num||i===c.num*2||i===c.num*3)&&(m=i),m>0&&(n.hitThisRound=!0);break}case"DOUBLE":{(o==="DOUBLE"&&h===c.num||i===c.num*2)&&(m=c.num*2,n.hitThisRound=!0);break}case"TRIPLE":{(o==="TRIPLE"&&h===c.num||i===c.num*3)&&(m=c.num*3,n.hitThisRound=!0);break}case"BULL":{(o==="BULL"||o==="INNER_BULL"||i===25||i===50)&&(m=o==="INNER_BULL"||i===50?50:25,n.hitThisRound=!0);break}case"ANY_NUMBER":{i>0&&(m=i,n.hitThisRound=!0);break}}return n.score+=m,m}function wl(n){n.finished||(n.hitThisRound||(n.score=Math.floor(n.score/2)),n.hitThisRound=!1,n.stage+=1,n.stage>=n.targets.length&&(n.finished=!0))}function nr(){return{round:1,score:0,target:"HIGH",finished:!1}}function Sl(n,i,o,h){if(n.finished)return 0;let c=0;if(n.target==="HIGH")if(o==="INNER_BULL")c=50;else if(typeof h=="number"){const p=h*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);h>=20&&(c=p)}else i>=40&&(c=i);else if(typeof h=="number"){const p=h*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);h<=10&&(c=p)}else i>0&&i<=30&&(c=i);return n.score+=c,c}function kl(n){if(!n.finished){if(n.round+=1,n.round>10){n.finished=!0;return}n.target=n.target==="HIGH"?"LOW":"HIGH"}}function Cl(n,i=3){return{number:n,lives:i,isKiller:!1,eliminated:!1}}function Dl(n){const i=Array.from({length:20},(h,c)=>c+1),o={};for(const h of n){const c=Math.floor(Math.random()*i.length),m=i.splice(c,1)[0];o[h]=m}return o}function Ya(n,i,o,h){const c=i[n];if(!c||!h||!o)return{becameKiller:!1};if(!c.isKiller&&o==="DOUBLE"&&h===c.number)return c.isKiller=!0,{becameKiller:!0};if(c.isKiller&&(o==="DOUBLE"||o==="TRIPLE")){const m=Object.keys(i).find(p=>p!==n&&!i[p].eliminated&&i[p].number===h);if(m){const p=i[m],H=o==="TRIPLE"?2:1;return p.lives=Math.max(0,p.lives-H),p.lives===0&&(p.eliminated=!0),{becameKiller:!1,victimId:m,livesRemoved:H}}}return{becameKiller:!1}}function Za(n){const i=Object.entries(n).filter(([,o])=>!o.eliminated&&o.lives>0);return i.length===1?i[0][0]:null}function Ja(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function Al(n,i,o,h){if(n.finished)return 0;let c=0;if(typeof h=="number"&&h===n.inning?o==="TRIPLE"?c=3:o==="DOUBLE"?c=2:c=1:!h&&(i===n.inning||i===n.inning*2||i===n.inning*3)&&(c=i===n.inning*3?3:i===n.inning*2?2:1),n.score+=c,n.dartsThisInning+=1,n.dartsThisInning>=3){const m=n.inning+1;m>9?n.finished=!0:(n.inning=m,n.dartsThisInning=0)}return c}const Ml={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function ei(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function Ll(n,i,o,h){if(n.finished)return!1;const c=Ml[n.hole];if(n.dartsThisHole+=1,typeof h=="number"&&h===c&&(o==="SINGLE"||o==="DOUBLE"||o==="TRIPLE")||!h&&(i===c||i===c*2||i===c*3)){n.strokes+=n.dartsThisHole;const p=n.hole+1;return p>18?n.finished=!0:(n.hole=p,n.dartsThisHole=0),!0}if(n.dartsThisHole>=3){n.strokes+=3;const p=n.hole+1;p>18?n.finished=!0:(n.hole=p,n.dartsThisHole=0)}return!1}const oi={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function ti(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function Tl(n){const i=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[o,h,c]of i)if(n[o]&&n[o]===n[h]&&n[o]===n[c])return n[o];return n.every(o=>o)?"Draw":null}function El(n,i,o,h,c){if(n.finished||n.board[i])return!1;const m=oi[i];let p=!1;if(m.type==="BULL"?p=h==="BULL"||h==="INNER_BULL"||o===25||o===50:m.type==="NUM"&&typeof m.num=="number"&&(typeof c=="number"&&c===m.num||!c&&(o===m.num||o===m.num*2||o===m.num*3))&&(p=!0),!p)return!1;n.board[i]=n.turn;const H=Tl(n.board);return H?(n.finished=!0,n.winner=H,!0):(n.turn=n.turn==="X"?"O":"X",!0)}function ar(){return{targetIndex:0,darts:0,finished:!1}}const ci=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],Us=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function Rl(n){return ci[n.targetIndex]}function Vs(n,i,o){if(n.finished)return n;const h=Rl(n);if(!(o==="SINGLE"&&i===h||o==="DOUBLE"&&i===h||o==="TRIPLE"&&i===h||o==="INNER_BULL"&&h===25))return n;const m=n.targetIndex+1,p=m>=ci.length;return{targetIndex:m,darts:n.darts+1,finished:p}}function si(n,i){return Vs(n,i,"SINGLE")}function Pl(){return ar()}function ir(n=50){return{score:0,darts:0,finished:!1,target:n}}const Il=[5,10,15,20,25,50];function Bl(n){return Il.includes(n)}function Os(n,i,o){if(n.finished)return n;if(!Bl(i))return{...n,darts:n.darts+1};const h=n.score+i,c=h>=n.target;return{score:c?n.target:h,darts:n.darts+1,finished:c,target:n.target}}function ni(n,i){return Os(n,i)}function Fl(n=50){return ir(n)}function lr(n=70){return{score:0,darts:0,finished:!1,target:n}}const Hl=[7,14,21];function Ul(n){return Hl.includes(n)}function _s(n,i,o){if(n.finished)return n;if(!Ul(i))return{...n,darts:n.darts+1};const h=n.score+i,c=h>=n.target;return{score:c?n.target:h,darts:n.darts+1,finished:c,target:n.target}}function ri(n,i){return _s(n,i)}function Vl(n=70){return lr(n)}const cr=[20,19,18,17,16,15,14,13,12,25];function ai(){const n={};return cr.forEach(i=>{n[i]=0}),{marks:n,points:0}}function Ol(n,i,o,h,c=()=>!1){let m=null,p=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)m=25,p=o==="INNER_BULL"||i===50?2:1;else if(typeof h=="number"&&h>=12&&h<=20)m=h,o==="TRIPLE"?p=3:o==="DOUBLE"?p=2:p=1;else if(i){for(const ue of[20,19,18,17,16,15,14,13,12]){if(i===ue){m=ue,p=1;break}if(i===ue*2){m=ue,p=2;break}if(i===ue*3){m=ue,p=3;break}}!m&&(i===25||i===50)&&(m=25,p=i===50?2:1)}if(!m)return 0;const H=n.marks[m],it=Math.max(0,3-H),ke=Math.min(it,p),j=Math.max(0,p-ke),Re=H+ke;n.marks[m]=Re>3?3:Re;let G=0;return j>0&&!c(m)&&(m===25?o==="INNER_BULL"?G+=50*j:G+=25*j:G+=m*j),n.points+=G,G}function _l(n){return cr.every(i=>(n.marks[i]||0)>=3)}function $l({left:n,right:i,className:o="",sticky:h=!0}){return e.jsxs("div",{className:`${h?"sticky top-0":""} card relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm ${o}`,children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:[n," ðŸŽ¯"]}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:i})]})}function W(n){return(i,o)=>{n(i)}}function Kl(n){const{match:i,commitManualVisitTotal:o,endTurn:h}=n;return{addVisit:(c,m=3,p)=>{if(o){o(c);return}try{i.addVisit(c,m,p)}catch{i.addVisit(c,m)}},undoVisit:()=>{i.undoVisit()},nextPlayer:()=>{if(h)try{h(0)}catch{i.nextPlayer()}else i.nextPlayer()},endLeg:c=>{typeof c=="number"?i.endLeg(c):i.endLeg(0)},endGame:()=>{i.endGame()}}}const ii=r.memo(L),li=["Easy","Medium","Hardened"],Wl=6500;function ve(n,i,o){return Math.max(i,Math.min(o,n))}function Gl(n,i){let o=0;if(i==="Easy"){const h=[22,26,41,45,60];o=h[Math.floor(Math.random()*h.length)]}else i==="Medium"?o=Math.round(ve(60+(Math.random()*30-15),30,100)):o=Math.round(ve(80+(Math.random()*20-10),50,120));return n<=0?0:o>n?[100,85,81,60,57,45,41,26,22,20,1].find(c=>c<=n)??0:o}function zl({onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:n,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const Xl=ul();function ko({user:n}){const{offlineLayout:i,favoriteDouble:o,callerEnabled:h,callerVoice:c,callerVolume:m,speakCheckoutOnly:p,rememberLastOffline:H,setLastOffline:it,autoStartOffline:ke,cameraEnabled:j,textSize:Re,boxSize:G,autoscoreProvider:ue,autoCommitMode:Ce="wait-for-clear",matchType:di="singles",setMatchType:ui,teamAName:mi="Team A",setTeamAName:xi,teamBName:hi="Team B",setTeamBName:fi}=nl(),dr=ue==="manual",A=j&&!dr,Oe=i==="classic"?"classic":"modern",Ft=j&&!dr&&Ce!=="immediate",[d,$s]=r.useState("X01"),[C,Ks]=r.useState(501),[R,ur]=r.useState("None"),[pi,mr]=r.useState(!1),[Ht,lt]=r.useState(!1),[me,z]=r.useState(C),[se,Ut]=r.useState(C),[ql,xr]=r.useState(!1),[hr,U]=r.useState(!1),[ot,fr]=r.useState(1),[ne,Vt]=r.useState(0),I=rl(),[bi,pr]=r.useState(!1),br=r.useRef(!1),[re,Ot]=r.useState(0),[_t,V]=r.useState(null),[$t,gr]=r.useState(1),[Kt,vr]=r.useState(1),[je,jr]=r.useState([]),[Nr,gi]=r.useState(2e3),Pe=al(),[_e,$e]=r.useState(!1),[yr,xe]=r.useState(!1),[Ws,Wt]=r.useState(!1),[ct,Ke]=r.useState({player:!1,opponent:!1}),Gt=il(t=>t.setPaused);r.useEffect(()=>{const t=()=>{$e(!1),lt(!1),xe(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[dt,vi]=r.useState(!1),[ut,ji]=r.useState(!1),[zt,wr]=r.useState(1),[Ql,Sr]=r.useState(!1),[ae,mt]=r.useState(!0),[Gs,Ni]=r.useState(()=>typeof window<"u"&&window.innerWidth<768),[Yl,yi]=r.useState(!1);r.useEffect(()=>{if(typeof window>"u")return;const t=()=>Ni(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),r.useEffect(()=>{Gs||yi(!1)},[Gs]),r.useEffect(()=>{const t=()=>Ze(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[k,y]=r.useState(0),[Ie,zs]=r.useState(0),[xt,Xs]=r.useState(0),[ie,kr]=r.useState(0),[Xt,Cr]=r.useState(0),[ht,qs]=r.useState(er()),[qt,Qt]=r.useState(tr()),[Ne,Yt]=r.useState(sr()),[De,Zt]=r.useState(nr()),[Zl,X]=r.useState(0),[Jt,Dr]=r.useState(1),[Qs,Ys]=r.useState(27),[Jl,Ar]=r.useState(0),[wi,Zs]=r.useState(0),[Mr,Lr]=r.useState(!1),[es,Tr]=r.useState(1),[Js,Er]=r.useState(0),[eo,Rr]=r.useState(0),Si=8,[ts,Pr]=r.useState(1),[en,Ir]=r.useState(0),[to,Br]=r.useState(0),ki=10,[ss,Fr]=r.useState(1),[tn,Hr]=r.useState(0),[so,Ur]=r.useState(0),Ci=10,[ft,sn]=r.useState(170),[Vr,Or]=r.useState(0),[ns,_r]=r.useState(0),[rs,$r]=r.useState(0),[pt,nn]=r.useState(121),[Kr,Wr]=r.useState(0),[as,Gr]=r.useState(0),[is,zr]=r.useState(0),[ye,rn]=r.useState(20),[bt,an]=r.useState(0),[Xr,ln]=r.useState(0),[Be,Di]=r.useState(30),[qr,on]=r.useState(!1),[gt,Qr]=r.useState(Ja()),[vt,Yr]=r.useState(ei()),[he,Zr]=r.useState(ti()),[cn,Jr]=r.useState(ai()),[P,dn]=r.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[jt,Nt]=r.useState({}),[ls,un]=r.useState({}),[ea,mn]=r.useState(!1),[fe,We]=r.useState(0),[no,Ge]=r.useState(0),[ze,yt]=r.useState(null),[Ai,we]=r.useState(""),[os,ro]=r.useState(ar()),[q,Xe]=r.useState(ar()),[pe,ao]=r.useState(ir(50)),[le,wt]=r.useState(ir(50)),[be,io]=r.useState(lr(70)),[oe,St]=r.useState(lr(70)),[ta,qe]=r.useState(0),[xn,Fe]=r.useState(0),[ce,O]=r.useState(0),[hn,kt]=r.useState(C),[He,Q]=r.useState(0),[fn,Ae]=r.useState(null),[cs,_]=r.useState(0),ds=r.useRef(0),Mi=r.useRef(0),Y=r.useRef(me),F=r.useRef(ce),Z=r.useRef(He),Qe=r.useRef(hn),J=r.useRef(cs);r.useEffect(()=>{Y.current=me},[me]),r.useEffect(()=>{F.current=ce},[ce]),r.useEffect(()=>{Z.current=He},[He]),r.useEffect(()=>{Qe.current=hn},[hn]),r.useEffect(()=>{J.current=cs},[cs]);const[Li,Ct]=r.useState(0);r.useRef(null);const[sa,pn]=r.useState(0),[bn,gn]=r.useState(0),[vn,Ye]=r.useState(0),[jn,Me]=r.useState(0),[Nn,Dt]=r.useState(null),[yn,At]=r.useState(0),[us,Mt]=r.useState(0),[na,ms]=r.useState(0),[xs,ra]=r.useState(0),[aa,ia]=r.useState(0),[wn,Lt]=r.useState(0),[Sn,la]=r.useState(0),[oa,hs]=r.useState(0),[ca,da]=r.useState(0),[ua,fs]=r.useState(0),[Ti,ps]=r.useState(0),[Ei,bs]=r.useState(0),[ma,kn]=r.useState(0),[Ri,Cn]=r.useState(0),[Pi,Dn]=r.useState(0),[Ii,gs]=r.useState(0),[Bi,xa]=r.useState(0),[vs,js]=r.useState(null),[Fi,Le]=r.useState(!1),[Hi,An]=r.useState(!1),[$,K]=r.useState(""),[lo,oo]=r.useState(""),[co,uo]=r.useState(""),[mo,xo]=r.useState(""),[ho,ha]=r.useState(""),[fo,fa]=r.useState(""),[Ns,pa]=r.useState(null),[Ui,Ze]=r.useState(!1),[Mn,Ln]=r.useState(!1),[Vi,ba]=r.useState({}),[po,ys]=r.useState(!1),Ue=r.useRef(null),Tn=r.useRef(null),ge=r.useCallback(()=>{const t=Tn.current;t&&(clearTimeout(t),Tn.current=null)},[]),Oi=r.useCallback(t=>{if(t>0&&t<=60){const s=ll(t,o);js({remaining:t,routes:s}),Le(!0)}else js(null),Le(!1)},[o]),ws=r.useCallback(()=>{try{Fs({type:"quit"})}catch{}$e(!1),lt(!1),xe(!1),Wt(!1),Ke({player:!1,opponent:!1})},[]);r.useEffect(()=>{Ws&&ct.player&&ct.opponent&&ws()},[ws,ct,Ws]);const ga=r.useCallback(t=>{if(!h)return;const s=It(n,"Player");try{Zn(s,t.visitTotal,Math.max(t.remaining,0),c,{volume:m,checkoutOnly:p})}catch{}},[h,c,m,p,n]),va=r.useCallback((t,s)=>{ys(!1);const{visitTotal:a,darts:l,preRemaining:u,remaining:b,doubleAttempts:g,finished:N,doubleWindow:f,highestCheckout:x}=t;N?(z(0),Y.current=0,typeof x=="number"&&x>0&&gs(v=>Math.max(v,x))):(z(b),Y.current=b),Ae(a),a===180?fs(v=>v+1):a>=140?ps(v=>v+1):a>=100&&bs(v=>v+1),f&&g>0&&(Mt(v=>v+g),N&&ms(v=>v+1)),t.announced||ga(t);try{Hs.getState().recordVisit("offline-x01",l,a,{preRemaining:u,postRemaining:N?0:b,finish:N,bust:!1})}catch{}try{I.addVisit(a,l,{visitTotal:a}),N&&I.endLeg(u)}catch{}N&&(V("player"),U(!0)),Pt(N?0:b),Q(0),Z.current=0,O(0),F.current=0,_(0),J.current=0},[Pt,gs,V,z,Ae,Q,O,_,U,fs,ps,bs,Mt,ms,ga]),Je=r.useCallback(t=>{const s=Ue.current;s&&(Ue.current=null,ge(),va(s,t))},[ge,va]);r.useCallback(t=>{Ue.current={...t,announced:!1},ys(!0),ge(),Tn.current=setTimeout(()=>Je("timeout"),Wl)},[ge,Je]),r.useEffect(()=>{if(!Ft)return;const t=()=>Je("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[Ft,Je]),r.useEffect(()=>{Ft||Je("timeout")},[Ft,Je]),r.useEffect(()=>()=>ge(),[ge]),r.useEffect(()=>{if(ce===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}ds.current=0}Mi.current=ce},[ce]);const D=It(n,"Player 1"),Ss=R==="None"?"Player 2":R,ks=Ve("X01",me,se,ne,re,xn,bn,He,vn,fn,Nn,ce,jn,na,us,aa,xs,je,ae,R,C),ja=Ve("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ht),En=Ve("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ae,R,void 0,ht,qt),Rn=Ve("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,P,jt,ls,fe),Pn=Ve("Scam"),In=Ve("Fives"),Bn=Ve("Sevens"),Fn=r.useMemo(()=>{switch(d){case"Cricket":return ja;case"Shanghai":return En;case"Killer":return Rn;case"Scam":return Pn;case"Fives":return In;case"Sevens":return Bn;default:return ks}},[d,ja,En,Rn,Pn,In,Bn,ks]),_i=d==="X01"?`${ne}-${re}`:void 0,Cs=r.useMemo(()=>{const t=ks||[],s=ce>0?He:fn??xn,a=jn>0?vn:Nn??bn;return t.length===0?{name:ae?D:Ss,isCurrentTurn:!0,legsWon:ae?ne:re,score:ae?me:se,lastScore:ae?s:a}:t.find(l=>l.isCurrentTurn)??t[0]},[ks,ae,D,Ss,ne,re,me,se,ce,He,fn,xn,vn,Nn,bn,jn]),Na=r.useMemo(()=>{if(!Cs)return[];const{matchAvg:t,allTimeAvg:s,...a}=Cs;return[{...a,matchAvg:void 0,allTimeAvg:void 0}]},[Cs]);Cs?.name;const ya=ae?me:se,Ds=I.players?.[I.currentPlayerIdx];let wa=0,Sa=0;if(Ds&&Ds.legs&&Ds.legs.length>0){for(const t of Ds.legs)if(Array.isArray(t.visits))for(const s of t.visits)wa+=s.score||0,Sa+=s.darts||0}const $i=wa+(He||0),ka=Sa+(ce||0),Ca=ka>0?$i/ka*3:0,Hn=r.useMemo(()=>{if(Fn.length>0)return Fn;switch(d){case"Double Practice":return[{name:D,isCurrentTurn:!0,target:at[Ie]?.label||"â€”",hits:xt,totalNeeded:at.length}];case"Around the Clock":return[{name:D,isCurrentTurn:!0,target:te[ie]===25?"25 (Outer Bull)":te[ie]===50?"50 (Inner Bull)":te[ie]||"â€”",hits:Xt,totalNeeded:te.length}];case"Treble Practice":return[{name:D,isCurrentTurn:!0,target:`T${ye}`,hits:bt,totalNeeded:Be}];case"Count-Up":return[{name:D,isCurrentTurn:!0,score:Js,round:es}];case"High Score":return[{name:D,isCurrentTurn:!0,score:en,round:ts}];case"Low Score":return[{name:D,isCurrentTurn:!0,score:tn,round:ss}];case"Checkout 170":return[{name:D,isCurrentTurn:!0,remaining:ft,attempts:ns,successes:rs}];case"Checkout 121":return[{name:D,isCurrentTurn:!0,remaining:pt,attempts:as,successes:is}];case"Bob's 27":return[{name:D,isCurrentTurn:!0,target:Jt,score:Qs}];case"Baseball":return[{name:D,isCurrentTurn:!0,inning:gt.inning,score:gt.score}];case"Golf":return[{name:D,isCurrentTurn:!0,hole:vt.hole,strokes:vt.strokes}];case"Tic Tac Toe":return[{name:D,isCurrentTurn:!0,turn:he.turn,winner:he.winner}];case"Scam":return[{name:D,isCurrentTurn:!0,target:Us[q.targetIndex]||"â€”",darts:q.darts,finished:q.finished}];case"Fives":return[{name:D,isCurrentTurn:!0,score:pe.score,target:pe.target,darts:pe.darts}];case"Sevens":return[{name:D,isCurrentTurn:!0,score:be.score,target:be.target,darts:be.darts}];case"High-Low":return[{name:D,isCurrentTurn:!0,round:De.round,target:De.target,score:De.score}];case"Halve It":return[{name:D,isCurrentTurn:!0,round:Ne.stage+1,target:(()=>{const t=rr(Ne);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})(),score:Ne.score}];default:return Na}},[Fn,d,D,Ie,xt,ie,Xt,ye,bt,Be,Js,es,en,ts,tn,ss,ft,ns,rs,pt,as,is,Jt,Qs,gt,vt,he,q,pe,be,De,Ne,Na]),Tt=r.useMemo(()=>{if(d==="X01")return{primaryLabel:"Current score",primaryValue:ya,secondaryLabel:"3-dart avg",secondaryValue:Ca.toFixed(1),secondaryClass:"text-emerald-300"};const t=Hn[0],s=t?.score??t?.points??t?.lives??t?.remaining??0;let a="Target",l=t?.target??t?.round??"â€”";return d==="Cricket"||d==="American Cricket"?(a="Points",l=t?.points??0):d==="Killer"?(a="Lives",l=t?.lives??0):d==="Checkout 170"||d==="Checkout 121"?(a="Remaining",l=t?.remaining??0):d==="Baseball"?(a="Inning",l=t?.inning??1):d==="Golf"?(a="Hole",l=t?.hole??1):(d==="Scam"||d==="Fives"||d==="Sevens")&&(a="Target",l=t?.target??"â€”"),{primaryLabel:"Score",primaryValue:s,secondaryLabel:a,secondaryValue:l,secondaryClass:"text-white"}},[d,ya,Ca,Hn]),Te=r.useCallback(t=>Math.max(0,Math.min(99,Math.round(t||0))).toString(),[]),M=r.useCallback((t,s=1)=>{!t||s<=0||ba(a=>({...a,[t]:(a[t]||0)+s}))},[]),E=r.useCallback(t=>{t&&ba(s=>s[t]===void 0?s:{...s,[t]:0})},[]);Vi[d];const Da=r.useCallback(()=>{Ue.current&&(Ue.current=null),ge(),ys(!1)},[ge]);r.useCallback(t=>{const s=ve(t,0,C);Da(),z(s),Y.current=s;const a=s===0?C:s;kt(a),Qe.current=a,Q(0),Z.current=0,O(0),F.current=0,_(0),J.current=0,Ae(null),Fe(0),y(0),ds.current=0,s===0?(V("player"),U(!0)):(V(null),U(!1))},[Da,z,C,kt,Q,O,_,Ae,Fe,y,V,U]);const Aa=r.useCallback((t,s)=>{t==="player"?(Vt(s),ha("")):(Ot(s),fa("")),V(null),U(!1)},[Ot,fa,ha,V,Vt,U]),Ki=r.useCallback(()=>{pa(t=>t&&(t.stage===1?{...t,stage:2}:(Aa(t.target,t.value),null)))},[Aa]),Et=r.useCallback(()=>{pa(null)},[]);r.useEffect(()=>{if(!Ns)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),Et())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[Et,Ns]);const Un=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(Re),et=r.useRef(null),tt=r.useRef(null),Vn=r.useRef(null),[Se,Rt]=r.useState("first"),[st,On]=r.useState(1),Wi=r.useRef(null);r.useEffect(()=>{const t=Math.max(1,Math.floor(Number(st)||1)),s=Se==="first"?t:Math.max(1,Math.ceil(t/2));fr(s)},[Se,st]),r.useEffect(()=>{if(!ut){wr(1),Sr(!1);return}const t=()=>{const l=et.current,u=tt.current;if(!l||!u)return;const b=Vn.current?Vn.current.getBoundingClientRect().height:0,g=Math.max(0,l.clientHeight-b-6),N=Math.max(0,l.clientWidth-8),f=u.getBoundingClientRect(),x=zt||1,v=f.height/x,w=f.width/x,T=g>0?g/v:1,S=N>0?N/w:1,Bs=Math.min(1,Math.max(.5,Math.min(T,S))),de=v*Bs,sl=g>0&&de-g>1;Sr(sl),wr(Bs)};t();const s=window.ResizeObserver,a=s?new s(()=>t()):null;return a&&et.current&&a.observe(et.current),a&&tt.current&&a.observe(tt.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{a&&et.current&&a.unobserve(et.current)}catch{}try{a&&tt.current&&a.unobserve(tt.current)}catch{}}},[ut,zt]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.mode;a&&($s(a),Ee())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.formatType,l=s?.detail?.formatCount,u=s?.detail?.startScore;(a==="first"||a==="best")&&Rt(a),typeof l=="number"&&isFinite(l)&&On(Math.max(1,Math.floor(l))),typeof u=="number"&&isFinite(u)&&Ks(Math.max(1,Math.floor(u)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),r.useEffect(()=>{if(!ke)return;const t=setTimeout(()=>Ee(),50);return()=>clearTimeout(t)},[ke]),r.useEffect(()=>{if(!_e||ae||R==="None"||Li<=0)return;let t,s=performance.now();const a=l=>{const u=l-s;s=l,Ct(b=>{const g=b-u;if(g<=0){let N=0,f=0,x=se;for(Me(0);N<3&&x>0;){const v=Gl(x,R),w=ve(v-N*20,0,Math.min(60,x)),T=x-w;if(gn(w),pn(de=>de+1),la(de=>de+1),T<0){x=se,Ye(0),At(0),f=0,Dt(0),Me(0);break}f+=w,Ye(de=>de+w),da(de=>de+w);const S=x,Bs=T;if(S>50&&Bs<=50?At(1):S<=50&&At(de=>de+1),x=T,N+=1,Me(N),x===0)break}if(Ut(x),x===0){f===180?kn(w=>w+1):f>=140?Cn(w=>w+1):f>=100&&Dn(w=>w+1);const v=se;v<=170&&xa(w=>Math.max(w,v)),se<=50&&(ra(w=>w+(yn>0?yn:1)),ia(w=>w+1)),Dt(f),Ye(0),At(0),Me(0),V("ai"),U(!0)}return x>0&&N>=3&&(f===180?kn(v=>v+1):f>=140?Cn(v=>v+1):f>=100&&Dn(v=>v+1),Dt(f),Ye(0),At(0),Me(0)),Me(0),mt(!0),0}return g}),t=requestAnimationFrame(a)};return t=requestAnimationFrame(a),()=>cancelAnimationFrame(t)},[_e,ae,R,se]),r.useEffect(()=>{I.inProgress&&(br.current||(pr(!0),br.current=!0))},[I.inProgress]);function Ee(){lt(!0),z(C),Y.current=C,Ut(C),xr(!1),$e(!0),mt(!0),y(0),qe(0),Fe(0),O(0),F.current=0,kt(C),Q(0),Ae(null),_(0),Ct(0),pn(0),gn(0),Ye(0),Me(0),Dt(null),V(null),Vt(0),Ot(0),jr([]),an(0),ln(0),on(!1),Lt(0),la(0),hs(0),da(0),fs(0),ps(0),bs(0),kn(0),Cn(0),Dn(0),gs(0),xa(0),Mt(0),ms(0),ra(0),ia(0),E("X01");const t=Math.max(1,Math.floor(Number(st)||1));if(fr(Se==="first"?t:Math.max(1,Math.ceil(t/2))),H)try{it({mode:d,x01Start:C,firstTo:ot,aiLevel:R})}catch{}const s=It(n,"You"),a=R!=="None"?`AI (${R})`:"Opponent",l=R!=="None"?[s,a]:[s];I.newMatch(l,C,`offline-${Date.now()}`)}function Gi(){z(C),Y.current=C,Ut(C),xr(!1),js(null),Le(!1),$e(!0),mt(!0),y(0),qe(0),Fe(0),O(0),F.current=0,kt(C),Q(0),Qe.current=C,Z.current=0,Ae(null),_(0),J.current=0,J.current=0,Ct(0),pn(0),gn(0),Ye(0),Me(0),Dt(null),V(null)}function Pt(t){Oi(t),O(0),F.current=0,kt(t===0?C:t),Qe.current=t===0?C:t,_(0),J.current=0,R!=="None"?(mt(!1),Ct(Nr)):(Ct(0),mt(!0))}function B(t){if(!Number.isFinite(t))return!1;const s=Qe.current,a=Y.current,l=F.current,u=Z.current,b=l>0||u>0;b&&(z(s),Y.current=s,O(0),F.current=0,Q(0),Z.current=0,_(0),J.current=0,Fe(0),y(0),qe(S=>Math.max(0,S-l)),Lt(S=>Math.max(0,S-l)),hs(S=>Math.max(0,S-u)),ds.current=0);const g=b?s:a,N=g<=170?170:180,f=ve(Math.round(t),0,N),x=g-f,v=ve(Math.round(Kt||0),0,3),w=ve(Math.round($t||0),0,3),T=x===0?v:3;if(M("X01",T),qe(S=>S+T),Lt(S=>S+T),O(T),F.current=T,Q(f),Z.current=f,Ae(f),f===180?fs(S=>S+1):f>=140?ps(S=>S+1):f>=100&&bs(S=>S+1),x<0){if(h)try{Zn(D,0,Math.max(s,0),c,{volume:m,checkoutOnly:p})}catch{}try{Hs.getState().recordVisit("offline-x01",T,0,{preRemaining:g,postRemaining:s,bust:!0,finish:!1})}catch{}z(s),Y.current=s,Ae(0),Q(0),Z.current=0,O(0),F.current=0,_(0),J.current=0;try{I.addVisit(0,T)}catch{}return Pt(s),!0}if(z(x),Y.current=x,hs(S=>S+f),h)try{Zn(D,f,Math.max(x,0),c,{volume:m,checkoutOnly:p})}catch{}if(x===0?(Mt(S=>S+w),ms(S=>S+1),_(w),J.current=w):g<=50&&Mt(S=>S+3),x===0){g<=170&&gs(S=>Math.max(S,g)),js(null),Le(!1);try{Hs.getState().recordVisit("offline-x01",T,f,{preRemaining:g,postRemaining:0,finish:!0,bust:!1})}catch{}try{I.addVisit(f,T),I.endLeg(g)}catch{}return V("player"),U(!0),O(0),F.current=0,Q(0),Z.current=0,_(0),J.current=0,!0}try{Hs.getState().recordVisit("offline-x01",T,f,{preRemaining:g,postRemaining:x,finish:!1,bust:!1})}catch{}try{I.addVisit(f,T)}catch{}return Pt(x),Q(0),Z.current=0,O(0),F.current=0,_(0),J.current=0,!0}const ee=Kl({match:I,commitManualVisitTotal:B,endTurn:Pt}),[_n,$n]=r.useState(""),Ma=t=>{$n(t)},zi=t=>t===50?{ring:"INNER_BULL",sector:25}:t===25?{ring:"BULL",sector:25}:t>=1&&t<=20?{ring:"SINGLE",sector:t}:{ring:void 0,sector:null},Xi=t=>{const{ring:s,sector:a}=zi(t);switch(d){case"Double Practice":Wn(t);return;case"Around the Clock":Rs(t,s,a);return;case"Cricket":Ps(t,s,a);return;case"Shanghai":Is(t,s,a);return;case"Halve It":qn(t,s,a);return;case"High-Low":Qn(t,s,a);return;case"Bob's 27":Gn(t,s,a);return;case"Count-Up":As(t);return;case"High Score":Ms(t);return;case"Low Score":Ls(t);return;case"Checkout 170":zn(t,s);return;case"Checkout 121":Xn(t,s);return;case"Treble Practice":Es(t,s,a);return;case"Baseball":Fa(t,s,a);return;case"Golf":Ha(t,s,a);return;case"American Cricket":Ua(t,s,a);return;case"Scam":Xe(Vs(q,t,s));return;case"Fives":setFives(Os(pe,t));return;case"Sevens":setSevens(_s(be,t));return;default:Pe("Use manual controls for this mode.",{type:"info",timeout:2e3})}},Kn=()=>{const t=parseInt(_n,10);if(isNaN(t)||t<0){alert("Enter a valid number");return}if(d!=="X01"){const l=ve(Math.round(t),0,999);Xi(l),$n("");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=Y.current<=170?170:180,a=ve(Math.round(t),0,s);t>s&&Pe(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),B(a)&&$n("")},La=r.useCallback(()=>{Ue.current&&(Ue.current=null,ge(),ys(!1));const t=F.current,s=Z.current,a=Qe.current;t===0&&s===0||(z(a),Y.current=a,O(0),F.current=0,Q(0),Z.current=0,_(0),J.current=0,Fe(0),y(0),qe(l=>Math.max(0,l-t)),Lt(l=>Math.max(0,l-t)),hs(l=>Math.max(0,l-s)),ds.current=0)},[ge]);r.useEffect(()=>{const t=s=>{const a=s?.detail;!a||a?.source==="offline-play"||La()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[La]);function Wn(t){M("Double Practice");const s=ve(Math.round(t||0),0,60);if(Fe(s),qe(a=>a+1),Lt(a=>a+1),Qa(s,Ie)){const a=xt+1;Xs(a),zs(l=>Math.min(20,l+1)),a>=21&&(V("player"),U(!0))}y(0)}function Ta(){Wn(Number(k))}function Ea(){const t=Bt($);if(t==null){alert("Enter like D16, 50, 25, T20");return}Wn(t),K("")}function Gn(t,s,a){if(Mr)return!1;M("Bob's 27");const l=Jt,u=s==="DOUBLE"&&a===l||!s&&t===l*2;return u&&Zs(b=>b+1),Ar(b=>{const g=b+1;if(g>=3){const N=wi+(u?1:0);N>0?Ys(x=>x+N*l*2):Ys(x=>x-l*2);const f=l+1;return Dr(f),Zs(0),f>20&&Lr(!0),0}return g}),!0}function Ra(){Gn(Math.max(0,k|0)),y(0)}function Pa(){Dr(1),Ys(27),Ar(0),Zs(0),Lr(!1),E("Bob's 27")}function As(t){return M("Count-Up"),Er(s=>s+Math.max(0,t|0)),Rr(s=>{const a=s+1;return a>=3?(Tr(l=>l+1),0):a}),!0}function Ms(t){return M("High Score"),Ir(s=>s+Math.max(0,t|0)),Br(s=>{const a=s+1;return a>=3?(Pr(l=>l+1),0):a}),!0}function Ls(t){return M("Low Score"),Hr(s=>s+Math.max(0,t|0)),Ur(s=>{const a=s+1;return a>=3?(Fr(l=>l+1),0):a}),!0}function Ia(t,s,a,l,u,b,g,N){const f=t-g;if(!(f<0))if(f===0){if(N==="DOUBLE"||N==="INNER_BULL"){b(x=>x+1),u(x=>x+1),l(()=>0),s(t);return}s(f)}else s(f);l(x=>{const v=x+1;return v>=3?(u(w=>w+1),0):v})}function zn(t,s){return M("Checkout 170"),Ia(ft,sn,Vr,Or,_r,$r,t,s),Vr+1>=3&&sn(170),!0}function Xn(t,s){return M("Checkout 121"),Ia(pt,nn,Kr,Wr,Gr,zr,t,s),Kr+1>=3&&nn(121),!0}function Ts(t){const s=Bt($);if(s==null){alert("Enter like T20, D16, 25, 50");return}const a=$.trim().toUpperCase(),l=a.startsWith("D")||a==="50"||a==="BULL"||a==="DBULL"||a==="IBULL"||a.includes("INNER");t?zn(s,l?"DOUBLE":void 0):Xn(s,l?"DOUBLE":void 0),K("")}function qi(){sn(170),Or(0),_r(0),$r(0),E("Checkout 170")}function Qi(){nn(121),Wr(0),Gr(0),zr(0),E("Checkout 121")}function Es(t,s,a){return qr?!1:(M("Treble Practice"),(s==="TRIPLE"&&a===ye||!s&&t===ye*3)&&an(u=>u+1),ln(u=>{const b=u+1;if(b%3===0&&[20,19,18].includes(ye)){const g=["T20","T19","T18"],N=g.indexOf(`T${ye}`),f=g[(N+1)%g.length];rn(Number(f.replace("T","")))}return Be>0&&b>=Be&&on(!0),b}),!0)}function Ba(){an(0),ln(0),on(!1),E("Treble Practice")}function Fa(t,s,a){return M("Baseball"),Qr(l=>{const u={...l};return Al(u,t,s,a),u}),!0}function Yi(){Qr(Ja()),E("Baseball")}function Ha(t,s,a){return M("Golf"),Yr(l=>{const u={...l};return Ll(u,t,s,a),u}),!0}function Zi(){Yr(ei()),E("Golf")}function Ji(t,s,a,l){return M("Tic Tac Toe"),Zr(u=>{const b={...u,board:[...u.board]};return El(b,t,s,a,l),b}),!0}function el(){Zr(ti()),E("Tic Tac Toe")}function Ua(t,s,a){return M("American Cricket"),Jr(l=>{const u={...l,marks:{...l.marks}};return Ol(u,t,s,a,()=>!1),u}),!0}function Va(){Jr(ai()),E("American Cricket")}function Rs(t,s,a){M("Around the Clock");const l=te[ie];let u=!1;if(typeof a=="number"&&a===l&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(u=!0),l===25&&(s==="BULL"||t===25)&&(u=!0),l===50&&(s==="INNER_BULL"||t===50)&&(u=!0),u||(t===l||t===l*2||t===l*3)&&(u=!0),u){const b=Xt+1;return Cr(b),kr(g=>g+1),!0}return!0}function Oa(){Rs(Math.max(0,k|0)),y(0)}function _a(){const t=Bt($);if(t==null){alert("Enter like T20, D5, 25, 50");return}Rs(t),K("")}function Ps(t,s,a){return M("Cricket"),qs(l=>{const u={...l,marks:{...l.marks}};return bl(u,t,s,a,()=>!1),u}),X(l=>{const u=l+1;return u>=3?0:u}),!0}function $a(){Ps(Math.max(0,k|0)),y(0)}function Is(t,s,a){return M("Shanghai"),Qt(l=>{const u={...l,turnHits:{...l.turnHits}};return jl(u,t,s,a),u}),X(l=>{const u=l+1;return u>=3?(Qt(b=>{const g={...b,turnHits:{...b.turnHits}};return Nl(g),g}),0):u}),!0}function Ka(){Is(Math.max(0,k|0)),y(0)}function qn(t,s,a){return M("Halve It"),Yt(l=>{const u={...l,targets:[...l.targets]};return yl(u,t,s,a),u}),X(l=>{const u=l+1;return u>=3?(Yt(b=>{const g={...b,targets:[...b.targets]};return wl(g),g}),0):u}),!0}function Wa(){qn(Math.max(0,k|0)),y(0)}function Qn(t,s,a){return M("High-Low"),Zt(l=>{const u={...l};return Sl(u,t,s,a),u}),X(l=>{const u=l+1;return u>=3?(Zt(b=>{const g={...b};return kl(g),g}),0):u}),!0}function Ga(){Qn(Math.max(0,k|0)),y(0)}function tl(){const t=_t??"player",s=t==="player"?cs||void 0:yn||void 0,a=1,l=t==="player"?ta:sa;jr([...je,{winner:t,doubleDarts:$t,checkoutDarts:Kt,winnerDarts:l,doublesAtt:s,doublesHit:a}]),U(!1);let u=ne,b=re;if(_t==="player"?u+=1:_t==="ai"&&(b+=1),Vt(u),Ot(b),V(null),u>=ot||b>=ot){try{xl(d,t==="player")}catch{}try{I.endGame()}catch{}$e(!1),lt(!1),z(C),Ut(C),An(!0);return}Gi()}const Yn=!Jn.includes(d)&&!(n?.fullAccess||n?.admin);return e.jsxs("div",{className:"card ndn-game-shell ndn-page flex flex-col min-h-0 relative overflow-hidden md:overflow-hidden overflow-y-auto",children:[bi&&e.jsx(ol,{players:I.players||[],user:n,onDone:()=>pr(!1)}),!_e&&!Ht&&e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h2",{className:"text-2xl font-bold ndn-section-title",children:"Offline Mode ðŸŽ®"})}),e.jsxs("div",{className:"ndn-shell-body",children:[!_e&&!Ht&&e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:d,onChange:t=>$s(t.target.value),children:[Jn.map(t=>e.jsx("option",{value:t,children:t},t)),Xa.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t," ",n?.fullAccess||n?.admin?"":"(Premium)"]},t))]}),d==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:Be,onChange:t=>Di(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."}),j&&!Gs&&e.jsx("div",{className:"hidden md:block w-[360px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2",style:{willChange:"transform, opacity"},children:e.jsx(ii,{scoringMode:"x01",showToolbar:A,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:W(B),onAutoDart:(t,s,a)=>{}})})})]}),!n?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),d==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:C,onChange:t=>Ks(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:R,onChange:t=>ur(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),li.map(t=>e.jsx("option",{value:t,children:t},t))]}),R!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:Nr/1e3,onChange:t=>gi(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>mr(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),d==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!_e&&!Ht&&e.jsx("button",{className:"btn",disabled:Yn,title:Yn?"PREMIUM required for this mode":"",onClick:Ee,children:"Start Match ðŸš€"}),_e&&e.jsx("div",{className:`fixed inset-0 z-[1000] bg-slate-950/90 backdrop-blur-sm ${dt?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(nt,{storageKey:"ndn:modal:offline-match:v2",frameClassName:"relative",frameFullScreenClassName:"relative ndn-modal-full",className:`${dt?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:dt,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex h-full",children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 pl-2 sm:pl-3",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{et.current=t},children:[Oe!=="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:t=>{Vn.current=t},children:e.jsx($l,{className:"w-full",left:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[d,d==="X01"?` / ${C}`:""]}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",ot," Â· Legs ",ne,"-",re]}),e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs bg-white/10 text-white/70 border-white/20",children:"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:ut?"Actual Size":"Fit All",onClick:()=>ji(t=>!t),children:ut?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:dt?"Restore":"Maximize",onClick:()=>vi(t=>!t),children:dt?"Restore":"Maximize"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ee()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>xe(!0),children:"Quit"})]})})}),yr&&e.jsx(qa,{onClose:()=>xe(!1),onQuit:()=>{if(R==="None"){xe(!1),Ke({player:!0,opponent:!1}),Wt(!0);return}ws()},onPause:()=>{try{Gt(!0,null,D),Fs({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:D})}catch{}xe(!1)}})]}),Ws&&e.jsx("div",{className:"fixed inset-0 z-[170] flex items-center justify-center bg-black/70 p-4",children:e.jsxs(nt,{storageKey:"ndn:modal:offline-quit-confirm",className:"w-full relative",defaultWidth:460,defaultHeight:320,minWidth:360,minHeight:260,maxWidth:720,maxHeight:520,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Confirm Quit (Both Players)"}),e.jsx("p",{className:"text-sm text-slate-200 mb-4",children:"Both players must accept to end the match. If either player wants to continue, the match will keep going."}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("button",{className:`btn w-full ${ct.player?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>Ke(t=>({...t,player:!0})),children:[It(n,"Player 1")," Accepts"]}),e.jsxs("button",{className:`btn w-full ${ct.opponent?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>Ke(t=>({...t,opponent:!0})),children:[R==="None"?"Opponent":`${R} AI`," Accepts"]}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 w-full",onClick:()=>{Ke({player:!1,opponent:!1}),Wt(!1)},children:"Continue Match"})]})]})}),d==="X01"&&Fi&&vs&&e.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center bg-black/70 p-4",onClick:()=>Le(!1),children:e.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl",onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key==="Escape")&&(t.preventDefault(),Le(!1))},tabIndex:-1,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-emerald-200/70",children:"Checkout box"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-100",children:[vs.remaining," left"]})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Le(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${$t===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>gr(t),children:Te(t)},`double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Kt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>vr(t),children:Te(t)},`checkout-${t}`))})]}),vs.routes.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-emerald-200/80 mb-1",children:"Suggested checkout"}),e.jsx("div",{className:"space-y-1",children:vs.routes.map(t=>e.jsx("div",{className:"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold",children:t},t))})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>Le(!1),children:"Enter"})})]})]})}),e.jsxs("div",{ref:t=>{tt.current=t},className:"will-change-transform",style:ut?{transform:`scale(${zt})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,zt))}em`}:void 0,children:[Oe!=="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:d==="X01"?"X01 Match âš”ï¸":`${d} âš”ï¸`}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",d]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",C]}),e.jsxs("div",{ref:Wi,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=me!==C||se!==C||ce>0,s=`pill ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${s} ${Se==="first"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Rt("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${s} ${Se==="best"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Rt("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:st,onChange:a=>On(Math.max(1,Math.floor(Number(a.target.value)||1))),disabled:t,title:Se==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",ne,"â€“",re]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`input input-compact font-bold ${Un}`,value:di,onChange:t=>ui(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${Un} w-[7.5rem]`,value:mi,onChange:t=>xi(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${Un} w-[7.5rem]`,value:hi,onChange:t=>fi(t.target.value),placeholder:"Team B"})]})]})]}),Oe!=="modern"&&d!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[d==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:at[Ie]?.label||"â€”"})]})}),d==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:te[ie]===25?"25 (Outer Bull)":te[ie]===50?"50 (Inner Bull)":te[ie]||"â€”"})]})}),d==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:or.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,ht.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:ht.points})]}),gl(ht)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{qs(er()),X(0),E("Cricket")},children:"Reset"})]})]}),d==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:qt.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",qt.score]}),qt.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Qt(tr()),X(0),E("Shanghai")},children:"Reset"})]})]}),d==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[Ne.stage+1,"/",Ne.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=rr(Ne);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ne.score]}),Ne.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Yt(sr()),X(0),E("Halve It")},children:"Reset"})]})]}),d==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",De.round," Â· Target ",De.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",De.score]}),De.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Zt(nr()),X(0),E("High-Low")},children:"Reset"})]})]}),d==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",Jt]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Qs]}),Mr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Pa,children:"Reset"})]})]}),d==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",es,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Js]})]}),d==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",ts,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",en]})]}),d==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",ss,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",tn]})]}),d==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:ft}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",ns," Â· Successes:"," ",rs]})]}),d==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:pt}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",as," Â· Successes:"," ",is]})]}),d==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",ye]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",bt]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${ye===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>rn(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:ye,onChange:t=>rn(parseInt(t.target.value,10)),children:Array.from({length:20},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ba,children:"Reset"})]})]})}),d==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:gt.inning}),e.jsxs("div",{className:"text-sm",children:["Score:"," ",e.jsx("span",{className:"font-semibold",children:gt.score})]})]}),d==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:vt.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes:"," ",e.jsx("span",{className:"font-semibold",children:vt.strokes})]})]}),d==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:he.turn}),he.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",he.winner||"â€”"]})]}),d==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Us[os.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[os.targetIndex+1,"/",Us.length]})]}),os.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",os.darts," darts!"]})]}),d==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[pe.score,"/",pe.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:pe.darts})]}),pe.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",pe.target,"!"]})]}),d==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[be.score,"/",be.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:be.darts})]}),be.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",be.target,"!"]})]}),d==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:cr.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,cn.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:cn.points})]}),_l(cn)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Va,children:"Reset"})]})]}),d==="Killer"&&e.jsx(e.Fragment,{children:ea?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:P[fe]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:ze?`${P.find(t=>t.id===ze)?.name||"Winner"} Wins`:Ai||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):Oe==="modern"?e.jsxs("div",{className:"space-y-3 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap py-1",children:[e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-rose-600/20 text-rose-200 border border-rose-400/30 hover:bg-rose-600/40 transition-colors",onClick:()=>xe(!0),children:"Quit"}),e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-amber-600/20 text-amber-200 border border-amber-400/30 hover:bg-amber-600/40 transition-colors",onClick:()=>{try{Gt(!0,null,D),Fs({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:D})}catch{}Pe("Match paused â€” select duration on overlay",{type:"info",timeout:2500})},children:"Pause"}),e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-slate-600/20 text-slate-200 border border-slate-400/30 hover:bg-slate-600/40 transition-colors",onClick:()=>Ee(),children:"Restart"}),e.jsx("button",{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-colors ${Mn?"bg-indigo-600/40 text-indigo-100 border-indigo-400/50":"bg-indigo-600/20 text-indigo-200 border-indigo-400/30 hover:bg-indigo-600/40"}`,onClick:()=>Ln(t=>!t),children:Mn?"Close Setup â–²":"New Match â–¼"})]}),Mn&&e.jsxs("div",{className:"rounded-2xl bg-slate-900/80 border border-white/10 p-3 space-y-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Match Setup"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Game Mode"}),e.jsxs("select",{className:"input w-full text-sm",value:d,onChange:t=>$s(t.target.value),children:[Jn.map(t=>e.jsx("option",{value:t,children:t},t)),Xa.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t,n?.fullAccess||n?.admin?"":" (Premium)"]},t))]})]}),d==="X01"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Starting Score"}),e.jsx("input",{className:"input w-full text-sm",type:"number",min:1,max:1001,value:C,onChange:t=>Ks(Number(t.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Format"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-xs border ${Se==="first"?"bg-white/20 border-white/30":"bg-transparent border-white/10 opacity-60"}`,onClick:()=>Rt("first"),children:"First to"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-xs border ${Se==="best"?"bg-white/20 border-white/30":"bg-transparent border-white/10 opacity-60"}`,onClick:()=>Rt("best"),children:"Best of"}),e.jsx("input",{className:"input w-14 text-center text-sm",type:"number",min:1,step:1,value:st,onChange:t=>On(Math.max(1,Math.floor(Number(t.target.value)||1)))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"AI Opponent"}),e.jsxs("select",{className:"input w-full text-sm",value:R,onChange:t=>ur(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),li.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>{Ln(!1),Ee()},children:"Start New Match ðŸš€"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Ln(!1),children:"Cancel"})]})]}),yr&&e.jsx(qa,{onClose:()=>xe(!1),onQuit:()=>{if(R==="None"){xe(!1),Ke({player:!0,opponent:!1}),Wt(!0);return}ws()},onPause:()=>{try{Gt(!0,null,D),Fs({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:D})}catch{}xe(!1)}})]}):null,Oe!=="modern"?e.jsxs("div",{className:"space-y-2",children:[d==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:at[Ie]?.label||"â€”"})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&Qa(t,Ie)){const l=xt+1,u=Ie+1;return Xs(l),zs(u),l>=at.length&&setTimeout(()=>{Xs(0),zs(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ta()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ta,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:$,onChange:t=>K(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ea()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ea,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",xt," of 21"]})]}),d==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:te[ie]===25?"25 (Outer Bull)":te[ie]===50?"50 (Inner Bull)":te[ie]||"â€”"})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Rs(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Oa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Oa,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:$,onChange:t=>K(t.target.value),onKeyDown:t=>{t.key==="Enter"&&_a()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:_a,children:"Add"})]}),Xt>=te.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Cr(0),kr(0),E("Around the Clock")},children:"Reset"})]})]}),d==="Cricket"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ps(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&$a()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$a,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{qs(er()),X(0),E("Cricket")},children:"Reset"})]})]}),d==="Shanghai"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Is(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ka()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ka,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Qt(tr()),X(0),E("Shanghai")},children:"Reset"})]})]}),d==="Halve It"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>qn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Wa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Wa,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Yt(sr()),X(0),E("Halve It")},children:"Reset"})]})]}),d==="High-Low"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Qn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ga()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ga,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Zt(nr()),X(0),E("High-Low")},children:"Reset"})]})]}),d==="Bob's 27"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Gn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ra()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ra,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Pa,children:"Reset"})]})]}),d==="Count-Up"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:t=>As(t),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(As(k),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{As(k),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Tr(1),Er(0),Rr(0),E("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",es,"/",Si]})]}),d==="High Score"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:t=>Ms(t),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Ms(k),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Ms(k),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Pr(1),Ir(0),Br(0),E("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",ts,"/",ki]})]}),d==="Low Score"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:t=>Ls(t),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Ls(k),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Ls(k),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Fr(1),Hr(0),Ur(0),E("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",ss,"/",Ci]})]}),d==="Checkout 170"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s)=>zn(t,s==="MISS"?void 0:s),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:$,onChange:t=>K(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ts(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ts(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:qi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",ft," Â· Attempts: ",ns," ","Â· Successes: ",rs]})]}),d==="Checkout 121"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s)=>Xn(t,s==="MISS"?void 0:s),onAddVisit:W(B),onEndLeg:t=>ee.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:$,onChange:t=>K(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ts(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ts(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Qi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",pt," Â· Attempts: ",as," ","Â· Successes: ",is]})]}),d==="Treble Practice"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Es(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:$,onChange:t=>K(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=Bt($);s!=null&&Es(s,void 0,void 0),K("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=Bt($);t!=null&&Es(t,void 0,void 0),K("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",bt," Â· Misses:"," ",Math.max(0,Xr-bt)," Â· Darts:"," ",Xr,Be>0?`/${Be}`:""]}),qr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Ba,children:"Reset"})]})]}),d==="Baseball"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Fa(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Yi,children:"Reset"})})]}),d==="Golf"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ha(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Zi,children:"Reset"})})]}),d==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${he.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(he.finished||he.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),a=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",l=t,u=oi[l],b=u.type==="BULL"?null:u.num||null;Ji(l,s,a,b)},children:he.board[t]||""},t))}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:el,children:"Reset"})})]}),d==="American Cricket"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ua(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Va,children:"Reset"})})]}),d==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Us[q.targetIndex]})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{const l=s==="MISS"?void 0:s;return M("Scam"),Xe(Vs(q,t,l)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(M("Scam"),Xe(si(q,k)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{M("Scam"),Xe(si(q,k)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Xe(Pl()),E("Scam")},children:"Reset"})]}),q.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",q.darts," darts!"]})]}),d==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[le.score,"/",le.target]})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(M("Fives"),wt(Os(le,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(M("Fives"),wt(ni(le,k)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{M("Fives"),wt(ni(le,k)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{wt(Fl(le.target)),E("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",le.darts]}),le.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",le.target," in"," ",le.darts," darts!"]})]}),d==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[oe.score,"/",oe.target]})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(M("Sevens"),St(_s(oe,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:k,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(M("Sevens"),St(ri(oe,k)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{M("Sevens"),St(ri(oe,k)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{St(Vl(oe.target)),E("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",oe.darts]}),oe.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",oe.target," in"," ",oe.darts," darts!"]})]}),d==="Killer"&&e.jsx(e.Fragment,{children:ea?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:P.map(t=>{const s=jt[t.id],a=ls[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number:"," ",e.jsx("span",{className:"font-semibold",children:a})]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsx("span",{className:"font-semibold",children:s?.lives??0})]})]},t.id)})}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(ze)return!1;const l=s==="MISS"?void 0:s,u=a?.sector??null,b=P[fe];return b?(Nt(g=>{const N={};Object.keys(g).forEach(v=>N[v]={...g[v]});const f=Ya(b.id,N,l,u);if(f.becameKiller)we(`${b.name} became a Killer`);else if(f.victimId){const v=P.find(w=>w.id===f.victimId);we(`${b.name} hit ${v?.name}'s ${ls[f.victimId]} (${f.livesRemoved} life${(f.livesRemoved||0)>1?"s":""})`)}else we("No effect");const x=Za(N);return x&&yt(x),N}),Ge(g=>{const N=g+1;if(N>=3){let f=fe;for(let x=1;x<=P.length;x++){const v=(fe+x)%P.length,w=P[v].id,T=jt[w];if(T&&!T.eliminated&&T.lives>0){f=v;break}}return We(f),0}return N}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:$,onChange:t=>K(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(ze)return;const a=$.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!a){K("");return}const l=a[1]||"S",u=parseInt(a[2],10),b=l==="D"?"DOUBLE":l==="T"?"TRIPLE":"SINGLE",g=P[fe];Nt(N=>{const f={};Object.keys(N).forEach(w=>f[w]={...N[w]});const x=Ya(g.id,f,b,u);if(x.becameKiller)we(`${g.name} became a Killer`);else if(x.victimId){const w=P.find(T=>T.id===x.victimId);we(`${g.name} hit ${w?.name}'s ${ls[x.victimId]} (${x.livesRemoved} life${(x.livesRemoved||0)>1?"s":""})`)}else we("No effect");const v=Za(f);return v&&yt(v),f}),K(""),Ge(N=>{const f=N+1;if(f>=3){let x=fe;for(let v=1;v<=P.length;v++){const w=(fe+v)%P.length,T=P[w].id,S=jt[T];if(S&&!S.eliminated&&S.lives>0){x=w;break}}return We(x),0}return f})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=fe;for(let s=1;s<=P.length;s++){const a=(fe+s)%P.length,l=P[a].id,u=jt[l];if(u&&!u.eliminated&&u.lives>0){t=a;break}}We(t),Ge(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Nt({}),un({}),mn(!1),We(0),Ge(0),yt(null),we("")},children:"Reset"})]}),ze&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",P.find(t=>t.id===ze)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Nt({}),un({}),mn(!1),We(0),Ge(0),yt(null),we("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:P.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:a=>{const l=a.target.value;dn(u=>u.map((b,g)=>g===s?{...b,name:l}:b))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>dn(a=>a.filter((l,u)=>u!==s)),disabled:P.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>dn(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(P.length<2){alert("Need at least 2 players");return}const t=P.map(l=>l.id),s=Dl(t),a={};t.forEach(l=>{a[l]=Cl(s[l])}),un(s),Nt(a),We(0),Ge(0),yt(null),we("Assigned numbers"),mn(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-2",children:"Visit total"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:d==="X01"?me<=170?170:180:999,placeholder:d==="X01"?"0â€“180":"0â€“999",value:_n,onChange:t=>Ma(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Kn()}}),e.jsx("button",{className:"btn px-4 py-1 text-sm",onClick:Kn,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(fl,{value:_n,onChange:Ma,onSubmit:Kn,helperText:"Tap numbers then Enter to commit the visit total."})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:Tt.primaryLabel}),e.jsx("div",{className:"text-lg font-bold text-white",children:Tt.primaryValue})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:Tt.secondaryLabel}),e.jsx("div",{className:`text-lg font-bold ${Tt.secondaryClass}`,children:Tt.secondaryValue})]})]})}),e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Game"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[d,d==="X01"?` / ${C}`:""]})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Format"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[Se==="first"?"First to":"Best of"," ",st," Â· ",ne,"-",re]})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(rt,{gameMode:d,players:Hn,matchScore:_i})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!j&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),j?e.jsx("div",{className:"bg-black aspect-video max-h-[420px]",children:e.jsx(ii,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!1,disableDetection:!0})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Tap numbers then Enter to commit a 3-dart visit."})]}),e.jsx("div",{className:"flex flex-col gap-3 min-h-0 flex-1 text-[14px]",children:e.jsx("div",{className:"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"}})}),d==="Cricket"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Ps(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),d==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(rt,{gameMode:"Shanghai",players:En})}),d==="Shanghai"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Is(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),d==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(rt,{gameMode:"Killer",players:Rn})}),d==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(rt,{gameMode:"Scam",players:Pn})}),d==="Scam"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Xe(Vs(q,t,s)),!0}})}),d==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(rt,{gameMode:"Fives",players:In})}),d==="Fives"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return wt(Os(le,t)),!0}})}),d==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(rt,{gameMode:"Sevens",players:Bn})}),d==="Sevens"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return St(_s(oe,t)),!0}})})]}),e.jsx("div",{className:"h-1"})]})]})})})}),pi&&e.jsx(zl,{onClose:()=>mr(!1)}),Yn&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${Xl}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&Pe("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?Pe("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):Pe("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{Pe("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",cl(dl(),5)]})]})]}),Ui&&typeof document<"u"?za.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>Ze(!1),children:e.jsx(nt,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>Ze(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>Ze(!1),children:"Close"})]}),e.jsx(ml,{fill:!0,user:n,playerScore:me,aiScore:se,x01Score:C,inMatch:Ht,showWinPopup:hr,pendingLegWinner:_t,playerDartsThrown:ta,aiDartsThrown:sa,totalPlayerDarts:wn,totalAiDarts:Sn,totalPlayerPoints:oa,totalAiPoints:ca,player180s:ua,player140s:Ti,player100s:Ei,ai180s:ma,ai140s:Ri,ai100s:Pi,playerHighestCheckout:Ii,aiHighestCheckout:Bi,onClose:()=>Ze(!1),onOpen:()=>Ze(!0),layout:Oe})]})})}),document.body):null,Ns&&typeof document<"u"?za.createPortal((()=>{const{target:t,value:s,stage:a}=Ns,l=t==="player"?D:Ss,u=t==="player"?ne:re;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:Et,children:e.jsx(nt,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:Et,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",a," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:a===1?e.jsxs(e.Fragment,{children:["Set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:u})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:Et,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Ki,children:"Yes"})]})]})})})})(),document.body):null,hr&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]",children:e.jsxs(nt,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:pl(I.players?.[I.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${$t===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>gr(t),children:Te(t)},`win-double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Kt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>vr(t),children:Te(t)},`win-checkout-${t}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:tl,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{U(!1),Ee()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{U(!1),$e(!1),lt(!1)},children:"Back to Menu"})]})]})}),Hi&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(nt,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[d," Â· ",C," start Â· First to ",ot]}),(()=>{const t=wn>0?oa/wn*3:0,s=(()=>{const f=je.filter(x=>x.winner==="player"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),a=(()=>{const f=je.filter(x=>x.winner==="player"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),l=us>0?Math.round(na/us*100):0,u=Sn>0?ca/Sn*3:0,b=(()=>{const f=je.filter(x=>x.winner==="ai"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),g=(()=>{const f=je.filter(x=>x.winner==="ai"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),N=xs>0?Math.round(aa/xs*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:It(n,"You")}),e.jsx("div",{className:"text-3xl font-extrabold",children:ne}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:us})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[l,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:s})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:a})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ua})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[ne," â€“ ",re]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:R==="None"?"Opponent":`${R} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:re}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:u.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:xs})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[N,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:b})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:g})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ma})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:je.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":R==="None"?"Opp":"AI"," ","Â· Dbl ",Te(t.doubleDarts)," Â· CO"," ",Te(t.checkoutDarts||0)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>An(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{An(!1),Ee()},children:"Rematch"})]})]})}),je.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:je.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",Te(t.doubleDarts),", Checkout darts: ",Te(t.checkoutDarts||0)]},s))})]})]}),e.jsx(hl,{localPlayerName:D,onResume:()=>{Gt(!1,null)}})]})}export{ko as default};
//# sourceMappingURL=OfflinePlay-B8RLyVcx.js.map
