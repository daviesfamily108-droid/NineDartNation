import{b as Ci,u as ki,i as Di,e as Ai,k as Mi,l as Li,m as Ti,n as jt,o as dn,p as as,j as e,M as Ei,r as ar,q as rr,t as Ri,R as Ye,G as Re,C as A,v as Pi,w as Ii,h as Hi,x as Bi,y as Vi}from"./index-rAzhK-sV.js";import{r as a}from"./ui-DygUIHRq.js";import{M as Ui,S as Fi}from"./MatchControls-BFCF6xja.js";import{f as Oi}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const un=[...Array.from({length:20},(n,i)=>({label:`D${i+1}`,score:(i+1)*2})),{label:"DBULL",score:50,isBull:!0}];function ir(n,i){const o=un[i];return!!o&&n===o.score}function yt(n){const i=n.trim().toUpperCase();if(!i)return null;if(i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL")return 50;if(i==="25"||i==="OBULL")return 25;const o=i.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!o)return null;const m=o[1]||"S",c=parseInt(o[2],10);return c<1||c>20?null:c*(m==="S"?1:m==="D"?2:3)}const wt=[...Array.from({length:20},(n,i)=>i+1),25,50],_i=[20,19,18,17,16,15,25];function lr(){const n={};return _i.forEach(i=>{n[i]=0}),{marks:n,points:0}}function Ki(n,i,o,m,c=()=>!1){let u=null,x=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)u=25,x=o==="INNER_BULL"||i===50?2:1;else if(typeof m=="number"&&m>=15&&m<=20)u=m,o==="TRIPLE"?x=3:o==="DOUBLE"?x=2:x=1;else if(i){const K=[20,19,18,17,16,15];for(const $ of K){if(i===$){u=$,x=1;break}if(i===$*2){u=$,x=2;break}if(i===$*3){u=$,x=3;break}}!u&&(i===25||i===50)&&(u=25,x=i===50?2:1)}if(!u)return 0;const H=n.marks[u],ge=Math.max(0,3-H),te=Math.min(ge,x),v=Math.max(0,x-te),ue=H+te;n.marks[u]=ue>3?3:ue;let U=0;return v>0&&!c(u)&&(u===25?o==="INNER_BULL"?U+=50*v:U+=25*v:U+=u*v),n.points+=U,U}function or(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function $i(n){return n.round}function Wi(n,i,o,m){if(n.finished)return 0;const c=$i(n);let u=0;return typeof m=="number"&&m===c?o==="TRIPLE"?(u=c*3,n.turnHits.triples++):o==="DOUBLE"?(u=c*2,n.turnHits.doubles++):o==="SINGLE"&&(u=c*1,n.turnHits.singles++):!m&&(i===c||i===c*2||i===c*3)&&(i===c*3?(u=c*3,n.turnHits.triples++):i===c*2?(u=c*2,n.turnHits.doubles++):i===c&&(u=c,n.turnHits.singles++)),n.score+=u,u}function Gi(n){if(!n.finished){if(n.turnHits.singles>0&&n.turnHits.doubles>0&&n.turnHits.triples>0){n.shanghaiAchieved=!0,n.finished=!0;return}const i=n.round+1;i>20?n.finished=!0:n.round=i}n.turnHits={singles:0,doubles:0,triples:0}}function cr(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function zi(n){return n.targets[n.stage]||null}function Xi(n,i,o,m){if(n.finished)return 0;const c=zi(n);if(!c)return 0;let u=0;switch(c.kind){case"NUMBER":{typeof m=="number"&&m===c.num?o==="TRIPLE"?u=c.num*3:o==="DOUBLE"?u=c.num*2:o==="SINGLE"&&(u=c.num):!m&&(i===c.num||i===c.num*2||i===c.num*3)&&(u=i),u>0&&(n.hitThisRound=!0);break}case"DOUBLE":{(o==="DOUBLE"&&m===c.num||i===c.num*2)&&(u=c.num*2,n.hitThisRound=!0);break}case"TRIPLE":{(o==="TRIPLE"&&m===c.num||i===c.num*3)&&(u=c.num*3,n.hitThisRound=!0);break}case"BULL":{(o==="BULL"||o==="INNER_BULL"||i===25||i===50)&&(u=o==="INNER_BULL"||i===50?50:25,n.hitThisRound=!0);break}case"ANY_NUMBER":{i>0&&(u=i,n.hitThisRound=!0);break}}return n.score+=u,u}function Yi(n){n.finished||(n.hitThisRound||(n.score=Math.floor(n.score/2)),n.hitThisRound=!1,n.stage+=1,n.stage>=n.targets.length&&(n.finished=!0))}function dr(){return{round:1,score:0,target:"HIGH",finished:!1}}function qi(n,i,o,m){if(n.finished)return 0;let c=0;if(n.target==="HIGH")if(o==="INNER_BULL")c=50;else if(typeof m=="number"){const x=m*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);m>=20&&(c=x)}else i>=40&&(c=i);else if(typeof m=="number"){const x=m*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);m<=10&&(c=x)}else i>0&&i<=30&&(c=i);return n.score+=c,c}function Qi(n){if(!n.finished){if(n.round+=1,n.round>10){n.finished=!0;return}n.target=n.target==="HIGH"?"LOW":"HIGH"}}function Zi(n,i=3){return{number:n,lives:i,isKiller:!1,eliminated:!1}}function Ji(n){const i=Array.from({length:20},(m,c)=>c+1),o={};for(const m of n){const c=Math.floor(Math.random()*i.length),u=i.splice(c,1)[0];o[m]=u}return o}function ur(n,i,o,m){const c=i[n];if(!c||!m||!o)return{becameKiller:!1};if(!c.isKiller&&o==="DOUBLE"&&m===c.number)return c.isKiller=!0,{becameKiller:!0};if(c.isKiller&&(o==="DOUBLE"||o==="TRIPLE")){const u=Object.keys(i).find(x=>x!==n&&!i[x].eliminated&&i[x].number===m);if(u){const x=i[u],H=o==="TRIPLE"?2:1;return x.lives=Math.max(0,x.lives-H),x.lives===0&&(x.eliminated=!0),{becameKiller:!1,victimId:u,livesRemoved:H}}}return{becameKiller:!1}}function mr(n){const i=Object.entries(n).filter(([,o])=>!o.eliminated&&o.lives>0);return i.length===1?i[0][0]:null}function hr(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function el(n,i,o,m){if(n.finished)return 0;let c=0;if(typeof m=="number"&&m===n.inning?o==="TRIPLE"?c=3:o==="DOUBLE"?c=2:c=1:!m&&(i===n.inning||i===n.inning*2||i===n.inning*3)&&(c=i===n.inning*3?3:i===n.inning*2?2:1),n.score+=c,n.dartsThisInning+=1,n.dartsThisInning>=3){const u=n.inning+1;u>9?n.finished=!0:(n.inning=u,n.dartsThisInning=0)}return c}const tl={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function fr(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function sl(n,i,o,m){if(n.finished)return!1;const c=tl[n.hole];if(n.dartsThisHole+=1,typeof m=="number"&&m===c&&(o==="SINGLE"||o==="DOUBLE"||o==="TRIPLE")||!m&&(i===c||i===c*2||i===c*3)){n.strokes+=n.dartsThisHole;const x=n.hole+1;return x>18?n.finished=!0:(n.hole=x,n.dartsThisHole=0),!0}if(n.dartsThisHole>=3){n.strokes+=3;const x=n.hole+1;x>18?n.finished=!0:(n.hole=x,n.dartsThisHole=0)}return!1}const jr={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function xr(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function nl(n){const i=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[o,m,c]of i)if(n[o]&&n[o]===n[m]&&n[o]===n[c])return n[o];return n.every(o=>o)?"Draw":null}function al(n,i,o,m,c){if(n.finished||n.board[i])return!1;const u=jr[i];let x=!1;if(u.type==="BULL"?x=m==="BULL"||m==="INNER_BULL"||o===25||o===50:u.type==="NUM"&&typeof u.num=="number"&&(typeof c=="number"&&c===u.num||!c&&(o===u.num||o===u.num*2||o===u.num*3))&&(x=!0),!x)return!1;n.board[i]=n.turn;const H=nl(n.board);return H?(n.finished=!0,n.winner=H,!0):(n.turn=n.turn==="X"?"O":"X",!0)}function mn(){return{targetIndex:0,darts:0,finished:!1}}const yr=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],rl=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function il(n){return yr[n.targetIndex]}function hn(n,i,o){if(n.finished)return n;const m=il(n);if(!(o==="SINGLE"&&i===m||o==="DOUBLE"&&i===m||o==="TRIPLE"&&i===m||o==="INNER_BULL"&&m===25))return n;const u=n.targetIndex+1,x=u>=yr.length;return{targetIndex:u,darts:n.darts+1,finished:x}}function br(n,i){return hn(n,i,"SINGLE")}function ll(){return mn()}function fn(n=50){return{score:0,darts:0,finished:!1,target:n}}const ol=[5,10,15,20,25,50];function cl(n){return ol.includes(n)}function xn(n,i,o){if(n.finished)return n;if(!cl(i))return{...n,darts:n.darts+1};const m=n.score+i,c=m>=n.target;return{score:c?n.target:m,darts:n.darts+1,finished:c,target:n.target}}function pr(n,i){return xn(n,i)}function dl(n=50){return fn(n)}function bn(n=70){return{score:0,darts:0,finished:!1,target:n}}const ul=[7,14,21];function ml(n){return ul.includes(n)}function pn(n,i,o){if(n.finished)return n;if(!ml(i))return{...n,darts:n.darts+1};const m=n.score+i,c=m>=n.target;return{score:c?n.target:m,darts:n.darts+1,finished:c,target:n.target}}function gr(n,i){return pn(n,i)}function hl(n=70){return bn(n)}const fl=[20,19,18,17,16,15,14,13,12,25];function vr(){const n={};return fl.forEach(i=>{n[i]=0}),{marks:n,points:0}}function xl(n,i,o,m,c=()=>!1){let u=null,x=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)u=25,x=o==="INNER_BULL"||i===50?2:1;else if(typeof m=="number"&&m>=12&&m<=20)u=m,o==="TRIPLE"?x=3:o==="DOUBLE"?x=2:x=1;else if(i){for(const K of[20,19,18,17,16,15,14,13,12]){if(i===K){u=K,x=1;break}if(i===K*2){u=K,x=2;break}if(i===K*3){u=K,x=3;break}}!u&&(i===25||i===50)&&(u=25,x=i===50?2:1)}if(!u)return 0;const H=n.marks[u],ge=Math.max(0,3-H),te=Math.min(ge,x),v=Math.max(0,x-te),ue=H+te;n.marks[u]=ue>3?3:ue;let U=0;return v>0&&!c(u)&&(u===25?o==="INNER_BULL"?U+=50*v:U+=25*v:U+=u*v),n.points+=U,U}function V(n){return(i,o)=>{n(i)}}function bl(n){const{match:i,commitManualVisitTotal:o,endTurn:m}=n;return{addVisit:(c,u=3,x)=>{if(o){o(c);return}try{i.addVisit(c,u,x)}catch{i.addVisit(c,u)}},undoVisit:()=>{i.undoVisit()},nextPlayer:()=>{if(m)try{m(0)}catch{i.nextPlayer()}else i.nextPlayer()},endLeg:c=>{typeof c=="number"?i.endLeg(c):i.endLeg(0)},endGame:()=>{i.endGame()}}}function Pe(n,i,o,m,c,u,x,H,ge,te,v,ue,U,K,$,rs,qe,ve,Ne,se,Qe,Ie,C,je,De,g,Ze){return a.useMemo(()=>{const S=[];if(n==="X01"){let le=0,L=0,Ae=0;if(ve&&ve.length>0){for(const P of ve)P.dartsThrown&&P.totalScored&&(L+=P.dartsThrown,Ae+=P.totalScored);L>0&&(le=Ae/L*3)}const O=(ue??0)>0?H??0:te??null??(u??0);if(S.push({name:"You",isCurrentTurn:!!Ne,legsWon:m||0,score:typeof i=="number"?i:typeof Qe=="number"?Qe:0,lastScore:O,avg:le,checkoutRate:$&&$>0?Math.round((K||0)/$*100):0,bestLeg:ve&&ve.length>0?`${Math.min(...ve.map(P=>P.doubleDarts+(P.checkoutDarts||0)))||0} darts`:"â€”",matchAvg:le,allTimeAvg:Ci("You")||0}),se&&se!=="None"){const F=(U??0)>0?ge??0:v??null??(x??0);S.push({name:`${se} AI`,isCurrentTurn:!Ne,legsWon:c||0,score:typeof o=="number"?o:typeof Qe=="number"?Qe:0,lastScore:F,avg:void 0,checkoutRate:qe&&qe>0?Math.round((rs||0)/qe*100):0,bestLeg:"â€”"})}}return n==="Cricket"&&(S.push({name:"You",isCurrentTurn:!!Ne,closed:Ie?.marks||{},points:Ie?.points||0}),se&&se!=="None"&&S.push({name:`${se} AI`,isCurrentTurn:!Ne,closed:{},points:0})),n==="Shanghai"&&(S.push({name:"You",isCurrentTurn:!!Ne,round:C?.round||1,target:C?.target||1,score:C?.score||0}),se&&se!=="None"&&S.push({name:`${se} AI`,isCurrentTurn:!Ne,round:C?.round||1,target:C?.target||1,score:0})),n==="Killer"&&je&&je.length>0&&je.forEach((le,L)=>{const Ae=De?.[le.id];S.push({name:le.name,isCurrentTurn:L===Ze,number:g?.[le.id],lives:Ae?.lives||0,eliminated:Ae?.eliminated||!1})}),S},[n,i,o,m,c,u,x,H,ge,te,v,ue,U,K,$,rs,qe,ve,Ne,se,Ie,C,je,De,g,Ze])}const Nr=a.memo(A),pl=["Easy","Medium","Hardened"],gl=6500;function pe(n,i,o){return Math.max(i,Math.min(o,n))}function vl(n,i){let o=0;if(i==="Easy"){const m=[22,26,41,45,60];o=m[Math.floor(Math.random()*m.length)]}else i==="Medium"?o=Math.round(pe(60+(Math.random()*30-15),30,100)):o=Math.round(pe(80+(Math.random()*20-10),50,120));return n<=0?0:o>n?[100,85,81,60,57,45,41,26,22,20,1].find(c=>c<=n)??0:o}function Nl({onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:n,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const jl=Hi();function co({user:n}){const{offlineLayout:i,favoriteDouble:o,callerEnabled:m,callerVoice:c,callerVolume:u,speakCheckoutOnly:x,rememberLastOffline:H,setLastOffline:ge,autoStartOffline:te,cameraEnabled:v,textSize:ue,boxSize:U,autoscoreProvider:K,autoCommitMode:$="wait-for-clear",matchType:rs="singles",setMatchType:qe,teamAName:ve="Team A",setTeamAName:Ne,teamBName:se="Team B",setTeamBName:Qe}=ki(),Ie=K==="manual",C=v&&!Ie,je="modern",De=v&&!Ie&&$!=="immediate",[g,Ze]=a.useState("X01"),[S,le]=a.useState(501),[L,Ae]=a.useState("None"),[gn,is]=a.useState(!1),[Je,He]=a.useState(!1),[oe,O]=a.useState(S),[P,et]=a.useState(S),[wr,ls]=a.useState(!1),[os,F]=a.useState(!1),[St,vn]=a.useState(1),[me,Ct]=a.useState(0),B=Di(),[Sr,Nn]=a.useState(!1),jn=a.useRef(!1),[he,kt]=a.useState(0),[Dt,W]=a.useState(null),[At,yn]=a.useState(1),[Mt,wn]=a.useState(1),[fe,Sn]=a.useState([]),[Cn,Cr]=a.useState(2e3),tt=Ai(),[Be,Ve]=a.useState(!1),[yl,kn]=a.useState(!1),[cs,Dn]=a.useState(!1),[st,Lt]=a.useState({player:!1,opponent:!1});Mi(t=>t.setPaused),a.useEffect(()=>{const t=()=>{Ve(!1),He(!1),kn(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[ds,wl]=a.useState(!1),[us,Sl]=a.useState(!1),[Tt,An]=a.useState(1),[Cl,Mn]=a.useState(!1),[ne,nt]=a.useState(!0),[at,kr]=a.useState(()=>typeof window<"u"&&window.innerWidth<768),[Ln,ms]=a.useState(!1);a.useEffect(()=>{if(typeof window>"u")return;const t=()=>kr(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),a.useEffect(()=>{at||ms(!1)},[at]),a.useEffect(()=>{const t=()=>$e(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[D,y]=a.useState(0),[Et,hs]=a.useState(0),[fs,xs]=a.useState(0),[Rt,Tn]=a.useState(0),[En,Rn]=a.useState(0),[Pn,In]=a.useState(lr()),[Dr,bs]=a.useState(or()),[kl,ps]=a.useState(cr()),[Dl,gs]=a.useState(dr()),[Al,ye]=a.useState(0),[Ar,Hn]=a.useState(1),[Ml,vs]=a.useState(27),[Ll,Bn]=a.useState(0),[Mr,Ns]=a.useState(0),[Lr,Vn]=a.useState(!1),[Tr,Un]=a.useState(1),[Tl,Fn]=a.useState(0),[El,On]=a.useState(0),Er=8,[Rr,_n]=a.useState(1),[Rl,Kn]=a.useState(0),[Pl,$n]=a.useState(0),Pr=10,[Ir,Wn]=a.useState(1),[Il,Gn]=a.useState(0),[Hl,zn]=a.useState(0),Hr=10,[Xn,js]=a.useState(170),[Yn,qn]=a.useState(0),[Br,Qn]=a.useState(0),[Vr,Zn]=a.useState(0),[Jn,ys]=a.useState(121),[ea,ta]=a.useState(0),[Ur,sa]=a.useState(0),[Fr,na]=a.useState(0),[Pt,Or]=a.useState(20),[aa,ws]=a.useState(0),[ra,Ss]=a.useState(0),[rt,_r]=a.useState(30),[ia,Cs]=a.useState(!1),[Bl,la]=a.useState(hr()),[Vl,oa]=a.useState(fr()),[It,ca]=a.useState(xr()),[Ul,da]=a.useState(vr()),[E,ks]=a.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[it,lt]=a.useState({}),[Ht,Ds]=a.useState({}),[Kr,As]=a.useState(!1),[xe,Ue]=a.useState(0),[Fl,Fe]=a.useState(0),[Bt,ot]=a.useState(null),[Ol,be]=a.useState(""),[_l,Kl]=a.useState(mn()),[Me,ct]=a.useState(mn()),[$l,Wl]=a.useState(fn(50)),[ae,dt]=a.useState(fn(50)),[Gl,zl]=a.useState(bn(70)),[re,ut]=a.useState(bn(70)),[ua,Oe]=a.useState(0),[Ms,Le]=a.useState(0),[ce,G]=a.useState(0),[Ls,mt]=a.useState(S),[Te,Q]=a.useState(0),[Ts,we]=a.useState(null),[Vt,z]=a.useState(0),Ut=a.useRef(0),$r=a.useRef(0),Z=a.useRef(oe),_=a.useRef(ce),J=a.useRef(Te),_e=a.useRef(Ls),ee=a.useRef(Vt);a.useEffect(()=>{Z.current=oe},[oe]),a.useEffect(()=>{_.current=ce},[ce]),a.useEffect(()=>{J.current=Te},[Te]),a.useEffect(()=>{_e.current=Ls},[Ls]),a.useEffect(()=>{ee.current=Vt},[Vt]);const[Wr,ht]=a.useState(0);a.useRef(null);const[ma,Es]=a.useState(0),[Rs,Ps]=a.useState(0),[Is,Ke]=a.useState(0),[Hs,Se]=a.useState(0),[Bs,ft]=a.useState(null),[Vs,xt]=a.useState(0),[Ft,bt]=a.useState(0),[ha,Ot]=a.useState(0),[_t,fa]=a.useState(0),[xa,ba]=a.useState(0),[Us,pt]=a.useState(0),[Fs,pa]=a.useState(0),[ga,Kt]=a.useState(0),[va,Na]=a.useState(0),[ja,$t]=a.useState(0),[Gr,Wt]=a.useState(0),[zr,Gt]=a.useState(0),[ya,Os]=a.useState(0),[Xr,_s]=a.useState(0),[Yr,Ks]=a.useState(0),[qr,zt]=a.useState(0),[Qr,wa]=a.useState(0),[Xt,Yt]=a.useState(null),[Zr,Ce]=a.useState(!1),[Jr,$s]=a.useState(!1),[X,Y]=a.useState(""),[Xl,Yl]=a.useState(""),[ql,Ql]=a.useState(""),[Zl,Jl]=a.useState(""),[eo,Sa]=a.useState(""),[to,Ca]=a.useState(""),[qt,ka]=a.useState(null),[ei,$e]=a.useState(!1),[ti,Da]=a.useState({}),[so,Qt]=a.useState(!1),Ee=a.useRef(null),Ws=a.useRef(null),de=a.useCallback(()=>{const t=Ws.current;t&&(clearTimeout(t),Ws.current=null)},[]),si=a.useCallback(t=>{if(t>0&&t<=60){const s=Li(t,o);Yt({remaining:t,routes:s}),Ce(!0)}else Yt(null),Ce(!1)},[o]),Aa=a.useCallback(()=>{try{Ti({type:"quit"})}catch{}Ve(!1),He(!1),kn(!1),Dn(!1),Lt({player:!1,opponent:!1})},[]);a.useEffect(()=>{cs&&st.player&&st.opponent&&Aa()},[Aa,st,cs]);const Ma=a.useCallback(t=>{if(!m)return;const s=jt(n,"Player");try{dn(s,t.visitTotal,Math.max(t.remaining,0),c,{volume:u,checkoutOnly:x})}catch{}},[m,c,u,x,n]),La=a.useCallback((t,s)=>{Qt(!1);const{visitTotal:r,darts:l,preRemaining:d,remaining:b,doubleAttempts:p,finished:j,doubleWindow:f,highestCheckout:h}=t;j?(O(0),Z.current=0,typeof h=="number"&&h>0&&zt(N=>Math.max(N,h))):(O(b),Z.current=b),we(r),r===180?$t(N=>N+1):r>=140?Wt(N=>N+1):r>=100&&Gt(N=>N+1),f&&p>0&&(bt(N=>N+p),j&&Ot(N=>N+1)),t.announced||Ma(t);try{as.getState().recordVisit("offline-x01",l,r,{preRemaining:d,postRemaining:j?0:b,finish:j,bust:!1})}catch{}try{B.addVisit(r,l,{visitTotal:r}),j&&B.endLeg(d)}catch{}j&&(W("player"),F(!0)),Nt(j?0:b),Q(0),J.current=0,G(0),_.current=0,z(0),ee.current=0},[Nt,zt,W,O,we,Q,G,z,F,$t,Wt,Gt,bt,Ot,Ma]),We=a.useCallback(t=>{const s=Ee.current;s&&(Ee.current=null,de(),La(s,t))},[de,La]);a.useCallback(t=>{Ee.current={...t,announced:!1},Qt(!0),de(),Ws.current=setTimeout(()=>We("timeout"),gl)},[de,We]),a.useEffect(()=>{if(!De)return;const t=()=>We("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[De,We]),a.useEffect(()=>{De||We("timeout")},[De,We]),a.useEffect(()=>()=>de(),[de]),a.useEffect(()=>{if(ce===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}Ut.current=0}$r.current=ce},[ce]);const Ge=jt(n,"Player 1"),Zt=L==="None"?"Player 2":L,Jt=Pe("X01",oe,P,me,he,Ms,Rs,Te,Is,Ts,Bs,ce,Hs,ha,Ft,xa,_t,fe,ne,L,S),Ta=Pe("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Pn),Gs=Pe("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ne,L,void 0,Pn,Dr),zs=Pe("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,E,it,Ht,xe),Xs=Pe("Scam"),Ys=Pe("Fives"),qs=Pe("Sevens");a.useMemo(()=>{switch(g){case"Cricket":return Ta;case"Shanghai":return Gs;case"Killer":return zs;case"Scam":return Xs;case"Fives":return Ys;case"Sevens":return qs;default:return Jt}},[g,Ta,Gs,zs,Xs,Ys,qs,Jt]);const ni=g==="X01"?`${me}-${he}`:void 0,es=a.useMemo(()=>{const t=Jt||[],s=ce>0?Te:Ts??Ms,r=Hs>0?Is:Bs??Rs;return t.length===0?{name:ne?Ge:Zt,isCurrentTurn:!0,legsWon:ne?me:he,score:ne?oe:P,lastScore:ne?s:r}:t.find(l=>l.isCurrentTurn)??t[0]},[Jt,ne,Ge,Zt,me,he,oe,P,ce,Te,Ts,Ms,Is,Bs,Rs,Hs]),Ea=a.useMemo(()=>{if(!es)return[];const{matchAvg:t,allTimeAvg:s,...r}=es;return[{...r,matchAvg:void 0,allTimeAvg:void 0}]},[es]);es?.name;const ai=ne?oe:P,ts=B.players?.[B.currentPlayerIdx];let Ra=0,Pa=0;if(ts&&ts.legs&&ts.legs.length>0){for(const t of ts.legs)if(Array.isArray(t.visits))for(const s of t.visits)Ra+=s.score||0,Pa+=s.darts||0}const ri=Ra+(Te||0),Ia=Pa+(ce||0),ii=Ia>0?ri/Ia*3:0,ke=a.useCallback(t=>Math.max(0,Math.min(99,Math.round(t||0))).toString(),[]),M=a.useCallback((t,s=1)=>{!t||s<=0||Da(r=>({...r,[t]:(r[t]||0)+s}))},[]),R=a.useCallback(t=>{t&&Da(s=>s[t]===void 0?s:{...s,[t]:0})},[]);ti[g];const Ha=a.useCallback(()=>{Ee.current&&(Ee.current=null),de(),Qt(!1)},[de]);a.useCallback(t=>{const s=pe(t,0,S);Ha(),O(s),Z.current=s;const r=s===0?S:s;mt(r),_e.current=r,Q(0),J.current=0,G(0),_.current=0,z(0),ee.current=0,we(null),Le(0),y(0),Ut.current=0,s===0?(W("player"),F(!0)):(W(null),F(!1))},[Ha,O,S,mt,Q,G,z,we,Le,y,W,F]);const Ba=a.useCallback((t,s)=>{t==="player"?(Ct(s),Sa("")):(kt(s),Ca("")),W(null),F(!1)},[kt,Ca,Sa,W,Ct,F]),li=a.useCallback(()=>{ka(t=>t&&(t.stage===1?{...t,stage:2}:(Ba(t.target,t.value),null)))},[Ba]),gt=a.useCallback(()=>{ka(null)},[]);a.useEffect(()=>{if(!qt)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),gt())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[gt,qt]);const ze=a.useRef(null),Xe=a.useRef(null),Va=a.useRef(null),[Qs,oi]=a.useState("first"),[Zs,ci]=a.useState(1);a.useRef(null),a.useEffect(()=>{const t=Math.max(1,Math.floor(Number(Zs)||1)),s=Qs==="first"?t:Math.max(1,Math.ceil(t/2));vn(s)},[Qs,Zs]),a.useEffect(()=>{if(!us){An(1),Mn(!1);return}const t=()=>{const l=ze.current,d=Xe.current;if(!l||!d)return;const b=Va.current?Va.current.getBoundingClientRect().height:0,p=Math.max(0,l.clientHeight-b-6),j=Math.max(0,l.clientWidth-8),f=d.getBoundingClientRect(),h=Tt||1,N=f.height/h,w=f.width/h,T=p>0?p/N:1,k=j>0?j/w:1,ns=Math.min(1,Math.max(.5,Math.min(T,k))),ie=N*ns,Si=p>0&&ie-p>1;Mn(Si),An(ns)};t();const s=window.ResizeObserver,r=s?new s(()=>t()):null;return r&&ze.current&&r.observe(ze.current),r&&Xe.current&&r.observe(Xe.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{r&&ze.current&&r.unobserve(ze.current)}catch{}try{r&&Xe.current&&r.unobserve(Xe.current)}catch{}}},[us,Tt]),a.useEffect(()=>{const t=s=>{const r=s?.detail?.mode;r&&(Ze(r),vt())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),a.useEffect(()=>{const t=s=>{const r=s?.detail?.formatType,l=s?.detail?.formatCount,d=s?.detail?.startScore;(r==="first"||r==="best")&&oi(r),typeof l=="number"&&isFinite(l)&&ci(Math.max(1,Math.floor(l))),typeof d=="number"&&isFinite(d)&&le(Math.max(1,Math.floor(d)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),a.useEffect(()=>{if(!te)return;const t=setTimeout(()=>vt(),50);return()=>clearTimeout(t)},[te]),a.useEffect(()=>{if(!Be||ne||L==="None"||Wr<=0)return;let t,s=performance.now();const r=l=>{const d=l-s;s=l,ht(b=>{const p=b-d;if(p<=0){let j=0,f=0,h=P;for(Se(0);j<3&&h>0;){const N=vl(h,L),w=pe(N-j*20,0,Math.min(60,h)),T=h-w;if(Ps(w),Es(ie=>ie+1),pa(ie=>ie+1),T<0){h=P,Ke(0),xt(0),f=0,ft(0),Se(0);break}f+=w,Ke(ie=>ie+w),Na(ie=>ie+w);const k=h,ns=T;if(k>50&&ns<=50?xt(1):k<=50&&xt(ie=>ie+1),h=T,j+=1,Se(j),h===0)break}if(et(h),h===0){f===180?Os(w=>w+1):f>=140?_s(w=>w+1):f>=100&&Ks(w=>w+1);const N=P;N<=170&&wa(w=>Math.max(w,N)),P<=50&&(fa(w=>w+(Vs>0?Vs:1)),ba(w=>w+1)),ft(f),Ke(0),xt(0),Se(0),W("ai"),F(!0)}return h>0&&j>=3&&(f===180?Os(N=>N+1):f>=140?_s(N=>N+1):f>=100&&Ks(N=>N+1),ft(f),Ke(0),xt(0),Se(0)),Se(0),nt(!0),0}return p}),t=requestAnimationFrame(r)};return t=requestAnimationFrame(r),()=>cancelAnimationFrame(t)},[Be,ne,L,P]),a.useEffect(()=>{B.inProgress&&(jn.current||(Nn(!0),jn.current=!0))},[B.inProgress]);function vt(){He(!0),O(S),Z.current=S,et(S),ls(!1),Ve(!0),nt(!0),y(0),Oe(0),Le(0),G(0),_.current=0,mt(S),Q(0),we(null),z(0),ht(0),Es(0),Ps(0),Ke(0),Se(0),ft(null),W(null),Ct(0),kt(0),Sn([]),ws(0),Ss(0),Cs(!1),pt(0),pa(0),Kt(0),Na(0),$t(0),Wt(0),Gt(0),Os(0),_s(0),Ks(0),zt(0),wa(0),bt(0),Ot(0),fa(0),ba(0),R("X01");const t=Math.max(1,Math.floor(Number(Zs)||1));if(vn(Qs==="first"?t:Math.max(1,Math.ceil(t/2))),H)try{ge({mode:g,x01Start:S,firstTo:St,aiLevel:L})}catch{}const s=jt(n,"You"),r=L!=="None"?`AI (${L})`:"Opponent",l=L!=="None"?[s,r]:[s];B.newMatch(l,S,`offline-${Date.now()}`)}function di(){O(S),Z.current=S,et(S),ls(!1),Yt(null),Ce(!1),Ve(!0),nt(!0),y(0),Oe(0),Le(0),G(0),_.current=0,mt(S),Q(0),_e.current=S,J.current=0,we(null),z(0),ee.current=0,ee.current=0,ht(0),Es(0),Ps(0),Ke(0),Se(0),ft(null),W(null)}function Nt(t){si(t),G(0),_.current=0,mt(t===0?S:t),_e.current=t===0?S:t,z(0),ee.current=0,L!=="None"?(nt(!1),ht(Cn)):(ht(0),nt(!0))}function I(t){if(!Number.isFinite(t))return!1;const s=_e.current,r=Z.current,l=_.current,d=J.current,b=l>0||d>0;b&&(O(s),Z.current=s,G(0),_.current=0,Q(0),J.current=0,z(0),ee.current=0,Le(0),y(0),Oe(k=>Math.max(0,k-l)),pt(k=>Math.max(0,k-l)),Kt(k=>Math.max(0,k-d)),Ut.current=0);const p=b?s:r,j=p<=170?170:180,f=pe(Math.round(t),0,j),h=p-f,N=pe(Math.round(Mt||0),0,3),w=pe(Math.round(At||0),0,3),T=h===0?N:3;if(M("X01",T),Oe(k=>k+T),pt(k=>k+T),G(T),_.current=T,Q(f),J.current=f,we(f),f===180?$t(k=>k+1):f>=140?Wt(k=>k+1):f>=100&&Gt(k=>k+1),h<0){if(m)try{dn(Ge,0,Math.max(s,0),c,{volume:u,checkoutOnly:x})}catch{}try{as.getState().recordVisit("offline-x01",T,0,{preRemaining:p,postRemaining:s,bust:!0,finish:!1})}catch{}O(s),Z.current=s,we(0),Q(0),J.current=0,G(0),_.current=0,z(0),ee.current=0;try{B.addVisit(0,T)}catch{}return Nt(s),!0}if(O(h),Z.current=h,Kt(k=>k+f),m)try{dn(Ge,f,Math.max(h,0),c,{volume:u,checkoutOnly:x})}catch{}if(h===0?(bt(k=>k+w),Ot(k=>k+1),z(w),ee.current=w):p<=50&&bt(k=>k+3),h===0){p<=170&&zt(k=>Math.max(k,p)),Yt(null),Ce(!1);try{as.getState().recordVisit("offline-x01",T,f,{preRemaining:p,postRemaining:0,finish:!0,bust:!1})}catch{}try{B.addVisit(f,T),B.endLeg(p)}catch{}return W("player"),F(!0),G(0),_.current=0,Q(0),J.current=0,z(0),ee.current=0,!0}try{as.getState().recordVisit("offline-x01",T,f,{preRemaining:p,postRemaining:h,finish:!1,bust:!1})}catch{}try{B.addVisit(f,T)}catch{}return Nt(h),Q(0),J.current=0,G(0),_.current=0,z(0),ee.current=0,!0}const q=bl({match:B,commitManualVisitTotal:I,endTurn:Nt}),[Js,Ua]=a.useState(""),Fa=t=>{Ua(t)},en=()=>{const t=parseInt(Js,10);if(isNaN(t)||t<0||t>180){alert("Enter a number 0-180 for visit total");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=Z.current<=170?170:180,r=pe(Math.round(t),0,s);t>s&&tt(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),I(r)&&Ua("")},Oa=a.useCallback(()=>{Ee.current&&(Ee.current=null,de(),Qt(!1));const t=_.current,s=J.current,r=_e.current;t===0&&s===0||(O(r),Z.current=r,G(0),_.current=0,Q(0),J.current=0,z(0),ee.current=0,Le(0),y(0),Oe(l=>Math.max(0,l-t)),pt(l=>Math.max(0,l-t)),Kt(l=>Math.max(0,l-s)),Ut.current=0)},[de]);a.useEffect(()=>{const t=s=>{const r=s?.detail;!r||r?.source==="offline-play"||Oa()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[Oa]);function _a(t){M("Double Practice");const s=pe(Math.round(t||0),0,60);if(Le(s),Oe(r=>r+1),pt(r=>r+1),ir(s,Et)){const r=fs+1;xs(r),hs(l=>Math.min(20,l+1)),r>=21&&(W("player"),F(!0))}y(0)}function Ka(){_a(Number(D))}function $a(){const t=yt(X);if(t==null){alert("Enter like D16, 50, 25, T20");return}_a(t),Y("")}function Wa(t,s,r){if(Lr)return!1;M("Bob's 27");const l=Ar,d=s==="DOUBLE"&&r===l||!s&&t===l*2;return d&&Ns(b=>b+1),Bn(b=>{const p=b+1;if(p>=3){const j=Mr+(d?1:0);j>0?vs(h=>h+j*l*2):vs(h=>h-l*2);const f=l+1;return Hn(f),Ns(0),f>20&&Vn(!0),0}return p}),!0}function Ga(){Wa(Math.max(0,D|0)),y(0)}function ui(){Hn(1),vs(27),Bn(0),Ns(0),Vn(!1),R("Bob's 27")}function tn(t){return M("Count-Up"),Fn(s=>s+Math.max(0,t|0)),On(s=>{const r=s+1;return r>=3?(Un(l=>l+1),0):r}),!0}function sn(t){return M("High Score"),Kn(s=>s+Math.max(0,t|0)),$n(s=>{const r=s+1;return r>=3?(_n(l=>l+1),0):r}),!0}function nn(t){return M("Low Score"),Gn(s=>s+Math.max(0,t|0)),zn(s=>{const r=s+1;return r>=3?(Wn(l=>l+1),0):r}),!0}function za(t,s,r,l,d,b,p,j){const f=t-p;if(!(f<0))if(f===0){if(j==="DOUBLE"||j==="INNER_BULL"){b(h=>h+1),d(h=>h+1),l(()=>0),s(t);return}s(f)}else s(f);l(h=>{const N=h+1;return N>=3?(d(w=>w+1),0):N})}function Xa(t,s){return M("Checkout 170"),za(Xn,js,Yn,qn,Qn,Zn,t,s),Yn+1>=3&&js(170),!0}function Ya(t,s){return M("Checkout 121"),za(Jn,ys,ea,ta,sa,na,t,s),ea+1>=3&&ys(121),!0}function ss(t){const s=yt(X);if(s==null){alert("Enter like T20, D16, 25, 50");return}const r=X.trim().toUpperCase(),l=r.startsWith("D")||r==="50"||r==="BULL"||r==="DBULL"||r==="IBULL"||r.includes("INNER");t?Xa(s,l?"DOUBLE":void 0):Ya(s,l?"DOUBLE":void 0),Y("")}function mi(){js(170),qn(0),Qn(0),Zn(0),R("Checkout 170")}function hi(){ys(121),ta(0),sa(0),na(0),R("Checkout 121")}function an(t,s,r){return ia?!1:(M("Treble Practice"),(s==="TRIPLE"&&r===Pt||!s&&t===Pt*3)&&ws(d=>d+1),Ss(d=>{const b=d+1;if(b%3===0&&[20,19,18].includes(Pt)){const p=["T20","T19","T18"],j=p.indexOf(`T${Pt}`),f=p[(j+1)%p.length];Or(Number(f.replace("T","")))}return rt>0&&b>=rt&&Cs(!0),b}),!0)}function fi(){ws(0),Ss(0),Cs(!1),R("Treble Practice")}function xi(t,s,r){return M("Baseball"),la(l=>{const d={...l};return el(d,t,s,r),d}),!0}function bi(){la(hr()),R("Baseball")}function pi(t,s,r){return M("Golf"),oa(l=>{const d={...l};return sl(d,t,s,r),d}),!0}function gi(){oa(fr()),R("Golf")}function vi(t,s,r,l){return M("Tic Tac Toe"),ca(d=>{const b={...d,board:[...d.board]};return al(b,t,s,r,l),b}),!0}function Ni(){ca(xr()),R("Tic Tac Toe")}function ji(t,s,r){return M("American Cricket"),da(l=>{const d={...l,marks:{...l.marks}};return xl(d,t,s,r,()=>!1),d}),!0}function yi(){da(vr()),R("American Cricket")}function rn(t,s,r){M("Around the Clock");const l=wt[Rt];let d=!1;if(typeof r=="number"&&r===l&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(d=!0),l===25&&(s==="BULL"||t===25)&&(d=!0),l===50&&(s==="INNER_BULL"||t===50)&&(d=!0),d||(t===l||t===l*2||t===l*3)&&(d=!0),d){const b=En+1;return Rn(b),Tn(p=>p+1),!0}return!0}function qa(){rn(Math.max(0,D|0)),y(0)}function Qa(){const t=yt(X);if(t==null){alert("Enter like T20, D5, 25, 50");return}rn(t),Y("")}function ln(t,s,r){return M("Cricket"),In(l=>{const d={...l,marks:{...l.marks}};return Ki(d,t,s,r,()=>!1),d}),ye(l=>{const d=l+1;return d>=3?0:d}),!0}function Za(){ln(Math.max(0,D|0)),y(0)}function on(t,s,r){return M("Shanghai"),bs(l=>{const d={...l,turnHits:{...l.turnHits}};return Wi(d,t,s,r),d}),ye(l=>{const d=l+1;return d>=3?(bs(b=>{const p={...b,turnHits:{...b.turnHits}};return Gi(p),p}),0):d}),!0}function Ja(){on(Math.max(0,D|0)),y(0)}function er(t,s,r){return M("Halve It"),ps(l=>{const d={...l,targets:[...l.targets]};return Xi(d,t,s,r),d}),ye(l=>{const d=l+1;return d>=3?(ps(b=>{const p={...b,targets:[...b.targets]};return Yi(p),p}),0):d}),!0}function tr(){er(Math.max(0,D|0)),y(0)}function sr(t,s,r){return M("High-Low"),gs(l=>{const d={...l};return qi(d,t,s,r),d}),ye(l=>{const d=l+1;return d>=3?(gs(b=>{const p={...b};return Qi(p),p}),0):d}),!0}function nr(){sr(Math.max(0,D|0)),y(0)}function wi(){const t=Dt??"player",s=t==="player"?Vt||void 0:Vs||void 0,r=1,l=t==="player"?ua:ma;Sn([...fe,{winner:t,doubleDarts:At,checkoutDarts:Mt,winnerDarts:l,doublesAtt:s,doublesHit:r}]),F(!1);let d=me,b=he;if(Dt==="player"?d+=1:Dt==="ai"&&(b+=1),Ct(d),kt(b),W(null),d>=St||b>=St){try{Vi(g,t==="player")}catch{}try{B.endGame()}catch{}Ve(!1),He(!1),O(S),et(S),$s(!0);return}di()}const cn=!rr.includes(g)&&!(n?.fullAccess||n?.admin);return e.jsxs("div",{className:"ndn-game-shell ndn-page relative overflow-hidden md:overflow-hidden overflow-y-auto bg-transparent shadow-none rounded-none",children:[Sr&&e.jsx(Ei,{players:B.players||[],user:n,onDone:()=>Nn(!1)}),!Be&&!Je&&e.jsxs("h2",{className:"text-3xl font-bold text-brand-700 mb-4 ndn-section-title",children:["Offline Mode ï¿½"," ",e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),e.jsxs("div",{className:"ndn-shell-body",children:[!Be&&!Je&&e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:g,onChange:t=>Ze(t.target.value),children:[rr.map(t=>e.jsx("option",{value:t,children:t},t)),Ri.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t," ",n?.fullAccess||n?.admin?"":"(Premium)"]},t))]}),g==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:rt,onChange:t=>_r(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."}),v&&!at&&e.jsx("div",{className:"hidden md:block w-[360px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2",style:{willChange:"transform, opacity"},children:e.jsx(Nr,{scoringMode:"x01",showToolbar:C,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:V(I),onAutoDart:(t,s,r)=>{}})})})]}),!n?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),g==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:S,onChange:t=>le(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:L,onChange:t=>Ae(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),pl.map(t=>e.jsx("option",{value:t,children:t},t))]}),L!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:Cn/1e3,onChange:t=>Cr(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>is(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),g==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!Be&&!Je&&e.jsx("button",{className:"btn",disabled:cn,title:cn?"PREMIUM required for this mode":"",onClick:vt,children:"Start Match ðŸš€"}),Be&&e.jsx("div",{className:`fixed inset-0 z-[1000] bg-slate-950/90 backdrop-blur-sm ${ds?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(Ye,{storageKey:"ndn:modal:offline-match:v2",frameClassName:"relative",frameFullScreenClassName:"relative ndn-modal-full",className:`${ds?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:ds,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex h-full",children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 -ml-2 sm:-ml-3",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{ze.current=t},children:[je!=="modern",cs&&e.jsx("div",{className:"fixed inset-0 z-[170] flex items-center justify-center bg-black/70 p-4",children:e.jsxs(Ye,{storageKey:"ndn:modal:offline-quit-confirm",className:"w-full relative",defaultWidth:460,defaultHeight:320,minWidth:360,minHeight:260,maxWidth:720,maxHeight:520,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Confirm Quit (Both Players)"}),e.jsx("p",{className:"text-sm text-slate-200 mb-4",children:"Both players must accept to end the match. If either player wants to continue, the match will keep going."}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("button",{className:`btn w-full ${st.player?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>Lt(t=>({...t,player:!0})),children:[jt(n,"Player 1")," Accepts"]}),e.jsxs("button",{className:`btn w-full ${st.opponent?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>Lt(t=>({...t,opponent:!0})),children:[L==="None"?"Opponent":`${L} AI`," Accepts"]}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 w-full",onClick:()=>{Lt({player:!1,opponent:!1}),Dn(!1)},children:"Continue Match"})]})]})}),g==="X01"&&Zr&&Xt&&e.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center bg-black/70 p-4",onClick:()=>Ce(!1),children:e.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl",onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key==="Escape")&&(t.preventDefault(),Ce(!1))},tabIndex:-1,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-emerald-200/70",children:"Checkout box"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-100",children:[Xt.remaining," left"]})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Ce(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${At===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>yn(t),children:ke(t)},`double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Mt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>wn(t),children:ke(t)},`checkout-${t}`))})]}),Xt.routes.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-emerald-200/80 mb-1",children:"Suggested checkout"}),e.jsx("div",{className:"space-y-1",children:Xt.routes.map(t=>e.jsx("div",{className:"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold",children:t},t))})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>Ce(!1),children:"Enter"})})]})]})}),e.jsxs("div",{ref:t=>{Xe.current=t},className:"will-change-transform",style:us?{transform:`scale(${Tt})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,Tt))}em`}:void 0,children:[je!=="modern",e.jsxs("div",{className:"space-y-3 mb-2",children:[e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0 space-y-2.5",children:g==="X01"&&e.jsx(Ui,{inProgress:!0,startingScore:S,onAddVisit:V(I),onNextPlayer:()=>q?.nextPlayer(),onEndLeg:()=>{},onUndo:()=>{},showDartsSelect:!1,showCheckoutSelectors:!1,showActionButtons:!1,showQuickButtons:!1,showUndo:!1,showVisitInputRow:!1,showHelperText:!1,showNumberPadLabel:!1})}),e.jsxs("div",{className:"flex flex-col gap-3 md:w-[340px] md:flex-shrink-0",children:[e.jsx(Re,{gameMode:g,players:Ea,matchScore:`${me}-${he}`}),e.jsx("div",{className:"hidden md:block rounded-2xl overflow-hidden bg-black border border-white/10",children:v?e.jsx(A,{scoringMode:g==="X01"?"x01":"custom",showToolbar:!1,minimalControls:!0,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:V(I),onAutoDart:()=>{}}):e.jsx("div",{className:"p-4 text-sm text-slate-200 text-center",children:"Camera disabled"})})]})]}),at&&v&&!Ln&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 md:hidden",children:[e.jsx("button",{className:"btn rounded-full border border-white/20 bg-white/10 px-4 py-2 text-sm text-white",onClick:()=>ms(!0),children:"Camera"}),e.jsx("span",{className:"text-xs text-white/60",children:"Tap to open the camera tab"})]})]})}),at&&v&&Ln&&e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-start justify-center px-3 pt-6 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80"}),e.jsx("div",{className:"relative z-10 w-full max-w-[420px]",children:e.jsxs("div",{className:"relative h-[75vh] rounded-[28px] overflow-hidden bg-black shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(A,{scoringMode:"x01",showToolbar:!1,minimalControls:!0,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:V(I),onAutoDart:(t,s,r)=>{}})}),e.jsx("button",{className:"absolute top-3 right-3 rounded-full bg-black/60 p-2 text-white",onClick:()=>ms(!1),"aria-label":"Close camera tab",children:"âœ•"}),null]})})]})]}),g!=="X01"?e.jsxs("div",{className:"space-y-2",children:[g==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:un[Et]?.label||"â€”"})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&ir(t,Et)){const l=fs+1,d=Et+1;return xs(l),hs(d),l>=un.length&&setTimeout(()=>{xs(0),hs(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ka()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ka,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:X,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&$a()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$a,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",fs," of 21"]})]}),g==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:wt[Rt]===25?"25 (Outer Bull)":wt[Rt]===50?"50 (Inner Bull)":wt[Rt]||"â€”"})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>rn(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&qa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:qa,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:X,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Qa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Qa,children:"Add"})]}),En>=wt.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Rn(0),Tn(0),R("Around the Clock")},children:"Reset"})]})]}),g==="Cricket"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>ln(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Za()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Za,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{In(lr()),ye(0),R("Cricket")},children:"Reset"})]})]}),g==="Shanghai"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>on(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ja()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ja,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{bs(or()),ye(0),R("Shanghai")},children:"Reset"})]})]}),g==="Halve It"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>er(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&tr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:tr,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ps(cr()),ye(0),R("Halve It")},children:"Reset"})]})]}),g==="High-Low"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>sr(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&nr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:nr,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{gs(dr()),ye(0),R("High-Low")},children:"Reset"})]})]}),g==="Bob's 27"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>Wa(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ga()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ga,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:ui,children:"Reset"})]})]}),g==="Count-Up"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:t=>tn(t),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(tn(D),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{tn(D),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Un(1),Fn(0),On(0),R("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Tr,"/",Er]})]}),g==="High Score"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:t=>sn(t),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(sn(D),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{sn(D),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{_n(1),Kn(0),$n(0),R("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Rr,"/",Pr]})]}),g==="Low Score"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:t=>nn(t),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(nn(D),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{nn(D),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Wn(1),Gn(0),zn(0),R("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Ir,"/",Hr]})]}),g==="Checkout 170"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s)=>Xa(t,s==="MISS"?void 0:s),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:X,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ss(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>ss(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:mi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Xn," Â· Attempts: ",Br," ","Â· Successes: ",Vr]})]}),g==="Checkout 121"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s)=>Ya(t,s==="MISS"?void 0:s),onAddVisit:V(I),onEndLeg:t=>q.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:X,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ss(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>ss(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:hi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Jn," Â· Attempts: ",Ur," ","Â· Successes: ",Fr]})]}),g==="Treble Practice"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>an(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:X,onChange:t=>Y(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=yt(X);s!=null&&an(s,void 0,void 0),Y("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=yt(X);t!=null&&an(t,void 0,void 0),Y("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",aa," Â· Misses:"," ",Math.max(0,ra-aa)," Â· Darts:"," ",ra,rt>0?`/${rt}`:""]}),ia&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:fi,children:"Reset"})]})]}),g==="Baseball"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>xi(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:bi,children:"Reset"})})]}),g==="Golf"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>pi(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:gi,children:"Reset"})})]}),g==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${It.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(It.finished||It.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),r=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",l=t,d=jr[l],b=d.type==="BULL"?null:d.num||null;vi(l,s,r,b)},children:It.board[t]||""},t))}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ni,children:"Reset"})})]}),g==="American Cricket"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>ji(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:yi,children:"Reset"})})]}),g==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:rl[Me.targetIndex]})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{const l=s==="MISS"?void 0:s;return M("Scam"),ct(hn(Me,t,l)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(M("Scam"),ct(br(Me,D)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{M("Scam"),ct(br(Me,D)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ct(ll()),R("Scam")},children:"Reset"})]}),Me.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",Me.darts," darts!"]})]}),g==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[ae.score,"/",ae.target]})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>(M("Fives"),dt(xn(ae,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(M("Fives"),dt(pr(ae,D)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{M("Fives"),dt(pr(ae,D)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{dt(dl(ae.target)),R("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",ae.darts]}),ae.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",ae.target," in"," ",ae.darts," darts!"]})]}),g==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[re.score,"/",re.target]})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>(M("Sevens"),ut(pn(re,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:D,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(M("Sevens"),ut(gr(re,D)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{M("Sevens"),ut(gr(re,D)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ut(hl(re.target)),R("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",re.darts]}),re.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",re.target," in"," ",re.darts," darts!"]})]}),g==="Killer"&&e.jsx(e.Fragment,{children:Kr?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:E.map(t=>{const s=it[t.id],r=Ht[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number:"," ",e.jsx("span",{className:"font-semibold",children:r})]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsx("span",{className:"font-semibold",children:s?.lives??0})]})]},t.id)})}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(Bt)return!1;const l=s==="MISS"?void 0:s,d=r?.sector??null,b=E[xe];return b?(lt(p=>{const j={};Object.keys(p).forEach(N=>j[N]={...p[N]});const f=ur(b.id,j,l,d);if(f.becameKiller)be(`${b.name} became a Killer`);else if(f.victimId){const N=E.find(w=>w.id===f.victimId);be(`${b.name} hit ${N?.name}'s ${Ht[f.victimId]} (${f.livesRemoved} life${(f.livesRemoved||0)>1?"s":""})`)}else be("No effect");const h=mr(j);return h&&ot(h),j}),Fe(p=>{const j=p+1;if(j>=3){let f=xe;for(let h=1;h<=E.length;h++){const N=(xe+h)%E.length,w=E[N].id,T=it[w];if(T&&!T.eliminated&&T.lives>0){f=N;break}}return Ue(f),0}return j}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:X,onChange:t=>Y(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(Bt)return;const r=X.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!r){Y("");return}const l=r[1]||"S",d=parseInt(r[2],10),b=l==="D"?"DOUBLE":l==="T"?"TRIPLE":"SINGLE",p=E[xe];lt(j=>{const f={};Object.keys(j).forEach(w=>f[w]={...j[w]});const h=ur(p.id,f,b,d);if(h.becameKiller)be(`${p.name} became a Killer`);else if(h.victimId){const w=E.find(T=>T.id===h.victimId);be(`${p.name} hit ${w?.name}'s ${Ht[h.victimId]} (${h.livesRemoved} life${(h.livesRemoved||0)>1?"s":""})`)}else be("No effect");const N=mr(f);return N&&ot(N),f}),Y(""),Fe(j=>{const f=j+1;if(f>=3){let h=xe;for(let N=1;N<=E.length;N++){const w=(xe+N)%E.length,T=E[w].id,k=it[T];if(k&&!k.eliminated&&k.lives>0){h=w;break}}return Ue(h),0}return f})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=xe;for(let s=1;s<=E.length;s++){const r=(xe+s)%E.length,l=E[r].id,d=it[l];if(d&&!d.eliminated&&d.lives>0){t=r;break}}Ue(t),Fe(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{lt({}),Ds({}),As(!1),Ue(0),Fe(0),ot(null),be("")},children:"Reset"})]}),Bt&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",E.find(t=>t.id===Bt)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{lt({}),Ds({}),As(!1),Ue(0),Fe(0),ot(null),be("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:E.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:r=>{const l=r.target.value;ks(d=>d.map((b,p)=>p===s?{...b,name:l}:b))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>ks(r=>r.filter((l,d)=>d!==s)),disabled:E.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>ks(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(E.length<2){alert("Need at least 2 players");return}const t=E.map(l=>l.id),s=Ji(t),r={};t.forEach(l=>{r[l]=Zi(s[l])}),Ds(s),lt(r),Ue(0),Fe(0),ot(null),be("Assigned numbers"),As(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-2",children:"Visit total"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:oe<=170?170:180,placeholder:"0â€“180",value:Js,onChange:t=>Fa(t.target.value),onKeyDown:t=>{t.key==="Enter"&&en()}}),e.jsx("button",{className:"btn px-4 py-1 text-sm",onClick:en,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Fi,{value:Js,onChange:Fa,onSubmit:en,helperText:"Tap numbers then Enter to commit the visit total."})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Current score"}),e.jsx("div",{className:"text-lg font-bold text-white",children:ai})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"3-dart avg"}),e.jsx("div",{className:"text-lg font-bold text-emerald-300",children:ii.toFixed(1)})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(Re,{gameMode:g,players:Ea,matchScore:ni})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!v&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),v?e.jsx("div",{className:"bg-black aspect-video max-h-[420px]",children:e.jsx(Nr,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:()=>!1})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Tap numbers then Enter to commit a 3-dart visit."})]}),e.jsx("div",{className:"flex flex-col gap-3 min-h-0 flex-1 text-[14px]",children:e.jsx("div",{className:"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"}})}),g==="Cricket"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return ln(t,s==="MISS"?void 0:s,r?.sector??null),!0}})}),g==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(Re,{gameMode:"Shanghai",players:Gs})}),g==="Shanghai"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return on(t,s==="MISS"?void 0:s,r?.sector??null),!0}})}),g==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(Re,{gameMode:"Killer",players:zs})}),g==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(Re,{gameMode:"Scam",players:Xs})}),g==="Scam"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return ct(hn(Me,t,s)),!0}})}),g==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(Re,{gameMode:"Fives",players:Ys})}),g==="Fives"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return dt(xn(ae,t)),!0}})}),g==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(Re,{gameMode:"Sevens",players:qs})}),g==="Sevens"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(A,{scoringMode:"custom",showToolbar:C,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return ut(pn(re,t)),!0}})})]}),e.jsx("div",{className:"h-1"})]})]})})})}),gn&&e.jsx(Nl,{onClose:()=>is(!1)}),cn&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${jl}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&tt("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?tt("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):tt("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{tt("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",Pi(Ii(),5)]})]})]}),ei&&typeof document<"u"?ar.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>$e(!1),children:e.jsx(Ye,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>$e(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>$e(!1),children:"Close"})]}),e.jsx(Bi,{fill:!0,user:n,playerScore:oe,aiScore:P,x01Score:S,inMatch:Je,showWinPopup:os,pendingLegWinner:Dt,playerDartsThrown:ua,aiDartsThrown:ma,totalPlayerDarts:Us,totalAiDarts:Fs,totalPlayerPoints:ga,totalAiPoints:va,player180s:ja,player140s:Gr,player100s:zr,ai180s:ya,ai140s:Xr,ai100s:Yr,playerHighestCheckout:qr,aiHighestCheckout:Qr,onClose:()=>$e(!1),onOpen:()=>$e(!0),layout:je})]})})}),document.body):null,qt&&typeof document<"u"?ar.createPortal((()=>{const{target:t,value:s,stage:r}=qt,l=t==="player"?Ge:Zt,d=t==="player"?me:he;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:gt,children:e.jsx(Ye,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:gt,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",r," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:r===1?e.jsxs(e.Fragment,{children:["Set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:d})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:gt,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:li,children:"Yes"})]})]})})})})(),document.body):null,os&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]",children:e.jsxs(Ye,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:Oi(B.players?.[B.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${At===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>yn(t),children:ke(t)},`win-double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Mt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>wn(t),children:ke(t)},`win-checkout-${t}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:wi,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{F(!1),vt()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{F(!1),Ve(!1),He(!1)},children:"Back to Menu"})]})]})}),Jr&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(Ye,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[g," Â· ",S," start Â· First to ",St]}),(()=>{const t=Us>0?ga/Us*3:0,s=(()=>{const f=fe.filter(h=>h.winner==="player"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),r=(()=>{const f=fe.filter(h=>h.winner==="player"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),l=Ft>0?Math.round(ha/Ft*100):0,d=Fs>0?va/Fs*3:0,b=(()=>{const f=fe.filter(h=>h.winner==="ai"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),p=(()=>{const f=fe.filter(h=>h.winner==="ai"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),j=_t>0?Math.round(xa/_t*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:jt(n,"You")}),e.jsx("div",{className:"text-3xl font-extrabold",children:me}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:Ft})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[l,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:s})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:r})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ja})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[me," â€“ ",he]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:L==="None"?"Opponent":`${L} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:he}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:d.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:_t})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[j,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:b})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ya})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:fe.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":L==="None"?"Opp":"AI"," ","Â· Dbl ",ke(t.doubleDarts)," Â· CO"," ",ke(t.checkoutDarts||0)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>$s(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{$s(!1),vt()},children:"Rematch"})]})]})}),fe.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:fe.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",ke(t.doubleDarts),", Checkout darts: ",ke(t.checkoutDarts||0)]},s))})]})]})]})}export{co as default};
//# sourceMappingURL=OfflinePlay-DfB9Iw7j.js.map
