{"version":3,"file":"Tournaments-CxgFWA_o.js","sources":["../../src/components/MatchCard.tsx","../../src/components/Tournaments.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { labelForMode, type ModeKey } from \"../utils/games\";\r\n\r\ntype Tournament = {\r\n  id: string;\r\n  title: string;\r\n  game: string;\r\n  mode: ModeKey;\r\n  value: number;\r\n  startAt: number;\r\n  capacity: number;\r\n  participants: { email: string; username: string }[];\r\n  creatorName?: string;\r\n  creatorEmail?: string;\r\n  official?: boolean;\r\n};\r\n\r\nexport default function MatchCard({\r\n  t,\r\n  onJoin,\r\n  onLeave,\r\n  joined,\r\n  disabled,\r\n}: {\r\n  t: Tournament;\r\n  onJoin?: (t: any) => void;\r\n  onLeave?: (t: any) => void;\r\n  joined?: boolean;\r\n  disabled?: boolean;\r\n}) {\r\n  return (\r\n    <li className=\"p-3 rounded bg-black/10 flex items-center justify-between relative\">\r\n      <div className=\"space-y-0.5\">\r\n        <div className=\"font-semibold\">\r\n          {t.title}\r\n          {t.official && (\r\n            <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-amber-500 text-black text-xs\">\r\n              Official\r\n            </span>\r\n          )}\r\n        </div>\r\n        <div className=\"text-sm opacity-80\">\r\n          {t.game}\r\n          {t.game === \"X01\" ? `/501` : \"\"} · {labelForMode(t.mode)} {t.value} ·{\" \"}\r\n          {new Date(t.startAt).toLocaleString()} · Cap {t.capacity} · Joined{\" \"}\r\n          {t.participants?.length || 0}\r\n        </div>\r\n        <div className=\"text-xs opacity-60 mt-1\">\r\n          Created by: {t.creatorName || t.creatorEmail || \"Unknown\"}\r\n        </div>\r\n      </div>\r\n      <div className=\"flex items-center gap-2\">\r\n        <button\r\n          className={`btn ${joined ? \"bg-emerald-600 hover:bg-emerald-600\" : \"\"}`}\r\n          disabled={disabled}\r\n          onClick={() => (joined ? onLeave && onLeave(t) : onJoin && onJoin(t))}\r\n        >\r\n          {joined ? \"Already Joined\" : \"Join Now\"}\r\n        </button>\r\n      </div>\r\n    </li>\r\n  );\r\n}\r\n","import { useEffect, useMemo, useState, useRef } from \"react\";\r\nimport {\r\n  getModeOptionsForGame,\r\n  getModeValueOptionsForGame,\r\n  labelForMode,\r\n  type ModeKey,\r\n} from \"../utils/games\";\r\nimport { useMatch } from \"../store/match\";\r\nimport MatchCard from \"./MatchCard\";\r\nimport MatchStartShowcase from \"./ui/MatchStartShowcase\";\r\nimport ResizableModal from \"./ui/ResizableModal\";\r\nimport { useToast } from \"../store/toast\";\r\nimport { useWS } from \"./WSProvider\";\r\nimport { apiFetch } from \"../utils/api\";\r\nimport { useUserSettings } from \"../store/userSettings\";\r\n\r\ntype Tournament = {\r\n  id: string;\r\n  title: string;\r\n  game: string;\r\n  mode: ModeKey;\r\n  value: number;\r\n  description: string;\r\n  startAt: number;\r\n  checkinMinutes: number;\r\n  capacity: number;\r\n  participants: { email: string; username: string }[];\r\n  official?: boolean;\r\n  prize?: boolean;\r\n  prizeType?: \"premium\" | \"cash\" | \"none\";\r\n  prizeAmount?: number;\r\n  currency?: string;\r\n  payoutStatus?: \"none\" | \"pending\" | \"paid\";\r\n  status: \"scheduled\" | \"running\" | \"completed\";\r\n  winnerEmail?: string | null;\r\n  startingScore?: number;\r\n  creatorEmail?: string;\r\n  creatorName?: string;\r\n};\r\n\r\nexport default function Tournaments({ user }: { user: any }) {\r\n  const toast = useToast();\r\n  const wsGlobal = (() => {\r\n    try {\r\n      return useWS();\r\n    } catch {\r\n      return null;\r\n    }\r\n  })();\r\n  // Persisted match preferences (used when creating or joining)\r\n  const {\r\n    matchType = \"singles\",\r\n    setMatchType,\r\n    teamAName = \"Team A\",\r\n    setTeamAName,\r\n    teamBName = \"Team B\",\r\n    setTeamBName,\r\n  } = useUserSettings();\r\n  const [list, setList] = useState<Tournament[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n  const [fetchError, setFetchError] = useState<string | null>(null);\r\n  const [lastRefresh, setLastRefresh] = useState<number | null>(null);\r\n  const [cooldownUntil, setCooldownUntil] = useState<number | null>(null);\r\n  const [showCreate, setShowCreate] = useState(false);\r\n  const [showDemoStart, setShowDemoStart] = useState(false);\r\n  const [showStartShowcase, setShowStartShowcase] = useState(false);\r\n  const startedShowcasedRef = useRef(false);\r\n  const match = useMatch();\r\n  const endSummaryPrevRef = useRef(!!useMatch.getState().inProgress);\r\n  useEffect(() => {\r\n    const prev = endSummaryPrevRef.current;\r\n    const now = !!match.inProgress;\r\n    // Reset the showcased flag when match ends\r\n    if (!now) startedShowcasedRef.current = false;\r\n    // When match starts, show the start showcase once\r\n    if (now && !startedShowcasedRef.current) {\r\n      startedShowcasedRef.current = true;\r\n      setShowStartShowcase(true);\r\n    }\r\n    endSummaryPrevRef.current = now;\r\n  }, [match.inProgress, match.players]);\r\n  const [leaveAsk, setLeaveAsk] = useState<{\r\n    open: boolean;\r\n    t: Tournament | null;\r\n  }>({ open: false, t: null });\r\n  const [deleteConfirm, setDeleteConfirm] = useState<{\r\n    open: boolean;\r\n    t: Tournament | null;\r\n  }>({ open: false, t: null });\r\n  const [form, setForm] = useState({\r\n    title: \"Community X01 Tournament\",\r\n    game: \"X01\",\r\n    mode: \"bestof\" as ModeKey,\r\n    value: 3,\r\n    description: \"\",\r\n    startAt: new Date(Date.now() + 2 * 60 * 60 * 1000)\r\n      .toISOString()\r\n      .slice(0, 16), // local yyyy-mm-ddThh:mm\r\n    checkinMinutes: 15,\r\n    capacity: 8,\r\n    startingScore: 501,\r\n    requireCalibration: false,\r\n  });\r\n  const isTouch = (() => {\r\n    try {\r\n      return \"ontouchstart\" in window || (navigator.maxTouchPoints || 0) > 0;\r\n    } catch {\r\n      return false;\r\n    }\r\n  })();\r\n\r\n  async function refresh() {\r\n    try {\r\n      // Avoid multiple quick refreshes which can cause load spikes\r\n      if (lastRefresh && Date.now() - lastRefresh < 3000) return;\r\n      const res = await apiFetch(\"/api/tournaments\");\r\n      const data = await res.json();\r\n      const newList = Array.isArray(data.tournaments) ? data.tournaments : [];\r\n      setList(newList);\r\n      try {\r\n        console.debug(\r\n          \"[Tournaments] refresh fetched\",\r\n          newList.length,\r\n          \"tournaments\",\r\n        );\r\n        console.log(\"[Tournaments] fetched list:\", newList);\r\n      } catch {}\r\n      setFetchError(null);\r\n      setLastRefresh(Date.now());\r\n    } catch (err: any) {\r\n      try {\r\n        setFetchError(String(err?.message || err));\r\n      } catch {\r\n        setFetchError(\"unknown\");\r\n      }\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    refresh();\r\n  }, []);\r\n\r\n  // Re-fetch tournaments when we have a fresh WS connection so clients resync after reconnects/server restarts\r\n  useEffect(() => {\r\n    try {\r\n      if (wsGlobal?.connected) refresh();\r\n    } catch {}\r\n  }, [wsGlobal?.connected]);\r\n\r\n  // Listen for WS push updates from global provider if available\r\n  useEffect(() => {\r\n    if (!wsGlobal) return;\r\n    const unsub = wsGlobal.addListener((msg) => {\r\n      try {\r\n        if (msg.type === \"tournaments\") {\r\n          setList(msg.tournaments || []);\r\n          setLastRefresh(Date.now());\r\n        }\r\n        if (msg.type === \"tournaments\") {\r\n          try {\r\n            console.debug(\r\n              \"[Tournaments] WS tournaments update, num=\",\r\n              (msg.tournaments || []).length,\r\n            );\r\n          } catch {}\r\n        }\r\n        if (msg.type === \"tournament-win\" && msg.message) {\r\n          toast(msg.message, { type: \"success\", timeout: 10000 }); // Show for 10 seconds\r\n        }\r\n        // tournament-reminder handled optionally here if desired\r\n      } catch {}\r\n    });\r\n    return () => {\r\n      unsub();\r\n    };\r\n  }, [wsGlobal?.connected]);\r\n\r\n  // If WS connects, ask for a fresh list via WS; this will prompt server to send a tournaments snapshot.\r\n  useEffect(() => {\r\n    try {\r\n      if (wsGlobal?.connected) {\r\n        try {\r\n          wsGlobal.send({ type: \"list-tournaments\" });\r\n        } catch {}\r\n        // Also ensure we refresh as a fallback\r\n        refresh();\r\n      }\r\n    } catch {}\r\n  }, [wsGlobal?.connected]);\r\n\r\n  // Polling fallback: if WS is unavailable, poll the API every 10s to keep lobby up-to-date\r\n  useEffect(() => {\r\n    let iv: number | null = null;\r\n    try {\r\n      if (!wsGlobal || !wsGlobal.connected) {\r\n        iv = window.setInterval(() => {\r\n          refresh();\r\n        }, 10000);\r\n      }\r\n    } catch {}\r\n    return () => {\r\n      if (iv) clearInterval(iv);\r\n    };\r\n  }, [wsGlobal?.connected]);\r\n\r\n  const email = String(user?.email || \"\").toLowerCase();\r\n\r\n  // Simple, persistent match preference UI\r\n  const MatchPrefs = () => (\r\n    <div className=\"mb-3 p-2 rounded-lg bg-slate-900/40 border border-white/10 text-white text-xs flex items-center gap-2 flex-wrap\">\r\n      <span className=\"opacity-70\">Default match</span>\r\n      <span className=\"btn py-1 px-2 bg-indigo-500/30 border border-indigo-400/50 text-indigo-100\">\r\n        Singles\r\n      </span>\r\n      <span className=\"text-xs opacity-60 ml-2\">\r\n        (tournaments use Singles only)\r\n      </span>\r\n    </div>\r\n  );\r\n  // Fetch subscription to detect if user is a recent tournament winner (cooldown)\r\n  useEffect(() => {\r\n    let abort = false;\r\n    async function check() {\r\n      if (!email) {\r\n        setCooldownUntil(null);\r\n        return;\r\n      }\r\n      try {\r\n        const res = await apiFetch(\r\n          `/api/subscription?email=${encodeURIComponent(email)}`,\r\n        );\r\n        const data = await res.json();\r\n        if (!abort) {\r\n          if (\r\n            data?.source === \"tournament\" &&\r\n            typeof data.expiresAt === \"number\" &&\r\n            data.expiresAt > Date.now()\r\n          ) {\r\n            setCooldownUntil(data.expiresAt);\r\n          } else {\r\n            setCooldownUntil(null);\r\n          }\r\n        }\r\n      } catch {\r\n        if (!abort) setCooldownUntil(null);\r\n      }\r\n    }\r\n    check();\r\n    return () => {\r\n      abort = true;\r\n    };\r\n  }, [email]);\r\n  function hasJoined(t: Tournament) {\r\n    return !!t.participants?.some((p) => p.email === email);\r\n  }\r\n\r\n  // Helper to delete a tournament with proper error handling and owner fallback\r\n  async function deleteTournament(t: Tournament) {\r\n    if (!email) return;\r\n    setDeleteConfirm({ open: true, t });\r\n  }\r\n\r\n  async function confirmDeleteTournament() {\r\n    const t = deleteConfirm.t;\r\n    if (!t || !email) return;\r\n    setDeleteConfirm({ open: false, t: null });\r\n    setLoading(true);\r\n    try {\r\n      // First try creator/owner shared endpoint\r\n      let res = await apiFetch(\"/api/tournaments/delete\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ tournamentId: t.id, requesterEmail: email }),\r\n      });\r\n\r\n      // If forbidden but user is the owner, try the admin endpoint as a fallback\r\n      if (\r\n        !res.ok &&\r\n        res.status === 403 &&\r\n        String(email) === \"daviesfamily108@gmail.com\"\r\n      ) {\r\n        res = await apiFetch(\"/api/admin/tournaments/delete\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify({ tournamentId: t.id, requesterEmail: email }),\r\n        });\r\n      }\r\n\r\n      if (!res.ok) {\r\n        let msg = \"Delete failed\";\r\n        try {\r\n          const data = await res.json();\r\n          if (data?.error) msg = `Delete failed: ${String(data.error)}`;\r\n        } catch {}\r\n        toast(msg, { type: \"error\" });\r\n        return;\r\n      }\r\n\r\n      toast(\"Tournament deleted\", { type: \"success\" });\r\n      await refresh();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function join(t: Tournament) {\r\n    if (!email) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await apiFetch(\"/api/tournaments/join\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          tournamentId: t.id,\r\n          email,\r\n          username: user?.username,\r\n        }),\r\n      });\r\n      if (!res.ok) {\r\n        let data: any = {};\r\n        try {\r\n          data = await res.json();\r\n        } catch {}\r\n        if (\r\n          data?.error === \"WINNER_COOLDOWN\" &&\r\n          typeof data.until === \"number\"\r\n        ) {\r\n          setErrorMsg(\r\n            `You're a recent NDN tournament winner. You can re-enter after ${fmt(data.until)}.`,\r\n          );\r\n          setTimeout(() => setErrorMsg(\"\"), 6000);\r\n          toast(\"Join blocked: winner cooldown active\", { type: \"error\" });\r\n        } else if (data?.error === \"ALREADY_IN_TOURNAMENT\") {\r\n          setErrorMsg(\r\n            String(\r\n              data.message || \"You can only join one tournament at a time.\",\r\n            ),\r\n          );\r\n          setTimeout(() => setErrorMsg(\"\"), 6000);\r\n          toast(\"Join blocked: already in another tournament\", {\r\n            type: \"error\",\r\n          });\r\n        } else if (data?.error) {\r\n          setErrorMsg(String(data.error));\r\n          setTimeout(() => setErrorMsg(\"\"), 3500);\r\n          toast(`Join failed: ${String(data.error)}`, { type: \"error\" });\r\n        }\r\n        return;\r\n      }\r\n      toast(\"Joined tournament\", { type: \"success\" });\r\n      await refresh();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function leave(t: Tournament) {\r\n    if (!email) return;\r\n    setLoading(true);\r\n    try {\r\n      const res = await apiFetch(\"/api/tournaments/leave\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ tournamentId: t.id, email }),\r\n      });\r\n      if (!res.ok) {\r\n        let data: any = {};\r\n        try {\r\n          data = await res.json();\r\n        } catch {}\r\n        if (data?.error) {\r\n          toast(`Leave failed: ${String(data.error)}`, { type: \"error\" });\r\n        } else if (res.status === 404) {\r\n          toast(\r\n            \"Leave failed (endpoint not found). Restart the server to enable /api/tournaments/leave.\",\r\n            { type: \"error\" },\r\n          );\r\n        } else {\r\n          toast(\"Leave failed. Please try again.\", { type: \"error\" });\r\n        }\r\n        return;\r\n      }\r\n      toast(\"Left tournament\", { type: \"success\" });\r\n      // Optimistic local update\r\n      setList((prev) =>\r\n        prev.map((it) =>\r\n          it.id === t.id\r\n            ? {\r\n                ...it,\r\n                participants: (it.participants || []).filter(\r\n                  (p) => p.email !== email,\r\n                ),\r\n              }\r\n            : it,\r\n        ),\r\n      );\r\n      await refresh();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function createTournament() {\r\n    setLoading(true);\r\n    try {\r\n      const start = new Date(form.startAt).getTime();\r\n      const res = await apiFetch(\"/api/tournaments/create\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          title: form.title,\r\n          game: form.game,\r\n          mode: form.mode,\r\n          value: Number(form.value),\r\n          description: form.description,\r\n          startAt: start,\r\n          checkinMinutes: Number(form.checkinMinutes),\r\n          capacity: Number(form.capacity),\r\n          startingScore:\r\n            form.game === \"X01\" ? Number(form.startingScore || 501) : undefined,\r\n          requireCalibration: !!form.requireCalibration,\r\n          creatorEmail: user?.email,\r\n          creatorName: user?.username,\r\n        }),\r\n      });\r\n      if (!res.ok) {\r\n        let details = \"\";\r\n        try {\r\n          const data = await res.json();\r\n          if (data?.error) details = String(data.error);\r\n          else if (data?.details) details = String(data.details);\r\n        } catch {}\r\n        const msg = details\r\n          ? `Create failed: ${details}`\r\n          : \"Create failed. Please try again.\";\r\n        setErrorMsg(msg);\r\n        toast(msg, { type: \"error\" });\r\n        setTimeout(() => setErrorMsg(\"\"), 6000);\r\n        return;\r\n      }\r\n      try {\r\n        const data = await res.json();\r\n        if (!data?.ok) {\r\n          const msg = data?.error\r\n            ? `Create failed: ${String(data.error)}`\r\n            : \"Create failed. Please try again.\";\r\n          setErrorMsg(msg);\r\n          toast(msg, { type: \"error\" });\r\n          setTimeout(() => setErrorMsg(\"\"), 6000);\r\n          return;\r\n        }\r\n      } catch {}\r\n      setShowCreate(false);\r\n      toast(\"Tournament created\", { type: \"success\" });\r\n      await refresh();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  // Close the create modal on Escape\r\n  useEffect(() => {\r\n    if (!showCreate) return;\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") setShowCreate(false);\r\n    };\r\n    document.addEventListener(\"keydown\", onKey);\r\n    return () => document.removeEventListener(\"keydown\", onKey);\r\n  }, [showCreate]);\r\n\r\n  const official = useMemo(() => list.filter((t) => t.official), [list]);\r\n  const community = useMemo(() => list.filter((t) => !t.official), [list]);\r\n  const created = useMemo(\r\n    () => list.filter((t) => t.status === \"scheduled\" && !t.official),\r\n    [list],\r\n  );\r\n  const nextOfficial = useMemo(() => {\r\n    const upcoming = official\r\n      .filter((t) => t.status === \"scheduled\")\r\n      .sort((a, b) => a.startAt - b.startAt);\r\n    return upcoming[0] || null;\r\n  }, [official]);\r\n\r\n  function fmt(ts: number) {\r\n    const d = new Date(ts);\r\n    return d.toLocaleString();\r\n  }\r\n\r\n  return (\r\n    <div className=\"card ndn-game-shell\">\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <h2 className=\"text-2xl font-bold\">Tournaments</h2>\r\n      </div>\r\n      <div className=\"ndn-shell-body\">\r\n        {/* Create Tournament + and default match prefs on a single header row */}\r\n        <div className=\"mb-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-between gap-2 flex-wrap\">\r\n          <div className=\"min-w-0\">\r\n            <MatchPrefs />\r\n          </div>\r\n          <div className=\"shrink-0\">\r\n            <button className=\"btn\" onClick={() => setShowCreate(true)}>\r\n              Create Tournament +\r\n            </button>\r\n            {((import.meta as any).env?.DEV ||\r\n              email === \"daviesfamily108@gmail.com\") && (\r\n              <button\r\n                className=\"btn btn-ghost ml-2\"\r\n                onClick={() => setShowDemoStart(true)}\r\n              >\r\n                Demo Start Showcase\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n        {/* DEV-only start showcase demo */}\r\n        {showDemoStart && (\r\n          <MatchStartShowcase\r\n            players={[\r\n              { id: \"0\", name: \"Demo A\", legsWon: 0, legs: [] },\r\n              { id: \"1\", name: \"Demo B\", legsWon: 0, legs: [] },\r\n            ]}\r\n            onDone={() => setShowDemoStart(false)}\r\n          />\r\n        )}\r\n        {/* Show overlay when a tournament match starts while on the tournaments page */}\r\n        {showStartShowcase && (\r\n          <MatchStartShowcase\r\n            players={(match.players || []) as any}\r\n            onDone={() => setShowStartShowcase(false)}\r\n          />\r\n        )}\r\n        <div className=\"mb-2 text-sm font-semibold text-slate-300\">\r\n          World Lobby\r\n        </div>\r\n        {/* Created Game Lobby: show all created tournaments (scheduled) */}\r\n        <div className=\"mb-3 p-3 rounded-xl border border-slate-700 bg-black/10\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <div className=\"font-semibold\">Created Game Lobby</div>\r\n            <div className=\"text-xs opacity-60\">\r\n              All tournaments created by users and admins\r\n            </div>\r\n          </div>\r\n          <ul className=\"space-y-2\">\r\n            {created.length === 0 && (\r\n              <li className=\"text-sm opacity-60\">\r\n                No created tournaments yet.\r\n              </li>\r\n            )}\r\n            {created.map((t) => (\r\n              <MatchCard\r\n                key={t.id}\r\n                t={t}\r\n                onJoin={(m) => join(m)}\r\n                onLeave={(m) => leave(m)}\r\n                joined={hasJoined(t)}\r\n                disabled={\r\n                  loading ||\r\n                  t.status !== \"scheduled\" ||\r\n                  (!hasJoined(t) && t.participants.length >= t.capacity)\r\n                }\r\n              />\r\n            ))}\r\n          </ul>\r\n        </div>\r\n        {/* Persistent banner for next official weekly tournament */}\r\n        {nextOfficial && (\r\n          <div className=\"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10\">\r\n            <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-2\">\r\n              <div>\r\n                <div className=\"text-sm uppercase tracking-wide text-indigo-300 font-semibold\">\r\n                  Weekly Official Tournament\r\n                </div>\r\n                <div className=\"font-bold\">{nextOfficial.title}</div>\r\n                <div className=\"text-sm opacity-80\">\r\n                  {nextOfficial.game}\r\n                  {nextOfficial.game === \"X01\" && nextOfficial.startingScore\r\n                    ? `/${nextOfficial.startingScore}`\r\n                    : \"\"}{\" \"}\r\n                  · {labelForMode(nextOfficial.mode)} {nextOfficial.value} ·\r\n                  Starts {fmt(nextOfficial.startAt)} · Cap{\" \"}\r\n                  {nextOfficial.capacity} · Joined{\" \"}\r\n                  {nextOfficial.participants.length}\r\n                </div>\r\n                {nextOfficial.prize && (\r\n                  <div className=\"text-xs mt-1\">\r\n                    Prize:{\" \"}\r\n                    {nextOfficial.prizeType === \"cash\" &&\r\n                    nextOfficial.prizeAmount\r\n                      ? `${nextOfficial.currency || \"USD\"} ${nextOfficial.prizeAmount}`\r\n                      : \"3 months PREMIUM\"}\r\n                  </div>\r\n                )}\r\n                {nextOfficial.status !== \"scheduled\" && (\r\n                  <div className=\"text-xs\">Status: {nextOfficial.status}</div>\r\n                )}\r\n                {cooldownUntil && cooldownUntil > Date.now() && (\r\n                  <div className=\"text-xs text-rose-300\">\r\n                    Recent winners can re-enter after {fmt(cooldownUntil)}.\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"shrink-0\">\r\n                <button\r\n                  className={`btn ${hasJoined(nextOfficial) ? \"bg-emerald-600 hover:bg-emerald-600\" : \"\"}`}\r\n                  title={\r\n                    hasJoined(nextOfficial)\r\n                      ? \"Double-click to leave this tournament\"\r\n                      : nextOfficial.official &&\r\n                          cooldownUntil &&\r\n                          cooldownUntil > Date.now()\r\n                        ? `Recent winners can re-enter after ${fmt(cooldownUntil)}`\r\n                        : \"\"\r\n                  }\r\n                  disabled={\r\n                    loading ||\r\n                    nextOfficial.status !== \"scheduled\" ||\r\n                    (!hasJoined(nextOfficial) &&\r\n                      (nextOfficial.participants.length >=\r\n                        nextOfficial.capacity ||\r\n                        (!!cooldownUntil && cooldownUntil > Date.now())))\r\n                  }\r\n                  onClick={() => {\r\n                    if (!hasJoined(nextOfficial)) {\r\n                      join(nextOfficial);\r\n                    } else if (isTouch) {\r\n                      setLeaveAsk({ open: true, t: nextOfficial });\r\n                    }\r\n                  }}\r\n                  onDoubleClick={() => {\r\n                    if (!isTouch && hasJoined(nextOfficial))\r\n                      setLeaveAsk({ open: true, t: nextOfficial });\r\n                  }}\r\n                  aria-label={\r\n                    hasJoined(nextOfficial) ? \"Already Joined\" : \"Join Now\"\r\n                  }\r\n                >\r\n                  {hasJoined(nextOfficial) ? \"Already Joined!\" : \"Join Now\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {errorMsg && (\r\n          <div className=\"mb-3 p-2 rounded-lg bg-amber-700/30 border border-amber-600/40 text-amber-200 text-sm\">\r\n            {errorMsg}\r\n          </div>\r\n        )}\r\n        <div className=\"space-y-4\">\r\n          <section>\r\n            <div className=\"font-semibold mb-1\">Official</div>\r\n            <div className=\"text-xs opacity-70 mb-2\">\r\n              {cooldownUntil && cooldownUntil > Date.now() ? (\r\n                <>\r\n                  You’re a recent NDN tournament winner — to keep it fair, you\r\n                  can re-enter after {fmt(cooldownUntil)}.\r\n                </>\r\n              ) : (\r\n                <>\r\n                  Note: Weekly winners can re-enter once their 3 months of\r\n                  PREMIUM ends.\r\n                </>\r\n              )}\r\n            </div>\r\n            <ul className=\"space-y-2\">\r\n              {official.map((t) => (\r\n                <li\r\n                  key={t.id}\r\n                  className=\"p-3 rounded bg-black/10 flex items-center justify-between relative\"\r\n                >\r\n                  <div className=\"space-y-0.5\">\r\n                    <div className=\"font-semibold\">\r\n                      {t.title}{\" \"}\r\n                      {t.prize && (\r\n                        <span className=\"inline-flex items-center gap-1 ml-2 align-middle\">\r\n                          <span className=\"text-xs px-2 py-0.5 rounded bg-amber-500 text-black\">\r\n                            Prize\r\n                          </span>\r\n                          <span\r\n                            className=\"inline-flex items-center justify-center w-4 h-4 rounded-full bg-slate-600 text-white text-[10px] leading-none cursor-help\"\r\n                            title={\r\n                              t.prizeType === \"cash\"\r\n                                ? \"Official cash prize tournament — payout handled by admin.\"\r\n                                : \"Weekly winners get 3 months of PREMIUM and can re-enter once their prize period ends.\"\r\n                            }\r\n                            aria-label=\"Prize info\"\r\n                          >\r\n                            i\r\n                          </span>\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"text-sm opacity-80\">\r\n                      {t.game}\r\n                      {t.game === \"X01\" && t.startingScore\r\n                        ? `/${t.startingScore}`\r\n                        : \"\"}{\" \"}\r\n                      · {labelForMode(t.mode)} {t.value} · {fmt(t.startAt)} ·\r\n                      Cap {t.capacity} · Joined {t.participants.length}\r\n                    </div>\r\n                    {t.prize && (\r\n                      <div className=\"text-xs\">\r\n                        Prize:{\" \"}\r\n                        {t.prizeType === \"cash\" && t.prizeAmount\r\n                          ? `${t.currency || \"USD\"} ${t.prizeAmount}`\r\n                          : \"3 months PREMIUM\"}\r\n                        {t.status === \"completed\" &&\r\n                          t.prizeType === \"cash\" &&\r\n                          t.payoutStatus && (\r\n                            <span\r\n                              className={`ml-2 px-2 py-0.5 rounded ${t.payoutStatus === \"paid\" ? \"bg-emerald-600\" : \"bg-amber-600\"}`}\r\n                            >\r\n                              {t.payoutStatus === \"paid\" ? \"Paid\" : \"Pending\"}\r\n                            </span>\r\n                          )}\r\n                      </div>\r\n                    )}\r\n                    {t.status !== \"scheduled\" && (\r\n                      <div className=\"text-xs\">Status: {t.status}</div>\r\n                    )}\r\n                    {hasJoined(t) && (\r\n                      <div className=\"text-xs text-emerald-400 font-semibold\">\r\n                        Already Joined\r\n                      </div>\r\n                    )}\r\n                    {t.official &&\r\n                      cooldownUntil &&\r\n                      cooldownUntil > Date.now() && (\r\n                        <div className=\"text-xs text-rose-300\">\r\n                          Cooldown active until {fmt(cooldownUntil)}.\r\n                        </div>\r\n                      )}\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <button\r\n                      className={`btn ${hasJoined(t) ? \"bg-emerald-600 hover:bg-emerald-600\" : \"\"}`}\r\n                      title={\r\n                        hasJoined(t)\r\n                          ? \"Double-click to leave this tournament\"\r\n                          : t.official &&\r\n                              cooldownUntil &&\r\n                              cooldownUntil > Date.now()\r\n                            ? `Recent winners can re-enter after ${fmt(cooldownUntil)}`\r\n                            : \"\"\r\n                      }\r\n                      disabled={\r\n                        loading ||\r\n                        t.status !== \"scheduled\" ||\r\n                        (!hasJoined(t) &&\r\n                          (t.participants.length >= t.capacity ||\r\n                            (t.official &&\r\n                              !!cooldownUntil &&\r\n                              cooldownUntil > Date.now())))\r\n                      }\r\n                      onClick={() => {\r\n                        if (!hasJoined(t)) {\r\n                          join(t);\r\n                        } else if (isTouch) {\r\n                          setLeaveAsk({ open: true, t });\r\n                        }\r\n                      }}\r\n                      onDoubleClick={() => {\r\n                        if (!isTouch && hasJoined(t))\r\n                          setLeaveAsk({ open: true, t });\r\n                      }}\r\n                      aria-label={hasJoined(t) ? \"Already Joined\" : \"Join Now\"}\r\n                    >\r\n                      {hasJoined(t) ? \"Already Joined!\" : \"Join Now\"}\r\n                    </button>\r\n                    {/* Delete button when you are the creator (owner-created official) and it hasn't started */}\r\n                    {t.status === \"scheduled\" &&\r\n                      email &&\r\n                      ((t.creatorEmail &&\r\n                        String(t.creatorEmail).toLowerCase() === email) ||\r\n                        email === \"daviesfamily108@gmail.com\") && (\r\n                        <button\r\n                          className=\"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow\"\r\n                          title=\"Delete this tournament\"\r\n                          onClick={() => deleteTournament(t)}\r\n                          aria-label=\"Delete tournament\"\r\n                        >\r\n                          ×\r\n                        </button>\r\n                      )}\r\n                  </div>\r\n                </li>\r\n              ))}\r\n              {official.length === 0 && (\r\n                <li className=\"text-sm opacity-60\">\r\n                  No official tournaments yet.\r\n                </li>\r\n              )}\r\n            </ul>\r\n          </section>\r\n\r\n          <section>\r\n            <div className=\"font-semibold mb-1\">Community</div>\r\n            <ul className=\"space-y-2\">\r\n              {community.map((t) => (\r\n                <li\r\n                  key={t.id}\r\n                  className=\"p-3 rounded bg-black/10 flex items-center justify-between relative\"\r\n                >\r\n                  <div className=\"space-y-0.5\">\r\n                    <div className=\"font-semibold\">{t.title}</div>\r\n                    <div className=\"text-sm opacity-80\">\r\n                      {t.game}\r\n                      {t.game === \"X01\" && t.startingScore\r\n                        ? `/${t.startingScore}`\r\n                        : \"\"}{\" \"}\r\n                      · {labelForMode(t.mode)} {t.value} · {fmt(t.startAt)} ·\r\n                      Cap {t.capacity} · Joined {t.participants.length}\r\n                    </div>\r\n                    {t.description && (\r\n                      <div className=\"text-xs opacity-80\">{t.description}</div>\r\n                    )}\r\n                    {hasJoined(t) && (\r\n                      <div className=\"text-xs text-emerald-400 font-semibold\">\r\n                        Already Joined\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <button\r\n                      className=\"btn\"\r\n                      title={\r\n                        hasJoined(t)\r\n                          ? \"Double-click to leave this tournament\"\r\n                          : \"\"\r\n                      }\r\n                      disabled={\r\n                        loading ||\r\n                        t.status !== \"scheduled\" ||\r\n                        (!hasJoined(t) && t.participants.length >= t.capacity)\r\n                      }\r\n                      onClick={() => {\r\n                        if (!hasJoined(t)) {\r\n                          join(t);\r\n                        } else if (isTouch) {\r\n                          setLeaveAsk({ open: true, t });\r\n                        }\r\n                      }}\r\n                      onDoubleClick={() => {\r\n                        if (!isTouch && hasJoined(t))\r\n                          setLeaveAsk({ open: true, t });\r\n                      }}\r\n                    >\r\n                      {hasJoined(t) ? \"Already Joined\" : \"Join Now\"}\r\n                    </button>\r\n                    {/* Delete button for creator to delete their own scheduled tournament */}\r\n                    {t.status === \"scheduled\" &&\r\n                      email &&\r\n                      ((t.creatorEmail &&\r\n                        String(t.creatorEmail).toLowerCase() === email) ||\r\n                        email === \"daviesfamily108@gmail.com\") && (\r\n                        <button\r\n                          className=\"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow\"\r\n                          title=\"Delete this tournament\"\r\n                          onClick={() => deleteTournament(t)}\r\n                          aria-label=\"Delete tournament\"\r\n                        >\r\n                          ×\r\n                        </button>\r\n                      )}\r\n                  </div>\r\n                </li>\r\n              ))}\r\n              {community.length === 0 && (\r\n                <li className=\"text-sm opacity-60\">\r\n                  No community tournaments yet.\r\n                </li>\r\n              )}\r\n            </ul>\r\n          </section>\r\n        </div>\r\n\r\n        {showCreate && (\r\n          <div className=\"mb-4\">\r\n            <div className=\"card relative\">\r\n              <div className=\"flex items-center justify-between mb-3\">\r\n                <h3 className=\"text-xl font-semibold\">Create Tournament</h3>\r\n                <button className=\"btn\" onClick={() => setShowCreate(false)}>\r\n                  Close\r\n                </button>\r\n              </div>\r\n              <div className=\"space-y-3 md:space-y-0 md:grid md:grid-cols-2 md:gap-4 pr-1\">\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">\r\n                    Title\r\n                  </label>\r\n                  <input\r\n                    className=\"input w-full\"\r\n                    value={form.title}\r\n                    onChange={(e) =>\r\n                      setForm((f) => ({ ...f, title: e.target.value }))\r\n                    }\r\n                  />\r\n                </div>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-1\">\r\n                      Game\r\n                    </label>\r\n                    <select\r\n                      className=\"input w-full\"\r\n                      value={form.game}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({ ...f, game: e.target.value }))\r\n                      }\r\n                    >\r\n                      {[\"X01\", \"Cricket\", \"Killer\"].map((g) => (\r\n                        <option key={g} value={g}>\r\n                          {g}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-1\">\r\n                      Mode\r\n                    </label>\r\n                    <select\r\n                      className=\"input w-full\"\r\n                      value={form.mode}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({ ...f, mode: e.target.value as any }))\r\n                      }\r\n                    >\r\n                      {getModeOptionsForGame(\r\n                        form.game as import(\"../utils/games\").GameKey,\r\n                      ).map((o) => (\r\n                        <option key={String(o)} value={String(o)}>\r\n                          {labelForMode(String(o))}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-1\">\r\n                      Number\r\n                    </label>\r\n                    <input\r\n                      className=\"input w-full\"\r\n                      type=\"number\"\r\n                      min={1}\r\n                      value={form.value}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({\r\n                          ...f,\r\n                          value: Number(e.target.value),\r\n                        }))\r\n                      }\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    className=\"input w-full\"\r\n                    rows={5}\r\n                    value={form.description}\r\n                    onChange={(e) =>\r\n                      setForm((f) => ({ ...f, description: e.target.value }))\r\n                    }\r\n                  />\r\n                </div>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-1\">\r\n                      Start time\r\n                    </label>\r\n                    <input\r\n                      className=\"input w-full\"\r\n                      type=\"datetime-local\"\r\n                      value={form.startAt}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({ ...f, startAt: e.target.value }))\r\n                      }\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-1\">\r\n                      Check-in reminder (min)\r\n                    </label>\r\n                    <input\r\n                      className=\"input w-full\"\r\n                      type=\"number\"\r\n                      min={0}\r\n                      value={form.checkinMinutes}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({\r\n                          ...f,\r\n                          checkinMinutes: Number(e.target.value),\r\n                        }))\r\n                      }\r\n                    />\r\n                  </div>\r\n                </div>\r\n                {form.game === \"X01\" && (\r\n                  <div>\r\n                    <label className=\"block text-sm font-semibold mb-1\">\r\n                      X01 Starting Score\r\n                    </label>\r\n                    <select\r\n                      className=\"input w-full\"\r\n                      value={String(form.startingScore)}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({\r\n                          ...f,\r\n                          startingScore: Number(e.target.value),\r\n                        }))\r\n                      }\r\n                    >\r\n                      {[301, 501, 701].map((s) => (\r\n                        <option key={s} value={s}>\r\n                          {s}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                )}\r\n                <div>\r\n                  <label className=\"inline-flex items-center gap-2 text-sm\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      className=\"accent-purple-500\"\r\n                      checked={!!form.requireCalibration}\r\n                      onChange={(e) =>\r\n                        setForm((f) => ({\r\n                          ...f,\r\n                          requireCalibration: !!e.target.checked,\r\n                        }))\r\n                      }\r\n                    />\r\n                    <span className=\"font-semibold\">Require calibration</span>\r\n                  </label>\r\n                  <div className=\"text-xs opacity-70 mt-1\">\r\n                    If checked, players must have a calibrated board to join\r\n                    matches spawned from this tournament.\r\n                  </div>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">\r\n                    Capacity\r\n                  </label>\r\n                  <input\r\n                    className=\"input w-full\"\r\n                    type=\"number\"\r\n                    min={6}\r\n                    max={64}\r\n                    value={form.capacity}\r\n                    onChange={(e) =>\r\n                      setForm((f) => ({\r\n                        ...f,\r\n                        capacity: Number(e.target.value),\r\n                      }))\r\n                    }\r\n                  />\r\n                </div>\r\n                <div className=\"text-xs opacity-70\">\r\n                  Note: community tournaments do not award prizes.\r\n                </div>\r\n                <div className=\"flex justify-end\">\r\n                  <button\r\n                    className=\"btn\"\r\n                    disabled={loading}\r\n                    onClick={createTournament}\r\n                  >\r\n                    Create\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {leaveAsk.open && leaveAsk.t && (\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n            <div\r\n              className=\"absolute inset-0 bg-black/40\"\r\n              onClick={() => setLeaveAsk({ open: false, t: null })}\r\n            />\r\n            <div className=\"relative card p-4 w-[360px] max-w-[90vw]\">\r\n              <div className=\"text-lg font-semibold mb-2\">\r\n                Leave tournament?\r\n              </div>\r\n              <div className=\"text-sm opacity-80 mb-4\">\r\n                Are you sure you want to remove yourself from “\r\n                {leaveAsk.t.title}”?\r\n              </div>\r\n              <div className=\"flex items-center justify-end gap-2\">\r\n                <button\r\n                  className=\"btn bg-rose-600 hover:bg-rose-700\"\r\n                  onClick={() => setLeaveAsk({ open: false, t: null })}\r\n                >\r\n                  Decline\r\n                </button>\r\n                <button\r\n                  className=\"btn bg-emerald-600 hover:bg-emerald-700\"\r\n                  onClick={async () => {\r\n                    const t = leaveAsk.t!;\r\n                    setLeaveAsk({ open: false, t: null });\r\n                    await leave(t);\r\n                  }}\r\n                >\r\n                  Accept\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Delete Tournament Confirmation Modal */}\r\n        {deleteConfirm.open && deleteConfirm.t && (\r\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n            <div className=\"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-xl font-semibold mb-4 text-white\">\r\n                  Delete Tournament\r\n                </div>\r\n                <div className=\"text-slate-300 mb-6\">\r\n                  Are you sure you want to delete{\" \"}\r\n                  <span className=\"font-semibold text-white\">\r\n                    \"{deleteConfirm.t.title}\"\r\n                  </span>\r\n                  ?\r\n                  <br />\r\n                  <span className=\"text-sm text-slate-400\">\r\n                    This action cannot be undone.\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex gap-3 justify-center\">\r\n                  <button\r\n                    className=\"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors\"\r\n                    onClick={() => setDeleteConfirm({ open: false, t: null })}\r\n                  >\r\n                    Decline\r\n                  </button>\r\n                  <button\r\n                    className=\"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors\"\r\n                    onClick={confirmDeleteTournament}\r\n                  >\r\n                    Continue\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Phone camera overlay removed per UX preference; header badge preview only */}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["MatchCard","t","onJoin","onLeave","joined","disabled","jsxs","jsx","labelForMode","Tournaments","user","toast","useToast","wsGlobal","useWS","matchType","setMatchType","teamAName","setTeamAName","teamBName","setTeamBName","useUserSettings","list","setList","useState","loading","setLoading","errorMsg","setErrorMsg","fetchError","setFetchError","lastRefresh","setLastRefresh","cooldownUntil","setCooldownUntil","showCreate","setShowCreate","showDemoStart","setShowDemoStart","showStartShowcase","setShowStartShowcase","startedShowcasedRef","useRef","match","useMatch","endSummaryPrevRef","useEffect","now","leaveAsk","setLeaveAsk","deleteConfirm","setDeleteConfirm","form","setForm","isTouch","refresh","data","apiFetch","newList","err","unsub","msg","iv","email","MatchPrefs","abort","check","hasJoined","p","deleteTournament","confirmDeleteTournament","res","join","fmt","leave","prev","it","createTournament","start","details","onKey","e","official","useMemo","community","created","nextOfficial","a","b","ts","MatchStartShowcase","m","Fragment","f","g","getModeOptionsForGame","o","s"],"mappings":"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"}