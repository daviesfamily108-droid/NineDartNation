{"version":3,"file":"Tournaments-Ct_kug-J.js","sources":["../../src/components/MatchCard.tsx","../../src/components/Tournaments.tsx"],"sourcesContent":["import React from 'react'\r\n\r\ntype Tournament = {\r\n  id: string\r\n  title: string\r\n  game: string\r\n  mode: 'bestof'|'firstto'\r\n  value: number\r\n  startAt: number\r\n  capacity: number\r\n  participants: { email: string, username: string }[]\r\n  creatorName?: string\r\n  creatorEmail?: string\r\n  official?: boolean\r\n}\r\n\r\nexport default function MatchCard({ t, onJoin, onLeave, joined, disabled }: { t: Tournament, onJoin?: (t:any)=>void, onLeave?: (t:any)=>void, joined?: boolean, disabled?: boolean }) {\r\n  return (\r\n    <li className=\"p-3 rounded bg-black/10 flex items-center justify-between relative\">\r\n      <div className=\"space-y-0.5\">\r\n        <div className=\"font-semibold\">\r\n          {t.title}\r\n          {t.official && <span className=\"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-amber-500 text-black text-xs\">Official</span>}\r\n        </div>\r\n        <div className=\"text-sm opacity-80\">{t.game}{t.game==='X01' ? `/501` : ''} · {t.mode==='firstto' ? 'First to' : 'Best of'} {t.value} · {new Date(t.startAt).toLocaleString()} · Cap {t.capacity} · Joined {t.participants?.length || 0}</div>\r\n        <div className=\"text-xs opacity-60 mt-1\">Created by: {t.creatorName || t.creatorEmail || 'Unknown'}</div>\r\n      </div>\r\n      <div className=\"flex items-center gap-2\">\r\n        <button className={`btn ${joined ? 'bg-emerald-600 hover:bg-emerald-600' : ''}`} disabled={disabled} onClick={() => joined ? (onLeave && onLeave(t)) : (onJoin && onJoin(t))}>{joined ? 'Already Joined' : 'Join Now'}</button>\r\n      </div>\r\n    </li>\r\n  )\r\n}\r\n","import { useEffect, useMemo, useState, useRef } from 'react'\r\nimport { useMatch } from '../store/match'\r\nimport MatchCard from './MatchCard'\r\nimport MatchStartShowcase from './ui/MatchStartShowcase'\r\nimport ResizableModal from './ui/ResizableModal'\r\nimport { useToast } from '../store/toast'\r\nimport { useWS } from './WSProvider'\r\nimport { apiFetch } from '../utils/api'\r\nimport { useUserSettings } from '../store/userSettings'\r\n\r\ntype Tournament = {\r\n  id: string\r\n  title: string\r\n  game: string\r\n  mode: 'bestof'|'firstto'\r\n  value: number\r\n  description: string\r\n  startAt: number\r\n  checkinMinutes: number\r\n  capacity: number\r\n  participants: { email: string, username: string }[]\r\n  official?: boolean\r\n  prize?: boolean\r\n  prizeType?: 'premium'|'cash'|'none'\r\n  prizeAmount?: number\r\n  currency?: string\r\n  payoutStatus?: 'none'|'pending'|'paid'\r\n  status: 'scheduled'|'running'|'completed'\r\n  winnerEmail?: string|null\r\n  startingScore?: number\r\n  creatorEmail?: string\r\n  creatorName?: string\r\n}\r\n\r\nexport default function Tournaments({ user }: { user: any }) {\r\n  const toast = useToast()\r\n  const wsGlobal = (() => { try { return useWS() } catch { return null } })()\r\n  // Persisted match preferences (used when creating or joining)\r\n  const { matchType = 'singles', setMatchType, teamAName = 'Team A', setTeamAName, teamBName = 'Team B', setTeamBName } = useUserSettings()\r\n  const [list, setList] = useState<Tournament[]>([])\r\n  const [loading, setLoading] = useState(false)\r\n  const [errorMsg, setErrorMsg] = useState('')\r\n  const [fetchError, setFetchError] = useState<string | null>(null)\r\n  const [lastRefresh, setLastRefresh] = useState<number | null>(null)\r\n  const [cooldownUntil, setCooldownUntil] = useState<number | null>(null)\r\n  const [showCreate, setShowCreate] = useState(false)\r\n  const [showDemoStart, setShowDemoStart] = useState(false)\r\n  const [showStartShowcase, setShowStartShowcase] = useState(false)\r\n  const startedShowcasedRef = useRef(false)\r\n  const match = useMatch()\r\n  const endSummaryPrevRef = useRef(!!useMatch.getState().inProgress)\r\n  useEffect(() => {\r\n    const prev = endSummaryPrevRef.current\r\n    const now = !!match.inProgress\r\n    // Reset the showcased flag when match ends\r\n    if (!now) startedShowcasedRef.current = false\r\n    // When match starts, show the start showcase once\r\n    if (now && !startedShowcasedRef.current) {\r\n      startedShowcasedRef.current = true\r\n      setShowStartShowcase(true)\r\n    }\r\n    endSummaryPrevRef.current = now\r\n  }, [match.inProgress, match.players])\r\n  const [leaveAsk, setLeaveAsk] = useState<{ open: boolean; t: Tournament | null }>({ open: false, t: null })\r\n  const [deleteConfirm, setDeleteConfirm] = useState<{ open: boolean; t: Tournament | null }>({ open: false, t: null })\r\n  const [form, setForm] = useState({\r\n    title: 'Community X01 Tournament',\r\n    game: 'X01',\r\n    mode: 'bestof' as 'bestof'|'firstto',\r\n    value: 3,\r\n    description: '',\r\n    startAt: new Date(Date.now() + 2*60*60*1000).toISOString().slice(0,16), // local yyyy-mm-ddThh:mm\r\n    checkinMinutes: 15,\r\n    capacity: 8,\r\n    startingScore: 501,\r\n    requireCalibration: false,\r\n  })\r\n  const isTouch = (() => {\r\n    try { return ('ontouchstart' in window) || (navigator.maxTouchPoints||0) > 0 } catch { return false }\r\n  })()\r\n\r\n  async function refresh() {\r\n    try {\r\n      const res = await apiFetch('/api/tournaments')\r\n      const data = await res.json()\r\n  const newList = Array.isArray(data.tournaments) ? data.tournaments : []\r\n  setList(newList)\r\n  try { console.debug('[Tournaments] refresh fetched', newList.length, 'tournaments'); console.log('[Tournaments] fetched list:', newList) } catch {}\r\n      setFetchError(null)\r\n      setLastRefresh(Date.now())\r\n    } catch (err: any) {\r\n      try { setFetchError(String(err?.message || err)) } catch { setFetchError('unknown') }\r\n    }\r\n  }\r\n  useEffect(() => { refresh() }, [])\r\n\r\n  // Re-fetch tournaments when we have a fresh WS connection so clients resync after reconnects/server restarts\r\n  useEffect(() => {\r\n    try {\r\n      if (wsGlobal?.connected) refresh()\r\n    } catch {}\r\n  }, [wsGlobal?.connected])\r\n\r\n  // Listen for WS push updates from global provider if available\r\n  useEffect(() => {\r\n    if (!wsGlobal) return\r\n    const unsub = wsGlobal.addListener((msg) => {\r\n      try {\r\n  if (msg.type === 'tournaments') { setList(msg.tournaments || []); setLastRefresh(Date.now()); }\r\n        if (msg.type === 'tournaments') {\r\n          try { console.debug('[Tournaments] WS tournaments update, num=', (msg.tournaments || []).length) } catch {}\r\n        }\r\n        if (msg.type === 'tournament-win' && msg.message) {\r\n          toast(msg.message, { type: 'success', timeout: 10000 }) // Show for 10 seconds\r\n        }\r\n        // tournament-reminder handled optionally here if desired\r\n      } catch {}\r\n    })\r\n    return () => { unsub() }\r\n  }, [wsGlobal?.connected])\r\n\r\n  // If WS connects, ask for a fresh list via WS; this will prompt server to send a tournaments snapshot.\r\n  useEffect(() => {\r\n    try {\r\n      if (wsGlobal?.connected) {\r\n        try { wsGlobal.send({ type: 'list-tournaments' }) } catch {}\r\n        // Also ensure we refresh as a fallback\r\n        refresh()\r\n      }\r\n    } catch {}\r\n  }, [wsGlobal?.connected])\r\n\r\n  // Polling fallback: if WS is unavailable, poll the API every 10s to keep lobby up-to-date\r\n  useEffect(() => {\r\n    let iv: number | null = null\r\n    try {\r\n      if (!wsGlobal || !wsGlobal.connected) {\r\n        iv = window.setInterval(() => { refresh() }, 10000)\r\n      }\r\n    } catch {}\r\n    return () => { if (iv) clearInterval(iv) }\r\n  }, [wsGlobal?.connected])\r\n\r\n  const email = String(user?.email || '').toLowerCase()\r\n  \r\n  // Simple, persistent match preference UI\r\n  const MatchPrefs = () => (\r\n    <div className=\"mb-3 p-2 rounded-lg bg-slate-900/40 border border-white/10 text-white text-xs flex items-center gap-2 flex-wrap\">\r\n      <span className=\"opacity-70\">Default match</span>\r\n      <span className=\"btn py-1 px-2 bg-indigo-500/30 border border-indigo-400/50 text-indigo-100\">Singles</span>\r\n      <span className=\"text-xs opacity-60 ml-2\">(tournaments use Singles only)</span>\r\n    </div>\r\n  )\r\n  // Fetch subscription to detect if user is a recent tournament winner (cooldown)\r\n  useEffect(() => {\r\n    let abort = false\r\n    async function check() {\r\n      if (!email) { setCooldownUntil(null); return }\r\n      try {\r\n        const res = await apiFetch(`/api/subscription?email=${encodeURIComponent(email)}`)\r\n        const data = await res.json()\r\n        if (!abort) {\r\n          if (data?.source === 'tournament' && typeof data.expiresAt === 'number' && data.expiresAt > Date.now()) {\r\n            setCooldownUntil(data.expiresAt)\r\n          } else {\r\n            setCooldownUntil(null)\r\n          }\r\n        }\r\n      } catch {\r\n        if (!abort) setCooldownUntil(null)\r\n      }\r\n    }\r\n    check()\r\n    return () => { abort = true }\r\n  }, [email])\r\n  function hasJoined(t: Tournament) {\r\n    return !!t.participants?.some(p => p.email === email)\r\n  }\r\n\r\n  // Helper to delete a tournament with proper error handling and owner fallback\r\n  async function deleteTournament(t: Tournament) {\r\n    if (!email) return\r\n    setDeleteConfirm({ open: true, t })\r\n  }\r\n\r\n  async function confirmDeleteTournament() {\r\n    const t = deleteConfirm.t\r\n    if (!t || !email) return\r\n    setDeleteConfirm({ open: false, t: null })\r\n    setLoading(true)\r\n    try {\r\n      // First try creator/owner shared endpoint\r\n      let res = await apiFetch('/api/tournaments/delete', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ tournamentId: t.id, requesterEmail: email })\r\n      })\r\n\r\n      // If forbidden but user is the owner, try the admin endpoint as a fallback\r\n      if (!res.ok && res.status === 403 && String(email) === 'daviesfamily108@gmail.com') {\r\n        res = await apiFetch('/api/admin/tournaments/delete', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ tournamentId: t.id, requesterEmail: email })\r\n        })\r\n      }\r\n\r\n      if (!res.ok) {\r\n        let msg = 'Delete failed'\r\n        try {\r\n          const data = await res.json()\r\n          if (data?.error) msg = `Delete failed: ${String(data.error)}`\r\n        } catch {}\r\n        toast(msg, { type: 'error' })\r\n        return\r\n      }\r\n\r\n      toast('Tournament deleted', { type: 'success' })\r\n      await refresh()\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  async function join(t: Tournament) {\r\n    if (!email) return\r\n    setLoading(true)\r\n    try {\r\n      const res = await apiFetch('/api/tournaments/join', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ tournamentId: t.id, email, username: user?.username }) })\r\n      if (!res.ok) {\r\n        let data: any = {}\r\n        try { data = await res.json() } catch {}\r\n        if (data?.error === 'WINNER_COOLDOWN' && typeof data.until === 'number') {\r\n          setErrorMsg(`You're a recent NDN tournament winner. You can re-enter after ${fmt(data.until)}.`)\r\n          setTimeout(()=>setErrorMsg(''), 6000)\r\n          toast('Join blocked: winner cooldown active', { type: 'error' })\r\n        } else if (data?.error === 'ALREADY_IN_TOURNAMENT') {\r\n          setErrorMsg(String(data.message || 'You can only join one tournament at a time.'))\r\n          setTimeout(()=>setErrorMsg(''), 6000)\r\n          toast('Join blocked: already in another tournament', { type: 'error' })\r\n        } else if (data?.error) {\r\n          setErrorMsg(String(data.error))\r\n          setTimeout(()=>setErrorMsg(''), 3500)\r\n          toast(`Join failed: ${String(data.error)}`, { type: 'error' })\r\n        }\r\n        return\r\n      }\r\n      toast('Joined tournament', { type: 'success' })\r\n      await refresh()\r\n    } finally { setLoading(false) }\r\n  }\r\n\r\n  async function leave(t: Tournament) {\r\n    if (!email) return\r\n    setLoading(true)\r\n    try {\r\n      const res = await apiFetch('/api/tournaments/leave', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ tournamentId: t.id, email }) })\r\n      if (!res.ok) {\r\n        let data: any = {}\r\n        try { data = await res.json() } catch {}\r\n        if (data?.error) {\r\n          toast(`Leave failed: ${String(data.error)}`, { type: 'error' })\r\n        } else if (res.status === 404) {\r\n          toast('Leave failed (endpoint not found). Restart the server to enable /api/tournaments/leave.', { type: 'error' })\r\n        } else {\r\n          toast('Leave failed. Please try again.', { type: 'error' })\r\n        }\r\n        return\r\n      }\r\n      toast('Left tournament', { type: 'success' })\r\n      // Optimistic local update\r\n      setList(prev => prev.map(it => it.id === t.id ? { ...it, participants: (it.participants||[]).filter(p => p.email !== email) } : it))\r\n      await refresh()\r\n    } finally { setLoading(false) }\r\n  }\r\n\r\n  async function createTournament() {\r\n    setLoading(true)\r\n    try {\r\n      const start = new Date(form.startAt).getTime()\r\n      const res = await apiFetch('/api/tournaments/create', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({\r\n        title: form.title,\r\n        game: form.game,\r\n        mode: form.mode,\r\n        value: Number(form.value),\r\n        description: form.description,\r\n        startAt: start,\r\n        checkinMinutes: Number(form.checkinMinutes),\r\n        capacity: Number(form.capacity),\r\n        startingScore: form.game==='X01' ? Number(form.startingScore||501) : undefined,\r\n        requireCalibration: !!form.requireCalibration,\r\n        creatorEmail: user?.email,\r\n        creatorName: user?.username,\r\n      }) })\r\n      if (!res.ok) {\r\n        let details = ''\r\n        try {\r\n          const data = await res.json()\r\n          if (data?.error) details = String(data.error)\r\n          else if (data?.details) details = String(data.details)\r\n        } catch {}\r\n        const msg = details ? `Create failed: ${details}` : 'Create failed. Please try again.'\r\n        setErrorMsg(msg)\r\n        toast(msg, { type: 'error' })\r\n        setTimeout(()=>setErrorMsg(''), 6000)\r\n        return\r\n      }\r\n      try {\r\n        const data = await res.json()\r\n        if (!data?.ok) {\r\n          const msg = data?.error ? `Create failed: ${String(data.error)}` : 'Create failed. Please try again.'\r\n          setErrorMsg(msg)\r\n          toast(msg, { type: 'error' })\r\n          setTimeout(()=>setErrorMsg(''), 6000)\r\n          return\r\n        }\r\n      } catch {}\r\n      setShowCreate(false)\r\n      toast('Tournament created', { type: 'success' })\r\n      await refresh()\r\n    } finally { setLoading(false) }\r\n  }\r\n\r\n  // Close the create modal on Escape\r\n  useEffect(() => {\r\n    if (!showCreate) return\r\n    const onKey = (e: KeyboardEvent) => { if (e.key === 'Escape') setShowCreate(false) }\r\n    document.addEventListener('keydown', onKey)\r\n    return () => document.removeEventListener('keydown', onKey)\r\n  }, [showCreate])\r\n\r\n  const official = useMemo(() => list.filter(t => t.official), [list])\r\n  const community = useMemo(() => list.filter(t => !t.official), [list])\r\n  const created = useMemo(() => list.filter(t => t.status === 'scheduled' && !t.official), [list])\r\n  const nextOfficial = useMemo(() => {\r\n    const upcoming = official\r\n      .filter(t => t.status === 'scheduled')\r\n      .sort((a,b) => a.startAt - b.startAt)\r\n    return upcoming[0] || null\r\n  }, [official])\r\n\r\n  function fmt(ts: number) {\r\n    const d = new Date(ts)\r\n    return d.toLocaleString()\r\n  }\r\n\r\n  return (\r\n    <div className=\"card ndn-game-shell\">\r\n      {/* Debug: quick indicator to help diagnose lobby state on deployed env */}\r\n      <div className=\"absolute top-3 right-6 text-xs opacity-80 p-2 rounded bg-black/30 text-white\">\r\n        <div>Tournaments: {list.length}</div>\r\n        <div>Last refresh: {lastRefresh ? new Date(lastRefresh).toLocaleTimeString() : '—'}</div>\r\n        {fetchError && <div className=\"text-rose-300\">Fetch err: {String(fetchError).slice(0,40)}</div>}\r\n        <div className=\"mt-1\"><button className=\"btn btn-sm\" onClick={() => refresh()}>Refresh</button></div>\r\n      </div>\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <h2 className=\"text-2xl font-bold\">Tournaments</h2>\r\n      </div>\r\n      <div className=\"ndn-shell-body\">\r\n      {/* Create Tournament + and default match prefs on a single header row */}\r\n      <div className=\"mb-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-between gap-2 flex-wrap\">\r\n        <div className=\"min-w-0\">\r\n          <MatchPrefs />\r\n        </div>\r\n        <div className=\"shrink-0\">\r\n          <button className=\"btn\" onClick={()=>setShowCreate(true)}>Create Tournament +</button>\r\n          {((import.meta as any).env?.DEV || email === 'daviesfamily108@gmail.com') && (\r\n            <button className=\"btn btn-ghost ml-2\" onClick={() => setShowDemoStart(true)}>Demo Start Showcase</button>\r\n          )}\r\n        </div>\r\n      </div>\r\n  {/* DEV-only start showcase demo */}\r\n  {showDemoStart && <MatchStartShowcase players={[{ id: '0', name: 'Demo A', legsWon: 0, legs: [] }, { id: '1', name: 'Demo B', legsWon: 0, legs: [] }]} onDone={() => setShowDemoStart(false)} />}\r\n  {/* Show overlay when a tournament match starts while on the tournaments page */}\r\n  {showStartShowcase && <MatchStartShowcase players={(match.players || []) as any} onDone={() => setShowStartShowcase(false)} />}\r\n  <div className=\"mb-2 text-sm font-semibold text-slate-300\">World Lobby</div>\r\n      {/* Created Game Lobby: show all created tournaments (scheduled) */}\r\n      <div className=\"mb-3 p-3 rounded-xl border border-slate-700 bg-black/10\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <div className=\"font-semibold\">Created Game Lobby</div>\r\n          <div className=\"text-xs opacity-60\">All tournaments created by users and admins</div>\r\n        </div>\r\n        <ul className=\"space-y-2\">\r\n          {created.length === 0 && <li className=\"text-sm opacity-60\">No created tournaments yet.</li>}\r\n          {created.map(t => (\r\n            <MatchCard key={t.id} t={t} onJoin={(m)=>join(m)} onLeave={(m)=>leave(m)} joined={hasJoined(t)} disabled={loading || t.status!=='scheduled' || (!hasJoined(t) && (t.participants.length>=t.capacity))} />\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      {/* Persistent banner for next official weekly tournament */}\r\n      {nextOfficial && (\r\n        <div className=\"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10\">\r\n          <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-2\">\r\n            <div>\r\n              <div className=\"text-sm uppercase tracking-wide text-indigo-300 font-semibold\">Weekly Official Tournament</div>\r\n              <div className=\"font-bold\">{nextOfficial.title}</div>\r\n                  <div className=\"text-sm opacity-80\">{nextOfficial.game}{nextOfficial.game==='X01' && nextOfficial.startingScore?`/${nextOfficial.startingScore}`:''} · {nextOfficial.mode==='firstto'?'First to':'Best of'} {nextOfficial.value} · Starts {fmt(nextOfficial.startAt)} · Cap {nextOfficial.capacity} · Joined {nextOfficial.participants.length}</div>\r\n              {nextOfficial.prize && (\r\n                <div className=\"text-xs mt-1\">\r\n                  Prize: {nextOfficial.prizeType === 'cash' && nextOfficial.prizeAmount ? `${nextOfficial.currency||'USD'} ${nextOfficial.prizeAmount}` : '3 months PREMIUM'}\r\n                </div>\r\n              )}\r\n              {nextOfficial.status !== 'scheduled' && <div className=\"text-xs\">Status: {nextOfficial.status}</div>}\r\n              {cooldownUntil && cooldownUntil > Date.now() && (\r\n                <div className=\"text-xs text-rose-300\">Recent winners can re-enter after {fmt(cooldownUntil)}.</div>\r\n              )}\r\n            </div>\r\n            <div className=\"shrink-0\">\r\n              <button\r\n                className={`btn ${hasJoined(nextOfficial) ? 'bg-emerald-600 hover:bg-emerald-600' : ''}`}\r\n                title={hasJoined(nextOfficial)\r\n                  ? 'Double-click to leave this tournament'\r\n                  : (nextOfficial.official && cooldownUntil && cooldownUntil > Date.now() ? `Recent winners can re-enter after ${fmt(cooldownUntil)}` : '')}\r\n                disabled={loading || nextOfficial.status!=='scheduled' || (!hasJoined(nextOfficial) && (nextOfficial.participants.length>=nextOfficial.capacity || (!!cooldownUntil && cooldownUntil > Date.now())))}\r\n                onClick={()=> {\r\n                  if (!hasJoined(nextOfficial)) { join(nextOfficial) }\r\n                  else if (isTouch) { setLeaveAsk({ open: true, t: nextOfficial }) }\r\n                }}\r\n                onDoubleClick={()=> { if (!isTouch && hasJoined(nextOfficial)) setLeaveAsk({ open: true, t: nextOfficial }) }}\r\n                aria-label={hasJoined(nextOfficial) ? 'Already Joined' : 'Join Now'}\r\n              >{hasJoined(nextOfficial) ? 'Already Joined!' : 'Join Now'}</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {errorMsg && (\r\n        <div className=\"mb-3 p-2 rounded-lg bg-amber-700/30 border border-amber-600/40 text-amber-200 text-sm\">{errorMsg}</div>\r\n      )}\r\n      <div className=\"space-y-4\">\r\n        <section>\r\n          <div className=\"font-semibold mb-1\">Official</div>\r\n          <div className=\"text-xs opacity-70 mb-2\">\r\n            {cooldownUntil && cooldownUntil > Date.now() ? (\r\n              <>You’re a recent NDN tournament winner — to keep it fair, you can re-enter after {fmt(cooldownUntil)}.</>\r\n            ) : (\r\n              <>Note: Weekly winners can re-enter once their 3 months of PREMIUM ends.</>\r\n            )}\r\n          </div>\r\n          <ul className=\"space-y-2\">\r\n            {official.map(t => (\r\n              <li key={t.id} className=\"p-3 rounded bg-black/10 flex items-center justify-between relative\">\r\n                <div className=\"space-y-0.5\">\r\n                  <div className=\"font-semibold\">{t.title} {t.prize && (\r\n                    <span className=\"inline-flex items-center gap-1 ml-2 align-middle\">\r\n                      <span className=\"text-xs px-2 py-0.5 rounded bg-amber-500 text-black\">Prize</span>\r\n                      <span\r\n                        className=\"inline-flex items-center justify-center w-4 h-4 rounded-full bg-slate-600 text-white text-[10px] leading-none cursor-help\"\r\n                        title={t.prizeType==='cash' ? 'Official cash prize tournament — payout handled by admin.' : 'Weekly winners get 3 months of PREMIUM and can re-enter once their prize period ends.'}\r\n                        aria-label=\"Prize info\"\r\n                      >i</span>\r\n                    </span>\r\n                  )}</div>\r\n                  <div className=\"text-sm opacity-80\">{t.game}{t.game==='X01' && t.startingScore?`/${t.startingScore}`:''} · {t.mode==='firstto'?'First to':'Best of'} {t.value} · {fmt(t.startAt)} · Cap {t.capacity} · Joined {t.participants.length}</div>\r\n                  {t.prize && (\r\n                    <div className=\"text-xs\">\r\n                      Prize: {t.prizeType === 'cash' && t.prizeAmount ? `${t.currency||'USD'} ${t.prizeAmount}` : '3 months PREMIUM'}\r\n                      {t.status==='completed' && t.prizeType==='cash' && t.payoutStatus && (\r\n                        <span className={`ml-2 px-2 py-0.5 rounded ${t.payoutStatus==='paid'?'bg-emerald-600':'bg-amber-600'}`}>{t.payoutStatus==='paid'?'Paid':'Pending'}</span>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                  {t.status !== 'scheduled' && <div className=\"text-xs\">Status: {t.status}</div>}\r\n                  {hasJoined(t) && <div className=\"text-xs text-emerald-400 font-semibold\">Already Joined</div>}\r\n                  {t.official && cooldownUntil && cooldownUntil > Date.now() && (\r\n                    <div className=\"text-xs text-rose-300\">Cooldown active until {fmt(cooldownUntil)}.</div>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    className={`btn ${hasJoined(t) ? 'bg-emerald-600 hover:bg-emerald-600' : ''}`}\r\n                    title={hasJoined(t)\r\n                      ? 'Double-click to leave this tournament'\r\n                      : (t.official && cooldownUntil && cooldownUntil > Date.now() ? `Recent winners can re-enter after ${fmt(cooldownUntil)}` : '')}\r\n                    disabled={loading || t.status!=='scheduled' || (!hasJoined(t) && (t.participants.length>=t.capacity || (t.official && !!cooldownUntil && cooldownUntil > Date.now())))}\r\n                    onClick={()=> { if (!hasJoined(t)) { join(t) } else if (isTouch) { setLeaveAsk({ open: true, t }) } }}\r\n                    onDoubleClick={()=> { if (!isTouch && hasJoined(t)) setLeaveAsk({ open: true, t }) }}\r\n                    aria-label={hasJoined(t) ? 'Already Joined' : 'Join Now'}\r\n                  >{hasJoined(t) ? 'Already Joined!' : 'Join Now'}</button>\r\n                  {/* Delete button when you are the creator (owner-created official) and it hasn't started */}\r\n                  {(t.status==='scheduled' && email && ((t.creatorEmail && String(t.creatorEmail).toLowerCase()===email) || email === 'daviesfamily108@gmail.com')) && (\r\n                    <button\r\n                      className=\"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow\"\r\n                      title=\"Delete this tournament\"\r\n                      onClick={()=>deleteTournament(t)}\r\n                      aria-label=\"Delete tournament\"\r\n                    >×</button>\r\n                  )}\r\n                </div>\r\n              </li>\r\n            ))}\r\n            {official.length === 0 && <li className=\"text-sm opacity-60\">No official tournaments yet.</li>}\r\n          </ul>\r\n        </section>\r\n\r\n        <section>\r\n          <div className=\"font-semibold mb-1\">Community</div>\r\n          <ul className=\"space-y-2\">\r\n            {community.map(t => (\r\n              <li key={t.id} className=\"p-3 rounded bg-black/10 flex items-center justify-between relative\">\r\n                <div className=\"space-y-0.5\">\r\n                  <div className=\"font-semibold\">{t.title}</div>\r\n                  <div className=\"text-sm opacity-80\">{t.game}{t.game==='X01' && t.startingScore?`/${t.startingScore}`:''} · {t.mode==='firstto'?'First to':'Best of'} {t.value} · {fmt(t.startAt)} · Cap {t.capacity} · Joined {t.participants.length}</div>\r\n                  {t.description && <div className=\"text-xs opacity-80\">{t.description}</div>}\r\n                  {hasJoined(t) && <div className=\"text-xs text-emerald-400 font-semibold\">Already Joined</div>}\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    className=\"btn\"\r\n                    title={hasJoined(t) ? 'Double-click to leave this tournament' : ''}\r\n                    disabled={loading || t.status!=='scheduled' || (!hasJoined(t) && t.participants.length>=t.capacity)}\r\n                    onClick={()=> { if (!hasJoined(t)) { join(t) } else if (isTouch) { setLeaveAsk({ open: true, t }) } }}\r\n                    onDoubleClick={()=> { if (!isTouch && hasJoined(t)) setLeaveAsk({ open: true, t }) }}\r\n                  >{hasJoined(t) ? 'Already Joined' : 'Join Now'}</button>\r\n                  {/* Delete button for creator to delete their own scheduled tournament */}\r\n                  {(t.status==='scheduled' && email && ((t.creatorEmail && String(t.creatorEmail).toLowerCase()===email) || email === 'daviesfamily108@gmail.com')) && (\r\n                    <button\r\n                      className=\"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow\"\r\n                      title=\"Delete this tournament\"\r\n                      onClick={()=>deleteTournament(t)}\r\n                      aria-label=\"Delete tournament\"\r\n                    >×</button>\r\n                  )}\r\n                </div>\r\n              </li>\r\n            ))}\r\n            {community.length === 0 && <li className=\"text-sm opacity-60\">No community tournaments yet.</li>}\r\n          </ul>\r\n        </section>\r\n      </div>\r\n\r\n      {showCreate && (\r\n        <div className=\"mb-4\">\r\n          <div className=\"card relative\">\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <h3 className=\"text-xl font-semibold\">Create Tournament</h3>\r\n              <button className=\"btn\" onClick={()=>setShowCreate(false)}>Close</button>\r\n            </div>\r\n            <div className=\"space-y-3 md:space-y-0 md:grid md:grid-cols-2 md:gap-4 pr-1\">\r\n              <div>\r\n                <label className=\"block text-sm font-semibold mb-1\">Title</label>\r\n                <input className=\"input w-full\" value={form.title} onChange={e=>setForm(f=>({ ...f, title: e.target.value }))} />\r\n              </div>\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">Game</label>\r\n                  <select className=\"input w-full\" value={form.game} onChange={e=>setForm(f=>({ ...f, game: e.target.value }))}>\r\n                    {['X01', 'Cricket', 'Killer'].map(g => <option key={g} value={g}>{g}</option>)}\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">Mode</label>\r\n                  <select className=\"input w-full\" value={form.mode} onChange={e=>setForm(f=>({ ...f, mode: e.target.value as any }))}>\r\n                    <option value=\"bestof\">Best of</option>\r\n                    <option value=\"firstto\">First to</option>\r\n                  </select>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">Number</label>\r\n                  <input className=\"input w-full\" type=\"number\" min={1} value={form.value} onChange={e=>setForm(f=>({ ...f, value: Number(e.target.value) }))} />\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-semibold mb-1\">Description</label>\r\n                <textarea className=\"input w-full\" rows={5} value={form.description} onChange={e=>setForm(f=>({ ...f, description: e.target.value }))} />\r\n              </div>\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">Start time</label>\r\n                  <input className=\"input w-full\" type=\"datetime-local\" value={form.startAt} onChange={e=>setForm(f=>({ ...f, startAt: e.target.value }))} />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">Check-in reminder (min)</label>\r\n                  <input className=\"input w-full\" type=\"number\" min={0} value={form.checkinMinutes} onChange={e=>setForm(f=>({ ...f, checkinMinutes: Number(e.target.value) }))} />\r\n                </div>\r\n              </div>\r\n              {form.game==='X01' && (\r\n                <div>\r\n                  <label className=\"block text-sm font-semibold mb-1\">X01 Starting Score</label>\r\n                  <select className=\"input w-full\" value={String(form.startingScore)} onChange={e=>setForm(f=>({ ...f, startingScore: Number(e.target.value) }))}>\r\n                    {[301, 501, 701].map(s => <option key={s} value={s}>{s}</option>)}\r\n                  </select>\r\n                </div>\r\n              )}\r\n              <div>\r\n                <label className=\"inline-flex items-center gap-2 text-sm\">\r\n                  <input type=\"checkbox\" className=\"accent-purple-500\" checked={!!form.requireCalibration} onChange={e=>setForm(f=>({ ...f, requireCalibration: !!e.target.checked }))} />\r\n                  <span className=\"font-semibold\">Require calibration</span>\r\n                </label>\r\n                <div className=\"text-xs opacity-70 mt-1\">If checked, players must have a calibrated board to join matches spawned from this tournament.</div>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-semibold mb-1\">Capacity</label>\r\n                <input className=\"input w-full\" type=\"number\" min={6} max={64} value={form.capacity} onChange={e=>setForm(f=>({ ...f, capacity: Number(e.target.value) }))} />\r\n              </div>\r\n              <div className=\"text-xs opacity-70\">Note: community tournaments do not award prizes.</div>\r\n              <div className=\"flex justify-end\">\r\n                <button className=\"btn\" disabled={loading} onClick={createTournament}>Create</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {leaveAsk.open && leaveAsk.t && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n          <div className=\"absolute inset-0 bg-black/40\" onClick={()=>setLeaveAsk({ open: false, t: null })} />\r\n          <div className=\"relative card p-4 w-[360px] max-w-[90vw]\">\r\n            <div className=\"text-lg font-semibold mb-2\">Leave tournament?</div>\r\n            <div className=\"text-sm opacity-80 mb-4\">Are you sure you want to remove yourself from “{leaveAsk.t.title}”?</div>\r\n            <div className=\"flex items-center justify-end gap-2\">\r\n              <button\r\n                className=\"btn bg-rose-600 hover:bg-rose-700\"\r\n                onClick={()=>setLeaveAsk({ open: false, t: null })}\r\n              >Decline</button>\r\n              <button\r\n                className=\"btn bg-emerald-600 hover:bg-emerald-700\"\r\n                onClick={async ()=>{ const t = leaveAsk.t!; setLeaveAsk({ open: false, t: null }); await leave(t) }}\r\n              >Accept</button>\r\n            </div>\r\n        </div>\r\n      </div>\r\n      )}\r\n\r\n      {/* Delete Tournament Confirmation Modal */}\r\n      {deleteConfirm.open && deleteConfirm.t && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-xl font-semibold mb-4 text-white\">Delete Tournament</div>\r\n              <div className=\"text-slate-300 mb-6\">\r\n                Are you sure you want to delete <span className=\"font-semibold text-white\">\"{deleteConfirm.t.title}\"</span>?\r\n                <br />\r\n                <span className=\"text-sm text-slate-400\">This action cannot be undone.</span>\r\n              </div>\r\n              <div className=\"flex gap-3 justify-center\">\r\n                <button\r\n                  className=\"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors\"\r\n                  onClick={() => setDeleteConfirm({ open: false, t: null })}\r\n                >\r\n                  Decline\r\n                </button>\r\n                <button\r\n                  className=\"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors\"\r\n                  onClick={confirmDeleteTournament}\r\n                >\r\n                  Continue\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n  {/* Phone camera overlay removed per UX preference; header badge preview only */}\r\n    </div>\r\n    </div>\r\n  )\r\n}"],"names":["MatchCard","t","onJoin","onLeave","joined","disabled","jsxs","jsx","Tournaments","user","toast","useToast","wsGlobal","useWS","matchType","setMatchType","teamAName","setTeamAName","teamBName","setTeamBName","useUserSettings","list","setList","useState","loading","setLoading","errorMsg","setErrorMsg","fetchError","setFetchError","lastRefresh","setLastRefresh","cooldownUntil","setCooldownUntil","showCreate","setShowCreate","showDemoStart","setShowDemoStart","showStartShowcase","setShowStartShowcase","startedShowcasedRef","useRef","match","useMatch","endSummaryPrevRef","useEffect","now","leaveAsk","setLeaveAsk","deleteConfirm","setDeleteConfirm","form","setForm","isTouch","refresh","data","apiFetch","newList","err","unsub","msg","iv","email","MatchPrefs","abort","check","hasJoined","p","deleteTournament","confirmDeleteTournament","res","join","fmt","leave","prev","it","createTournament","start","details","onKey","e","official","useMemo","community","created","nextOfficial","a","b","ts","MatchStartShowcase","m","Fragment","f","g","s"],"mappings":"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"}