{"version":3,"file":"OnlinePlay.clean-BhbUvm3n.js","sources":["../../src/components/ui/CreateMatchModal.tsx","../../src/components/OnlinePlay.clean.tsx"],"sourcesContent":["import React, { useLayoutEffect, useState, useRef } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport {\n  allGames,\n  type GameKey,\n  getStartOptionsForGame,\n} from \"../../utils/games\";\nimport { useUserSettings } from \"../../store/userSettings\";\n\ntype Props = {\n  open: boolean;\n  onClose: () => void;\n  onCreate: (payload: any) => void;\n};\n\nexport default function CreateMatchModal({ open, onClose, onCreate }: Props) {\n  const [portalEl] = useState(() => document.createElement(\"div\"));\n  const [game, setGame] = useState<GameKey>(\"X01\");\n  const [modeType, setModeType] = useState<\"bestof\" | \"firstto\">(\"bestof\");\n  const [legs, setLegs] = useState<number>(3);\n  const legsRef = useRef<HTMLInputElement | null>(null);\n  const [avgChoice, setAvgChoice] = useState<number>(0);\n  const [startingScore, setStartingScore] = useState<number | undefined>(() => {\n    const opts = getStartOptionsForGame(game);\n    return opts?.[0];\n  });\n  const user = (useUserSettings() as any).username || \"Anonymous\";\n\n  useLayoutEffect(() => {\n    portalEl.className = \"ndn-create-match-portal\";\n    document.body.appendChild(portalEl);\n    return () => {\n      try {\n        portalEl && portalEl.remove();\n      } catch {}\n    };\n  }, [portalEl]);\n\n  // Close modal on Escape key\n  useLayoutEffect(() => {\n    function onKey(e: KeyboardEvent) {\n      if (e.key === \"Escape\") onClose();\n    }\n    if (open) document.addEventListener(\"keydown\", onKey);\n    return () => document.removeEventListener(\"keydown\", onKey);\n  }, [open, onClose]);\n\n  const handleCreate = () => {\n    const payload = {\n      createdBy: user,\n      game,\n      modeType,\n      legs,\n      avgChoice,\n      startingScore,\n    };\n    onCreate(payload);\n    onClose();\n  };\n\n  if (!open) return null;\n\n  if (!portalEl) return null;\n\n  return createPortal(\n  <div className=\"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4\">\n      {/* A dedicated, accessible button covers the backdrop to capture clicks and keyboard input */}\n      <button\n        aria-label=\"Close dialog\"\n        className=\"absolute inset-0 w-full h-full bg-transparent\"\n        onClick={onClose}\n      />\n      <div\n        className=\"card rounded-xl p-6 max-w-lg w-full relative text-white\"\n        role=\"dialog\"\n      >\n        <button\n          aria-label=\"Close\"\n          className=\"absolute top-3 right-3 text-rose-400 font-bold\"\n          onClick={onClose}\n        >\n          ✕\n        </button>\n        <h2 className=\"text-lg font-semibold mb-3\">Create Match</h2>\n  <div className=\"grid grid-cols-1 gap-3\">\n          <div>\n            <div className=\"text-sm opacity-80\">Created By</div>\n            <div className=\"mt-1 p-2 bg-white/5 rounded text-white\">{user}</div>\n          </div>\n          <div>\n            <label className=\"text-sm opacity-80\" htmlFor=\"match-game\">\n              Match Name (Game)\n            </label>\n            <select\n              id=\"match-game\"\n              className=\"w-full p-2 border border-white/10 bg-white/5 rounded text-white\"\n              value={game}\n              onChange={(e) => {\n                const v = e.target.value as GameKey;\n                setGame(v);\n                const opts = getStartOptionsForGame(v);\n                setStartingScore(opts?.[0]);\n              }}\n            >\n              {allGames.map((g) => (\n                <option key={g} value={g}>\n                  {g}\n                </option>\n              ))}\n            </select>\n          </div>\n          {getStartOptionsForGame(game)?.length ? (\n            <div>\n              <label\n                className=\"text-sm opacity-80\"\n                htmlFor=\"match-start\"\n              >{`${game} Starting Score`}</label>\n              <select\n                id=\"match-start\"\n                className=\"w-full p-2 border border-white/10 bg-white/5 rounded text-white\"\n                value={startingScore}\n                onChange={(e) => setStartingScore(Number(e.target.value))}\n              >\n                {getStartOptionsForGame(game).map((opt) => (\n                  <option key={opt} value={opt}>\n                    {opt}\n                  </option>\n                ))}\n              </select>\n            </div>\n          ) : null}\n          <div>\n            <div className=\"text-sm opacity-80\">Mode</div>\n            <div className=\"flex gap-2 mt-1 justify-center\">\n              <label\n                className={`btn ${modeType === \"bestof\" ? \"btn-primary\" : \"btn-ghost\"}`}\n              >\n                <input\n                  type=\"radio\"\n                  name=\"mode\"\n                  value=\"bestof\"\n                  checked={modeType === \"bestof\"}\n                  onChange={() => {\n                    setModeType(\"bestof\");\n                    setLegs((prev) => {\n                      const base = Math.max(1, prev || 3);\n                      // Ensure odd for Best Of\n                      return base % 2 === 1 ? base : base + 1;\n                    });\n                    setTimeout(() => legsRef.current?.focus(), 0);\n                  }}\n                  className=\"sr-only\"\n                />{\" \"}\n                Best Of\n              </label>\n              <label\n                className={`btn ${modeType === \"firstto\" ? \"btn-primary\" : \"btn-ghost\"}`}\n              >\n                <input\n                  type=\"radio\"\n                  name=\"mode\"\n                  value=\"firstto\"\n                  checked={modeType === \"firstto\"}\n                  onChange={() => {\n                    setModeType(\"firstto\");\n                    setLegs((prev) => Math.max(1, prev || 3));\n                    setTimeout(() => legsRef.current?.focus(), 0);\n                  }}\n                  className=\"sr-only\"\n                />{\" \"}\n                First To\n              </label>\n            </div>\n          </div>\n          <div>\n            <label className=\"text-sm opacity-80\" htmlFor=\"match-legs\">\n              {modeType === \"bestof\" ? \"Best Of\" : \"First To\"}\n            </label>\n            <input\n              id=\"match-legs\"\n              type=\"number\"\n              min={1}\n              value={legs}\n              onChange={(e) =>\n                setLegs(Math.max(1, Number(e.target.value || 1)))\n              }\n              ref={legsRef}\n              className=\"w-full p-2 border border-white/10 bg-white/5 rounded text-white\"\n            />\n          </div>\n          <div>\n            <label className=\"text-sm opacity-80\" htmlFor=\"match-avg\">\n              Average Choice (±)\n            </label>\n            <input\n              id=\"match-avg\"\n              type=\"number\"\n              value={avgChoice}\n              onChange={(e) => setAvgChoice(Number(e.target.value || 0))}\n              className=\"w-full p-2 border border-white/10 bg-white/5 rounded text-white\"\n            />\n          </div>\n        </div>\n        <div className=\"flex justify-end mt-4\">\n          <button className=\"btn btn-primary\" onClick={handleCreate}>\n            Create Match\n          </button>\n        </div>\n      </div>\n    </div>,\n    portalEl,\n  );\n}\n","import React, { useState, useMemo, useEffect } from \"react\";\nimport CreateMatchModal from \"./ui/CreateMatchModal\";\nimport GameCalibrationStatus from \"./GameCalibrationStatus\";\nimport MatchStartShowcase from \"./ui/MatchStartShowcase\";\nimport { useMatch } from \"../store/match\";\nimport { useWS } from \"./WSProvider\";\n\nexport default function OnlinePlayClean({ user }: { user?: any }) {\n  const username = user?.username || \"You\";\n  const [currentRoomIdx, setCurrentRoomIdx] = useState(0);\n  const [rooms, setRooms] = useState(() => [\n    { id: 1, name: \"room-1\", matches: [] as any[] },\n  ]);\n  const wsGlobal = (() => {\n    try {\n      return useWS();\n    } catch {\n      return null;\n    }\n  })();\n  const [serverMatches, setServerMatches] = useState<any[]>([]);\n  const inProgress = useMatch((s) => s.inProgress);\n  const players = useMatch((s) => s.players);\n  const [showStartShowcase, setShowStartShowcase] = useState<boolean>(false);\n  const startedShowcasedRef = React.useRef(false);\n  useEffect(() => {\n    if (!inProgress) return;\n    if (startedShowcasedRef.current) return;\n    startedShowcasedRef.current = true;\n    setShowStartShowcase(true);\n  }, [inProgress]);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [joinMatch, setJoinMatch] = useState<any | null>(null);\n  const joinAcceptRef = React.useRef<HTMLButtonElement | null>(null);\n  const [selfId, setSelfId] = useState<string | null>(null);\n  const [participants, setParticipants] = useState<Record<string, string>>({});\n  const [joinTimer, setJoinTimer] = useState(30);\n  const serverPrestartRef = React.useRef(false);\n  const [joinChoice, setJoinChoice] = useState<null | \"bull\" | \"skip\">(null);\n  const [remoteChoices, setRemoteChoices] = useState<\n    Record<string, \"bull\" | \"skip\">\n  >({});\n  const [bullActive, setBullActive] = useState(false);\n  const [bullThrow, setBullThrow] = useState<number | null>(null);\n  const [bullWinner, setBullWinner] = useState<string | null>(null);\n  const [bullLocalThrow, setBullLocalThrow] = useState<number | null>(null);\n  const [bullThrown, setBullThrown] = useState(false);\n\n  const currentRoom = rooms[currentRoomIdx];\n  const maxMatchesPerRoom = 12;\n  const worldLobby = useMemo(() => {\n    if (serverMatches && serverMatches.length) return serverMatches as any[];\n    return rooms.flatMap((r) =>\n      r.matches.map((m) => ({ ...m, roomName: r.name })),\n    );\n  }, [rooms, serverMatches]);\n\n  // Combined matches: current room first, then world lobby matches that are not in current room\n  const combinedMatches = useMemo(() => {\n    const local = currentRoom?.matches || [];\n    const ids = new Set(local.map((m: any) => m.id));\n    const others = (worldLobby || []).filter((m: any) => !ids.has(m.id));\n    return [...local, ...others];\n  }, [currentRoom, worldLobby]);\n\n  const handleCreateMatch = (payload: any) => {\n    const newMatch = {\n      id: `m-${Date.now()}`,\n      createdBy: payload.createdBy || username,\n      game: payload.game,\n      modeType: payload.modeType,\n      legs: payload.legs,\n      startingScore: payload.startingScore,\n      createdAt: Date.now(),\n    };\n    // Optimistically add to current room\n    setRooms((prev) =>\n      prev.map((r, idx) =>\n        idx === currentRoomIdx\n          ? { ...r, matches: [newMatch, ...r.matches] }\n          : r,\n      ),\n    );\n    // If we have a server WS connection, send a create-match message\n    try {\n      if (wsGlobal?.connected) {\n        wsGlobal.send({\n          type: \"create-match\",\n          game: payload.game,\n          mode: payload.modeType,\n          value: payload.legs,\n          startingScore: payload.startingScore,\n          creatorAvg: payload.avgChoice || 0,\n        });\n      }\n    } catch {}\n  };\n\n  const newRoom = () => {\n    setRooms((prev) => {\n      const id = prev.length + 1;\n      const newRooms = [...prev, { id, name: `room-${id}`, matches: [] }];\n      setCurrentRoomIdx(newRooms.length - 1);\n      return newRooms;\n    });\n  };\n\n  // WS: subscribe to lobby and prestart events\n  useEffect(() => {\n    if (!wsGlobal) return;\n    if (wsGlobal.connected) wsGlobal.send({ type: \"list-matches\" });\n    const unsub = wsGlobal.addListener((msg) => {\n      try {\n        if (msg?.type === \"joined\") {\n          if (msg.id) setSelfId(msg.id);\n        }\n        if (msg?.type === \"presence\") {\n          // presence carries id and username\n          try {\n            if (msg.id)\n              setParticipants((prev) => ({\n                ...prev,\n                [msg.id]: msg.username || msg.name || msg.id,\n              }));\n          } catch {}\n        }\n        if (msg?.type === \"matches\") {\n          setServerMatches(msg.matches || []);\n        }\n        if (msg?.type === \"match-prestart\") {\n          // Someone accepted the invite; show prestart and update join match if it matches\n          const m = msg.match || null;\n          if (m) m.prestartEndsAt = msg.prestartEndsAt;\n          // Ensure we know the creator's username\n          try {\n            if (m?.creatorId && m?.creatorName)\n              setParticipants((prev) => ({\n                ...prev,\n                [m.creatorId]: m.creatorName,\n              }));\n          } catch {}\n          serverPrestartRef.current = true;\n          setJoinMatch(m);\n          const endsAt = msg.prestartEndsAt || Date.now();\n          setJoinTimer(\n            Math.max(\n              0,\n              Math.ceil(((endsAt || Date.now()) - Date.now()) / 1000),\n            ),\n          );\n          setTimeout(() => {\n            serverPrestartRef.current = false;\n          }, 0);\n          // store on joinMatch as prestartEndsAt\n          // reset diffuse state\n          setJoinChoice(null);\n          setRemoteChoices({});\n          setBullActive(false);\n          setBullThrow(null);\n          setBullWinner(null);\n        }\n        if (msg?.type === \"match-start\") {\n          // If the started match matches our current join request, close the modal\n          if (joinMatch && msg.roomId === joinMatch.id) {\n            setJoinMatch(null);\n            setJoinChoice(null);\n            setRemoteChoices({});\n            // (joinPrestart ends were attached to joinMatch; no-op)\n          }\n        }\n        if (msg?.type === \"prestart-choice-notify\") {\n          const { roomId, playerId, choice } = msg;\n          if (!roomId || !choice) return;\n          setRemoteChoices((prev) => ({ ...(prev || {}), [playerId]: choice }));\n        }\n        if (msg?.type === \"prestart-bull\") {\n          setBullActive(true);\n          setBullThrown(false);\n          setBullLocalThrow(null);\n        }\n        if (msg?.type === \"prestart-bull-winner\") {\n          setBullWinner(msg.winnerId || null);\n          setBullActive(false);\n          setBullThrown(false);\n        }\n        if (msg?.type === \"prestart-bull-tie\") {\n          // reset to allow another round\n          setBullWinner(null);\n          setBullActive(false);\n          setBullThrown(false);\n        }\n      } catch (err) {}\n    });\n    return unsub;\n  }, [wsGlobal, joinChoice]);\n\n  // Join timer\n  useEffect(() => {\n    if (!joinMatch) return;\n    if (serverPrestartRef.current) return;\n    // If a server-supplied prestart exists, do not override joinTimer\n    if ((joinMatch as any).prestartEndsAt) return;\n    setJoinTimer(30);\n    setJoinChoice(null);\n    setRemoteChoices({});\n    const t = setInterval(() => setJoinTimer((v) => Math.max(0, v - 1)), 1000);\n    return () => clearInterval(t);\n  }, [joinMatch]);\n\n  // Focus the accept button when the join modal is shown\n  useEffect(() => {\n    if (!joinMatch) return;\n    setTimeout(() => joinAcceptRef.current?.focus(), 0);\n  }, [joinMatch]);\n\n  const handleJoinAccept = () => {\n    // Send accept (invite-response) to server if we have a match prestart\n    try {\n      if (wsGlobal?.connected && joinMatch?.id) {\n        wsGlobal.send({\n          type: \"invite-response\",\n          matchId: joinMatch.id,\n          accept: true,\n          toId: joinMatch.creatorId,\n        });\n      }\n    } catch {}\n    setJoinMatch(null);\n  };\n\n  const requestJoin = (m: any) => {\n    setJoinMatch(m);\n    try {\n      if (wsGlobal?.connected) {\n        wsGlobal.send({ type: \"join-match\", matchId: m.id, calibrated: true });\n      }\n    } catch {}\n  };\n\n  const sendPrestartChoice = (choice: \"bull\" | \"skip\") => {\n    setJoinChoice(choice);\n    try {\n      if (wsGlobal?.connected && joinMatch?.id) {\n        wsGlobal.send({\n          type: \"prestart-choice\",\n          roomId: joinMatch.id,\n          choice,\n        });\n      }\n    } catch {}\n  };\n\n  // No local state for the start showcase; MatchStartShowcase reads from `match.inProgress` directly\n\n  return (\n    <div\n      className=\"flex-1 min-h-0\"\n      style={{ position: \"relative\", marginTop: 0 }}\n    >\n      <div className=\"card ndn-game-shell relative overflow-hidden h-full flex flex-col\">\n        {showStartShowcase && (\n          <MatchStartShowcase\n            players={(players || []) as any}\n            user={user}\n            onDone={() => setShowStartShowcase(false)}\n            onRequestClose={() => setShowStartShowcase(false)}\n          />\n        )}\n        <h2 className=\"text-3xl font-bold text-black dark:text-white mb-4\">\n          Online Play\n        </h2>\n        <div className=\"ndn-shell-body flex-1 overflow-hidden p-3 pb-0\">\n          <div className=\"rounded-xl border border-slate-700 bg-black/10 p-3 flex-1 min-h-0 overflow-hidden flex flex-col\">\n            {/* Top row: Room, New Room, Create Match */}\n            <div className=\"mb-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-between gap-2 flex-wrap\">\n              <div className=\"min-w-0\">\n                <div className=\"text-sm opacity-80\">Room</div>\n                <div className=\"px-3 py-1 bg-white/5 rounded border border-white/10\">\n                  Room ({currentRoom?.id})\n                </div>\n                <div style={{ width: 12 }} />\n                <button className=\"btn btn-ghost\" onClick={newRoom}>\n                  New Room\n                </button>\n              </div>\n              <div className=\"shrink-0 flex items-center gap-2\">\n                <button\n                  className=\"btn btn-primary\"\n                  onClick={() => setShowCreateModal(true)}\n                  disabled={\n                    (currentRoom?.matches?.length || 0) >= maxMatchesPerRoom\n                  }\n                >\n                  Create Match +\n                </button>\n                {(currentRoom?.matches?.length || 0) >= maxMatchesPerRoom && (\n                  <div className=\"text-xs text-rose-400 mt-1\">\n                    Room full — create a new room\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <p className=\"mb-2\" />\n            <div className=\"flex-1 overflow-auto\">\n              <h3 className=\"font-semibold underline mb-3\">\n                Matches in this Room\n              </h3>\n              <div className=\"mb-3 p-3 rounded-xl border border-slate-700 bg-black/10\">\n                <div className=\"mb-4\">\n                  {(combinedMatches.length || 0) === 0 ? (\n                    <div className=\"text-sm opacity-60\">\n                      No matches in this room yet.\n                    </div>\n                  ) : (\n                    <div\n                      className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 max-h-[28rem] overflow-auto\"\n                      data-testid=\"matches-grid\"\n                    >\n                      {combinedMatches.map((m: any) => (\n                        <div\n                          key={m.id}\n                          className=\"p-3 rounded border bg-black/10 flex items-start justify-between h-24\"\n                          data-testid={`match-${m.id}`}\n                        >\n                          <div>\n                            <div className=\"font-semibold text-sm\">\n                              {m.game}{\" \"}\n                              {m.modeType === \"bestof\"\n                                ? \"(Best Of)\"\n                                : \"(First To)\"}{\" \"}\n                              - {m.legs} legs\n                            </div>\n                            {m.startingScore && (\n                              <div className=\"text-xs opacity-80\">\n                                Starting:{\" \"}\n                                <span className=\"font-mono\">\n                                  {m.startingScore}\n                                </span>\n                              </div>\n                            )}\n                            <div className=\"text-xs opacity-70 flex items-center gap-2\">\n                              Created by: {m.createdBy}\n                              {m.roomName && (\n                                <div className=\"ml-2 inline-flex items-center gap-2 text-xs uppercase px-2 py-0.5 rounded-full bg-white/5 border border-white/10\">\n                                  Room: {m.roomName}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"ml-4 shrink-0\">\n                            <button\n                              className=\"btn btn-sm\"\n                              onClick={() => requestJoin(m)}\n                            >\n                              Join Now!\n                            </button>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </div>\n              {/* World Lobby removed: combined matches are displayed above */}\n            </div>\n          </div>\n        </div>\n\n        {/* Create Match modal */}\n        <CreateMatchModal\n          open={showCreateModal}\n          onClose={() => setShowCreateModal(false)}\n          onCreate={(p) => {\n            handleCreateMatch(p);\n            setShowCreateModal(false);\n          }}\n        />\n\n        {/* Join Modal (simplified) */}\n        {joinMatch && (\n          <div\n            role=\"dialog\"\n            aria-modal=\"true\"\n            aria-labelledby=\"join-heading\"\n            tabIndex={-1}\n            className=\"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4\"\n          >\n            <div className=\"bg-slate-800 rounded-2xl p-6 max-w-md w-full\">\n              <div id=\"join-heading\" className=\"text-lg font-bold mb-2\">\n                Join Match\n              </div>\n              <div className=\"mb-3\">\n                {joinMatch.game} - {joinMatch.modeType} • {joinMatch.legs} legs\n              </div>\n              <div className=\"text-sm opacity-80 mb-3\">\n                Created by {joinMatch.createdBy}\n              </div>\n              <div className=\"mb-3\">\n                <GameCalibrationStatus gameMode={joinMatch.game} compact />\n              </div>\n              {joinMatch.startingScore && (\n                <div className=\"mb-3\">\n                  Starting score:{\" \"}\n                  <span className=\"font-mono\">{joinMatch.startingScore}</span>\n                </div>\n              )}\n              {/* Match start showcase overlay */}\n              <MatchStartShowcase\n                open={showStartShowcase}\n                players={players as any}\n                user={user}\n                onRequestClose={() => {}}\n                onDone={() => {}}\n              />\n              <div className=\"mb-3\">\n                Timer: <span className=\"font-mono\">{joinTimer}s</span>\n              </div>\n              {(joinTimer <= 15 || (joinMatch as any)?.prestartEndsAt) && (\n                <div className=\"mb-3\">\n                  Choose:{\" \"}\n                  <div className=\"flex gap-2\">\n                    <button\n                      className={`btn ${joinChoice === \"bull\" ? \"btn-primary\" : \"btn-ghost\"}`}\n                      onClick={() => sendPrestartChoice(\"bull\")}\n                    >\n                      Bull Up\n                    </button>\n                    <button\n                      className={`btn ${joinChoice === \"skip\" ? \"btn-primary\" : \"btn-ghost\"}`}\n                      onClick={() => sendPrestartChoice(\"skip\")}\n                    >\n                      Skip\n                    </button>\n                  </div>\n                  <div className=\"text-xs opacity-70 mt-2\">\n                    {joinChoice\n                      ? `You chose: ${joinChoice}`\n                      : \"Please choose Bull Up or Skip before accepting\"}\n                  </div>\n                  {Object.keys(remoteChoices).length > 0 && (\n                    <div\n                      className=\"text-xs opacity-70 mt-2\"\n                      role=\"status\"\n                      aria-live=\"polite\"\n                    >\n                      {Object.entries(remoteChoices).map(([pid, choice]) => (\n                        <div key={pid}>\n                          {participants[pid] || pid} chose: {choice}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                  {joinChoice === \"skip\" && (\n                    <div className=\"text-xs opacity-70 mt-2\">\n                      Skip requires both players to click Skip. Waiting for\n                      other player…\n                    </div>\n                  )}\n                  {joinChoice === \"skip\" &&\n                    Object.values(remoteChoices).some((c) => c === \"skip\") && (\n                      <div className=\"text-sm font-semibold mt-2\">\n                        Both players skipped — Left player throws first\n                      </div>\n                    )}\n                  {bullActive && (\n                    <div className=\"text-xs opacity-70 mt-2\">\n                      Bull Up active —\n                      {bullThrown\n                        ? ` you threw ${bullLocalThrow ?? 50}`\n                        : \" throw to win the bull!\"}\n                    </div>\n                  )}\n                  {bullActive && !bullThrown && (\n                    <div className=\"flex items-center gap-2 mt-2\">\n                      <input\n                        className=\"input input-sm\"\n                        aria-label=\"bull-throw\"\n                        type=\"number\"\n                        min={0}\n                        max={50}\n                        value={bullThrow ?? 50}\n                        onChange={(e) =>\n                          setBullThrow(\n                            Math.max(\n                              0,\n                              Math.min(50, Number(e.target.value || 0)),\n                            ),\n                          )\n                        }\n                      />\n                      <button\n                        className=\"btn btn-primary\"\n                        onClick={() => {\n                          try {\n                            if (wsGlobal?.connected && joinMatch?.id)\n                              wsGlobal.send({\n                                type: \"prestart-bull-throw\",\n                                roomId: joinMatch.id,\n                                score: bullThrow ?? 50,\n                              });\n                          } catch {}\n                          setBullLocalThrow(bullThrow ?? 50);\n                          setBullThrown(true);\n                        }}\n                      >\n                        Throw Bull\n                      </button>\n                    </div>\n                  )}\n                  {bullThrown && (\n                    <div className=\"text-sm font-semibold mt-2 animate-pulse\">\n                      You threw: {bullLocalThrow ?? 50}\n                    </div>\n                  )}\n                  {bullWinner && (\n                    <div className=\"text-sm font-semibold mt-2\">\n                      Bull winner: {bullWinner}\n                    </div>\n                  )}\n                </div>\n              )}\n              <div className=\"flex items-center gap-2\">\n                <button\n                  ref={joinAcceptRef}\n                  aria-label=\"Accept invitation\"\n                  className=\"btn btn-primary\"\n                  onClick={handleJoinAccept}\n                  disabled={joinTimer <= 15 && !joinChoice}\n                >\n                  Accept\n                </button>\n                <button\n                  className=\"btn btn-ghost\"\n                  onClick={() => {\n                    setJoinMatch(null);\n                  }}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["CreateMatchModal","open","onClose","onCreate","portalEl","useState","game","setGame","modeType","setModeType","legs","setLegs","legsRef","useRef","avgChoice","setAvgChoice","startingScore","setStartingScore","getStartOptionsForGame","user","useUserSettings","useLayoutEffect","onKey","e","handleCreate","createPortal","jsxs","jsx","v","opts","allGames","g","opt","prev","base","OnlinePlayClean","username","currentRoomIdx","setCurrentRoomIdx","rooms","setRooms","wsGlobal","useWS","serverMatches","setServerMatches","inProgress","useMatch","s","players","showStartShowcase","setShowStartShowcase","startedShowcasedRef","React","useEffect","showCreateModal","setShowCreateModal","joinMatch","setJoinMatch","joinAcceptRef","selfId","setSelfId","participants","setParticipants","joinTimer","setJoinTimer","serverPrestartRef","joinChoice","setJoinChoice","remoteChoices","setRemoteChoices","bullActive","setBullActive","bullThrow","setBullThrow","bullWinner","setBullWinner","bullLocalThrow","setBullLocalThrow","bullThrown","setBullThrown","currentRoom","maxMatchesPerRoom","worldLobby","useMemo","r","m","combinedMatches","local","ids","others","handleCreateMatch","payload","newMatch","idx","newRoom","id","newRooms","msg","endsAt","roomId","playerId","choice","handleJoinAccept","requestJoin","sendPrestartChoice","MatchStartShowcase","p","GameCalibrationStatus","pid","c"],"mappings":"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"}