import{h as yl,j as e,B as Qe,b as wl,u as Sl,i as kl,e as Cl,k as Dl,l as Ps,m as Jt,r as Xa,n as Ya,p as Al,R as es,G as Ml,P as Ll,o as qa,q as Ae,C as L,t as Tl,v as Rl,w as El,x as Il,f as Pl,y as Bl}from"./index-jnU-qcsE.js";import{r}from"./ui-C3zlW9wh.js";import{M as Fl,G as Vl,C as Ol}from"./MatchStartShowcase-4KbOzekC.js";import{f as On}from"./stats-X3jz_E9o.js";import{M as Hl}from"./MatchControls-Pz17XM_b.js";import"./vendor-D3F3s8fL.js";const Hn={UNDO:["undo","back","correction","oops","mistake"],BUST:["bust","busted","no score"],NEXT:["next","switch","done","finish"]},Bs={zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20,thirty:30,forty:40,fifty:50,sixty:60,bull:50,bullseye:50,"double bull":50,"inner bull":50,"red bit":50,"outer bull":25,"twenty five":25,"twenty-five":25,"green bit":25,top:20},Qa={twenty:20,thirty:30,forty:40,fifty:50,sixty:60,seventy:70,eighty:80,ninety:90},Ul={single:"S",double:"D",triple:"T",treble:"T"};function $l(n){const i=n.replace(/-/g," ").replace(/\band\b/g," ").trim();if(Bs[i]!==void 0)return Bs[i];const d=parseInt(i,10);if(!isNaN(d))return d;const m=i.split(/\s+/);let l=0,c=0;for(const f of m)if(f==="hundred")c=(c||1)*100;else if(Qa[f])l+=c,c=Qa[f];else if(Bs[f])c+=Bs[f];else return null;return l+c}function _l(n){const i=n.toLowerCase().trim();if(Hn.UNDO.some(c=>i.includes(c)))return{type:"command",value:"undo"};if(Hn.BUST.some(c=>i.includes(c)))return{type:"command",value:"bust"};if(Hn.NEXT.some(c=>i.includes(c)))return{type:"command",value:"next"};let d="S",m=i;for(const[c,f]of Object.entries(Ul))if(m.startsWith(c)){d=f,m=m.replace(c,"").trim();break}const l=$l(m);if(l!==null){if(i.includes("top")&&d==="D")return{type:"dart",value:"D20"};if(l===50||l===25)return{type:"dart",value:l.toString()};if(d!=="S"&&l>=1&&l<=20)return{type:"dart",value:`${d}${l}`};if(d==="S")return l>=1&&l<=20?{type:"dart",value:`S${l}`}:{type:"visit_score",value:l}}return{type:"unknown",value:n}}function Kl(n){const[i,d]=r.useState(!1),[m,l]=r.useState(null),[c,f]=r.useState(""),P=r.useRef(null);r.useEffect(()=>{if(typeof window<"u"){const T=window.SpeechRecognition||window.webkitSpeechRecognition;if(T){const M=new T;M.continuous=!1,M.interimResults=!1,M.lang="en-US",M.onstart=()=>{d(!0),l(null)},M.onend=()=>{d(!1)},M.onerror=V=>{console.error("Speech recognition error",V.error),V.error==="not-allowed"?l("Microphone access denied"):V.error==="no-speech"||l(`Error: ${V.error}`),d(!1)},M.onresult=V=>{const B=V.results[0][0].transcript;f(B);const S=_l(B);n(S)},P.current=M}else l("Voice not supported in this browser")}},[n]);const z=r.useCallback(()=>{if(!P.current){l("Browser not supported");return}if(i)P.current.stop();else{l(null),f("");try{P.current.start()}catch(T){console.error("Failed to start recognition",T)}}},[i]);return{isListening:i,toggleListening:z,error:m,transcript:c,supported:!!P.current}}function Za(n,i,d,m){const l=(m-90)*Math.PI/180;return{x:n+d*Math.cos(l),y:i+d*Math.sin(l)}}function Ja(n){return[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5].indexOf(n)*18+9}function Wl({width:n=320,height:i=320}){const d=yl(l=>l.samples),m=r.useRef(null);return r.useEffect(()=>{const l=m.current;if(!l)return;const c=l.getContext("2d");if(!c)return;l.width=n,l.height=i,c.clearRect(0,0,n,i);const f=n/2,P=i/2,z=Math.min(n,i)/(Qe.doubleOuter*2+20),T={bullInner:Qe.bullInner*z,bullOuter:Qe.bullOuter*z,trebleInner:Qe.trebleInner*z,trebleOuter:Qe.trebleOuter*z,doubleInner:Qe.doubleInner*z,doubleOuter:Qe.doubleOuter*z};c.strokeStyle="rgba(255,255,255,0.06)",c.lineWidth=1;const M=["doubleOuter","doubleInner","trebleOuter","trebleInner","bullOuter","bullInner"];for(const S of M)c.beginPath(),c.arc(f,P,T[S],0,Math.PI*2),c.stroke();const V=[];for(const S of d){let E=Math.random()*360,se=Math.random()*T.doubleOuter;typeof S.sector=="number"&&S.sector>=1&&S.sector<=20&&(E=Ja(S.sector),S.ring==="DOUBLE"?se=(T.doubleInner+T.doubleOuter)/2:S.ring==="TRIPLE"?se=(T.trebleInner+T.trebleOuter)/2:S.ring==="INNER_BULL"?se=T.bullInner*.5:S.ring==="BULL"?se=T.bullOuter*.8:se=(T.trebleOuter+T.doubleInner)/2*(.6+Math.random()*.4));const y=Za(f,P,se,E);V.push({x:y.x,y:y.y,w:1})}for(const S of V){const E=c.createRadialGradient(S.x,S.y,1,S.x,S.y,60);E.addColorStop(0,"rgba(255,0,0,0.9)"),E.addColorStop(.3,"rgba(255,100,0,0.5)"),E.addColorStop(1,"rgba(255,100,0,0)"),c.fillStyle=E,c.beginPath(),c.arc(S.x,S.y,60,0,Math.PI*2),c.fill()}c.fillStyle="rgba(255,255,255,0.85)",c.font="12px ui-sans-serif";const B={};for(const S of d)S.sector&&(B[S.sector]=(B[S.sector]||0)+1);for(const S of Object.keys(B)){const E=Number(S),se=Ja(E),y=Za(f,P,T.trebleOuter+18,se);c.fillText(String(B[E]),y.x-6,y.y+4)}},[d,n,i]),e.jsx("canvas",{ref:m,style:{width:"100%",height:"auto",borderRadius:8,background:"#081018"}})}const Fs=[...Array.from({length:20},(n,i)=>({label:`D${i+1}`,score:(i+1)*2})),{label:"DBULL",score:50,isBull:!0}];function ei(n,i){const d=Fs[i];return!!d&&n===d.score}function Ze(n){const i=n.trim().toUpperCase();if(!i)return null;if(i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL")return 50;if(i==="25"||i==="OBULL")return 25;const d=i.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!d)return null;const m=d[1]||"S",l=parseInt(d[2],10);return l<1||l>20?null:l*(m==="S"?1:m==="D"?2:3)}const He=[...Array.from({length:20},(n,i)=>i+1),25,50],Zn=[20,19,18,17,16,15,25];function Un(){const n={};return Zn.forEach(i=>{n[i]=0}),{marks:n,points:0}}function Gl(n,i,d,m,l=()=>!1){let c=null,f=0;if(d==="BULL"||d==="INNER_BULL"||i===25||i===50)c=25,f=d==="INNER_BULL"||i===50?2:1;else if(typeof m=="number"&&m>=15&&m<=20)c=m,d==="TRIPLE"?f=3:d==="DOUBLE"?f=2:f=1;else if(i){const S=[20,19,18,17,16,15];for(const E of S){if(i===E){c=E,f=1;break}if(i===E*2){c=E,f=2;break}if(i===E*3){c=E,f=3;break}}!c&&(i===25||i===50)&&(c=25,f=i===50?2:1)}if(!c)return 0;const P=n.marks[c],z=Math.max(0,3-P),T=Math.min(z,f),M=Math.max(0,f-T),V=P+T;n.marks[c]=V>3?3:V;let B=0;return M>0&&!l(c)&&(c===25?d==="INNER_BULL"?B+=50*M:B+=25*M:B+=c*M),n.points+=B,B}function zl(n){return Zn.every(i=>(n.marks[i]||0)>=3)}function $n(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function Xl(n){return n.round}function Yl(n,i,d,m){if(n.finished)return 0;const l=Xl(n);let c=0;return typeof m=="number"&&m===l?d==="TRIPLE"?(c=l*3,n.turnHits.triples++):d==="DOUBLE"?(c=l*2,n.turnHits.doubles++):d==="SINGLE"&&(c=l*1,n.turnHits.singles++):!m&&(i===l||i===l*2||i===l*3)&&(i===l*3?(c=l*3,n.turnHits.triples++):i===l*2?(c=l*2,n.turnHits.doubles++):i===l&&(c=l,n.turnHits.singles++)),n.score+=c,c}function ql(n){if(!n.finished){if(n.turnHits.singles>0&&n.turnHits.doubles>0&&n.turnHits.triples>0){n.shanghaiAchieved=!0,n.finished=!0;return}const i=n.round+1;i>20?n.finished=!0:n.round=i}n.turnHits={singles:0,doubles:0,triples:0}}function _n(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function ui(n){return n.targets[n.stage]||null}function Ql(n,i,d,m){if(n.finished)return 0;const l=ui(n);if(!l)return 0;let c=0;switch(l.kind){case"NUMBER":{typeof m=="number"&&m===l.num?d==="TRIPLE"?c=l.num*3:d==="DOUBLE"?c=l.num*2:d==="SINGLE"&&(c=l.num):!m&&(i===l.num||i===l.num*2||i===l.num*3)&&(c=i),c>0&&(n.hitThisRound=!0);break}case"DOUBLE":{(d==="DOUBLE"&&m===l.num||i===l.num*2)&&(c=l.num*2,n.hitThisRound=!0);break}case"TRIPLE":{(d==="TRIPLE"&&m===l.num||i===l.num*3)&&(c=l.num*3,n.hitThisRound=!0);break}case"BULL":{(d==="BULL"||d==="INNER_BULL"||i===25||i===50)&&(c=d==="INNER_BULL"||i===50?50:25,n.hitThisRound=!0);break}case"ANY_NUMBER":{i>0&&(c=i,n.hitThisRound=!0);break}}return n.score+=c,c}function Zl(n){n.finished||(n.hitThisRound||(n.score=Math.floor(n.score/2)),n.hitThisRound=!1,n.stage+=1,n.stage>=n.targets.length&&(n.finished=!0))}function Kn(){return{round:1,score:0,target:"HIGH",finished:!1}}function Jl(n,i,d,m){if(n.finished)return 0;let l=0;if(n.target==="HIGH")if(d==="INNER_BULL")l=50;else if(typeof m=="number"){const f=m*(d==="TRIPLE"?3:d==="DOUBLE"?2:1);m>=20&&(l=f)}else i>=40&&(l=i);else if(typeof m=="number"){const f=m*(d==="TRIPLE"?3:d==="DOUBLE"?2:1);m<=10&&(l=f)}else i>0&&i<=30&&(l=i);return n.score+=l,l}function eo(n){if(!n.finished){if(n.round+=1,n.round>10){n.finished=!0;return}n.target=n.target==="HIGH"?"LOW":"HIGH"}}function to(n,i=3){return{number:n,lives:i,isKiller:!1,eliminated:!1}}function so(n){const i=Array.from({length:20},(m,l)=>l+1),d={};for(const m of n){const l=Math.floor(Math.random()*i.length),c=i.splice(l,1)[0];d[m]=c}return d}function ti(n,i,d,m){const l=i[n];if(!l||!m||!d)return{becameKiller:!1};if(!l.isKiller&&d==="DOUBLE"&&m===l.number)return l.isKiller=!0,{becameKiller:!0};if(l.isKiller&&(d==="DOUBLE"||d==="TRIPLE")){const c=Object.keys(i).find(f=>f!==n&&!i[f].eliminated&&i[f].number===m);if(c){const f=i[c],P=d==="TRIPLE"?2:1;return f.lives=Math.max(0,f.lives-P),f.lives===0&&(f.eliminated=!0),{becameKiller:!1,victimId:c,livesRemoved:P}}}return{becameKiller:!1}}function si(n){const i=Object.entries(n).filter(([,d])=>!d.eliminated&&d.lives>0);return i.length===1?i[0][0]:null}function ni(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function no(n,i,d,m){if(n.finished)return 0;let l=0;if(typeof m=="number"&&m===n.inning?d==="TRIPLE"?l=3:d==="DOUBLE"?l=2:l=1:!m&&(i===n.inning||i===n.inning*2||i===n.inning*3)&&(l=i===n.inning*3?3:i===n.inning*2?2:1),n.score+=l,n.dartsThisInning+=1,n.dartsThisInning>=3){const c=n.inning+1;c>9?n.finished=!0:(n.inning=c,n.dartsThisInning=0)}return l}const ro={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function ri(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function ao(n,i,d,m){if(n.finished)return!1;const l=ro[n.hole];if(n.dartsThisHole+=1,typeof m=="number"&&m===l&&(d==="SINGLE"||d==="DOUBLE"||d==="TRIPLE")||!m&&(i===l||i===l*2||i===l*3)){n.strokes+=n.dartsThisHole;const f=n.hole+1;return f>18?n.finished=!0:(n.hole=f,n.dartsThisHole=0),!0}if(n.dartsThisHole>=3){n.strokes+=3;const f=n.hole+1;f>18?n.finished=!0:(n.hole=f,n.dartsThisHole=0)}return!1}const mi={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function ai(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function io(n){const i=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[d,m,l]of i)if(n[d]&&n[d]===n[m]&&n[d]===n[l])return n[d];return n.every(d=>d)?"Draw":null}function lo(n,i,d,m,l){if(n.finished||n.board[i])return!1;const c=mi[i];let f=!1;if(c.type==="BULL"?f=m==="BULL"||m==="INNER_BULL"||d===25||d===50:c.type==="NUM"&&typeof c.num=="number"&&(typeof l=="number"&&l===c.num||!l&&(d===c.num||d===c.num*2||d===c.num*3))&&(f=!0),!f)return!1;n.board[i]=n.turn;const P=io(n.board);return P?(n.finished=!0,n.winner=P,!0):(n.turn=n.turn==="X"?"O":"X",!0)}function Gn(){return{targetIndex:0,darts:0,finished:!1}}const xi=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],Wn=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function oo(n){return xi[n.targetIndex]}function zn(n,i,d){if(n.finished)return n;const m=oo(n);if(!(d==="SINGLE"&&i===m||d==="DOUBLE"&&i===m||d==="TRIPLE"&&i===m||d==="INNER_BULL"&&m===25))return n;const c=n.targetIndex+1,f=c>=xi.length;return{targetIndex:c,darts:n.darts+1,finished:f}}function ii(n,i){return zn(n,i,"SINGLE")}function co(){return Gn()}function Xn(n=50){return{score:0,darts:0,finished:!1,target:n}}const uo=[5,10,15,20,25,50];function mo(n){return uo.includes(n)}function Yn(n,i,d){if(n.finished)return n;if(!mo(i))return{...n,darts:n.darts+1};const m=n.score+i,l=m>=n.target;return{score:l?n.target:m,darts:n.darts+1,finished:l,target:n.target}}function li(n,i){return Yn(n,i)}function xo(n=50){return Xn(n)}function qn(n=70){return{score:0,darts:0,finished:!1,target:n}}const ho=[7,14,21];function fo(n){return ho.includes(n)}function Qn(n,i,d){if(n.finished)return n;if(!fo(i))return{...n,darts:n.darts+1};const m=n.score+i,l=m>=n.target;return{score:l?n.target:m,darts:n.darts+1,finished:l,target:n.target}}function oi(n,i){return Qn(n,i)}function po(n=70){return qn(n)}const Jn=[20,19,18,17,16,15,14,13,12,25];function ci(){const n={};return Jn.forEach(i=>{n[i]=0}),{marks:n,points:0}}function bo(n,i,d,m,l=()=>!1){let c=null,f=0;if(d==="BULL"||d==="INNER_BULL"||i===25||i===50)c=25,f=d==="INNER_BULL"||i===50?2:1;else if(typeof m=="number"&&m>=12&&m<=20)c=m,d==="TRIPLE"?f=3:d==="DOUBLE"?f=2:f=1;else if(i){for(const S of[20,19,18,17,16,15,14,13,12]){if(i===S){c=S,f=1;break}if(i===S*2){c=S,f=2;break}if(i===S*3){c=S,f=3;break}}!c&&(i===25||i===50)&&(c=25,f=i===50?2:1)}if(!c)return 0;const P=n.marks[c],z=Math.max(0,3-P),T=Math.min(z,f),M=Math.max(0,f-T),V=P+T;n.marks[c]=V>3?3:V;let B=0;return M>0&&!l(c)&&(c===25?d==="INNER_BULL"?B+=50*M:B+=25*M:B+=c*M),n.points+=B,B}function go(n){return Jn.every(i=>(n.marks[i]||0)>=3)}function q(n){return(i,d)=>{n(i)}}function vo(n){const{match:i,commitManualVisitTotal:d,endTurn:m}=n;return{addVisit:(l,c=3,f)=>{if(d){d(l);return}try{i.addVisit(l,c,f)}catch{i.addVisit(l,c)}},undoVisit:()=>{i.undoVisit()},nextPlayer:()=>{if(m)try{m(0)}catch{i.nextPlayer()}else i.nextPlayer()},endLeg:l=>{typeof l=="number"?i.endLeg(l):i.endLeg(0)},endGame:()=>{i.endGame()}}}function Je(n,i,d,m,l,c,f,P,z,T,M,V,B,S,E,se,y,be,ye,he,er,jt,Ie,et,ts,ss,ns){return r.useMemo(()=>{const ue=[];if(n==="X01"){let k=0,me=0,x=0;if(be&&be.length>0){for(const ge of be)ge.dartsThrown&&ge.totalScored&&(me+=ge.dartsThrown,x+=ge.totalScored);me>0&&(k=x/me*3)}const Hs=(V??0)>0?P??0:T??null??(c??0);if(ue.push({name:"You",isCurrentTurn:!!ye,legsWon:m||0,score:i||0,lastScore:Hs,checkoutRate:E&&E>0?Math.round((S||0)/E*100):0,bestLeg:be&&be.length>0?`${Math.min(...be.map(ge=>ge.doubleDarts+(ge.checkoutDarts||0)))||0} darts`:"â€”",matchAvg:k,allTimeAvg:wl("You")||0}),he&&he!=="None"){const W=(B??0)>0?z??0:M??null??(f??0);ue.push({name:`${he} AI`,isCurrentTurn:!ye,legsWon:l||0,score:d||0,lastScore:W,checkoutRate:y&&y>0?Math.round((se||0)/y*100):0,bestLeg:"â€”"})}}return n==="Cricket"&&(ue.push({name:"You",isCurrentTurn:!!ye,closed:jt?.marks||{},points:jt?.points||0}),he&&he!=="None"&&ue.push({name:`${he} AI`,isCurrentTurn:!ye,closed:{},points:0})),n==="Shanghai"&&(ue.push({name:"You",isCurrentTurn:!!ye,round:Ie?.round||1,target:Ie?.target||1,score:Ie?.score||0}),he&&he!=="None"&&ue.push({name:`${he} AI`,isCurrentTurn:!ye,round:Ie?.round||1,target:Ie?.target||1,score:0})),n==="Killer"&&et&&et.length>0&&et.forEach((k,me)=>{const x=ts?.[k.id];ue.push({name:k.name,isCurrentTurn:me===ns,number:ss?.[k.id],lives:x?.lives||0,eliminated:x?.eliminated||!1})}),ue},[n,i,d,m,l,c,f,P,z,T,M,V,B,S,E,se,y,be,ye,he,jt,Ie,et,ts,ss,ns])}const di=r.memo(L),jo=["Easy","Medium","Hardened"],No=6500;function Ee(n,i,d){return Math.max(i,Math.min(d,n))}function yo(n,i){let d=0;if(i==="Easy"){const m=[22,26,41,45,60];d=m[Math.floor(Math.random()*m.length)]}else i==="Medium"?d=Math.round(Ee(60+(Math.random()*30-15),30,100)):d=Math.round(Ee(80+(Math.random()*20-10),50,120));return n<=0?0:d>n?[100,85,81,60,57,45,41,26,22,20,1].find(l=>l<=n)??0:d}function wo({onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:n,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const So=Pl();function Go({user:n}){const{offlineLayout:i,favoriteDouble:d,callerEnabled:m,callerVoice:l,callerVolume:c,speakCheckoutOnly:f,rememberLastOffline:P,setLastOffline:z,autoStartOffline:T,cameraScale:M,setCameraScale:V,cameraAspect:B="wide",setCameraAspect:S,cameraFitMode:E="fill",setCameraFitMode:se,cameraEnabled:y,textSize:be,boxSize:ye,autoscoreProvider:he,autoCommitMode:er="wait-for-clear",matchType:jt="singles",setMatchType:Ie,teamAName:et="Team A",setTeamAName:ts,teamBName:ss="Team B",setTeamBName:ns}=Sl(),ue=he==="manual",k=y&&!ue,me=y&&!ue&&er!=="immediate",[x,Vs]=r.useState("X01"),[C,Os]=r.useState(501),[A,tr]=r.useState("None"),[Hs,ge]=r.useState(!1),[Us,tt]=r.useState(!1),[U,X]=r.useState(C),[W,Nt]=r.useState(C),[ko,sr]=r.useState(!1),[nr,le]=r.useState(!1),[yt,rr]=r.useState(1),[$,rs]=r.useState(0),Q=kl(),[hi,ar]=r.useState(!1),ir=r.useRef(!1),[G,as]=r.useState(0),[is,oe]=r.useState(null),[lr,fi]=r.useState(1),[or,pi]=r.useState(1),[ve,cr]=r.useState([]),[dr,bi]=r.useState(2e3),fe=Cl(),[$s,st]=r.useState(!1),[gi,wt]=r.useState(!1),vi=Dl(t=>t.setPaused);r.useEffect(()=>{const t=()=>{st(!1),tt(!1),wt(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[St,ur]=r.useState(i==="modern"),[kt,mr]=r.useState(i==="modern");r.useEffect(()=>{ur(i==="modern"),mr(i==="modern")},[i]),r.useEffect(()=>{E!=="fit"&&se("fit")},[E,se]);const[ls,xr]=r.useState(1),[Co,hr]=r.useState(!1),[I,Ct]=r.useState(!0),[Dt,ji]=r.useState(()=>typeof window<"u"&&window.innerWidth<768),[fr,_s]=r.useState(!1);r.useEffect(()=>{if(typeof window>"u")return;const t=()=>ji(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),r.useEffect(()=>{Dt||_s(!1)},[Dt]),r.useEffect(()=>{const t=()=>xt(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[D,w]=r.useState(0),[At,Ks]=r.useState(0),[Ws,Gs]=r.useState(0),[Ue,pr]=r.useState(0),[br,gr]=r.useState(0),[Mt,zs]=r.useState(Un()),[os,cs]=r.useState($n()),[Lt,ds]=r.useState(_n()),[us,ms]=r.useState(Kn()),[Do,pe]=r.useState(0),[vr,jr]=r.useState(1),[Ni,Xs]=r.useState(27),[Ao,Nr]=r.useState(0),[yi,Ys]=r.useState(0),[yr,wr]=r.useState(!1),[Sr,kr]=r.useState(1),[wi,Cr]=r.useState(0),[Mo,Dr]=r.useState(0),Si=8,[Ar,Mr]=r.useState(1),[ki,Lr]=r.useState(0),[Lo,Tr]=r.useState(0),Ci=10,[Rr,Er]=r.useState(1),[Di,Ir]=r.useState(0),[To,Pr]=r.useState(0),Ai=10,[qs,Qs]=r.useState(170),[Br,Fr]=r.useState(0),[Vr,Or]=r.useState(0),[Hr,Ur]=r.useState(0),[Zs,Js]=r.useState(121),[$r,_r]=r.useState(0),[Kr,Wr]=r.useState(0),[Gr,zr]=r.useState(0),[$e,en]=r.useState(20),[tn,sn]=r.useState(0),[Xr,nn]=r.useState(0),[Tt,Mi]=r.useState(30),[Yr,rn]=r.useState(!1),[qr,Qr]=r.useState(ni()),[Zr,Jr]=r.useState(ri()),[_e,ea]=r.useState(ai()),[an,ta]=r.useState(ci()),[O,ln]=r.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[Rt,Et]=r.useState({}),[xs,on]=r.useState({}),[sa,cn]=r.useState(!1),[we,nt]=r.useState(0),[Ro,rt]=r.useState(0),[at,It]=r.useState(null),[Li,Me]=r.useState(""),[hs,Eo]=r.useState(Gn()),[Ke,Pt]=r.useState(Gn()),[Bt,Io]=r.useState(Xn(50)),[je,Ft]=r.useState(Xn(50)),[Vt,Po]=r.useState(qn(70)),[Ne,Ot]=r.useState(qn(70)),[fs,We]=r.useState(0),[Le,Pe]=r.useState(0),[_,Z]=r.useState(0),[dn,Ht]=r.useState(C),[Se,ce]=r.useState(0),[it,Te]=r.useState(null),[ps,ne]=r.useState(0),Ge=r.useRef(0),Ti=r.useRef(0),re=r.useRef(U),J=r.useRef(_),ae=r.useRef(Se),ze=r.useRef(dn),ee=r.useRef(ps);r.useEffect(()=>{re.current=U},[U]),r.useEffect(()=>{J.current=_},[_]),r.useEffect(()=>{ae.current=Se},[Se]),r.useEffect(()=>{ze.current=dn},[dn]),r.useEffect(()=>{ee.current=ps},[ps]);const[Ri,Ut]=r.useState(0);r.useRef(null);const[bs,un]=r.useState(0),[Xe,gs]=r.useState(0),[lt,Ye]=r.useState(0),[ot,Re]=r.useState(0),[ct,dt]=r.useState(null),[mn,ut]=r.useState(0),[$t,_t]=r.useState(0),[xn,vs]=r.useState(0),[Kt,na]=r.useState(0),[hn,ra]=r.useState(0),[Wt,mt]=r.useState(0),[Gt,aa]=r.useState(0),[fn,zt]=r.useState(0),[pn,ia]=r.useState(0),[la,js]=r.useState(0),[Ei,Ns]=r.useState(0),[Ii,ys]=r.useState(0),[oa,bn]=r.useState(0),[Pi,gn]=r.useState(0),[Bi,vn]=r.useState(0),[Fi,ws]=r.useState(0),[Vi,ca]=r.useState(0),[Oi,jn]=r.useState(!1),[te,Y]=r.useState(""),[Nn,Xt]=r.useState(""),[Bo,Fo]=r.useState(""),[da,ua]=r.useState(""),[ma,yn]=r.useState(""),[xa,wn]=r.useState(""),[Ss,Sn]=r.useState(null),[Hi,xt]=r.useState(!1),[Ui,ha]=r.useState({}),[$i,Yt]=r.useState(!1),Be=r.useRef(null),kn=r.useRef(null),ke=r.useCallback(()=>{const t=kn.current;t&&(clearTimeout(t),kn.current=null)},[]),fa=r.useCallback(t=>{if(!m)return;const s=n?.username||"Player";try{Ps(s,t.visitTotal,Math.max(t.remaining,0),l,{volume:c,checkoutOnly:f})}catch{}},[m,l,c,f,n?.username]),ks=r.useCallback((t,s)=>{Yt(!1);const{visitTotal:a,darts:o,preRemaining:u,remaining:g,doubleAttempts:b,finished:N,doubleWindow:p,highestCheckout:v}=t;N?(X(0),re.current=0,typeof v=="number"&&v>0&&ws(h=>Math.max(h,v))):(X(g),re.current=g),Te(a),a===180?js(h=>h+1):a>=140?Ns(h=>h+1):a>=100&&ys(h=>h+1),p&&b>0&&(_t(h=>h+b),N&&vs(h=>h+1)),t.announced||fa(t);try{Jt.getState().recordVisit("offline-x01",o,a,{preRemaining:u,postRemaining:N?0:g,finish:N,bust:!1})}catch{}N&&(oe("player"),le(!0)),vt(N?0:g),ce(0),ae.current=0,Z(0),J.current=0,ne(0),ee.current=0},[vt,ws,oe,X,Te,ce,Z,ne,le,js,Ns,ys,_t,vs,fa]),ht=r.useCallback(t=>{const s=Be.current;s&&(Be.current=null,ke(),ks(s,t))},[ke,ks]),pa=r.useCallback(t=>{Be.current={...t,announced:!1},Yt(!0),ke(),kn.current=setTimeout(()=>ht("timeout"),No)},[ke,ht]);r.useEffect(()=>{if(!me)return;const t=()=>ht("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[me,ht]),r.useEffect(()=>{me||ht("timeout")},[me,ht]),r.useEffect(()=>()=>ke(),[ke]),r.useEffect(()=>{if(_===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}Ge.current=0}Ti.current=_},[_]);const Ce=n?.username||"Player 1",Fe=A==="None"?"Player 2":A,_i=I?Ce:Fe,Ki=I?Fe:Ce,Wi=I?$:G,Gi=I?G:$,Cs=Je("X01",U,W,$,G,Le,Xe,Se,lt,it,ct,_,ot,xn,$t,hn,Kt,ve,I,A),zi=Je("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Mt),Xi=Je("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,I,A,void 0,Mt,os),Yi=Je("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,O,Rt,xs,we),qi=Je("Scam"),Qi=Je("Fives"),Zi=Je("Sevens"),Ds=r.useMemo(()=>{const t=Cs||[],s=_>0?Se:it??Le,a=ot>0?lt:ct??Xe;return t.length===0?{name:I?Ce:Fe,isCurrentTurn:!0,legsWon:I?$:G,score:I?U:W,lastScore:I?s:a}:t.find(o=>o.isCurrentTurn)??t[0]},[Cs,I,Ce,Fe,$,G,U,W,_,Se,it,Le,lt,ct,Xe,ot]),ba=r.useMemo(()=>{if(!Ds)return[];const{matchAvg:t,allTimeAvg:s,...a}=Ds;return[{...a,matchAvg:void 0,allTimeAvg:void 0}]},[Ds]),Ji=I?Fe:Ce,el=Ds?.name??(I?Ce:Fe),ga=I?U:W,va=I?_>0?Se:it??Le:ot>0?lt:ct??Xe,As=Q.players?.[Q.currentPlayerIdx];let tl=0,sl=0;if(As&&As.legs&&As.legs.length>0){for(const t of As.legs)if(Array.isArray(t.visits))for(const s of t.visits)tl+=s.score||0,sl+=s.darts||0}const R=r.useCallback((t,s=1)=>{!t||s<=0||ha(a=>({...a,[t]:(a[t]||0)+s}))},[]),F=r.useCallback(t=>{t&&ha(s=>s[t]===void 0?s:{...s,[t]:0})},[]);Ui[x];const nl=t=>{if(!t.trim())return null;const s=Number(t);return Number.isFinite(s)?Ee(Math.round(s),0,C):null},rl=t=>{if(!t.trim())return null;const s=Number(t);return Number.isFinite(s)?Math.max(0,Math.round(s)):null},ja=r.useCallback(()=>{Be.current&&(Be.current=null),ke(),Yt(!1)},[ke]);r.useCallback(t=>{const s=Ee(t,0,C);ja(),X(s),re.current=s;const a=s===0?C:s;Ht(a),ze.current=a,ce(0),ae.current=0,Z(0),J.current=0,ne(0),ee.current=0,Te(null),Pe(0),w(0),Ge.current=0,s===0?(oe("player"),le(!0)):(oe(null),le(!1))},[ja,X,C,Ht,ce,Z,ne,Te,Pe,w,oe,le]);const Na=t=>{const a=nl(da);if(a===null){fe(`Enter a number between 0 and ${C}`,{type:"error",timeout:2500});return}Nt(a),Ye(0),Re(0),dt(null),ut(0),gs(0),ua(""),oe(null),le(!1)},ya=r.useCallback((t,s)=>{t==="player"?(rs(s),yn("")):(as(s),wn("")),oe(null),le(!1)},[as,wn,yn,oe,rs,le]),Ms=t=>{const a=rl(t==="player"?ma:xa);if(a===null){fe("Enter a non-negative whole number for legs",{type:"error",timeout:2500});return}Sn({target:t,value:a,stage:1})},al=r.useCallback(()=>{Sn(t=>t&&(t.stage===1?{...t,stage:2}:(ya(t.target,t.value),null)))},[ya]),qt=r.useCallback(()=>{Sn(null)},[]);r.useEffect(()=>{if(!Ss)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),qt())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[qt,Ss]);const Ve=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(be),ft=r.useRef(null),pt=r.useRef(null),Cn=r.useRef(null),[bt,Dn]=r.useState("first"),[Ls,wa]=r.useState(1),il=r.useRef(null);r.useEffect(()=>{const t=Math.max(1,Math.floor(Number(Ls)||1)),s=bt==="first"?t:Math.max(1,Math.ceil(t/2));rr(s)},[bt,Ls]),r.useEffect(()=>{if(!kt){xr(1),hr(!1);return}const t=()=>{const o=ft.current,u=pt.current;if(!o||!u)return;const g=Cn.current?Cn.current.getBoundingClientRect().height:0,b=Math.max(0,o.clientHeight-g-6),N=Math.max(0,o.clientWidth-8),p=u.getBoundingClientRect(),v=ls||1,h=p.height/v,j=p.width/v,ie=b>0?b/h:1,De=N>0?N/j:1,Oe=Math.min(1,Math.max(.5,Math.min(ie,De))),de=h*Oe,K=b>0&&de-b>1;hr(K),xr(Oe)};t();const s=window.ResizeObserver,a=s?new s(()=>t()):null;return a&&ft.current&&a.observe(ft.current),a&&pt.current&&a.observe(pt.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{a&&ft.current&&a.unobserve(ft.current)}catch{}try{a&&pt.current&&a.unobserve(pt.current)}catch{}}},[kt,ls]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.mode;a&&(Vs(a),gt())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.formatType,o=s?.detail?.formatCount,u=s?.detail?.startScore;(a==="first"||a==="best")&&Dn(a),typeof o=="number"&&isFinite(o)&&wa(Math.max(1,Math.floor(o))),typeof u=="number"&&isFinite(u)&&Os(Math.max(1,Math.floor(u)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),r.useEffect(()=>{if(!T)return;const t=setTimeout(()=>gt(),50);return()=>clearTimeout(t)},[T]),r.useEffect(()=>{if(!$s||I||A==="None"||Ri<=0)return;let t,s=performance.now();const a=o=>{const u=o-s;s=o,Ut(g=>{const b=g-u;if(b<=0){let N=0,p=0,v=W;for(Re(0);N<3&&v>0;){const h=yo(v,A),j=Ee(h-N*20,0,Math.min(60,v)),ie=v-j;if(gs(j),un(de=>de+1),aa(de=>de+1),ie<0){v=W,Ye(0),ut(0),p=0,dt(0),Re(0);break}p+=j,Ye(de=>de+j),ia(de=>de+j);const De=v,Oe=ie;if(De>50&&Oe<=50?ut(1):De<=50&&ut(de=>de+1),v=ie,N+=1,Re(N),v===0)break}if(Nt(v),v===0){p===180?bn(j=>j+1):p>=140?gn(j=>j+1):p>=100&&vn(j=>j+1);const h=W;h<=170&&ca(j=>Math.max(j,h)),W<=50&&(na(j=>j+(mn>0?mn:1)),ra(j=>j+1)),dt(p),Ye(0),ut(0),Re(0),oe("ai"),le(!0)}return v>0&&N>=3&&(p===180?bn(h=>h+1):p>=140?gn(h=>h+1):p>=100&&vn(h=>h+1),dt(p),Ye(0),ut(0),Re(0)),Re(0),Ct(!0),0}return b}),t=requestAnimationFrame(a)};return t=requestAnimationFrame(a),()=>cancelAnimationFrame(t)},[$s,I,A,W]),r.useEffect(()=>{Q.inProgress&&(ir.current||(ar(!0),ir.current=!0))},[Q.inProgress]);function gt(){tt(!0),X(C),re.current=C,Nt(C),sr(!1),st(!0),Ct(!0),w(0),We(0),Pe(0),Z(0),J.current=0,Ht(C),ce(0),Te(null),ne(0),Ut(0),un(0),gs(0),Ye(0),Re(0),dt(null),oe(null),rs(0),as(0),cr([]),sn(0),nn(0),rn(!1),mt(0),aa(0),zt(0),ia(0),js(0),Ns(0),ys(0),bn(0),gn(0),vn(0),ws(0),ca(0),_t(0),vs(0),na(0),ra(0),F("X01");const t=Math.max(1,Math.floor(Number(Ls)||1));if(rr(bt==="first"?t:Math.max(1,Math.ceil(t/2))),P)try{z({mode:x,x01Start:C,firstTo:yt,aiLevel:A})}catch{}const s=n?.username||"You",a=A!=="None"?`AI (${A})`:"Opponent",o=A!=="None"?[s,a]:[s];Q.newMatch(o,C,`offline-${Date.now()}`)}function ll(){X(C),re.current=C,Nt(C),sr(!1),st(!0),Ct(!0),w(0),We(0),Pe(0),Z(0),J.current=0,Ht(C),ce(0),ze.current=C,ae.current=0,Te(null),ne(0),ee.current=0,ee.current=0,Ut(0),un(0),gs(0),Ye(0),Re(0),dt(null),oe(null)}function vt(t){Z(0),J.current=0,Ht(t===0?C:t),ze.current=t===0?C:t,ne(0),ee.current=0,A!=="None"?(Ct(!1),Ut(dr)):(Ut(0),Ct(!0))}function qe(t){if(me&&Be.current){$i||Yt(!0),fe("Remove your darts before starting the next throw",{type:"info",timeout:1800});return}R("X01");const s=re.current,a=J.current,o=ae.current,u=ze.current,g=ee.current,b=s-t,N=a+1;if(Pe(t),We(K=>K+1),mt(K=>K+1),b<0){try{const K=s,Vn=u;Jt.getState().recordVisit("offline-x01",N,0,{preRemaining:K,postRemaining:Vn,bust:!0,finish:!1})}catch{}if(X(u),re.current=u,s<=50){const K=(g||0)+1;_t(Vn=>Vn+K)}if(m)try{Ps(n?.username||"Player",0,Math.max(u,0),l,{volume:c,checkoutOnly:f})}catch{}Te(0),w(0),ce(0),ae.current=0,ne(0),ee.current=0,vt(u);return}X(b),re.current=b,Z(N),J.current=N;const p=o+t;ce(p),ae.current=p,zt(K=>K+t),w(0);const v=s,h=b,j=v>50&&h<=50,ie=v<=50;j?(ne(1),ee.current=1):ie&&(ne(K=>K+1),ee.current=(g||0)+1);const De=ee.current||0,Oe=v<=50,de=Oe?Math.max(De,Math.min(N,3)):0;if(b===0){const K={visitTotal:p,darts:N,preRemaining:s,remaining:0,doubleAttempts:de,finished:!0,doubleWindow:Oe,highestCheckout:u<=170?u:null};me?pa(K):ks(K,"immediate");return}if(N>=3){const K={visitTotal:p,darts:N,preRemaining:s,remaining:b,doubleAttempts:de,finished:!1,doubleWindow:Oe,highestCheckout:null};me?pa(K):ks(K,"immediate");return}}function Ts(){const t=Ee(Math.round(Number(D)||0),0,60);qe(t)}function H(t){if(!Number.isFinite(t))return!1;const s=ze.current,a=re.current,o=J.current,u=ae.current,g=o>0||u>0;g&&(X(s),re.current=s,Z(0),J.current=0,ce(0),ae.current=0,ne(0),ee.current=0,Pe(0),w(0),We(h=>Math.max(0,h-o)),mt(h=>Math.max(0,h-o)),zt(h=>Math.max(0,h-u)),Ge.current=0);const b=g?s:a,N=b<=170?170:180,p=Ee(Math.round(t),0,N);R("X01",3),We(h=>h+3),mt(h=>h+3),Z(3),J.current=3,ce(p),ae.current=p,Te(p),p===180?js(h=>h+1):p>=140?Ns(h=>h+1):p>=100&&ys(h=>h+1);const v=b-p;if(v<0){if(m)try{Ps(Ce,0,Math.max(s,0),l,{volume:c,checkoutOnly:f})}catch{}try{Jt.getState().recordVisit("offline-x01",3,0,{preRemaining:b,postRemaining:s,bust:!0,finish:!1})}catch{}X(s),re.current=s,Te(0),ce(0),ae.current=0,Z(0),J.current=0,ne(0),ee.current=0;try{Q.addVisit(0,3)}catch{}return vt(s),!0}if(X(v),re.current=v,zt(h=>h+p),m)try{Ps(Ce,p,Math.max(v,0),l,{volume:c,checkoutOnly:f})}catch{}if(b<=50&&(_t(h=>h+3),v===0&&vs(h=>h+1)),v===0){b<=170&&ws(h=>Math.max(h,b));try{Jt.getState().recordVisit("offline-x01",3,p,{preRemaining:b,postRemaining:0,finish:!0,bust:!1})}catch{}try{Q.addVisit(p,3)}catch{}return oe("player"),le(!0),Z(0),J.current=0,ce(0),ae.current=0,ne(0),ee.current=0,!0}try{Jt.getState().recordVisit("offline-x01",3,p,{preRemaining:b,postRemaining:v,finish:!1,bust:!1})}catch{}try{Q.addVisit(p,3)}catch{}return vt(v),ce(0),ae.current=0,Z(0),J.current=0,ne(0),ee.current=0,!0}const xe=vo({match:Q,commitManualVisitTotal:H,endTurn:vt}),[An,Sa]=r.useState(""),ka=t=>{Sa(t)},Rs=()=>{const t=parseInt(An,10);if(isNaN(t)||t<0||t>180){alert("Enter a number 0-180 for visit total");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=re.current<=170?170:180,a=Ee(Math.round(t),0,s);t>s&&fe(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),H(a)&&Sa("")},Mn=r.useCallback(()=>{Be.current&&(Be.current=null,ke(),Yt(!1));const t=J.current,s=ae.current,a=ze.current;t===0&&s===0||(X(a),re.current=a,Z(0),J.current=0,ce(0),ae.current=0,ne(0),ee.current=0,Pe(0),w(0),We(o=>Math.max(0,o-t)),mt(o=>Math.max(0,o-t)),zt(o=>Math.max(0,o-s)),Ge.current=0)},[ke]);r.useEffect(()=>{const t=s=>{const a=s?.detail;!a||a?.source==="offline-play"||Mn()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[Mn]);function Ca(t){R("Double Practice");const s=Ee(Math.round(t||0),0,60);if(Pe(s),We(a=>a+1),mt(a=>a+1),ei(s,At)){const a=Ws+1;Gs(a),Ks(o=>Math.min(20,o+1)),a>=21&&(oe("player"),le(!0))}w(0)}function Da(){Ca(Number(D))}function Aa(){const t=Ze(te);if(t==null){alert("Enter like D16, 50, 25, T20");return}Ca(t),Y("")}function Ma(t,s,a){if(yr)return!1;R("Bob's 27");const o=vr,u=s==="DOUBLE"&&a===o||!s&&t===o*2;return u&&Ys(g=>g+1),Nr(g=>{const b=g+1;if(b>=3){const N=yi+(u?1:0);N>0?Xs(v=>v+N*o*2):Xs(v=>v-o*2);const p=o+1;return jr(p),Ys(0),p>20&&wr(!0),0}return b}),!0}function La(){Ma(Math.max(0,D|0)),w(0)}function Ta(){jr(1),Xs(27),Nr(0),Ys(0),wr(!1),F("Bob's 27")}function Ln(t){return R("Count-Up"),Cr(s=>s+Math.max(0,t|0)),Dr(s=>{const a=s+1;return a>=3?(kr(o=>o+1),0):a}),!0}function Tn(t){return R("High Score"),Lr(s=>s+Math.max(0,t|0)),Tr(s=>{const a=s+1;return a>=3?(Mr(o=>o+1),0):a}),!0}function Rn(t){return R("Low Score"),Ir(s=>s+Math.max(0,t|0)),Pr(s=>{const a=s+1;return a>=3?(Er(o=>o+1),0):a}),!0}function Ra(t,s,a,o,u,g,b,N){const p=t-b;if(!(p<0))if(p===0){if(N==="DOUBLE"||N==="INNER_BULL"){g(v=>v+1),u(v=>v+1),o(()=>0),s(t);return}s(p)}else s(p);o(v=>{const h=v+1;return h>=3?(u(j=>j+1),0):h})}function Ea(t,s){return R("Checkout 170"),Ra(qs,Qs,Br,Fr,Or,Ur,t,s),Br+1>=3&&Qs(170),!0}function Ia(t,s){return R("Checkout 121"),Ra(Zs,Js,$r,_r,Wr,zr,t,s),$r+1>=3&&Js(121),!0}function Es(t){const s=Ze(te);if(s==null){alert("Enter like T20, D16, 25, 50");return}const a=te.trim().toUpperCase(),o=a.startsWith("D")||a==="50"||a==="BULL"||a==="DBULL"||a==="IBULL"||a.includes("INNER");t?Ea(s,o?"DOUBLE":void 0):Ia(s,o?"DOUBLE":void 0),Y("")}function ol(){Qs(170),Fr(0),Or(0),Ur(0),F("Checkout 170")}function cl(){Js(121),_r(0),Wr(0),zr(0),F("Checkout 121")}function En(t,s,a){return Yr?!1:(R("Treble Practice"),(s==="TRIPLE"&&a===$e||!s&&t===$e*3)&&sn(u=>u+1),nn(u=>{const g=u+1;if(g%3===0&&[20,19,18].includes($e)){const b=["T20","T19","T18"],N=b.indexOf(`T${$e}`),p=b[(N+1)%b.length];en(Number(p.replace("T","")))}return Tt>0&&g>=Tt&&rn(!0),g}),!0)}function Pa(){sn(0),nn(0),rn(!1),F("Treble Practice")}function dl(t,s,a){return R("Baseball"),Qr(o=>{const u={...o};return no(u,t,s,a),u}),!0}function ul(){Qr(ni()),F("Baseball")}function ml(t,s,a){return R("Golf"),Jr(o=>{const u={...o};return ao(u,t,s,a),u}),!0}function xl(){Jr(ri()),F("Golf")}function hl(t,s,a,o){return R("Tic Tac Toe"),ea(u=>{const g={...u,board:[...u.board]};return lo(g,t,s,a,o),g}),!0}function fl(){ea(ai()),F("Tic Tac Toe")}function pl(t,s,a){return R("American Cricket"),ta(o=>{const u={...o,marks:{...o.marks}};return bo(u,t,s,a,()=>!1),u}),!0}function Ba(){ta(ci()),F("American Cricket")}function In(t,s,a){R("Around the Clock");const o=He[Ue];let u=!1;if(typeof a=="number"&&a===o&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(u=!0),o===25&&(s==="BULL"||t===25)&&(u=!0),o===50&&(s==="INNER_BULL"||t===50)&&(u=!0),u||(t===o||t===o*2||t===o*3)&&(u=!0),u){const g=br+1;return gr(g),pr(b=>b+1),!0}return!0}function Fa(){In(Math.max(0,D|0)),w(0)}function Va(){const t=Ze(te);if(t==null){alert("Enter like T20, D5, 25, 50");return}In(t),Y("")}function Pn(t,s,a){return R("Cricket"),zs(o=>{const u={...o,marks:{...o.marks}};return Gl(u,t,s,a,()=>!1),u}),pe(o=>{const u=o+1;return u>=3?0:u}),!0}function Oa(){Pn(Math.max(0,D|0)),w(0)}function Bn(t,s,a){return R("Shanghai"),cs(o=>{const u={...o,turnHits:{...o.turnHits}};return Yl(u,t,s,a),u}),pe(o=>{const u=o+1;return u>=3?(cs(g=>{const b={...g,turnHits:{...g.turnHits}};return ql(b),b}),0):u}),!0}function Ha(){Bn(Math.max(0,D|0)),w(0)}function Ua(t,s,a){return R("Halve It"),ds(o=>{const u={...o,targets:[...o.targets]};return Ql(u,t,s,a),u}),pe(o=>{const u=o+1;return u>=3?(ds(g=>{const b={...g,targets:[...g.targets]};return Zl(b),b}),0):u}),!0}function $a(){Ua(Math.max(0,D|0)),w(0)}function _a(t,s,a){return R("High-Low"),ms(o=>{const u={...o};return Jl(u,t,s,a),u}),pe(o=>{const u=o+1;return u>=3?(ms(g=>{const b={...g};return eo(b),b}),0):u}),!0}function Ka(){_a(Math.max(0,D|0)),w(0)}function Wa(){const t=te.trim().toUpperCase();if(!t)return null;if(t==="50"||t==="BULL"||t==="DBULL"||t==="IBULL")return 50;if(t==="25"||t==="OBULL")return 25;const s=t.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!s)return null;const a=s[1]||"S",o=parseInt(s[2],10);return o<1||o>20?null:o*(a==="S"?1:a==="D"?2:3)}function Qt(){const t=Wa();if(t==null){alert("Enter like T20, D16, 5, 25, 50");return}qe(t),Y("")}function Ga(){const t=Nn.trim().split(`
`).map(s=>s.trim()).filter(s=>s);if(t.length!==0){for(const s of t){const a=Ze(s);if(a==null){alert(`Invalid score: ${s}`);return}qe(a)}Xt("")}}function Zt(){_!==0&&(X(t=>t+Le),Z(t=>Math.max(0,t-1)))}function Is(){const t=Wa();if(t==null){alert("Enter like T20, D16, 5, 25, 50");return}if(_===0){Qt();return}const s=Le;X(a=>a+s),Z(a=>Math.max(0,a-1)),setTimeout(()=>qe(t),0),Y("")}const bl=r.useCallback(t=>{if(I){if(t.type==="command")t.value==="undo"&&(Zt(),fe("Undoing last dart",{type:"info",timeout:1e3}));else if(t.type==="dart"){const s=Ze(t.value);s!==null&&(qe(s),fe(`Voice: ${t.value}`,{type:"success",timeout:1e3}))}else if(t.type==="visit_score"){const s=t.value;s<=180&&s>=0&&(H(s),fe(`Voice Visit: ${s}`,{type:"success",timeout:1e3}))}}},[I,Zt,qe,fe]),{isListening:za,toggleListening:gl,error:vl,supported:jl}=Kl(bl);function Nl(){const t=is??"player",s=t==="player"?ps||void 0:mn||void 0,a=1,o=t==="player"?fs:bs;cr([...ve,{winner:t,doubleDarts:lr,checkoutDarts:or,winnerDarts:o,doublesAtt:s,doublesHit:a}]),le(!1);let u=$,g=G;if(is==="player"?u+=1:is==="ai"&&(g+=1),rs(u),as(g),oe(null),u>=yt||g>=yt){try{Bl(x,t==="player")}catch{}st(!1),tt(!1),X(C),Nt(C),jn(!0);return}ll()}const Fn=!Ya.includes(x)&&!(n?.fullAccess||n?.admin);return e.jsxs("div",{className:"card ndn-game-shell relative overflow-hidden",children:[hi&&e.jsx(Fl,{players:Q.players||[],user:n,onDone:()=>ar(!1)}),e.jsxs("h2",{className:"text-3xl font-bold text-brand-700 mb-4",children:["Offline Mode ï¿½"," ",i==="classic"?e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle",children:"Classic layout"}):e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),e.jsxs("div",{className:"ndn-shell-body",children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:x,onChange:t=>Vs(t.target.value),children:[Ya.map(t=>e.jsx("option",{value:t,children:t},t)),Al.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t," ",n?.fullAccess||n?.admin?"":"(Premium)"]},t))]}),e.jsx(Vl,{gameMode:x,compact:!0}),x==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:Tt,onChange:t=>Mi(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."}),y&&!Dt&&e.jsx("div",{className:"hidden md:block w-[360px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2",style:{willChange:"transform, opacity"},children:e.jsx(di,{scoringMode:"x01",showToolbar:k,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:q(H),onAutoDart:(t,s,a)=>{}})})})]}),!n?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),x==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:C,onChange:t=>Os(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:A,onChange:t=>tr(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),jo.map(t=>e.jsx("option",{value:t,children:t},t))]}),A!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:dr/1e3,onChange:t=>bi(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>ge(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),x==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!Us&&e.jsx("button",{className:"btn",disabled:Fn,title:Fn?"PREMIUM required for this mode":"",onClick:gt,children:"Start Match ðŸš€"}),$s&&e.jsx("div",{className:`absolute inset-0 z-[1000] ${St?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(es,{storageKey:"ndn:modal:offline-match",className:`${St?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:St,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pr-1 pt-2 pb-2",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{ft.current=t},children:[e.jsx("div",{ref:t=>{Cn.current=t},children:e.jsx(Ml,{left:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[x,x==="X01"?` / ${C}`:""]}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",yt," Â· Legs ",$,"-",G]}),e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${i==="modern"?"bg-emerald-500/15 text-emerald-200 border-emerald-400/30":"bg-white/10 text-white/70 border-white/20"}`,children:i==="modern"?"Modern layout":"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden items-center gap-2 mr-2 text-xs",children:[e.jsx("span",{className:"opacity-80",children:"Cam"}),e.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>V(Math.max(.5,Math.round((M-.05)*100)/100)),title:"Decrease camera size",children:"âˆ’"}),e.jsxs("span",{className:"w-9 text-center",children:[Math.round(M*100),"%"]}),e.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>V(Math.min(1.25,Math.round((M+.05)*100)/100)),title:"Increase camera size",children:"+"})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:kt?"Actual Size":"Fit All",onClick:()=>mr(t=>!t),children:kt?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:St?"Restore":"Maximize",onClick:()=>ur(t=>!t),children:St?"Restore":"Maximize"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{gt()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>wt(!0),children:"Quit"})]})})}),gi&&e.jsx(Ll,{onClose:()=>wt(!1),onQuit:()=>{try{qa({type:"quit"})}catch{}st(!1),tt(!1),wt(!1)},onPause:t=>{const s=Date.now()+t*60*1e3;try{vi(!0,s),qa({type:"pause",pauseEndsAt:s,pauseStartedAt:Date.now()})}catch{}wt(!1)}}),e.jsxs("div",{ref:t=>{pt.current=t},className:"will-change-transform",style:kt?{transform:`scale(${ls})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,ls))}em`}:void 0,children:[e.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:x==="X01"?"X01 Match âš”ï¸":`${x} âš”ï¸`}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",x]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",C]}),e.jsxs("div",{ref:il,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=U!==C||W!==C||_>0,s=`pill ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${s} ${bt==="first"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Dn("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${s} ${bt==="best"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Dn("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:Ls,onChange:a=>wa(Math.max(1,Math.floor(Number(a.target.value)||1))),disabled:t,title:bt==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",$,"â€“",G]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`input input-compact font-bold ${Ve}`,value:jt,onChange:t=>Ie(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${Ve} w-[7.5rem]`,value:et,onChange:t=>ts(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${Ve} w-[7.5rem]`,value:ss,onChange:t=>ns(t.target.value),placeholder:"Team B"})]})]}),x!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[x==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:Fs[At]?.label||"â€”"})]})}),x==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:He[Ue]===25?"25 (Outer Bull)":He[Ue]===50?"50 (Inner Bull)":He[Ue]||"â€”"})]})}),x==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:Zn.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,Mt.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:Mt.points})]}),zl(Mt)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{zs(Un()),pe(0),F("Cricket")},children:"Reset"})]})]}),x==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:os.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",os.score]}),os.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{cs($n()),pe(0),F("Shanghai")},children:"Reset"})]})]}),x==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[Lt.stage+1,"/",Lt.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=ui(Lt);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Lt.score]}),Lt.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{ds(_n()),pe(0),F("Halve It")},children:"Reset"})]})]}),x==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",us.round," Â· Target ",us.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",us.score]}),us.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{ms(Kn()),pe(0),F("High-Low")},children:"Reset"})]})]}),x==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",vr]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ni]}),yr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Ta,children:"Reset"})]})]}),x==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Sr,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",wi]})]}),x==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Ar,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",ki]})]}),x==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Rr,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Di]})]}),x==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:qs}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Vr," Â· Successes:"," ",Hr]})]}),x==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Zs}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Kr," Â· Successes:"," ",Gr]})]}),x==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",$e]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",tn]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${$e===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>en(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:$e,onChange:t=>en(parseInt(t.target.value,10)),children:Array.from({length:20},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Pa,children:"Reset"})]})]})}),x==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:qr.inning}),e.jsxs("div",{className:"text-sm",children:["Score:"," ",e.jsx("span",{className:"font-semibold",children:qr.score})]})]}),x==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Zr.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes:"," ",e.jsx("span",{className:"font-semibold",children:Zr.strokes})]})]}),x==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:_e.turn}),_e.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",_e.winner||"â€”"]})]}),x==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Wn[hs.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[hs.targetIndex+1,"/",Wn.length]})]}),hs.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",hs.darts," darts!"]})]}),x==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Bt.score,"/",Bt.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Bt.darts})]}),Bt.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Bt.target,"!"]})]}),x==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Vt.score,"/",Vt.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Vt.darts})]}),Vt.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Vt.target,"!"]})]}),x==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:Jn.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,an.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:an.points})]}),go(an)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Ba,children:"Reset"})]})]}),x==="Killer"&&e.jsx(e.Fragment,{children:sa?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:O[we]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:at?`${O.find(t=>t.id===at)?.name||"Winner"} Wins`:Li||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):i==="modern"?e.jsxs("div",{className:"space-y-3 mb-2",children:[ue?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Manual scoring active"}),e.jsx("div",{className:"text-xs opacity-70",children:"Camera previews are disabled. Use the manual entry controls below to record your turn."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center flex-wrap gap-1.5 mt-1",children:e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[e.jsx("span",{className:"opacity-70",children:"Cam"}),e.jsx("button",{className:`btn ${Ve}`,onClick:()=>V(Math.max(.5,Math.round((M-.05)*100)/100)),children:"âˆ’"}),e.jsxs("span",{className:`btn ${Ve} min-w-[2.5rem] text-center`,children:[Math.round(M*100),"%"]}),e.jsx("button",{className:`btn ${Ve}`,onClick:()=>V(Math.min(1.25,Math.round((M+.05)*100)/100)),children:"+"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${Ve}`,title:"Toggle fit/fill",onClick:()=>se(E==="fill"?"fit":"fill"),children:E==="fill"?"Fill":"Fit"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${Ve}`,title:"Toggle camera aspect",onClick:()=>S(B==="square"?"wide":"square"),children:B==="square"?"Square":"Wide"})]})}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:gap-6",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-[minmax(0,1fr)_300px] md:items-start md:gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{"data-testid":"offline-current-shooter",className:"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Current Shooter"}),e.jsxs("div",{className:"mt-1 flex items-center gap-4",children:[e.jsx("div",{className:"text-xl font-semibold text-white",children:el}),e.jsx("div",{className:"ml-auto text-sm text-slate-300",children:"3-Dart Avg (Live)"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm text-white/80",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Remaining"}),e.jsx("div",{className:"font-mono text-lg text-white",children:ga})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Last Dart"}),e.jsx("div",{className:"font-mono text-lg text-white",children:va||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Match Legs"}),e.jsxs("div",{className:"font-semibold text-white",children:[$,"-",G]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Next Up"}),e.jsx("div",{className:"font-medium text-white",children:Ji})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{"data-testid":"offline-live-avg",className:"rounded-xl bg-slate-900/60 border border-white/10 p-3 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"mt-1 text-lg font-semibold",children:On(Q.players?.[Q.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{"data-testid":"offline-player-stats",className:"rounded-lg border p-3 bg-slate-900/50 border-white/10 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"You"}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("div",{children:["Legs Won:"," ",e.jsx("span",{className:"font-semibold",children:$})]}),e.jsxs("div",{children:["Score:"," ",e.jsx("span",{className:"font-mono",children:ga})]}),e.jsxs("div",{children:["Last Score:"," ",e.jsx("span",{className:"font-mono",children:va||0})]})]})]})]})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"rounded-lg border p-3 bg-slate-900/50 border-white/10 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"mt-1 text-lg font-semibold",children:On(Q.players?.[Q.currentPlayerIdx]?.currentThreeDartAvg??0)})]})}),e.jsx(Ae,{gameMode:x,players:ba,matchScore:`${$}-${G}`})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(Ae,{gameMode:x,players:ba,matchScore:`${$}-${G}`})}),Dt&&y&&!fr&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 md:hidden",children:[e.jsx("button",{className:"btn rounded-full border border-white/20 bg-white/10 px-4 py-2 text-sm text-white",onClick:()=>_s(!0),children:"Camera"}),e.jsx("span",{className:"text-xs text-white/60",children:"Tap to open the camera tab"})]}),x==="X01"&&e.jsxs("div",{className:"mt-3 md:mt-4 rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Manual Scoreboard Override"}),e.jsxs("p",{className:"mt-1 text-xs text-white/40",children:["Adjust the live totals if a dart was misread. Values are clamped between 0 and ",C,"."]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:Ce}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Commit Visit"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx(Hl,{inProgress:!0,startingScore:C,onAddVisit:q(H),quickButtons:[180,140,100,60],onNextPlayer:()=>xe?.nextPlayer(),onEndLeg:()=>{},onUndo:()=>{},showDartsSelect:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:ma,onChange:t=>yn(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ms("player")},placeholder:`${$}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ms("player"),children:"Set"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:Fe}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Three Dart Edit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:C,value:da,onChange:t=>ua(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Na()},placeholder:`${W}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Na(),children:"Set"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:xa,onChange:t=>wn(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ms("ai")},placeholder:`${G}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ms("ai"),children:"Set"})]})]})]})]})]})]})})})]}),Dt&&y&&fr&&e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-start justify-center px-3 pt-6 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80"}),e.jsx("div",{className:"relative z-10 w-full max-w-[420px]",children:e.jsxs("div",{className:"relative h-[75vh] rounded-[28px] overflow-hidden bg-black shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(L,{scoringMode:"x01",showToolbar:k,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:q(H),onAutoDart:(t,s,a)=>{}})}),e.jsx("button",{className:"absolute top-3 right-3 rounded-full bg-black/60 p-2 text-white",onClick:()=>_s(!1),"aria-label":"Close camera tab",children:"âœ•"}),e.jsxs("div",{className:"absolute bottom-4 right-4 w-full max-w-[220px] rounded-[20px] bg-black/70 p-3 text-left text-white shadow-lg",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide text-white/60",children:"Current thrower"}),e.jsx("div",{className:"text-sm font-semibold leading-tight",children:_i}),e.jsxs("div",{className:"text-[11px] text-white/60",children:["Legs: ",Wi]}),e.jsx("div",{className:"mt-2 text-[10px] uppercase tracking-wide text-white/60",children:"Opponent"}),e.jsx("div",{className:"text-sm font-semibold leading-tight",children:Ki}),e.jsxs("div",{className:"text-[11px] text-white/60",children:["Legs: ",Gi]})]})]})})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:[grid-template-columns:minmax(0,0.75fr)_minmax(0,3fr)_minmax(0,0.75fr)] gap-2 mb-2 items-stretch min-w-0",children:e.jsxs("div",{className:"flex items-stretch justify-center md:px-3 min-w-0",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"You Remain"}),I?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:U}),e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-U/C)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart:"," ",e.jsx("span",{className:"font-semibold",children:Le})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score:"," ",e.jsx("span",{className:"font-semibold",children:_>0?Se:it??Le})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg:"," ",e.jsx("span",{className:"font-semibold",children:Wt>0?(fn/Wt*3).toFixed(1):"0.0"})]}),e.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[e.jsxs("span",{children:["Darts thrown: ",fs]}),e.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(t=>e.jsx("span",{className:`w-2 h-2 rounded-full ${t<_?"bg-emerald-400":"bg-white/20"}`},t))})]}),e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles:"," ",e.jsxs("span",{className:"font-semibold",children:["Att ",$t," Â· Hit ",xn]})]}),U<=170&&U>0&&(()=>{const s=Tl(U,d)[0]||"â€”";return e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[e.jsx("span",{className:"opacity-70",children:"Checkout"}),e.jsx("span",{className:"font-semibold",children:s})]})})()]}),e.jsx("div",{className:"flex items-stretch justify-center md:justify-end md:px-3 min-w-0 flex-1 min-h-0 ndn-camera-tall",children:e.jsx(Rl,{storageKey:"ndn:camera:tile:offline:center:v4",className:"relative rounded-2xl overflow-hidden bg-black w-full camera-fullwidth-card",defaultWidth:0,defaultHeight:0,minWidth:300,minHeight:300,maxWidth:2e3,maxHeight:1200,autoFill:!0,children:e.jsx(L,{scoringMode:"x01",showToolbar:k,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:q(H),onAutoDart:(t,s,a)=>{}})})}),e.jsxs("div",{className:`mt-2 ${ye==="small"?"p-2":ye==="large"?"p-4":"p-3"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${be==="small"?"text-xs":be==="large"?"text-base":"text-sm"}`,children:[e.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const t=I?n?.username||"You":A==="None"?"â€”":`${A} AI`,s=I?U:A==="None"?0:W,a=I?_>0?Se:it??Le:ot>0?lt:ct??Xe,o=I?fs:bs,u=C-(I?U:A==="None"?C:W),g=o>0?u/o*3:0,b=`${$}-${G}`,N=ve.length>0?`${Math.min(...ve.map(p=>p.doubleDarts+(p.checkoutDarts||0)))||0} darts`:"â€”";return e.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[e.jsx("div",{className:"opacity-80",children:"Current score"}),e.jsx("div",{className:"font-mono text-right",children:b}),e.jsx("div",{className:"opacity-80",children:"Current thrower"}),e.jsx("div",{className:"text-right font-semibold text-lg",children:t}),e.jsx("div",{className:"opacity-80",children:"Score remaining"}),e.jsx("div",{className:"text-right font-mono font-bold text-xl",children:s}),e.jsx("div",{className:"opacity-80",children:"3-dart avg"}),e.jsx("div",{className:"text-right font-mono",children:g.toFixed(1)}),e.jsx("div",{className:"opacity-80",children:"Last score"}),e.jsx("div",{className:"text-right font-mono",children:a}),e.jsx("div",{className:"opacity-80",children:"Best leg"}),e.jsx("div",{className:"text-right",children:N})]})})()]}),e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[e.jsxs("span",{children:[A==="None"?"Opponent":`${A} AI`," Remain"]}),I?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:A!=="None"?W:"N/A"}),A!=="None"&&e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-W/C)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart:"," ",e.jsx("span",{className:"font-semibold",children:A==="None"?0:Xe})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score:"," ",e.jsx("span",{className:"font-semibold",children:A==="None"?"â€”":ot>0?lt:ct??Xe})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg:"," ",e.jsx("span",{className:"font-semibold",children:A!=="None"?Gt>0?(pn/Gt*3).toFixed(1):"0.0":"â€”"})]}),A!=="None"&&e.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",bs]}),A!=="None"&&e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles:"," ",e.jsxs("span",{className:"font-semibold",children:["Att ",Kt," Â· Hit ",hn]})]})]})]})}),x!=="X01"?e.jsxs("div",{className:"space-y-2",children:[x==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Fs[At]?.label||"â€”"})]}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&ei(t,At)){const o=Ws+1,u=At+1;return Gs(o),Ks(u),o>=Fs.length&&setTimeout(()=>{Gs(0),Ks(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Da()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Da,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Aa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Aa,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",Ws," of 21"]})]}),x==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:He[Ue]===25?"25 (Outer Bull)":He[Ue]===50?"50 (Inner Bull)":He[Ue]||"â€”"})]}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>In(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Fa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Fa,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Va()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Va,children:"Add"})]}),br>=He.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{gr(0),pr(0),F("Around the Clock")},children:"Reset"})]})]}),x==="Cricket"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Pn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Oa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Oa,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{zs(Un()),pe(0),F("Cricket")},children:"Reset"})]})]}),x==="Shanghai"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Bn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ha()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ha,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{cs($n()),pe(0),F("Shanghai")},children:"Reset"})]})]}),x==="Halve It"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ua(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&$a()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$a,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ds(_n()),pe(0),F("Halve It")},children:"Reset"})]})]}),x==="High-Low"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>_a(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ka()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ka,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ms(Kn()),pe(0),F("High-Low")},children:"Reset"})]})]}),x==="Bob's 27"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ma(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&La()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:La,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ta,children:"Reset"})]})]}),x==="Count-Up"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:t=>Ln(t),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Ln(D),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Ln(D),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{kr(1),Cr(0),Dr(0),F("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Sr,"/",Si]})]}),x==="High Score"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:t=>Tn(t),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Tn(D),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Tn(D),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Mr(1),Lr(0),Tr(0),F("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Ar,"/",Ci]})]}),x==="Low Score"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:t=>Rn(t),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Rn(D),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Rn(D),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Er(1),Ir(0),Pr(0),F("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Rr,"/",Ai]})]}),x==="Checkout 170"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s)=>Ea(t,s==="MISS"?void 0:s),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Es(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Es(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:ol,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",qs," Â· Attempts: ",Vr," ","Â· Successes: ",Hr]})]}),x==="Checkout 121"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s)=>Ia(t,s==="MISS"?void 0:s),onAddVisit:q(H),onEndLeg:t=>xe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Es(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Es(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:cl,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Zs," Â· Attempts: ",Kr," ","Â· Successes: ",Gr]})]}),x==="Treble Practice"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>En(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=Ze(te);s!=null&&En(s,void 0,void 0),Y("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=Ze(te);t!=null&&En(t,void 0,void 0),Y("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",tn," Â· Misses:"," ",Math.max(0,Xr-tn)," Â· Darts:"," ",Xr,Tt>0?`/${Tt}`:""]}),Yr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Pa,children:"Reset"})]})]}),x==="Baseball"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>dl(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:ul,children:"Reset"})})]}),x==="Golf"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>ml(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:xl,children:"Reset"})})]}),x==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${_e.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(_e.finished||_e.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),a=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",o=t,u=mi[o],g=u.type==="BULL"?null:u.num||null;hl(o,s,a,g)},children:_e.board[t]||""},t))}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:fl,children:"Reset"})})]}),x==="American Cricket"&&e.jsxs(e.Fragment,{children:[y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>pl(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ba,children:"Reset"})})]}),x==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Wn[Ke.targetIndex]})]}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{const o=s==="MISS"?void 0:s;return R("Scam"),Pt(zn(Ke,t,o)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(R("Scam"),Pt(ii(Ke,D)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{R("Scam"),Pt(ii(Ke,D)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Pt(co()),F("Scam")},children:"Reset"})]}),Ke.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",Ke.darts," darts!"]})]}),x==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[je.score,"/",je.target]})]}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(R("Fives"),Ft(Yn(je,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(R("Fives"),Ft(li(je,D)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{R("Fives"),Ft(li(je,D)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ft(xo(je.target)),F("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",je.darts]}),je.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",je.target," in"," ",je.darts," darts!"]})]}),x==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[Ne.score,"/",Ne.target]})]}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(R("Sevens"),Ot(Qn(Ne,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(R("Sevens"),Ot(oi(Ne,D)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{R("Sevens"),Ot(oi(Ne,D)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ot(po(Ne.target)),F("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",Ne.darts]}),Ne.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",Ne.target," in"," ",Ne.darts," darts!"]})]}),x==="Killer"&&e.jsx(e.Fragment,{children:sa?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:O.map(t=>{const s=Rt[t.id],a=xs[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number:"," ",e.jsx("span",{className:"font-semibold",children:a})]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsx("span",{className:"font-semibold",children:s?.lives??0})]})]},t.id)})}),y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(at)return!1;const o=s==="MISS"?void 0:s,u=a?.sector??null,g=O[we];return g?(Et(b=>{const N={};Object.keys(b).forEach(h=>N[h]={...b[h]});const p=ti(g.id,N,o,u);if(p.becameKiller)Me(`${g.name} became a Killer`);else if(p.victimId){const h=O.find(j=>j.id===p.victimId);Me(`${g.name} hit ${h?.name}'s ${xs[p.victimId]} (${p.livesRemoved} life${(p.livesRemoved||0)>1?"s":""})`)}else Me("No effect");const v=si(N);return v&&It(v),N}),rt(b=>{const N=b+1;if(N>=3){let p=we;for(let v=1;v<=O.length;v++){const h=(we+v)%O.length,j=O[h].id,ie=Rt[j];if(ie&&!ie.eliminated&&ie.lives>0){p=h;break}}return nt(p),0}return N}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(at)return;const a=te.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!a){Y("");return}const o=a[1]||"S",u=parseInt(a[2],10),g=o==="D"?"DOUBLE":o==="T"?"TRIPLE":"SINGLE",b=O[we];Et(N=>{const p={};Object.keys(N).forEach(j=>p[j]={...N[j]});const v=ti(b.id,p,g,u);if(v.becameKiller)Me(`${b.name} became a Killer`);else if(v.victimId){const j=O.find(ie=>ie.id===v.victimId);Me(`${b.name} hit ${j?.name}'s ${xs[v.victimId]} (${v.livesRemoved} life${(v.livesRemoved||0)>1?"s":""})`)}else Me("No effect");const h=si(p);return h&&It(h),p}),Y(""),rt(N=>{const p=N+1;if(p>=3){let v=we;for(let h=1;h<=O.length;h++){const j=(we+h)%O.length,ie=O[j].id,De=Rt[ie];if(De&&!De.eliminated&&De.lives>0){v=j;break}}return nt(v),0}return p})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=we;for(let s=1;s<=O.length;s++){const a=(we+s)%O.length,o=O[a].id,u=Rt[o];if(u&&!u.eliminated&&u.lives>0){t=a;break}}nt(t),rt(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Et({}),on({}),cn(!1),nt(0),rt(0),It(null),Me("")},children:"Reset"})]}),at&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",O.find(t=>t.id===at)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Et({}),on({}),cn(!1),nt(0),rt(0),It(null),Me("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:O.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:a=>{const o=a.target.value;ln(u=>u.map((g,b)=>b===s?{...g,name:o}:g))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>ln(a=>a.filter((o,u)=>u!==s)),disabled:O.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>ln(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(O.length<2){alert("Need at least 2 players");return}const t=O.map(o=>o.id),s=so(t),a={};t.forEach(o=>{a[o]=to(s[o])}),on(s),Et(a),nt(0),rt(0),It(null),Me("Assigned numbers"),cn(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-3 min-h-0 flex-1 text-[14px]",children:[e.jsxs("div",{className:"basis-1/2 shrink-0 min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"},children:[e.jsx("div",{className:"text-sm font-semibold opacity-80",children:"Scoreboard"}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ae,{gameMode:x,players:Cs,matchScore:`${$}-${G}`})}),I&&e.jsxs("div",{className:"p-4 rounded-2xl bg-slate-900/60 border border-white/10 text-slate-100 shadow-lg backdrop-blur-sm flex-shrink-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("h4",{className:"text-sm font-semibold tracking-wide uppercase text-indigo-200",children:"Manual Scoring"}),e.jsx("span",{className:"text-xs text-white/60",children:"Override a visit or enter dart-by-dart scores."})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Single Dart"}),e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:60,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?Zt():Ts())},placeholder:"60"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ts,children:"Add Dart"}),jl&&e.jsx("button",{className:`btn px-3 py-1 text-sm flex items-center gap-2 ${za?"bg-red-500/20 text-red-200 border-red-500/50 animate-pulse":""}`,onClick:gl,title:vl||"Talk to score (e.g. 'Triple 20', 'Double Top', 'Undo')",children:za?"ðŸŽ¤ Listening...":"ðŸŽ¤ Voice"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Three Dart Edit"}),e.jsx("input",{className:"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:U<=170?170:180,value:An,onChange:t=>ka(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Rs()},placeholder:"100"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Rs,children:"Commit Visit"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:Zt,children:"Undo Visit"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Manual"}),e.jsx("input",{className:"input w-28 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?Is():Qt())},placeholder:"T20"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Qt,children:"Apply"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:Is,disabled:_===0,children:"Replace Last"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Multi-entry (one per line)"}),e.jsx("textarea",{className:"mt-2 w-full rounded-xl bg-slate-950/70 border border-white/10 text-sm text-slate-100 placeholder-white/40 p-3 focus:outline-none focus:border-emerald-400/60 focus:ring-2 focus:ring-emerald-500/30",rows:3,value:Nn,onChange:t=>Xt(t.target.value),placeholder:`T20
D16
25`}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ga,children:"Apply All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Xt(""),children:"Clear"})]})]}),e.jsx("div",{className:"pt-2 border-t border-white/10 mt-3",children:e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:Mn,disabled:_===0&&Se===0,children:"Clear Current Visit"})})]})]})]}),y&&e.jsx("div",{className:"basis-1/2 shrink-0 min-w-0 rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s)=>{const a=s??"MISS",o=Number.isFinite(t)?Math.max(0,t):0,u=Date.now();if(o<=0){if(a!=="MISS"||u-(Ge.current||0)<1200)return;Ge.current=u}else Ge.current=0;qe(o)}})})]}),x==="X01"&&!y&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:x,players:Cs,matchScore:`${$}-${G}`})}),x==="Cricket"&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:"Cricket",players:zi})}),x==="Cricket"&&y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Pn(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),x==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:"Shanghai",players:Xi})}),x==="Shanghai"&&y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Bn(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),x==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:"Killer",players:Yi})}),x==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:"Scam",players:qi})}),x==="Scam"&&y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Pt(zn(Ke,t,s)),!0}})}),x==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:"Fives",players:Qi})}),x==="Fives"&&y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Ft(Yn(je,t)),!0}})}),x==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(Ae,{gameMode:"Sevens",players:Zi})}),x==="Sevens"&&y&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:k,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Ot(Qn(Ne,t)),!0}})}),e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?Zt():Ts())}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ts,title:"Add a single dart (0â€“60)",children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:U<=170?170:180,placeholder:"Visit total (0â€“180)",value:An,onChange:t=>ka(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Rs()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Rs,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D16, 5, 25, 50)",value:te,onChange:t=>Y(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?Is():Qt())}}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:Is,disabled:_===0,children:"Replace Last"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Qt,children:"Add"})]}),e.jsxs("div",{children:[e.jsx("textarea",{className:"input w-full h-24 resize-none",placeholder:`Type scores manually (one per line, e.g. T20
D16
5
25
50) - No camera needed!`,value:Nn,onChange:t=>Xt(t.target.value)}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ga,children:"Add All Scores"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Xt(""),children:"Clear"})]})]})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Enter to Add Â· Shift+Enter to Replace Last"})]}),e.jsx("div",{className:"h-1"})]})]}),e.jsx("div",{className:"hidden md:block w-[380px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2 sticky top-4 self-start",style:{willChange:"transform, opacity"},children:e.jsx(di,{scoringMode:x==="X01"?"x01":"custom",showToolbar:k,immediateAutoCommit:!1,cameraAutoCommit:y&&!ue?"camera":"parent",onAddVisit:q(H),onAutoDart:()=>{}})})})]})})}),Hs&&e.jsx(wo,{onClose:()=>ge(!1)}),Fn&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${So}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&fe("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?fe("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):fe("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{fe("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",El(Il(),5)]})]})]}),Hi&&typeof document<"u"?Xa.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>xt(!1),children:e.jsx(es,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>xt(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>xt(!1),children:"Close"})]}),e.jsx(Ol,{fill:!0,user:n,playerScore:U,aiScore:W,x01Score:C,inMatch:Us,showWinPopup:nr,pendingLegWinner:is,playerDartsThrown:fs,aiDartsThrown:bs,totalPlayerDarts:Wt,totalAiDarts:Gt,totalPlayerPoints:fn,totalAiPoints:pn,player180s:la,player140s:Ei,player100s:Ii,ai180s:oa,ai140s:Pi,ai100s:Bi,playerHighestCheckout:Fi,aiHighestCheckout:Vi,onClose:()=>xt(!1),onOpen:()=>xt(!0),layout:i})]})})}),document.body):null,Ss&&typeof document<"u"?Xa.createPortal((()=>{const{target:t,value:s,stage:a}=Ss,o=t==="player"?Ce:Fe,u=t==="player"?$:G;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:qt,children:e.jsx(es,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:qt,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",a," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:a===1?e.jsxs(e.Fragment,{children:["Set ",o,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",o,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:u})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:qt,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:al,children:"Yes"})]})]})})})})(),document.body):null,nr&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]",children:e.jsxs(es,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:On(Q.players?.[Q.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsx("label",{className:"block mb-1",children:"Darts to hit double:"}),e.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(t=>e.jsx("button",{className:`btn ${lr===t?"bg-brand-600":""}`,onClick:()=>fi(t),children:t},t))}),e.jsx("label",{className:"block mb-1",children:"Darts for checkout:"}),e.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(t=>e.jsx("button",{className:`btn ${or===t?"bg-brand-600":""}`,onClick:()=>pi(t),children:t},t))}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:Nl,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{le(!1),gt()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{le(!1),st(!1),tt(!1)},children:"Back to Menu"})]})]})}),Oi&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(es,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[x," Â· ",C," start Â· First to ",yt]}),(()=>{const t=Wt>0?fn/Wt*3:0,s=t*3,a=(()=>{const h=ve.filter(j=>j.winner==="player"&&typeof j.winnerDarts=="number").map(j=>j.winnerDarts);return h.length?`${Math.min(...h)} darts`:"â€”"})(),o=(()=>{const h=ve.filter(j=>j.winner==="player"&&typeof j.winnerDarts=="number").map(j=>j.winnerDarts);return h.length?`${Math.max(...h)} darts`:"â€”"})(),u=$t>0?Math.round(xn/$t*100):0,g=Gt>0?pn/Gt*3:0,b=g*3,N=(()=>{const h=ve.filter(j=>j.winner==="ai"&&typeof j.winnerDarts=="number").map(j=>j.winnerDarts);return h.length?`${Math.min(...h)} darts`:"â€”"})(),p=(()=>{const h=ve.filter(j=>j.winner==="ai"&&typeof j.winnerDarts=="number").map(j=>j.winnerDarts);return h.length?`${Math.max(...h)} darts`:"â€”"})(),v=Kt>0?Math.round(hn/Kt*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:n?.username||"You"}),e.jsx("div",{className:"text-3xl font-extrabold",children:$}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 9DA"}),e.jsx("div",{className:"font-semibold",children:s.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:$t})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[u,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:a})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:o})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:la})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[$," â€“ ",G]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:A==="None"?"Opponent":`${A} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:G}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:g.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 9DA"}),e.jsx("div",{className:"font-semibold",children:b.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:Kt})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[v,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:N})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:oa})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":A==="None"?"Opp":"AI"," ","Â· Dbl ",t.doubleDarts," Â· CO ",t.checkoutDarts]},s))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Shot Heat Map"}),e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black p-3",children:e.jsx(Wl,{})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>jn(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{jn(!1),gt()},children:"Rematch"})]})]})}),ve.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:ve.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",t.doubleDarts,", Checkout darts:"," ",t.checkoutDarts]},s))})]})]})]})}export{Go as default};
//# sourceMappingURL=OfflinePlay--wSvF8MS.js.map
