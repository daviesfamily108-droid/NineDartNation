import{u as S,p as M,j as e,J as k,K as y,L as I}from"./index-Dj7mIiiu.js";import{r as a}from"./ui-Vpbk6UnN.js";import{u as C}from"./match-BLqxJLcc.js";import{M as B}from"./MatchStartShowcase-DcDlfoQh.js";import"./vendor-D3F3s8fL.js";function O({open:u,onClose:n,onCreate:x}){const[r]=a.useState(()=>document.createElement("div")),[c,b]=a.useState("X01"),[o,p]=a.useState("bestof"),[l,f]=a.useState(3),[g,h]=a.useState(0),[m,d]=a.useState(c==="X01"?501:void 0),j=S().username||"Anonymous";C(),a.useLayoutEffect(()=>(r.className="ndn-create-match-portal",document.body.appendChild(r),()=>{try{r&&r.remove()}catch{}}),[r]);const N=()=>{x({createdBy:j,game:c,modeType:o,legs:l,avgChoice:g,startingScore:m}),n()};return!u||!r?null:M.createPortal(e.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4",onClick:n,children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full relative",onClick:s=>s.stopPropagation(),role:"dialog",children:[e.jsx("button",{"aria-label":"Close",className:"absolute top-3 right-3 text-red-600 font-bold",onClick:n,children:"✕"}),e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Create Match"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",children:"Created By"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded",children:j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-game",children:"Match Name (Game)"}),e.jsx("select",{id:"match-game",className:"w-full p-2 border rounded",value:c,onChange:s=>{const t=s.target.value;b(t);const i=y(t);d(i?.[0])},children:k.map(s=>e.jsx("option",{value:s,children:s},s))})]}),c==="X01"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-start",children:`${c} Starting Score`}),e.jsx("select",{id:"match-start",className:"w-full p-2 border rounded",value:m,onChange:s=>d(Number(s.target.value)),children:y(c).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",children:"Mode"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs("label",{className:`btn ${o==="bestof"?"btn-primary":"btn-ghost"}`,children:[e.jsx("input",{type:"radio",name:"mode",value:"bestof",checked:o==="bestof",onChange:()=>p("bestof"),className:"sr-only"})," Best Of"]}),e.jsxs("label",{className:`btn ${o==="firstto"?"btn-primary":"btn-ghost"}`,children:[e.jsx("input",{type:"radio",name:"mode",value:"firstto",checked:o==="firstto",onChange:()=>p("firstto"),className:"sr-only"})," First To"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-legs",children:"Legs"}),e.jsx("input",{id:"match-legs",type:"number",min:1,value:l,onChange:s=>f(Math.max(1,Number(s.target.value||1))),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-avg",children:"Average Choice (±)"}),e.jsx("input",{id:"match-avg",type:"number",value:g,onChange:s=>h(Number(s.target.value||0)),className:"w-full p-2 border rounded"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{className:"btn btn-primary",onClick:N,children:"Create Match"})})]})}),r)}function D({user:u}){const n=I(),x=!!(n&&n.connected),[r]=a.useState("room-1"),[c,b]=a.useState(!1),[o,p]=a.useState([]),[l,f]=a.useState(null),[g,h]=a.useState(60),m=C(),d=u?.username||"You",j=t=>{const v={id:`local-${Date.now()}`,...t,startingScore:t.startingScore||(t.game==="X01"?501:void 0),players:[t.createdBy]};p(w=>[v,...w]);try{n&&n.connected&&n.send({type:"create-match",match:v})}catch{}},N=t=>{if(t.createdBy===d){f({matchId:t.id,fromId:`u-${Date.now()}`,fromName:`${d}-test`,game:t.game});return}try{n&&n.connected&&n.send({type:"join-request",matchId:t.id,fromName:d})}catch{}},s=t=>{if(l){if(t){const i=o.find(v=>v.id===l.matchId);if(i)try{m.newMatch([i.createdBy,l.fromName||"Opponent"],i.startingScore||501)}catch{}}f(null)}};return a.useEffect(()=>{let t=null;return l?(h(60),t=setInterval(()=>h(i=>Math.max(0,i-1)),1e3)):h(60),()=>{t&&clearInterval(t)}},[l]),e.jsxs("div",{className:"card ndn-game-shell relative overflow-hidden",children:[e.jsx("h2",{className:"text-3xl font-bold text-brand-700 mb-4",children:"Online Play"}),e.jsx("div",{className:"ndn-shell-body",children:e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"text-xl font-semibold",children:"Online Lobby = World Lobby"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"px-3 py-1 bg-white/5 rounded border border-white/10",children:["Room ",r]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${x?"bg-emerald-400":"bg-rose-500"}`,title:x?"Connected":"Disconnected"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>b(!0),children:"Create Match +"})]})]}),e.jsx("hr",{className:"border-t-4 border-black/80 my-3"}),e.jsx("div",{className:"space-y-3",children:o.length===0?e.jsx("div",{className:"text-sm opacity-60",children:"No games created yet."}):o.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/3 border rounded",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:[t.game," ",t.modeType==="bestof"?"(Best Of)":"(First To)"," - ",t.legs," legs"]}),e.jsxs("div",{className:"text-xs opacity-70",children:["Created by: ",t.createdBy]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn btn-sm",onClick:()=>N(t),children:t.createdBy===d?"Simulate Join":"Join Now!"})})]},t.id))})]})}),c&&e.jsx(O,{open:c,onClose:()=>b(!1),onCreate:j}),l&&e.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/80 p-4",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-2xl p-6 max-w-lg w-full",children:[e.jsx("div",{className:"text-lg font-bold mb-2",children:"Join Request"}),e.jsxs("div",{className:"opacity-80 mb-4",children:[l.fromName||"Player"," wants to join your match (",l.game,"). Accept?"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>s(!0),children:["Accept (",g,"s)"]}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>s(!1),children:"Decline"})]})]})}),e.jsx(B,{open:m.inProgress,players:m.players,user:u,initialSeconds:15,roomId:r,onDone:()=>{},onRequestClose:()=>{}})]})}export{D as default};
//# sourceMappingURL=OnlinePlay.clean-BybyV-Q9.js.map
