import{C,u as B,t as E,j as e,D as L}from"./index-Dhnedrwu.js";import{r as a}from"./ui-Vpbk6UnN.js";import{G as F}from"./GameCalibrationStatus-OE67rABQ.js";import"./vendor-D3F3s8fL.js";function $({open:p,onClose:r,onCreate:j}){const[i]=a.useState(()=>document.createElement("div")),[n,g]=a.useState("X01"),[d,h]=a.useState("bestof"),[l,x]=a.useState(3),[u,N]=a.useState(0),[c,b]=a.useState(()=>C(n)?.[0]),f=B().username||"Anonymous";a.useLayoutEffect(()=>(i.className="ndn-create-match-portal",document.body.appendChild(i),()=>{try{i&&i.remove()}catch{}}),[i]),a.useLayoutEffect(()=>{function t(m){m.key==="Escape"&&r()}return p&&document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[p,r]);const w=()=>{j({createdBy:f,game:n,modeType:d,legs:l,avgChoice:u,startingScore:c}),r()};return!p||!i?null:E.createPortal(e.jsxs("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4",children:[e.jsx("button",{"aria-label":"Close dialog",className:"absolute inset-0 w-full h-full bg-transparent",onClick:r}),e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full relative",role:"dialog",children:[e.jsx("button",{"aria-label":"Close",className:"absolute top-3 right-3 text-red-600 font-bold",onClick:r,children:"✕"}),e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Create Match"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-80",children:"Created By"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 rounded",children:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-game",children:"Match Name (Game)"}),e.jsx("select",{id:"match-game",className:"w-full p-2 border rounded",value:n,onChange:t=>{const m=t.target.value;g(m);const v=C(m);b(v?.[0])},children:L.map(t=>e.jsx("option",{value:t,children:t},t))})]}),C(n)?.length?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-start",children:`${n} Starting Score`}),e.jsx("select",{id:"match-start",className:"w-full p-2 border rounded",value:c,onChange:t=>b(Number(t.target.value)),children:C(n).map(t=>e.jsx("option",{value:t,children:t},t))})]}):null,e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-80",children:"Mode"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs("label",{className:`btn ${d==="bestof"?"btn-primary":"btn-ghost"}`,children:[e.jsx("input",{type:"radio",name:"mode",value:"bestof",checked:d==="bestof",onChange:()=>h("bestof"),className:"sr-only"})," ","Best Of"]}),e.jsxs("label",{className:`btn ${d==="firstto"?"btn-primary":"btn-ghost"}`,children:[e.jsx("input",{type:"radio",name:"mode",value:"firstto",checked:d==="firstto",onChange:()=>h("firstto"),className:"sr-only"})," ","First To"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-legs",children:"Legs"}),e.jsx("input",{id:"match-legs",type:"number",min:1,value:l,onChange:t=>x(Math.max(1,Number(t.target.value||1))),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-avg",children:"Average Choice (±)"}),e.jsx("input",{id:"match-avg",type:"number",value:u,onChange:t=>N(Number(t.target.value||0)),className:"w-full p-2 border rounded"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{className:"btn btn-primary",onClick:w,children:"Create Match"})})]})]}),i)}function P({user:p}){const r=p?.username||"You",[j,i]=a.useState(0),[n,g]=a.useState(()=>[{id:1,name:"room-1",matches:[]}]),[d,h]=a.useState(!1),[l,x]=a.useState(null),[u,N]=a.useState(30),[c,b]=a.useState(null),[f,w]=a.useState(null),t=n[j],m=8,v=a.useMemo(()=>n.flatMap(s=>s.matches.map(o=>({...o,roomName:s.name}))),[n]),k=s=>{const o={id:`m-${Date.now()}`,createdBy:s.createdBy||r,game:s.game,modeType:s.modeType,legs:s.legs,startingScore:s.startingScore,createdAt:Date.now()};g(y=>y.map((S,T)=>T===j?{...S,matches:[o,...S.matches]}:S))},M=()=>{g(s=>{const o=s.length+1,y=[...s,{id:o,name:`room-${o}`,matches:[]}];return i(y.length-1),y})};a.useEffect(()=>{if(!l)return;N(30),b(null),w(null);const s=setInterval(()=>N(o=>Math.max(0,o-1)),1e3);return()=>clearInterval(s)},[l]);const R=()=>{x(null)};return e.jsx("div",{className:"flex-1 min-h-0",style:{position:"relative",marginTop:0},children:e.jsxs("div",{className:"card ndn-game-shell relative overflow-hidden h-full flex flex-col",children:[e.jsx("h2",{className:"text-3xl font-bold text-brand-700 mb-4",children:"Online Play"}),e.jsx("div",{className:"ndn-shell-body flex-1 overflow-hidden p-3",children:e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4 h-full min-h-[320px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm opacity-80",children:"Room"}),e.jsxs("div",{className:"px-3 py-1 bg-white/5 rounded border border-white/10",children:["Room (",t?.id,")"]}),e.jsx("div",{style:{width:12}}),e.jsx("button",{className:"btn btn-ghost",onClick:M,children:"New Room"})]}),e.jsxs("div",{className:"ml-auto",children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>h(!0),disabled:(t?.matches?.length||0)>=m,children:"Create Match +"}),(t?.matches?.length||0)>=m&&e.jsx("div",{className:"text-xs text-rose-400 mt-1",children:"Room full — create a new room"})]})]}),e.jsx("p",{className:"mb-2"}),e.jsx("h3",{className:"font-semibold underline mb-3",children:"Matches in this Room"}),e.jsx("div",{className:"space-y-3 mb-4",children:(t?.matches?.length||0)===0?e.jsx("div",{className:"text-sm opacity-60",children:"No matches in this room yet."}):t.matches.map(s=>e.jsxs("div",{className:"p-3 rounded bg-white/3 border flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sm",children:[s.game," ",s.modeType==="bestof"?"(Best Of)":"(First To)"," - ",s.legs," legs"]}),s.startingScore&&e.jsxs("div",{className:"text-xs opacity-80",children:["Starting: ",e.jsx("span",{className:"font-mono",children:s.startingScore})]}),e.jsxs("div",{className:"text-xs opacity-70",children:["Created by: ",s.createdBy]})]}),e.jsx("div",{className:"ml-4",children:e.jsx("button",{className:"btn btn-sm",onClick:()=>x(s),children:"Join Now!"})})]},s.id))}),e.jsx("h3",{className:"font-semibold underline mb-3",children:"World Lobby"}),e.jsx("div",{className:"space-y-3",children:v.length===0?e.jsx("div",{className:"text-sm opacity-60",children:"No matches found."}):v.map(s=>e.jsxs("div",{className:"p-3 rounded bg-white/3 border flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sm",children:[s.game," ",s.modeType==="bestof"?"(Best Of)":"(First To)"," - ",s.legs," legs"]}),s.startingScore&&e.jsxs("div",{className:"text-xs opacity-80",children:["Starting: ",e.jsx("span",{className:"font-mono",children:s.startingScore})]}),e.jsxs("div",{className:"text-xs opacity-70",children:["Created by: ",s.createdBy," • Room: ",s.roomName]})]}),e.jsx("div",{className:"ml-4",children:e.jsx("button",{className:"btn btn-sm",onClick:()=>x(s),children:"Join Now!"})})]},s.id))})]})}),e.jsx($,{open:d,onClose:()=>h(!1),onCreate:s=>{k(s),h(!1)}}),l&&e.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4",children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full",children:[e.jsx("div",{className:"text-lg font-bold mb-2",children:"Join Match"}),e.jsxs("div",{className:"mb-3",children:[l.game," - ",l.modeType," • ",l.legs," legs"]}),e.jsxs("div",{className:"text-sm opacity-80 mb-3",children:["Created by ",l.createdBy]}),e.jsx("div",{className:"mb-3",children:e.jsx(F,{gameMode:l.game,compact:!0})}),l.startingScore&&e.jsxs("div",{className:"mb-3",children:["Starting score: ",e.jsx("span",{className:"font-mono",children:l.startingScore})]}),e.jsxs("div",{className:"mb-3",children:["Timer: ",e.jsxs("span",{className:"font-mono",children:[u,"s"]})]}),u<=15&&e.jsxs("div",{className:"mb-3",children:["Choose: ",e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`btn ${c==="bull"?"btn-primary":"btn-ghost"}`,onClick:()=>b("bull"),children:"Bull Up"}),e.jsx("button",{className:`btn ${c==="skip"?"btn-primary":"btn-ghost"}`,onClick:()=>b("skip"),children:"Skip"})]}),e.jsx("div",{className:"text-xs opacity-70 mt-2",children:c?`You chose: ${c}`:"Please choose Bull Up or Skip before accepting"}),c==="skip"&&e.jsx("div",{className:"text-xs opacity-70 mt-2",children:"Skip requires both players to click Skip. Waiting for other player…"}),c==="skip"&&f==="skip"&&e.jsx("div",{className:"text-sm font-semibold mt-2",children:"Both players skipped — Left player throws first"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:R,disabled:u<=15&&!c,children:"Accept"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>x(null),children:"Cancel"})]})]})})]})})}export{P as default};
//# sourceMappingURL=OnlinePlay.clean-D5PZ_758.js.map
