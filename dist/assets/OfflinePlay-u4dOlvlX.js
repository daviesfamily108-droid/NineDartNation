import{j as e,u as cl,i as Qa,k as dl,e as ul,l as ml,m as xl,n as Us,o as Bt,p as er,q as Vs,M as hl,r as Ya,t as I,v as tr,w as Za,x as Ja,y as ei,R as rt,P as ti,C as L,G as at,z as fl,A as pl,h as bl,B as gl,D as vl}from"./index-ALD5k1ur.js";import{r}from"./ui-Cl5S-Tv0.js";import{u as Oe,A as re,P as jl}from"./aroundTheClock-Cqqf9SE2.js";import{S as Nl}from"./ScoreNumberPad-Dd1JGFwO.js";import{f as yl}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const it=[...Array.from({length:20},(n,i)=>({label:`D${i+1}`,score:(i+1)*2})),{label:"DBULL",score:50,isBull:!0}];function si(n,i){const c=it[i];return!!c&&n===c.score}function Ft(n){const i=n.trim().toUpperCase();if(!i)return null;if(i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL")return 50;if(i==="25"||i==="OBULL")return 25;const c=i.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!c)return null;const h=c[1]||"S",d=parseInt(c[2],10);return d<1||d>20?null:d*(h==="S"?1:h==="D"?2:3)}const dr=[20,19,18,17,16,15,25];function sr(){const n={};return dr.forEach(i=>{n[i]=0}),{marks:n,points:0}}function wl(n,i,c,h,d=()=>!1){let m=null,b=0;if(c==="BULL"||c==="INNER_BULL"||i===25||i===50)m=25,b=c==="INNER_BULL"||i===50?2:1;else if(typeof h=="number"&&h>=15&&h<=20)m=h,c==="TRIPLE"?b=3:c==="DOUBLE"?b=2:b=1;else if(i){const me=[20,19,18,17,16,15];for(const Ae of me){if(i===Ae){m=Ae,b=1;break}if(i===Ae*2){m=Ae,b=2;break}if(i===Ae*3){m=Ae,b=3;break}}!m&&(i===25||i===50)&&(m=25,b=i===50?2:1)}if(!m)return 0;const U=n.marks[m],lt=Math.max(0,3-U),De=Math.min(lt,b),j=Math.max(0,b-De),Ie=U+De;n.marks[m]=Ie>3?3:Ie;let z=0;return j>0&&!d(m)&&(m===25?c==="INNER_BULL"?z+=50*j:z+=25*j:z+=m*j),n.points+=z,z}function Sl(n){return dr.every(i=>(n.marks[i]||0)>=3)}function nr(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function kl(n){return n.round}function Cl(n,i,c,h){if(n.finished)return 0;const d=kl(n);let m=0;return typeof h=="number"&&h===d?c==="TRIPLE"?(m=d*3,n.turnHits.triples++):c==="DOUBLE"?(m=d*2,n.turnHits.doubles++):c==="SINGLE"&&(m=d*1,n.turnHits.singles++):!h&&(i===d||i===d*2||i===d*3)&&(i===d*3?(m=d*3,n.turnHits.triples++):i===d*2?(m=d*2,n.turnHits.doubles++):i===d&&(m=d,n.turnHits.singles++)),n.score+=m,m}function Dl(n){if(!n.finished){if(n.turnHits.singles>0&&n.turnHits.doubles>0&&n.turnHits.triples>0){n.shanghaiAchieved=!0,n.finished=!0;return}const i=n.round+1;i>20?n.finished=!0:n.round=i}n.turnHits={singles:0,doubles:0,triples:0}}function rr(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function ir(n){return n.targets[n.stage]||null}function Al(n,i,c,h){if(n.finished)return 0;const d=ir(n);if(!d)return 0;let m=0;switch(d.kind){case"NUMBER":{typeof h=="number"&&h===d.num?c==="TRIPLE"?m=d.num*3:c==="DOUBLE"?m=d.num*2:c==="SINGLE"&&(m=d.num):!h&&(i===d.num||i===d.num*2||i===d.num*3)&&(m=i),m>0&&(n.hitThisRound=!0);break}case"DOUBLE":{(c==="DOUBLE"&&h===d.num||i===d.num*2)&&(m=d.num*2,n.hitThisRound=!0);break}case"TRIPLE":{(c==="TRIPLE"&&h===d.num||i===d.num*3)&&(m=d.num*3,n.hitThisRound=!0);break}case"BULL":{(c==="BULL"||c==="INNER_BULL"||i===25||i===50)&&(m=c==="INNER_BULL"||i===50?50:25,n.hitThisRound=!0);break}case"ANY_NUMBER":{i>0&&(m=i,n.hitThisRound=!0);break}}return n.score+=m,m}function Tl(n){n.finished||(n.hitThisRound||(n.score=Math.floor(n.score/2)),n.hitThisRound=!1,n.stage+=1,n.stage>=n.targets.length&&(n.finished=!0))}function ar(){return{round:1,score:0,target:"HIGH",finished:!1}}function Ll(n,i,c,h){if(n.finished)return 0;let d=0;if(n.target==="HIGH")if(c==="INNER_BULL")d=50;else if(typeof h=="number"){const b=h*(c==="TRIPLE"?3:c==="DOUBLE"?2:1);h>=20&&(d=b)}else i>=40&&(d=i);else if(typeof h=="number"){const b=h*(c==="TRIPLE"?3:c==="DOUBLE"?2:1);h<=10&&(d=b)}else i>0&&i<=30&&(d=i);return n.score+=d,d}function Ml(n){if(!n.finished){if(n.round+=1,n.round>10){n.finished=!0;return}n.target=n.target==="HIGH"?"LOW":"HIGH"}}function El(n,i=3){return{number:n,lives:i,isKiller:!1,eliminated:!1}}function Rl(n){const i=Array.from({length:20},(h,d)=>d+1),c={};for(const h of n){const d=Math.floor(Math.random()*i.length),m=i.splice(d,1)[0];c[h]=m}return c}function ni(n,i,c,h){const d=i[n];if(!d||!h||!c)return{becameKiller:!1};if(!d.isKiller&&c==="DOUBLE"&&h===d.number)return d.isKiller=!0,{becameKiller:!0};if(d.isKiller&&(c==="DOUBLE"||c==="TRIPLE")){const m=Object.keys(i).find(b=>b!==n&&!i[b].eliminated&&i[b].number===h);if(m){const b=i[m],U=c==="TRIPLE"?2:1;return b.lives=Math.max(0,b.lives-U),b.lives===0&&(b.eliminated=!0),{becameKiller:!1,victimId:m,livesRemoved:U}}}return{becameKiller:!1}}function ri(n){const i=Object.entries(n).filter(([,c])=>!c.eliminated&&c.lives>0);return i.length===1?i[0][0]:null}function ai(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function Pl(n,i,c,h){if(n.finished)return 0;let d=0;if(typeof h=="number"&&h===n.inning?c==="TRIPLE"?d=3:c==="DOUBLE"?d=2:d=1:!h&&(i===n.inning||i===n.inning*2||i===n.inning*3)&&(d=i===n.inning*3?3:i===n.inning*2?2:1),n.score+=d,n.dartsThisInning+=1,n.dartsThisInning>=3){const m=n.inning+1;m>9?n.finished=!0:(n.inning=m,n.dartsThisInning=0)}return d}const Il={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function ii(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function Bl(n,i,c,h){if(n.finished)return!1;const d=Il[n.hole];if(n.dartsThisHole+=1,typeof h=="number"&&h===d&&(c==="SINGLE"||c==="DOUBLE"||c==="TRIPLE")||!h&&(i===d||i===d*2||i===d*3)){n.strokes+=n.dartsThisHole;const b=n.hole+1;return b>18?n.finished=!0:(n.hole=b,n.dartsThisHole=0),!0}if(n.dartsThisHole>=3){n.strokes+=3;const b=n.hole+1;b>18?n.finished=!0:(n.hole=b,n.dartsThisHole=0)}return!1}const hi={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function li(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function Fl(n){const i=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[c,h,d]of i)if(n[c]&&n[c]===n[h]&&n[c]===n[d])return n[c];return n.every(c=>c)?"Draw":null}function Hl(n,i,c,h,d){if(n.finished||n.board[i])return!1;const m=hi[i];let b=!1;if(m.type==="BULL"?b=h==="BULL"||h==="INNER_BULL"||c===25||c===50:m.type==="NUM"&&typeof m.num=="number"&&(typeof d=="number"&&d===m.num||!d&&(c===m.num||c===m.num*2||c===m.num*3))&&(b=!0),!b)return!1;n.board[i]=n.turn;const U=Fl(n.board);return U?(n.finished=!0,n.winner=U,!0):(n.turn=n.turn==="X"?"O":"X",!0)}function lr(){return{targetIndex:0,darts:0,finished:!1}}const fi=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],Os=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function Ul(n){return fi[n.targetIndex]}function $s(n,i,c){if(n.finished)return n;const h=Ul(n);if(!(c==="SINGLE"&&i===h||c==="DOUBLE"&&i===h||c==="TRIPLE"&&i===h||c==="INNER_BULL"&&h===25))return n;const m=n.targetIndex+1,b=m>=fi.length;return{targetIndex:m,darts:n.darts+1,finished:b}}function oi(n,i){return $s(n,i,"SINGLE")}function Vl(){return lr()}function or(n=50){return{score:0,darts:0,finished:!1,target:n}}const Ol=[5,10,15,20,25,50];function $l(n){return Ol.includes(n)}function _s(n,i,c){if(n.finished)return n;if(!$l(i))return{...n,darts:n.darts+1};const h=n.score+i,d=h>=n.target;return{score:d?n.target:h,darts:n.darts+1,finished:d,target:n.target}}function ci(n,i){return _s(n,i)}function _l(n=50){return or(n)}function cr(n=70){return{score:0,darts:0,finished:!1,target:n}}const Kl=[7,14,21];function Wl(n){return Kl.includes(n)}function Ks(n,i,c){if(n.finished)return n;if(!Wl(i))return{...n,darts:n.darts+1};const h=n.score+i,d=h>=n.target;return{score:d?n.target:h,darts:n.darts+1,finished:d,target:n.target}}function di(n,i){return Ks(n,i)}function Gl(n=70){return cr(n)}const ur=[20,19,18,17,16,15,14,13,12,25];function ui(){const n={};return ur.forEach(i=>{n[i]=0}),{marks:n,points:0}}function zl(n,i,c,h,d=()=>!1){let m=null,b=0;if(c==="BULL"||c==="INNER_BULL"||i===25||i===50)m=25,b=c==="INNER_BULL"||i===50?2:1;else if(typeof h=="number"&&h>=12&&h<=20)m=h,c==="TRIPLE"?b=3:c==="DOUBLE"?b=2:b=1;else if(i){for(const me of[20,19,18,17,16,15,14,13,12]){if(i===me){m=me,b=1;break}if(i===me*2){m=me,b=2;break}if(i===me*3){m=me,b=3;break}}!m&&(i===25||i===50)&&(m=25,b=i===50?2:1)}if(!m)return 0;const U=n.marks[m],lt=Math.max(0,3-U),De=Math.min(lt,b),j=Math.max(0,b-De),Ie=U+De;n.marks[m]=Ie>3?3:Ie;let z=0;return j>0&&!d(m)&&(m===25?c==="INNER_BULL"?z+=50*j:z+=25*j:z+=m*j),n.points+=z,z}function Xl(n){return ur.every(i=>(n.marks[i]||0)>=3)}function ql({left:n,right:i,className:c="",sticky:h=!0}){return e.jsxs("div",{className:`${h?"sticky top-0":""} card relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm ${c}`,children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:[n," ðŸŽ¯"]}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:i})]})}function G(n){return(i,c)=>{n(i)}}function Ql(n){const{match:i,commitManualVisitTotal:c,endTurn:h}=n;return{addVisit:(d,m=3,b)=>{if(c){c(d);return}try{i.addVisit(d,m,b)}catch{i.addVisit(d,m)}},undoVisit:()=>{i.undoVisit()},nextPlayer:()=>{if(h)try{h(0)}catch{i.nextPlayer()}else i.nextPlayer()},endLeg:d=>{typeof d=="number"?i.endLeg(d):i.endLeg(0)},endGame:()=>{i.endGame()}}}const mi=r.memo(L),xi=["Easy","Medium","Hardened"],Yl=6500;function je(n,i,c){return Math.max(i,Math.min(c,n))}function Zl(n,i){let c=0;if(i==="Easy"){const h=[22,26,41,45,60];c=h[Math.floor(Math.random()*h.length)]}else i==="Medium"?c=Math.round(je(60+(Math.random()*30-15),30,100)):c=Math.round(je(80+(Math.random()*20-10),50,120));return n<=0?0:c>n?[100,85,81,60,57,45,41,26,22,20,1].find(d=>d<=n)??0:c}function Jl({onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-start justify-center pt-8 z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:n,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const eo=bl();function Mo({user:n}){const{offlineLayout:i,favoriteDouble:c,callerEnabled:h,callerVoice:d,callerVolume:m,speakCheckoutOnly:b,rememberLastOffline:U,setLastOffline:lt,autoStartOffline:De,cameraEnabled:j,textSize:Ie,boxSize:z,autoscoreProvider:me,autoCommitMode:Ae="wait-for-clear",matchType:pi="singles",setMatchType:bi,teamAName:gi="Team A",setTeamAName:vi,teamBName:ji="Team B",setTeamBName:Ni}=cl(),mr=me==="manual",A=j&&!mr,$e=i==="classic"?"classic":"modern",Ht=j&&!mr&&Ae!=="immediate",[o,Ws]=r.useState("X01"),[xr,Gs]=r.useState(()=>Qa("X01")),[k,Ut]=r.useState(501),[R,hr]=r.useState("None"),[yi,fr]=r.useState(!1),[Vt,ot]=r.useState(!1),[xe,X]=r.useState(k),[ae,Ot]=r.useState(k),[to,pr]=r.useState(!1),[br,V]=r.useState(!1),[ct,gr]=r.useState(1),[q,$t]=r.useState(0),B=dl(),[wi,vr]=r.useState(!1),jr=r.useRef(!1),[Q,_t]=r.useState(0),[Kt,O]=r.useState(null),[Wt,Nr]=r.useState(1),[Gt,yr]=r.useState(1),[Ne,wr]=r.useState([]),[Sr,Si]=r.useState(2e3),ye=ul(),[_e,Ke]=r.useState(!1),[kr,he]=r.useState(!1),[zs,zt]=r.useState(!1),[dt,We]=r.useState({player:!1,opponent:!1}),Xt=ml(t=>t.setPaused);r.useEffect(()=>{const t=()=>{Ke(!1),ot(!1),he(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[ut,ki]=r.useState(!1),[mt,Ci]=r.useState(!1),[qt,Cr]=r.useState(1),[so,Dr]=r.useState(!1),[ie,xt]=r.useState(!0),[Xs,Di]=r.useState(()=>typeof window<"u"&&window.innerWidth<768),[no,Ai]=r.useState(!1);r.useEffect(()=>{if(typeof window>"u")return;const t=()=>Di(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),r.useEffect(()=>{Xs||Ai(!1)},[Xs]),r.useEffect(()=>{const t=()=>Je(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[C,y]=r.useState(0),[Be,qs]=r.useState(0),[ht,Qs]=r.useState(0),[le,Ar]=r.useState(0),[Qt,Tr]=r.useState(0),[ft,Ys]=r.useState(sr()),[Yt,Zt]=r.useState(nr()),[we,Jt]=r.useState(rr()),[Te,es]=r.useState(ar()),[ro,Y]=r.useState(0),[ts,Lr]=r.useState(1),[Zs,Js]=r.useState(27),[ao,Mr]=r.useState(0),[Ti,en]=r.useState(0),[Er,Rr]=r.useState(!1),[ss,Pr]=r.useState(1),[tn,Ir]=r.useState(0),[io,Br]=r.useState(0),Li=8,[ns,Fr]=r.useState(1),[sn,Hr]=r.useState(0),[lo,Ur]=r.useState(0),Mi=10,[rs,Vr]=r.useState(1),[nn,Or]=r.useState(0),[oo,$r]=r.useState(0),Ei=10,[pt,rn]=r.useState(170),[_r,Kr]=r.useState(0),[as,Wr]=r.useState(0),[is,Gr]=r.useState(0),[bt,an]=r.useState(121),[zr,Xr]=r.useState(0),[ls,qr]=r.useState(0),[os,Qr]=r.useState(0),[Se,ln]=r.useState(20),[gt,on]=r.useState(0),[Yr,cn]=r.useState(0),[Fe,Ri]=r.useState(30),[Zr,dn]=r.useState(!1),[vt,Jr]=r.useState(ai()),[jt,ea]=r.useState(ii()),[fe,ta]=r.useState(li()),[un,sa]=r.useState(ui()),[P,mn]=r.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[Nt,yt]=r.useState({}),[cs,xn]=r.useState({}),[na,hn]=r.useState(!1),[pe,Ge]=r.useState(0),[co,ze]=r.useState(0),[Xe,wt]=r.useState(null),[Pi,ke]=r.useState(""),[ds,uo]=r.useState(lr()),[Z,qe]=r.useState(lr()),[be,mo]=r.useState(or(50)),[oe,St]=r.useState(or(50)),[ge,xo]=r.useState(cr(70)),[ce,kt]=r.useState(cr(70)),[ra,Qe]=r.useState(0),[fn,He]=r.useState(0),[de,$]=r.useState(0),[pn,Ct]=r.useState(k),[Ue,J]=r.useState(0),[bn,Le]=r.useState(null),[us,_]=r.useState(0),ms=r.useRef(0),Ii=r.useRef(0),ee=r.useRef(xe),H=r.useRef(de),te=r.useRef(Ue),Ye=r.useRef(pn),se=r.useRef(us);r.useEffect(()=>{ee.current=xe},[xe]),r.useEffect(()=>{H.current=de},[de]),r.useEffect(()=>{te.current=Ue},[Ue]),r.useEffect(()=>{Ye.current=pn},[pn]),r.useEffect(()=>{se.current=us},[us]);const[Bi,Dt]=r.useState(0);r.useRef(null);const[aa,gn]=r.useState(0),[vn,jn]=r.useState(0),[Nn,Ze]=r.useState(0),[yn,Me]=r.useState(0),[wn,At]=r.useState(null),[Sn,Tt]=r.useState(0),[xs,Lt]=r.useState(0),[ia,hs]=r.useState(0),[fs,la]=r.useState(0),[oa,ca]=r.useState(0),[kn,Mt]=r.useState(0),[Cn,da]=r.useState(0),[ua,ps]=r.useState(0),[ma,xa]=r.useState(0),[ha,bs]=r.useState(0),[Fi,gs]=r.useState(0),[Hi,vs]=r.useState(0),[fa,Dn]=r.useState(0),[Ui,An]=r.useState(0),[Vi,Tn]=r.useState(0),[Oi,js]=r.useState(0),[$i,pa]=r.useState(0),[Ns,ys]=r.useState(null),[_i,Ee]=r.useState(!1),[Ki,Ln]=r.useState(!1),[K,W]=r.useState(""),[ho,fo]=r.useState(""),[po,bo]=r.useState(""),[go,vo]=r.useState(""),[jo,ba]=r.useState(""),[No,ga]=r.useState(""),[ws,va]=r.useState(null),[Wi,Je]=r.useState(!1),[Mn,En]=r.useState(!1),[Gi,ja]=r.useState({}),[yo,Ss]=r.useState(!1),Ve=r.useRef(null),Rn=r.useRef(null),ve=r.useCallback(()=>{const t=Rn.current;t&&(clearTimeout(t),Rn.current=null)},[]),zi=r.useCallback(t=>{if(t>0&&t<=60){const s=xl(t,c);ys({remaining:t,routes:s}),Ee(!0)}else ys(null),Ee(!1)},[c]),ks=r.useCallback(()=>{try{Us({type:"quit"})}catch{}Ke(!1),ot(!1),he(!1),zt(!1),We({player:!1,opponent:!1})},[]);r.useEffect(()=>{zs&&dt.player&&dt.opponent&&ks()},[ks,dt,zs]);const Na=r.useCallback(t=>{if(!h)return;const s=Bt(n,"Player");try{er(s,t.visitTotal,Math.max(t.remaining,0),d,{volume:m,checkoutOnly:b})}catch{}},[h,d,m,b,n]),ya=r.useCallback((t,s)=>{Ss(!1);const{visitTotal:a,darts:l,preRemaining:u,remaining:g,doubleAttempts:p,finished:N,doubleWindow:f,highestCheckout:x}=t;N?(X(0),ee.current=0,typeof x=="number"&&x>0&&js(v=>Math.max(v,x))):(X(g),ee.current=g),Le(a),a===180?bs(v=>v+1):a>=140?gs(v=>v+1):a>=100&&vs(v=>v+1),f&&p>0&&(Lt(v=>v+p),N&&hs(v=>v+1)),t.announced||Na(t);try{Vs.getState().recordVisit("offline-x01",l,a,{preRemaining:u,postRemaining:N?0:g,finish:N,bust:!1})}catch{}try{B.addVisit(a,l,{visitTotal:a}),N&&B.endLeg(u)}catch{}N&&(O("player"),V(!0)),It(N?0:g),J(0),te.current=0,$(0),H.current=0,_(0),se.current=0},[It,js,O,X,Le,J,$,_,V,bs,gs,vs,Lt,hs,Na]),et=r.useCallback(t=>{const s=Ve.current;s&&(Ve.current=null,ve(),ya(s,t))},[ve,ya]);r.useCallback(t=>{Ve.current={...t,announced:!1},Ss(!0),ve(),Rn.current=setTimeout(()=>et("timeout"),Yl)},[ve,et]),r.useEffect(()=>{if(!Ht)return;const t=()=>et("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[Ht,et]),r.useEffect(()=>{Ht||et("timeout")},[Ht,et]),r.useEffect(()=>()=>ve(),[ve]),r.useEffect(()=>{if(de===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}ms.current=0}Ii.current=de},[de]);const D=Bt(n,"Player 1"),Cs=R==="None"?"Player 2":R,Ds=Oe("X01",xe,ae,q,Q,fn,vn,Ue,Nn,bn,wn,de,yn,ia,xs,oa,fs,Ne,ie,R,k),wa=Oe("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ft),Pn=Oe("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ie,R,void 0,ft,Yt),In=Oe("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,P,Nt,cs,pe),Bn=Oe("Scam"),Fn=Oe("Fives"),Hn=Oe("Sevens"),Un=r.useMemo(()=>{switch(o){case"Cricket":return wa;case"Shanghai":return Pn;case"Killer":return In;case"Scam":return Bn;case"Fives":return Fn;case"Sevens":return Hn;default:return Ds}},[o,wa,Pn,In,Bn,Fn,Hn,Ds]),Xi=o==="X01"?`${q}-${Q}`:void 0,As=r.useMemo(()=>{const t=Ds||[],s=de>0?Ue:bn??fn,a=yn>0?Nn:wn??vn;return t.length===0?{name:ie?D:Cs,isCurrentTurn:!0,legsWon:ie?q:Q,score:ie?xe:ae,lastScore:ie?s:a}:t.find(l=>l.isCurrentTurn)??t[0]},[Ds,ie,D,Cs,q,Q,xe,ae,de,Ue,bn,fn,Nn,wn,vn,yn]),Sa=r.useMemo(()=>{if(!As)return[];const{matchAvg:t,allTimeAvg:s,...a}=As;return[{...a,matchAvg:void 0,allTimeAvg:void 0}]},[As]);As?.name;const ka=ie?xe:ae,Ts=B.players?.[B.currentPlayerIdx];let Ca=0,Da=0;if(Ts&&Ts.legs&&Ts.legs.length>0){for(const t of Ts.legs)if(Array.isArray(t.visits))for(const s of t.visits)Ca+=s.score||0,Da+=s.darts||0}const qi=Ca+(Ue||0),Aa=Da+(de||0),Ta=Aa>0?qi/Aa*3:0,Vn=r.useMemo(()=>{if(Un.length>0)return Un;switch(o){case"Double Practice":return[{name:D,isCurrentTurn:!0,target:it[Be]?.label||"â€”",hits:ht,totalNeeded:it.length}];case"Around the Clock":return[{name:D,isCurrentTurn:!0,target:re[le]===25?"25 (Outer Bull)":re[le]===50?"50 (Inner Bull)":re[le]||"â€”",hits:Qt,totalNeeded:re.length}];case"Treble Practice":return[{name:D,isCurrentTurn:!0,target:`T${Se}`,hits:gt,totalNeeded:Fe}];case"Count-Up":return[{name:D,isCurrentTurn:!0,score:tn,round:ss}];case"High Score":return[{name:D,isCurrentTurn:!0,score:sn,round:ns}];case"Low Score":return[{name:D,isCurrentTurn:!0,score:nn,round:rs}];case"Checkout 170":return[{name:D,isCurrentTurn:!0,remaining:pt,attempts:as,successes:is}];case"Checkout 121":return[{name:D,isCurrentTurn:!0,remaining:bt,attempts:ls,successes:os}];case"Bob's 27":return[{name:D,isCurrentTurn:!0,target:ts,score:Zs}];case"Baseball":return[{name:D,isCurrentTurn:!0,inning:vt.inning,score:vt.score}];case"Golf":return[{name:D,isCurrentTurn:!0,hole:jt.hole,strokes:jt.strokes}];case"Tic Tac Toe":return[{name:D,isCurrentTurn:!0,turn:fe.turn,winner:fe.winner}];case"Scam":return[{name:D,isCurrentTurn:!0,target:Os[Z.targetIndex]||"â€”",darts:Z.darts,finished:Z.finished}];case"Fives":return[{name:D,isCurrentTurn:!0,score:be.score,target:be.target,darts:be.darts}];case"Sevens":return[{name:D,isCurrentTurn:!0,score:ge.score,target:ge.target,darts:ge.darts}];case"High-Low":return[{name:D,isCurrentTurn:!0,round:Te.round,target:Te.target,score:Te.score}];case"Halve It":return[{name:D,isCurrentTurn:!0,round:we.stage+1,target:(()=>{const t=ir(we);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})(),score:we.score}];default:return Sa}},[Un,o,D,Be,ht,le,Qt,Se,gt,Fe,tn,ss,sn,ns,nn,rs,pt,as,is,bt,ls,os,ts,Zs,vt,jt,fe,Z,be,ge,Te,we,Sa]),Et=r.useMemo(()=>{if(o==="X01")return{primaryLabel:"Current score",primaryValue:ka,secondaryLabel:"3-dart avg",secondaryValue:Ta.toFixed(1),secondaryClass:"text-emerald-300"};const t=Vn[0],s=t?.score??t?.points??t?.lives??t?.remaining??0;let a="Target",l=t?.target??t?.round??"â€”";return o==="Cricket"||o==="American Cricket"?(a="Points",l=t?.points??0):o==="Killer"?(a="Lives",l=t?.lives??0):o==="Checkout 170"||o==="Checkout 121"?(a="Remaining",l=t?.remaining??0):o==="Baseball"?(a="Inning",l=t?.inning??1):o==="Golf"?(a="Hole",l=t?.hole??1):(o==="Scam"||o==="Fives"||o==="Sevens")&&(a="Target",l=t?.target??"â€”"),{primaryLabel:"Score",primaryValue:s,secondaryLabel:a,secondaryValue:l,secondaryClass:"text-white"}},[o,ka,Ta,Vn]),Re=r.useCallback(t=>Math.max(0,Math.min(99,Math.round(t||0))).toString(),[]),T=r.useCallback((t,s=1)=>{!t||s<=0||ja(a=>({...a,[t]:(a[t]||0)+s}))},[]),E=r.useCallback(t=>{t&&ja(s=>s[t]===void 0?s:{...s,[t]:0})},[]);Gi[o];const La=r.useCallback(()=>{Ve.current&&(Ve.current=null),ve(),Ss(!1)},[ve]);r.useCallback(t=>{const s=je(t,0,k);La(),X(s),ee.current=s;const a=s===0?k:s;Ct(a),Ye.current=a,J(0),te.current=0,$(0),H.current=0,_(0),se.current=0,Le(null),He(0),y(0),ms.current=0,s===0?(O("player"),V(!0)):(O(null),V(!1))},[La,X,k,Ct,J,$,_,Le,He,y,O,V]);const Ma=r.useCallback((t,s)=>{t==="player"?($t(s),ba("")):(_t(s),ga("")),O(null),V(!1)},[_t,ga,ba,O,$t,V]),Qi=r.useCallback(()=>{va(t=>t&&(t.stage===1?{...t,stage:2}:(Ma(t.target,t.value),null)))},[Ma]),Rt=r.useCallback(()=>{va(null)},[]);r.useEffect(()=>{if(!ws)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),Rt())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[Rt,ws]);const On=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(Ie),tt=r.useRef(null),st=r.useRef(null),$n=r.useRef(null),[Ce,Pt]=r.useState("first"),[nt,_n]=r.useState(1),Yi=r.useRef(null);r.useEffect(()=>{const t=Math.max(1,Math.floor(Number(nt)||1)),s=Ce==="first"?t:Math.max(1,Math.ceil(t/2));gr(s)},[Ce,nt]),r.useEffect(()=>{if(!mt){Cr(1),Dr(!1);return}const t=()=>{const l=tt.current,u=st.current;if(!l||!u)return;const g=$n.current?$n.current.getBoundingClientRect().height:0,p=Math.max(0,l.clientHeight-g-6),N=Math.max(0,l.clientWidth-8),f=u.getBoundingClientRect(),x=qt||1,v=f.height/x,w=f.width/x,M=p>0?p/v:1,S=N>0?N/w:1,Hs=Math.min(1,Math.max(.5,Math.min(M,S))),ue=v*Hs,ol=p>0&&ue-p>1;Dr(ol),Cr(Hs)};t();const s=window.ResizeObserver,a=s?new s(()=>t()):null;return a&&tt.current&&a.observe(tt.current),a&&st.current&&a.observe(st.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{a&&tt.current&&a.unobserve(tt.current)}catch{}try{a&&st.current&&a.unobserve(st.current)}catch{}}},[mt,qt]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.mode;a&&(Ws(a),Pe())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.formatType,l=s?.detail?.formatCount,u=s?.detail?.startScore;(a==="first"||a==="best")&&Pt(a),typeof l=="number"&&isFinite(l)&&_n(Math.max(1,Math.floor(l))),typeof u=="number"&&isFinite(u)&&Ut(Math.max(1,Math.floor(u)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),r.useEffect(()=>{if(!De)return;const t=setTimeout(()=>Pe(),50);return()=>clearTimeout(t)},[De]),r.useEffect(()=>{if(!_e||ie||R==="None"||Bi<=0)return;let t,s=performance.now();const a=l=>{const u=l-s;s=l,Dt(g=>{const p=g-u;if(p<=0){let N=0,f=0,x=ae;for(Me(0);N<3&&x>0;){const v=Zl(x,R),w=je(v-N*20,0,Math.min(60,x)),M=x-w;if(jn(w),gn(ue=>ue+1),da(ue=>ue+1),M<0){x=ae,Ze(0),Tt(0),f=0,At(0),Me(0);break}f+=w,Ze(ue=>ue+w),xa(ue=>ue+w);const S=x,Hs=M;if(S>50&&Hs<=50?Tt(1):S<=50&&Tt(ue=>ue+1),x=M,N+=1,Me(N),x===0)break}if(Ot(x),x===0){f===180?Dn(w=>w+1):f>=140?An(w=>w+1):f>=100&&Tn(w=>w+1);const v=ae;v<=170&&pa(w=>Math.max(w,v)),ae<=50&&(la(w=>w+(Sn>0?Sn:1)),ca(w=>w+1)),At(f),Ze(0),Tt(0),Me(0),O("ai"),V(!0)}return x>0&&N>=3&&(f===180?Dn(v=>v+1):f>=140?An(v=>v+1):f>=100&&Tn(v=>v+1),At(f),Ze(0),Tt(0),Me(0)),Me(0),xt(!0),0}return p}),t=requestAnimationFrame(a)};return t=requestAnimationFrame(a),()=>cancelAnimationFrame(t)},[_e,ie,R,ae]),r.useEffect(()=>{B.inProgress&&(jr.current||(vr(!0),jr.current=!0))},[B.inProgress]);function Pe(){ot(!0),X(k),ee.current=k,Ot(k),pr(!1),Ke(!0),xt(!0),y(0),Qe(0),He(0),$(0),H.current=0,Ct(k),J(0),Le(null),_(0),Dt(0),gn(0),jn(0),Ze(0),Me(0),At(null),O(null),$t(0),_t(0),wr([]),on(0),cn(0),dn(!1),Mt(0),da(0),ps(0),xa(0),bs(0),gs(0),vs(0),Dn(0),An(0),Tn(0),js(0),pa(0),Lt(0),hs(0),la(0),ca(0),E("X01");const t=Math.max(1,Math.floor(Number(nt)||1));if(gr(Ce==="first"?t:Math.max(1,Math.ceil(t/2))),U)try{lt({mode:o,x01Start:k,firstTo:ct,aiLevel:R})}catch{}const s=Bt(n,"You"),a=R!=="None"?`AI (${R})`:"Opponent",l=R!=="None"?[s,a]:[s];B.newMatch(l,k,`offline-${Date.now()}`)}function Zi(){X(k),ee.current=k,Ot(k),pr(!1),ys(null),Ee(!1),Ke(!0),xt(!0),y(0),Qe(0),He(0),$(0),H.current=0,Ct(k),J(0),Ye.current=k,te.current=0,Le(null),_(0),se.current=0,se.current=0,Dt(0),gn(0),jn(0),Ze(0),Me(0),At(null),O(null)}function It(t){zi(t),$(0),H.current=0,Ct(t===0?k:t),Ye.current=t===0?k:t,_(0),se.current=0,R!=="None"?(xt(!1),Dt(Sr)):(Dt(0),xt(!0))}function F(t){if(!Number.isFinite(t))return!1;const s=Ye.current,a=ee.current,l=H.current,u=te.current,g=l>0||u>0;g&&(X(s),ee.current=s,$(0),H.current=0,J(0),te.current=0,_(0),se.current=0,He(0),y(0),Qe(S=>Math.max(0,S-l)),Mt(S=>Math.max(0,S-l)),ps(S=>Math.max(0,S-u)),ms.current=0);const p=g?s:a,N=p<=170?170:180,f=je(Math.round(t),0,N),x=p-f,v=je(Math.round(Gt||0),0,3),w=je(Math.round(Wt||0),0,3),M=x===0?v:3;if(T("X01",M),Qe(S=>S+M),Mt(S=>S+M),$(M),H.current=M,J(f),te.current=f,Le(f),f===180?bs(S=>S+1):f>=140?gs(S=>S+1):f>=100&&vs(S=>S+1),x<0){if(h)try{er(D,0,Math.max(s,0),d,{volume:m,checkoutOnly:b})}catch{}try{Vs.getState().recordVisit("offline-x01",M,0,{preRemaining:p,postRemaining:s,bust:!0,finish:!1})}catch{}X(s),ee.current=s,Le(0),J(0),te.current=0,$(0),H.current=0,_(0),se.current=0;try{B.addVisit(0,M)}catch{}return It(s),!0}if(X(x),ee.current=x,ps(S=>S+f),h)try{er(D,f,Math.max(x,0),d,{volume:m,checkoutOnly:b})}catch{}if(x===0?(Lt(S=>S+w),hs(S=>S+1),_(w),se.current=w):p<=50&&Lt(S=>S+3),x===0){p<=170&&js(S=>Math.max(S,p)),ys(null),Ee(!1);try{Vs.getState().recordVisit("offline-x01",M,f,{preRemaining:p,postRemaining:0,finish:!0,bust:!1})}catch{}try{B.addVisit(f,M,{visitTotal:f,doubleWindowDarts:w,finishedByDouble:!0}),B.endLeg(p)}catch{}return O("player"),V(!0),$(0),H.current=0,J(0),te.current=0,_(0),se.current=0,!0}try{Vs.getState().recordVisit("offline-x01",M,f,{preRemaining:p,postRemaining:x,finish:!1,bust:!1})}catch{}try{const S=p<=50?M:p<=170&&x<=50?1:0;B.addVisit(f,M,{visitTotal:f,doubleWindowDarts:S,finishedByDouble:!1})}catch{}return It(x),J(0),te.current=0,$(0),H.current=0,_(0),se.current=0,!0}const ne=Ql({match:B,commitManualVisitTotal:F,endTurn:It}),[Kn,Wn]=r.useState(""),Ea=t=>{Wn(t)},Ji=t=>t===50?{ring:"INNER_BULL",sector:25}:t===25?{ring:"BULL",sector:25}:t>=1&&t<=20?{ring:"SINGLE",sector:t}:{ring:void 0,sector:null},el=t=>{const{ring:s,sector:a}=Ji(t);switch(o){case"Double Practice":zn(t);return;case"Around the Clock":Is(t,s,a);return;case"Cricket":Bs(t,s,a);return;case"Shanghai":Fs(t,s,a);return;case"Halve It":Yn(t,s,a);return;case"High-Low":Zn(t,s,a);return;case"Bob's 27":Xn(t,s,a);return;case"Count-Up":Ls(t);return;case"High Score":Ms(t);return;case"Low Score":Es(t);return;case"Checkout 170":qn(t,s);return;case"Checkout 121":Qn(t,s);return;case"Treble Practice":Ps(t,s,a);return;case"Baseball":Va(t,s,a);return;case"Golf":Oa(t,s,a);return;case"American Cricket":$a(t,s,a);return;case"Scam":qe($s(Z,t,s));return;case"Fives":setFives(_s(be,t));return;case"Sevens":setSevens(Ks(ge,t));return;case"Killer":ye("Use the Killer player board to record hits.",{type:"info",timeout:2e3});return;case"Tic Tac Toe":ye("Tap a cell on the Tic Tac Toe board to claim it.",{type:"info",timeout:2e3});return;default:ye("Use the in-game controls for this mode.",{type:"info",timeout:2e3})}},Gn=()=>{const t=parseInt(Kn,10);if(isNaN(t)||t<0){alert("Enter a valid number");return}if(o!=="X01"){const l=je(Math.round(t),0,999);el(l),Wn("");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=ee.current<=170?170:180,a=je(Math.round(t),0,s);t>s&&ye(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),F(a)&&Wn("")},Ra=r.useCallback(()=>{Ve.current&&(Ve.current=null,ve(),Ss(!1));const t=H.current,s=te.current,a=Ye.current;t===0&&s===0||(X(a),ee.current=a,$(0),H.current=0,J(0),te.current=0,_(0),se.current=0,He(0),y(0),Qe(l=>Math.max(0,l-t)),Mt(l=>Math.max(0,l-t)),ps(l=>Math.max(0,l-s)),ms.current=0)},[ve]);r.useEffect(()=>{const t=s=>{const a=s?.detail;!a||a?.source==="offline-play"||Ra()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[Ra]);function zn(t){T("Double Practice");const s=je(Math.round(t||0),0,60);if(He(s),Qe(a=>a+1),Mt(a=>a+1),si(s,Be)){const a=ht+1;Qs(a),qs(l=>Math.min(20,l+1)),a>=21&&(O("player"),V(!0))}y(0)}function Pa(){zn(Number(C))}function Ia(){const t=Ft(K);if(t==null){alert("Enter like D16, 50, 25, T20");return}zn(t),W("")}function Xn(t,s,a){if(Er)return!1;T("Bob's 27");const l=ts,u=s==="DOUBLE"&&a===l||!s&&t===l*2;return u&&en(g=>g+1),Mr(g=>{const p=g+1;if(p>=3){const N=Ti+(u?1:0);N>0?Js(x=>x+N*l*2):Js(x=>x-l*2);const f=l+1;return Lr(f),en(0),f>20&&Rr(!0),0}return p}),!0}function Ba(){Xn(Math.max(0,C|0)),y(0)}function Fa(){Lr(1),Js(27),Mr(0),en(0),Rr(!1),E("Bob's 27")}function Ls(t){return T("Count-Up"),Ir(s=>s+Math.max(0,t|0)),Br(s=>{const a=s+1;return a>=3?(Pr(l=>l+1),0):a}),!0}function Ms(t){return T("High Score"),Hr(s=>s+Math.max(0,t|0)),Ur(s=>{const a=s+1;return a>=3?(Fr(l=>l+1),0):a}),!0}function Es(t){return T("Low Score"),Or(s=>s+Math.max(0,t|0)),$r(s=>{const a=s+1;return a>=3?(Vr(l=>l+1),0):a}),!0}function Ha(t,s,a,l,u,g,p,N){const f=t-p;if(!(f<0))if(f===0){if(N==="DOUBLE"||N==="INNER_BULL"){g(x=>x+1),u(x=>x+1),l(()=>0),s(t);return}s(f)}else s(f);l(x=>{const v=x+1;return v>=3?(u(w=>w+1),0):v})}function qn(t,s){return T("Checkout 170"),Ha(pt,rn,_r,Kr,Wr,Gr,t,s),_r+1>=3&&rn(170),!0}function Qn(t,s){return T("Checkout 121"),Ha(bt,an,zr,Xr,qr,Qr,t,s),zr+1>=3&&an(121),!0}function Rs(t){const s=Ft(K);if(s==null){alert("Enter like T20, D16, 25, 50");return}const a=K.trim().toUpperCase(),l=a.startsWith("D")||a==="50"||a==="BULL"||a==="DBULL"||a==="IBULL"||a.includes("INNER");t?qn(s,l?"DOUBLE":void 0):Qn(s,l?"DOUBLE":void 0),W("")}function tl(){rn(170),Kr(0),Wr(0),Gr(0),E("Checkout 170")}function sl(){an(121),Xr(0),qr(0),Qr(0),E("Checkout 121")}function Ps(t,s,a){return Zr?!1:(T("Treble Practice"),(s==="TRIPLE"&&a===Se||!s&&t===Se*3)&&on(u=>u+1),cn(u=>{const g=u+1;if(g%3===0&&[20,19,18].includes(Se)){const p=["T20","T19","T18"],N=p.indexOf(`T${Se}`),f=p[(N+1)%p.length];ln(Number(f.replace("T","")))}return Fe>0&&g>=Fe&&dn(!0),g}),!0)}function Ua(){on(0),cn(0),dn(!1),E("Treble Practice")}function Va(t,s,a){return T("Baseball"),Jr(l=>{const u={...l};return Pl(u,t,s,a),u}),!0}function nl(){Jr(ai()),E("Baseball")}function Oa(t,s,a){return T("Golf"),ea(l=>{const u={...l};return Bl(u,t,s,a),u}),!0}function rl(){ea(ii()),E("Golf")}function al(t,s,a,l){return T("Tic Tac Toe"),ta(u=>{const g={...u,board:[...u.board]};return Hl(g,t,s,a,l),g}),!0}function il(){ta(li()),E("Tic Tac Toe")}function $a(t,s,a){return T("American Cricket"),sa(l=>{const u={...l,marks:{...l.marks}};return zl(u,t,s,a,()=>!1),u}),!0}function _a(){sa(ui()),E("American Cricket")}function Is(t,s,a){T("Around the Clock");const l=re[le];let u=!1;if(typeof a=="number"&&a===l&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(u=!0),l===25&&(s==="BULL"||t===25)&&(u=!0),l===50&&(s==="INNER_BULL"||t===50)&&(u=!0),u||(t===l||t===l*2||t===l*3)&&(u=!0),u){const g=Qt+1;return Tr(g),Ar(p=>p+1),!0}return!0}function Ka(){Is(Math.max(0,C|0)),y(0)}function Wa(){const t=Ft(K);if(t==null){alert("Enter like T20, D5, 25, 50");return}Is(t),W("")}function Bs(t,s,a){return T("Cricket"),Ys(l=>{const u={...l,marks:{...l.marks}};return wl(u,t,s,a,()=>!1),u}),Y(l=>{const u=l+1;return u>=3?0:u}),!0}function Ga(){Bs(Math.max(0,C|0)),y(0)}function Fs(t,s,a){return T("Shanghai"),Zt(l=>{const u={...l,turnHits:{...l.turnHits}};return Cl(u,t,s,a),u}),Y(l=>{const u=l+1;return u>=3?(Zt(g=>{const p={...g,turnHits:{...g.turnHits}};return Dl(p),p}),0):u}),!0}function za(){Fs(Math.max(0,C|0)),y(0)}function Yn(t,s,a){return T("Halve It"),Jt(l=>{const u={...l,targets:[...l.targets]};return Al(u,t,s,a),u}),Y(l=>{const u=l+1;return u>=3?(Jt(g=>{const p={...g,targets:[...g.targets]};return Tl(p),p}),0):u}),!0}function Xa(){Yn(Math.max(0,C|0)),y(0)}function Zn(t,s,a){return T("High-Low"),es(l=>{const u={...l};return Ll(u,t,s,a),u}),Y(l=>{const u=l+1;return u>=3?(es(g=>{const p={...g};return Ml(p),p}),0):u}),!0}function qa(){Zn(Math.max(0,C|0)),y(0)}function ll(){const t=Kt??"player",s=t==="player"?us||void 0:Sn||void 0,a=1,l=t==="player"?ra:aa;wr([...Ne,{winner:t,doubleDarts:Wt,checkoutDarts:Gt,winnerDarts:l,doublesAtt:s,doublesHit:a}]),V(!1);let u=q,g=Q;if(Kt==="player"?u+=1:Kt==="ai"&&(g+=1),$t(u),_t(g),O(null),u>=ct||g>=ct){try{vl(o,t==="player")}catch{}try{B.endGame()}catch{}Ke(!1),ot(!1),X(k),Ot(k),Ln(!0);return}Zi()}const Jn=!tr.includes(o)&&!(n?.fullAccess||n?.admin);return e.jsxs("div",{className:"card ndn-game-shell ndn-page flex flex-col min-h-0 relative overflow-hidden md:overflow-hidden overflow-y-auto",children:[wi&&e.jsx(hl,{players:B.players||[],user:n,onDone:()=>vr(!1)}),!_e&&!Vt&&e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h2",{className:"text-2xl font-bold ndn-section-title",children:"Offline Mode ðŸŽ®"})}),e.jsxs("div",{className:"ndn-shell-body",children:[!_e&&!Vt&&e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:o,onChange:t=>{const s=t.target.value;Ws(s),Gs(Qa(s))},children:[tr.map(t=>e.jsxs("option",{value:t,children:[I(t).emoji," ",t]},t)),Za.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[I(t).emoji," ",t," ",n?.fullAccess||n?.admin?"":"(Premium)"]},t))]}),I(o).tagline&&e.jsxs("div",{className:"text-xs mt-0.5 px-0.5",style:{color:I(o).color},children:[I(o).emoji," ",I(o).tagline]}),o!=="Treble Practice"&&Ja(o).length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 items-end",children:Ja(o).map(t=>e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:t.label}),t.type==="select"&&t.options?e.jsx("select",{className:"input w-full",value:xr[t.key]??t.defaultValue,onChange:s=>Gs(a=>({...a,[t.key]:Number(s.target.value)})),children:t.options.map(s=>e.jsx("option",{value:s,children:s},s))}):e.jsx("input",{className:"input w-full",type:"number",min:t.min??1,max:t.max,step:t.step??1,value:xr[t.key]??t.defaultValue,onChange:s=>Gs(a=>({...a,[t.key]:Number(s.target.value)}))}),t.hint&&e.jsx("div",{className:"text-xs text-slate-300 mt-0.5",children:t.hint})]},t.key))}),o!=="X01"&&ei(o).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"font-semibold",children:"Starting Score"}),e.jsx("select",{className:"input w-full",value:k,onChange:t=>Ut(Number(t.target.value)),children:ei(o).map(t=>e.jsx("option",{value:t,children:t},t))})]}),o==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:Fe,onChange:t=>Ri(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."}),j&&!Xs&&e.jsx("div",{className:"hidden md:block w-[360px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2",style:{willChange:"transform, opacity"},children:e.jsx(mi,{scoringMode:"x01",showToolbar:A,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:G(F),onAutoDart:(t,s,a)=>{}})})})]}),!n?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),o==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:k,onChange:t=>Ut(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:R,onChange:t=>hr(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),xi.map(t=>e.jsx("option",{value:t,children:t},t))]}),R!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:Sr/1e3,onChange:t=>Si(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>fr(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),o==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!_e&&!Vt&&e.jsx("button",{className:"btn",disabled:Jn,title:Jn?"PREMIUM required for this mode":"",onClick:Pe,children:"Start Match ðŸš€"}),_e&&e.jsx("div",{className:`fixed inset-0 z-[1000] bg-slate-950/90 backdrop-blur-sm ${ut?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(rt,{storageKey:"ndn:modal:offline-match:v2",frameClassName:"relative",frameFullScreenClassName:"relative ndn-modal-full",className:`${ut?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:ut,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex h-full",children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 pl-2 sm:pl-3",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{tt.current=t},children:[$e!=="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:t=>{$n.current=t},children:e.jsx(ql,{className:"w-full",left:e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full text-[10px] sm:text-xs border",style:{backgroundColor:`${I(o).color}20`,color:I(o).color,borderColor:`${I(o).color}50`},children:[I(o).emoji," ",o]}),e.jsx("span",{className:"font-medium whitespace-nowrap",children:o==="X01"?`X01 / ${k}`:o}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",ct," Â· Legs ",q,"-",Q]}),e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs bg-white/10 text-white/70 border-white/20",children:"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:mt?"Actual Size":"Fit All",onClick:()=>Ci(t=>!t),children:mt?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:ut?"Restore":"Maximize",onClick:()=>ki(t=>!t),children:ut?"Restore":"Maximize"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Pe()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>he(!0),children:"Quit"})]})})}),kr&&e.jsx(ti,{onClose:()=>he(!1),onQuit:()=>{if(R==="None"){he(!1),We({player:!0,opponent:!1}),zt(!0);return}ks()},onPause:()=>{try{Xt(!0,null,D),Us({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:D})}catch{}he(!1)}})]}),zs&&e.jsx("div",{className:"fixed inset-0 z-[170] flex items-start justify-center pt-8 bg-black/70 p-4",children:e.jsxs(rt,{storageKey:"ndn:modal:offline-quit-confirm",className:"w-full relative",defaultWidth:460,defaultHeight:320,minWidth:360,minHeight:260,maxWidth:720,maxHeight:520,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Confirm Quit (Both Players)"}),e.jsx("p",{className:"text-sm text-slate-200 mb-4",children:"Both players must accept to end the match. If either player wants to continue, the match will keep going."}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("button",{className:`btn w-full ${dt.player?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>We(t=>({...t,player:!0})),children:[Bt(n,"Player 1")," Accepts"]}),e.jsxs("button",{className:`btn w-full ${dt.opponent?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>We(t=>({...t,opponent:!0})),children:[R==="None"?"Opponent":`${R} AI`," Accepts"]}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 w-full",onClick:()=>{We({player:!1,opponent:!1}),zt(!1)},children:"Continue Match"})]})]})}),o==="X01"&&_i&&Ns&&e.jsx("div",{className:"fixed inset-0 z-[160] flex items-start justify-center pt-8 bg-black/70 p-4",onClick:()=>Ee(!1),children:e.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl",onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key==="Escape")&&(t.preventDefault(),Ee(!1))},tabIndex:-1,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-emerald-200/70",children:"Checkout box"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-100",children:[Ns.remaining," left"]})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Ee(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Wt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Nr(t),children:Re(t)},`double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Gt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>yr(t),children:Re(t)},`checkout-${t}`))})]}),Ns.routes.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-emerald-200/80 mb-1",children:"Suggested checkout"}),e.jsx("div",{className:"space-y-1",children:Ns.routes.map(t=>e.jsx("div",{className:"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold",children:t},t))})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>Ee(!1),children:"Enter"})})]})]})}),e.jsxs("div",{ref:t=>{st.current=t},className:"will-change-transform",style:mt?{transform:`scale(${qt})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,qt))}em`}:void 0,children:[$e!=="modern"&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:[I(o).emoji," ",o==="X01"?`X01 â€” ${k}`:o]}),e.jsxs("p",{className:"text-xs text-slate-300/70 mb-1",children:[I(o).tagline," Â· 3 darts per visit"]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full border",style:{backgroundColor:`${I(o).color}20`,color:I(o).color,borderColor:`${I(o).color}50`},children:[I(o).emoji," ",o]}),o==="X01"&&e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",k]}),e.jsxs("div",{ref:Yi,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=xe!==k||ae!==k||de>0,s=`pill ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${s} ${Ce==="first"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Pt("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${s} ${Ce==="best"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Pt("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:nt,onChange:a=>_n(Math.max(1,Math.floor(Number(a.target.value)||1))),disabled:t,title:Ce==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",q,"â€“",Q]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`input input-compact font-bold ${On}`,value:pi,onChange:t=>bi(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${On} w-[7.5rem]`,value:gi,onChange:t=>vi(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${On} w-[7.5rem]`,value:ji,onChange:t=>Ni(t.target.value),placeholder:"Team B"})]})]})]}),$e!=="modern"&&o!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[o==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:it[Be]?.label||"â€”"})]})}),o==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:re[le]===25?"25 (Outer Bull)":re[le]===50?"50 (Inner Bull)":re[le]||"â€”"})]})}),o==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:dr.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,ft.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:ft.points})]}),Sl(ft)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Ys(sr()),Y(0),E("Cricket")},children:"Reset"})]})]}),o==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:Yt.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Yt.score]}),Yt.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Zt(nr()),Y(0),E("Shanghai")},children:"Reset"})]})]}),o==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[we.stage+1,"/",we.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=ir(we);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",we.score]}),we.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Jt(rr()),Y(0),E("Halve It")},children:"Reset"})]})]}),o==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Te.round," Â· Target ",Te.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Te.score]}),Te.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{es(ar()),Y(0),E("High-Low")},children:"Reset"})]})]}),o==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",ts]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Zs]}),Er&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Fa,children:"Reset"})]})]}),o==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",ss,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",tn]})]}),o==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",ns,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",sn]})]}),o==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",rs,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",nn]})]}),o==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:pt}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",as," Â· Successes:"," ",is]})]}),o==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:bt}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",ls," Â· Successes:"," ",os]})]}),o==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",Se]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",gt]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${Se===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>ln(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:Se,onChange:t=>ln(parseInt(t.target.value,10)),children:Array.from({length:20},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ua,children:"Reset"})]})]})}),o==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:vt.inning}),e.jsxs("div",{className:"text-sm",children:["Score:"," ",e.jsx("span",{className:"font-semibold",children:vt.score})]})]}),o==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:jt.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes:"," ",e.jsx("span",{className:"font-semibold",children:jt.strokes})]})]}),o==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:fe.turn}),fe.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",fe.winner||"â€”"]})]}),o==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Os[ds.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[ds.targetIndex+1,"/",Os.length]})]}),ds.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",ds.darts," darts!"]})]}),o==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[be.score,"/",be.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:be.darts})]}),be.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",be.target,"!"]})]}),o==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[ge.score,"/",ge.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:ge.darts})]}),ge.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",ge.target,"!"]})]}),o==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:ur.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,un.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:un.points})]}),Xl(un)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:_a,children:"Reset"})]})]}),o==="Killer"&&e.jsx(e.Fragment,{children:na?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:P[pe]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Xe?`${P.find(t=>t.id===Xe)?.name||"Winner"} Wins`:Pi||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):$e==="modern"?e.jsxs("div",{className:"space-y-3 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border px-4 py-2",style:{borderColor:`${I(o).color}50`,backgroundColor:`${I(o).color}18`},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:I(o).emoji}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold leading-tight text-white",children:o==="X01"?`X01 â€” ${k}`:o}),e.jsxs("p",{className:"text-[11px] text-slate-300/80",children:[I(o).tagline," Â· 3 darts per visit"]})]})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs",children:e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs ",q,"â€“",Q]})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap py-1",children:[e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-rose-600/20 text-rose-200 border border-rose-400/30 hover:bg-rose-600/40 transition-colors",onClick:()=>he(!0),children:"Quit"}),e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-amber-600/20 text-amber-200 border border-amber-400/30 hover:bg-amber-600/40 transition-colors",onClick:()=>{try{Xt(!0,null,D),Us({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:D})}catch{}ye("Match paused â€” select duration on overlay",{type:"info",timeout:2500})},children:"Pause"}),e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-slate-600/20 text-slate-200 border border-slate-400/30 hover:bg-slate-600/40 transition-colors",onClick:()=>Pe(),children:"Restart"}),e.jsx("button",{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-colors ${Mn?"bg-indigo-600/40 text-indigo-100 border-indigo-400/50":"bg-indigo-600/20 text-indigo-200 border-indigo-400/30 hover:bg-indigo-600/40"}`,onClick:()=>En(t=>!t),children:Mn?"Close Setup â–²":"New Match â–¼"})]}),Mn&&e.jsxs("div",{className:"rounded-2xl bg-slate-900/80 border border-white/10 p-3 space-y-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Match Setup"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Game Mode"}),e.jsxs("select",{className:"input w-full text-sm",value:o,onChange:t=>Ws(t.target.value),children:[tr.map(t=>e.jsx("option",{value:t,children:t},t)),Za.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t,n?.fullAccess||n?.admin?"":" (Premium)"]},t))]})]}),o==="X01"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Starting Score"}),e.jsx("input",{className:"input w-full text-sm",type:"number",min:1,max:1001,value:k,onChange:t=>Ut(Number(t.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Format"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-xs border ${Ce==="first"?"bg-white/20 border-white/30":"bg-transparent border-white/10 opacity-60"}`,onClick:()=>Pt("first"),children:"First to"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-xs border ${Ce==="best"?"bg-white/20 border-white/30":"bg-transparent border-white/10 opacity-60"}`,onClick:()=>Pt("best"),children:"Best of"}),e.jsx("input",{className:"input w-14 text-center text-sm",type:"number",min:1,step:1,value:nt,onChange:t=>_n(Math.max(1,Math.floor(Number(t.target.value)||1)))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"AI Opponent"}),e.jsxs("select",{className:"input w-full text-sm",value:R,onChange:t=>hr(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),xi.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>{En(!1),Pe()},children:"Start New Match ðŸš€"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>En(!1),children:"Cancel"})]})]}),kr&&e.jsx(ti,{onClose:()=>he(!1),onQuit:()=>{if(R==="None"){he(!1),We({player:!0,opponent:!1}),zt(!0);return}ks()},onPause:()=>{try{Xt(!0,null,D),Us({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:D})}catch{}he(!1)}})]}):null,$e!=="modern"?e.jsxs("div",{className:"space-y-2",children:[o==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:it[Be]?.label||"â€”"})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&si(t,Be)){const l=ht+1,u=Be+1;return Qs(l),qs(u),l>=it.length&&setTimeout(()=>{Qs(0),qs(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Pa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Pa,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:K,onChange:t=>W(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ia()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ia,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",ht," of 21"]})]}),o==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:re[le]===25?"25 (Outer Bull)":re[le]===50?"50 (Inner Bull)":re[le]||"â€”"})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Is(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ka()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ka,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:K,onChange:t=>W(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Wa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Wa,children:"Add"})]}),Qt>=re.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Tr(0),Ar(0),E("Around the Clock")},children:"Reset"})]})]}),o==="Cricket"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Bs(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ga()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ga,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ys(sr()),Y(0),E("Cricket")},children:"Reset"})]})]}),o==="Shanghai"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Fs(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&za()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:za,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Zt(nr()),Y(0),E("Shanghai")},children:"Reset"})]})]}),o==="Halve It"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Yn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Xa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Xa,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Jt(rr()),Y(0),E("Halve It")},children:"Reset"})]})]}),o==="High-Low"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Zn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&qa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:qa,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{es(ar()),Y(0),E("High-Low")},children:"Reset"})]})]}),o==="Bob's 27"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Xn(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ba()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ba,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Fa,children:"Reset"})]})]}),o==="Count-Up"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:t=>Ls(t),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Ls(C),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Ls(C),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Pr(1),Ir(0),Br(0),E("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",ss,"/",Li]})]}),o==="High Score"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:t=>Ms(t),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Ms(C),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Ms(C),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Fr(1),Hr(0),Ur(0),E("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",ns,"/",Mi]})]}),o==="Low Score"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:t=>Es(t),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Es(C),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Es(C),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Vr(1),Or(0),$r(0),E("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",rs,"/",Ei]})]}),o==="Checkout 170"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s)=>qn(t,s==="MISS"?void 0:s),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:K,onChange:t=>W(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Rs(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Rs(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:tl,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",pt," Â· Attempts: ",as," ","Â· Successes: ",is]})]}),o==="Checkout 121"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s)=>Qn(t,s==="MISS"?void 0:s),onAddVisit:G(F),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:K,onChange:t=>W(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Rs(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Rs(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:sl,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",bt," Â· Attempts: ",ls," ","Â· Successes: ",os]})]}),o==="Treble Practice"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ps(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:K,onChange:t=>W(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=Ft(K);s!=null&&Ps(s,void 0,void 0),W("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=Ft(K);t!=null&&Ps(t,void 0,void 0),W("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",gt," Â· Misses:"," ",Math.max(0,Yr-gt)," Â· Darts:"," ",Yr,Fe>0?`/${Fe}`:""]}),Zr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Ua,children:"Reset"})]})]}),o==="Baseball"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Va(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:nl,children:"Reset"})})]}),o==="Golf"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Oa(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:rl,children:"Reset"})})]}),o==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${fe.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(fe.finished||fe.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),a=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",l=t,u=hi[l],g=u.type==="BULL"?null:u.num||null;al(l,s,a,g)},children:fe.board[t]||""},t))}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:il,children:"Reset"})})]}),o==="American Cricket"&&e.jsxs(e.Fragment,{children:[j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>$a(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:_a,children:"Reset"})})]}),o==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Os[Z.targetIndex]})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{const l=s==="MISS"?void 0:s;return T("Scam"),qe($s(Z,t,l)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(T("Scam"),qe(oi(Z,C)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{T("Scam"),qe(oi(Z,C)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{qe(Vl()),E("Scam")},children:"Reset"})]}),Z.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",Z.darts," darts!"]})]}),o==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[oe.score,"/",oe.target]})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(T("Fives"),St(_s(oe,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(T("Fives"),St(ci(oe,C)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{T("Fives"),St(ci(oe,C)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{St(_l(oe.target)),E("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",oe.darts]}),oe.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",oe.target," in"," ",oe.darts," darts!"]})]}),o==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[ce.score,"/",ce.target]})]}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(T("Sevens"),kt(Ks(ce,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:C,onChange:t=>y(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(T("Sevens"),kt(di(ce,C)),y(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{T("Sevens"),kt(di(ce,C)),y(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{kt(Gl(ce.target)),E("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",ce.darts]}),ce.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",ce.target," in"," ",ce.darts," darts!"]})]}),o==="Killer"&&e.jsx(e.Fragment,{children:na?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:P.map(t=>{const s=Nt[t.id],a=cs[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number:"," ",e.jsx("span",{className:"font-semibold",children:a})]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsx("span",{className:"font-semibold",children:s?.lives??0})]})]},t.id)})}),j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(Xe)return!1;const l=s==="MISS"?void 0:s,u=a?.sector??null,g=P[pe];return g?(yt(p=>{const N={};Object.keys(p).forEach(v=>N[v]={...p[v]});const f=ni(g.id,N,l,u);if(f.becameKiller)ke(`${g.name} became a Killer`);else if(f.victimId){const v=P.find(w=>w.id===f.victimId);ke(`${g.name} hit ${v?.name}'s ${cs[f.victimId]} (${f.livesRemoved} life${(f.livesRemoved||0)>1?"s":""})`)}else ke("No effect");const x=ri(N);return x&&wt(x),N}),ze(p=>{const N=p+1;if(N>=3){let f=pe;for(let x=1;x<=P.length;x++){const v=(pe+x)%P.length,w=P[v].id,M=Nt[w];if(M&&!M.eliminated&&M.lives>0){f=v;break}}return Ge(f),0}return N}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:K,onChange:t=>W(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(Xe)return;const a=K.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!a){W("");return}const l=a[1]||"S",u=parseInt(a[2],10),g=l==="D"?"DOUBLE":l==="T"?"TRIPLE":"SINGLE",p=P[pe];yt(N=>{const f={};Object.keys(N).forEach(w=>f[w]={...N[w]});const x=ni(p.id,f,g,u);if(x.becameKiller)ke(`${p.name} became a Killer`);else if(x.victimId){const w=P.find(M=>M.id===x.victimId);ke(`${p.name} hit ${w?.name}'s ${cs[x.victimId]} (${x.livesRemoved} life${(x.livesRemoved||0)>1?"s":""})`)}else ke("No effect");const v=ri(f);return v&&wt(v),f}),W(""),ze(N=>{const f=N+1;if(f>=3){let x=pe;for(let v=1;v<=P.length;v++){const w=(pe+v)%P.length,M=P[w].id,S=Nt[M];if(S&&!S.eliminated&&S.lives>0){x=w;break}}return Ge(x),0}return f})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=pe;for(let s=1;s<=P.length;s++){const a=(pe+s)%P.length,l=P[a].id,u=Nt[l];if(u&&!u.eliminated&&u.lives>0){t=a;break}}Ge(t),ze(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{yt({}),xn({}),hn(!1),Ge(0),ze(0),wt(null),ke("")},children:"Reset"})]}),Xe&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",P.find(t=>t.id===Xe)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{yt({}),xn({}),hn(!1),Ge(0),ze(0),wt(null),ke("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:P.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:a=>{const l=a.target.value;mn(u=>u.map((g,p)=>p===s?{...g,name:l}:g))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>mn(a=>a.filter((l,u)=>u!==s)),disabled:P.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>mn(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(P.length<2){alert("Need at least 2 players");return}const t=P.map(l=>l.id),s=Rl(t),a={};t.forEach(l=>{a[l]=El(s[l])}),xn(s),yt(a),Ge(0),ze(0),wt(null),ke("Assigned numbers"),hn(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-2",children:"Visit total"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:o==="X01"?xe<=170?170:180:999,placeholder:o==="X01"?"0â€“180":"0â€“999",value:Kn,onChange:t=>Ea(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Gn()}}),e.jsx("button",{className:"btn px-4 py-1 text-sm",onClick:Gn,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Nl,{value:Kn,onChange:Ea,onSubmit:Gn,helperText:"Tap numbers then Enter to commit the visit total."})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:Et.primaryLabel}),e.jsx("div",{className:"text-lg font-bold text-white",children:Et.primaryValue})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:Et.secondaryLabel}),e.jsx("div",{className:`text-lg font-bold ${Et.secondaryClass}`,children:Et.secondaryValue})]})]})}),e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Game"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[o,o==="X01"?` / ${k}`:""]})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Format"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[Ce==="first"?"First to":"Best of"," ",nt," Â· ",q,"-",Q]})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(at,{gameMode:o,players:Vn,matchScore:Xi})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!j&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),j?e.jsx("div",{className:"bg-black aspect-video max-h-[420px]",children:e.jsx(mi,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!1,disableDetection:!0})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Tap numbers then Enter to commit a 3-dart visit."})]}),e.jsx("div",{className:"flex flex-col gap-3 min-h-0 flex-1 text-[14px]",children:e.jsx("div",{className:"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"}})}),o==="Cricket"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Bs(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),o==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(at,{gameMode:"Shanghai",players:Pn})}),o==="Shanghai"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Fs(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),o==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(at,{gameMode:"Killer",players:In})}),o==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(at,{gameMode:"Scam",players:Bn})}),o==="Scam"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return qe($s(Z,t,s)),!0}})}),o==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(at,{gameMode:"Fives",players:Fn})}),o==="Fives"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return St(_s(oe,t)),!0}})}),o==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(at,{gameMode:"Sevens",players:Hn})}),o==="Sevens"&&j&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(L,{scoringMode:"custom",showToolbar:A,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return kt(Ks(ce,t)),!0}})})]}),e.jsx("div",{className:"h-1"})]})]})})})}),yi&&e.jsx(Jl,{onClose:()=>fr(!1)}),Jn&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${eo}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&ye("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?ye("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):ye("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{ye("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",fl(pl(),5)]})]})]}),Wi&&typeof document<"u"?Ya.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-start justify-center pt-8 p-4",onClick:()=>Je(!1),children:e.jsx(rt,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>Je(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>Je(!1),children:"Close"})]}),e.jsx(gl,{fill:!0,user:n,playerScore:xe,aiScore:ae,x01Score:k,inMatch:Vt,showWinPopup:br,pendingLegWinner:Kt,playerDartsThrown:ra,aiDartsThrown:aa,totalPlayerDarts:kn,totalAiDarts:Cn,totalPlayerPoints:ua,totalAiPoints:ma,player180s:ha,player140s:Fi,player100s:Hi,ai180s:fa,ai140s:Ui,ai100s:Vi,playerHighestCheckout:Oi,aiHighestCheckout:$i,onClose:()=>Je(!1),onOpen:()=>Je(!0),layout:$e})]})})}),document.body):null,ws&&typeof document<"u"?Ya.createPortal((()=>{const{target:t,value:s,stage:a}=ws,l=t==="player"?D:Cs,u=t==="player"?q:Q;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-start justify-center pt-8 p-4",onClick:Rt,children:e.jsx(rt,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:Rt,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",a," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:a===1?e.jsxs(e.Fragment,{children:["Set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:u})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:Rt,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Qi,children:"Yes"})]})]})})})})(),document.body):null,br&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-start justify-center pt-8 z-[99999]",children:e.jsxs(rt,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:yl(B.players?.[B.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Wt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Nr(t),children:Re(t)},`win-double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${Gt===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>yr(t),children:Re(t)},`win-checkout-${t}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:ll,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{V(!1),Pe()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{V(!1),Ke(!1),ot(!1)},children:"Back to Menu"})]})]})}),Ki&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-start justify-center pt-8 z-[60]",children:e.jsxs(rt,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[o," Â· ",k," start Â· First to ",ct]}),(()=>{const t=kn>0?ua/kn*3:0,s=(()=>{const f=Ne.filter(x=>x.winner==="player"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),a=(()=>{const f=Ne.filter(x=>x.winner==="player"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),l=xs>0?Math.round(ia/xs*100):0,u=Cn>0?ma/Cn*3:0,g=(()=>{const f=Ne.filter(x=>x.winner==="ai"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),p=(()=>{const f=Ne.filter(x=>x.winner==="ai"&&typeof x.winnerDarts=="number").map(x=>x.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),N=fs>0?Math.round(oa/fs*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:Bt(n,"You")}),e.jsx("div",{className:"text-3xl font-extrabold",children:q}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:xs})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[l,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:s})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:a})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ha})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[q," â€“ ",Q]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:R==="None"?"Opponent":`${R} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:Q}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:u.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:fs})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[N,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:g})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:fa})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ne.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":R==="None"?"Opp":"AI"," ","Â· Dbl ",Re(t.doubleDarts)," Â· CO"," ",Re(t.checkoutDarts||0)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>Ln(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{Ln(!1),Pe()},children:"Rematch"})]})]})}),Ne.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:Ne.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",Re(t.doubleDarts),", Checkout darts: ",Re(t.checkoutDarts||0)]},s))})]})]}),e.jsx(jl,{localPlayerName:D,onResume:()=>{Xt(!1,null)}})]})}export{Mo as default};
//# sourceMappingURL=OfflinePlay-u4dOlvlX.js.map
