(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}})();function Au(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zh={exports:{}},dc={},Hh={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mi=Symbol.for("react.element"),Eg=Symbol.for("react.portal"),Tg=Symbol.for("react.fragment"),Mg=Symbol.for("react.strict_mode"),Ig=Symbol.for("react.profiler"),Dg=Symbol.for("react.provider"),Pg=Symbol.for("react.context"),Lg=Symbol.for("react.forward_ref"),Ag=Symbol.for("react.suspense"),Rg=Symbol.for("react.memo"),Og=Symbol.for("react.lazy"),pf=Symbol.iterator;function _g(e){return e===null||typeof e!="object"?null:(e=pf&&e[pf]||e["@@iterator"],typeof e=="function"?e:null)}var Wh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vh=Object.assign,Gh={};function fl(e,t,s){this.props=e,this.context=t,this.refs=Gh,this.updater=s||Wh}fl.prototype.isReactComponent={};fl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};fl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Kh(){}Kh.prototype=fl.prototype;function Ru(e,t,s){this.props=e,this.context=t,this.refs=Gh,this.updater=s||Wh}var Ou=Ru.prototype=new Kh;Ou.constructor=Ru;Vh(Ou,fl.prototype);Ou.isPureReactComponent=!0;var xf=Array.isArray,Jh=Object.prototype.hasOwnProperty,_u={current:null},qh={key:!0,ref:!0,__self:!0,__source:!0};function Yh(e,t,s){var r,a={},l=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(l=""+t.key),t)Jh.call(t,r)&&!qh.hasOwnProperty(r)&&(a[r]=t[r]);var o=arguments.length-2;if(o===1)a.children=s;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:Mi,type:e,key:l,ref:i,props:a,_owner:_u.current}}function Ug(e,t){return{$$typeof:Mi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Uu(e){return typeof e=="object"&&e!==null&&e.$$typeof===Mi}function Bg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var gf=/\/+/g;function zc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bg(""+e.key):t.toString(36)}function go(e,t,s,r,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Mi:case Eg:i=!0}}if(i)return i=e,a=a(i),e=r===""?"."+zc(i,0):r,xf(a)?(s="",e!=null&&(s=e.replace(gf,"$&/")+"/"),go(a,t,s,"",function(u){return u})):a!=null&&(Uu(a)&&(a=Ug(a,s+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(gf,"$&/")+"/")+e)),t.push(a)),1;if(i=0,r=r===""?".":r+":",xf(e))for(var o=0;o<e.length;o++){l=e[o];var c=r+zc(l,o);i+=go(l,t,s,c,a)}else if(c=_g(e),typeof c=="function")for(e=c.call(e),o=0;!(l=e.next()).done;)l=l.value,c=r+zc(l,o++),i+=go(l,t,s,c,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function qi(e,t,s){if(e==null)return e;var r=[],a=0;return go(e,r,"","",function(l){return t.call(s,l,a++)}),r}function $g(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Un={current:null},yo={transition:null},Fg={ReactCurrentDispatcher:Un,ReactCurrentBatchConfig:yo,ReactCurrentOwner:_u};function Xh(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:qi,forEach:function(e,t,s){qi(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return qi(e,function(){t++}),t},toArray:function(e){return qi(e,function(t){return t})||[]},only:function(e){if(!Uu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qe.Component=fl;Qe.Fragment=Tg;Qe.Profiler=Ig;Qe.PureComponent=Ru;Qe.StrictMode=Mg;Qe.Suspense=Ag;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fg;Qe.act=Xh;Qe.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Vh({},e.props),a=e.key,l=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,i=_u.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Jh.call(t,c)&&!qh.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=s;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:Mi,type:e.type,key:a,ref:l,props:r,_owner:i}};Qe.createContext=function(e){return e={$$typeof:Pg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Dg,_context:e},e.Consumer=e};Qe.createElement=Yh;Qe.createFactory=function(e){var t=Yh.bind(null,e);return t.type=e,t};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(e){return{$$typeof:Lg,render:e}};Qe.isValidElement=Uu;Qe.lazy=function(e){return{$$typeof:Og,_payload:{_status:-1,_result:e},_init:$g}};Qe.memo=function(e,t){return{$$typeof:Rg,type:e,compare:t===void 0?null:t}};Qe.startTransition=function(e){var t=yo.transition;yo.transition={};try{e()}finally{yo.transition=t}};Qe.unstable_act=Xh;Qe.useCallback=function(e,t){return Un.current.useCallback(e,t)};Qe.useContext=function(e){return Un.current.useContext(e)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(e){return Un.current.useDeferredValue(e)};Qe.useEffect=function(e,t){return Un.current.useEffect(e,t)};Qe.useId=function(){return Un.current.useId()};Qe.useImperativeHandle=function(e,t,s){return Un.current.useImperativeHandle(e,t,s)};Qe.useInsertionEffect=function(e,t){return Un.current.useInsertionEffect(e,t)};Qe.useLayoutEffect=function(e,t){return Un.current.useLayoutEffect(e,t)};Qe.useMemo=function(e,t){return Un.current.useMemo(e,t)};Qe.useReducer=function(e,t,s){return Un.current.useReducer(e,t,s)};Qe.useRef=function(e){return Un.current.useRef(e)};Qe.useState=function(e){return Un.current.useState(e)};Qe.useSyncExternalStore=function(e,t,s){return Un.current.useSyncExternalStore(e,t,s)};Qe.useTransition=function(){return Un.current.useTransition()};Qe.version="18.3.1";Hh.exports=Qe;var m=Hh.exports;const zg=Au(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hg=m,Wg=Symbol.for("react.element"),Vg=Symbol.for("react.fragment"),Gg=Object.prototype.hasOwnProperty,Kg=Hg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jg={key:!0,ref:!0,__self:!0,__source:!0};function Qh(e,t,s){var r,a={},l=null,i=null;s!==void 0&&(l=""+s),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Gg.call(t,r)&&!Jg.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Wg,type:e,key:l,ref:i,props:a,_owner:Kg.current}}dc.Fragment=Vg;dc.jsx=Qh;dc.jsxs=Qh;zh.exports=dc;var n=zh.exports,Ed={},Zh={exports:{}},as={},e0={exports:{}},t0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,Y){var ue=$.length;$.push(Y);e:for(;0<ue;){var Ce=ue-1>>>1,Ee=$[Ce];if(0<a(Ee,Y))$[Ce]=Y,$[ue]=Ee,ue=Ce;else break e}}function s($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var Y=$[0],ue=$.pop();if(ue!==Y){$[0]=ue;e:for(var Ce=0,Ee=$.length,ot=Ee>>>1;Ce<ot;){var he=2*(Ce+1)-1,Ze=$[he],ft=he+1,Ae=$[ft];if(0>a(Ze,ue))ft<Ee&&0>a(Ae,Ze)?($[Ce]=Ae,$[ft]=ue,Ce=ft):($[Ce]=Ze,$[he]=ue,Ce=he);else if(ft<Ee&&0>a(Ae,ue))$[Ce]=Ae,$[ft]=ue,Ce=ft;else break e}}return Y}function a($,Y){var ue=$.sortIndex-Y.sortIndex;return ue!==0?ue:$.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,g=null,x=3,y=!1,v=!1,C=!1,D=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var Y=s(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=$)r(u),Y.sortIndex=Y.expirationTime,t(c,Y);else break;Y=s(u)}}function E($){if(C=!1,w($),!v)if(s(c)!==null)v=!0,R(p);else{var Y=s(u);Y!==null&&Z(E,Y.startTime-$)}}function p($,Y){v=!1,C&&(C=!1,b(N),N=-1),y=!0;var ue=x;try{for(w(Y),g=s(c);g!==null&&(!(g.expirationTime>Y)||$&&!_());){var Ce=g.callback;if(typeof Ce=="function"){g.callback=null,x=g.priorityLevel;var Ee=Ce(g.expirationTime<=Y);Y=e.unstable_now(),typeof Ee=="function"?g.callback=Ee:g===s(c)&&r(c),w(Y)}else r(c);g=s(c)}if(g!==null)var ot=!0;else{var he=s(u);he!==null&&Z(E,he.startTime-Y),ot=!1}return ot}finally{g=null,x=ue,y=!1}}var S=!1,P=null,N=-1,q=5,G=-1;function _(){return!(e.unstable_now()-G<q)}function te(){if(P!==null){var $=e.unstable_now();G=$;var Y=!0;try{Y=P(!0,$)}finally{Y?L():(S=!1,P=null)}}else S=!1}var L;if(typeof h=="function")L=function(){h(te)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,oe=Q.port2;Q.port1.onmessage=te,L=function(){oe.postMessage(null)}}else L=function(){D(te,0)};function R($){P=$,S||(S=!0,L())}function Z($,Y){N=D(function(){$(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){v||y||(v=!0,R(p))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function($){switch(x){case 1:case 2:case 3:var Y=3;break;default:Y=x}var ue=x;x=Y;try{return $()}finally{x=ue}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,Y){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ue=x;x=$;try{return Y()}finally{x=ue}},e.unstable_scheduleCallback=function($,Y,ue){var Ce=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Ce+ue:Ce):ue=Ce,$){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=ue+Ee,$={id:d++,callback:Y,priorityLevel:$,startTime:ue,expirationTime:Ee,sortIndex:-1},ue>Ce?($.sortIndex=ue,t(u,$),s(c)===null&&$===s(u)&&(C?(b(N),N=-1):C=!0,Z(E,ue-Ce))):($.sortIndex=Ee,t(c,$),v||y||(v=!0,R(p))),$},e.unstable_shouldYield=_,e.unstable_wrapCallback=function($){var Y=x;return function(){var ue=x;x=Y;try{return $.apply(this,arguments)}finally{x=ue}}}})(t0);e0.exports=t0;var qg=e0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yg=m,rs=qg;function se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n0=new Set,ci={};function xa(e,t){el(e,t),el(e+"Capture",t)}function el(e,t){for(ci[e]=t,e=0;e<t.length;e++)n0.add(t[e])}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Td=Object.prototype.hasOwnProperty,Xg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yf={},vf={};function Qg(e){return Td.call(vf,e)?!0:Td.call(yf,e)?!1:Xg.test(e)?vf[e]=!0:(yf[e]=!0,!1)}function Zg(e,t,s,r){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ey(e,t,s,r){if(t===null||typeof t>"u"||Zg(e,t,s,r))return!0;if(r)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Bn(e,t,s,r,a,l,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=i}var En={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){En[e]=new Bn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];En[t]=new Bn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){En[e]=new Bn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){En[e]=new Bn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){En[e]=new Bn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){En[e]=new Bn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){En[e]=new Bn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){En[e]=new Bn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){En[e]=new Bn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Bu=/[\-:]([a-z])/g;function $u(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Bu,$u);En[t]=new Bn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Bu,$u);En[t]=new Bn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Bu,$u);En[t]=new Bn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){En[e]=new Bn(e,1,!1,e.toLowerCase(),null,!1,!1)});En.xlinkHref=new Bn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){En[e]=new Bn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Fu(e,t,s,r){var a=En.hasOwnProperty(t)?En[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ey(t,s,a,r)&&(s=null),r||a===null?Qg(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):a.mustUseProperty?e[a.propertyName]=s===null?a.type===3?!1:"":s:(t=a.attributeName,r=a.attributeNamespace,s===null?e.removeAttribute(t):(a=a.type,s=a===3||a===4&&s===!0?"":""+s,r?e.setAttributeNS(r,t,s):e.setAttribute(t,s))))}var hr=Yg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yi=Symbol.for("react.element"),Oa=Symbol.for("react.portal"),_a=Symbol.for("react.fragment"),zu=Symbol.for("react.strict_mode"),Md=Symbol.for("react.profiler"),s0=Symbol.for("react.provider"),r0=Symbol.for("react.context"),Hu=Symbol.for("react.forward_ref"),Id=Symbol.for("react.suspense"),Dd=Symbol.for("react.suspense_list"),Wu=Symbol.for("react.memo"),wr=Symbol.for("react.lazy"),a0=Symbol.for("react.offscreen"),bf=Symbol.iterator;function Al(e){return e===null||typeof e!="object"?null:(e=bf&&e[bf]||e["@@iterator"],typeof e=="function"?e:null)}var Jt=Object.assign,Hc;function zl(e){if(Hc===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Hc=t&&t[1]||""}return`
`+Hc+e}var Wc=!1;function Vc(e,t){if(!e||Wc)return"";Wc=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),l=r.stack.split(`
`),i=a.length-1,o=l.length-1;1<=i&&0<=o&&a[i]!==l[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==l[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==l[o]){var c=`
`+a[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Wc=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?zl(e):""}function ty(e){switch(e.tag){case 5:return zl(e.type);case 16:return zl("Lazy");case 13:return zl("Suspense");case 19:return zl("SuspenseList");case 0:case 2:case 15:return e=Vc(e.type,!1),e;case 11:return e=Vc(e.type.render,!1),e;case 1:return e=Vc(e.type,!0),e;default:return""}}function Pd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _a:return"Fragment";case Oa:return"Portal";case Md:return"Profiler";case zu:return"StrictMode";case Id:return"Suspense";case Dd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case r0:return(e.displayName||"Context")+".Consumer";case s0:return(e._context.displayName||"Context")+".Provider";case Hu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Wu:return t=e.displayName||null,t!==null?t:Pd(e.type)||"Memo";case wr:t=e._payload,e=e._init;try{return Pd(e(t))}catch{}}return null}function ny(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pd(t);case 8:return t===zu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function zr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function l0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sy(e){var t=l0(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var a=s.get,l=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){r=""+i,l.call(this,i)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xi(e){e._valueTracker||(e._valueTracker=sy(e))}function i0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),r="";return e&&(r=l0(e)?e.checked?"true":"false":e.value),e=r,e!==s?(t.setValue(e),!0):!1}function Lo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ld(e,t){var s=t.checked;return Jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function wf(e,t){var s=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;s=zr(t.value!=null?t.value:s),e._wrapperState={initialChecked:r,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function o0(e,t){t=t.checked,t!=null&&Fu(e,"checked",t,!1)}function Ad(e,t){o0(e,t);var s=zr(t.value),r=t.type;if(s!=null)r==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Rd(e,t.type,s):t.hasOwnProperty("defaultValue")&&Rd(e,t.type,zr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function jf(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Rd(e,t,s){(t!=="number"||Lo(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Hl=Array.isArray;function Ja(e,t,s,r){if(e=e.options,t){t={};for(var a=0;a<s.length;a++)t["$"+s[a]]=!0;for(s=0;s<e.length;s++)a=t.hasOwnProperty("$"+e[s].value),e[s].selected!==a&&(e[s].selected=a),a&&r&&(e[s].defaultSelected=!0)}else{for(s=""+zr(s),t=null,a=0;a<e.length;a++){if(e[a].value===s){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Od(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(se(91));return Jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nf(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(se(92));if(Hl(s)){if(1<s.length)throw Error(se(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:zr(s)}}function c0(e,t){var s=zr(t.value),r=zr(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),r!=null&&(e.defaultValue=""+r)}function kf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function d0(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _d(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?d0(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Qi,u0=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,s,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Qi=Qi||document.createElement("div"),Qi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Qi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function di(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ry=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(e){ry.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gl[t]=Gl[e]})});function m0(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Gl.hasOwnProperty(e)&&Gl[e]?(""+t).trim():t+"px"}function f0(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var r=s.indexOf("--")===0,a=m0(s,t[s],r);s==="float"&&(s="cssFloat"),r?e.setProperty(s,a):e[s]=a}}var ay=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ud(e,t){if(t){if(ay[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(se(62))}}function Bd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $d=null;function Vu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fd=null,qa=null,Ya=null;function Sf(e){if(e=Pi(e)){if(typeof Fd!="function")throw Error(se(280));var t=e.stateNode;t&&(t=pc(t),Fd(e.stateNode,e.type,t))}}function h0(e){qa?Ya?Ya.push(e):Ya=[e]:qa=e}function p0(){if(qa){var e=qa,t=Ya;if(Ya=qa=null,Sf(e),t)for(e=0;e<t.length;e++)Sf(t[e])}}function x0(e,t){return e(t)}function g0(){}var Gc=!1;function y0(e,t,s){if(Gc)return e(t,s);Gc=!0;try{return x0(e,t,s)}finally{Gc=!1,(qa!==null||Ya!==null)&&(g0(),p0())}}function ui(e,t){var s=e.stateNode;if(s===null)return null;var r=pc(s);if(r===null)return null;s=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(se(231,t,typeof s));return s}var zd=!1;if(dr)try{var Rl={};Object.defineProperty(Rl,"passive",{get:function(){zd=!0}}),window.addEventListener("test",Rl,Rl),window.removeEventListener("test",Rl,Rl)}catch{zd=!1}function ly(e,t,s,r,a,l,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(s,u)}catch(d){this.onError(d)}}var Kl=!1,Ao=null,Ro=!1,Hd=null,iy={onError:function(e){Kl=!0,Ao=e}};function oy(e,t,s,r,a,l,i,o,c){Kl=!1,Ao=null,ly.apply(iy,arguments)}function cy(e,t,s,r,a,l,i,o,c){if(oy.apply(this,arguments),Kl){if(Kl){var u=Ao;Kl=!1,Ao=null}else throw Error(se(198));Ro||(Ro=!0,Hd=u)}}function ga(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function v0(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Cf(e){if(ga(e)!==e)throw Error(se(188))}function dy(e){var t=e.alternate;if(!t){if(t=ga(e),t===null)throw Error(se(188));return t!==e?null:e}for(var s=e,r=t;;){var a=s.return;if(a===null)break;var l=a.alternate;if(l===null){if(r=a.return,r!==null){s=r;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===s)return Cf(a),e;if(l===r)return Cf(a),t;l=l.sibling}throw Error(se(188))}if(s.return!==r.return)s=a,r=l;else{for(var i=!1,o=a.child;o;){if(o===s){i=!0,s=a,r=l;break}if(o===r){i=!0,r=a,s=l;break}o=o.sibling}if(!i){for(o=l.child;o;){if(o===s){i=!0,s=l,r=a;break}if(o===r){i=!0,r=l,s=a;break}o=o.sibling}if(!i)throw Error(se(189))}}if(s.alternate!==r)throw Error(se(190))}if(s.tag!==3)throw Error(se(188));return s.stateNode.current===s?e:t}function b0(e){return e=dy(e),e!==null?w0(e):null}function w0(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=w0(e);if(t!==null)return t;e=e.sibling}return null}var j0=rs.unstable_scheduleCallback,Ef=rs.unstable_cancelCallback,uy=rs.unstable_shouldYield,my=rs.unstable_requestPaint,nn=rs.unstable_now,fy=rs.unstable_getCurrentPriorityLevel,Gu=rs.unstable_ImmediatePriority,N0=rs.unstable_UserBlockingPriority,Oo=rs.unstable_NormalPriority,hy=rs.unstable_LowPriority,k0=rs.unstable_IdlePriority,uc=null,Gs=null;function py(e){if(Gs&&typeof Gs.onCommitFiberRoot=="function")try{Gs.onCommitFiberRoot(uc,e,void 0,(e.current.flags&128)===128)}catch{}}var Os=Math.clz32?Math.clz32:yy,xy=Math.log,gy=Math.LN2;function yy(e){return e>>>=0,e===0?32:31-(xy(e)/gy|0)|0}var Zi=64,eo=4194304;function Wl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function _o(e,t){var s=e.pendingLanes;if(s===0)return 0;var r=0,a=e.suspendedLanes,l=e.pingedLanes,i=s&268435455;if(i!==0){var o=i&~a;o!==0?r=Wl(o):(l&=i,l!==0&&(r=Wl(l)))}else i=s&~a,i!==0?r=Wl(i):l!==0&&(r=Wl(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(r&4&&(r|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)s=31-Os(t),a=1<<s,r|=e[s],t&=~a;return r}function vy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function by(e,t){for(var s=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var i=31-Os(l),o=1<<i,c=a[i];c===-1?(!(o&s)||o&r)&&(a[i]=vy(o,t)):c<=t&&(e.expiredLanes|=o),l&=~o}}function Wd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function S0(){var e=Zi;return Zi<<=1,!(Zi&4194240)&&(Zi=64),e}function Kc(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function Ii(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Os(t),e[t]=s}function wy(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<s;){var a=31-Os(s),l=1<<a;t[a]=0,r[a]=-1,e[a]=-1,s&=~l}}function Ku(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var r=31-Os(s),a=1<<r;a&t|e[r]&t&&(e[r]|=t),s&=~a}}var gt=0;function C0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var E0,Ju,T0,M0,I0,Vd=!1,to=[],Ar=null,Rr=null,Or=null,mi=new Map,fi=new Map,kr=[],jy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tf(e,t){switch(e){case"focusin":case"focusout":Ar=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":Or=null;break;case"pointerover":case"pointerout":mi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fi.delete(t.pointerId)}}function Ol(e,t,s,r,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:s,eventSystemFlags:r,nativeEvent:l,targetContainers:[a]},t!==null&&(t=Pi(t),t!==null&&Ju(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ny(e,t,s,r,a){switch(t){case"focusin":return Ar=Ol(Ar,e,t,s,r,a),!0;case"dragenter":return Rr=Ol(Rr,e,t,s,r,a),!0;case"mouseover":return Or=Ol(Or,e,t,s,r,a),!0;case"pointerover":var l=a.pointerId;return mi.set(l,Ol(mi.get(l)||null,e,t,s,r,a)),!0;case"gotpointercapture":return l=a.pointerId,fi.set(l,Ol(fi.get(l)||null,e,t,s,r,a)),!0}return!1}function D0(e){var t=ra(e.target);if(t!==null){var s=ga(t);if(s!==null){if(t=s.tag,t===13){if(t=v0(s),t!==null){e.blockedOn=t,I0(e.priority,function(){T0(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=Gd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var r=new s.constructor(s.type,s);$d=r,s.target.dispatchEvent(r),$d=null}else return t=Pi(s),t!==null&&Ju(t),e.blockedOn=s,!1;t.shift()}return!0}function Mf(e,t,s){vo(e)&&s.delete(t)}function ky(){Vd=!1,Ar!==null&&vo(Ar)&&(Ar=null),Rr!==null&&vo(Rr)&&(Rr=null),Or!==null&&vo(Or)&&(Or=null),mi.forEach(Mf),fi.forEach(Mf)}function _l(e,t){e.blockedOn===t&&(e.blockedOn=null,Vd||(Vd=!0,rs.unstable_scheduleCallback(rs.unstable_NormalPriority,ky)))}function hi(e){function t(a){return _l(a,e)}if(0<to.length){_l(to[0],e);for(var s=1;s<to.length;s++){var r=to[s];r.blockedOn===e&&(r.blockedOn=null)}}for(Ar!==null&&_l(Ar,e),Rr!==null&&_l(Rr,e),Or!==null&&_l(Or,e),mi.forEach(t),fi.forEach(t),s=0;s<kr.length;s++)r=kr[s],r.blockedOn===e&&(r.blockedOn=null);for(;0<kr.length&&(s=kr[0],s.blockedOn===null);)D0(s),s.blockedOn===null&&kr.shift()}var Xa=hr.ReactCurrentBatchConfig,Uo=!0;function Sy(e,t,s,r){var a=gt,l=Xa.transition;Xa.transition=null;try{gt=1,qu(e,t,s,r)}finally{gt=a,Xa.transition=l}}function Cy(e,t,s,r){var a=gt,l=Xa.transition;Xa.transition=null;try{gt=4,qu(e,t,s,r)}finally{gt=a,Xa.transition=l}}function qu(e,t,s,r){if(Uo){var a=Gd(e,t,s,r);if(a===null)sd(e,t,r,Bo,s),Tf(e,r);else if(Ny(a,e,t,s,r))r.stopPropagation();else if(Tf(e,r),t&4&&-1<jy.indexOf(e)){for(;a!==null;){var l=Pi(a);if(l!==null&&E0(l),l=Gd(e,t,s,r),l===null&&sd(e,t,r,Bo,s),l===a)break;a=l}a!==null&&r.stopPropagation()}else sd(e,t,r,null,s)}}var Bo=null;function Gd(e,t,s,r){if(Bo=null,e=Vu(r),e=ra(e),e!==null)if(t=ga(e),t===null)e=null;else if(s=t.tag,s===13){if(e=v0(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bo=e,null}function P0(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fy()){case Gu:return 1;case N0:return 4;case Oo:case hy:return 16;case k0:return 536870912;default:return 16}default:return 16}}var Mr=null,Yu=null,bo=null;function L0(){if(bo)return bo;var e,t=Yu,s=t.length,r,a="value"in Mr?Mr.value:Mr.textContent,l=a.length;for(e=0;e<s&&t[e]===a[e];e++);var i=s-e;for(r=1;r<=i&&t[s-r]===a[l-r];r++);return bo=a.slice(e,1<r?1-r:void 0)}function wo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function no(){return!0}function If(){return!1}function ls(e){function t(s,r,a,l,i){this._reactName=s,this._targetInst=a,this.type=r,this.nativeEvent=l,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],this[o]=s?s(l):l[o]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?no:If,this.isPropagationStopped=If,this}return Jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=no)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=no)},persist:function(){},isPersistent:no}),t}var hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xu=ls(hl),Di=Jt({},hl,{view:0,detail:0}),Ey=ls(Di),Jc,qc,Ul,mc=Jt({},Di,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ul&&(Ul&&e.type==="mousemove"?(Jc=e.screenX-Ul.screenX,qc=e.screenY-Ul.screenY):qc=Jc=0,Ul=e),Jc)},movementY:function(e){return"movementY"in e?e.movementY:qc}}),Df=ls(mc),Ty=Jt({},mc,{dataTransfer:0}),My=ls(Ty),Iy=Jt({},Di,{relatedTarget:0}),Yc=ls(Iy),Dy=Jt({},hl,{animationName:0,elapsedTime:0,pseudoElement:0}),Py=ls(Dy),Ly=Jt({},hl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ay=ls(Ly),Ry=Jt({},hl,{data:0}),Pf=ls(Ry),Oy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_y={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function By(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Uy[e])?!!t[e]:!1}function Qu(){return By}var $y=Jt({},Di,{key:function(e){if(e.key){var t=Oy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=wo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_y[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qu,charCode:function(e){return e.type==="keypress"?wo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?wo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Fy=ls($y),zy=Jt({},mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lf=ls(zy),Hy=Jt({},Di,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qu}),Wy=ls(Hy),Vy=Jt({},hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gy=ls(Vy),Ky=Jt({},mc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Jy=ls(Ky),qy=[9,13,27,32],Zu=dr&&"CompositionEvent"in window,Jl=null;dr&&"documentMode"in document&&(Jl=document.documentMode);var Yy=dr&&"TextEvent"in window&&!Jl,A0=dr&&(!Zu||Jl&&8<Jl&&11>=Jl),Af=" ",Rf=!1;function R0(e,t){switch(e){case"keyup":return qy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O0(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ua=!1;function Xy(e,t){switch(e){case"compositionend":return O0(t);case"keypress":return t.which!==32?null:(Rf=!0,Af);case"textInput":return e=t.data,e===Af&&Rf?null:e;default:return null}}function Qy(e,t){if(Ua)return e==="compositionend"||!Zu&&R0(e,t)?(e=L0(),bo=Yu=Mr=null,Ua=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return A0&&t.locale!=="ko"?null:t.data;default:return null}}var Zy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Of(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zy[e.type]:t==="textarea"}function _0(e,t,s,r){h0(r),t=$o(t,"onChange"),0<t.length&&(s=new Xu("onChange","change",null,s,r),e.push({event:s,listeners:t}))}var ql=null,pi=null;function ev(e){J0(e,0)}function fc(e){var t=Fa(e);if(i0(t))return e}function tv(e,t){if(e==="change")return t}var U0=!1;if(dr){var Xc;if(dr){var Qc="oninput"in document;if(!Qc){var _f=document.createElement("div");_f.setAttribute("oninput","return;"),Qc=typeof _f.oninput=="function"}Xc=Qc}else Xc=!1;U0=Xc&&(!document.documentMode||9<document.documentMode)}function Uf(){ql&&(ql.detachEvent("onpropertychange",B0),pi=ql=null)}function B0(e){if(e.propertyName==="value"&&fc(pi)){var t=[];_0(t,pi,e,Vu(e)),y0(ev,t)}}function nv(e,t,s){e==="focusin"?(Uf(),ql=t,pi=s,ql.attachEvent("onpropertychange",B0)):e==="focusout"&&Uf()}function sv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fc(pi)}function rv(e,t){if(e==="click")return fc(t)}function av(e,t){if(e==="input"||e==="change")return fc(t)}function lv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Us=typeof Object.is=="function"?Object.is:lv;function xi(e,t){if(Us(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var a=s[r];if(!Td.call(t,a)||!Us(e[a],t[a]))return!1}return!0}function Bf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $f(e,t){var s=Bf(e);e=0;for(var r;s;){if(s.nodeType===3){if(r=e+s.textContent.length,e<=t&&r>=t)return{node:s,offset:t-e};e=r}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Bf(s)}}function $0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function F0(){for(var e=window,t=Lo();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=Lo(e.document)}return t}function em(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iv(e){var t=F0(),s=e.focusedElem,r=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&$0(s.ownerDocument.documentElement,s)){if(r!==null&&em(s)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=s.textContent.length,l=Math.min(r.start,a);r=r.end===void 0?l:Math.min(r.end,a),!e.extend&&l>r&&(a=r,r=l,l=a),a=$f(s,l);var i=$f(s,r);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ov=dr&&"documentMode"in document&&11>=document.documentMode,Ba=null,Kd=null,Yl=null,Jd=!1;function Ff(e,t,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Jd||Ba==null||Ba!==Lo(r)||(r=Ba,"selectionStart"in r&&em(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yl&&xi(Yl,r)||(Yl=r,r=$o(Kd,"onSelect"),0<r.length&&(t=new Xu("onSelect","select",null,t,s),e.push({event:t,listeners:r}),t.target=Ba)))}function so(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var $a={animationend:so("Animation","AnimationEnd"),animationiteration:so("Animation","AnimationIteration"),animationstart:so("Animation","AnimationStart"),transitionend:so("Transition","TransitionEnd")},Zc={},z0={};dr&&(z0=document.createElement("div").style,"AnimationEvent"in window||(delete $a.animationend.animation,delete $a.animationiteration.animation,delete $a.animationstart.animation),"TransitionEvent"in window||delete $a.transitionend.transition);function hc(e){if(Zc[e])return Zc[e];if(!$a[e])return e;var t=$a[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in z0)return Zc[e]=t[s];return e}var H0=hc("animationend"),W0=hc("animationiteration"),V0=hc("animationstart"),G0=hc("transitionend"),K0=new Map,zf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wr(e,t){K0.set(e,t),xa(t,[e])}for(var ed=0;ed<zf.length;ed++){var td=zf[ed],cv=td.toLowerCase(),dv=td[0].toUpperCase()+td.slice(1);Wr(cv,"on"+dv)}Wr(H0,"onAnimationEnd");Wr(W0,"onAnimationIteration");Wr(V0,"onAnimationStart");Wr("dblclick","onDoubleClick");Wr("focusin","onFocus");Wr("focusout","onBlur");Wr(G0,"onTransitionEnd");el("onMouseEnter",["mouseout","mouseover"]);el("onMouseLeave",["mouseout","mouseover"]);el("onPointerEnter",["pointerout","pointerover"]);el("onPointerLeave",["pointerout","pointerover"]);xa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xa("onBeforeInput",["compositionend","keypress","textInput","paste"]);xa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vl));function Hf(e,t,s){var r=e.type||"unknown-event";e.currentTarget=s,cy(r,t,void 0,e),e.currentTarget=null}function J0(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var r=e[s],a=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==l&&a.isPropagationStopped())break e;Hf(a,o,u),l=c}else for(i=0;i<r.length;i++){if(o=r[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==l&&a.isPropagationStopped())break e;Hf(a,o,u),l=c}}}if(Ro)throw e=Hd,Ro=!1,Hd=null,e}function Ut(e,t){var s=t[Zd];s===void 0&&(s=t[Zd]=new Set);var r=e+"__bubble";s.has(r)||(q0(t,e,2,!1),s.add(r))}function nd(e,t,s){var r=0;t&&(r|=4),q0(s,e,r,t)}var ro="_reactListening"+Math.random().toString(36).slice(2);function gi(e){if(!e[ro]){e[ro]=!0,n0.forEach(function(s){s!=="selectionchange"&&(uv.has(s)||nd(s,!1,e),nd(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ro]||(t[ro]=!0,nd("selectionchange",!1,t))}}function q0(e,t,s,r){switch(P0(t)){case 1:var a=Sy;break;case 4:a=Cy;break;default:a=qu}s=a.bind(null,t,s,e),a=void 0,!zd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,s,{capture:!0,passive:a}):e.addEventListener(t,s,!0):a!==void 0?e.addEventListener(t,s,{passive:a}):e.addEventListener(t,s,!1)}function sd(e,t,s,r,a){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ra(o),i===null)return;if(c=i.tag,c===5||c===6){r=l=i;continue e}o=o.parentNode}}r=r.return}y0(function(){var u=l,d=Vu(s),g=[];e:{var x=K0.get(e);if(x!==void 0){var y=Xu,v=e;switch(e){case"keypress":if(wo(s)===0)break e;case"keydown":case"keyup":y=Fy;break;case"focusin":v="focus",y=Yc;break;case"focusout":v="blur",y=Yc;break;case"beforeblur":case"afterblur":y=Yc;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Df;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=My;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=Wy;break;case H0:case W0:case V0:y=Py;break;case G0:y=Gy;break;case"scroll":y=Ey;break;case"wheel":y=Jy;break;case"copy":case"cut":case"paste":y=Ay;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Lf}var C=(t&4)!==0,D=!C&&e==="scroll",b=C?x!==null?x+"Capture":null:x;C=[];for(var h=u,w;h!==null;){w=h;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,b!==null&&(E=ui(h,b),E!=null&&C.push(yi(h,E,w)))),D)break;h=h.return}0<C.length&&(x=new y(x,v,null,s,d),g.push({event:x,listeners:C}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",x&&s!==$d&&(v=s.relatedTarget||s.fromElement)&&(ra(v)||v[ur]))break e;if((y||x)&&(x=d.window===d?d:(x=d.ownerDocument)?x.defaultView||x.parentWindow:window,y?(v=s.relatedTarget||s.toElement,y=u,v=v?ra(v):null,v!==null&&(D=ga(v),v!==D||v.tag!==5&&v.tag!==6)&&(v=null)):(y=null,v=u),y!==v)){if(C=Df,E="onMouseLeave",b="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(C=Lf,E="onPointerLeave",b="onPointerEnter",h="pointer"),D=y==null?x:Fa(y),w=v==null?x:Fa(v),x=new C(E,h+"leave",y,s,d),x.target=D,x.relatedTarget=w,E=null,ra(d)===u&&(C=new C(b,h+"enter",v,s,d),C.target=w,C.relatedTarget=D,E=C),D=E,y&&v)t:{for(C=y,b=v,h=0,w=C;w;w=Ra(w))h++;for(w=0,E=b;E;E=Ra(E))w++;for(;0<h-w;)C=Ra(C),h--;for(;0<w-h;)b=Ra(b),w--;for(;h--;){if(C===b||b!==null&&C===b.alternate)break t;C=Ra(C),b=Ra(b)}C=null}else C=null;y!==null&&Wf(g,x,y,C,!1),v!==null&&D!==null&&Wf(g,D,v,C,!0)}}e:{if(x=u?Fa(u):window,y=x.nodeName&&x.nodeName.toLowerCase(),y==="select"||y==="input"&&x.type==="file")var p=tv;else if(Of(x))if(U0)p=av;else{p=sv;var S=nv}else(y=x.nodeName)&&y.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(p=rv);if(p&&(p=p(e,u))){_0(g,p,s,d);break e}S&&S(e,x,u),e==="focusout"&&(S=x._wrapperState)&&S.controlled&&x.type==="number"&&Rd(x,"number",x.value)}switch(S=u?Fa(u):window,e){case"focusin":(Of(S)||S.contentEditable==="true")&&(Ba=S,Kd=u,Yl=null);break;case"focusout":Yl=Kd=Ba=null;break;case"mousedown":Jd=!0;break;case"contextmenu":case"mouseup":case"dragend":Jd=!1,Ff(g,s,d);break;case"selectionchange":if(ov)break;case"keydown":case"keyup":Ff(g,s,d)}var P;if(Zu)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ua?R0(e,s)&&(N="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(N="onCompositionStart");N&&(A0&&s.locale!=="ko"&&(Ua||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ua&&(P=L0()):(Mr=d,Yu="value"in Mr?Mr.value:Mr.textContent,Ua=!0)),S=$o(u,N),0<S.length&&(N=new Pf(N,e,null,s,d),g.push({event:N,listeners:S}),P?N.data=P:(P=O0(s),P!==null&&(N.data=P)))),(P=Yy?Xy(e,s):Qy(e,s))&&(u=$o(u,"onBeforeInput"),0<u.length&&(d=new Pf("onBeforeInput","beforeinput",null,s,d),g.push({event:d,listeners:u}),d.data=P))}J0(g,t)})}function yi(e,t,s){return{instance:e,listener:t,currentTarget:s}}function $o(e,t){for(var s=t+"Capture",r=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=ui(e,s),l!=null&&r.unshift(yi(e,l,a)),l=ui(e,t),l!=null&&r.push(yi(e,l,a))),e=e.return}return r}function Ra(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Wf(e,t,s,r,a){for(var l=t._reactName,i=[];s!==null&&s!==r;){var o=s,c=o.alternate,u=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&u!==null&&(o=u,a?(c=ui(s,l),c!=null&&i.unshift(yi(s,c,o))):a||(c=ui(s,l),c!=null&&i.push(yi(s,c,o)))),s=s.return}i.length!==0&&e.push({event:t,listeners:i})}var mv=/\r\n?/g,fv=/\u0000|\uFFFD/g;function Vf(e){return(typeof e=="string"?e:""+e).replace(mv,`
`).replace(fv,"")}function ao(e,t,s){if(t=Vf(t),Vf(e)!==t&&s)throw Error(se(425))}function Fo(){}var qd=null,Yd=null;function Xd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qd=typeof setTimeout=="function"?setTimeout:void 0,hv=typeof clearTimeout=="function"?clearTimeout:void 0,Gf=typeof Promise=="function"?Promise:void 0,pv=typeof queueMicrotask=="function"?queueMicrotask:typeof Gf<"u"?function(e){return Gf.resolve(null).then(e).catch(xv)}:Qd;function xv(e){setTimeout(function(){throw e})}function rd(e,t){var s=t,r=0;do{var a=s.nextSibling;if(e.removeChild(s),a&&a.nodeType===8)if(s=a.data,s==="/$"){if(r===0){e.removeChild(a),hi(t);return}r--}else s!=="$"&&s!=="$?"&&s!=="$!"||r++;s=a}while(s);hi(t)}function _r(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Kf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var pl=Math.random().toString(36).slice(2),Vs="__reactFiber$"+pl,vi="__reactProps$"+pl,ur="__reactContainer$"+pl,Zd="__reactEvents$"+pl,gv="__reactListeners$"+pl,yv="__reactHandles$"+pl;function ra(e){var t=e[Vs];if(t)return t;for(var s=e.parentNode;s;){if(t=s[ur]||s[Vs]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Kf(e);e!==null;){if(s=e[Vs])return s;e=Kf(e)}return t}e=s,s=e.parentNode}return null}function Pi(e){return e=e[Vs]||e[ur],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Fa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(se(33))}function pc(e){return e[vi]||null}var eu=[],za=-1;function Vr(e){return{current:e}}function Bt(e){0>za||(e.current=eu[za],eu[za]=null,za--)}function It(e,t){za++,eu[za]=e.current,e.current=t}var Hr={},Pn=Vr(Hr),Vn=Vr(!1),ua=Hr;function tl(e,t){var s=e.type.contextTypes;if(!s)return Hr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in s)a[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Gn(e){return e=e.childContextTypes,e!=null}function zo(){Bt(Vn),Bt(Pn)}function Jf(e,t,s){if(Pn.current!==Hr)throw Error(se(168));It(Pn,t),It(Vn,s)}function Y0(e,t,s){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return s;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(se(108,ny(e)||"Unknown",a));return Jt({},s,r)}function Ho(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Hr,ua=Pn.current,It(Pn,e),It(Vn,Vn.current),!0}function qf(e,t,s){var r=e.stateNode;if(!r)throw Error(se(169));s?(e=Y0(e,t,ua),r.__reactInternalMemoizedMergedChildContext=e,Bt(Vn),Bt(Pn),It(Pn,e)):Bt(Vn),It(Vn,s)}var lr=null,xc=!1,ad=!1;function X0(e){lr===null?lr=[e]:lr.push(e)}function vv(e){xc=!0,X0(e)}function Gr(){if(!ad&&lr!==null){ad=!0;var e=0,t=gt;try{var s=lr;for(gt=1;e<s.length;e++){var r=s[e];do r=r(!0);while(r!==null)}lr=null,xc=!1}catch(a){throw lr!==null&&(lr=lr.slice(e+1)),j0(Gu,Gr),a}finally{gt=t,ad=!1}}return null}var Ha=[],Wa=0,Wo=null,Vo=0,ys=[],vs=0,ma=null,ir=1,or="";function na(e,t){Ha[Wa++]=Vo,Ha[Wa++]=Wo,Wo=e,Vo=t}function Q0(e,t,s){ys[vs++]=ir,ys[vs++]=or,ys[vs++]=ma,ma=e;var r=ir;e=or;var a=32-Os(r)-1;r&=~(1<<a),s+=1;var l=32-Os(t)+a;if(30<l){var i=a-a%5;l=(r&(1<<i)-1).toString(32),r>>=i,a-=i,ir=1<<32-Os(t)+a|s<<a|r,or=l+e}else ir=1<<l|s<<a|r,or=e}function tm(e){e.return!==null&&(na(e,1),Q0(e,1,0))}function nm(e){for(;e===Wo;)Wo=Ha[--Wa],Ha[Wa]=null,Vo=Ha[--Wa],Ha[Wa]=null;for(;e===ma;)ma=ys[--vs],ys[vs]=null,or=ys[--vs],ys[vs]=null,ir=ys[--vs],ys[vs]=null}var ns=null,ts=null,Ht=!1,Rs=null;function Z0(e,t){var s=bs(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Yf(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ns=e,ts=_r(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ns=e,ts=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=ma!==null?{id:ir,overflow:or}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=bs(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,ns=e,ts=null,!0):!1;default:return!1}}function tu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function nu(e){if(Ht){var t=ts;if(t){var s=t;if(!Yf(e,t)){if(tu(e))throw Error(se(418));t=_r(s.nextSibling);var r=ns;t&&Yf(e,t)?Z0(r,s):(e.flags=e.flags&-4097|2,Ht=!1,ns=e)}}else{if(tu(e))throw Error(se(418));e.flags=e.flags&-4097|2,Ht=!1,ns=e}}}function Xf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ns=e}function lo(e){if(e!==ns)return!1;if(!Ht)return Xf(e),Ht=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xd(e.type,e.memoizedProps)),t&&(t=ts)){if(tu(e))throw ep(),Error(se(418));for(;t;)Z0(e,t),t=_r(t.nextSibling)}if(Xf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){ts=_r(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}ts=null}}else ts=ns?_r(e.stateNode.nextSibling):null;return!0}function ep(){for(var e=ts;e;)e=_r(e.nextSibling)}function nl(){ts=ns=null,Ht=!1}function sm(e){Rs===null?Rs=[e]:Rs.push(e)}var bv=hr.ReactCurrentBatchConfig;function Bl(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(se(309));var r=s.stateNode}if(!r)throw Error(se(147,e));var a=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(i){var o=a.refs;i===null?delete o[l]:o[l]=i},t._stringRef=l,t)}if(typeof e!="string")throw Error(se(284));if(!s._owner)throw Error(se(290,e))}return e}function io(e,t){throw e=Object.prototype.toString.call(t),Error(se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qf(e){var t=e._init;return t(e._payload)}function tp(e){function t(b,h){if(e){var w=b.deletions;w===null?(b.deletions=[h],b.flags|=16):w.push(h)}}function s(b,h){if(!e)return null;for(;h!==null;)t(b,h),h=h.sibling;return null}function r(b,h){for(b=new Map;h!==null;)h.key!==null?b.set(h.key,h):b.set(h.index,h),h=h.sibling;return b}function a(b,h){return b=Fr(b,h),b.index=0,b.sibling=null,b}function l(b,h,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<h?(b.flags|=2,h):w):(b.flags|=2,h)):(b.flags|=1048576,h)}function i(b){return e&&b.alternate===null&&(b.flags|=2),b}function o(b,h,w,E){return h===null||h.tag!==6?(h=md(w,b.mode,E),h.return=b,h):(h=a(h,w),h.return=b,h)}function c(b,h,w,E){var p=w.type;return p===_a?d(b,h,w.props.children,E,w.key):h!==null&&(h.elementType===p||typeof p=="object"&&p!==null&&p.$$typeof===wr&&Qf(p)===h.type)?(E=a(h,w.props),E.ref=Bl(b,h,w),E.return=b,E):(E=To(w.type,w.key,w.props,null,b.mode,E),E.ref=Bl(b,h,w),E.return=b,E)}function u(b,h,w,E){return h===null||h.tag!==4||h.stateNode.containerInfo!==w.containerInfo||h.stateNode.implementation!==w.implementation?(h=fd(w,b.mode,E),h.return=b,h):(h=a(h,w.children||[]),h.return=b,h)}function d(b,h,w,E,p){return h===null||h.tag!==7?(h=da(w,b.mode,E,p),h.return=b,h):(h=a(h,w),h.return=b,h)}function g(b,h,w){if(typeof h=="string"&&h!==""||typeof h=="number")return h=md(""+h,b.mode,w),h.return=b,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case Yi:return w=To(h.type,h.key,h.props,null,b.mode,w),w.ref=Bl(b,null,h),w.return=b,w;case Oa:return h=fd(h,b.mode,w),h.return=b,h;case wr:var E=h._init;return g(b,E(h._payload),w)}if(Hl(h)||Al(h))return h=da(h,b.mode,w,null),h.return=b,h;io(b,h)}return null}function x(b,h,w,E){var p=h!==null?h.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return p!==null?null:o(b,h,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Yi:return w.key===p?c(b,h,w,E):null;case Oa:return w.key===p?u(b,h,w,E):null;case wr:return p=w._init,x(b,h,p(w._payload),E)}if(Hl(w)||Al(w))return p!==null?null:d(b,h,w,E,null);io(b,w)}return null}function y(b,h,w,E,p){if(typeof E=="string"&&E!==""||typeof E=="number")return b=b.get(w)||null,o(h,b,""+E,p);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Yi:return b=b.get(E.key===null?w:E.key)||null,c(h,b,E,p);case Oa:return b=b.get(E.key===null?w:E.key)||null,u(h,b,E,p);case wr:var S=E._init;return y(b,h,w,S(E._payload),p)}if(Hl(E)||Al(E))return b=b.get(w)||null,d(h,b,E,p,null);io(h,E)}return null}function v(b,h,w,E){for(var p=null,S=null,P=h,N=h=0,q=null;P!==null&&N<w.length;N++){P.index>N?(q=P,P=null):q=P.sibling;var G=x(b,P,w[N],E);if(G===null){P===null&&(P=q);break}e&&P&&G.alternate===null&&t(b,P),h=l(G,h,N),S===null?p=G:S.sibling=G,S=G,P=q}if(N===w.length)return s(b,P),Ht&&na(b,N),p;if(P===null){for(;N<w.length;N++)P=g(b,w[N],E),P!==null&&(h=l(P,h,N),S===null?p=P:S.sibling=P,S=P);return Ht&&na(b,N),p}for(P=r(b,P);N<w.length;N++)q=y(P,b,N,w[N],E),q!==null&&(e&&q.alternate!==null&&P.delete(q.key===null?N:q.key),h=l(q,h,N),S===null?p=q:S.sibling=q,S=q);return e&&P.forEach(function(_){return t(b,_)}),Ht&&na(b,N),p}function C(b,h,w,E){var p=Al(w);if(typeof p!="function")throw Error(se(150));if(w=p.call(w),w==null)throw Error(se(151));for(var S=p=null,P=h,N=h=0,q=null,G=w.next();P!==null&&!G.done;N++,G=w.next()){P.index>N?(q=P,P=null):q=P.sibling;var _=x(b,P,G.value,E);if(_===null){P===null&&(P=q);break}e&&P&&_.alternate===null&&t(b,P),h=l(_,h,N),S===null?p=_:S.sibling=_,S=_,P=q}if(G.done)return s(b,P),Ht&&na(b,N),p;if(P===null){for(;!G.done;N++,G=w.next())G=g(b,G.value,E),G!==null&&(h=l(G,h,N),S===null?p=G:S.sibling=G,S=G);return Ht&&na(b,N),p}for(P=r(b,P);!G.done;N++,G=w.next())G=y(P,b,N,G.value,E),G!==null&&(e&&G.alternate!==null&&P.delete(G.key===null?N:G.key),h=l(G,h,N),S===null?p=G:S.sibling=G,S=G);return e&&P.forEach(function(te){return t(b,te)}),Ht&&na(b,N),p}function D(b,h,w,E){if(typeof w=="object"&&w!==null&&w.type===_a&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Yi:e:{for(var p=w.key,S=h;S!==null;){if(S.key===p){if(p=w.type,p===_a){if(S.tag===7){s(b,S.sibling),h=a(S,w.props.children),h.return=b,b=h;break e}}else if(S.elementType===p||typeof p=="object"&&p!==null&&p.$$typeof===wr&&Qf(p)===S.type){s(b,S.sibling),h=a(S,w.props),h.ref=Bl(b,S,w),h.return=b,b=h;break e}s(b,S);break}else t(b,S);S=S.sibling}w.type===_a?(h=da(w.props.children,b.mode,E,w.key),h.return=b,b=h):(E=To(w.type,w.key,w.props,null,b.mode,E),E.ref=Bl(b,h,w),E.return=b,b=E)}return i(b);case Oa:e:{for(S=w.key;h!==null;){if(h.key===S)if(h.tag===4&&h.stateNode.containerInfo===w.containerInfo&&h.stateNode.implementation===w.implementation){s(b,h.sibling),h=a(h,w.children||[]),h.return=b,b=h;break e}else{s(b,h);break}else t(b,h);h=h.sibling}h=fd(w,b.mode,E),h.return=b,b=h}return i(b);case wr:return S=w._init,D(b,h,S(w._payload),E)}if(Hl(w))return v(b,h,w,E);if(Al(w))return C(b,h,w,E);io(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,h!==null&&h.tag===6?(s(b,h.sibling),h=a(h,w),h.return=b,b=h):(s(b,h),h=md(w,b.mode,E),h.return=b,b=h),i(b)):s(b,h)}return D}var sl=tp(!0),np=tp(!1),Go=Vr(null),Ko=null,Va=null,rm=null;function am(){rm=Va=Ko=null}function lm(e){var t=Go.current;Bt(Go),e._currentValue=t}function su(e,t,s){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===s)break;e=e.return}}function Qa(e,t){Ko=e,rm=Va=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wn=!0),e.firstContext=null)}function Ns(e){var t=e._currentValue;if(rm!==e)if(e={context:e,memoizedValue:t,next:null},Va===null){if(Ko===null)throw Error(se(308));Va=e,Ko.dependencies={lanes:0,firstContext:e}}else Va=Va.next=e;return t}var aa=null;function im(e){aa===null?aa=[e]:aa.push(e)}function sp(e,t,s,r){var a=t.interleaved;return a===null?(s.next=s,im(t)):(s.next=a.next,a.next=s),t.interleaved=s,mr(e,r)}function mr(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var jr=!1;function om(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ur(e,t,s){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,dt&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,mr(e,s)}return a=r.interleaved,a===null?(t.next=t,im(r)):(t.next=a.next,a.next=t),r.interleaved=t,mr(e,s)}function jo(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,s|=r,t.lanes=s,Ku(e,s)}}function Zf(e,t){var s=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var a=null,l=null;if(s=s.firstBaseUpdate,s!==null){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};l===null?a=l=i:l=l.next=i,s=s.next}while(s!==null);l===null?a=l=t:l=l.next=t}else a=l=t;s={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Jo(e,t,s,r){var a=e.updateQueue;jr=!1;var l=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?l=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(l!==null){var g=a.baseState;i=0,d=u=c=null,o=l;do{var x=o.lane,y=o.eventTime;if((r&x)===x){d!==null&&(d=d.next={eventTime:y,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,C=o;switch(x=t,y=s,C.tag){case 1:if(v=C.payload,typeof v=="function"){g=v.call(y,g,x);break e}g=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=C.payload,x=typeof v=="function"?v.call(y,g,x):v,x==null)break e;g=Jt({},g,x);break e;case 2:jr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,x=a.effects,x===null?a.effects=[o]:x.push(o))}else y={eventTime:y,lane:x,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=y,c=g):d=d.next=y,i|=x;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;x=o,o=x.next,x.next=null,a.lastBaseUpdate=x,a.shared.pending=null}}while(!0);if(d===null&&(c=g),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);ha|=i,e.lanes=i,e.memoizedState=g}}function eh(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=s,typeof a!="function")throw Error(se(191,a));a.call(r)}}}var Li={},Ks=Vr(Li),bi=Vr(Li),wi=Vr(Li);function la(e){if(e===Li)throw Error(se(174));return e}function cm(e,t){switch(It(wi,t),It(bi,e),It(Ks,Li),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_d(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_d(t,e)}Bt(Ks),It(Ks,t)}function rl(){Bt(Ks),Bt(bi),Bt(wi)}function ap(e){la(wi.current);var t=la(Ks.current),s=_d(t,e.type);t!==s&&(It(bi,e),It(Ks,s))}function dm(e){bi.current===e&&(Bt(Ks),Bt(bi))}var Vt=Vr(0);function qo(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ld=[];function um(){for(var e=0;e<ld.length;e++)ld[e]._workInProgressVersionPrimary=null;ld.length=0}var No=hr.ReactCurrentDispatcher,id=hr.ReactCurrentBatchConfig,fa=0,Kt=null,mn=null,vn=null,Yo=!1,Xl=!1,ji=0,wv=0;function Tn(){throw Error(se(321))}function mm(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Us(e[s],t[s]))return!1;return!0}function fm(e,t,s,r,a,l){if(fa=l,Kt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,No.current=e===null||e.memoizedState===null?Sv:Cv,e=s(r,a),Xl){l=0;do{if(Xl=!1,ji=0,25<=l)throw Error(se(301));l+=1,vn=mn=null,t.updateQueue=null,No.current=Ev,e=s(r,a)}while(Xl)}if(No.current=Xo,t=mn!==null&&mn.next!==null,fa=0,vn=mn=Kt=null,Yo=!1,t)throw Error(se(300));return e}function hm(){var e=ji!==0;return ji=0,e}function Ws(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?Kt.memoizedState=vn=e:vn=vn.next=e,vn}function ks(){if(mn===null){var e=Kt.alternate;e=e!==null?e.memoizedState:null}else e=mn.next;var t=vn===null?Kt.memoizedState:vn.next;if(t!==null)vn=t,mn=e;else{if(e===null)throw Error(se(310));mn=e,e={memoizedState:mn.memoizedState,baseState:mn.baseState,baseQueue:mn.baseQueue,queue:mn.queue,next:null},vn===null?Kt.memoizedState=vn=e:vn=vn.next=e}return vn}function Ni(e,t){return typeof t=="function"?t(e):t}function od(e){var t=ks(),s=t.queue;if(s===null)throw Error(se(311));s.lastRenderedReducer=e;var r=mn,a=r.baseQueue,l=s.pending;if(l!==null){if(a!==null){var i=a.next;a.next=l.next,l.next=i}r.baseQueue=a=l,s.pending=null}if(a!==null){l=a.next,r=r.baseState;var o=i=null,c=null,u=l;do{var d=u.lane;if((fa&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var g={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=g,i=r):c=c.next=g,Kt.lanes|=d,ha|=d}u=u.next}while(u!==null&&u!==l);c===null?i=r:c.next=o,Us(r,t.memoizedState)||(Wn=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,s.lastRenderedState=r}if(e=s.interleaved,e!==null){a=e;do l=a.lane,Kt.lanes|=l,ha|=l,a=a.next;while(a!==e)}else a===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function cd(e){var t=ks(),s=t.queue;if(s===null)throw Error(se(311));s.lastRenderedReducer=e;var r=s.dispatch,a=s.pending,l=t.memoizedState;if(a!==null){s.pending=null;var i=a=a.next;do l=e(l,i.action),i=i.next;while(i!==a);Us(l,t.memoizedState)||(Wn=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),s.lastRenderedState=l}return[l,r]}function lp(){}function ip(e,t){var s=Kt,r=ks(),a=t(),l=!Us(r.memoizedState,a);if(l&&(r.memoizedState=a,Wn=!0),r=r.queue,pm(dp.bind(null,s,r,e),[e]),r.getSnapshot!==t||l||vn!==null&&vn.memoizedState.tag&1){if(s.flags|=2048,ki(9,cp.bind(null,s,r,a,t),void 0,null),bn===null)throw Error(se(349));fa&30||op(s,t,a)}return a}function op(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Kt.updateQueue,t===null?(t={lastEffect:null,stores:null},Kt.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function cp(e,t,s,r){t.value=s,t.getSnapshot=r,up(t)&&mp(e)}function dp(e,t,s){return s(function(){up(t)&&mp(e)})}function up(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Us(e,s)}catch{return!0}}function mp(e){var t=mr(e,1);t!==null&&_s(t,e,1,-1)}function th(e){var t=Ws();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:e},t.queue=e,e=e.dispatch=kv.bind(null,Kt,e),[t.memoizedState,e]}function ki(e,t,s,r){return e={tag:e,create:t,destroy:s,deps:r,next:null},t=Kt.updateQueue,t===null?(t={lastEffect:null,stores:null},Kt.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(r=s.next,s.next=e,e.next=r,t.lastEffect=e)),e}function fp(){return ks().memoizedState}function ko(e,t,s,r){var a=Ws();Kt.flags|=e,a.memoizedState=ki(1|t,s,void 0,r===void 0?null:r)}function gc(e,t,s,r){var a=ks();r=r===void 0?null:r;var l=void 0;if(mn!==null){var i=mn.memoizedState;if(l=i.destroy,r!==null&&mm(r,i.deps)){a.memoizedState=ki(t,s,l,r);return}}Kt.flags|=e,a.memoizedState=ki(1|t,s,l,r)}function nh(e,t){return ko(8390656,8,e,t)}function pm(e,t){return gc(2048,8,e,t)}function hp(e,t){return gc(4,2,e,t)}function pp(e,t){return gc(4,4,e,t)}function xp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gp(e,t,s){return s=s!=null?s.concat([e]):null,gc(4,4,xp.bind(null,t,e),s)}function xm(){}function yp(e,t){var s=ks();t=t===void 0?null:t;var r=s.memoizedState;return r!==null&&t!==null&&mm(t,r[1])?r[0]:(s.memoizedState=[e,t],e)}function vp(e,t){var s=ks();t=t===void 0?null:t;var r=s.memoizedState;return r!==null&&t!==null&&mm(t,r[1])?r[0]:(e=e(),s.memoizedState=[e,t],e)}function bp(e,t,s){return fa&21?(Us(s,t)||(s=S0(),Kt.lanes|=s,ha|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wn=!0),e.memoizedState=s)}function jv(e,t){var s=gt;gt=s!==0&&4>s?s:4,e(!0);var r=id.transition;id.transition={};try{e(!1),t()}finally{gt=s,id.transition=r}}function wp(){return ks().memoizedState}function Nv(e,t,s){var r=$r(e);if(s={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null},jp(e))Np(t,s);else if(s=sp(e,t,s,r),s!==null){var a=_n();_s(s,e,r,a),kp(s,t,r)}}function kv(e,t,s){var r=$r(e),a={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null};if(jp(e))Np(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var i=t.lastRenderedState,o=l(i,s);if(a.hasEagerState=!0,a.eagerState=o,Us(o,i)){var c=t.interleaved;c===null?(a.next=a,im(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}s=sp(e,t,a,r),s!==null&&(a=_n(),_s(s,e,r,a),kp(s,t,r))}}function jp(e){var t=e.alternate;return e===Kt||t!==null&&t===Kt}function Np(e,t){Xl=Yo=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function kp(e,t,s){if(s&4194240){var r=t.lanes;r&=e.pendingLanes,s|=r,t.lanes=s,Ku(e,s)}}var Xo={readContext:Ns,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useInsertionEffect:Tn,useLayoutEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useMutableSource:Tn,useSyncExternalStore:Tn,useId:Tn,unstable_isNewReconciler:!1},Sv={readContext:Ns,useCallback:function(e,t){return Ws().memoizedState=[e,t===void 0?null:t],e},useContext:Ns,useEffect:nh,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,ko(4194308,4,xp.bind(null,t,e),s)},useLayoutEffect:function(e,t){return ko(4194308,4,e,t)},useInsertionEffect:function(e,t){return ko(4,2,e,t)},useMemo:function(e,t){var s=Ws();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var r=Ws();return t=s!==void 0?s(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Nv.bind(null,Kt,e),[r.memoizedState,e]},useRef:function(e){var t=Ws();return e={current:e},t.memoizedState=e},useState:th,useDebugValue:xm,useDeferredValue:function(e){return Ws().memoizedState=e},useTransition:function(){var e=th(!1),t=e[0];return e=jv.bind(null,e[1]),Ws().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var r=Kt,a=Ws();if(Ht){if(s===void 0)throw Error(se(407));s=s()}else{if(s=t(),bn===null)throw Error(se(349));fa&30||op(r,t,s)}a.memoizedState=s;var l={value:s,getSnapshot:t};return a.queue=l,nh(dp.bind(null,r,l,e),[e]),r.flags|=2048,ki(9,cp.bind(null,r,l,s,t),void 0,null),s},useId:function(){var e=Ws(),t=bn.identifierPrefix;if(Ht){var s=or,r=ir;s=(r&~(1<<32-Os(r)-1)).toString(32)+s,t=":"+t+"R"+s,s=ji++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=wv++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Cv={readContext:Ns,useCallback:yp,useContext:Ns,useEffect:pm,useImperativeHandle:gp,useInsertionEffect:hp,useLayoutEffect:pp,useMemo:vp,useReducer:od,useRef:fp,useState:function(){return od(Ni)},useDebugValue:xm,useDeferredValue:function(e){var t=ks();return bp(t,mn.memoizedState,e)},useTransition:function(){var e=od(Ni)[0],t=ks().memoizedState;return[e,t]},useMutableSource:lp,useSyncExternalStore:ip,useId:wp,unstable_isNewReconciler:!1},Ev={readContext:Ns,useCallback:yp,useContext:Ns,useEffect:pm,useImperativeHandle:gp,useInsertionEffect:hp,useLayoutEffect:pp,useMemo:vp,useReducer:cd,useRef:fp,useState:function(){return cd(Ni)},useDebugValue:xm,useDeferredValue:function(e){var t=ks();return mn===null?t.memoizedState=e:bp(t,mn.memoizedState,e)},useTransition:function(){var e=cd(Ni)[0],t=ks().memoizedState;return[e,t]},useMutableSource:lp,useSyncExternalStore:ip,useId:wp,unstable_isNewReconciler:!1};function Ls(e,t){if(e&&e.defaultProps){t=Jt({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function ru(e,t,s,r){t=e.memoizedState,s=s(r,t),s=s==null?t:Jt({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var yc={isMounted:function(e){return(e=e._reactInternals)?ga(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var r=_n(),a=$r(e),l=cr(r,a);l.payload=t,s!=null&&(l.callback=s),t=Ur(e,l,a),t!==null&&(_s(t,e,a,r),jo(t,e,a))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var r=_n(),a=$r(e),l=cr(r,a);l.tag=1,l.payload=t,s!=null&&(l.callback=s),t=Ur(e,l,a),t!==null&&(_s(t,e,a,r),jo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=_n(),r=$r(e),a=cr(s,r);a.tag=2,t!=null&&(a.callback=t),t=Ur(e,a,r),t!==null&&(_s(t,e,r,s),jo(t,e,r))}};function sh(e,t,s,r,a,l,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,i):t.prototype&&t.prototype.isPureReactComponent?!xi(s,r)||!xi(a,l):!0}function Sp(e,t,s){var r=!1,a=Hr,l=t.contextType;return typeof l=="object"&&l!==null?l=Ns(l):(a=Gn(t)?ua:Pn.current,r=t.contextTypes,l=(r=r!=null)?tl(e,a):Hr),t=new t(s,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function rh(e,t,s,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,r),t.state!==e&&yc.enqueueReplaceState(t,t.state,null)}function au(e,t,s,r){var a=e.stateNode;a.props=s,a.state=e.memoizedState,a.refs={},om(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=Ns(l):(l=Gn(t)?ua:Pn.current,a.context=tl(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(ru(e,t,l,s),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&yc.enqueueReplaceState(a,a.state,null),Jo(e,s,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function al(e,t){try{var s="",r=t;do s+=ty(r),r=r.return;while(r);var a=s}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function dd(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function lu(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var Tv=typeof WeakMap=="function"?WeakMap:Map;function Cp(e,t,s){s=cr(-1,s),s.tag=3,s.payload={element:null};var r=t.value;return s.callback=function(){Zo||(Zo=!0,xu=r),lu(e,t)},s}function Ep(e,t,s){s=cr(-1,s),s.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;s.payload=function(){return r(a)},s.callback=function(){lu(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(s.callback=function(){lu(e,t),typeof r!="function"&&(Br===null?Br=new Set([this]):Br.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),s}function ah(e,t,s){var r=e.pingCache;if(r===null){r=e.pingCache=new Tv;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(s)||(a.add(s),e=zv.bind(null,e,t,s),t.then(e,e))}function lh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ih(e,t,s,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=cr(-1,1),t.tag=2,Ur(s,t,1))),s.lanes|=1),e)}var Mv=hr.ReactCurrentOwner,Wn=!1;function On(e,t,s,r){t.child=e===null?np(t,null,s,r):sl(t,e.child,s,r)}function oh(e,t,s,r,a){s=s.render;var l=t.ref;return Qa(t,a),r=fm(e,t,s,r,l,a),s=hm(),e!==null&&!Wn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fr(e,t,a)):(Ht&&s&&tm(t),t.flags|=1,On(e,t,r,a),t.child)}function ch(e,t,s,r,a){if(e===null){var l=s.type;return typeof l=="function"&&!km(l)&&l.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=l,Tp(e,t,l,r,a)):(e=To(s.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var i=l.memoizedProps;if(s=s.compare,s=s!==null?s:xi,s(i,r)&&e.ref===t.ref)return fr(e,t,a)}return t.flags|=1,e=Fr(l,r),e.ref=t.ref,e.return=t,t.child=e}function Tp(e,t,s,r,a){if(e!==null){var l=e.memoizedProps;if(xi(l,r)&&e.ref===t.ref)if(Wn=!1,t.pendingProps=r=l,(e.lanes&a)!==0)e.flags&131072&&(Wn=!0);else return t.lanes=e.lanes,fr(e,t,a)}return iu(e,t,s,r,a)}function Mp(e,t,s){var r=t.pendingProps,a=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(Ka,es),es|=s;else{if(!(s&1073741824))return e=l!==null?l.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,It(Ka,es),es|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:s,It(Ka,es),es|=r}else l!==null?(r=l.baseLanes|s,t.memoizedState=null):r=s,It(Ka,es),es|=r;return On(e,t,a,s),t.child}function Ip(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function iu(e,t,s,r,a){var l=Gn(s)?ua:Pn.current;return l=tl(t,l),Qa(t,a),s=fm(e,t,s,r,l,a),r=hm(),e!==null&&!Wn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,fr(e,t,a)):(Ht&&r&&tm(t),t.flags|=1,On(e,t,s,a),t.child)}function dh(e,t,s,r,a){if(Gn(s)){var l=!0;Ho(t)}else l=!1;if(Qa(t,a),t.stateNode===null)So(e,t),Sp(t,s,r),au(t,s,r,a),r=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=s.contextType;typeof u=="object"&&u!==null?u=Ns(u):(u=Gn(s)?ua:Pn.current,u=tl(t,u));var d=s.getDerivedStateFromProps,g=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==r||c!==u)&&rh(t,i,r,u),jr=!1;var x=t.memoizedState;i.state=x,Jo(t,r,i,a),c=t.memoizedState,o!==r||x!==c||Vn.current||jr?(typeof d=="function"&&(ru(t,s,d,r),c=t.memoizedState),(o=jr||sh(t,s,o,r,x,c,u))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=u,r=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,rp(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ls(t.type,o),i.props=u,g=t.pendingProps,x=i.context,c=s.contextType,typeof c=="object"&&c!==null?c=Ns(c):(c=Gn(s)?ua:Pn.current,c=tl(t,c));var y=s.getDerivedStateFromProps;(d=typeof y=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==g||x!==c)&&rh(t,i,r,c),jr=!1,x=t.memoizedState,i.state=x,Jo(t,r,i,a);var v=t.memoizedState;o!==g||x!==v||Vn.current||jr?(typeof y=="function"&&(ru(t,s,y,r),v=t.memoizedState),(u=jr||sh(t,s,u,r,x,v,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,v,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),i.props=r,i.state=v,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),r=!1)}return ou(e,t,s,r,l,a)}function ou(e,t,s,r,a,l){Ip(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return a&&qf(t,s,!1),fr(e,t,l);r=t.stateNode,Mv.current=t;var o=i&&typeof s.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=sl(t,e.child,null,l),t.child=sl(t,null,o,l)):On(e,t,o,l),t.memoizedState=r.state,a&&qf(t,s,!0),t.child}function Dp(e){var t=e.stateNode;t.pendingContext?Jf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Jf(e,t.context,!1),cm(e,t.containerInfo)}function uh(e,t,s,r,a){return nl(),sm(a),t.flags|=256,On(e,t,s,r),t.child}var cu={dehydrated:null,treeContext:null,retryLane:0};function du(e){return{baseLanes:e,cachePool:null,transitions:null}}function Pp(e,t,s){var r=t.pendingProps,a=Vt.current,l=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),It(Vt,a&1),e===null)return nu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,l?(r=t.mode,l=t.child,i={mode:"hidden",children:i},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=i):l=wc(i,r,0,null),e=da(e,r,s,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=du(s),t.memoizedState=cu,e):gm(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Iv(e,t,i,r,o,a,s);if(l){l=r.fallback,i=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Fr(a,c),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?l=Fr(o,l):(l=da(l,i,s,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,i=e.child.memoizedState,i=i===null?du(s):{baseLanes:i.baseLanes|s,cachePool:null,transitions:i.transitions},l.memoizedState=i,l.childLanes=e.childLanes&~s,t.memoizedState=cu,r}return l=e.child,e=l.sibling,r=Fr(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=s),r.return=t,r.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=r,t.memoizedState=null,r}function gm(e,t){return t=wc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function oo(e,t,s,r){return r!==null&&sm(r),sl(t,e.child,null,s),e=gm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Iv(e,t,s,r,a,l,i){if(s)return t.flags&256?(t.flags&=-257,r=dd(Error(se(422))),oo(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,a=t.mode,r=wc({mode:"visible",children:r.children},a,0,null),l=da(l,a,i,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&sl(t,e.child,null,i),t.child.memoizedState=du(i),t.memoizedState=cu,l);if(!(t.mode&1))return oo(e,t,i,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,l=Error(se(419)),r=dd(l,r,void 0),oo(e,t,i,r)}if(o=(i&e.childLanes)!==0,Wn||o){if(r=bn,r!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|i)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,mr(e,a),_s(r,e,a,-1))}return Nm(),r=dd(Error(se(421))),oo(e,t,i,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Hv.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,ts=_r(a.nextSibling),ns=t,Ht=!0,Rs=null,e!==null&&(ys[vs++]=ir,ys[vs++]=or,ys[vs++]=ma,ir=e.id,or=e.overflow,ma=t),t=gm(t,r.children),t.flags|=4096,t)}function mh(e,t,s){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),su(e.return,t,s)}function ud(e,t,s,r,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=s,l.tailMode=a)}function Lp(e,t,s){var r=t.pendingProps,a=r.revealOrder,l=r.tail;if(On(e,t,r.children,s),r=Vt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&mh(e,s,t);else if(e.tag===19)mh(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(It(Vt,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(s=t.child,a=null;s!==null;)e=s.alternate,e!==null&&qo(e)===null&&(a=s),s=s.sibling;s=a,s===null?(a=t.child,t.child=null):(a=s.sibling,s.sibling=null),ud(t,!1,a,s,l);break;case"backwards":for(s=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&qo(e)===null){t.child=a;break}e=a.sibling,a.sibling=s,s=a,a=e}ud(t,!0,s,null,l);break;case"together":ud(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function So(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function fr(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),ha|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(se(153));if(t.child!==null){for(e=t.child,s=Fr(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Fr(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function Dv(e,t,s){switch(t.tag){case 3:Dp(t),nl();break;case 5:ap(t);break;case 1:Gn(t.type)&&Ho(t);break;case 4:cm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;It(Go,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(It(Vt,Vt.current&1),t.flags|=128,null):s&t.child.childLanes?Pp(e,t,s):(It(Vt,Vt.current&1),e=fr(e,t,s),e!==null?e.sibling:null);It(Vt,Vt.current&1);break;case 19:if(r=(s&t.childLanes)!==0,e.flags&128){if(r)return Lp(e,t,s);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),It(Vt,Vt.current),r)break;return null;case 22:case 23:return t.lanes=0,Mp(e,t,s)}return fr(e,t,s)}var Ap,uu,Rp,Op;Ap=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};uu=function(){};Rp=function(e,t,s,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,la(Ks.current);var l=null;switch(s){case"input":a=Ld(e,a),r=Ld(e,r),l=[];break;case"select":a=Jt({},a,{value:void 0}),r=Jt({},r,{value:void 0}),l=[];break;case"textarea":a=Od(e,a),r=Od(e,r),l=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Fo)}Ud(s,r);var i;s=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(s||(s={}),s[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ci.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var c=r[u];if(o=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(s||(s={}),s[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(s||(s={}),s[i]=c[i])}else s||(l||(l=[]),l.push(u,s)),s=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(l=l||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ci.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ut("scroll",e),l||o===c||(l=[])):(l=l||[]).push(u,c))}s&&(l=l||[]).push("style",s);var u=l;(t.updateQueue=u)&&(t.flags|=4)}};Op=function(e,t,s,r){s!==r&&(t.flags|=4)};function $l(e,t){if(!Ht)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Mn(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,r=0;if(t)for(var a=e.child;a!==null;)s|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)s|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=s,t}function Pv(e,t,s){var r=t.pendingProps;switch(nm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mn(t),null;case 1:return Gn(t.type)&&zo(),Mn(t),null;case 3:return r=t.stateNode,rl(),Bt(Vn),Bt(Pn),um(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(lo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Rs!==null&&(vu(Rs),Rs=null))),uu(e,t),Mn(t),null;case 5:dm(t);var a=la(wi.current);if(s=t.type,e!==null&&t.stateNode!=null)Rp(e,t,s,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(se(166));return Mn(t),null}if(e=la(Ks.current),lo(t)){r=t.stateNode,s=t.type;var l=t.memoizedProps;switch(r[Vs]=t,r[vi]=l,e=(t.mode&1)!==0,s){case"dialog":Ut("cancel",r),Ut("close",r);break;case"iframe":case"object":case"embed":Ut("load",r);break;case"video":case"audio":for(a=0;a<Vl.length;a++)Ut(Vl[a],r);break;case"source":Ut("error",r);break;case"img":case"image":case"link":Ut("error",r),Ut("load",r);break;case"details":Ut("toggle",r);break;case"input":wf(r,l),Ut("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Ut("invalid",r);break;case"textarea":Nf(r,l),Ut("invalid",r)}Ud(s,l),a=null;for(var i in l)if(l.hasOwnProperty(i)){var o=l[i];i==="children"?typeof o=="string"?r.textContent!==o&&(l.suppressHydrationWarning!==!0&&ao(r.textContent,o,e),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(l.suppressHydrationWarning!==!0&&ao(r.textContent,o,e),a=["children",""+o]):ci.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Ut("scroll",r)}switch(s){case"input":Xi(r),jf(r,l,!0);break;case"textarea":Xi(r),kf(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=Fo)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=d0(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(s,{is:r.is}):(e=i.createElement(s),s==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,s),e[Vs]=t,e[vi]=r,Ap(e,t,!1,!1),t.stateNode=e;e:{switch(i=Bd(s,r),s){case"dialog":Ut("cancel",e),Ut("close",e),a=r;break;case"iframe":case"object":case"embed":Ut("load",e),a=r;break;case"video":case"audio":for(a=0;a<Vl.length;a++)Ut(Vl[a],e);a=r;break;case"source":Ut("error",e),a=r;break;case"img":case"image":case"link":Ut("error",e),Ut("load",e),a=r;break;case"details":Ut("toggle",e),a=r;break;case"input":wf(e,r),a=Ld(e,r),Ut("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Jt({},r,{value:void 0}),Ut("invalid",e);break;case"textarea":Nf(e,r),a=Od(e,r),Ut("invalid",e);break;default:a=r}Ud(s,a),o=a;for(l in o)if(o.hasOwnProperty(l)){var c=o[l];l==="style"?f0(e,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&u0(e,c)):l==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&di(e,c):typeof c=="number"&&di(e,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ci.hasOwnProperty(l)?c!=null&&l==="onScroll"&&Ut("scroll",e):c!=null&&Fu(e,l,c,i))}switch(s){case"input":Xi(e),jf(e,r,!1);break;case"textarea":Xi(e),kf(e);break;case"option":r.value!=null&&e.setAttribute("value",""+zr(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?Ja(e,!!r.multiple,l,!1):r.defaultValue!=null&&Ja(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Fo)}switch(s){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mn(t),null;case 6:if(e&&t.stateNode!=null)Op(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(se(166));if(s=la(wi.current),la(Ks.current),lo(t)){if(r=t.stateNode,s=t.memoizedProps,r[Vs]=t,(l=r.nodeValue!==s)&&(e=ns,e!==null))switch(e.tag){case 3:ao(r.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ao(r.nodeValue,s,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(s.nodeType===9?s:s.ownerDocument).createTextNode(r),r[Vs]=t,t.stateNode=r}return Mn(t),null;case 13:if(Bt(Vt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ht&&ts!==null&&t.mode&1&&!(t.flags&128))ep(),nl(),t.flags|=98560,l=!1;else if(l=lo(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(se(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(se(317));l[Vs]=t}else nl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mn(t),l=!1}else Rs!==null&&(vu(Rs),Rs=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Vt.current&1?fn===0&&(fn=3):Nm())),t.updateQueue!==null&&(t.flags|=4),Mn(t),null);case 4:return rl(),uu(e,t),e===null&&gi(t.stateNode.containerInfo),Mn(t),null;case 10:return lm(t.type._context),Mn(t),null;case 17:return Gn(t.type)&&zo(),Mn(t),null;case 19:if(Bt(Vt),l=t.memoizedState,l===null)return Mn(t),null;if(r=(t.flags&128)!==0,i=l.rendering,i===null)if(r)$l(l,!1);else{if(fn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=qo(e),i!==null){for(t.flags|=128,$l(l,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=s,s=t.child;s!==null;)l=s,e=r,l.flags&=14680066,i=l.alternate,i===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,e=i.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return It(Vt,Vt.current&1|2),t.child}e=e.sibling}l.tail!==null&&nn()>ll&&(t.flags|=128,r=!0,$l(l,!1),t.lanes=4194304)}else{if(!r)if(e=qo(i),e!==null){if(t.flags|=128,r=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),$l(l,!0),l.tail===null&&l.tailMode==="hidden"&&!i.alternate&&!Ht)return Mn(t),null}else 2*nn()-l.renderingStartTime>ll&&s!==1073741824&&(t.flags|=128,r=!0,$l(l,!1),t.lanes=4194304);l.isBackwards?(i.sibling=t.child,t.child=i):(s=l.last,s!==null?s.sibling=i:t.child=i,l.last=i)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=nn(),t.sibling=null,s=Vt.current,It(Vt,r?s&1|2:s&1),t):(Mn(t),null);case 22:case 23:return jm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?es&1073741824&&(Mn(t),t.subtreeFlags&6&&(t.flags|=8192)):Mn(t),null;case 24:return null;case 25:return null}throw Error(se(156,t.tag))}function Lv(e,t){switch(nm(t),t.tag){case 1:return Gn(t.type)&&zo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return rl(),Bt(Vn),Bt(Pn),um(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return dm(t),null;case 13:if(Bt(Vt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(se(340));nl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Bt(Vt),null;case 4:return rl(),null;case 10:return lm(t.type._context),null;case 22:case 23:return jm(),null;case 24:return null;default:return null}}var co=!1,In=!1,Av=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Ga(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(r){Yt(e,t,r)}else s.current=null}function mu(e,t,s){try{s()}catch(r){Yt(e,t,r)}}var fh=!1;function Rv(e,t){if(qd=Uo,e=F0(),em(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var a=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{s.nodeType,l.nodeType}catch{s=null;break e}var i=0,o=-1,c=-1,u=0,d=0,g=e,x=null;t:for(;;){for(var y;g!==s||a!==0&&g.nodeType!==3||(o=i+a),g!==l||r!==0&&g.nodeType!==3||(c=i+r),g.nodeType===3&&(i+=g.nodeValue.length),(y=g.firstChild)!==null;)x=g,g=y;for(;;){if(g===e)break t;if(x===s&&++u===a&&(o=i),x===l&&++d===r&&(c=i),(y=g.nextSibling)!==null)break;g=x,x=g.parentNode}g=y}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(Yd={focusedElem:e,selectionRange:s},Uo=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var C=v.memoizedProps,D=v.memoizedState,b=t.stateNode,h=b.getSnapshotBeforeUpdate(t.elementType===t.type?C:Ls(t.type,C),D);b.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(E){Yt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return v=fh,fh=!1,v}function Ql(e,t,s){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&mu(t,s,l)}a=a.next}while(a!==r)}}function vc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var r=s.create;s.destroy=r()}s=s.next}while(s!==t)}}function fu(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function _p(e){var t=e.alternate;t!==null&&(e.alternate=null,_p(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vs],delete t[vi],delete t[Zd],delete t[gv],delete t[yv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Up(e){return e.tag===5||e.tag===3||e.tag===4}function hh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Up(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hu(e,t,s){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Fo));else if(r!==4&&(e=e.child,e!==null))for(hu(e,t,s),e=e.sibling;e!==null;)hu(e,t,s),e=e.sibling}function pu(e,t,s){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(pu(e,t,s),e=e.sibling;e!==null;)pu(e,t,s),e=e.sibling}var Sn=null,As=!1;function vr(e,t,s){for(s=s.child;s!==null;)Bp(e,t,s),s=s.sibling}function Bp(e,t,s){if(Gs&&typeof Gs.onCommitFiberUnmount=="function")try{Gs.onCommitFiberUnmount(uc,s)}catch{}switch(s.tag){case 5:In||Ga(s,t);case 6:var r=Sn,a=As;Sn=null,vr(e,t,s),Sn=r,As=a,Sn!==null&&(As?(e=Sn,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Sn.removeChild(s.stateNode));break;case 18:Sn!==null&&(As?(e=Sn,s=s.stateNode,e.nodeType===8?rd(e.parentNode,s):e.nodeType===1&&rd(e,s),hi(e)):rd(Sn,s.stateNode));break;case 4:r=Sn,a=As,Sn=s.stateNode.containerInfo,As=!0,vr(e,t,s),Sn=r,As=a;break;case 0:case 11:case 14:case 15:if(!In&&(r=s.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var l=a,i=l.destroy;l=l.tag,i!==void 0&&(l&2||l&4)&&mu(s,t,i),a=a.next}while(a!==r)}vr(e,t,s);break;case 1:if(!In&&(Ga(s,t),r=s.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=s.memoizedProps,r.state=s.memoizedState,r.componentWillUnmount()}catch(o){Yt(s,t,o)}vr(e,t,s);break;case 21:vr(e,t,s);break;case 22:s.mode&1?(In=(r=In)||s.memoizedState!==null,vr(e,t,s),In=r):vr(e,t,s);break;default:vr(e,t,s)}}function ph(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Av),t.forEach(function(r){var a=Wv.bind(null,e,r);s.has(r)||(s.add(r),r.then(a,a))})}}function Ps(e,t){var s=t.deletions;if(s!==null)for(var r=0;r<s.length;r++){var a=s[r];try{var l=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Sn=o.stateNode,As=!1;break e;case 3:Sn=o.stateNode.containerInfo,As=!0;break e;case 4:Sn=o.stateNode.containerInfo,As=!0;break e}o=o.return}if(Sn===null)throw Error(se(160));Bp(l,i,a),Sn=null,As=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Yt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$p(t,e),t=t.sibling}function $p(e,t){var s=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ps(t,e),zs(e),r&4){try{Ql(3,e,e.return),vc(3,e)}catch(C){Yt(e,e.return,C)}try{Ql(5,e,e.return)}catch(C){Yt(e,e.return,C)}}break;case 1:Ps(t,e),zs(e),r&512&&s!==null&&Ga(s,s.return);break;case 5:if(Ps(t,e),zs(e),r&512&&s!==null&&Ga(s,s.return),e.flags&32){var a=e.stateNode;try{di(a,"")}catch(C){Yt(e,e.return,C)}}if(r&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,i=s!==null?s.memoizedProps:l,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&l.type==="radio"&&l.name!=null&&o0(a,l),Bd(o,i);var u=Bd(o,l);for(i=0;i<c.length;i+=2){var d=c[i],g=c[i+1];d==="style"?f0(a,g):d==="dangerouslySetInnerHTML"?u0(a,g):d==="children"?di(a,g):Fu(a,d,g,u)}switch(o){case"input":Ad(a,l);break;case"textarea":c0(a,l);break;case"select":var x=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var y=l.value;y!=null?Ja(a,!!l.multiple,y,!1):x!==!!l.multiple&&(l.defaultValue!=null?Ja(a,!!l.multiple,l.defaultValue,!0):Ja(a,!!l.multiple,l.multiple?[]:"",!1))}a[vi]=l}catch(C){Yt(e,e.return,C)}}break;case 6:if(Ps(t,e),zs(e),r&4){if(e.stateNode===null)throw Error(se(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(C){Yt(e,e.return,C)}}break;case 3:if(Ps(t,e),zs(e),r&4&&s!==null&&s.memoizedState.isDehydrated)try{hi(t.containerInfo)}catch(C){Yt(e,e.return,C)}break;case 4:Ps(t,e),zs(e);break;case 13:Ps(t,e),zs(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(bm=nn())),r&4&&ph(e);break;case 22:if(d=s!==null&&s.memoizedState!==null,e.mode&1?(In=(u=In)||d,Ps(t,e),In=u):Ps(t,e),zs(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(xe=e,d=e.child;d!==null;){for(g=xe=d;xe!==null;){switch(x=xe,y=x.child,x.tag){case 0:case 11:case 14:case 15:Ql(4,x,x.return);break;case 1:Ga(x,x.return);var v=x.stateNode;if(typeof v.componentWillUnmount=="function"){r=x,s=x.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(C){Yt(r,s,C)}}break;case 5:Ga(x,x.return);break;case 22:if(x.memoizedState!==null){gh(g);continue}}y!==null?(y.return=x,xe=y):gh(g)}d=d.sibling}e:for(d=null,g=e;;){if(g.tag===5){if(d===null){d=g;try{a=g.stateNode,u?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(o=g.stateNode,c=g.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=m0("display",i))}catch(C){Yt(e,e.return,C)}}}else if(g.tag===6){if(d===null)try{g.stateNode.nodeValue=u?"":g.memoizedProps}catch(C){Yt(e,e.return,C)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;d===g&&(d=null),g=g.return}d===g&&(d=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Ps(t,e),zs(e),r&4&&ph(e);break;case 21:break;default:Ps(t,e),zs(e)}}function zs(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(Up(s)){var r=s;break e}s=s.return}throw Error(se(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(di(a,""),r.flags&=-33);var l=hh(e);pu(e,l,a);break;case 3:case 4:var i=r.stateNode.containerInfo,o=hh(e);hu(e,o,i);break;default:throw Error(se(161))}}catch(c){Yt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ov(e,t,s){xe=e,Fp(e)}function Fp(e,t,s){for(var r=(e.mode&1)!==0;xe!==null;){var a=xe,l=a.child;if(a.tag===22&&r){var i=a.memoizedState!==null||co;if(!i){var o=a.alternate,c=o!==null&&o.memoizedState!==null||In;o=co;var u=In;if(co=i,(In=c)&&!u)for(xe=a;xe!==null;)i=xe,c=i.child,i.tag===22&&i.memoizedState!==null?yh(a):c!==null?(c.return=i,xe=c):yh(a);for(;l!==null;)xe=l,Fp(l),l=l.sibling;xe=a,co=o,In=u}xh(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,xe=l):xh(e)}}function xh(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:In||vc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!In)if(s===null)r.componentDidMount();else{var a=t.elementType===t.type?s.memoizedProps:Ls(t.type,s.memoizedProps);r.componentDidUpdate(a,s.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&eh(t,l,r);break;case 3:var i=t.updateQueue;if(i!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}eh(t,i,s)}break;case 5:var o=t.stateNode;if(s===null&&t.flags&4){s=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var g=d.dehydrated;g!==null&&hi(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}In||t.flags&512&&fu(t)}catch(x){Yt(t,t.return,x)}}if(t===e){xe=null;break}if(s=t.sibling,s!==null){s.return=t.return,xe=s;break}xe=t.return}}function gh(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var s=t.sibling;if(s!==null){s.return=t.return,xe=s;break}xe=t.return}}function yh(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{vc(4,t)}catch(c){Yt(t,s,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(c){Yt(t,a,c)}}var l=t.return;try{fu(t)}catch(c){Yt(t,l,c)}break;case 5:var i=t.return;try{fu(t)}catch(c){Yt(t,i,c)}}}catch(c){Yt(t,t.return,c)}if(t===e){xe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,xe=o;break}xe=t.return}}var _v=Math.ceil,Qo=hr.ReactCurrentDispatcher,ym=hr.ReactCurrentOwner,ws=hr.ReactCurrentBatchConfig,dt=0,bn=null,cn=null,Cn=0,es=0,Ka=Vr(0),fn=0,Si=null,ha=0,bc=0,vm=0,Zl=null,Hn=null,bm=0,ll=1/0,ar=null,Zo=!1,xu=null,Br=null,uo=!1,Ir=null,ec=0,ei=0,gu=null,Co=-1,Eo=0;function _n(){return dt&6?nn():Co!==-1?Co:Co=nn()}function $r(e){return e.mode&1?dt&2&&Cn!==0?Cn&-Cn:bv.transition!==null?(Eo===0&&(Eo=S0()),Eo):(e=gt,e!==0||(e=window.event,e=e===void 0?16:P0(e.type)),e):1}function _s(e,t,s,r){if(50<ei)throw ei=0,gu=null,Error(se(185));Ii(e,s,r),(!(dt&2)||e!==bn)&&(e===bn&&(!(dt&2)&&(bc|=s),fn===4&&Sr(e,Cn)),Kn(e,r),s===1&&dt===0&&!(t.mode&1)&&(ll=nn()+500,xc&&Gr()))}function Kn(e,t){var s=e.callbackNode;by(e,t);var r=_o(e,e===bn?Cn:0);if(r===0)s!==null&&Ef(s),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(s!=null&&Ef(s),t===1)e.tag===0?vv(vh.bind(null,e)):X0(vh.bind(null,e)),pv(function(){!(dt&6)&&Gr()}),s=null;else{switch(C0(r)){case 1:s=Gu;break;case 4:s=N0;break;case 16:s=Oo;break;case 536870912:s=k0;break;default:s=Oo}s=qp(s,zp.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function zp(e,t){if(Co=-1,Eo=0,dt&6)throw Error(se(327));var s=e.callbackNode;if(Za()&&e.callbackNode!==s)return null;var r=_o(e,e===bn?Cn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=tc(e,r);else{t=r;var a=dt;dt|=2;var l=Wp();(bn!==e||Cn!==t)&&(ar=null,ll=nn()+500,ca(e,t));do try{$v();break}catch(o){Hp(e,o)}while(!0);am(),Qo.current=l,dt=a,cn!==null?t=0:(bn=null,Cn=0,t=fn)}if(t!==0){if(t===2&&(a=Wd(e),a!==0&&(r=a,t=yu(e,a))),t===1)throw s=Si,ca(e,0),Sr(e,r),Kn(e,nn()),s;if(t===6)Sr(e,r);else{if(a=e.current.alternate,!(r&30)&&!Uv(a)&&(t=tc(e,r),t===2&&(l=Wd(e),l!==0&&(r=l,t=yu(e,l))),t===1))throw s=Si,ca(e,0),Sr(e,r),Kn(e,nn()),s;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(se(345));case 2:sa(e,Hn,ar);break;case 3:if(Sr(e,r),(r&130023424)===r&&(t=bm+500-nn(),10<t)){if(_o(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){_n(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Qd(sa.bind(null,e,Hn,ar),t);break}sa(e,Hn,ar);break;case 4:if(Sr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-Os(r);l=1<<i,i=t[i],i>a&&(a=i),r&=~l}if(r=a,r=nn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_v(r/1960))-r,10<r){e.timeoutHandle=Qd(sa.bind(null,e,Hn,ar),r);break}sa(e,Hn,ar);break;case 5:sa(e,Hn,ar);break;default:throw Error(se(329))}}}return Kn(e,nn()),e.callbackNode===s?zp.bind(null,e):null}function yu(e,t){var s=Zl;return e.current.memoizedState.isDehydrated&&(ca(e,t).flags|=256),e=tc(e,t),e!==2&&(t=Hn,Hn=s,t!==null&&vu(t)),e}function vu(e){Hn===null?Hn=e:Hn.push.apply(Hn,e)}function Uv(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var r=0;r<s.length;r++){var a=s[r],l=a.getSnapshot;a=a.value;try{if(!Us(l(),a))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Sr(e,t){for(t&=~vm,t&=~bc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Os(t),r=1<<s;e[s]=-1,t&=~r}}function vh(e){if(dt&6)throw Error(se(327));Za();var t=_o(e,0);if(!(t&1))return Kn(e,nn()),null;var s=tc(e,t);if(e.tag!==0&&s===2){var r=Wd(e);r!==0&&(t=r,s=yu(e,r))}if(s===1)throw s=Si,ca(e,0),Sr(e,t),Kn(e,nn()),s;if(s===6)throw Error(se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,sa(e,Hn,ar),Kn(e,nn()),null}function wm(e,t){var s=dt;dt|=1;try{return e(t)}finally{dt=s,dt===0&&(ll=nn()+500,xc&&Gr())}}function pa(e){Ir!==null&&Ir.tag===0&&!(dt&6)&&Za();var t=dt;dt|=1;var s=ws.transition,r=gt;try{if(ws.transition=null,gt=1,e)return e()}finally{gt=r,ws.transition=s,dt=t,!(dt&6)&&Gr()}}function jm(){es=Ka.current,Bt(Ka)}function ca(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,hv(s)),cn!==null)for(s=cn.return;s!==null;){var r=s;switch(nm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zo();break;case 3:rl(),Bt(Vn),Bt(Pn),um();break;case 5:dm(r);break;case 4:rl();break;case 13:Bt(Vt);break;case 19:Bt(Vt);break;case 10:lm(r.type._context);break;case 22:case 23:jm()}s=s.return}if(bn=e,cn=e=Fr(e.current,null),Cn=es=t,fn=0,Si=null,vm=bc=ha=0,Hn=Zl=null,aa!==null){for(t=0;t<aa.length;t++)if(s=aa[t],r=s.interleaved,r!==null){s.interleaved=null;var a=r.next,l=s.pending;if(l!==null){var i=l.next;l.next=a,r.next=i}s.pending=r}aa=null}return e}function Hp(e,t){do{var s=cn;try{if(am(),No.current=Xo,Yo){for(var r=Kt.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Yo=!1}if(fa=0,vn=mn=Kt=null,Xl=!1,ji=0,ym.current=null,s===null||s.return===null){fn=1,Si=t,cn=null;break}e:{var l=e,i=s.return,o=s,c=t;if(t=Cn,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,g=d.tag;if(!(d.mode&1)&&(g===0||g===11||g===15)){var x=d.alternate;x?(d.updateQueue=x.updateQueue,d.memoizedState=x.memoizedState,d.lanes=x.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=lh(i);if(y!==null){y.flags&=-257,ih(y,i,o,l,t),y.mode&1&&ah(l,u,t),t=y,c=u;var v=t.updateQueue;if(v===null){var C=new Set;C.add(c),t.updateQueue=C}else v.add(c);break e}else{if(!(t&1)){ah(l,u,t),Nm();break e}c=Error(se(426))}}else if(Ht&&o.mode&1){var D=lh(i);if(D!==null){!(D.flags&65536)&&(D.flags|=256),ih(D,i,o,l,t),sm(al(c,o));break e}}l=c=al(c,o),fn!==4&&(fn=2),Zl===null?Zl=[l]:Zl.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var b=Cp(l,c,t);Zf(l,b);break e;case 1:o=c;var h=l.type,w=l.stateNode;if(!(l.flags&128)&&(typeof h.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Br===null||!Br.has(w)))){l.flags|=65536,t&=-t,l.lanes|=t;var E=Ep(l,o,t);Zf(l,E);break e}}l=l.return}while(l!==null)}Gp(s)}catch(p){t=p,cn===s&&s!==null&&(cn=s=s.return);continue}break}while(!0)}function Wp(){var e=Qo.current;return Qo.current=Xo,e===null?Xo:e}function Nm(){(fn===0||fn===3||fn===2)&&(fn=4),bn===null||!(ha&268435455)&&!(bc&268435455)||Sr(bn,Cn)}function tc(e,t){var s=dt;dt|=2;var r=Wp();(bn!==e||Cn!==t)&&(ar=null,ca(e,t));do try{Bv();break}catch(a){Hp(e,a)}while(!0);if(am(),dt=s,Qo.current=r,cn!==null)throw Error(se(261));return bn=null,Cn=0,fn}function Bv(){for(;cn!==null;)Vp(cn)}function $v(){for(;cn!==null&&!uy();)Vp(cn)}function Vp(e){var t=Jp(e.alternate,e,es);e.memoizedProps=e.pendingProps,t===null?Gp(e):cn=t,ym.current=null}function Gp(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=Lv(s,t),s!==null){s.flags&=32767,cn=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{fn=6,cn=null;return}}else if(s=Pv(s,t,es),s!==null){cn=s;return}if(t=t.sibling,t!==null){cn=t;return}cn=t=e}while(t!==null);fn===0&&(fn=5)}function sa(e,t,s){var r=gt,a=ws.transition;try{ws.transition=null,gt=1,Fv(e,t,s,r)}finally{ws.transition=a,gt=r}return null}function Fv(e,t,s,r){do Za();while(Ir!==null);if(dt&6)throw Error(se(327));s=e.finishedWork;var a=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(se(177));e.callbackNode=null,e.callbackPriority=0;var l=s.lanes|s.childLanes;if(wy(e,l),e===bn&&(cn=bn=null,Cn=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||uo||(uo=!0,qp(Oo,function(){return Za(),null})),l=(s.flags&15990)!==0,s.subtreeFlags&15990||l){l=ws.transition,ws.transition=null;var i=gt;gt=1;var o=dt;dt|=4,ym.current=null,Rv(e,s),$p(s,e),iv(Yd),Uo=!!qd,Yd=qd=null,e.current=s,Ov(s),my(),dt=o,gt=i,ws.transition=l}else e.current=s;if(uo&&(uo=!1,Ir=e,ec=a),l=e.pendingLanes,l===0&&(Br=null),py(s.stateNode),Kn(e,nn()),t!==null)for(r=e.onRecoverableError,s=0;s<t.length;s++)a=t[s],r(a.value,{componentStack:a.stack,digest:a.digest});if(Zo)throw Zo=!1,e=xu,xu=null,e;return ec&1&&e.tag!==0&&Za(),l=e.pendingLanes,l&1?e===gu?ei++:(ei=0,gu=e):ei=0,Gr(),null}function Za(){if(Ir!==null){var e=C0(ec),t=ws.transition,s=gt;try{if(ws.transition=null,gt=16>e?16:e,Ir===null)var r=!1;else{if(e=Ir,Ir=null,ec=0,dt&6)throw Error(se(331));var a=dt;for(dt|=4,xe=e.current;xe!==null;){var l=xe,i=l.child;if(xe.flags&16){var o=l.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(xe=u;xe!==null;){var d=xe;switch(d.tag){case 0:case 11:case 15:Ql(8,d,l)}var g=d.child;if(g!==null)g.return=d,xe=g;else for(;xe!==null;){d=xe;var x=d.sibling,y=d.return;if(_p(d),d===u){xe=null;break}if(x!==null){x.return=y,xe=x;break}xe=y}}}var v=l.alternate;if(v!==null){var C=v.child;if(C!==null){v.child=null;do{var D=C.sibling;C.sibling=null,C=D}while(C!==null)}}xe=l}}if(l.subtreeFlags&2064&&i!==null)i.return=l,xe=i;else e:for(;xe!==null;){if(l=xe,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Ql(9,l,l.return)}var b=l.sibling;if(b!==null){b.return=l.return,xe=b;break e}xe=l.return}}var h=e.current;for(xe=h;xe!==null;){i=xe;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,xe=w;else e:for(i=h;xe!==null;){if(o=xe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vc(9,o)}}catch(p){Yt(o,o.return,p)}if(o===i){xe=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,xe=E;break e}xe=o.return}}if(dt=a,Gr(),Gs&&typeof Gs.onPostCommitFiberRoot=="function")try{Gs.onPostCommitFiberRoot(uc,e)}catch{}r=!0}return r}finally{gt=s,ws.transition=t}}return!1}function bh(e,t,s){t=al(s,t),t=Cp(e,t,1),e=Ur(e,t,1),t=_n(),e!==null&&(Ii(e,1,t),Kn(e,t))}function Yt(e,t,s){if(e.tag===3)bh(e,e,s);else for(;t!==null;){if(t.tag===3){bh(t,e,s);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Br===null||!Br.has(r))){e=al(s,e),e=Ep(t,e,1),t=Ur(t,e,1),e=_n(),t!==null&&(Ii(t,1,e),Kn(t,e));break}}t=t.return}}function zv(e,t,s){var r=e.pingCache;r!==null&&r.delete(t),t=_n(),e.pingedLanes|=e.suspendedLanes&s,bn===e&&(Cn&s)===s&&(fn===4||fn===3&&(Cn&130023424)===Cn&&500>nn()-bm?ca(e,0):vm|=s),Kn(e,t)}function Kp(e,t){t===0&&(e.mode&1?(t=eo,eo<<=1,!(eo&130023424)&&(eo=4194304)):t=1);var s=_n();e=mr(e,t),e!==null&&(Ii(e,t,s),Kn(e,s))}function Hv(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),Kp(e,s)}function Wv(e,t){var s=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(s=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(t),Kp(e,s)}var Jp;Jp=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vn.current)Wn=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Wn=!1,Dv(e,t,s);Wn=!!(e.flags&131072)}else Wn=!1,Ht&&t.flags&1048576&&Q0(t,Vo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;So(e,t),e=t.pendingProps;var a=tl(t,Pn.current);Qa(t,s),a=fm(null,t,r,e,a,s);var l=hm();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gn(r)?(l=!0,Ho(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,om(t),a.updater=yc,t.stateNode=a,a._reactInternals=t,au(t,r,e,s),t=ou(null,t,r,!0,l,s)):(t.tag=0,Ht&&l&&tm(t),On(null,t,a,s),t=t.child),t;case 16:r=t.elementType;e:{switch(So(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=Gv(r),e=Ls(r,e),a){case 0:t=iu(null,t,r,e,s);break e;case 1:t=dh(null,t,r,e,s);break e;case 11:t=oh(null,t,r,e,s);break e;case 14:t=ch(null,t,r,Ls(r.type,e),s);break e}throw Error(se(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ls(r,a),iu(e,t,r,a,s);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ls(r,a),dh(e,t,r,a,s);case 3:e:{if(Dp(t),e===null)throw Error(se(387));r=t.pendingProps,l=t.memoizedState,a=l.element,rp(e,t),Jo(t,r,null,s);var i=t.memoizedState;if(r=i.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=al(Error(se(423)),t),t=uh(e,t,r,s,a);break e}else if(r!==a){a=al(Error(se(424)),t),t=uh(e,t,r,s,a);break e}else for(ts=_r(t.stateNode.containerInfo.firstChild),ns=t,Ht=!0,Rs=null,s=np(t,null,r,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(nl(),r===a){t=fr(e,t,s);break e}On(e,t,r,s)}t=t.child}return t;case 5:return ap(t),e===null&&nu(t),r=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,i=a.children,Xd(r,a)?i=null:l!==null&&Xd(r,l)&&(t.flags|=32),Ip(e,t),On(e,t,i,s),t.child;case 6:return e===null&&nu(t),null;case 13:return Pp(e,t,s);case 4:return cm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=sl(t,null,r,s):On(e,t,r,s),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ls(r,a),oh(e,t,r,a,s);case 7:return On(e,t,t.pendingProps,s),t.child;case 8:return On(e,t,t.pendingProps.children,s),t.child;case 12:return On(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,l=t.memoizedProps,i=a.value,It(Go,r._currentValue),r._currentValue=i,l!==null)if(Us(l.value,i)){if(l.children===a.children&&!Vn.current){t=fr(e,t,s);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var o=l.dependencies;if(o!==null){i=l.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(l.tag===1){c=cr(-1,s&-s),c.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}l.lanes|=s,c=l.alternate,c!==null&&(c.lanes|=s),su(l.return,s,t),o.lanes|=s;break}c=c.next}}else if(l.tag===10)i=l.type===t.type?null:l.child;else if(l.tag===18){if(i=l.return,i===null)throw Error(se(341));i.lanes|=s,o=i.alternate,o!==null&&(o.lanes|=s),su(i,s,t),i=l.sibling}else i=l.child;if(i!==null)i.return=l;else for(i=l;i!==null;){if(i===t){i=null;break}if(l=i.sibling,l!==null){l.return=i.return,i=l;break}i=i.return}l=i}On(e,t,a.children,s),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Qa(t,s),a=Ns(a),r=r(a),t.flags|=1,On(e,t,r,s),t.child;case 14:return r=t.type,a=Ls(r,t.pendingProps),a=Ls(r.type,a),ch(e,t,r,a,s);case 15:return Tp(e,t,t.type,t.pendingProps,s);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Ls(r,a),So(e,t),t.tag=1,Gn(r)?(e=!0,Ho(t)):e=!1,Qa(t,s),Sp(t,r,a),au(t,r,a,s),ou(null,t,r,!0,e,s);case 19:return Lp(e,t,s);case 22:return Mp(e,t,s)}throw Error(se(156,t.tag))};function qp(e,t){return j0(e,t)}function Vv(e,t,s,r){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bs(e,t,s,r){return new Vv(e,t,s,r)}function km(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gv(e){if(typeof e=="function")return km(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hu)return 11;if(e===Wu)return 14}return 2}function Fr(e,t){var s=e.alternate;return s===null?(s=bs(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function To(e,t,s,r,a,l){var i=2;if(r=e,typeof e=="function")km(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case _a:return da(s.children,a,l,t);case zu:i=8,a|=8;break;case Md:return e=bs(12,s,t,a|2),e.elementType=Md,e.lanes=l,e;case Id:return e=bs(13,s,t,a),e.elementType=Id,e.lanes=l,e;case Dd:return e=bs(19,s,t,a),e.elementType=Dd,e.lanes=l,e;case a0:return wc(s,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case s0:i=10;break e;case r0:i=9;break e;case Hu:i=11;break e;case Wu:i=14;break e;case wr:i=16,r=null;break e}throw Error(se(130,e==null?e:typeof e,""))}return t=bs(i,s,t,a),t.elementType=e,t.type=r,t.lanes=l,t}function da(e,t,s,r){return e=bs(7,e,r,t),e.lanes=s,e}function wc(e,t,s,r){return e=bs(22,e,r,t),e.elementType=a0,e.lanes=s,e.stateNode={isHidden:!1},e}function md(e,t,s){return e=bs(6,e,null,t),e.lanes=s,e}function fd(e,t,s){return t=bs(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Kv(e,t,s,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kc(0),this.expirationTimes=Kc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kc(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Sm(e,t,s,r,a,l,i,o,c){return e=new Kv(e,t,s,o,c),t===1?(t=1,l===!0&&(t|=8)):t=0,l=bs(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},om(l),e}function Jv(e,t,s){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oa,key:r==null?null:""+r,children:e,containerInfo:t,implementation:s}}function Yp(e){if(!e)return Hr;e=e._reactInternals;e:{if(ga(e)!==e||e.tag!==1)throw Error(se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(se(171))}if(e.tag===1){var s=e.type;if(Gn(s))return Y0(e,s,t)}return t}function Xp(e,t,s,r,a,l,i,o,c){return e=Sm(s,r,!0,e,a,l,i,o,c),e.context=Yp(null),s=e.current,r=_n(),a=$r(s),l=cr(r,a),l.callback=t??null,Ur(s,l,a),e.current.lanes=a,Ii(e,a,r),Kn(e,r),e}function jc(e,t,s,r){var a=t.current,l=_n(),i=$r(a);return s=Yp(s),t.context===null?t.context=s:t.pendingContext=s,t=cr(l,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Ur(a,t,i),e!==null&&(_s(e,a,i,l),jo(e,a,i)),i}function nc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function wh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Cm(e,t){wh(e,t),(e=e.alternate)&&wh(e,t)}function qv(){return null}var Qp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Em(e){this._internalRoot=e}Nc.prototype.render=Em.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(se(409));jc(e,t,null,null)};Nc.prototype.unmount=Em.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pa(function(){jc(null,e,null,null)}),t[ur]=null}};function Nc(e){this._internalRoot=e}Nc.prototype.unstable_scheduleHydration=function(e){if(e){var t=M0();e={blockedOn:null,target:e,priority:t};for(var s=0;s<kr.length&&t!==0&&t<kr[s].priority;s++);kr.splice(s,0,e),s===0&&D0(e)}};function Tm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function kc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jh(){}function Yv(e,t,s,r,a){if(a){if(typeof r=="function"){var l=r;r=function(){var u=nc(i);l.call(u)}}var i=Xp(t,r,e,0,null,!1,!1,"",jh);return e._reactRootContainer=i,e[ur]=i.current,gi(e.nodeType===8?e.parentNode:e),pa(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var u=nc(c);o.call(u)}}var c=Sm(e,0,!1,null,null,!1,!1,"",jh);return e._reactRootContainer=c,e[ur]=c.current,gi(e.nodeType===8?e.parentNode:e),pa(function(){jc(t,c,s,r)}),c}function Sc(e,t,s,r,a){var l=s._reactRootContainer;if(l){var i=l;if(typeof a=="function"){var o=a;a=function(){var c=nc(i);o.call(c)}}jc(t,i,e,a)}else i=Yv(s,t,e,a,r);return nc(i)}E0=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=Wl(t.pendingLanes);s!==0&&(Ku(t,s|1),Kn(t,nn()),!(dt&6)&&(ll=nn()+500,Gr()))}break;case 13:pa(function(){var r=mr(e,1);if(r!==null){var a=_n();_s(r,e,1,a)}}),Cm(e,1)}};Ju=function(e){if(e.tag===13){var t=mr(e,134217728);if(t!==null){var s=_n();_s(t,e,134217728,s)}Cm(e,134217728)}};T0=function(e){if(e.tag===13){var t=$r(e),s=mr(e,t);if(s!==null){var r=_n();_s(s,e,t,r)}Cm(e,t)}};M0=function(){return gt};I0=function(e,t){var s=gt;try{return gt=e,t()}finally{gt=s}};Fd=function(e,t,s){switch(t){case"input":if(Ad(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var r=s[t];if(r!==e&&r.form===e.form){var a=pc(r);if(!a)throw Error(se(90));i0(r),Ad(r,a)}}}break;case"textarea":c0(e,s);break;case"select":t=s.value,t!=null&&Ja(e,!!s.multiple,t,!1)}};x0=wm;g0=pa;var Xv={usingClientEntryPoint:!1,Events:[Pi,Fa,pc,h0,p0,wm]},Fl={findFiberByHostInstance:ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qv={bundleType:Fl.bundleType,version:Fl.version,rendererPackageName:Fl.rendererPackageName,rendererConfig:Fl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=b0(e),e===null?null:e.stateNode},findFiberByHostInstance:Fl.findFiberByHostInstance||qv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mo.isDisabled&&mo.supportsFiber)try{uc=mo.inject(Qv),Gs=mo}catch{}}as.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xv;as.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tm(t))throw Error(se(200));return Jv(e,t,null,s)};as.createRoot=function(e,t){if(!Tm(e))throw Error(se(299));var s=!1,r="",a=Qp;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Sm(e,1,!1,null,null,s,!1,r,a),e[ur]=t.current,gi(e.nodeType===8?e.parentNode:e),new Em(t)};as.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(se(188)):(e=Object.keys(e).join(","),Error(se(268,e)));return e=b0(t),e=e===null?null:e.stateNode,e};as.flushSync=function(e){return pa(e)};as.hydrate=function(e,t,s){if(!kc(t))throw Error(se(200));return Sc(null,e,t,!0,s)};as.hydrateRoot=function(e,t,s){if(!Tm(e))throw Error(se(405));var r=s!=null&&s.hydratedSources||null,a=!1,l="",i=Qp;if(s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(l=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),t=Xp(t,null,e,1,s??null,a,!1,l,i),e[ur]=t.current,gi(e),r)for(e=0;e<r.length;e++)s=r[e],a=s._getVersion,a=a(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,a]:t.mutableSourceEagerHydrationData.push(s,a);return new Nc(t)};as.render=function(e,t,s){if(!kc(t))throw Error(se(200));return Sc(null,e,t,!1,s)};as.unmountComponentAtNode=function(e){if(!kc(e))throw Error(se(40));return e._reactRootContainer?(pa(function(){Sc(null,null,e,!1,function(){e._reactRootContainer=null,e[ur]=null})}),!0):!1};as.unstable_batchedUpdates=wm;as.unstable_renderSubtreeIntoContainer=function(e,t,s,r){if(!kc(s))throw Error(se(200));if(e==null||e._reactInternals===void 0)throw Error(se(38));return Sc(e,t,s,!1,r)};as.version="18.3.1-next-f1338f8080-20240426";function Zp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zp)}catch(e){console.error(e)}}Zp(),Zh.exports=as;var Mm=Zh.exports;const Zv=Au(Mm);var Nh=Mm;Ed.createRoot=Nh.createRoot,Ed.hydrateRoot=Nh.hydrateRoot;/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ex=(...e)=>e.filter((t,s,r)=>!!t&&r.indexOf(t)===s).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tb={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:i,...o},c)=>m.createElement("svg",{ref:c,...tb,width:t,height:t,stroke:e,strokeWidth:r?Number(s)*24/Number(t):s,className:ex("lucide",a),...o},[...i.map(([u,d])=>m.createElement(u,d)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=(e,t)=>{const s=m.forwardRef(({className:r,...a},l)=>m.createElement(nb,{ref:l,iconNode:t,className:ex(`lucide-${eb(e)}`,r),...a}));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=Xt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=Xt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=Xt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=Xt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=Xt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=Xt("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=Xt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=Xt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sc=Xt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=Xt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=Xt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Xt("PoundSterling",[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=Xt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=Xt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=Xt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=Xt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=Xt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=Xt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=Xt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=Xt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=Xt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=Xt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ax=e=>`ndn_online_quota_${e}`;function Io(e=new Date){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),s=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-s);const r=new Date(Date.UTC(t.getUTCFullYear(),0,1)),a=Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7),l=String(a).padStart(2,"0");return`${t.getUTCFullYear()}-${l}`}function lx(e){try{const t=localStorage.getItem(ax(e));if(!t)return{week:Io(),used:0};const s=JSON.parse(t),r=Io();return!s.week||s.week!==r?{week:r,used:0}:{week:String(s.week),used:Number(s.used)||0}}catch{return{week:Io(),used:0}}}function pb(e,t){try{localStorage.setItem(ax(e),JSON.stringify(t))}catch{}}function Sh(e,t=3){const s=Io(),r=lx(e),a={week:s,used:(r.week===s?r.used:0)+1};return pb(e,a),a}function ix(e,t=3){const s=lx(e);return Math.max(0,t-(s.used||0))}const ox="ndn:isAdmin:v1";function cx(){try{const e=localStorage.getItem(ox);return e?JSON.parse(e):{}}catch{return{}}}function xb(e,t){try{const s=cx();s[(e||"").toLowerCase()]={v:t,ts:Date.now()},localStorage.setItem(ox,JSON.stringify(s))}catch{}}async function gb(e){var a,l;const t=String(e||"").toLowerCase();if(!t)return!1;try{const i=String(((l=(a=import.meta)==null?void 0:a.env)==null?void 0:l.VITE_OWNER_EMAIL)||"").toLowerCase();if(i&&t===i)return!0}catch{}if(t==="daviesfamily108@gmail.com")return!0;try{const i=localStorage.getItem("ndn:forceAdmin");if(i==="1"||i==="true")return!0}catch{}const r=cx()[t];if(r&&Date.now()-r.ts<5*60*1e3)return!!r.v;try{const o=await(await fetch(`/api/admins/check?email=${encodeURIComponent(t)}`)).json().catch(()=>({})),c=!!(o!=null&&o.isAdmin);return xb(t,c),c}catch{return!!(r!=null&&r.v)}}function dx(e){const t=String(e||"").toLowerCase(),[s,r]=m.useState(!1);return m.useEffect(()=>{var l,i;let a=!0;if(!t){r(!1);return}try{const o=String(((i=(l=import.meta)==null?void 0:l.env)==null?void 0:i.VITE_OWNER_EMAIL)||"").toLowerCase(),c=(()=>{try{const u=localStorage.getItem("ndn:forceAdmin");return u==="1"||u==="true"}catch{return!1}})();if(o&&t===o){r(!0);return}if(c){r(!0);return}}catch{}if(t==="daviesfamily108@gmail.com"){r(!0);return}return gb(t).then(o=>{a&&r(!!o)}),()=>{a=!1}},[t]),s}const pd={},yb=5,vb={GBP:1,EUR:1.16,USD:1.26,AUD:1.92,NZD:2.08,CAD:1.73};function ux(e,t=yb){const s=(e||"GBP").toUpperCase(),r=vb[s]??1,a=t*r;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s}).format(a)}catch{return`${s} ${a.toFixed(2)}`}}function mx(){try{const e=new Intl.NumberFormat().resolvedOptions(),t=String(e.locale).toLowerCase();return t.includes("-gb")?"GBP":t.includes("-ie")||t.includes("-de")||t.includes("-fr")||t.includes("-es")||t.includes("-it")||t.includes("-nl")?"EUR":t.includes("-us")?"USD":t.includes("-au")?"AUD":t.includes("-nz")?"NZD":t.includes("-ca")?"CAD":"GBP"}catch{return"GBP"}}const bb=(pd==null?void 0:pd.VITE_DISCORD_INVITE_URL)||"https://discord.gg/nCfT4hJz";let rr=null;function wb(){var t,s,r;if(rr)return rr;const e=(r=(s=(t=import.meta)==null?void 0:t.env)==null?void 0:s.VITE_API_URL)==null?void 0:r.trim();if(e)return rr=e.replace(/\/$/,""),rr;if(typeof window<"u"){const{protocol:a,host:l,hostname:i}=window.location,o=`${a}//${l}`;return i.endsWith("onrender.com")||i==="localhost"||i==="127.0.0.1"?rr=o.replace(/\/$/,""):rr="https://ninedartnation.onrender.com",rr}return rr="https://ninedartnation.onrender.com",rr}function jb(e){if(/^https?:\/\//i.test(e))return e;const t=wb(),s=e.startsWith("/")?e:`/${e}`;return`${t}${s}`}function Do(e){return jb(e)}function Gt(e,t){const s=Do(e);return fetch(s,t)}function Nb(){if(typeof window>"u"||typeof window.fetch!="function")return;const e=window;if(e.__ndnApiPatched)return;const t=window.fetch.bind(window);window.fetch=(s,r)=>{try{if(typeof s=="string")return s.startsWith("/")?t(Do(s),r):t(s,r);if(s instanceof Request){const a=s.url.startsWith("/")?Do(s.url):s.url;if(a===s.url)return t(s,r);const l=new Request(a,s);return t(l,r)}if(s instanceof URL){const a=s.href.startsWith("/")?Do(s.href):s.href;return t(a,r)}}catch(a){console.warn("[API] Interceptor failed, falling back to original fetch",a)}return t(s,r)},e.__ndnApiPatched=!0}function kb(e){const t=[{key:"score",label:"Home",icon:lb},{key:"online",label:"Online",icon:bu},{key:"offline",label:"Offline",icon:Mo},{key:"tournaments",label:"Tournaments",icon:Mo},{key:"friends",label:"Friends",icon:bu},{key:"stats",label:"Stats",icon:Mo},{key:"calibrate",label:"Calibrate",icon:tx},{key:"settings",label:"Settings",icon:ti}];return e!=null&&e.fullAccess||t.push({key:"fullaccess",label:"PREMIUM £€$",icon:db}),t}function fx({active:e,onChange:t,user:s,className:r}){const a=kb(s),l=dx(s==null?void 0:s.email);if(l&&!a.some(g=>g.key==="admin")){const g=a.findIndex(y=>y.key==="settings"),x={key:"admin",label:"Admin",icon:ti};g>=0?a.splice(g,0,x):a.push(x)}const[i,o]=m.useState(!1),c=s!=null&&s.username&&!(s!=null&&s.fullAccess)?ix(s.username):1/0,[u,d]=m.useState({friendRequests:0,messages:0,tournaments:0});return m.useEffect(()=>{if(!(s!=null&&s.email))return;const g=async()=>{var y,v;try{const[C,D]=await Promise.all([Gt(`/api/friends/requests?email=${encodeURIComponent(s.email)}`),Gt(`/api/friends/messages?email=${encodeURIComponent(s.email)}`)]),b=C.ok?await C.json():{requests:[]},w=((y=(D.ok?await D.json():{messages:[]}).messages)==null?void 0:y.filter(E=>!E.read).length)||0;d({friendRequests:((v=b.requests)==null?void 0:v.length)||0,messages:w,tournaments:0})}catch(C){console.error("Failed to fetch notifications:",C)}};g();const x=setInterval(g,3e4);return()=>clearInterval(x)},[s==null?void 0:s.email]),m.useEffect(()=>{if(!i)return;const g=x=>{(x.key==="Escape"||x.key==="Enter")&&o(!1)};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[i]),n.jsxs("aside",{className:`${s!=null&&s.fullAccess?"premium-sidebar":""} sidebar glass ${r?"":"w-60"} p-2 sm:p-4 rounded-2xl ${r??"hidden sm:flex"} flex-col gap-2 overflow-y-auto overflow-x-hidden ${r?"":"fixed top-2 bottom-2 sm:top-4 sm:bottom-4"}`,children:[a.map(({key:g,label:x,icon:y})=>g==="admin"&&!l?null:n.jsxs("button",{className:`tab whitespace-nowrap flex items-center justify-start gap-3 ${e===g?"tab--active":"tab--inactive"} `,onClick:()=>t(g),title:x,style:{fontWeight:700,fontSize:"1.1rem",color:e===g?"#fff":"#E5E7EB",letterSpacing:"0.02em"},children:[n.jsx(y,{className:"w-6 h-6"}),n.jsxs("span",{className:"flex items-center gap-2",children:[x,g==="online"&&!(s!=null&&s.fullAccess)&&c<=0&&n.jsxs("span",{title:"Weekly free games used",className:"inline-flex items-center gap-1 text-[0.65rem] px-2 py-0.5 rounded-full bg-rose-600 text-white",children:[n.jsx(ib,{className:"w-3 h-3"}),"Locked"]}),g==="friends"&&u.friendRequests>0&&n.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-orange-500 rounded-full",children:u.friendRequests>9?"9+":u.friendRequests}),g==="score"&&(u.messages>0||u.tournaments>0)&&n.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-orange-500 rounded-full",children:u.messages+u.tournaments>9?"9+":u.messages+u.tournaments})]})]},g)),n.jsxs("button",{className:"tab tab--compact whitespace-nowrap flex items-center justify-start gap-3 bg-[#5865F2] text-white mt-2",onClick:()=>o(!0),title:"BullseyeDartsLeague",style:{fontWeight:700,fontSize:"1.1rem",letterSpacing:"0.02em"},children:[n.jsx(sc,{className:"w-6 h-6"}),n.jsx("span",{className:"truncate",children:"BullseyeDartsLeague"})]}),i&&Mm.createPortal(n.jsxs("div",{className:"fixed inset-0 z-[1000]",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>o(!1),onTouchStart:()=>o(!1)}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:n.jsxs("div",{role:"dialog","aria-modal":"true",className:"card max-w-md w-full relative text-left p-6 rounded-xl",children:[n.jsx("button",{className:"absolute -top-3 -right-3 btn px-3 py-1","aria-label":"Close",onClick:()=>o(!1),children:"✕"}),n.jsxs("h3",{className:"text-xl font-bold mb-2 flex items-center gap-2 text-[#8ea1e1]",children:[n.jsx(sc,{className:"w-6 h-6"})," BullseyeDartsLeague"]}),n.jsx("div",{className:"mb-4 text-lg font-semibold",children:"Join this fantastic Online Darts League with divisions and other cool stuff included"}),n.jsx("a",{href:bb,target:"_blank",rel:"noopener noreferrer nofollow",className:"btn bg-[#5865F2] text-white w-full font-bold text-lg",children:"Join Discord"})]})})]}),document.body)]})}const Sb={},Ch=e=>{let t;const s=new Set,r=(d,g)=>{const x=typeof d=="function"?d(t):d;if(!Object.is(x,t)){const y=t;t=g??(typeof x!="object"||x===null)?x:Object.assign({},t,x),s.forEach(v=>v(t,y))}},a=()=>t,c={setState:r,getState:a,getInitialState:()=>u,subscribe:d=>(s.add(d),()=>s.delete(d)),destroy:()=>{(Sb?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},u=t=e(r,a,c);return c},Cb=e=>e?Ch(e):Ch;var hx={exports:{}},px={},xx={exports:{}},gx={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var il=m;function Eb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tb=typeof Object.is=="function"?Object.is:Eb,Mb=il.useState,Ib=il.useEffect,Db=il.useLayoutEffect,Pb=il.useDebugValue;function Lb(e,t){var s=t(),r=Mb({inst:{value:s,getSnapshot:t}}),a=r[0].inst,l=r[1];return Db(function(){a.value=s,a.getSnapshot=t,xd(a)&&l({inst:a})},[e,s,t]),Ib(function(){return xd(a)&&l({inst:a}),e(function(){xd(a)&&l({inst:a})})},[e]),Pb(s),s}function xd(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Tb(e,s)}catch{return!0}}function Ab(e,t){return t()}var Rb=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ab:Lb;gx.useSyncExternalStore=il.useSyncExternalStore!==void 0?il.useSyncExternalStore:Rb;xx.exports=gx;var Ob=xx.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cc=m,_b=Ob;function Ub(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Bb=typeof Object.is=="function"?Object.is:Ub,$b=_b.useSyncExternalStore,Fb=Cc.useRef,zb=Cc.useEffect,Hb=Cc.useMemo,Wb=Cc.useDebugValue;px.useSyncExternalStoreWithSelector=function(e,t,s,r,a){var l=Fb(null);if(l.current===null){var i={hasValue:!1,value:null};l.current=i}else i=l.current;l=Hb(function(){function c(y){if(!u){if(u=!0,d=y,y=r(y),a!==void 0&&i.hasValue){var v=i.value;if(a(v,y))return g=v}return g=y}if(v=g,Bb(d,y))return v;var C=r(y);return a!==void 0&&a(v,C)?(d=y,v):(d=y,g=C)}var u=!1,d,g,x=s===void 0?null:s;return[function(){return c(t())},x===null?void 0:function(){return c(x())}]},[t,s,r,a]);var o=$b(e,l[0],l[1]);return zb(function(){i.hasValue=!0,i.value=o},[o]),Wb(o),o};hx.exports=px;var Vb=hx.exports;const Gb=Au(Vb),yx={},{useDebugValue:Kb}=zg,{useSyncExternalStoreWithSelector:Jb}=Gb;let Eh=!1;const qb=e=>e;function Yb(e,t=qb,s){(yx?"production":void 0)!=="production"&&s&&!Eh&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Eh=!0);const r=Jb(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return Kb(r),r}const Th=e=>{(yx?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Cb(e):e,s=(r,a)=>Yb(t,r,a);return Object.assign(s,t),s},ya=e=>e?Th(e):Th;let Xb=1;const wu=ya(e=>({toasts:[],push:(t,s)=>e(r=>{const a=Xb++,l={id:a,message:t,type:(s==null?void 0:s.type)||"info",timeout:(s==null?void 0:s.timeout)??3e3};return l.timeout&&l.timeout>0&&setTimeout(()=>{e(i=>({toasts:i.toasts.filter(o=>o.id!==a)}))},l.timeout),{toasts:[...r.toasts,l]}}),remove:t=>e(s=>({toasts:s.toasts.filter(r=>r.id!==t)})),clear:()=>e({toasts:[]})}));function xl(){return wu(t=>t.push)}function jt(e){return(e??0).toFixed(2)}const Qb=e=>`ndn_stats_${e}`,vx=e=>`ndn_stats_ts_${e}`;function Zn(e){try{const t=localStorage.getItem(Qb(e));if(!t)return{darts:0,scored:0};const s=JSON.parse(t);return{darts:Number(s.darts)||0,scored:Number(s.scored)||0,fnDarts:Number(s.fnDarts)||0,fnScored:Number(s.fnScored)||0,best3:typeof s.best3=="number"?s.best3:0,worst3:typeof s.worst3=="number"?s.worst3:0,bestLegDarts:typeof s.bestLegDarts=="number"?s.bestLegDarts:0,bestCheckout:typeof s.bestCheckout=="number"?s.bestCheckout:0,worstLegDarts:typeof s.worstLegDarts=="number"?s.worstLegDarts:0,bestFNAvg:typeof s.bestFNAvg=="number"?s.bestFNAvg:0,worstFNAvg:typeof s.worstFNAvg=="number"?s.worstFNAvg:0}}catch{return{darts:0,scored:0}}}function Dr(e){const{darts:t,scored:s}=Zn(e);return t?s/t*3:0}function gd(e){const{fnDarts:t=0,fnScored:s=0}=Zn(e);return t?s/t*3:0}const bx="ndn_game_mode_stats";function Im(e){let t={};try{const s=localStorage.getItem(bx);s&&(t=JSON.parse(s))}catch{}if(Array.isArray(e))for(const s of e)t[s]||(t[s]={played:0,won:0});return t}function Zb(e){try{localStorage.setItem(bx,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("ndn:stats-updated",{detail:{gameModes:!0}}))}catch{}}function e1(e,t){const s=Im(),r=s[e]||{played:0,won:0};r.played+=1,t&&(r.won+=1),s[e]=r,Zb(s)}function Ec(e){try{const t=localStorage.getItem(vx(e));if(!t)return[];const s=JSON.parse(t);return Array.isArray(s)?s.map(r=>({t:Number(r.t)||0,darts:Number(r.darts)||0,scored:Number(r.scored)||0,fnDarts:Number(r.fnDarts)||0,fnScored:Number(r.fnScored)||0})).filter(r=>r.t>0):[]}catch{return[]}}function t1(e,t){try{localStorage.setItem(vx(e),JSON.stringify(t)),window.dispatchEvent(new CustomEvent("ndn:stats-updated",{detail:{name:e}}))}catch{}}function n1(e,t){const s=Date.now();return e.filter(r=>s-r.t<=t)}function ia(e,t,s,r=Date.now(),a,l){if(t<=0)return;const i=Ec(e),o=n1([...i,{t:r,darts:t,scored:s,fnDarts:a,fnScored:l}],1e3*60*60*24*30);t1(e,o)}function s1(e,t=1e3*60*60*24){const s=Ec(e);if(!s.length)return 0;const r=Date.now();let a=0,l=0;for(const i of s)r-i.t<=t&&(a+=i.darts,l+=i.scored);return a<=0?0:l/a*3}function r1(e,t=1e3*60*60*24*30){const s=Ec(e);if(!s.length)return 0;const r=Date.now();let a=0,l=0;for(const i of s)r-i.t<=t&&(a+=i.fnDarts||0,l+=i.fnScored||0);return a<=0?0:l/a*3}function yd(e){const s=Ec(e);if(!s.length)return 0;const r=Date.now(),a=s.filter(u=>r-u.t<=2592e6),l=a.filter(u=>typeof u.fnDarts=="number"),i=l.length?l:a;let o=0,c=0;for(const u of i)o+=u.darts,c+=u.scored;return o<=0?0:c/o*3}function vd(e){return r1(e,2592e6)}const wx="ndn_user_settings";function ju(){try{const e=localStorage.getItem(wx);if(!e)return{favoriteDouble:"D16",callerEnabled:!0,callerVoice:"",callerVolume:1,speakCheckoutOnly:!1,avgMode:"all-time",autoStartOffline:!1,rememberLastOffline:!0,lastOffline:{mode:"X01",x01Start:501,firstTo:1,aiLevel:"None"},reducedMotion:!1,compactHeader:!1,allowSpectate:!0,cameraScale:1,cameraAspect:"wide",calibrationGuide:!0,preferredCameraId:void 0,preferredCameraLabel:void 0,cameraEnabled:!0,offlineLayout:"modern",autoscoreProvider:"built-in",autoscoreWsUrl:"",textSize:"medium",boxSize:"medium"};const t=JSON.parse(e);return{favoriteDouble:t.favoriteDouble||"D16",callerEnabled:typeof t.callerEnabled=="boolean"?t.callerEnabled:!0,callerVoice:t.callerVoice||"",callerVolume:typeof t.callerVolume=="number"?Math.max(0,Math.min(1,t.callerVolume)):1,speakCheckoutOnly:!!t.speakCheckoutOnly,avgMode:t.avgMode==="24h"?"24h":"all-time",autoStartOffline:!!t.autoStartOffline,rememberLastOffline:typeof t.rememberLastOffline=="boolean"?t.rememberLastOffline:!0,lastOffline:t.lastOffline&&typeof t.lastOffline=="object"?{mode:t.lastOffline.mode||"X01",x01Start:Number(t.lastOffline.x01Start)||501,firstTo:Number(t.lastOffline.firstTo)||1,aiLevel:t.lastOffline.aiLevel||"None"}:{mode:"X01",x01Start:501,firstTo:1,aiLevel:"None"},reducedMotion:!!t.reducedMotion,compactHeader:!!t.compactHeader,allowSpectate:typeof t.allowSpectate=="boolean"?t.allowSpectate:!0,cameraScale:typeof t.cameraScale=="number"&&isFinite(t.cameraScale)?Math.max(.5,Math.min(1.25,t.cameraScale)):1,cameraAspect:t.cameraAspect==="square"?"square":"wide",autoscoreProvider:t.autoscoreProvider==="external-ws"?"external-ws":t.autoscoreProvider==="manual"?"manual":"built-in",autoscoreWsUrl:typeof t.autoscoreWsUrl=="string"?t.autoscoreWsUrl:"",calibrationGuide:typeof t.calibrationGuide=="boolean"?t.calibrationGuide:!0,preferredCameraId:typeof t.preferredCameraId=="string"?t.preferredCameraId:void 0,preferredCameraLabel:typeof t.preferredCameraLabel=="string"?t.preferredCameraLabel:void 0,preferredCameraLocked:typeof t.preferredCameraLocked=="boolean"?t.preferredCameraLocked:!1,cameraEnabled:typeof t.cameraEnabled=="boolean"?t.cameraEnabled:!0,offlineLayout:t.offlineLayout==="classic"?"classic":"modern",textSize:t.textSize==="small"||t.textSize==="large"?t.textSize:"medium",boxSize:t.boxSize==="small"||t.boxSize==="large"?t.boxSize:"medium"}}catch{return{favoriteDouble:"D16",callerEnabled:!0,callerVoice:"",callerVolume:1,speakCheckoutOnly:!1,avgMode:"all-time",autoStartOffline:!1,rememberLastOffline:!0,lastOffline:{mode:"X01",x01Start:501,firstTo:1,aiLevel:"None"},reducedMotion:!1,compactHeader:!1,allowSpectate:!0,cameraScale:1,cameraAspect:"wide",calibrationGuide:!0,preferredCameraId:void 0,preferredCameraLabel:void 0,preferredCameraLocked:!1,cameraEnabled:!0,offlineLayout:"modern",autoscoreProvider:"built-in",autoscoreWsUrl:"",textSize:"medium",boxSize:"medium"}}}function Wt(e){try{const t=ju();localStorage.setItem(wx,JSON.stringify({...t,...e}))}catch{}}const ss=ya((e,t)=>({...ju(),setFavoriteDouble:s=>{Wt({favoriteDouble:s}),e({favoriteDouble:s})},setCallerEnabled:s=>{Wt({callerEnabled:s}),e({callerEnabled:s})},setCallerVoice:s=>{Wt({callerVoice:s}),e({callerVoice:s})},setAvgMode:s=>{Wt({avgMode:s}),e({avgMode:s})},setCallerVolume:s=>{const r=Math.max(0,Math.min(1,s));Wt({callerVolume:r}),e({callerVolume:r})},setSpeakCheckoutOnly:s=>{Wt({speakCheckoutOnly:s}),e({speakCheckoutOnly:s})},setAutoStartOffline:s=>{Wt({autoStartOffline:s}),e({autoStartOffline:s})},setRememberLastOffline:s=>{Wt({rememberLastOffline:s}),e({rememberLastOffline:s})},setLastOffline:s=>{const a={...ju().lastOffline,...s};Wt({lastOffline:a}),e({lastOffline:a})},setReducedMotion:s=>{Wt({reducedMotion:s}),e({reducedMotion:s})},setCompactHeader:s=>{Wt({compactHeader:s}),e({compactHeader:s})},setAllowSpectate:s=>{Wt({allowSpectate:s}),e({allowSpectate:s})},setCameraScale:s=>{const r=Math.max(.5,Math.min(1.25,s));Wt({cameraScale:r}),e({cameraScale:r})},setCameraAspect:s=>{const r=s==="square"?"square":"wide";Wt({cameraAspect:r}),e({cameraAspect:r})},setAutoscoreProvider:s=>{Wt({autoscoreProvider:s}),e({autoscoreProvider:s})},setAutoscoreWsUrl:s=>{Wt({autoscoreWsUrl:s}),e({autoscoreWsUrl:s})},setCalibrationGuide:s=>{Wt({calibrationGuide:s}),e({calibrationGuide:s})},setPreferredCamera:(s,r,a=!1)=>{try{if(t().preferredCameraLocked&&!a)return}catch{}Wt({preferredCameraId:s,preferredCameraLabel:r}),e({preferredCameraId:s,preferredCameraLabel:r})},setPreferredCameraLocked:s=>{Wt({preferredCameraLocked:s}),e({preferredCameraLocked:s})},setCameraEnabled:s=>{Wt({cameraEnabled:s}),e({cameraEnabled:s})},setOfflineLayout:s=>{Wt({offlineLayout:s}),e({offlineLayout:s})},setTextSize:s=>{Wt({textSize:s}),e({textSize:s})},setBoxSize:s=>{Wt({boxSize:s}),e({boxSize:s})}}));function fo(e){try{window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:e}}))}catch{}}const a1="http://localhost:8787";function l1({user:e}){const[t,s]=m.useState(!1),[r,a]=m.useState(!1),[l,i]=m.useState(""),{lastOffline:o}=ss(),c=xl();return m.useEffect(()=>{const u=["The fastest televised 9-darter took roughly 25 seconds!","A perfect leg (501) can be finished in nine darts.","The inner bull is worth 50; the outer bull is 25.","Standard dartboards are made from compressed sisal fibers.","Doubles and trebles are the thin outer and middle rings.","Professional oche (throw line) distance is 7 ft 9¼ in (2.37 m).","“Dartitis” is a real condition affecting a player’s throwing motion.","Phil Taylor holds a record number of World Championship titles.","Checkout routes often end on a double—classic “double-out”.","The highest 3-dart score is 180 (triple 20, triple 20, triple 20)."],d=Math.floor(Math.random()*u.length);i(u[d])},[]),n.jsxs("div",{className:`${e!=null&&e.fullAccess?"premium-main":""} relative min-h-[600px] flex flex-col items-center justify-center overflow-hidden`,children:[n.jsxs("div",{className:"absolute inset-0 z-0",children:[n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-700 via-indigo-500 to-blue-600 opacity-60 blur-2xl"}),n.jsx("div",{className:"absolute top-20 left-1/4 w-40 h-40 bg-pink-400 rounded-full opacity-30 blur-2xl animate-pulse"}),n.jsx("div",{className:"absolute bottom-10 right-1/4 w-32 h-32 bg-blue-400 rounded-full opacity-30 blur-2xl animate-pulse"})]}),n.jsxs("div",{className:"relative z-10 w-full max-w-6xl mx-auto bg-white/10 backdrop-blur-lg rounded-2xl sm:rounded-3xl shadow-2xl p-4 sm:p-6 md:p-8 lg:p-10 flex flex-col items-center",children:[n.jsx("h2",{className:"text-2xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 via-purple-400 to-blue-400 mb-2 sm:mb-3 md:mb-4 drop-shadow-xl text-center leading-tight",children:"Welcome to Nine Dart Nation"}),n.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl text-white/80 mb-2 font-semibold text-center px-2",children:"Your home for competitive darts, stats, and online play."}),n.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg text-white/60 mb-3 sm:mb-4 italic text-center px-2",children:'"Where every dart counts and every player matters."'}),l&&n.jsx("div",{className:"w-full mb-4 sm:mb-6 px-2 sm:px-0",children:n.jsxs("div",{className:"mx-auto max-w-xs sm:max-w-xl rounded-full px-3 sm:px-5 py-2 text-center text-indigo-100 bg-gradient-to-r from-indigo-600/80 to-fuchsia-600/80 shadow-md",children:[n.jsx("span",{className:"font-semibold text-sm sm:text-base",children:"Did you know?"})," ",n.jsx("span",{className:"opacity-90 text-sm sm:text-base",children:l})]})}),n.jsxs("div",{className:"flex flex-wrap gap-3 sm:gap-4 md:gap-6 justify-center mb-6 md:mb-8 w-full max-w-4xl mx-auto",children:[n.jsxs("button",{onClick:()=>{fo("offline");try{window.dispatchEvent(new CustomEvent("ndn:offline-format",{detail:{formatType:"first",formatCount:Number(o==null?void 0:o.firstTo)||1,startScore:Number(o==null?void 0:o.x01Start)||501}}))}catch{}try{setTimeout(()=>{window.dispatchEvent(new CustomEvent("ndn:auto-start",{detail:{mode:(o==null?void 0:o.mode)||"X01"}}))},50)}catch{}},className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:"🎯"})," Start New Match"]}),n.jsxs("button",{onClick:()=>fo("stats"),className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:"📊"})," View Stats"]}),n.jsxs("button",{onClick:()=>fo("online"),className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-green-500 to-blue-400 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:"🏆"})," Join Online League"]}),n.jsxs("button",{onClick:()=>{fo("offline");try{window.dispatchEvent(new CustomEvent("ndn:auto-start",{detail:{mode:"Double Practice"}}))}catch{}},className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-pink-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:"💡"})," Practice Doubles"]})]}),(()=>{const u=(e==null?void 0:e.username)||"Player 1",d=Zn(u),g=!!(e!=null&&e.fullAccess),x="grid grid-cols-[120px,1fr,1fr] sm:grid-cols-[160px,1fr,1fr]",y=({label:v,left:C,right:D,lock:b})=>n.jsxs("div",{className:`relative ${x} gap-2 items-center p-2 rounded-lg ${b?"bg-white/5 border border-white/10 overflow-hidden":"bg-indigo-500/10 border border-indigo-500/40"} mb-2`,children:[n.jsx("div",{className:"text-[12px] opacity-80 pl-2 text-left",children:v}),n.jsx("div",{className:`text-sm font-semibold text-center ${b?"opacity-50 blur-[0.5px]":""}`,children:C}),n.jsx("div",{className:`text-sm font-semibold text-center ${b?"opacity-50 blur-[0.5px]":""}`,children:D}),b&&n.jsx("button",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-slate-900/35 hover:bg-slate-900/45 transition",onClick:async()=>{try{const w=await(await fetch(`${a1}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})})).json();w.ok&&w.url?window.location.href=w.url:w.error==="STRIPE_NOT_CONFIGURED"?c("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):c("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{c("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},title:"Unlock with PREMIUM",children:n.jsx("span",{className:"text-[12px] font-semibold",children:"Unlock PREMIUM"})})]});return n.jsxs("div",{className:"w-full mt-2 rounded-2xl p-2 sm:p-3 bg-white/5 border border-white/10 overflow-x-auto",children:[n.jsxs("div",{className:`${x} gap-2 mb-2 px-1 items-center min-w-[280px] sm:min-w-0`,children:[n.jsx("div",{className:"text-[12px] opacity-0 select-none",children:"label"}),n.jsx("div",{className:"text-[12px] font-semibold text-center",children:"BEST"}),n.jsx("div",{className:"text-[12px] font-semibold text-center",children:"WORST"})]}),n.jsx(y,{label:"3-dart avg",left:jt(d.best3||0),right:jt(d.worst3||0)}),n.jsx(y,{label:"9-dart avg",left:jt(d.bestFNAvg||0),right:jt(d.worstFNAvg||0),lock:!g}),n.jsx(y,{label:"Leg (darts)",left:String(d.bestLegDarts||0),right:String(d.worstLegDarts||0),lock:!g}),n.jsx(y,{label:"Checkout",left:String(d.bestCheckout||0),right:"—",lock:!g})]})})(),n.jsx("button",{className:"mt-6 sm:mt-8 md:mt-10 px-6 sm:px-8 md:px-10 py-3 md:py-4 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 text-base sm:text-lg md:text-xl touch-manipulation",onClick:()=>a(!0),children:"How to Play / Getting Started"})]}),n.jsx("footer",{className:"w-full py-2 md:py-2 text-center text-white/80 text-xs md:text-sm font-medium absolute bottom-0 left-0 z-20 flex items-center justify-center gap-1 md:gap-2",children:n.jsxs("button",{className:"flex items-center gap-1 md:gap-2 hover:text-white transition",onClick:()=>s(!0),children:[n.jsx("span",{children:"©"}),n.jsx("span",{style:{letterSpacing:"0.05em"},children:"NINEDARTNATION"})]})}),t&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs("div",{className:"card max-w-lg w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>s(!1),children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2",children:"Legal Information"}),n.jsxs("ul",{className:"list-disc pl-5 mb-2",children:[n.jsx("li",{children:"Terms & Conditions: All users must follow fair play and site rules."}),n.jsx("li",{children:"Privacy Policy: Your data is protected and never shared without consent."}),n.jsxs("li",{children:["Copyright © ",new Date().getFullYear()," NINEDARTNATION. All rights reserved."]}),n.jsx("li",{children:"Contact: support@ninedartnation.com"})]}),n.jsx("p",{className:"text-sm text-purple-200",children:"For full legal details, please contact us or visit our legal page."})]})}),r&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs("div",{className:"card max-w-lg w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>a(!1),children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2",children:"Getting Started"}),n.jsxs("ul",{className:"list-disc pl-5 mb-2",children:[n.jsx("li",{children:"Choose a game mode and invite friends or play solo."}),n.jsx("li",{children:"Track your stats and progress in the Stats tab."}),n.jsx("li",{children:"Join the BullseyeDartsLeague for online competition."}),n.jsx("li",{children:"Upgrade to PREMIUM for advanced features and modes."}),n.jsx("li",{children:"Need help? Visit the Settings tab for support and tips."})]}),n.jsx("p",{className:"text-sm text-purple-200",children:'Ready to play? Hit "Start New Match" and let the darts fly!'})]})})]})}function Hs({children:e,className:t,style:s}){const r=m.useRef(null);return m.useEffect(()=>{let a=0;const l=()=>{const c=r.current;if(!c)return;const u=document.getElementById("ndn-header");if(!u){c.style.clipPath="";return}const d=document.getElementById("ndn-main-scroll"),g=d?d.scrollTop:window.scrollY||0,x=u.getBoundingClientRect().height,y=g>0?x:0;c.style.marginTop=y>0?`${y}px`:"0px"};l();const i=()=>{a&&cancelAnimationFrame(a),a=requestAnimationFrame(l)},o=document.getElementById("ndn-main-scroll");return o==null||o.addEventListener("scroll",i,{passive:!0}),window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",i),()=>{o==null||o.removeEventListener("scroll",i),window.removeEventListener("scroll",i),window.removeEventListener("resize",i),a&&cancelAnimationFrame(a)}},[]),n.jsx("div",{ref:r,className:t,style:s,children:e})}const i1=({calibrationComplete:e})=>{const[t,s]=m.useState(!1),[r,a]=m.useState(!1);return m.useEffect(()=>{e?(s(!0),setTimeout(()=>a(!0),1200)):(s(!1),a(!1))},[e]),n.jsxs("div",{className:`flex flex-col items-center justify-center w-full h-full transition-opacity duration-700 ${r?"opacity-0":"opacity-100"}`,style:{pointerEvents:"none",position:"absolute",inset:0,zIndex:10},children:[n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:`animate-spin-slow ${t?"opacity-0":"opacity-100"} transition-opacity duration-500`,style:{transition:"opacity 0.5s"},children:n.jsxs("g",{children:[n.jsx("rect",{x:"36",y:"10",width:"8",height:"40",rx:"3",fill:"#a78bfa"}),n.jsx("polygon",{points:"40,10 44,22 36,22",fill:"#f472b6"}),n.jsx("rect",{x:"36",y:"50",width:"8",height:"18",rx:"2",fill:"#22d3ee"}),n.jsx("polygon",{points:"36,68 44,68 40,78",fill:"#10b981"})]})}),t&&n.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:"absolute",style:{left:0,top:0},children:[n.jsx("circle",{cx:"40",cy:"40",r:"32",fill:"none",stroke:"#10b981",strokeWidth:"6"}),n.jsx("polyline",{points:"28,44 38,54 54,30",fill:"none",stroke:"#10b981",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round"})]})]}),n.jsx("div",{className:"mt-4 text-lg font-semibold text-indigo-200",children:t?"Calibration Complete!":"Initializing Camera..."})]})};var gl={},o1=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},jx={},is={};let Dm;const c1=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];is.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};is.getSymbolTotalCodewords=function(t){return c1[t]};is.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};is.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Dm=t};is.isKanjiModeEnabled=function(){return typeof Dm<"u"};is.toSJIS=function(t){return Dm(t)};var Tc={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+s)}}e.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},e.from=function(r,a){if(e.isValid(r))return r;try{return t(r)}catch{return a}}})(Tc);function Nx(){this.buffer=[],this.length=0}Nx.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let s=0;s<t;s++)this.putBit((e>>>t-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var d1=Nx;function Ai(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}Ai.prototype.set=function(e,t,s,r){const a=e*this.size+t;this.data[a]=s,r&&(this.reservedBit[a]=!0)};Ai.prototype.get=function(e,t){return this.data[e*this.size+t]};Ai.prototype.xor=function(e,t,s){this.data[e*this.size+t]^=s};Ai.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var u1=Ai,kx={};(function(e){const t=is.getSymbolSize;e.getRowColCoords=function(r){if(r===1)return[];const a=Math.floor(r/7)+2,l=t(r),i=l===145?26:Math.ceil((l-13)/(2*a-2))*2,o=[l-7];for(let c=1;c<a-1;c++)o[c]=o[c-1]-i;return o.push(6),o.reverse()},e.getPositions=function(r){const a=[],l=e.getRowColCoords(r),i=l.length;for(let o=0;o<i;o++)for(let c=0;c<i;c++)o===0&&c===0||o===0&&c===i-1||o===i-1&&c===0||a.push([l[o],l[c]]);return a}})(kx);var Sx={};const m1=is.getSymbolSize,Mh=7;Sx.getPositions=function(t){const s=m1(t);return[[0,0],[s-Mh,0],[0,s-Mh]]};var Cx={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},e.from=function(a){return e.isValid(a)?parseInt(a,10):void 0},e.getPenaltyN1=function(a){const l=a.size;let i=0,o=0,c=0,u=null,d=null;for(let g=0;g<l;g++){o=c=0,u=d=null;for(let x=0;x<l;x++){let y=a.get(g,x);y===u?o++:(o>=5&&(i+=t.N1+(o-5)),u=y,o=1),y=a.get(x,g),y===d?c++:(c>=5&&(i+=t.N1+(c-5)),d=y,c=1)}o>=5&&(i+=t.N1+(o-5)),c>=5&&(i+=t.N1+(c-5))}return i},e.getPenaltyN2=function(a){const l=a.size;let i=0;for(let o=0;o<l-1;o++)for(let c=0;c<l-1;c++){const u=a.get(o,c)+a.get(o,c+1)+a.get(o+1,c)+a.get(o+1,c+1);(u===4||u===0)&&i++}return i*t.N2},e.getPenaltyN3=function(a){const l=a.size;let i=0,o=0,c=0;for(let u=0;u<l;u++){o=c=0;for(let d=0;d<l;d++)o=o<<1&2047|a.get(u,d),d>=10&&(o===1488||o===93)&&i++,c=c<<1&2047|a.get(d,u),d>=10&&(c===1488||c===93)&&i++}return i*t.N3},e.getPenaltyN4=function(a){let l=0;const i=a.data.length;for(let c=0;c<i;c++)l+=a.data[c];return Math.abs(Math.ceil(l*100/i/5)-10)*t.N4};function s(r,a,l){switch(r){case e.Patterns.PATTERN000:return(a+l)%2===0;case e.Patterns.PATTERN001:return a%2===0;case e.Patterns.PATTERN010:return l%3===0;case e.Patterns.PATTERN011:return(a+l)%3===0;case e.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(l/3))%2===0;case e.Patterns.PATTERN101:return a*l%2+a*l%3===0;case e.Patterns.PATTERN110:return(a*l%2+a*l%3)%2===0;case e.Patterns.PATTERN111:return(a*l%3+(a+l)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}e.applyMask=function(a,l){const i=l.size;for(let o=0;o<i;o++)for(let c=0;c<i;c++)l.isReserved(c,o)||l.xor(c,o,s(a,c,o))},e.getBestMask=function(a,l){const i=Object.keys(e.Patterns).length;let o=0,c=1/0;for(let u=0;u<i;u++){l(u),e.applyMask(u,a);const d=e.getPenaltyN1(a)+e.getPenaltyN2(a)+e.getPenaltyN3(a)+e.getPenaltyN4(a);e.applyMask(u,a),d<c&&(c=d,o=u)}return o}})(Cx);var Mc={};const Pr=Tc,ho=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],po=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Mc.getBlocksCount=function(t,s){switch(s){case Pr.L:return ho[(t-1)*4+0];case Pr.M:return ho[(t-1)*4+1];case Pr.Q:return ho[(t-1)*4+2];case Pr.H:return ho[(t-1)*4+3];default:return}};Mc.getTotalCodewordsCount=function(t,s){switch(s){case Pr.L:return po[(t-1)*4+0];case Pr.M:return po[(t-1)*4+1];case Pr.Q:return po[(t-1)*4+2];case Pr.H:return po[(t-1)*4+3];default:return}};var Ex={},Ic={};const ni=new Uint8Array(512),rc=new Uint8Array(256);(function(){let t=1;for(let s=0;s<255;s++)ni[s]=t,rc[t]=s,t<<=1,t&256&&(t^=285);for(let s=255;s<512;s++)ni[s]=ni[s-255]})();Ic.log=function(t){if(t<1)throw new Error("log("+t+")");return rc[t]};Ic.exp=function(t){return ni[t]};Ic.mul=function(t,s){return t===0||s===0?0:ni[rc[t]+rc[s]]};(function(e){const t=Ic;e.mul=function(r,a){const l=new Uint8Array(r.length+a.length-1);for(let i=0;i<r.length;i++)for(let o=0;o<a.length;o++)l[i+o]^=t.mul(r[i],a[o]);return l},e.mod=function(r,a){let l=new Uint8Array(r);for(;l.length-a.length>=0;){const i=l[0];for(let c=0;c<a.length;c++)l[c]^=t.mul(a[c],i);let o=0;for(;o<l.length&&l[o]===0;)o++;l=l.slice(o)}return l},e.generateECPolynomial=function(r){let a=new Uint8Array([1]);for(let l=0;l<r;l++)a=e.mul(a,new Uint8Array([1,t.exp(l)]));return a}})(Ex);const Tx=Ex;function Pm(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Pm.prototype.initialize=function(t){this.degree=t,this.genPoly=Tx.generateECPolynomial(this.degree)};Pm.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(t.length+this.degree);s.set(t);const r=Tx.mod(s,this.genPoly),a=this.degree-r.length;if(a>0){const l=new Uint8Array(this.degree);return l.set(r,a),l}return r};var f1=Pm,Mx={},Kr={},Lm={};Lm.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var Js={};const Ix="[0-9]+",h1="[A-Z $%*+\\-./:]+";let Ci="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ci=Ci.replace(/u/g,"\\u");const p1="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ci+`)(?:.|[\r
]))+`;Js.KANJI=new RegExp(Ci,"g");Js.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Js.BYTE=new RegExp(p1,"g");Js.NUMERIC=new RegExp(Ix,"g");Js.ALPHANUMERIC=new RegExp(h1,"g");const x1=new RegExp("^"+Ci+"$"),g1=new RegExp("^"+Ix+"$"),y1=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Js.testKanji=function(t){return x1.test(t)};Js.testNumeric=function(t){return g1.test(t)};Js.testAlphanumeric=function(t){return y1.test(t)};(function(e){const t=Lm,s=Js;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(l,i){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?l.ccBits[0]:i<27?l.ccBits[1]:l.ccBits[2]},e.getBestModeForData=function(l){return s.testNumeric(l)?e.NUMERIC:s.testAlphanumeric(l)?e.ALPHANUMERIC:s.testKanji(l)?e.KANJI:e.BYTE},e.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},e.isValid=function(l){return l&&l.bit&&l.ccBits};function r(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+a)}}e.from=function(l,i){if(e.isValid(l))return l;try{return r(l)}catch{return i}}})(Kr);(function(e){const t=is,s=Mc,r=Tc,a=Kr,l=Lm,i=7973,o=t.getBCHDigit(i);function c(x,y,v){for(let C=1;C<=40;C++)if(y<=e.getCapacity(C,v,x))return C}function u(x,y){return a.getCharCountIndicator(x,y)+4}function d(x,y){let v=0;return x.forEach(function(C){const D=u(C.mode,y);v+=D+C.getBitsLength()}),v}function g(x,y){for(let v=1;v<=40;v++)if(d(x,v)<=e.getCapacity(v,y,a.MIXED))return v}e.from=function(y,v){return l.isValid(y)?parseInt(y,10):v},e.getCapacity=function(y,v,C){if(!l.isValid(y))throw new Error("Invalid QR Code version");typeof C>"u"&&(C=a.BYTE);const D=t.getSymbolTotalCodewords(y),b=s.getTotalCodewordsCount(y,v),h=(D-b)*8;if(C===a.MIXED)return h;const w=h-u(C,y);switch(C){case a.NUMERIC:return Math.floor(w/10*3);case a.ALPHANUMERIC:return Math.floor(w/11*2);case a.KANJI:return Math.floor(w/13);case a.BYTE:default:return Math.floor(w/8)}},e.getBestVersionForData=function(y,v){let C;const D=r.from(v,r.M);if(Array.isArray(y)){if(y.length>1)return g(y,D);if(y.length===0)return 1;C=y[0]}else C=y;return c(C.mode,C.getLength(),D)},e.getEncodedBits=function(y){if(!l.isValid(y)||y<7)throw new Error("Invalid QR Code version");let v=y<<12;for(;t.getBCHDigit(v)-o>=0;)v^=i<<t.getBCHDigit(v)-o;return y<<12|v}})(Mx);var Dx={};const Nu=is,Px=1335,v1=21522,Ih=Nu.getBCHDigit(Px);Dx.getEncodedBits=function(t,s){const r=t.bit<<3|s;let a=r<<10;for(;Nu.getBCHDigit(a)-Ih>=0;)a^=Px<<Nu.getBCHDigit(a)-Ih;return(r<<10|a)^v1};var Lx={};const b1=Kr;function ol(e){this.mode=b1.NUMERIC,this.data=e.toString()}ol.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};ol.prototype.getLength=function(){return this.data.length};ol.prototype.getBitsLength=function(){return ol.getBitsLength(this.data.length)};ol.prototype.write=function(t){let s,r,a;for(s=0;s+3<=this.data.length;s+=3)r=this.data.substr(s,3),a=parseInt(r,10),t.put(a,10);const l=this.data.length-s;l>0&&(r=this.data.substr(s),a=parseInt(r,10),t.put(a,l*3+1))};var w1=ol;const j1=Kr,bd=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function cl(e){this.mode=j1.ALPHANUMERIC,this.data=e}cl.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};cl.prototype.getLength=function(){return this.data.length};cl.prototype.getBitsLength=function(){return cl.getBitsLength(this.data.length)};cl.prototype.write=function(t){let s;for(s=0;s+2<=this.data.length;s+=2){let r=bd.indexOf(this.data[s])*45;r+=bd.indexOf(this.data[s+1]),t.put(r,11)}this.data.length%2&&t.put(bd.indexOf(this.data[s]),6)};var N1=cl;const k1=Kr;function dl(e){this.mode=k1.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}dl.getBitsLength=function(t){return t*8};dl.prototype.getLength=function(){return this.data.length};dl.prototype.getBitsLength=function(){return dl.getBitsLength(this.data.length)};dl.prototype.write=function(e){for(let t=0,s=this.data.length;t<s;t++)e.put(this.data[t],8)};var S1=dl;const C1=Kr,E1=is;function ul(e){this.mode=C1.KANJI,this.data=e}ul.getBitsLength=function(t){return t*13};ul.prototype.getLength=function(){return this.data.length};ul.prototype.getBitsLength=function(){return ul.getBitsLength(this.data.length)};ul.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let s=E1.toSJIS(this.data[t]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),e.put(s,13)}};var T1=ul,Ax={exports:{}};(function(e){var t={single_source_shortest_paths:function(s,r,a){var l={},i={};i[r]=0;var o=t.PriorityQueue.make();o.push(r,0);for(var c,u,d,g,x,y,v,C,D;!o.empty();){c=o.pop(),u=c.value,g=c.cost,x=s[u]||{};for(d in x)x.hasOwnProperty(d)&&(y=x[d],v=g+y,C=i[d],D=typeof i[d]>"u",(D||C>v)&&(i[d]=v,o.push(d,v),l[d]=u))}if(typeof a<"u"&&typeof i[a]>"u"){var b=["Could not find a path from ",r," to ",a,"."].join("");throw new Error(b)}return l},extract_shortest_path_from_predecessor_list:function(s,r){for(var a=[],l=r;l;)a.push(l),s[l],l=s[l];return a.reverse(),a},find_path:function(s,r,a){var l=t.single_source_shortest_paths(s,r,a);return t.extract_shortest_path_from_predecessor_list(l,a)},PriorityQueue:{make:function(s){var r=t.PriorityQueue,a={},l;s=s||{};for(l in r)r.hasOwnProperty(l)&&(a[l]=r[l]);return a.queue=[],a.sorter=s.sorter||r.default_sorter,a},default_sorter:function(s,r){return s.cost-r.cost},push:function(s,r){var a={value:s,cost:r};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Ax);var M1=Ax.exports;(function(e){const t=Kr,s=w1,r=N1,a=S1,l=T1,i=Js,o=is,c=M1;function u(b){return unescape(encodeURIComponent(b)).length}function d(b,h,w){const E=[];let p;for(;(p=b.exec(w))!==null;)E.push({data:p[0],index:p.index,mode:h,length:p[0].length});return E}function g(b){const h=d(i.NUMERIC,t.NUMERIC,b),w=d(i.ALPHANUMERIC,t.ALPHANUMERIC,b);let E,p;return o.isKanjiModeEnabled()?(E=d(i.BYTE,t.BYTE,b),p=d(i.KANJI,t.KANJI,b)):(E=d(i.BYTE_KANJI,t.BYTE,b),p=[]),h.concat(w,E,p).sort(function(P,N){return P.index-N.index}).map(function(P){return{data:P.data,mode:P.mode,length:P.length}})}function x(b,h){switch(h){case t.NUMERIC:return s.getBitsLength(b);case t.ALPHANUMERIC:return r.getBitsLength(b);case t.KANJI:return l.getBitsLength(b);case t.BYTE:return a.getBitsLength(b)}}function y(b){return b.reduce(function(h,w){const E=h.length-1>=0?h[h.length-1]:null;return E&&E.mode===w.mode?(h[h.length-1].data+=w.data,h):(h.push(w),h)},[])}function v(b){const h=[];for(let w=0;w<b.length;w++){const E=b[w];switch(E.mode){case t.NUMERIC:h.push([E,{data:E.data,mode:t.ALPHANUMERIC,length:E.length},{data:E.data,mode:t.BYTE,length:E.length}]);break;case t.ALPHANUMERIC:h.push([E,{data:E.data,mode:t.BYTE,length:E.length}]);break;case t.KANJI:h.push([E,{data:E.data,mode:t.BYTE,length:u(E.data)}]);break;case t.BYTE:h.push([{data:E.data,mode:t.BYTE,length:u(E.data)}])}}return h}function C(b,h){const w={},E={start:{}};let p=["start"];for(let S=0;S<b.length;S++){const P=b[S],N=[];for(let q=0;q<P.length;q++){const G=P[q],_=""+S+q;N.push(_),w[_]={node:G,lastCount:0},E[_]={};for(let te=0;te<p.length;te++){const L=p[te];w[L]&&w[L].node.mode===G.mode?(E[L][_]=x(w[L].lastCount+G.length,G.mode)-x(w[L].lastCount,G.mode),w[L].lastCount+=G.length):(w[L]&&(w[L].lastCount=G.length),E[L][_]=x(G.length,G.mode)+4+t.getCharCountIndicator(G.mode,h))}}p=N}for(let S=0;S<p.length;S++)E[p[S]].end=0;return{map:E,table:w}}function D(b,h){let w;const E=t.getBestModeForData(b);if(w=t.from(h,E),w!==t.BYTE&&w.bit<E.bit)throw new Error('"'+b+'" cannot be encoded with mode '+t.toString(w)+`.
 Suggested mode is: `+t.toString(E));switch(w===t.KANJI&&!o.isKanjiModeEnabled()&&(w=t.BYTE),w){case t.NUMERIC:return new s(b);case t.ALPHANUMERIC:return new r(b);case t.KANJI:return new l(b);case t.BYTE:return new a(b)}}e.fromArray=function(h){return h.reduce(function(w,E){return typeof E=="string"?w.push(D(E,null)):E.data&&w.push(D(E.data,E.mode)),w},[])},e.fromString=function(h,w){const E=g(h,o.isKanjiModeEnabled()),p=v(E),S=C(p,w),P=c.find_path(S.map,"start","end"),N=[];for(let q=1;q<P.length-1;q++)N.push(S.table[P[q]].node);return e.fromArray(y(N))},e.rawSplit=function(h){return e.fromArray(g(h,o.isKanjiModeEnabled()))}})(Lx);const Dc=is,wd=Tc,I1=d1,D1=u1,P1=kx,L1=Sx,ku=Cx,Su=Mc,A1=f1,ac=Mx,R1=Dx,O1=Kr,jd=Lx;function _1(e,t){const s=e.size,r=L1.getPositions(t);for(let a=0;a<r.length;a++){const l=r[a][0],i=r[a][1];for(let o=-1;o<=7;o++)if(!(l+o<=-1||s<=l+o))for(let c=-1;c<=7;c++)i+c<=-1||s<=i+c||(o>=0&&o<=6&&(c===0||c===6)||c>=0&&c<=6&&(o===0||o===6)||o>=2&&o<=4&&c>=2&&c<=4?e.set(l+o,i+c,!0,!0):e.set(l+o,i+c,!1,!0))}}function U1(e){const t=e.size;for(let s=8;s<t-8;s++){const r=s%2===0;e.set(s,6,r,!0),e.set(6,s,r,!0)}}function B1(e,t){const s=P1.getPositions(t);for(let r=0;r<s.length;r++){const a=s[r][0],l=s[r][1];for(let i=-2;i<=2;i++)for(let o=-2;o<=2;o++)i===-2||i===2||o===-2||o===2||i===0&&o===0?e.set(a+i,l+o,!0,!0):e.set(a+i,l+o,!1,!0)}}function $1(e,t){const s=e.size,r=ac.getEncodedBits(t);let a,l,i;for(let o=0;o<18;o++)a=Math.floor(o/3),l=o%3+s-8-3,i=(r>>o&1)===1,e.set(a,l,i,!0),e.set(l,a,i,!0)}function Nd(e,t,s){const r=e.size,a=R1.getEncodedBits(t,s);let l,i;for(l=0;l<15;l++)i=(a>>l&1)===1,l<6?e.set(l,8,i,!0):l<8?e.set(l+1,8,i,!0):e.set(r-15+l,8,i,!0),l<8?e.set(8,r-l-1,i,!0):l<9?e.set(8,15-l-1+1,i,!0):e.set(8,15-l-1,i,!0);e.set(r-8,8,1,!0)}function F1(e,t){const s=e.size;let r=-1,a=s-1,l=7,i=0;for(let o=s-1;o>0;o-=2)for(o===6&&o--;;){for(let c=0;c<2;c++)if(!e.isReserved(a,o-c)){let u=!1;i<t.length&&(u=(t[i]>>>l&1)===1),e.set(a,o-c,u),l--,l===-1&&(i++,l=7)}if(a+=r,a<0||s<=a){a-=r,r=-r;break}}}function z1(e,t,s){const r=new I1;s.forEach(function(c){r.put(c.mode.bit,4),r.put(c.getLength(),O1.getCharCountIndicator(c.mode,e)),c.write(r)});const a=Dc.getSymbolTotalCodewords(e),l=Su.getTotalCodewordsCount(e,t),i=(a-l)*8;for(r.getLengthInBits()+4<=i&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const o=(i-r.getLengthInBits())/8;for(let c=0;c<o;c++)r.put(c%2?17:236,8);return H1(r,e,t)}function H1(e,t,s){const r=Dc.getSymbolTotalCodewords(t),a=Su.getTotalCodewordsCount(t,s),l=r-a,i=Su.getBlocksCount(t,s),o=r%i,c=i-o,u=Math.floor(r/i),d=Math.floor(l/i),g=d+1,x=u-d,y=new A1(x);let v=0;const C=new Array(i),D=new Array(i);let b=0;const h=new Uint8Array(e.buffer);for(let P=0;P<i;P++){const N=P<c?d:g;C[P]=h.slice(v,v+N),D[P]=y.encode(C[P]),v+=N,b=Math.max(b,N)}const w=new Uint8Array(r);let E=0,p,S;for(p=0;p<b;p++)for(S=0;S<i;S++)p<C[S].length&&(w[E++]=C[S][p]);for(p=0;p<x;p++)for(S=0;S<i;S++)w[E++]=D[S][p];return w}function W1(e,t,s,r){let a;if(Array.isArray(e))a=jd.fromArray(e);else if(typeof e=="string"){let u=t;if(!u){const d=jd.rawSplit(e);u=ac.getBestVersionForData(d,s)}a=jd.fromString(e,u||40)}else throw new Error("Invalid data");const l=ac.getBestVersionForData(a,s);if(!l)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=l;else if(t<l)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+l+`.
`);const i=z1(t,s,a),o=Dc.getSymbolSize(t),c=new D1(o);return _1(c,t),U1(c),B1(c,t),Nd(c,s,0),t>=7&&$1(c,t),F1(c,i),isNaN(r)&&(r=ku.getBestMask(c,Nd.bind(null,c,s))),ku.applyMask(r,c),Nd(c,s,r),{modules:c,version:t,errorCorrectionLevel:s,maskPattern:r,segments:a}}jx.create=function(t,s){if(typeof t>"u"||t==="")throw new Error("No input text");let r=wd.M,a,l;return typeof s<"u"&&(r=wd.from(s.errorCorrectionLevel,wd.M),a=ac.from(s.version),l=ku.from(s.maskPattern),s.toSJISFunc&&Dc.setToSJISFunction(s.toSJISFunc)),W1(t,a,r,l)};var Rx={},Am={};(function(e){function t(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let r=s.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+s);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(l){return[l,l]}))),r.length===6&&r.push("F","F");const a=parseInt(r.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+r.slice(0,6).join("")}}e.getOptions=function(r){r||(r={}),r.color||(r.color={});const a=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,l=r.width&&r.width>=21?r.width:void 0,i=r.scale||4;return{width:l,scale:l?4:i,margin:a,color:{dark:t(r.color.dark||"#000000ff"),light:t(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},e.getScale=function(r,a){return a.width&&a.width>=r+a.margin*2?a.width/(r+a.margin*2):a.scale},e.getImageWidth=function(r,a){const l=e.getScale(r,a);return Math.floor((r+a.margin*2)*l)},e.qrToImageData=function(r,a,l){const i=a.modules.size,o=a.modules.data,c=e.getScale(i,l),u=Math.floor((i+l.margin*2)*c),d=l.margin*c,g=[l.color.light,l.color.dark];for(let x=0;x<u;x++)for(let y=0;y<u;y++){let v=(x*u+y)*4,C=l.color.light;if(x>=d&&y>=d&&x<u-d&&y<u-d){const D=Math.floor((x-d)/c),b=Math.floor((y-d)/c);C=g[o[D*i+b]?1:0]}r[v++]=C.r,r[v++]=C.g,r[v++]=C.b,r[v]=C.a}}})(Am);(function(e){const t=Am;function s(a,l,i){a.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=i,l.width=i,l.style.height=i+"px",l.style.width=i+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(l,i,o){let c=o,u=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(u=r()),c=t.getOptions(c);const d=t.getImageWidth(l.modules.size,c),g=u.getContext("2d"),x=g.createImageData(d,d);return t.qrToImageData(x.data,l,c),s(g,u,d),g.putImageData(x,0,0),u},e.renderToDataURL=function(l,i,o){let c=o;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const u=e.render(l,i,c),d=c.type||"image/png",g=c.rendererOpts||{};return u.toDataURL(d,g.quality)}})(Rx);var Ox={};const V1=Am;function Dh(e,t){const s=e.a/255,r=t+'="'+e.hex+'"';return s<1?r+" "+t+'-opacity="'+s.toFixed(2).slice(1)+'"':r}function kd(e,t,s){let r=e+t;return typeof s<"u"&&(r+=" "+s),r}function G1(e,t,s){let r="",a=0,l=!1,i=0;for(let o=0;o<e.length;o++){const c=Math.floor(o%t),u=Math.floor(o/t);!c&&!l&&(l=!0),e[o]?(i++,o>0&&c>0&&e[o-1]||(r+=l?kd("M",c+s,.5+u+s):kd("m",a,0),a=0,l=!1),c+1<t&&e[o+1]||(r+=kd("h",i),i=0)):a++}return r}Ox.render=function(t,s,r){const a=V1.getOptions(s),l=t.modules.size,i=t.modules.data,o=l+a.margin*2,c=a.color.light.a?"<path "+Dh(a.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",u="<path "+Dh(a.color.dark,"stroke")+' d="'+G1(i,l,a.margin)+'"/>',d='viewBox="0 0 '+o+" "+o+'"',x='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+d+' shape-rendering="crispEdges">'+c+u+`</svg>
`;return typeof r=="function"&&r(null,x),x};const K1=o1,Cu=jx,_x=Rx,J1=Ox;function Rm(e,t,s,r,a){const l=[].slice.call(arguments,1),i=l.length,o=typeof l[i-1]=="function";if(!o&&!K1())throw new Error("Callback required as last argument");if(o){if(i<2)throw new Error("Too few arguments provided");i===2?(a=s,s=t,t=r=void 0):i===3&&(t.getContext&&typeof a>"u"?(a=r,r=void 0):(a=r,r=s,s=t,t=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(s=t,t=r=void 0):i===2&&!t.getContext&&(r=s,s=t,t=void 0),new Promise(function(c,u){try{const d=Cu.create(s,r);c(e(d,t,r))}catch(d){u(d)}})}try{const c=Cu.create(s,r);a(null,e(c,t,r))}catch(c){a(c)}}gl.create=Cu.create;gl.toCanvas=Rm.bind(null,_x.render);gl.toDataURL=Rm.bind(null,_x.renderToDataURL);gl.toString=Rm.bind(null,function(e,t,s){return J1.render(e,s)});const q1={};function Ux(e,t){let s;try{s=e()}catch{return}return{getItem:a=>{var l;const i=c=>c===null?null:JSON.parse(c,void 0),o=(l=s.getItem(a))!=null?l:null;return o instanceof Promise?o.then(i):i(o)},setItem:(a,l)=>s.setItem(a,JSON.stringify(l,void 0)),removeItem:a=>s.removeItem(a)}}const Ei=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(r){return Ei(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return Ei(r)(s)}}}},Y1=(e,t)=>(s,r,a)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:D=>D,version:0,merge:(D,b)=>({...b,...D}),...t},i=!1;const o=new Set,c=new Set;let u;try{u=l.getStorage()}catch{}if(!u)return e((...D)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),s(...D)},r,a);const d=Ei(l.serialize),g=()=>{const D=l.partialize({...r()});let b;const h=d({state:D,version:l.version}).then(w=>u.setItem(l.name,w)).catch(w=>{b=w});if(b)throw b;return h},x=a.setState;a.setState=(D,b)=>{x(D,b),g()};const y=e((...D)=>{s(...D),g()},r,a);let v;const C=()=>{var D;if(!u)return;i=!1,o.forEach(h=>h(r()));const b=((D=l.onRehydrateStorage)==null?void 0:D.call(l,r()))||void 0;return Ei(u.getItem.bind(u))(l.name).then(h=>{if(h)return l.deserialize(h)}).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==l.version){if(l.migrate)return l.migrate(h.state,h.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return h.state}).then(h=>{var w;return v=l.merge(h,(w=r())!=null?w:y),s(v,!0),g()}).then(()=>{b==null||b(v,void 0),i=!0,c.forEach(h=>h(v))}).catch(h=>{b==null||b(void 0,h)})};return a.persist={setOptions:D=>{l={...l,...D},D.getStorage&&(u=D.getStorage())},clearStorage:()=>{u==null||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>C(),hasHydrated:()=>i,onHydrate:D=>(o.add(D),()=>{o.delete(D)}),onFinishHydration:D=>(c.add(D),()=>{c.delete(D)})},C(),v||y},X1=(e,t)=>(s,r,a)=>{let l={storage:Ux(()=>localStorage),partialize:C=>C,version:0,merge:(C,D)=>({...D,...C}),...t},i=!1;const o=new Set,c=new Set;let u=l.storage;if(!u)return e((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),s(...C)},r,a);const d=()=>{const C=l.partialize({...r()});return u.setItem(l.name,{state:C,version:l.version})},g=a.setState;a.setState=(C,D)=>{g(C,D),d()};const x=e((...C)=>{s(...C),d()},r,a);a.getInitialState=()=>x;let y;const v=()=>{var C,D;if(!u)return;i=!1,o.forEach(h=>{var w;return h((w=r())!=null?w:x)});const b=((D=l.onRehydrateStorage)==null?void 0:D.call(l,(C=r())!=null?C:x))||void 0;return Ei(u.getItem.bind(u))(l.name).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==l.version){if(l.migrate)return[!0,l.migrate(h.state,h.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,h.state];return[!1,void 0]}).then(h=>{var w;const[E,p]=h;if(y=l.merge(p,(w=r())!=null?w:x),s(y,!0),E)return d()}).then(()=>{b==null||b(y,void 0),y=r(),i=!0,c.forEach(h=>h(y))}).catch(h=>{b==null||b(void 0,h)})};return a.persist={setOptions:C=>{l={...l,...C},C.storage&&(u=C.storage)},clearStorage:()=>{u==null||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>v(),hasHydrated:()=>i,onHydrate:C=>(o.add(C),()=>{o.delete(C)}),onFinishHydration:C=>(c.add(C),()=>{c.delete(C)})},l.skipHydration||v(),y||x},Q1=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((q1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Y1(e,t)):X1(e,t),Z1=Q1,Om=ya()(Z1((e,t)=>({H:null,createdAt:null,errorPx:null,imageSize:null,anchors:null,locked:!1,setCalibration:s=>e(r=>({...r,...s})),reset:()=>e({H:null,createdAt:null,errorPx:null,imageSize:null,anchors:null,locked:!1})}),{name:"ndn-calibration-v1",storage:Ux(()=>localStorage),onRehydrateStorage:()=>(e,t)=>{if(!t)try{if(e&&!e.H){const s=localStorage.getItem("ndn:calibration:v1");if(s){const r=JSON.parse(s);r&&(r.H||r.imageSize)&&e.setCalibration({H:r.H??null,createdAt:r.createdAt??null,errorPx:r.errorPx??null,imageSize:r.imageSize??null,anchors:r.anchors??null,locked:!!r.locked})}}}catch{}}})),Ge={bullInner:6.35,bullOuter:15.9,trebleInner:99,trebleOuter:107,doubleInner:162,doubleOuter:170},ew=[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5];function _m(e,t){const s=t.x,r=t.y,a=e[6]*s+e[7]*r+e[8],l=(e[0]*s+e[1]*r+e[2])/a,i=(e[3]*s+e[4]*r+e[5])/a;return{x:l,y:i}}function tw(e,t,s){return[t*e[0],t*e[1],t*e[2],s*e[3],s*e[4],s*e[5],e[6],e[7],e[8]]}function nw(e){const t=e,s=t[0],r=t[1],a=t[2],l=t[3],i=t[4],o=t[5],c=t[6],u=t[7],d=t[8],g=i*d-o*u,x=a*u-r*d,y=r*o-a*i,v=o*c-l*d,C=s*d-a*c,D=a*l-s*o,b=l*u-i*c,h=r*c-s*u,w=s*i-r*l,E=s*g+r*v+a*b;if(Math.abs(E)<1e-12)throw new Error("Singular homography");return[g/E,x/E,y/E,v/E,C/E,D/E,b/E,h/E,w/E]}function Bx(e,t){if(e.length!==4||t.length!==4)throw new Error("Need exactly 4 correspondences");const s=[],r=[];for(let i=0;i<4;i++){const{x:o,y:c}=e[i],{x:u,y:d}=t[i];s.push([o,c,1,0,0,0,-u*o,-u*c]),r.push(u),s.push([0,0,0,o,c,1,-d*o,-d*c]),r.push(d)}const a=sw(s,r);return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],1]}function sw(e,t){const s=e.length,r=e[0].length,a=Array.from({length:r},()=>new Array(r).fill(0)),l=new Array(r).fill(0);for(let i=0;i<s;i++)for(let o=0;o<r;o++){l[o]+=e[i][o]*t[i];for(let c=0;c<r;c++)a[o][c]+=e[i][o]*e[i][c]}return rw(a,l)}function rw(e,t){const s=t.length,r=e.map((l,i)=>l.concat([t[i]]));for(let l=0;l<s;l++){let i=l;for(let o=l+1;o<s;o++)Math.abs(r[o][l])>Math.abs(r[i][l])&&(i=o);if(Math.abs(r[i][l])<1e-12)throw new Error("Singular matrix");if(i!==l){const o=r[l];r[l]=r[i],r[i]=o}for(let o=l+1;o<s;o++){const c=r[o][l]/r[l][l];for(let u=l;u<=s;u++)r[o][u]-=c*r[l][u]}}const a=new Array(s).fill(0);for(let l=s-1;l>=0;l--){let i=r[l][s];for(let o=l+1;o<s;o++)i-=r[l][o]*a[o];a[l]=i/r[l][l]}return a}function Eu(){const e=Ge.doubleOuter;return[{x:0,y:-e},{x:e,y:0},{x:0,y:e},{x:-e,y:0}]}function $x(e,t,s=256){const r=[];for(let a=0;a<s;a++){const l=a/s*Math.PI*2,i=_m(e,{x:t*Math.cos(l),y:t*Math.sin(l)});r.push(i)}return r}function Fx(e,t,s){let r=0;for(let a=0;a<t.length;a++){const l=_m(e,t[a]),i=l.x-s[a].x,o=l.y-s[a].y;r+=i*i+o*o}return Math.sqrt(r/t.length)}function aw(e,t){const s=nw(e);return _m(s,t)}function lw(e){const t=Math.hypot(e.x,e.y);let r=Math.atan2(e.y,e.x)*180/Math.PI;r=(r+360+90)%360;const a=ew[Math.floor((360-r)%360/18)];return t<=Ge.bullInner?{base:50,ring:"INNER_BULL",sector:25,mult:2}:t<=Ge.bullOuter?{base:25,ring:"BULL",sector:25,mult:1}:t>=Ge.doubleOuter?{base:0,ring:"MISS",sector:null,mult:0}:t>=Ge.doubleInner?{base:a*2,ring:"DOUBLE",sector:a,mult:2}:t>=Ge.trebleOuter?{base:a,ring:"SINGLE",sector:a,mult:1}:t>=Ge.trebleInner?{base:a*3,ring:"TRIPLE",sector:a,mult:3}:{base:a,ring:"SINGLE",sector:a,mult:1}}function zx(e,t,s="#10b981",r=2){if(t.length){e.save(),e.strokeStyle=s,e.lineWidth=r,e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let a=1;a<t.length;a++)e.lineTo(t[a].x,t[a].y);e.closePath(),e.stroke(),e.restore()}}function iw(e,t,s="#f59e0b"){e.save(),e.strokeStyle=s,e.lineWidth=2,e.beginPath(),e.moveTo(t.x-8,t.y),e.lineTo(t.x+8,t.y),e.moveTo(t.x,t.y-8),e.lineTo(t.x,t.y+8),e.stroke(),e.restore()}function lc(e,t,s){return Math.max(t,Math.min(s,e))}function ow(e,t,s){const{width:r,data:a}=e,l=[[-1,0,1],[-2,0,2],[-1,0,1]],i=[[-1,-2,-1],[0,0,0],[1,2,1]];let o=0,c=0;for(let u=-1;u<=1;u++)for(let d=-1;d<=1;d++){const g=lc(t+d,0,r-1),y=(lc(s+u,0,e.height-1)*r+g)*4,v=a[y],C=a[y+1],D=a[y+2],b=.299*v+.587*C+.114*D;o+=b*l[u+1][d+1],c+=b*i[u+1][d+1]}return Math.hypot(o,c)}function cw(e,t,s=6){const a=e.getContext("2d").getImageData(0,0,e.width,e.height),l=lc(Math.round(t.x),1,e.width-2),i=lc(Math.round(t.y),1,e.height-2);let o={x:l,y:i,mag:-1};for(let c=i-s;c<=i+s;c++)for(let u=l-s;u<=l+s;u++){if(u<=0||c<=0||u>=e.width-1||c>=e.height-1)continue;const d=ow(a,u,c);d>o.mag&&(o={x:u,y:c,mag:d})}return{x:o.x,y:o.y}}function dw(e,t,s=6){return t.map(r=>cw(e,r,s))}var $e=$e||{};$e.Image=function(e,t,s){this.width=e||0,this.height=t||0,this.data=s||[]};$e.grayscale=function(e,t){for(var s=e.data,r=t.data,a=s.length,l=0,i=0;l<a;l+=4)r[i++]=s[l]*.299+s[l+1]*.587+s[l+2]*.114+.5&255;return t.width=e.width,t.height=e.height,t};$e.threshold=function(e,t,s){var r=e.data,a=t.data,l=r.length,i=[],o;for(o=0;o<256;++o)i[o]=o<=s?0:255;for(o=0;o<l;++o)a[o]=i[r[o]];return t.width=e.width,t.height=e.height,t};$e.adaptiveThreshold=function(e,t,s,r){var a=e.data,l=t.data,i=a.length,o=[],c;for($e.stackBoxBlur(e,t,s),c=0;c<768;++c)o[c]=c-255<=-r?255:0;for(c=0;c<i;++c)l[c]=o[a[c]-l[c]+255];return t.width=e.width,t.height=e.height,t};$e.otsu=function(e){var t=e.data,s=t.length,r=[],a=0,l=0,i=0,o=0,c=0,u=0,d,g,x;for(x=0;x<256;++x)r[x]=0;for(x=0;x<s;++x)r[t[x]]++;for(x=0;x<256;++x)l+=r[x]*x;for(x=0;x<256;++x)if(o+=r[x],o!==0){if(c=s-o,c===0)break;i+=r[x]*x,d=i/o-(l-i)/c,g=o*c*d*d,g>u&&(u=g,a=x)}return a};$e.stackBoxBlurMult=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265];$e.stackBoxBlurShift=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13];$e.BlurStack=function(){this.color=0,this.next=null};$e.stackBoxBlur=function(e,t,s){var r=e.data,a=t.data,l=e.height,i=e.width,o=l-1,c=i-1,u=s+s+1,d=s+1,g=$e.stackBoxBlurMult[s],x=$e.stackBoxBlurShift[s],y,v,C,D,b,h,w,E,p,S;for(y=v=new $e.BlurStack,S=1;S<u;++S)y=y.next=new $e.BlurStack;for(y.next=v,b=0,p=0;p<l;++p){for(h=b,C=r[b],D=d*C,y=v,S=0;S<d;++S)y.color=C,y=y.next;for(S=1;S<d;++S)y.color=r[b+S],D+=y.color,y=y.next;for(y=v,E=0;E<i;++E)a[b++]=D*g>>>x,w=E+d,w=h+(w<c?w:c),D-=y.color-r[w],y.color=r[w],y=y.next}for(E=0;E<i;++E){for(b=E,h=b+i,C=a[b],D=d*C,y=v,S=0;S<d;++S)y.color=C,y=y.next;for(S=1;S<d;++S)y.color=a[h],D+=y.color,y=y.next,h+=i;for(y=v,p=0;p<l;++p)a[b]=D*g>>>x,w=p+d,w=E+(w<o?w:o)*i,D-=y.color-a[w],y.color=a[w],y=y.next,b+=i}return t};$e.gaussianBlur=function(e,t,s,r){var a=$e.gaussianKernel(r);return t.width=e.width,t.height=e.height,s.width=e.width,s.height=e.height,$e.gaussianBlurFilter(e,s,a,!0),$e.gaussianBlurFilter(s,t,a,!1),t};$e.gaussianBlurFilter=function(e,t,s,r){var a=e.data,l=t.data,i=e.height,o=e.width,c=0,u=s.length>>1,d,g,x,y,v;for(x=0;x<i;++x)for(y=0;y<o;++y){for(g=0,v=-u;v<=u;++v)r?(d=c+v,(y+v<0||y+v>=o)&&(d=c)):(d=c+v*o,(x+v<0||x+v>=i)&&(d=c)),g+=s[u+v]*a[d];l[c++]=r?g:g+.5&255}return t};$e.gaussianKernel=function(e){var t=[[1],[.25,.5,.25],[.0625,.25,.375,.25,.0625],[.03125,.109375,.21875,.28125,.21875,.109375,.03125]],s=[],r,a,l,i,o,c;if(e<=7&&e%2===1)s=t[e>>1];else{for(r=(e-1)*.5,a=.8+.3*(r-1),l=-.5/(a*a),i=0,c=0;c<e;++c)o=c-r,i+=s[c]=Math.exp(l*o*o);for(i=1/i,c=0;c<e;++c)s[c]*=i}return s};$e.findContours=function(e,t){var s=e.width,r=e.height,a=[],l,i,o,c,u,d,g,x,y;for(l=$e.binaryBorder(e,t),i=$e.neighborhoodDeltas(s+2),o=s+3,u=1,x=0;x<r;++x,o+=2)for(y=0;y<s;++y,++o)c=l[o],c!==0&&(d=g=!1,c===1&&l[o-1]===0?d=!0:c>=1&&l[o+1]===0&&(g=!0),(d||g)&&(++u,a.push($e.borderFollowing(l,o,u,{x:y,y:x},g,i))));return a};$e.borderFollowing=function(e,t,s,r,a,l){var i=[],o,c,u,d,g;i.hole=a,d=g=a?0:4;do if(d=d-1&7,o=t+l[d],e[o]!==0)break;while(d!==g);if(d===g)e[t]=-s,i.push({x:r.x,y:r.y});else for(c=t;;){g=d;do u=c+l[++d];while(e[u]===0);if(d&=7,d-1>>>0<g>>>0?e[c]=-s:e[c]===1&&(e[c]=s),i.push({x:r.x,y:r.y}),r.x+=$e.neighborhood[d][0],r.y+=$e.neighborhood[d][1],u===t&&c===o)break;c=u,d=d+4&7}return i};$e.neighborhood=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]];$e.neighborhoodDeltas=function(e){for(var t=[],s=$e.neighborhood.length,r=0;r<s;++r)t[r]=$e.neighborhood[r][0]+$e.neighborhood[r][1]*e;return t.concat(t)};$e.approxPolyDP=function(e,t){var s={start_index:0,end_index:0},r={start_index:0,end_index:0},a=[],l=[],i=e.length,o,c,u,d,g,x,y,v,C,D,b;for(t*=t,b=0,C=0;C<3;++C)for(g=0,b=(b+r.start_index)%i,c=e[b],++b===i&&(b=0),D=1;D<i;++D)o=e[b],++b===i&&(b=0),y=o.x-c.x,v=o.y-c.y,d=y*y+v*v,d>g&&(g=d,r.start_index=D);for(g<=t?a.push({x:c.x,y:c.y}):(s.start_index=b,s.end_index=r.start_index+=s.start_index,r.start_index-=r.start_index>=i?i:0,r.end_index=s.start_index,r.end_index<r.start_index&&(r.end_index+=i),l.push({start_index:r.start_index,end_index:r.end_index}),l.push({start_index:s.start_index,end_index:s.end_index}));l.length!==0;){if(s=l.pop(),u=e[s.end_index%i],c=e[b=s.start_index%i],++b===i&&(b=0),s.end_index<=s.start_index+1)x=!0;else{for(g=0,y=u.x-c.x,v=u.y-c.y,C=s.start_index+1;C<s.end_index;++C)o=e[b],++b===i&&(b=0),d=Math.abs((o.y-c.y)*y-(o.x-c.x)*v),d>g&&(g=d,r.start_index=C);x=g*g<=t*(y*y+v*v)}x?a.push({x:c.x,y:c.y}):(r.end_index=s.end_index,s.end_index=r.start_index,l.push({start_index:r.start_index,end_index:r.end_index}),l.push({start_index:s.start_index,end_index:s.end_index}))}return a};$e.warp=function(e,t,s,r){var a=e.data,l=t.data,i=e.width,o=e.height,c=0,u,d,g,x,y,v,C,D,b,h,w,E,p,S,P,N,q,G,_,te,L,Q,oe;for(p=$e.getPerspectiveTransform(s,r-1),S=p[8],P=p[2],N=p[5],Q=0;Q<r;++Q)for(S+=p[7],P+=p[1],N+=p[4],q=S,G=P,_=N,oe=0;oe<r;++oe)q+=p[6],G+=p[0],_+=p[3],te=G/q,L=_/q,u=te>>>0,d=u===i-1?u:u+1,g=te-u,x=1-g,y=L>>>0,v=y===o-1?y:y+1,C=L-y,D=1-C,b=h=y*i,w=E=v*i,l[c++]=D*(x*a[b+u]+g*a[h+d])+C*(x*a[w+u]+g*a[E+d])&255;return t.width=r,t.height=r,t};$e.getPerspectiveTransform=function(e,t){var s=$e.square2quad(e);return s[0]/=t,s[1]/=t,s[3]/=t,s[4]/=t,s[6]/=t,s[7]/=t,s};$e.square2quad=function(e){var t=[],s,r,a,l,i,o,c;return s=e[0].x-e[1].x+e[2].x-e[3].x,r=e[0].y-e[1].y+e[2].y-e[3].y,s===0&&r===0?(t[0]=e[1].x-e[0].x,t[1]=e[2].x-e[1].x,t[2]=e[0].x,t[3]=e[1].y-e[0].y,t[4]=e[2].y-e[1].y,t[5]=e[0].y,t[6]=0,t[7]=0,t[8]=1):(a=e[1].x-e[2].x,l=e[3].x-e[2].x,i=e[1].y-e[2].y,o=e[3].y-e[2].y,c=a*o-l*i,t[6]=(s*o-l*r)/c,t[7]=(a*r-s*i)/c,t[8]=1,t[0]=e[1].x-e[0].x+t[6]*e[1].x,t[1]=e[3].x-e[0].x+t[7]*e[3].x,t[2]=e[0].x,t[3]=e[1].y-e[0].y+t[6]*e[1].y,t[4]=e[3].y-e[0].y+t[7]*e[3].y,t[5]=e[0].y),t};$e.isContourConvex=function(e){var t=0,s=!0,r=e.length,a=0,l=0,i,o,c,u,d,g,x,y;for(o=e[r-1],i=e[0],d=i.x-o.x,g=i.y-o.y;a<r;++a){if(++l===r&&(l=0),o=i,i=e[l],x=i.x-o.x,y=i.y-o.y,c=x*g,u=y*d,t|=u>c?1:u<c?2:3,t===3){s=!1;break}d=x,g=y}return s};$e.perimeter=function(e){for(var t=e.length,s=0,r=t-1,a=0,l,i;s<t;r=s++)l=e[s].x-e[r].x,i=e[s].y-e[r].y,a+=Math.sqrt(l*l+i*i);return a};$e.minEdgeLength=function(e){for(var t=e.length,s=0,r=t-1,a=1/0,l,i,o;s<t;r=s++)i=e[s].x-e[r].x,o=e[s].y-e[r].y,l=i*i+o*o,l<a&&(a=l);return Math.sqrt(a)};$e.countNonZero=function(e,t){var s=e.data,r=t.height,a=t.width,l=t.x+t.y*e.width,i=e.width-a,o=0,c,u;for(c=0;c<r;++c){for(u=0;u<a;++u)s[l++]!==0&&++o;l+=i}return o};$e.binaryBorder=function(e,t){var s=e.data,r=e.height,a=e.width,l=0,i=0,o,c;for(c=-2;c<a;++c)t[i++]=0;for(o=0;o<r;++o){for(t[i++]=0,c=0;c<a;++c)t[i++]=s[l++]===0?0:1;t[i++]=0}for(c=-2;c<a;++c)t[i++]=0;return t};var uw=$e,Dn=uw,qn=qn||{};qn.Marker=function(e,t){this.id=e,this.corners=t};qn.Detector=function(){this.grey=new Dn.Image,this.thres=new Dn.Image,this.homography=new Dn.Image,this.binary=[],this.contours=[],this.polys=[],this.candidates=[]};qn.Detector.prototype.detect=function(e){return Dn.grayscale(e,this.grey),Dn.adaptiveThreshold(this.grey,this.thres,2,7),this.contours=Dn.findContours(this.thres,this.binary),this.candidates=this.findCandidates(this.contours,e.width*.2,.05,10),this.candidates=this.clockwiseCorners(this.candidates),this.candidates=this.notTooNear(this.candidates,10),this.findMarkers(this.grey,this.candidates,49)};qn.Detector.prototype.findCandidates=function(e,t,s,r){var a=[],l=e.length,i,o,c;for(this.polys=[],c=0;c<l;++c)i=e[c],i.length>=t&&(o=Dn.approxPolyDP(i,i.length*s),this.polys.push(o),o.length===4&&Dn.isContourConvex(o)&&Dn.minEdgeLength(o)>=r&&a.push(o));return a};qn.Detector.prototype.clockwiseCorners=function(e){var t=e.length,s,r,a,l,i,o;for(o=0;o<t;++o)s=e[o][1].x-e[o][0].x,a=e[o][1].y-e[o][0].y,r=e[o][2].x-e[o][0].x,l=e[o][2].y-e[o][0].y,s*l-a*r<0&&(i=e[o][1],e[o][1]=e[o][3],e[o][3]=i);return e};qn.Detector.prototype.notTooNear=function(e,t){var s=[],r=e.length,a,l,i,o,c,u;for(o=0;o<r;++o)for(c=o+1;c<r;++c){for(a=0,u=0;u<4;++u)l=e[o][u].x-e[c][u].x,i=e[o][u].y-e[c][u].y,a+=l*l+i*i;a/4<t*t&&(Dn.perimeter(e[o])<Dn.perimeter(e[c])?e[o].tooNear=!0:e[c].tooNear=!0)}for(o=0;o<r;++o)e[o].tooNear||s.push(e[o]);return s};qn.Detector.prototype.findMarkers=function(e,t,s){var r=[],a=t.length,l,i,o;for(o=0;o<a;++o)l=t[o],Dn.warp(e,this.homography,l,s),Dn.threshold(this.homography,this.homography,Dn.otsu(this.homography)),i=this.getMarker(this.homography,l),i&&r.push(i);return r};qn.Detector.prototype.getMarker=function(e,t){var s=e.width/7>>>0,r=s*s>>1,a=[],l=[],i=[],o,c,u,d,g;for(d=0;d<7;++d)for(u=d===0||d===6?1:6,g=0;g<7;g+=u)if(o={x:g*s,y:d*s,width:s,height:s},Dn.countNonZero(e,o)>r)return null;for(d=0;d<5;++d)for(a[d]=[],g=0;g<5;++g)o={x:(g+1)*s,y:(d+1)*s,width:s,height:s},a[d][g]=Dn.countNonZero(e,o)>r?1:0;for(l[0]=a,i[0]=this.hammingDistance(l[0]),c={first:i[0],second:0},d=1;d<4;++d)l[d]=this.rotate(l[d-1]),i[d]=this.hammingDistance(l[d]),i[d]<c.first&&(c.first=i[d],c.second=d);return c.first!==0?null:new qn.Marker(this.mat2id(l[c.second]),this.rotate2(t,4-c.second))};qn.Detector.prototype.hammingDistance=function(e){var t=[[1,0,0,0,0],[1,0,1,1,1],[0,1,0,0,1],[0,1,1,1,0]],s=0,r,a,l,i,o;for(l=0;l<5;++l){for(a=1/0,i=0;i<4;++i){for(r=0,o=0;o<5;++o)r+=e[l][o]===t[i][o]?0:1;r<a&&(a=r)}s+=a}return s};qn.Detector.prototype.mat2id=function(e){var t=0,s;for(s=0;s<5;++s)t<<=1,t|=e[s][1],t<<=1,t|=e[s][3];return t};qn.Detector.prototype.rotate=function(e){var t=[],s=e.length,r,a;for(r=0;r<s;++r)for(t[r]=[],a=0;a<e[r].length;++a)t[r][a]=e[e[r].length-a-1][r];return t};qn.Detector.prototype.rotate2=function(e,t){var s=[],r=e.length,a;for(a=0;a<r;++a)s[a]=e[(t+a)%r];return s};var ps=ps||{};ps.svdcmp=function(e,t,s,r,a){var l,i,o,c,u,d,g,x,y=0,v,C,D=0,b,h,w=0,E,p,S,P=[];for(i=0;i<s;++i){if(g=i+1,P[i]=w*D,D=h=w=0,i<t){for(d=i;d<t;++d)w+=Math.abs(e[d][i]);if(w!==0){for(d=i;d<t;++d)e[d][i]/=w,h+=e[d][i]*e[d][i];for(C=e[i][i],D=-ps.sign(Math.sqrt(h),C),b=C*D-h,e[i][i]=C-D,c=g;c<s;++c){for(h=0,d=i;d<t;++d)h+=e[d][i]*e[d][c];for(C=h/b,d=i;d<t;++d)e[d][c]+=C*e[d][i]}for(d=i;d<t;++d)e[d][i]*=w}}if(r[i]=w*D,D=h=w=0,i<t&&i!==s-1){for(d=g;d<s;++d)w+=Math.abs(e[i][d]);if(w!==0){for(d=g;d<s;++d)e[i][d]/=w,h+=e[i][d]*e[i][d];for(C=e[i][g],D=-ps.sign(Math.sqrt(h),C),b=C*D-h,e[i][g]=C-D,d=g;d<s;++d)P[d]=e[i][d]/b;for(c=g;c<t;++c){for(h=0,d=g;d<s;++d)h+=e[c][d]*e[i][d];for(d=g;d<s;++d)e[c][d]+=h*P[d]}for(d=g;d<s;++d)e[i][d]*=w}}y=Math.max(y,Math.abs(r[i])+Math.abs(P[i]))}for(i=s-1;i>=0;--i){if(i<s-1){if(D!==0){for(c=g;c<s;++c)a[c][i]=e[i][c]/e[i][g]/D;for(c=g;c<s;++c){for(h=0,d=g;d<s;++d)h+=e[i][d]*a[d][c];for(d=g;d<s;++d)a[d][c]+=h*a[d][i]}}for(c=g;c<s;++c)a[i][c]=a[c][i]=0}a[i][i]=1,D=P[i],g=i}for(i=Math.min(s,t)-1;i>=0;--i){for(g=i+1,D=r[i],c=g;c<s;++c)e[i][c]=0;if(D!==0){for(D=1/D,c=g;c<s;++c){for(h=0,d=g;d<t;++d)h+=e[d][i]*e[d][c];for(C=h/e[i][i]*D,d=i;d<t;++d)e[d][c]+=C*e[d][i]}for(c=i;c<t;++c)e[c][i]*=D}else for(c=i;c<t;++c)e[c][i]=0;++e[i][i]}for(d=s-1;d>=0;--d)for(o=1;o<=30;++o){for(l=!0,g=d;g>=0;--g){if(x=g-1,Math.abs(P[g])+y===y){l=!1;break}if(Math.abs(r[x])+y===y)break}if(l)for(v=0,h=1,i=g;i<=d&&(C=h*P[i],Math.abs(C)+y!==y);++i)for(D=r[i],b=ps.pythag(C,D),r[i]=b,b=1/b,v=D*b,h=-C*b,c=1;c<=t;++c)p=e[c][x],S=e[c][i],e[c][x]=p*v+S*h,e[c][i]=S*v-p*h;if(S=r[d],g===d){if(S<0)for(r[d]=-S,c=0;c<s;++c)a[c][d]=-a[c][d];break}if(o===30)return!1;for(E=r[g],x=d-1,p=r[x],D=P[x],b=P[d],C=((p-S)*(p+S)+(D-b)*(D+b))/(2*b*p),D=ps.pythag(C,1),C=((E-S)*(E+S)+b*(p/(C+ps.sign(D,C))-b))/E,v=h=1,c=g;c<=x;++c){for(i=c+1,D=P[i],p=r[i],b=h*D,D=v*D,S=ps.pythag(C,b),P[c]=S,v=C/S,h=b/S,C=E*v+D*h,D=D*v-E*h,b=p*h,p*=v,u=0;u<s;++u)E=a[u][c],S=a[u][i],a[u][c]=E*v+S*h,a[u][i]=S*v-E*h;for(S=ps.pythag(C,b),r[c]=S,S!==0&&(S=1/S,v=C*S,h=b*S),C=v*D+h*p,E=v*p-h*D,u=0;u<t;++u)p=e[u][c],S=e[u][i],e[u][c]=p*v+S*h,e[u][i]=S*v-p*h}P[g]=0,P[d]=C,r[d]=E}return!0};ps.pythag=function(e,t){var s=Math.abs(e),r=Math.abs(t),a;return s>r?(a=r/s,s*Math.sqrt(1+a*a)):r===0?0:(a=s/r,r*Math.sqrt(1+a*a))};ps.sign=function(e,t){return t>=0?Math.abs(e):-Math.abs(e)};var Hx=ps,mw=Hx,Jn=Jn||{};Jn.Posit=function(e,t){this.objectPoints=this.buildModel(e),this.focalLength=t,this.objectVectors=[],this.objectNormal=[],this.objectMatrix=[[],[],[]],this.init()};Jn.Posit.prototype.buildModel=function(e){var t=e/2;return[[-t,t,0],[t,t,0],[t,-t,0],[-t,-t,0]]};Jn.Posit.prototype.init=function(){var e=this.objectPoints.length,t=[],s=[],r=0,a=2,l;for(l=0;l<e;++l)this.objectVectors[l]=[this.objectPoints[l][0]-this.objectPoints[0][0],this.objectPoints[l][1]-this.objectPoints[0][1],this.objectPoints[l][2]-this.objectPoints[0][2]],t[l]=[this.objectVectors[l][0],this.objectVectors[l][1],this.objectVectors[l][2]];for(;r===0;)s[0]=this.objectVectors[1][1]*this.objectVectors[a][2]-this.objectVectors[1][2]*this.objectVectors[a][1],s[1]=this.objectVectors[1][2]*this.objectVectors[a][0]-this.objectVectors[1][0]*this.objectVectors[a][2],s[2]=this.objectVectors[1][0]*this.objectVectors[a][1]-this.objectVectors[1][1]*this.objectVectors[a][0],r=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]),++a;for(l=0;l<3;++l)this.objectNormal[l]=s[l]/r;Jn.pseudoInverse(t,e,this.objectMatrix)};Jn.Posit.prototype.pose=function(e){var t=[[],[],[]],s=[[],[],[]],r=[],a=[[],[],[]],l=[[],[],[]],i=[],o=[],c,u,d,g,x,y;for(this.pos(e,t,s,r),d=this.isValid(t,r),d?c=this.iterate(e,t,r,a,i):c={euclidean:-1,pixels:-1,maximum:-1},g=this.isValid(s,r),g?u=this.iterate(e,s,r,l,o):u={euclidean:-1,pixels:-1,maximum:-1},x=0;x<3;++x)for(y=0;y<3;++y)d&&(i[x]-=a[x][y]*this.objectPoints[0][y]),g&&(o[x]-=l[x][y]*this.objectPoints[0][y]);return c.euclidean<u.euclidean?new Jn.Pose(c.pixels,a,i,u.pixels,l,o):new Jn.Pose(u.pixels,l,o,c.pixels,a,i)};Jn.Posit.prototype.pos=function(e,t,s,r){var a=this.objectPoints.length,l=[],i=[],o=[],c=[],u=[],d=[],g=[],x=[],y,v,C,D,b,h,w,E,p,S;for(p=0;p<a;++p)l[p]=[e[p].x-e[0].x,e[p].y-e[0].y];for(p=0;p<3;++p)for(i[p]=0,o[p]=0,S=0;S<a;++S)i[p]+=this.objectMatrix[p][S]*l[S][0],o[p]+=this.objectMatrix[p][S]*l[S][1];for(y=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],v=o[0]*o[0]+o[1]*o[1]+o[2]*o[2],C=i[0]*o[0]+i[1]*o[1]+i[2]*o[2],D=(v-y)*(v-y)+4*(C*C),v-y>=0?b=(v-y+Math.sqrt(D))/2:b=(v-y-Math.sqrt(D))/2,b>=0?(h=Math.sqrt(b),h===0?w=0:w=-C/h):(h=Math.sqrt(-(C*C)/b),h===0?w=Math.sqrt(y-v):w=-C/h),p=0;p<3;++p)c[p]=i[p]+h*this.objectNormal[p],u[p]=o[p]+w*this.objectNormal[p];for(E=Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2]),p=0;p<3;++p)d[p]=c[p]/E,g[p]=u[p]/E;for(x[0]=d[1]*g[2]-d[2]*g[1],x[1]=d[2]*g[0]-d[0]*g[2],x[2]=d[0]*g[1]-d[1]*g[0],p=0;p<3;++p)t[0][p]=d[p],t[1][p]=g[p],t[2][p]=x[p];for(p=0;p<3;++p)c[p]=i[p]-h*this.objectNormal[p],u[p]=o[p]-w*this.objectNormal[p];for(p=0;p<3;++p)d[p]=c[p]/E,g[p]=u[p]/E;for(x[0]=d[1]*g[2]-d[2]*g[1],x[1]=d[2]*g[0]-d[0]*g[2],x[2]=d[0]*g[1]-d[1]*g[0],p=0;p<3;++p)s[0][p]=d[p],s[1][p]=g[p],s[2][p]=x[p];r[0]=e[0].x/E,r[1]=e[0].y/E,r[2]=this.focalLength/E};Jn.Posit.prototype.isValid=function(e,t){for(var s=this.objectPoints.length,r=1/0,a=0,l;a<s;++a)l=t[2]+(e[2][0]*this.objectVectors[a][0]+e[2][1]*this.objectVectors[a][1]+e[2][2]*this.objectVectors[a][2]),l<r&&(r=l);return r>=0};Jn.Posit.prototype.iterate=function(e,t,s,r,a){var l=this.objectPoints.length,i=[],o=[],c=[[],[],[]],u=[[],[],[]],d=[],g=[],x=!1,y=0,v,C,D,b,h,w,E,p,S;for(p=0;p<l;++p)i[p]={x:e[p].x,y:e[p].y};for(p=0;p<3;++p){for(S=0;S<3;++S)r[p][S]=t[p][S];a[p]=s[p]}for(p=0;p<l;++p){for(D=0,S=0;S<3;++S)D+=this.objectVectors[p][S]*r[2][S]/a[2];o[p]={x:(1+D)*e[p].x,y:(1+D)*e[p].y}}for(C=0,p=0;p<l;++p)C+=Math.abs(o[p].x-i[p].x),C+=Math.abs(o[p].y-i[p].y);for(p=0;p<3;++p)d[p]=a[p]-(r[p][0]*this.objectPoints[0][0]+r[p][1]*this.objectPoints[0][1]+r[p][2]*this.objectPoints[0][2]);for(b=h=this.error(e,r,d),x=h.pixels===0||C<.01;y++<100&&!x;){for(p=0;p<l;++p)i[p].x=o[p].x,i[p].y=o[p].y;for(this.pos(o,c,u,a),p=0;p<3;++p)d[p]=a[p]-(c[p][0]*this.objectPoints[0][0]+c[p][1]*this.objectPoints[0][1]+c[p][2]*this.objectPoints[0][2]),g[p]=a[p]-(u[p][0]*this.objectPoints[0][0]+u[p][1]*this.objectPoints[0][1]+u[p][2]*this.objectPoints[0][2]);if(h=this.error(e,c,d),w=this.error(e,u,g),h.euclidean>=0&&w.euclidean>=0)if(w.euclidean<h.euclidean)for(b=w,p=0;p<3;++p)for(S=0;S<3;++S)r[p][S]=u[p][S];else for(b=h,p=0;p<3;++p)for(S=0;S<3;++S)r[p][S]=c[p][S];if(h.euclidean<0&&w.euclidean>=0)for(b=w,p=0;p<3;++p)for(S=0;S<3;++S)r[p][S]=u[p][S];if(w.euclidean<0&&h.euclidean>=0)for(b=h,p=0;p<3;++p)for(S=0;S<3;++S)r[p][S]=c[p][S];for(p=0;p<l;++p){for(D=0,S=0;S<3;++S)D+=this.objectVectors[p][S]*r[2][S]/a[2];o[p].x=(1+D)*e[p].x,o[p].y=(1+D)*e[p].y}for(v=C,C=0,p=0;p<l;++p)C+=Math.abs(o[p].x-i[p].x),C+=Math.abs(o[p].y-i[p].y);E=Math.abs(C-v),x=b.pixels===0||E<.01}return b};Jn.Posit.prototype.error=function(e,t,s){var r=this.objectPoints.length,a=[],l=[],i=[],o=0,c=0,u=0,d,g,x;if(!this.isValid(t,s))return{euclidean:-1,pixels:-1,maximum:-1};for(d=0;d<r;++d)for(a[d]=[],g=0;g<3;++g)a[d][g]=s[g];for(d=0;d<r;++d)for(g=0;g<3;++g)for(x=0;x<3;++x)a[d][g]+=t[g][x]*this.objectPoints[d][x];for(d=0;d<r;++d)for(l[d]=[],g=0;g<2;++g)l[d][g]=this.focalLength*a[d][g]/a[d][2];for(d=0;d<r;++d)i[d]=[l[d][0]-e[d].x,l[d][1]-e[d].y];for(d=0;d<r;++d)o+=Math.sqrt(i[d][0]*i[d][0]+i[d][1]*i[d][1]),c+=Math.abs(Math.round(l[d][0])-Math.round(e[d].x))+Math.abs(Math.round(l[d][1])-Math.round(e[d].y)),Math.abs(i[d][0])>u&&(u=Math.abs(i[d][0])),Math.abs(i[d][1])>u&&(u=Math.abs(i[d][1]));return{euclidean:o/r,pixels:c,maximum:u}};Jn.pseudoInverse=function(e,t,s){var r=[],a=[[],[],[]],l=[[],[],[]],i=0,o=0,c,u,d;for(mw.svdcmp(e,t,3,r,a),c=0;c<3;++c)r[c]>i&&(i=r[c]);for(i*=.01,c=0;c<3;++c)r[c]<i&&(r[c]=0);for(u=0;u<3;++u)if(r[u]===0)for(++o,d=u;d<2;++d){for(c=0;c<t;++c)e[c][d]=e[c][d+1];for(c=0;c<3;++c)a[c][d]=a[c][d+1]}for(u=0;u<2;++u)r[u]===0&&(r[u]=r[u+1]);for(c=0;c<3;++c)for(u=0;u<3-o;++u)l[c][u]=a[c][u]/r[u];for(c=0;c<3;++c)for(u=0;u<t;++u)for(s[c][u]=0,d=0;d<3-o;++d)s[c][u]+=l[c][d]*e[u][d]};Jn.Pose=function(e,t,s,r,a,l){this.bestError=e,this.bestRotation=t,this.bestTranslation=s,this.alternativeError=r,this.alternativeRotation=a,this.alternativeTranslation=l};var fw=Hx,js=js||{};js.Posit=function(e,t){this.model=this.buildModel(e),this.focalLength=t,this.init()};js.Posit.prototype.buildModel=function(e){var t=e/2;return[new ke(-t,t,0),new ke(t,t,0),new ke(t,-t,0),new ke(-t,-t,0)]};js.Posit.prototype.init=function(){var e=new ke,t=new tt,s;this.modelVectors=tt.fromRows(ke.sub(this.model[1],this.model[0]),ke.sub(this.model[2],this.model[0]),ke.sub(this.model[3],this.model[0])),s=tt.clone(this.modelVectors),fw.svdcmp(s.m,3,3,e.v,t.m),this.modelPseudoInverse=tt.mult(tt.mult(t,tt.fromDiagonal(ke.inverse(e))),tt.transpose(s)),this.modelNormal=t.column(e.minIndex())};js.Posit.prototype.pose=function(e){var t=new ke(1,1,1),s=new tt,r=new tt,a=new ke,l=new ke,i,o;return this.pos(e,t,s,r,a,l),i=this.iterate(e,s,a),o=this.iterate(e,r,l),i<o?new js.Pose(i,s.m,a.v,o,r.m,l.v):new js.Pose(o,r.m,l.v,i,s.m,a.v)};js.Posit.prototype.pos=function(e,t,s,r,a,l){var i=new ke(e[1].x,e[2].x,e[3].x),o=new ke(e[1].y,e[2].y,e[3].y),c=ke.addScalar(ke.mult(i,t),-e[0].x),u=ke.addScalar(ke.mult(o,t),-e[0].y),d=tt.multVector(this.modelPseudoInverse,c),g=tt.multVector(this.modelPseudoInverse,u),x=g.square()-d.square(),y=ke.dot(d,g),v=0,C=0,D,b,h,w,E,p,S,P,N;x===0?(v=Math.sqrt(Math.abs(2*y)),C=-Math.PI/2*(y<0?-1:y>0?1:0)):(v=Math.sqrt(Math.sqrt(x*x+4*y*y)),C=Math.atan(-2*y/x),x<0&&(C+=Math.PI),C/=2),P=v*Math.cos(C),N=v*Math.sin(C),D=ke.add(d,ke.multScalar(this.modelNormal,P)),b=ke.add(g,ke.multScalar(this.modelNormal,N)),w=D.normalize(),E=b.normalize(),h=ke.cross(D,b),s.copy(tt.fromRows(D,b,h)),p=(w+E)/2,S=tt.multVector(s,this.model[0]),a.v=[e[0].x/p-S.v[0],e[0].y/p-S.v[1],this.focalLength/p],D=ke.sub(d,ke.multScalar(this.modelNormal,P)),b=ke.sub(g,ke.multScalar(this.modelNormal,N)),w=D.normalize(),E=b.normalize(),h=ke.cross(D,b),r.copy(tt.fromRows(D,b,h)),p=(w+E)/2,S=tt.multVector(r,this.model[0]),l.v=[e[0].x/p-S.v[0],e[0].y/p-S.v[1],this.focalLength/p]};js.Posit.prototype.iterate=function(e,t,s){for(var r=1/0,a=new tt,l=new tt,i=new ke,o=new ke,c=0,u,d,g,x;c<100&&(u=ke.addScalar(ke.multScalar(tt.multVector(this.modelVectors,t.row(2)),1/s.v[2]),1),this.pos(e,u,a,l,i,o),g=this.getError(e,a,i),x=this.getError(e,l,o),g<x?(t.copy(a),s.copy(i),d=g):(t.copy(l),s.copy(o),d=x),!(d<=2||d>r));++c)r=d;return d};js.Posit.prototype.getError=function(e,t,s){var r=ke.add(tt.multVector(t,this.model[0]),s),a=ke.add(tt.multVector(t,this.model[1]),s),l=ke.add(tt.multVector(t,this.model[2]),s),i=ke.add(tt.multVector(t,this.model[3]),s),o,c,u,d,g,x,y,v,C;return r=r.v,a=a.v,l=l.v,i=i.v,r[0]*=this.focalLength/r[2],r[1]*=this.focalLength/r[2],a[0]*=this.focalLength/a[2],a[1]*=this.focalLength/a[2],l[0]*=this.focalLength/l[2],l[1]*=this.focalLength/l[2],i[0]*=this.focalLength/i[2],i[1]*=this.focalLength/i[2],o=[{x:r[0],y:r[1]},{x:a[0],y:a[1]},{x:l[0],y:l[1]},{x:i[0],y:i[1]}],c=this.angle(e[0],e[1],e[3]),u=this.angle(e[1],e[2],e[0]),d=this.angle(e[2],e[3],e[1]),g=this.angle(e[3],e[0],e[2]),x=this.angle(o[0],o[1],o[3]),y=this.angle(o[1],o[2],o[0]),v=this.angle(o[2],o[3],o[1]),C=this.angle(o[3],o[0],o[2]),(Math.abs(c-x)+Math.abs(u-y)+Math.abs(d-v)+Math.abs(g-C))/4};js.Posit.prototype.angle=function(e,t,s){var r=t.x-e.x,a=t.y-e.y,l=s.x-e.x,i=s.y-e.y;return Math.acos((r*l+a*i)/(Math.sqrt(r*r+a*a)*Math.sqrt(l*l+i*i)))*180/Math.PI};js.Pose=function(e,t,s,r,a,l){this.bestError=e,this.bestRotation=t,this.bestTranslation=s,this.alternativeError=r,this.alternativeRotation=a,this.alternativeTranslation=l};var ke=function(e,t,s){this.v=[e||0,t||0,s||0]};ke.prototype.copy=function(e){var t=this.v;return e=e.v,t[0]=e[0],t[1]=e[1],t[2]=e[2],this};ke.add=function(e,t){var s=new ke,r=s.v;return e=e.v,t=t.v,r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],s};ke.sub=function(e,t){var s=new ke,r=s.v;return e=e.v,t=t.v,r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s};ke.mult=function(e,t){var s=new ke,r=s.v;return e=e.v,t=t.v,r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],s};ke.addScalar=function(e,t){var s=new ke,r=s.v;return e=e.v,r[0]=e[0]+t,r[1]=e[1]+t,r[2]=e[2]+t,s};ke.multScalar=function(e,t){var s=new ke,r=s.v;return e=e.v,r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,s};ke.dot=function(e,t){return e=e.v,t=t.v,e[0]*t[0]+e[1]*t[1]+e[2]*t[2]};ke.cross=function(e,t){return e=e.v,t=t.v,new ke(e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0])};ke.prototype.normalize=function(){var e=this.v,t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return t>0&&(e[0]/=t,e[1]/=t,e[2]/=t),t};ke.inverse=function(e){var t=new ke,s=t.v;return e=e.v,e[0]!==0&&(s[0]=1/e[0]),e[1]!==0&&(s[1]=1/e[1]),e[2]!==0&&(s[2]=1/e[2]),t};ke.prototype.square=function(){var e=this.v;return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]};ke.prototype.minIndex=function(){var e=this.v;return e[0]<e[1]?e[0]<e[2]?0:2:e[1]<e[2]?1:2};var tt=function(){this.m=[[0,0,0],[0,0,0],[0,0,0]]};tt.clone=function(e){var t=new tt,s=t.m;return e=e.m,s[0][0]=e[0][0],s[0][1]=e[0][1],s[0][2]=e[0][2],s[1][0]=e[1][0],s[1][1]=e[1][1],s[1][2]=e[1][2],s[2][0]=e[2][0],s[2][1]=e[2][1],s[2][2]=e[2][2],t};tt.prototype.copy=function(e){var t=this.m;return e=e.m,t[0][0]=e[0][0],t[0][1]=e[0][1],t[0][2]=e[0][2],t[1][0]=e[1][0],t[1][1]=e[1][1],t[1][2]=e[1][2],t[2][0]=e[2][0],t[2][1]=e[2][1],t[2][2]=e[2][2],this};tt.fromRows=function(e,t,s){var r=new tt,a=r.m;return e=e.v,t=t.v,s=s.v,a[0][0]=e[0],a[0][1]=e[1],a[0][2]=e[2],a[1][0]=t[0],a[1][1]=t[1],a[1][2]=t[2],a[2][0]=s[0],a[2][1]=s[1],a[2][2]=s[2],r};tt.fromDiagonal=function(e){var t=new tt,s=t.m;return e=e.v,s[0][0]=e[0],s[1][1]=e[1],s[2][2]=e[2],t};tt.transpose=function(e){var t=new tt,s=t.m;return e=e.m,s[0][0]=e[0][0],s[0][1]=e[1][0],s[0][2]=e[2][0],s[1][0]=e[0][1],s[1][1]=e[1][1],s[1][2]=e[2][1],s[2][0]=e[0][2],s[2][1]=e[1][2],s[2][2]=e[2][2],t};tt.mult=function(e,t){var s=new tt,r=s.m;return e=e.m,t=t.m,r[0][0]=e[0][0]*t[0][0]+e[0][1]*t[1][0]+e[0][2]*t[2][0],r[0][1]=e[0][0]*t[0][1]+e[0][1]*t[1][1]+e[0][2]*t[2][1],r[0][2]=e[0][0]*t[0][2]+e[0][1]*t[1][2]+e[0][2]*t[2][2],r[1][0]=e[1][0]*t[0][0]+e[1][1]*t[1][0]+e[1][2]*t[2][0],r[1][1]=e[1][0]*t[0][1]+e[1][1]*t[1][1]+e[1][2]*t[2][1],r[1][2]=e[1][0]*t[0][2]+e[1][1]*t[1][2]+e[1][2]*t[2][2],r[2][0]=e[2][0]*t[0][0]+e[2][1]*t[1][0]+e[2][2]*t[2][0],r[2][1]=e[2][0]*t[0][1]+e[2][1]*t[1][1]+e[2][2]*t[2][1],r[2][2]=e[2][0]*t[0][2]+e[2][1]*t[1][2]+e[2][2]*t[2][2],s};tt.multVector=function(e,t){return e=e.m,t=t.v,new ke(e[0][0]*t[0]+e[0][1]*t[1]+e[0][2]*t[2],e[1][0]*t[0]+e[1][1]*t[1]+e[1][2]*t[2],e[2][0]*t[0]+e[2][1]*t[1]+e[2][2]*t[2])};tt.prototype.column=function(e){var t=this.m;return new ke(t[0][e],t[1][e],t[2][e])};tt.prototype.row=function(e){var t=this.m;return new ke(t[e][0],t[e][1],t[e][2])};var hw={};const Ph=["top","right","bottom","left"],gs={top:0,right:1,bottom:2,left:3};let Sd=null;function pw(){return Sd||(Sd=new hw.AR.Detector),Sd}function xw(e){const t=e.reduce((r,a)=>({x:r.x+a.x,y:r.y+a.y}),{x:0,y:0}),s=e.length||1;return{x:t.x/s,y:t.y/s}}function gw(e){try{const s=pw().detect(e)||[],r={},a=[];for(const d of s){const g=xw(d.corners);a.push({id:d.id,center:g});const x=Object.keys(gs).find(y=>gs[y]===d.id);x&&(r[x]={id:d.id,center:g})}const l=Object.keys(gs).filter(d=>!r[d]);if(l.length>0)return{success:!1,points:[],missing:l,markersFound:a,assignments:r,homography:null,errorPx:null,message:"Not all calibration markers were detected."};const i=[r.top.center,r.right.center,r.bottom.center,r.left.center],o=Eu(),c=Bx(o,i),u=Fx(c,o,i);return{success:!0,points:i,missing:[],markersFound:a,assignments:r,homography:c,errorPx:u}}catch(t){return{success:!1,points:[],missing:Object.keys(gs),markersFound:[],assignments:{},homography:null,errorPx:null,message:t instanceof Error?t.message:"Marker detection failed"}}}function yw(e){const t=e.getContext("2d");if(!t)return{success:!1,points:[],missing:Object.keys(gs),markersFound:[],assignments:{},homography:null,errorPx:null,message:"Canvas context unavailable for marker detection."};const s=t.getImageData(0,0,e.width,e.height);return gw(s)}const vw={"0,0":[1,0,0,0,0],"0,1":[1,0,1,1,1],"1,0":[0,1,0,0,1],"1,1":[0,1,1,1,0]};function bw(e){const t=new Array(5);let s=e>>>0;for(let a=4;a>=0;a--){const l=s&1;s>>=1;const i=s&1;s>>=1;const o=vw[`${i},${l}`];if(!o)throw new Error(`Unsupported marker id pattern for row ${a}`);t[a]=o.slice()}const r=Array.from({length:7},()=>new Array(7).fill(0));for(let a=0;a<5;a++)for(let l=0;l<5;l++)r[a+1][l+1]=t[a][l];return r}async function Wx(){const e=[];try{const t=await ww();for(const s of t){const r=await Nw(s,[80,8080,8787,8788,3e3,5e3]);for(const a of r){const l=await Sw(a.ip,a.port);l&&e.push(l)}}}catch(t){console.error("Network discovery failed:",t)}return e}async function ww(){const e=[];try{const t=new RTCPeerConnection({iceServers:[]});t.createDataChannel("");const s=await t.createOffer();return await t.setLocalDescription(s),new Promise(r=>{const a=setTimeout(()=>{t.close(),r(e)},5e3);t.onicecandidate=l=>{if(l.candidate){const o=l.candidate.candidate.match(/(\d+\.\d+\.\d+\.\d+)/);if(o&&o[1]&&!e.includes(o[1])){const c=o[1];jw(c)&&e.push(c)}}else clearTimeout(a),t.close(),r(e)}})}catch(t){return console.error("Failed to get local IPs:",t),["192.168.1.0"]}}function jw(e){const t=e.split(".").map(Number);return t[0]===10||t[0]===172&&t[1]>=16&&t[1]<=31||t[0]===192&&t[1]===168}async function Nw(e,t){const s=[],r=e.split(".").slice(0,3).join("."),a=[];for(let i=1;i<=254;i++){const o=`${r}.${i}`;for(const c of t)a.push(kw(o,c))}return(await Promise.allSettled(a)).forEach((i,o)=>{if(i.status==="fulfilled"&&i.value){const c=o%t.length,u=Math.floor(o/t.length),d=`${r}.${u+1}`;s.push({ip:d,port:t[c]})}}),s}async function kw(e,t){try{const s=await fetch(`http://${e}:${t}/`,{method:"HEAD",mode:"no-cors",signal:AbortSignal.timeout(2e3)});return!0}catch{return!1}}async function Sw(e,t){try{const s=["/","/api/info","/api/status","/camera","/stream"];for(const r of s)try{const a=await fetch(`http://${e}:${t}${r}`,{method:"GET",signal:AbortSignal.timeout(3e3)});if(a.ok){const l=a.headers.get("content-type")||"",i=await a.text();if(i.includes("OMNI")||i.includes("omni")||r.includes("omni"))return{id:`omni-${e}-${t}`,name:`OMNI Camera (${e})`,ip:e,port:t,type:"omni",capabilities:["video","calibration"],status:"online",connectionType:"wifi"};if(i.includes("VERT")||i.includes("vert")||r.includes("vert"))return{id:`vert-${e}-${t}`,name:`VERT Camera (${e})`,ip:e,port:t,type:"vert",capabilities:["video","calibration"],status:"online",connectionType:"wifi"};if(l.includes("video")||i.includes("stream")||r==="/stream")return{id:`generic-${e}-${t}`,name:`Network Camera (${e})`,ip:e,port:t,type:"generic",capabilities:["video"],status:"online",connectionType:"wifi"}}}catch{}}catch(s){console.error(`Failed to probe device ${e}:${t}:`,s)}return null}async function Cw(){const e=[];try{if(!("serial"in navigator))return console.warn("Web Serial API not supported in this browser"),e;const t=await navigator.serial.getPorts();for(const s of t){const r=await Vx(s);r&&e.push(r)}}catch(t){console.error("USB device discovery failed:",t)}return e}async function Ew(){try{if(!("serial"in navigator))return alert("Web Serial API not supported in this browser. Please use a compatible browser like Chrome or Edge."),null;const e=await navigator.serial.requestPort();return await Vx(e)}catch(e){return e.name!=="NotFoundError"&&console.error("USB device request failed:",e),null}}async function Vx(e){var t;try{await e.open({baudRate:9600,dataBits:8,stopBits:1,parity:"none"});const s=(t=e.readable)==null?void 0:t.getReader();if(s)try{const r=setTimeout(()=>s.cancel(),2e3),{value:a,done:l}=await s.read();if(clearTimeout(r),!l&&a){const i=new TextDecoder().decode(a);if(i.includes("OMNI")||i.includes("omni"))return s.releaseLock(),{id:`usb-omni-${Date.now()}`,name:"OMNI Camera (USB)",type:"omni",capabilities:["video","calibration"],status:"online",port:e};if(i.includes("VERT")||i.includes("vert"))return s.releaseLock(),{id:`usb-vert-${Date.now()}`,name:"VERT Camera (USB)",type:"vert",capabilities:["video","calibration"],status:"online",port:e}}}catch{}finally{try{s.releaseLock()}catch{}}return{id:`usb-generic-${Date.now()}`,name:"USB Scoring Device",type:"generic",capabilities:["video"],status:"online",port:e}}catch(s){return console.error("Failed to probe USB device:",s),null}}async function Gx(e){try{const t=`http://${e.ip}:${e.port}/stream`,s=document.createElement("video");return s.src=t,s.crossOrigin="anonymous",new Promise((r,a)=>{s.onloadeddata=()=>{const l=document.createElement("canvas"),i=l.getContext("2d");l.width=s.videoWidth,l.height=s.videoHeight;const o=l.captureStream(30),c=()=>{s.readyState>=2&&i.drawImage(s,0,0),requestAnimationFrame(c)};c(),r(o)},s.onerror=()=>a(new Error("Failed to load video stream")),s.load()})}catch(t){return console.error("Failed to connect to network device:",t),null}}async function Tw(e){try{if(!e.port)throw new Error("No serial port available");return console.log("USB device connection not fully implemented yet"),null}catch(t){return console.error("Failed to connect to USB device:",t),null}}function Mw(){const e=m.useRef(null),t=m.useRef(null),s=m.useRef(null),r=m.useRef(null),[a,l]=m.useState(!1),[i,o]=m.useState(!1),[c,u]=m.useState("camera"),[d,g]=m.useState(()=>localStorage.getItem("ndn:cal:mode")||"local"),[x,y]=m.useState([]),[v,C]=m.useState(!1),[D,b]=m.useState(null),[h,w]=m.useState(1),[E,p]=m.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("ndn:cal:forceDesktop")==="1"}catch{return!1}}),[S,P]=m.useState(()=>typeof navigator>"u"?!1:/Android|iPhone|iPad|iPod|Mobi/i.test(navigator.userAgent)),{H:N,setCalibration:q,reset:G,errorPx:_,locked:te}=Om(),{calibrationGuide:L,setCalibrationGuide:Q,preferredCameraId:oe,cameraEnabled:R,setCameraEnabled:Z,preferredCameraLocked:$,setPreferredCameraLocked:Y,setPreferredCamera:ue}=ss(),[Ce,Ee]=m.useState(null),[ot,he]=m.useState(!1),[Ze,ft]=m.useState(0),[Ae,ut]=m.useState(null),ge=m.useCallback((O,X=480)=>{if(typeof document>"u")throw new Error("Marker rendering only available in browser context");const ne=bw(O),K=document.createElement("canvas");K.width=X,K.height=X;const V=K.getContext("2d");if(!V)throw new Error("Unable to create marker canvas context");V.imageSmoothingEnabled=!1,V.fillStyle="#ffffff",V.fillRect(0,0,X,X);const De=X*.08,we=ne.length,Ye=(X-De*2)/we,Te=De;for(let kt=0;kt<we;kt++)for(let rn=0;rn<we;rn++){const At=ne[kt][rn];V.fillStyle=At===1?"#000000":"#ffffff",V.fillRect(Te+rn*Ye,Te+kt*Ye,Ye,Ye)}return V.strokeStyle="#000000",V.lineWidth=Math.max(2,Ye*.08),V.strokeRect(Te,Te,Ye*we,Ye*we),K.toDataURL("image/png")},[]),Tt=m.useCallback(()=>{try{const O=Ph.map(K=>{const V=gs[K];return{key:K,id:V,dataUrl:ge(V)}}),X=window.open("","_blank","width=900,height=1200");if(!X)throw new Error("Popup blocked by browser");const ne=`<!DOCTYPE html>
			<html>
			<head>
				<meta charset="utf-8" />
				<title>Nine Dart Nation – Marker Sheet</title>
				<style>
					body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; margin: 24px; color: #0f172a; }
					h1 { font-size: 20px; margin-bottom: 4px; }
					p { margin-top: 0; opacity: 0.7; }
					.grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 32px; margin-top: 24px; }
					.marker { text-align: center; }
					.marker h2 { font-size: 16px; margin: 12px 0 8px; }
					.marker img { width: 100%; max-width: 360px; border: 1px solid #0f172a; }
					footer { margin-top: 24px; font-size: 12px; opacity: 0.6; }
				</style>
			</head>
			<body>
				<h1>Marker sheet</h1>
				<p>Print at 100% scale on letter/A4 paper. Cut out and tape each marker so it is flush with the outer double ring.</p>
				<div class="grid">
					${O.map(K=>`
						<div class="marker">
							<h2>${K.key.toUpperCase()} • ID ${K.id}</h2>
							<img src="${K.dataUrl}" alt="Marker ${K.key}" />
						</div>
					`).join("")}
				</div>
				<footer>Tip: Keep markers flat, smooth, and unobstructed for best detection results.</footer>
			</body>
			</html>`;X.document.write(ne),X.document.close()}catch(O){console.error("Marker sheet generation failed",O),alert(`Unable to open marker sheet: ${(O==null?void 0:O.message)||O}`)}},[ge]),[ve,ze]=m.useState(null),de=m.useRef(!1),[re,Dt]=m.useState(null),nt=m.useRef(null),et=m.useCallback(O=>{nt.current=O,Dt(O)},[Dt]),[le,je]=m.useState(null),[ye,pe]=m.useState(Date.now()),[We,mt]=m.useState(!1),Oe=m.useRef(null),[$t,ht]=m.useState(""),[Pt,I]=m.useState(null),[ee,st]=m.useState(null),[yt,dn]=m.useState(!0),[Qt,rt]=m.useState([]),[Nt,xt]=m.useState(!1),[hn,vt]=m.useState(null),Zt=m.useRef(null);m.useEffect(()=>{const O=window.location.hostname;(O==="localhost"||O==="127.0.0.1")&&Gt("/api/hosts").then(X=>X.json()).then(X=>{const ne=Array.isArray(X==null?void 0:X.hosts)&&X.hosts.find(K=>K);ne&&I(ne)}).catch(()=>{}),Gt("/api/https-info").then(X=>X.json()).then(X=>{X&&typeof X.https=="boolean"&&st({https:!!X.https,port:Number(X.port)||8788})}).catch(()=>{})},[]);const Ft=m.useMemo(()=>{const O=re||"____",X="ws://localhost:8787";if(X.length>0)try{const we=new URL(X);return`${`${we.protocol==="wss:"?"https":"http"}://${we.host}${we.pathname.endsWith("/ws")?"":we.pathname}`.replace(/\/?ws$/i,"")}/mobile-cam.html?code=${O}`}catch{}const ne=Pt||window.location.hostname,K=!!(ee!=null&&ee.https),V=K?(ee==null?void 0:ee.port)||8788:8787;return`${K?"https":"http"}://${ne}:${V}/mobile-cam.html?code=${O}`},[re,Pt,ee]),$n=m.useMemo(()=>{if(!Ft)return null;try{const O=new URL(Ft);return O.searchParams.delete("code"),O.toString().replace(/\?$/,"")}catch{return typeof window<"u"?`${window.location.origin.replace(/\/$/,"")}/mobile-cam.html`:"/mobile-cam.html"}},[Ft]);m.useEffect(()=>{localStorage.setItem("ndn:cal:mode",d)},[d]),m.useEffect(()=>{if(!(typeof window>"u"))try{E?window.localStorage.setItem("ndn:cal:forceDesktop","1"):window.localStorage.removeItem("ndn:cal:forceDesktop")}catch{}},[E]),m.useEffect(()=>{if(typeof window>"u")return;const O=window.matchMedia("(pointer: coarse)"),X=()=>{const ne=typeof navigator<"u"&&/Android|iPhone|iPad|iPod|Mobi/i.test(navigator.userAgent),K=typeof O.matches=="boolean"?O.matches:!1,V=window.innerWidth<=820;P(ne||K||V)};X();try{typeof O.addEventListener=="function"?O.addEventListener("change",X):typeof O.addListener=="function"&&O.addListener(X)}catch{}return window.addEventListener("resize",X),()=>{try{typeof O.removeEventListener=="function"?O.removeEventListener("change",X):typeof O.removeListener=="function"&&O.removeListener(X)}catch{}window.removeEventListener("resize",X)}},[]),m.useEffect(()=>{if(!re){ht("");return}gl.toDataURL(Ft,{width:160,margin:1,color:{dark:"#000000",light:"#ffffff"}}).then(ht).catch(()=>ht(""))},[Ft,re]),m.useEffect(()=>{if(!le)return;const O=setInterval(()=>pe(Date.now()),1e3);return()=>clearInterval(O)},[le]);const F=m.useMemo(()=>le?Math.max(0,Math.ceil((le-ye)/1e3)):null,[le,ye]);m.useEffect(()=>()=>{Zt.current&&window.clearTimeout(Zt.current)},[]);const Ne=m.useCallback(async(O,X)=>{if(O)try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(O);else{const ne=document.createElement("textarea");ne.value=O,ne.style.position="fixed",ne.style.opacity="0",document.body.appendChild(ne),ne.focus(),ne.select(),document.execCommand("copy"),document.body.removeChild(ne)}vt(X),Zt.current&&window.clearTimeout(Zt.current),Zt.current=window.setTimeout(()=>vt(null),1500)}catch(ne){console.warn("[Calibrator] Copy failed:",ne),vt(null)}},[]);m.useEffect(()=>()=>Se(),[]);function ct(){if(ve&&ve.readyState===WebSocket.OPEN)return ve;const O="ws://localhost:8787",X=O.length>0?O.endsWith("/ws")?O:O.replace(/\/$/,"")+"/ws":void 0,K=`${window.location.protocol==="https:"?"wss":"ws"}://${window.location.host}/ws`,V=window.location.hostname,we=X||(V.endsWith("onrender.com")?K:"wss://ninedartnation.onrender.com/ws");console.log("[Calibrator] Connecting WebSocket to:",we);let at=new WebSocket(we);return ze(at),at}async function U(){g("phone"),He();try{Z(!0)}catch{}const O=ct();O.readyState===WebSocket.OPEN?O.send(JSON.stringify({type:"cam-create"})):O.onopen=()=>O.send(JSON.stringify({type:"cam-create"})),O.onerror=X=>{console.error("WebSocket connection error:",X),alert("Failed to connect to camera pairing service. Please check your internet connection and try again.")},O.onclose=X=>{if(console.log("WebSocket closed:",X.code,X.reason),Oe.current){try{Oe.current.close()}catch{}Oe.current=null}et(null),X.code!==1e3&&alert("Camera pairing connection lost. Please try pairing again.")},O.onmessage=async X=>{const ne=JSON.parse(X.data);if(ne.type==="cam-code")et(ne.code),ne.expiresAt&&je(ne.expiresAt);else if(ne.type==="cam-peer-joined"){!nt.current&&ne.code&&et(ne.code),mt(!0);const K=nt.current||ne.code||null;K&&(nt.current=K);try{if(te&&K){const De=t.current?{w:t.current.width,h:t.current.height}:null,we={H:N,imageSize:De,errorPx:_??null,createdAt:Date.now()};O.send(JSON.stringify({type:"cam-calibration",code:K,payload:we})),console.log("[Calibrator] Sent calibration to joined phone for code",K)}}catch(De){console.warn("[Calibrator] Failed to send calibration on peer join",De)}const V=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}],iceCandidatePoolSize:10});Oe.current=V,V.onconnectionstatechange=()=>{console.log("WebRTC connection state:",V.connectionState),V.connectionState==="failed"||V.connectionState==="disconnected"?(console.error("WebRTC connection failed"),alert("Camera connection lost. Please try pairing again."),Se()):V.connectionState==="connected"&&console.log("WebRTC connection established")},V.onicecandidate=De=>{De.candidate&&K&&O.send(JSON.stringify({type:"cam-ice",code:K,payload:De.candidate}))},V.ontrack=De=>{var we,at,Ye;if(console.log("[Calibrator] WebRTC ontrack received:",(we=De.streams)==null?void 0:we.length,"streams, track kind:",(at=De.track)==null?void 0:at.kind),e.current){const Te=(Ye=De.streams)==null?void 0:Ye[0];Te?(console.log("[Calibrator] Assigning video stream (tracks:",Te.getTracks().length,") to video element"),C(!1),setTimeout(()=>{e.current&&(console.log("[Calibrator] Setting srcObject and attempting play"),e.current.srcObject=Te,e.current.muted=!0,e.current.playsInline=!0,e.current.play().then(()=>{console.log("[Calibrator] Video playback started successfully"),l(!0),u("capture");try{ue(void 0,"Phone Camera",!0)}catch{}if(!$)try{Y(!0),de.current=!0}catch{}try{Z(!0)}catch{}o(!1)}).catch(kt=>{console.error("[Calibrator] Video play failed:",kt),o(!0),console.warn("[Calibrator] video play blocked — prompting user interaction")}))},100)):console.error("[Calibrator] No inbound stream received in ontrack")}else console.error("[Calibrator] Video element not available")};try{const De=await V.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!0});await V.setLocalDescription(De),console.log("[Calibrator] Sending cam-offer for code:",K),K?O.send(JSON.stringify({type:"cam-offer",code:K,payload:De})):console.warn("[Calibrator] Missing pairing code when sending offer")}catch(De){console.error("Failed to create WebRTC offer:",De),alert("Failed to establish camera connection. Please try again."),Se()}}else if(ne.type==="cam-answer"){console.log("[Calibrator] Received cam-answer");const K=Oe.current;if(K)try{await K.setRemoteDescription(new RTCSessionDescription(ne.payload)),console.log("[Calibrator] Remote description set (answer)")}catch(V){console.error("Failed to set remote description:",V),alert("Camera pairing failed. Please try again."),Se()}else console.warn("[Calibrator] Received cam-answer but no peer connection exists")}else if(ne.type==="cam-ice"){console.log("[Calibrator] Received cam-ice");const K=Oe.current;if(K)try{await K.addIceCandidate(ne.payload),console.log("[Calibrator] ICE candidate added")}catch(V){console.error("Failed to add ICE candidate:",V)}else console.warn("[Calibrator] Received ICE candidate but no peer connection exists")}else ne.type==="cam-error"&&(console.error("Camera pairing error:",ne.code),alert(ne.code==="EXPIRED"?"Code expired. Generate a new code.":`Camera error: ${ne.code||"Unknown error"}`),Se())}}async function H(){xt(!0);try{const O=await Wx();rt(O),O.length===0&&alert("No wifi scoring devices found on your network. Make sure devices are powered on and connected to the same network.")}catch(O){console.error("Wifi device discovery failed:",O),alert("Failed to discover wifi devices. Please check your network connection.")}finally{xt(!1)}u("camera")}async function me(O){try{rt(ne=>ne.map(K=>K.id===O.id?{...K,status:"connecting"}:K));const X=await Gx(O);if(X&&e.current)e.current.srcObject=X,await e.current.play(),l(!0),u("capture"),rt(ne=>ne.map(K=>K.id===O.id?{...K,status:"online"}:K));else throw new Error("Failed to get video stream")}catch(X){console.error("Failed to connect to wifi device:",X),alert(`Failed to connect to ${O.name}. Please check the device and try again.`),rt(ne=>ne.map(K=>K.id===O.id?{...K,status:"offline"}:K))}}async function be(){if(d==="phone")return U();if(d==="wifi")return H();try{console.log("[Calibrator] Attempting camera access...");const O={video:oe?{deviceId:{exact:oe}}:{facingMode:"environment"},audio:!1};console.log("[Calibrator] Camera constraints:",O);let X;try{X=await navigator.mediaDevices.getUserMedia(O),console.log("[Calibrator] Camera stream obtained:",X)}catch(ne){const K=ne&&(ne.name||ne.code)||"";if(console.warn("[Calibrator] Preferred camera not available:",ne),oe&&(K==="OverconstrainedError"||K==="NotFoundError"||K==="NotAllowedError"))X=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}),console.log("[Calibrator] Fallback camera stream obtained:",X);else throw ne}e.current?(e.current.srcObject=X,await e.current.play(),console.log("[Calibrator] Video playback started")):console.warn("[Calibrator] videoRef.current is null"),l(!0),u("capture")}catch(O){console.error("[Calibrator] Camera access failed:",O),alert(`Camera access failed: ${O instanceof Error?O.message:"Unknown error"}. Try refreshing the page or check camera permissions.`)}}function Se(){if(e.current&&e.current.srcObject&&(e.current.srcObject.getTracks().forEach(X=>X.stop()),e.current.srcObject=null,l(!1)),Oe.current){try{Oe.current.close()}catch{}Oe.current=null}if(et(null),je(null),mt(!1),ut(null),de.current){try{Y(!1)}catch{}de.current=!1}}function Be(){ve&&ve.readyState===WebSocket.OPEN?ve.send(JSON.stringify({type:"cam-create"})):U(),He()}function He(){try{$?de.current:(Y(!0),de.current=!0)}catch{}}function _e(){var O;try{(O=r.current)==null||O.click()}catch{}}function Ke(O){var K;const X=(K=O.target.files)==null?void 0:K[0];if(!X)return;const ne=new Image;ne.onload=()=>{try{if(!t.current)return;const V=t.current;V.width=ne.naturalWidth,V.height=ne.naturalHeight,V.getContext("2d").drawImage(ne,0,0,V.width,V.height),C(!0),b({w:V.width,h:V.height}),u("select"),y([]),ut(null),Se()}catch{}},ne.onerror=()=>{alert("Could not load image. Please try a different photo.")},ne.src=URL.createObjectURL(X);try{O.target.value=""}catch{}}function zt(){if(!e.current||!t.current)return;const O=e.current,X=t.current;X.width=O.videoWidth,X.height=O.videoHeight,X.getContext("2d").drawImage(O,0,0,X.width,X.height),C(!0),b({w:X.width,h:X.height}),u("select"),y([]),ut(null),ot&&setTimeout(()=>{Cs()},0)}function Lt(O=x,X=null){if(!t.current||!s.current)return;const ne=t.current,K=s.current;K.width=ne.width,K.height=ne.height;const V=K.getContext("2d");V.clearRect(0,0,K.width,K.height),O.forEach((we,at)=>{iw(V,we,"#f472b6"),V.save(),V.fillStyle="#f472b6",V.font="14px sans-serif",V.fillText(String(at+1),we.x+6,we.y-6),V.restore()});const De=X||N;if(De){const we=[Ge.bullInner,Ge.bullOuter,Ge.trebleInner,Ge.trebleOuter,Ge.doubleInner,Ge.doubleOuter];for(const at of we){const Ye=te?"#10b981":at===Ge.doubleOuter?"#22d3ee":"#a78bfa",Te=te||at===Ge.doubleOuter?3:2,kt=$x(De,at,360);zx(V,kt,Ye,Te)}}if(!De&&Ce){const we=(at,Ye,Te=2)=>{V.save(),V.strokeStyle=Ye,V.lineWidth=Te,V.beginPath(),V.arc(Ce.cx,Ce.cy,at,0,Math.PI*2),V.stroke(),V.restore()};we(Ce.doubleOuter,"#22d3ee",3),we(Ce.doubleInner,"#22d3ee",2),we(Ce.trebleOuter,"#fde047",2),we(Ce.trebleInner,"#fde047",2),we(Ce.bullOuter,"#34d399",2),we(Ce.bullInner,"#10b981",3)}if(L&&!te){V.save(),V.fillStyle="rgba(59,130,246,0.10)";const we=Math.round(Math.min(K.width,K.height)*.08),at=K.width-we*2,Ye=K.height-we*2;V.fillRect(we,we,at,Ye),V.strokeStyle="rgba(34,197,94,0.9)",V.lineWidth=2,V.beginPath(),V.moveTo(we,K.height/2),V.lineTo(K.width-we,K.height/2),V.stroke(),V.beginPath(),V.moveTo(K.width/2,we),V.lineTo(K.width/2,K.height-we),V.stroke(),V.strokeStyle="rgba(234,179,8,0.9)",V.setLineDash([6,4]);const Te=we+30,kt=we+30;V.beginPath(),V.moveTo(Te,kt+30),V.lineTo(Te+60,kt),V.stroke(),V.beginPath(),V.moveTo(K.width-Te,kt+30),V.lineTo(K.width-Te-60,kt),V.stroke(),V.restore(),V.save(),V.scale(1/h,1/h),V.fillStyle="rgba(255,255,255,0.85)",V.font="12px sans-serif",V.fillText("Tip: Frame board centered, edges parallel; slight top-down is okay. Keep bull near center.",we*h,(we+18)*h),V.restore()}}function sn(O){if(c!=="select")return;const X=O.target,ne=X.getBoundingClientRect(),K=O.clientX-ne.left,V=O.clientY-ne.top,De=X.width>0?X.width/ne.width:1,we=X.height>0?X.height/ne.height:1,at=K*De,Ye=V*we,Te=[...x,{x:at,y:Ye}];Te.length<=4&&(y(Te),Lt(Te))}function Ss(){const O=x.slice(0,-1);y(O),Lt(O)}function Mt(){if(!t.current||x.length===0)return;const O=dw(t.current,x,8);y(O),Lt(O)}function qs(){if(!t.current)return;if(x.length!==4)return alert("Please click 4 points: TOP, RIGHT, BOTTOM, LEFT corners of the double rim.");const O=Eu(),X=Bx(O,x);Lt(x,X);const ne=Fx(X,O,x);q({H:X,createdAt:Date.now(),errorPx:ne,imageSize:{w:t.current.width,h:t.current.height},anchors:{src:O,dst:x}}),u("computed")}function va(){y([]),C(!1),u("camera"),Lt([]),ut(null),G()}async function Cs(){if(!t.current)return alert("Load a photo or capture a frame first.");ut(null);const O=t.current,ne=Math.min(1,800/O.width),K=Math.max(1,Math.round(O.width*ne)),V=Math.max(1,Math.round(O.height*ne)),De=document.createElement("canvas");De.width=K,De.height=V;const we=De.getContext("2d");we.drawImage(O,0,0,K,V);const at=we.getImageData(0,0,K,V),Ye=new Float32Array(K*V);for(let Je=0,St=0;Je<at.data.length;Je+=4,St++){const fe=at.data[Je],Ct=at.data[Je+1],Rt=at.data[Je+2];Ye[St]=.299*fe+.587*Ct+.114*Rt}const Te=new Float32Array(K*V),kt=new Float32Array(K*V);for(let Je=1;Je<V-1;Je++)for(let St=1;St<K-1;St++){const fe=Je*K+St,Ct=Ye[fe-K-1],Rt=Ye[fe-K],bt=Ye[fe-K+1],Et=Ye[fe-1],qt=Ye[fe+1],kn=Ye[fe+K-1],pr=Ye[fe+K],Xs=Ye[fe+K+1];Te[fe]=-Ct-2*Et-kn+(bt+2*qt+Xs),kt[fe]=-Ct-2*Rt-bt+(kn+2*pr+Xs)}const rn=new Float32Array(K*V);let At=1;for(let Je=0;Je<rn.length;Je++){const St=Math.hypot(Te[Je],kt[Je]);rn[Je]=St,St>At&&(At=St)}const jn=Math.floor(K/2),pn=Math.floor(V/2),Bs=Math.floor(Math.min(K,V)*.35),Yn=Math.floor(Math.min(K,V)*.52);let an={score:-1,cx:jn,cy:pn,r:Math.floor((Bs+Yn)/2)};const xn=Math.max(2,Math.floor(Math.min(K,V)*.01)),$s=Math.max(2,Math.floor(Math.min(K,V)*.01));for(let Je=pn-Math.floor(V*.08);Je<=pn+Math.floor(V*.08);Je+=xn)for(let St=jn-Math.floor(K*.08);St<=jn+Math.floor(K*.08);St+=xn)for(let fe=Bs;fe<=Yn;fe+=$s){let Ct=0;const Rt=360;for(let bt=0;bt<Rt;bt++){const Et=bt*Math.PI/180,qt=Math.round(St+fe*Math.cos(Et)),kn=Math.round(Je+fe*Math.sin(Et));qt<=0||qt>=K-1||kn<=0||kn>=V-1||(Ct+=rn[kn*K+qt])}Ct>an.score&&(an={score:Ct,cx:St,cy:Je,r:fe})}const Le=1/ne,Ln=an.cx*Le,pt=an.cy*Le,Nn=an.r*Le;function Fn(Je){let St=0;const fe=Je*ne,Ct=360;for(let Rt=0;Rt<Ct;Rt++){const bt=Rt*Math.PI/180,Et=Math.round(an.cx+fe*Math.cos(bt)),qt=Math.round(an.cy+fe*Math.sin(bt));Et<=0||Et>=K-1||qt<=0||qt>=V-1||(St+=rn[qt*K+Et])}return St}const en={bullInner:Ge.bullInner/Ge.doubleOuter,bullOuter:Ge.bullOuter/Ge.doubleOuter,trebleInner:Ge.trebleInner/Ge.doubleOuter,trebleOuter:Ge.trebleOuter/Ge.doubleOuter,doubleInner:Ge.doubleInner/Ge.doubleOuter};function os(Je,St=.08){const fe=Math.max(1,Math.floor(Je*(1-St))),Ct=Math.max(fe+1,Math.floor(Je*(1+St)));let Rt=fe,bt=-1;for(let Et=fe;Et<=Ct;Et++){const qt=Fn(Et);qt>bt&&(bt=qt,Rt=Et)}return Rt}const lt=Nn,Es=os(lt*en.doubleInner),cs=os(lt*en.trebleOuter),An=os(lt*en.trebleInner),Fs=os(lt*en.bullOuter),Xn=os(lt*en.bullInner);Ee({cx:Ln,cy:pt,bullInner:Xn,bullOuter:Fs,trebleInner:An,trebleOuter:cs,doubleInner:Es,doubleOuter:lt});const gn=Je=>{let fe=0;for(let Ct=0;Ct<180;Ct++){const Rt=Ct*Math.PI/90,bt=Math.round(an.cx+Je*ne*Math.cos(Rt)),Et=Math.round(an.cy+Je*ne*Math.sin(Rt));bt<=0||bt>=K-1||Et<=0||Et>=V-1||(fe+=rn[Et*K+bt])}return fe/180},Rn=(gn(an.r)+gn(cs)+gn(An)+gn(Es)+gn(Fs)+gn(Xn))/(At*6),ds=Math.max(0,Math.min(1,Rn)),qr=Math.min(ds,Math.min(gn(an.r)/At,gn(cs)/At,gn(An)/At,gn(Es)/At,gn(Fs)/At,gn(Xn)/At));ft(Math.round(qr*100));const Qn=[{x:Ln,y:pt-lt},{x:Ln+lt,y:pt},{x:Ln,y:pt+lt},{x:Ln-lt,y:pt}];y(Qn),Lt(Qn);try{qs()}catch{}const us=qr>=.95;q({locked:us})}function Jr(){if(!t.current)return alert("Capture a frame or upload a photo first.");const O=yw(t.current);if(ut(O),!O.success||!O.homography){const V=O.missing.length?` Missing markers: ${O.missing.map(De=>`${De.toUpperCase()} (ID ${gs[De]})`).join(", ")}`:"";alert(O.message?`${O.message}${V}`:`Marker detection failed.${V}`);return}Ee(null),y(O.points),Lt(O.points,O.homography);const X=Eu(),ne={w:t.current.width,h:t.current.height},K=(O.errorPx??Number.POSITIVE_INFINITY)<=1.2;q({H:O.homography,createdAt:Date.now(),errorPx:O.errorPx??null,imageSize:ne,anchors:{src:X,dst:O.points},locked:K?!0:te}),u("computed")}m.useEffect(()=>{Lt()},[v,N]),m.useEffect(()=>{if(!ot||!a)return;let O=0;const X=()=>{try{zt()}catch{}O=requestAnimationFrame(X)};return O=requestAnimationFrame(X),()=>cancelAnimationFrame(O)},[ot,a]),m.useEffect(()=>{(async()=>{try{if(!te||!re)return;const O=t.current?{w:t.current.width,h:t.current.height}:null,X=JSON.stringify({H:N,anchors:null,imageSize:O,errorPx:_??null});try{await Gt(`/cam/calibration/${re}`,{method:"POST",headers:{"Content-Type":"application/json"},body:X}),console.log("[Calibrator] Posted calibration for code",re)}catch(ne){console.warn("[Calibrator] Upload calibration failed",ne)}try{const ne=localStorage.getItem("authToken");ne&&(await Gt("/api/user/calibration",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ne}`},body:X}),console.log("[Calibrator] Synced calibration to user account"))}catch(ne){console.warn("[Calibrator] User calibration sync failed",ne)}}catch{}})()},[te,re]);function wn(){var $s,Le,Ln;const{preferredCameraId:O,preferredCameraLabel:X,setPreferredCamera:ne,cameraEnabled:K,setCameraEnabled:V,preferredCameraLocked:De,setPreferredCameraLocked:we}=ss(),[at,Ye]=m.useState([]),[Te,kt]=m.useState(""),[rn,At]=m.useState(!1),jn=m.useRef(null),pn=document.getElementById("dropdown-portal-root")||(()=>{const pt=document.createElement("div");return pt.id="dropdown-portal-root",document.body.appendChild(pt),pt})();async function Bs(){kt("");try{try{await navigator.mediaDevices.getUserMedia({video:!0})}catch{}const Nn=(await navigator.mediaDevices.enumerateDevices()).filter(Fn=>Fn.kind==="videoinput");Ye(Nn)}catch{kt("Unable to list cameras. Grant camera permission in your browser.")}}m.useEffect(()=>{Bs()},[]),m.useEffect(()=>{function pt(Nn){jn.current&&!jn.current.contains(Nn.target)&&At(!1)}return document.addEventListener("mousedown",pt),()=>document.removeEventListener("mousedown",pt)},[]);const Yn=at.find(pt=>pt.deviceId===O),an=Yn?`${Yn.label||"Camera"}`:O?"Camera (unavailable)":"Auto (browser default)",xn=O&&!Yn;return n.jsxs("div",{className:"mt-3 p-3 rounded-lg border border-indigo-500/30 bg-indigo-500/5",children:[n.jsx("div",{className:"font-semibold mb-2",children:"Select camera device"}),Te&&n.jsx("div",{className:"text-rose-400 text-sm mb-2",children:Te}),xn&&n.jsxs("div",{className:"text-amber-400 text-sm mb-2",children:["Selected camera is no longer available.",n.jsx("button",{className:"underline ml-1",onClick:()=>ne(void 0,"",!0),disabled:a,children:"Use auto-selection"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[De?n.jsx("div",{className:"text-xs text-emerald-400",children:"🔒 Camera selection locked"}):n.jsx("div",{className:"text-xs text-slate-400",children:"Camera selection unlocked"}),n.jsx("button",{className:"btn btn--ghost px-2 py-0.5 text-xs ml-2",onClick:()=>{de.current=!1,we(!De)},children:De?"Unlock":"Lock"})]}),n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("input",{type:"checkbox",id:"cameraEnabled-calibrator",checked:K,onChange:pt=>V(pt.target.checked),className:"w-4 h-4",disabled:a}),n.jsx("label",{htmlFor:"cameraEnabled-calibrator",className:"text-sm",children:"Enable camera for scoring"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center text-sm",children:[n.jsxs("div",{className:"col-span-2 relative",ref:jn,children:[n.jsxs("div",{className:`input w-full flex items-center justify-between cursor-pointer ${a?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!a&&At(!rn),children:[n.jsx("span",{className:"truncate",children:an}),n.jsx("svg",{className:`w-4 h-4 transition-transform ${rn?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),rn&&!a&&Zv.createPortal(n.jsx("div",{className:"fixed left-0 top-0 w-full h-full z-[9999]",style:{pointerEvents:"none"},children:n.jsx("div",{className:"absolute",style:{left:(($s=jn.current)==null?void 0:$s.getBoundingClientRect().left)||0,top:((Le=jn.current)==null?void 0:Le.getBoundingClientRect().bottom)||0,width:((Ln=jn.current)==null?void 0:Ln.offsetWidth)||240,pointerEvents:"auto"},children:n.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[n.jsx("div",{className:"px-3 py-2 hover:bg-slate-700 cursor-pointer text-sm",onClick:()=>{ne(void 0,"",!0)},children:"Auto (browser default)"}),at.map(pt=>{const Nn=`${pt.label||"Camera"}`;return n.jsx("div",{className:"px-3 py-2 hover:bg-slate-700 cursor-pointer text-sm",onClick:()=>{ne(pt.deviceId,pt.label||"",!0)},children:Nn},pt.deviceId)}),n.jsx("div",{className:"px-3 py-2 hover:bg-slate-700 cursor-pointer text-sm text-indigo-400",onClick:()=>{g("phone"),u("camera"),l(!1),C(!1)},children:"📱 Phone Camera"},"phone-camera"),n.jsx("div",{className:"px-3 py-2 text-right",children:n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>At(!1),children:"Close"})})]})})}),pn)]}),n.jsx("div",{className:"text-right",children:n.jsx("button",{className:"btn px-2 py-1",onClick:Bs,disabled:a,children:"Refresh"})})]}),X&&n.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["Selected: ",X]}),n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Tip: All camera technology is supported for autoscoring needs—select your camera here and then open Calibrator to align."})]})}if(S&&!E){const O=$n??(typeof window<"u"?`${window.location.origin.replace(/\/$/,"")}/mobile-cam.html`:"/mobile-cam.html");return n.jsxs("div",{className:"mx-auto flex min-h-[calc(100vh-140px)] w-full max-w-xl flex-col justify-center gap-6 p-6",children:[n.jsxs("div",{className:"space-y-5 rounded-3xl border border-indigo-400/30 bg-slate-900/70 p-6 text-slate-100 shadow-xl",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300",children:"Mobile camera"}),n.jsx("h2",{className:"text-2xl font-semibold leading-tight text-white",children:"This device is ready to stream as your dartboard camera"}),n.jsx("p",{className:"text-sm text-slate-200/80",children:"Open the lightweight mobile camera page to stream video to your desktop calibrator. You can still come back here if you need the full desktop tools."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("a",{href:O,className:"btn w-full justify-center px-4 py-2 text-base",children:"Open mobile camera"}),n.jsx("button",{type:"button",className:"btn btn--ghost w-full justify-center px-4 py-2 text-sm",onClick:()=>Ne(O,"link"),children:hn==="link"?"Link copied!":"Copy link"})]}),n.jsxs("p",{className:"text-xs text-slate-300/70",children:["On a desktop, open Calibrator and generate a pairing code. Then tap ",n.jsx("span",{className:"font-semibold",children:"Pair with Desktop"})," from the mobile camera page to connect this device."]})]}),n.jsx("button",{type:"button",className:"self-center text-xs font-medium text-indigo-200 underline decoration-dotted decoration-indigo-300/70 transition hover:text-indigo-100",onClick:()=>p(!0),children:"Continue to desktop calibrator"})]})}return n.jsxs("div",{className:"space-y-6",children:[S&&E&&n.jsx("div",{className:"rounded-2xl border border-indigo-400/30 bg-indigo-500/10 p-4 text-sm text-indigo-100",children:n.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[n.jsx("p",{className:"leading-relaxed",children:"Using a phone? Switch back to the streamlined mobile camera interface for an easier pairing flow."}),n.jsx("button",{type:"button",className:"btn btn--ghost px-3 py-1 text-xs",onClick:()=>p(!1),children:"Open mobile camera mode"})]})}),n.jsxs("div",{className:"card space-y-6 p-6",children:[n.jsxs("header",{className:"flex flex-wrap items-start justify-between gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300",children:"Marker calibration"}),n.jsx("h2",{className:"text-2xl font-semibold leading-tight text-white",children:"Align your board with the autoscoring overlay"}),n.jsx("p",{className:"max-w-2xl text-sm opacity-80",children:"Place the printable fiducial markers around the double ring, capture a clear frame, and let the calibrator compute a precise homography."})]}),n.jsxs("div",{className:"flex flex-col items-end gap-2 text-xs font-medium",children:[n.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-indigo-400/50 bg-indigo-500/10 px-3 py-1",children:[n.jsx("span",{className:"opacity-60",children:"Mode"}),n.jsx("span",{children:d==="local"?"Desktop camera":d==="phone"?"Phone camera":"Wifi device"})]}),n.jsxs("span",{className:`inline-flex items-center gap-2 rounded-full border px-3 py-1 ${a?"border-emerald-400/60 bg-emerald-500/10 text-emerald-100":"border-white/20 bg-white/5 text-slate-200"}`,children:[n.jsx("span",{className:`h-2 w-2 rounded-full ${a?"bg-emerald-400":"bg-slate-400"}`}),a?"Live stream active":"Stream idle"]}),te?n.jsx("span",{className:"inline-flex items-center gap-2 rounded-full border border-emerald-400/60 bg-emerald-500/10 px-3 py-1 text-emerald-100",children:n.jsxs("span",{children:["Locked • ",_!=null?`${_.toFixed(2)}px error`:"ready"]})}):n.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-amber-400/40 bg-amber-500/10 px-3 py-1 text-amber-100",children:[n.jsx("span",{children:"Not locked"}),_!=null&&n.jsxs("span",{children:["• ",_.toFixed(2),"px"]})]})]})]}),n.jsxs("section",{className:"rounded-2xl border border-indigo-500/30 bg-indigo-500/5 p-5",children:[n.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wide text-indigo-200",children:"Marker kit"}),n.jsx("p",{className:"mt-1 text-sm opacity-80",children:"Print the fiducials, tape them flush with the outer double ring, then capture a clear frame before running detection."})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn px-3 py-1.5",onClick:Tt,children:"Open printable sheet"}),n.jsx("button",{className:"btn btn--ghost px-3 py-1.5",onClick:()=>ut(null),children:"Clear marker status"})]})]}),n.jsxs("ol",{className:"mt-3 list-decimal list-inside space-y-2 text-sm opacity-75",children:[n.jsx("li",{children:"Print and cut out the four markers. Place them on the top, right, bottom, and left edges of the double ring."}),n.jsx("li",{children:"Start your camera or upload a still frame with the full board visible and the markers unobstructed."}),n.jsxs("li",{children:["Run ",n.jsx("strong",{children:"Auto detect"})," for circle fitting or ",n.jsx("strong",{children:"Detect markers"})," for fiducials, then lock calibration when error ≤ 1.2px."]})]})]}),n.jsxs("div",{className:"grid gap-6 xl:grid-cols-[minmax(0,2fr)_minmax(320px,1fr)]",children:[n.jsxs("section",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-4 rounded-2xl border border-white/10 bg-black/40 p-4",children:[n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 text-xs",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("span",{className:"uppercase tracking-wide opacity-60",children:"Video source"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{className:`btn px-3 py-1 ${d==="local"?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-600"}`,onClick:()=>{g("local"),Se()},title:"Use local camera",children:"Local"}),n.jsx("button",{className:`btn px-3 py-1 ${d==="phone"?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-600"}`,onClick:()=>{g("phone"),Se()},title:"Pair phone camera",children:"Phone"}),n.jsx("button",{className:`btn px-3 py-1 ${d==="wifi"?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-600"}`,onClick:()=>{g("wifi"),Se(),H()},title:"Discover wifi/USB autoscoring devices",children:"Wifi"})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"opacity-70",children:"Zoom"}),n.jsx("input",{type:"range",min:50,max:200,step:5,value:Math.round((h||1)*100),onChange:O=>w(Math.max(.5,Math.min(2,Number(O.target.value)/100)))}),n.jsxs("span",{className:"w-12 text-right",children:[Math.round((h||1)*100),"%"]})]}),n.jsx("button",{className:"btn px-3 py-1",onClick:()=>w(1),children:"Actual"})]})]}),n.jsxs("div",{className:"relative w-full overflow-hidden rounded-2xl border border-indigo-400/30 bg-black",style:{aspectRatio:D?`${D.w} / ${D.h}`:"16 / 9"},children:[(!a||!We)&&n.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-gradient-to-br from-black/40 to-black/10",children:n.jsx(i1,{calibrationComplete:c==="computed"})}),n.jsxs("div",{className:"absolute inset-0",style:{transform:`scale(${h||1})`,transformOrigin:"center center"},children:[n.jsx("video",{ref:e,onLoadedMetadata:O=>{try{const X=O.currentTarget;X.videoWidth&&X.videoHeight&&b({w:X.videoWidth,h:X.videoHeight})}catch{}},className:`absolute inset-0 h-full w-full object-cover transition-opacity duration-300 ${v?"opacity-0 -z-10":"opacity-100 z-10"}`,autoPlay:!0,playsInline:!0,muted:!0,controls:!1}),i&&n.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur",children:n.jsx("button",{className:"rounded-lg bg-white px-4 py-2 font-semibold text-slate-900 shadow-lg",onClick:async()=>{var O;try{await((O=e.current)==null?void 0:O.play()),o(!1),l(!0),u("capture")}catch(X){console.warn("Tap-to-play retry failed",X),alert("Tap to enable video failed. Please check browser settings or reload the page.")}},children:"Tap to allow video"})}),n.jsx("canvas",{ref:t,className:`absolute inset-0 h-full w-full transition-opacity duration-300 ${v?"opacity-100 z-10":"opacity-0 -z-10"}`}),n.jsx("canvas",{ref:s,onClick:sn,className:"absolute inset-0 z-30 h-full w-full cursor-crosshair"})]})]}),n.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[n.jsx("input",{type:"checkbox",className:"accent-indigo-600",checked:L,onChange:O=>Q(O.target.checked)}),"Show preferred-view guide overlay"]})]}),n.jsxs("div",{className:"grid grid-cols-1 gap-3 text-xs sm:grid-cols-3",children:[n.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-2",children:[n.jsx("div",{className:"uppercase tracking-wide opacity-60",children:"Phase"}),n.jsx("div",{className:"text-sm font-semibold capitalize",children:c})]}),n.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-2",children:[n.jsx("div",{className:"uppercase tracking-wide opacity-60",children:"Points selected"}),n.jsxs("div",{className:"text-sm font-semibold",children:[x.length," / 4"]})]}),n.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 px-3 py-2",children:[n.jsx("div",{className:"uppercase tracking-wide opacity-60",children:"Fit error"}),n.jsx("div",{className:"text-sm font-semibold",children:_!=null?`${_.toFixed(2)} px`:"—"})]})]})]}),n.jsxs("aside",{className:"space-y-4",children:[n.jsx(wn,{}),n.jsxs("section",{className:"space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold",children:"Step 1 · Capture image"}),n.jsx("p",{className:"text-xs opacity-70",children:"Start your preferred camera or upload a static photo of the board."})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:a?n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:Se,children:"Stop camera"}),n.jsx("button",{className:"btn",onClick:zt,disabled:!a,children:"Capture frame"})]}):n.jsxs(n.Fragment,{children:[d==="local"&&n.jsx("button",{className:"btn",onClick:be,children:"Start camera"}),d==="phone"&&n.jsx("button",{className:"btn",onClick:U,children:"Pair phone camera"}),d==="wifi"&&n.jsx("button",{className:"btn",onClick:H,children:"Connect wifi camera"})]})}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("input",{ref:r,type:"file",accept:"image/*",className:"hidden",onChange:Ke}),n.jsx("button",{className:"btn",onClick:_e,children:"Upload photo"})]})]}),n.jsxs("section",{className:"space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold",children:"Step 2 · Detect markers"}),n.jsx("p",{className:"text-xs opacity-70",children:"Use fiducials or auto-detect to seed the rim points."})]}),n.jsxs("span",{className:`inline-flex items-center gap-2 rounded-full border px-3 py-1 text-[11px] ${Ze>=85?"border-emerald-400/60 bg-emerald-500/10 text-emerald-100":"border-white/20 bg-white/5 text-slate-200"}`,children:[n.jsx("span",{className:"opacity-70",children:"Confidence"}),n.jsxs("span",{children:[Ze,"%"]})]})]}),n.jsxs("label",{className:"inline-flex items-center gap-2 text-xs",children:[n.jsx("input",{type:"checkbox",className:"accent-indigo-600",checked:ot,onChange:O=>he(O.target.checked)}),"Live auto-detect while streaming"]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn",disabled:!v,onClick:Cs,children:"Auto detect"}),n.jsx("button",{className:"btn",disabled:!v,onClick:Jr,children:"Detect markers"})]}),Ae&&n.jsx("div",{className:`rounded-lg border px-3 py-2 text-xs ${Ae.success?"bg-emerald-500/10 border-emerald-500/30 text-emerald-100":"bg-rose-500/10 border-rose-500/30 text-rose-100"}`,children:Ae.success?n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{children:["Detected markers → board anchors:"," ",Ph.map(O=>{var ne;const X=(ne=Ae.assignments)==null?void 0:ne[O];return`${O.toUpperCase()}→${X?`ID ${X.id}`:"—"}`}).join(", ")]}),Ae.errorPx!=null&&n.jsxs("div",{children:["RMS error: ",Ae.errorPx.toFixed(2)," px"]}),n.jsxs("div",{className:"opacity-80",children:["Markers correspond to IDs TOP ",gs.top,", RIGHT ",gs.right,", BOTTOM ",gs.bottom,", LEFT ",gs.left,"."]})]}):n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{children:Ae.message||"Unable to detect all markers."}),Ae.missing.length>0&&n.jsxs("div",{children:["Missing: ",Ae.missing.map(O=>`${O.toUpperCase()} (ID ${gs[O]})`).join(", ")]})]})})]}),n.jsxs("section",{className:"space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold",children:"Step 3 · Align & lock"}),n.jsx("p",{className:"text-xs opacity-70",children:"Click points in TOP → RIGHT → BOTTOM → LEFT order, refine edges, then lock the calibration."})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn",disabled:x.length!==4,onClick:qs,children:"Compute"}),n.jsx("button",{className:`btn ${te?"bg-emerald-600 hover:bg-emerald-700":""}`,onClick:()=>q({locked:!te}),children:te?"Unlock":"Lock in"})]}),te&&n.jsxs("div",{className:"text-xs opacity-75",children:["Calibration saved ",_!=null?`· error ${_.toFixed(2)} px`:""]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn",disabled:x.length===0,onClick:Ss,children:"Undo"}),n.jsx("button",{className:"btn",disabled:x.length===0,onClick:Mt,children:"Refine points"}),n.jsx("button",{className:"btn",onClick:va,children:"Reset"})]})]})]})]}),d==="phone"&&!a&&n.jsxs("div",{className:"space-y-2 rounded-2xl border border-indigo-400/30 bg-black/40 p-4 text-xs text-white",children:[n.jsx("div",{className:"font-semibold",children:"Phone pairing"}),n.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 transition flex items-center gap-2",onClick:()=>Ne(Ft,"link"),title:"Copy mobile camera link",children:[n.jsx("span",{className:"flex-1 min-w-0 font-mono break-all text-[11px]",children:Ft}),n.jsx("span",{className:"text-[10px] uppercase tracking-wide whitespace-nowrap text-emerald-200",children:hn==="link"?"Copied!":"Copy link"})]}),n.jsx("div",{className:"flex items-center gap-2 text-[11px]",children:n.jsx("a",{href:Ft,target:"_blank",rel:"noreferrer",className:"underline decoration-dotted text-indigo-200 hover:text-indigo-100 transition",children:"Open link in new tab"})}),n.jsxs("div",{className:"opacity-80",children:["WS: ",ve?ve.readyState===1?"open":ve.readyState===0?"connecting":ve.readyState===2?"closing":"closed":"not started"," · ",ee!=null&&ee.https?"HTTPS on":"HTTP only"]}),re&&n.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 transition flex items-center justify-between gap-2",onClick:()=>Ne(re,"code"),title:"Copy pairing code",children:[n.jsx("span",{className:"font-mono tracking-[0.3em] text-sm",children:re}),n.jsx("span",{className:"text-[10px] uppercase tracking-wide whitespace-nowrap text-emerald-200",children:hn==="code"?"Copied!":"Copy code"})]}),$t&&n.jsx("img",{className:"mt-1 h-40 w-40 rounded bg-white",alt:"Scan to open",src:$t}),n.jsxs("div",{className:"flex items-center gap-2",children:[F!==null&&n.jsxs("span",{children:["Expires in ",F,"s"]}),n.jsx("button",{className:"btn px-2 py-1 text-xs",onClick:Be,children:"Regenerate"})]}),yt&&n.jsxs("div",{className:"space-y-2 rounded-lg border border-slate-700/50 bg-slate-900/60 p-3 text-slate-200",children:[n.jsx("div",{className:"font-semibold",children:"Troubleshooting"}),n.jsxs("ul",{className:"list-disc space-y-1 pl-4",children:[n.jsx("li",{children:"Phone and desktop must be on the same Wi‑Fi network."}),n.jsxs("li",{children:["Allow the server through your firewall (ports 8787 and ",ee!=null&&ee.https?ee.port:8788,")."]}),n.jsx("li",{children:"On iPhone, use HTTPS links (QR will prefer HTTPS when enabled)."})]}),n.jsx("div",{className:"text-right",children:n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>dn(!1),children:"Hide tips"})})]})]}),d==="wifi"&&!a&&n.jsxs("div",{className:"space-y-3 rounded-2xl border border-indigo-400/30 bg-black/40 p-4 text-xs text-white",children:[n.jsx("div",{className:"font-semibold",children:"Wifi scoring devices"}),Nt?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-white"}),n.jsx("span",{children:"Scanning network for devices…"})]}):Qt.length>0?n.jsxs("div",{className:"space-y-2",children:[Qt.map(O=>n.jsxs("div",{className:"flex items-center justify-between rounded border border-slate-700/50 bg-slate-900/60 p-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:O.name}),n.jsxs("div",{className:"opacity-70",children:[O.ip,":",O.port," · ",O.type.toUpperCase()]}),n.jsxs("div",{className:"opacity-70 text-xs",children:["Capabilities: ",O.capabilities.join(", ")]})]}),n.jsx("button",{className:`btn px-2 py-1 text-xs ${O.status==="connecting"?"bg-yellow-600":O.status==="online"?"bg-green-600":"bg-blue-600"}`,onClick:()=>me(O),disabled:O.status==="connecting",children:O.status==="connecting"?"Connecting…":"Connect"})]},O.id)),n.jsx("div",{className:"text-center",children:n.jsx("button",{className:"btn px-2 py-1 text-xs",onClick:H,children:"Rescan network"})})]}):n.jsxs("div",{className:"space-y-2 text-center",children:[n.jsx("div",{children:"No wifi scoring devices found."}),n.jsx("div",{className:"opacity-70",children:"Ensure your wifi cameras are powered on and on the same network."}),n.jsx("button",{className:"btn px-2 py-1 text-xs",onClick:H,children:"Scan again"})]})]})]})]})}const Iw=["D1","D2","D3","D4","D5","D6","D7","D8","D9","D10","D11","D12","D13","D14","D15","D16","D17","D18","D19","D20","DB"];function Dw(e){return e==="DB"?50:Number(e.slice(1))*2}function Pw(e){return Iw.includes(e)?Dw(e):32}function ic(e,t="D16"){if(e>170||e<=1)return[];const s={170:["T20 T20 DB"],167:["T20 T19 DB"],164:["T20 T18 DB"],161:["T20 T17 DB"],160:["T20 T20 D20"],158:["T20 T20 D19"],157:["T20 T19 D20"],156:["T20 T20 D18"],155:["T20 T19 D19"],154:["T20 T18 D20"],153:["T20 T19 D18"],152:["T20 T20 D16"],151:["T20 T17 D20"],150:["T20 T18 D18"],149:["T20 T19 D16"],148:["T20 T16 D20"],147:["T20 T17 D18"],146:["T20 T18 D16"],145:["T20 T15 D20"],144:["T20 T20 D12"],141:["T20 T19 D12"],140:["T20 T20 D10"],137:["T20 T19 D10"],136:["T20 T20 D8"],132:["BULL T14 D20","T20 T12 D8"],130:["T20 T20 D5","T20 T18 D8"],129:["T19 T16 D12"],128:["T18 T14 D16"],127:["T20 T17 D8"],126:["T19 T19 D6"],121:["T20 11 D20","T20 T15 D8"],120:["T20 20 D20","T20 S20 D20"],110:["T20 10 D20"],100:["T20 D20"],99:["T19 10 D16","T19 S10 D16"],97:["T19 D20"],96:["T20 D18"],95:["T19 D19"],94:["T18 D20"],92:["T20 D16"],90:["T18 D18","T20 D15"],86:["T18 D16"],84:["T20 D12","T16 D18"],82:["BULL D16","T14 D20"],81:["T19 D12"],80:["T20 D10","D20 D20"],78:["T18 D12"],76:["T20 D8","T16 D14"],74:["T14 D16","T18 D10"],72:["T16 D12","T20 D6"],70:["T18 D8","S20 BULL"],68:["T20 D4","T16 D10"],66:["T10 D18","T14 D12"],64:["T16 D8","D16 D16"],62:["T10 D16","T12 D13"],60:["20 D20","S20 D20"],58:["18 D20","S18 D20"],56:["16 D20","S16 D20"],54:["14 D20","S14 D20"],52:["20 D16","S20 D16"],50:["BULL","10 D20"],48:["16 D16","S16 D16"],46:["14 D16"],44:["12 D16"],42:["10 D16"],40:["D20"],38:["D19"],36:["D18"],34:["D17"],32:["D16"],30:["D15"],28:["D14"],26:["D13"],24:["D12"],22:["D11"],20:["D10"],18:["D9"],16:["D8"],14:["D7"],12:["D6"],10:["D5"],8:["D4"],6:["D3"],4:["D2"],2:["D1"]};if(s[e])return s[e];const r=Pw(t),a=[];for(const l of[60,57,54,51,48])if(e-l===r){a.push(`T${l/3} ${t}`);break}if(!a.length){for(const l of[20,19,18,17,16,15])if(e-l===r){a.push(`${l} ${t}`);break}}return a}function Po(e,t,s,r,a){try{const l=window.speechSynthesis;if(!l)return;const i=new SpeechSynthesisUtterance,o=s<=170&&s>0;if(a!=null&&a.checkoutOnly&&!o)return;if(i.text=o?`${e}, you have ${s} remaining.`:`${t}`,r){const c=l.getVoices().find(u=>u.name===r);c&&(i.voice=c)}typeof(a==null?void 0:a.volume)=="number"&&(i.volume=Math.max(0,Math.min(1,a.volume))),i.rate=1,i.pitch=1,l.speak(i)}catch{}}function oc({label:e,autoStart:t=!1,scale:s,className:r,aspect:a="inherit",style:l,fill:i=!1}){const o=m.useRef(null),[c,u]=m.useState(!1),[d,g]=m.useState(null),[x,y]=m.useState(null),[v,C]=m.useState(null),[D,b]=m.useState(()=>localStorage.getItem("ndn:camera:mode")||"local"),[h,w]=m.useState(null),[E,p]=m.useState(Date.now()),[S,P]=m.useState(!1),[N,q]=m.useState(null),[G,_]=m.useState(null),[te,L]=m.useState(!0),[Q,oe]=m.useState([]),[R,Z]=m.useState(!1),[$,Y]=m.useState([]),[ue,Ce]=m.useState(!1),Ee=ss(le=>le.autoscoreProvider),ot=ss(le=>le.setPreferredCameraLocked);if(Ee==="manual"){const je=[i?"rounded-2xl overflow-hidden bg-black w-full flex flex-col":"rounded-2xl overflow-hidden bg-black w-full mx-auto",r].filter(Boolean).join(" ").trim(),ye={...l||{}};return!i&&ye.aspectRatio===void 0&&ye.height===void 0&&ye.minHeight===void 0&&(ye.aspectRatio="4 / 3"),n.jsx("div",{className:je,style:ye,children:n.jsx("div",{className:"flex-1 w-full h-full flex items-center justify-center bg-slate-900 text-slate-200 text-xs p-4 text-center",children:"Manual scoring mode active — camera feeds are disabled."})})}m.useEffect(()=>{const le=window.location.hostname;(le==="localhost"||le==="127.0.0.1")&&Gt("/api/hosts").then(je=>je.json()).then(je=>{const ye=Array.isArray(je==null?void 0:je.hosts)&&je.hosts.find(pe=>pe);ye&&q(ye)}).catch(()=>{}),Gt("/api/https-info").then(je=>je.json()).then(je=>{je&&typeof je.https=="boolean"&&_({https:!!je.https,port:Number(je.port)||8788})}).catch(()=>{})},[]);const he=m.useMemo(()=>{const le=x||"____",je="ws://localhost:8787";if(je.length>0)try{const Oe=new URL(je);return`${`${Oe.protocol==="wss:"?"https":"http"}://${Oe.host}${Oe.pathname.endsWith("/ws")?"":Oe.pathname}`.replace(/\/?ws$/i,"")}/mobile-cam.html?code=${le}`}catch{}const ye=N||window.location.hostname,pe=!!(G!=null&&G.https),We=pe?(G==null?void 0:G.port)||8788:8787;return`${pe?"https":"http"}://${ye}:${We}/mobile-cam.html?code=${le}`},[x,N,G]);m.useEffect(()=>{localStorage.setItem("ndn:camera:mode",D)},[D]);const[Ze,ft]=m.useState("");m.useEffect(()=>{if(!x){ft("");return}gl.toDataURL(he,{width:160,margin:1,color:{dark:"#000000",light:"#ffffff"}}).then(ft).catch(()=>ft(""))},[he,x]),m.useEffect(()=>{if(!h)return;const le=setInterval(()=>p(Date.now()),1e3);return()=>clearInterval(le)},[h]);const Ae=m.useMemo(()=>h?Math.max(0,Math.ceil((h-E)/1e3)):null,[h,E]);m.useEffect(()=>{t?ut().catch(()=>{}):ge()},[t]);async function ut(){if(D==="wifi")return Tt();try{const{preferredCameraId:le,setPreferredCamera:je}=ss.getState(),ye=le?{video:{deviceId:{exact:le}},audio:!1}:{video:!0,audio:!1};let pe;try{pe=await navigator.mediaDevices.getUserMedia(ye)}catch(We){const mt=We&&(We.name||We.code)||"";if(le&&(mt==="OverconstrainedError"||mt==="NotFoundError"))pe=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});else throw We}o.current&&(o.current.srcObject=pe,await o.current.play(),u(!0))}catch{}}function ge(){o.current&&o.current.srcObject&&(o.current.srcObject.getTracks().forEach(je=>je.stop()),o.current.srcObject=null,u(!1))}async function Tt(){Z(!0);try{const le=await Wx();oe(le),le.length===0&&alert("No wifi scoring devices found on your network. Make sure devices are powered on and connected to the same network.")}catch(le){console.error("Wifi device discovery failed:",le),alert("Failed to discover wifi devices. Please check your network connection.")}finally{Z(!1)}}async function ve(le){try{oe(ye=>ye.map(pe=>pe.id===le.id?{...pe,status:"connecting"}:pe));const je=await Gx(le);if(je&&o.current)o.current.srcObject=je,await o.current.play(),u(!0),oe(ye=>ye.map(pe=>pe.id===le.id?{...pe,status:"online"}:pe));else throw new Error("Failed to get video stream")}catch(je){console.error("Failed to connect to wifi device:",je),alert(`Failed to connect to ${le.name}. Please check the device and try again.`),oe(ye=>ye.map(pe=>pe.id===le.id?{...pe,status:"offline"}:pe))}}async function ze(){Ce(!0);try{const le=await Cw();Y(le);const je=await Ew();je&&Y(ye=>[...ye,je]),le.length===0&&!je&&alert("No USB scoring devices found. Please connect a device and try again.")}catch(le){console.error("USB device discovery failed:",le),alert("Failed to discover USB devices. Please check device connections.")}finally{Ce(!1)}}async function de(le){try{Y(ye=>ye.map(pe=>pe.id===le.id?{...pe,status:"connecting"}:pe));const je=await Tw(le);if(je&&o.current)o.current.srcObject=je,await o.current.play(),u(!0),b("wifi"),Y(ye=>ye.map(pe=>pe.id===le.id?{...pe,status:"online"}:pe));else throw new Error("Failed to get video stream")}catch(je){console.error("Failed to connect to USB device:",je),alert(`Failed to connect to ${le.name}. Please check the device and try again.`),Y(ye=>ye.map(pe=>pe.id===le.id?{...pe,status:"offline"}:pe))}}function re(){if(d&&d.readyState===WebSocket.OPEN)return d;const le="ws://localhost:8787",je=le.length>0?le.endsWith("/ws")?le:le.replace(/\/$/,"")+"/ws":void 0,ye=window.location.protocol==="https:"?"wss":"ws",pe=`${ye}://${window.location.host}/ws`,We=window.location.hostname,mt=We==="localhost"||We==="127.0.0.1",Oe=We.endsWith("onrender.com"),$t="wss://ninedartnation.onrender.com/ws";let ht=je;ht||(mt?ht=`${ye}://${We}:8787/ws`:Oe?ht=pe:ht=$t),ht||(ht=pe);const Pt=new WebSocket(ht);return g(Pt),Pt}async function Dt(){b("phone"),P(!1);const le=re();le.readyState===WebSocket.OPEN?le.send(JSON.stringify({type:"cam-create"})):le.onopen=()=>le.send(JSON.stringify({type:"cam-create"})),le.onmessage=async je=>{const ye=JSON.parse(je.data);if(ye.type==="cam-code")y(ye.code),ye.expiresAt&&w(ye.expiresAt);else if(ye.type==="cam-peer-joined"){P(!0);const pe=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});C(pe),pe.onicecandidate=mt=>{mt.candidate&&x&&le.send(JSON.stringify({type:"cam-ice",code:x,payload:mt.candidate}))},pe.ontrack=mt=>{var Oe;if(o.current){const $t=(Oe=mt.streams)==null?void 0:Oe[0];$t&&(o.current.srcObject=$t,o.current.play().catch(()=>{}),u(!0))}};const We=await pe.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!0});await pe.setLocalDescription(We),x&&le.send(JSON.stringify({type:"cam-offer",code:x,payload:We}))}else if(ye.type==="cam-answer")v&&await v.setRemoteDescription(new RTCSessionDescription(ye.payload));else if(ye.type==="cam-ice"&&v)try{await v.addIceCandidate(ye.payload)}catch{}}}function nt(){y(null),w(null),P(!1),d&&d.readyState===WebSocket.OPEN?d.send(JSON.stringify({type:"cam-create"})):Dt();try{ot(!0)}catch{}}function et(){if(ge(),y(null),P(!1),w(null),v){try{v.close()}catch{}C(null)}}return n.jsx(Lw,{label:e,autoStart:t,start:ut,stopAll:et,startPhonePairing:Dt,startWifiConnection:Tt,startUsbConnection:ze,connectToWifiDevice:ve,connectToUsbDevice:de,videoRef:o,streaming:c,mode:D,setMode:b,pairCode:x,mobileUrl:he,ttl:Ae,qrDataUrl:Ze,regenerateCode:nt,httpsInfo:G,showTips:te,setShowTips:L,wifiDevices:Q,usbDevices:$,discoveringWifi:R,discoveringUsb:ue,scaleOverride:s,className:r,aspect:a,style:l,fill:i})}function Lw(e){const{cameraScale:t,cameraAspect:s}=ss(),r=Math.max(.5,Math.min(1.25,Number(e.scaleOverride??t??1))),{label:a,start:l,stopAll:i,startPhonePairing:o,startWifiConnection:c,startUsbConnection:u,connectToWifiDevice:d,connectToUsbDevice:g,videoRef:x,streaming:y,mode:v,setMode:C,pairCode:D,mobileUrl:b,ttl:h,qrDataUrl:w,regenerateCode:E,httpsInfo:p,showTips:S,setShowTips:P,wifiDevices:N,usbDevices:q,discoveringWifi:G,discoveringUsb:_,className:te,aspect:L,style:Q,fill:oe}=e,[R,Z]=m.useState(null),$=m.useRef(null);m.useEffect(()=>()=>{$.current&&window.clearTimeout($.current)},[]);const Y=L&&L!=="inherit"?L:s||"wide",ue=Y!=="free",Ce=ue?Y==="square"?"aspect-square":Y==="portrait"?"aspect-[3/4]":Y==="classic"?"aspect-[4/3]":"aspect-video":"",ot=[oe?"rounded-2xl overflow-hidden bg-black w-full flex flex-col":"rounded-2xl overflow-hidden bg-black w-full mx-auto flex flex-col",te].filter(Boolean).join(" ").trim(),he={...Q||{}},Ze=oe?"relative flex-1 min-h-[220px] bg-black":"relative w-full bg-black",ft={style:{transform:`scale(${r})`,transformOrigin:"center"}},Ae=(()=>{const ge="absolute inset-0 w-full h-full object-contain object-center bg-black";return oe?ue?n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsx("div",{className:`relative w-full max-w-full max-h-full ${Ce}`,children:n.jsx("video",{ref:x,className:ge,...ft})})}):n.jsx("video",{ref:x,className:ge,...ft}):ue?n.jsx("div",{className:`relative w-full ${Ce}`,children:n.jsx("video",{ref:x,className:ge,...ft})}):n.jsx("video",{ref:x,className:"w-full h-full object-contain object-center bg-black",...ft})})();async function ut(ge,Tt){if(ge)try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(ge);else{const ve=document.createElement("textarea");ve.value=ge,ve.style.position="fixed",ve.style.opacity="0",document.body.appendChild(ve),ve.focus(),ve.select(),document.execCommand("copy"),document.body.removeChild(ve)}Z(Tt),$.current&&window.clearTimeout($.current),$.current=window.setTimeout(()=>Z(null),1500)}catch(ve){console.warn("Copy to clipboard failed:",ve),Z(null)}}return n.jsxs("div",{className:ot,style:he,children:[n.jsx("div",{className:Ze,children:Ae}),n.jsxs("div",{className:"p-1 flex items-center justify-between bg-black/60 text-white text-[10px] gap-1",children:[n.jsx("span",{className:"truncate",children:a||(y?v==="phone"?"PHONE LIVE":v==="wifi"?"WIFI LIVE":"LIVE":"Camera")}),n.jsxs("div",{className:"flex items-center gap-1",children:[!y&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:`px-1 py-0.5 rounded ${v==="local"?"bg-emerald-600":"bg-slate-700"}`,onClick:()=>{C("local"),l()},children:"Local"}),n.jsx("button",{className:`px-1 py-0.5 rounded ${v==="phone"?"bg-emerald-600":"bg-slate-700"}`,onClick:o,children:"Phone"}),n.jsx("button",{className:`px-1 py-0.5 rounded ${v==="wifi"?"bg-emerald-600":"bg-slate-700"}`,onClick:()=>{C("wifi"),c()},children:"Wifi"}),n.jsx("button",{className:`px-1 py-0.5 rounded ${v==="wifi"?"bg-emerald-600":"bg-slate-700"}`,onClick:()=>{C("wifi"),u()},children:"USB"})]}),y?n.jsx("button",{className:"px-1 py-0.5 rounded bg-rose-600",onClick:i,children:"Stop"}):null]})]}),v==="phone"&&D&&!y&&n.jsxs("div",{className:"p-2 text-white text-[10px] bg-black/50",children:[n.jsx("div",{className:"text-xs opacity-80",children:"Launch on your mobile:"}),n.jsxs("button",{type:"button",className:"mt-1 w-full text-left px-2 py-1 rounded bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center gap-2",onClick:()=>ut(b,"link"),title:"Copy mobile camera link",children:[n.jsx("span",{className:"flex-1 min-w-0 font-mono break-all",children:b}),n.jsx("span",{className:"text-[9px] uppercase tracking-wide whitespace-nowrap text-emerald-200",children:R==="link"?"Copied!":"Copy"})]}),n.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[n.jsx("a",{href:b,target:"_blank",rel:"noreferrer",className:"px-2 py-1 rounded border border-indigo-500/30 text-indigo-100 hover:bg-indigo-500/20 transition",children:"Open link"}),n.jsxs("button",{type:"button",className:"flex-1 text-left px-2 py-1 rounded bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center justify-between gap-2",onClick:()=>ut(D,"code"),title:"Copy pairing code",children:[n.jsx("span",{className:"font-mono tracking-[0.3em] text-sm",children:D}),n.jsx("span",{className:"text-[9px] uppercase tracking-wide whitespace-nowrap text-emerald-200",children:R==="code"?"Copied!":"Copy"})]})]}),w&&n.jsx("img",{className:"mt-1 w-[160px] h-[160px] bg-white rounded",alt:"Scan to open",src:w}),n.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[h!==null&&n.jsxs("span",{children:["Expires in ",h,"s"]}),n.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700",onClick:E,children:"Regenerate"})]}),S&&n.jsxs("div",{className:"mt-2 p-2 rounded bg-slate-900/60 border border-slate-700/50 text-slate-200",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Troubleshooting"}),n.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[n.jsx("li",{children:"Phone and desktop must be on the same Wi‑Fi network."}),n.jsxs("li",{children:["Allow the server through your firewall (ports 8787 and ",p!=null&&p.https?p.port:8788,")."]}),n.jsx("li",{children:"On iPhone, use HTTPS links (QR will prefer https when enabled)."})]}),n.jsx("div",{className:"mt-2 text-right",children:n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>P(!1),children:"Hide tips"})})]})]}),v==="wifi"&&!y&&n.jsxs("div",{className:"p-2 text-white text-[10px] bg-black/50",children:[n.jsx("div",{className:"font-semibold mb-2",children:"Scoring Devices"}),n.jsxs("div",{className:"mb-3",children:[n.jsx("div",{className:"font-medium mb-1",children:"WiFi Devices"}),G?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),n.jsx("span",{children:"Scanning network..."})]}):N.length>0?n.jsxs("div",{className:"space-y-1",children:[N.map(ge=>n.jsxs("div",{className:"flex items-center justify-between p-1 rounded bg-slate-900/60",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:ge.name}),n.jsxs("div",{className:"opacity-70 text-[9px]",children:[ge.ip,":",ge.port]})]}),n.jsx("button",{className:`px-1 py-0.5 rounded text-[9px] ${ge.status==="connecting"?"bg-yellow-600":ge.status==="online"?"bg-green-600":"bg-blue-600"}`,onClick:()=>d(ge),disabled:ge.status==="connecting",children:ge.status==="connecting"?"...":"Connect"})]},ge.id)),n.jsx("div",{className:"text-center mt-2",children:n.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:c,children:"Rescan WiFi"})})]}):n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"mb-1 opacity-70",children:"No WiFi devices found"}),n.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:c,children:"Scan WiFi"})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium mb-1",children:"USB Devices"}),_?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),n.jsx("span",{children:"Scanning USB..."})]}):q.length>0?n.jsxs("div",{className:"space-y-1",children:[q.map(ge=>n.jsxs("div",{className:"flex items-center justify-between p-1 rounded bg-slate-900/60",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:ge.name}),n.jsx("div",{className:"opacity-70 text-[9px]",children:ge.type.toUpperCase()})]}),n.jsx("button",{className:`px-1 py-0.5 rounded text-[9px] ${ge.status==="connecting"?"bg-yellow-600":ge.status==="online"?"bg-green-600":"bg-blue-600"}`,onClick:()=>g(ge),disabled:ge.status==="connecting",children:ge.status==="connecting"?"...":"Connect"})]},ge.id)),n.jsx("div",{className:"text-center mt-2",children:n.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:u,children:"Rescan USB"})})]}):n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"mb-1 opacity-70",children:"No USB devices found"}),n.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:u,children:"Scan USB"})]})]})]})]})}function Aw(e){return e.dartsThrown===0?0:(e.totalScoreStart-e.totalScoreRemaining)/e.dartsThrown*3}function Rw(e){const t=Aw(e),s=e.finished;return{avg:t,isCompleted:s,darts:e.dartsThrown,checkout:e.checkoutScore??0}}function Ow(e){if(e.legs.length===0)return;const t=[];let s,r=e.bestCheckout??0;for(const a of e.legs){if(!a.finished)continue;const l=Rw(a);t.push(l.avg),(!s||l.darts<s.darts||l.darts===s.darts&&(a.endTime??0)<s.timestamp)&&(s={darts:l.darts,timestamp:a.endTime??Date.now()}),l.checkout>r&&(r=l.checkout)}t.length&&(e.bestThreeDartAvg=Math.max(...t),e.worstThreeDartAvg=Math.min(...t)),s&&(e.bestNineDart=s),e.bestCheckout=r}const si=ya((e,t)=>({roomId:"",players:[],currentPlayerIdx:0,startingScore:501,inProgress:!1,newMatch:(s,r,a="")=>e(()=>({players:s.map((i,o)=>({id:`${o}`,name:i,legsWon:0,legs:[]})),currentPlayerIdx:0,startingScore:r,inProgress:!0,roomId:a,bestLegThisMatch:void 0})),addVisit:(s,r)=>e(a=>{if(!a.inProgress)return a;const l=a.players[a.currentPlayerIdx];let i=l.legs[l.legs.length-1];return(!i||i.finished)&&(i={visits:[],totalScoreStart:a.startingScore,totalScoreRemaining:a.startingScore,dartsThrown:0,finished:!1,checkoutScore:null,startTime:Date.now()},l.legs.push(i)),i.visits.push({darts:r,score:s}),i.dartsThrown+=r,i.totalScoreRemaining=Math.max(0,i.totalScoreRemaining-s),{...a}}),undoVisit:()=>e(s=>{const r=s.players[s.currentPlayerIdx],a=r.legs[r.legs.length-1];if(!a||a.finished||a.visits.length===0)return s;const l=a.visits.pop();return a.dartsThrown-=l.darts,a.totalScoreRemaining+=l.score,{...s}}),endLeg:s=>e(r=>{const a=r.players[r.currentPlayerIdx],l=a.legs[a.legs.length-1];if(!l||l.finished)return r;if(l.finished=!0,l.checkoutScore=s,l.endTime=Date.now(),l.totalScoreRemaining===0){a.legsWon+=1;const i=r.bestLegThisMatch;(!i||l.dartsThrown<i.darts)&&(r.bestLegThisMatch={playerId:a.id,darts:l.dartsThrown,timestamp:l.endTime})}return{...r}}),nextPlayer:()=>e(s=>({...s,currentPlayerIdx:(s.currentPlayerIdx+1)%s.players.length})),endGame:()=>e(s=>{for(const r of s.players)Ow(r);return{...s,inProgress:!1}}),importState:s=>e(()=>({...s}))}));function _w(e,t){const s=aw(e,t);return lw(s)}function Uw(e){try{if(!e||typeof e!="object")return null;if((e.type==="dart"||e.kind==="dart"||e.event==="dart")&&typeof e.value=="number"){const t=Lh(e.ring);return Ah(e.value,t)}if(typeof e.value=="number"&&e.ring){const t=Lh(e.ring);return Ah(e.value,t)}if(typeof e.score=="string"){const t=e.score.trim().toUpperCase();if(t==="50"||t==="DBULL"||t==="INNER_BULL")return{value:50,ring:"INNER_BULL",sector:null,mult:0};if(t==="25"||t==="BULL"||t==="OBULL")return{value:25,ring:"BULL",sector:null,mult:0};const s=t.match(/^(S|D|T)(\d{1,2})$/);if(s){const r=s[1]==="S"?1:s[1]==="D"?2:3,a=parseInt(s[2],10);if(a>=1&&a<=20)return{value:a*r,ring:r===1?"SINGLE":r===2?"DOUBLE":"TRIPLE",sector:a,mult:r}}}if(typeof e.sector=="number"&&typeof e.mult=="number"){const t=Math.max(1,Math.min(20,Math.floor(e.sector))),s=e.mult===1?1:e.mult===2?2:3;return{value:t*s,ring:s===1?"SINGLE":s===2?"DOUBLE":"TRIPLE",sector:t,mult:s}}if(e.bull){const t=String(e.bull).toLowerCase()==="inner"||e.bull===!0;return{value:t?50:25,ring:t?"INNER_BULL":"BULL",sector:null,mult:0}}}catch{}return null}function Lh(e){const t=String(e||"").toUpperCase();return t.startsWith("TR")?"TRIPLE":t.startsWith("DO")?"DOUBLE":t.startsWith("SI")?"SINGLE":t==="INNER_BULL"||t==="DBULL"||t==="50"||t==="IBULL"?"INNER_BULL":t==="BULL"||t==="25"||t==="OBULL"||t==="OUTER_BULL"?"BULL":t==="MISS"||t==="0"?"MISS":"SINGLE"}function Ah(e,t){const s=Math.max(0,Math.min(60,Math.round(Number(e)||0)));return t==="INNER_BULL"?{value:50,ring:t}:t==="BULL"?{value:25,ring:t}:{value:s,ring:t}}function Bw(e,t){let s=null,r=!0;function a(){if(r)try{s=new WebSocket(e),s.onmessage=l=>{try{const i=JSON.parse(l.data),o=Uw(i);o&&t(o)}catch{}},s.onclose=()=>{s=null,setTimeout(a,1500)},s.onerror=()=>{}}catch{setTimeout(a,2e3)}}return a(),{close:()=>{r=!1;try{s==null||s.close()}catch{}}}}function Rh({storageKey:e,children:t,className:s,defaultWidth:r=640,defaultHeight:a=360,minWidth:l=320,minHeight:i=200,maxWidth:o=1600,maxHeight:c=1200}){const[u,d]=m.useState(()=>{try{const h=localStorage.getItem(e);if(h)return JSON.parse(h)}catch{}return{width:r,height:a}}),g=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{function h(){try{localStorage.removeItem(e)}catch{}d({width:r,height:a})}return window.addEventListener("ndn:layout-reset",h),window.addEventListener("ndn:camera-reset",h),()=>{window.removeEventListener("ndn:layout-reset",h),window.removeEventListener("ndn:camera-reset",h)}},[e,r,a]),m.useEffect(()=>{try{localStorage.setItem(e,JSON.stringify(u))}catch{}},[u,e]);function y(h,w,E){return Math.max(w,Math.min(E,h))}function v(h,w){h.preventDefault();const E=x.current;if(!E)return;const p=E.getBoundingClientRect();g.current={x:h.clientX,y:h.clientY,w:p.width,h:p.height,dir:w},window.addEventListener("mousemove",C),window.addEventListener("mouseup",D)}function C(h){const w=g.current;if(!w)return;const E=h.clientX-w.x,p=h.clientY-w.y;let S=w.w,P=w.h;w.dir.includes("e")&&(S=y(w.w+E,l,o)),w.dir.includes("s")&&(P=y(w.h+p,i,c)),w.dir.includes("w")&&(S=y(w.w-E,l,o)),w.dir.includes("n")&&(P=y(w.h-p,i,c)),d({width:Math.round(S),height:Math.round(P)})}function D(){window.removeEventListener("mousemove",C),window.removeEventListener("mouseup",D),g.current=null}const b={width:u.width?`${u.width}px`:void 0,height:u.height?`${u.height}px`:void 0,maxWidth:"100%",maxHeight:"80vh",position:"relative"};return n.jsxs("div",{ref:x,className:`${s||""}`,style:b,children:[t,n.jsx("div",{className:"resizer resizer-nw",onMouseDown:h=>v(h,"nw")}),n.jsx("div",{className:"resizer resizer-ne",onMouseDown:h=>v(h,"ne")}),n.jsx("div",{className:"resizer resizer-sw",onMouseDown:h=>v(h,"sw")}),n.jsx("div",{className:"resizer resizer-se",onMouseDown:h=>v(h,"se")})]})}function Lr({storageKey:e,children:t,className:s,defaultWidth:r=520,defaultHeight:a,minWidth:l=360,minHeight:i=200,maxWidth:o=1100,maxHeight:c=900,fullScreen:u=!1,initialFitHeight:d=!1}){const[g,x]=m.useState(()=>{if(!u){try{const p=localStorage.getItem(e);if(p)return JSON.parse(p)}catch{}return{width:r,height:a}}return{}}),y=m.useRef(null);m.useEffect(()=>{if(u)return;function p(){var S;try{localStorage.removeItem(e)}catch{}if(d&&((S=h.current)!=null&&S.parentElement)){const P=h.current.parentElement,N=window.getComputedStyle(P),q=parseFloat(N.paddingTop||"0")||0,G=parseFloat(N.paddingBottom||"0")||0,_=Math.max(0,P.clientHeight-q-G),te=Math.max(i,Math.min(c,Math.round(_)));x({width:r,height:te});return}x({width:r,height:a})}return window.addEventListener("ndn:layout-reset",p),()=>window.removeEventListener("ndn:layout-reset",p)},[e,r,a,u]),m.useEffect(()=>{if(!u)try{localStorage.setItem(e,JSON.stringify(g))}catch{}},[g,e,u]),m.useEffect(()=>{var _;if(u||!d)return;const p=(_=h.current)==null?void 0:_.parentElement;if(!p)return;const S=window.getComputedStyle(p),P=parseFloat(S.paddingTop||"0")||0,N=parseFloat(S.paddingBottom||"0")||0,q=Math.max(0,p.clientHeight-P-N),G=Math.max(i,Math.min(c,Math.round(q)));try{const te=localStorage.getItem(e);if(te){const L=JSON.parse(te),Q=(L==null?void 0:L.height)||0;(!Q||Q<G)&&x(oe=>({...oe,height:G}));return}}catch{}x(te=>({...te,height:G}))},[d,u,e,i,c]);function v(p,S,P){return Math.max(S,Math.min(P,p))}function C(p,S){p.preventDefault();const P=h.current;if(!P)return;const N=P.getBoundingClientRect();y.current={x:p.clientX,y:p.clientY,w:N.width,h:N.height,dir:S},window.addEventListener("mousemove",D),window.addEventListener("mouseup",b)}function D(p){var oe;const S=y.current;if(!S)return;const P=p.clientX-S.x,N=p.clientY-S.y,q=S.dir;let G=S.w,_=S.h,te=1/0;const L=(oe=h.current)==null?void 0:oe.parentElement;if(L){const R=window.getComputedStyle(L),Z=parseFloat(R.paddingTop||"0")||0,$=parseFloat(R.paddingBottom||"0")||0;te=Math.max(0,L.clientHeight-Z-$)}const Q=Math.min(c,isFinite(te)?te:c);q.includes("e")&&(G=v(S.w+P,l,o)),q.includes("s")&&(_=v(S.h+N,i,Q)),q.includes("w")&&(G=v(S.w-P,l,o)),q.includes("n")&&(_=v(S.h-N,i,Q)),x({width:Math.round(G),height:Math.round(_)})}function b(){window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",b),y.current=null}const h=m.useRef(null),w=u?{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"}:{width:g.width?`${g.width}px`:void 0,height:g.height?`${g.height}px`:void 0,maxWidth:`${o}px`,maxHeight:"100%"},E=u?"card relative ndn-modal-full":"card relative";return n.jsxs("div",{ref:h,className:`${E} ${s||""}`,style:w,children:[t,!u&&n.jsx("div",{className:"resizer resizer-nw",onMouseDown:p=>C(p,"nw")}),!u&&n.jsx("div",{className:"resizer resizer-ne",onMouseDown:p=>C(p,"ne")}),!u&&n.jsx("div",{className:"resizer resizer-sw",onMouseDown:p=>C(p,"sw")}),!u&&n.jsx("div",{className:"resizer resizer-se",onMouseDown:p=>C(p,"se")}),!u&&n.jsx("div",{className:"resizer-edge resizer-s",onMouseDown:p=>C(p,"s")})]})}const Kx=ya((e,t)=>({samples:[],addSample:s=>e(r=>({samples:[...r.samples,s]})),clear:()=>e({samples:[]}),export:()=>t().samples.slice()}));function Xe({onVisitCommitted:e,showToolbar:t=!0,onAutoDart:s,immediateAutoCommit:r=!1,hideInlinePanels:a=!1,scoringMode:l="x01",onGenericDart:i,onGenericReplace:o}){const c=m.useRef(null),{preferredCameraId:u,setPreferredCamera:d,autoscoreProvider:g,autoscoreWsUrl:x}=ss(),y=g==="manual",[v,C]=m.useState([]),D=m.useRef(null),b=m.useRef(null),[h,w]=m.useState(!1),[E,p]=m.useState(!1),[S,P]=m.useState(null),{H:N,imageSize:q,reset:G}=Om(),[_,te]=m.useState(""),[L,Q]=m.useState(""),[oe,R]=m.useState(0),[Z,$]=m.useState("MISS"),[Y,ue]=m.useState(0),[Ce,Ee]=m.useState(0),[ot,he]=m.useState([]),Ze=si(U=>U.addVisit),ft=si(U=>U.endLeg),Ae=si(U=>U),ut=Kx(U=>U.addSample),[ge,Tt]=m.useState(""),[ve,ze]=m.useState(""),[de,re]=m.useState(0),[Dt,nt]=m.useState(!1),[et,le]=m.useState(!1),[je,ye]=m.useState("auto"),[pe,We]=m.useState(!1),[mt,Oe]=m.useState(!1),[$t,ht]=m.useState(!1),Pt=m.useRef(null);m.useEffect(()=>{const U=()=>{y||Oe(!0)};return window.addEventListener("ndn:open-autoscore",U),()=>window.removeEventListener("ndn:open-autoscore",U)},[y]),m.useEffect(()=>{const U=()=>ht(!0);return window.addEventListener("ndn:open-scoring",U),()=>window.removeEventListener("ndn:open-scoring",U)},[]),m.useEffect(()=>{const U=()=>{ye("manual"),We(!0)},H=()=>{ye("auto"),We(!1)};return window.addEventListener("ndn:open-manual",U),window.addEventListener("ndn:close-manual",H),()=>{window.removeEventListener("ndn:open-manual",U),window.removeEventListener("ndn:close-manual",H)}},[]),m.useEffect(()=>{y&&(ye("manual"),Oe(!1))},[y]),m.useEffect(()=>{if(!pe)return;const U=setInterval(()=>{try{const H=c.current,me=Pt.current;if(!H||!me)return;const be=H.videoWidth||0,Se=H.videoHeight||0;if(!be||!Se)return;const Be=me.clientWidth||640,He=me.clientHeight||360;me.width!==Be&&(me.width=Be),me.height!==He&&(me.height=He);const _e=me.getContext("2d");if(!_e)return;_e.imageSmoothingEnabled=!0;const Ke=Math.min(Be/be,He/Se),zt=Math.round(be*Ke),Lt=Math.round(Se*Ke),sn=Math.floor((Be-zt)/2),Ss=Math.floor((He-Lt)/2);_e.fillStyle="#000",_e.fillRect(0,0,Be,He),_e.drawImage(H,sn,Ss,zt,Lt)}catch(H){console.warn("Manual preview update error:",H)}},120);return()=>clearInterval(U)},[pe]),m.useEffect(()=>()=>ee(),[]);async function I(){if(!(E||h)){p(!0),console.log("[CAMERA] Starting camera...");try{const U=u?{video:{deviceId:{exact:u}},audio:!1}:{video:{facingMode:"environment"},audio:!1};console.log("[CAMERA] Using constraints:",U);let H;try{H=await navigator.mediaDevices.getUserMedia(U),console.log("[CAMERA] Got stream:",!!H)}catch(me){console.warn("[CAMERA] First attempt failed:",me);const be=me&&(me.name||me.code)||"";if(u&&(be==="OverconstrainedError"||be==="NotFoundError"))console.log("[CAMERA] Trying fallback without deviceId"),H=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});else if(!u&&(be==="OverconstrainedError"||be==="NotFoundError"||be==="NotSupportedError"))console.log("[CAMERA] Trying fallback for facingMode not supported"),H=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});else throw me}if(c.current){console.log("[CAMERA] Setting stream to video element"),c.current.srcObject=H,console.log("[CAMERA] Stream tracks:",H.getTracks().length,"video tracks:",H.getVideoTracks().length),c.current.addEventListener("loadeddata",()=>console.log("[CAMERA] Video loadeddata")),c.current.addEventListener("canplay",()=>console.log("[CAMERA] Video canplay")),c.current.addEventListener("play",()=>console.log("[CAMERA] Video started playing")),c.current.addEventListener("error",me=>console.error("[CAMERA] Video error:",me));try{c.current.play(),console.log("[CAMERA] Play called successfully")}catch(me){console.error("[CAMERA] Video play failed:",me),setTimeout(()=>{var be;try{(be=c.current)==null||be.play(),console.log("[CAMERA] Retry play called")}catch(Se){console.error("[CAMERA] Retry play failed:",Se)}},100)}}else console.error("[CAMERA] Video element not found");w(!0);try{const me=await navigator.mediaDevices.enumerateDevices();C(me.filter(be=>be.kind==="videoinput")),console.log("[CAMERA] Found cameras:",me.filter(be=>be.kind==="videoinput").length)}catch(me){console.warn("[CAMERA] Failed to enumerate devices:",me)}}catch(U){console.error("[CAMERA] Camera start failed:",U),alert("Camera permission denied or not available.")}finally{p(!1)}}}function ee(){c.current&&c.current.srcObject&&(c.current.srcObject.getTracks().forEach(H=>H.stop()),c.current.srcObject=null,w(!1),p(!1))}function st(){try{if(!c.current||!D.current)return;const U=c.current,H=D.current;H.width=U.videoWidth,H.height=U.videoHeight;const me=H.getContext("2d");if(!me)return;me.drawImage(U,0,0,H.width,H.height);const be=H.toDataURL("image/png");P(be)}catch(U){console.warn("Capture error:",U)}}function yt(){return v.length?n.jsxs("div",{className:"absolute top-2 right-2 z-20 flex items-center gap-2 bg-black/40 rounded px-2 py-1 text-xs",children:[n.jsx("span",{children:"Cam:"}),n.jsxs("select",{className:"bg-black/20 rounded px-1 py-0.5",value:u||"",onChange:async U=>{var be;if(E)return;const H=U.target.value||void 0,me=(be=v.find(Se=>Se.deviceId===H))==null?void 0:be.label;d(H,me||"",!0),ee(),await new Promise(Se=>setTimeout(Se,100));try{await I()}catch(Se){console.warn("Failed to start camera after device switch:",Se),setTimeout(async()=>{try{await I()}catch(Be){console.error("Camera switch failed after retry:",Be),alert("Failed to switch camera. Please try again or refresh the page.")}},500)}},children:[n.jsx("option",{value:"",children:"Auto"}),v.map(U=>n.jsx("option",{value:U.deviceId,children:U.label||"Camera"},U.deviceId))]})]}):null}function dn(){try{if(!b.current||!c.current||!N||!q)return;const U=b.current,H=c.current,me=H.clientWidth,be=H.clientHeight;U.width=me,U.height=be;const Se=U.getContext("2d");if(!Se)return;Se.clearRect(0,0,me,be);const Be=me/q.w,He=be/q.h,_e=tw(N,Be,He),Ke=[Ge.bullInner,Ge.bullOuter,Ge.trebleInner,Ge.trebleOuter,Ge.doubleInner,Ge.doubleOuter];for(const zt of Ke){const Lt=$x(_e,zt,360);zx(Se,Lt,zt===Ge.doubleOuter?"#22d3ee":"#a78bfa",zt===Ge.doubleOuter?3:2)}}catch(U){console.warn("Overlay drawing error:",U)}}m.useEffect(()=>{if(y)return;const U=setInterval(dn,250);return()=>clearInterval(U)},[N,q,h,y]),m.useEffect(()=>{if(g!=="external-ws"||!x)return;const U=Bw(x,H=>{var me,be;if(s){try{s(H.value,H.ring,{sector:H.sector??null,mult:H.mult??0})}catch{}try{ut({playerId:((me=Ae.players[Ae.currentPlayerIdx])==null?void 0:me.id)??null,sector:H.sector??null,mult:H.mult??0,ring:H.ring,ts:Date.now()})}catch{}}else{const Se=H.ring==="INNER_BULL"?"INNER_BULL 50":H.ring==="BULL"?"BULL 25":`${H.ring[0]}${H.value/(H.mult||1)||H.value} ${H.value}`;xt(H.value,Se,H.ring);try{ut({playerId:((be=Ae.players[Ae.currentPlayerIdx])==null?void 0:be.id)??null,sector:H.sector??null,mult:H.mult??0,ring:H.ring,ts:Date.now()})}catch{}}});return()=>U.close()},[g,x]);function Qt(U){var zt;if(!b.current||!N||!q)return;const H=b.current.getBoundingClientRect(),me=U.clientX-H.left,be=U.clientY-H.top,Se=b.current.width/q.w,Be=b.current.height/q.h,He={x:me/Se,y:be/Be},_e=_w(N,He),Ke=`${_e.ring} ${_e.base>0?_e.base:""}`.trim();te(Ke),R(_e.base),$(_e.ring),le(!0);try{if(r&&s){s(_e.base,_e.ring,{sector:_e.sector,mult:_e.mult});try{ut({playerId:((zt=Ae.players[Ae.currentPlayerIdx])==null?void 0:zt.id)??null,sector:_e.sector??null,mult:_e.mult??0,ring:_e.ring,ts:Date.now()})}catch{}le(!1)}}catch{}}function rt(U){const H=U.trim().toUpperCase();if(!H)return null;const me=H==="BULL"||H==="50"||H==="DBULL"||H==="IBULL",be=H==="25"||H==="OBULL";if(me)return{label:"INNER_BULL 50",value:50,ring:"INNER_BULL"};if(be)return{label:"BULL 25",value:25,ring:"BULL"};const Se=H.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!Se)return null;const Be=Se[1]||"S",He=parseInt(Se[2],10);if(He<1||He>20)return null;const _e=Be==="S"?1:Be==="D"?2:3,Ke=Be==="S"?"SINGLE":Be==="D"?"DOUBLE":"TRIPLE";return{label:`${Be}${He} ${He*_e}`,value:He*_e,ring:Ke}}function Nt(){const U=Ae;if(!U.players.length)return U.startingScore;const H=U.players[U.currentPlayerIdx],me=H.legs[H.legs.length-1];return me?me.totalScoreRemaining:U.startingScore}function xt(U,H,me){if(l==="custom"){if(i)try{i(U,me,{label:H})}catch{}if(Y>=3)return;const zt=Y+1;ue(zt),Ee(Lt=>Lt+U),he(Lt=>[...Lt,{label:H,value:U,ring:me}]);return}if(Y>=3)return;const be=Y+1,Se=Ce+U,He=Nt()-Se,_e=He===0&&(me==="DOUBLE"||me==="INNER_BULL");if(He<0||He===1||He===0&&!_e){Ze(0,be),ue(0),Ee(0),he([]),e&&e(0,be,!1);return}if(ue(be),Ee(Se),he(zt=>[...zt,{label:H,value:U,ring:me}]),_e){Ze(Se,be),ft(Se),ue(0),Ee(0),he([]),e&&e(Se,be,!0);return}be>=3&&(Ze(Se,be),ue(0),Ee(0),he([]),e&&e(Se,be,!1))}function hn(){if(_){if(s)try{s(oe,Z,void 0)}catch{}else xt(oe,_,Z);re(0),le(!1)}}function vt(){const U=rt(L);if(!U){alert("Enter like T20, D16, 5, 25, 50");return}if(!et||!_||Z==="MISS"||oe===0){const H=de+1;re(H),H>=3&&nt(!0)}else re(0);xt(U.value,U.label,U.ring),Q(""),le(!1)}function Zt(){var Lt,sn,Ss;const U=rt(L);if(!U){alert("Enter like T20, D16, 5, 25, 50");return}if(Y===0||ot.length===0){vt();return}if(l==="custom"){if(!et||!_||Z==="MISS"||oe===0){const Mt=de+1;re(Mt),Mt>=3&&nt(!0)}else re(0);if(he(Mt=>[...Mt.slice(0,-1),{label:U.label,value:U.value,ring:U.ring}]),o)try{o(U.value,U.ring,{label:U.label})}catch{}Q(""),le(!1);return}if(!et||!_||Z==="MISS"||oe===0){const Mt=de+1;re(Mt),Mt>=3&&nt(!0)}else re(0);const H=ot[ot.length-1],me=Y-1,be=Ce-((H==null?void 0:H.value)||0),Se=Nt(),Be=be+U.value,He=me+1,_e=Se-Be,Ke=_e===0&&(U.ring==="DOUBLE"||U.ring==="INNER_BULL");if(_e<0||_e===1||_e===0&&!Ke){Ze(0,He);try{const Mt=(Lt=Ae.players[Ae.currentPlayerIdx])==null?void 0:Lt.name;Mt&&ia(Mt,He,0)}catch{}ue(0),Ee(0),he([]),e&&e(0,He,!1),Q(""),le(!1);return}if(ue(He),Ee(Be),he(Mt=>[...Mt.slice(0,-1),{label:U.label,value:U.value,ring:U.ring}]),Ke){Ze(Be,He),ft(Be);try{const Mt=(sn=Ae.players[Ae.currentPlayerIdx])==null?void 0:sn.name;Mt&&ia(Mt,He,Be)}catch{}ue(0),Ee(0),he([]),e&&e(Be,He,!0),Q(""),le(!1);return}if(He>=3){Ze(Be,He);try{const Mt=(Ss=Ae.players[Ae.currentPlayerIdx])==null?void 0:Ss.name;Mt&&ia(Mt,He,Be)}catch{}ue(0),Ee(0),he([]),e&&e(Be,He,!1)}Q(""),le(!1)}function Ft(){nt(!1),re(0);try{window.dispatchEvent(new CustomEvent("ndn:request-calibrate"))}catch{}}function $n(){G(),nt(!1),re(0)}function F(U,H){if(Y>=3)return;const me=U*(H==="S"?1:H==="D"?2:3),be=H==="S"?"SINGLE":H==="D"?"DOUBLE":"TRIPLE";if(!et||!_||Z==="MISS"||oe===0){const Se=de+1;re(Se),Se>=3&&nt(!0)}else re(0);xt(me,`${H}${U} ${me}`,be),le(!1)}function Ne(){if(Y===0)return;const U=ot[ot.length-1];ue(H=>H-1),Ee(H=>H-((U==null?void 0:U.value)||0)),he(H=>H.slice(0,-1))}function ct(){var U;if(Y!==0){if(l==="custom"){ue(0),Ee(0),he([]);return}Ze(Ce,Y);try{const H=(U=Ae.players[Ae.currentPlayerIdx])==null?void 0:U.name;H&&ia(H,Y,Ce)}catch{}ue(0),Ee(0),he([]),e&&e(Ce,Y,!1)}}return n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t&&n.jsx("div",{className:"lg:col-span-2",children:n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[!y&&n.jsx("button",{className:`btn px-3 py-1 text-sm ${je==="auto"?"tab--active":""}`,onClick:()=>{ye("auto"),We(!1),Oe(!0)},children:"Autoscore"}),n.jsx("button",{className:`btn px-3 py-1 text-sm ${je==="manual"?"tab--active":""}`,onClick:()=>{ye("manual"),We(!0)},title:"Open Manual Correction",children:"Manual Correction"}),y&&n.jsx("span",{className:"text-xs opacity-70",children:"Manual scoring mode active"})]})}),!a&&!y?n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Camera"}),n.jsxs(Rh,{storageKey:"ndn:camera:size",className:"relative rounded-2xl overflow-hidden bg-black",defaultWidth:480,defaultHeight:360,minWidth:320,minHeight:240,maxWidth:1600,maxHeight:900,children:[n.jsx(yt,{}),n.jsx("video",{ref:c,className:"w-full h-full object-cover",playsInline:!0,"webkit-playsinline":"true",muted:!0,autoPlay:!0}),n.jsx("canvas",{ref:b,className:"absolute inset-0 w-full h-full",onClick:Qt})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[h?n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:ee,children:"Stop Camera"}):n.jsx("button",{className:"btn",onClick:I,disabled:E,children:E?"Connecting Camera...":"Connect Camera"}),n.jsx("button",{className:"btn",onClick:st,disabled:!h,children:"Capture Still"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{try{window.dispatchEvent(new Event("ndn:camera-reset"))}catch{}},children:"Reset Camera Size"})]})]}):null,!a&&y&&n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Manual Scoring"}),n.jsx("p",{className:"text-sm opacity-80 mb-3",children:"Camera-based autoscore is disabled. Use the manual visit input or open the Manual Correction panel to record darts."}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsx("button",{className:"btn",onClick:()=>{We(!0),ye("manual")},children:"Open Manual Correction"}),n.jsx("button",{className:"btn btn--ghost",onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-scoring"))}catch{}},children:"Manage Pending Visit"})]})]}),n.jsx("canvas",{ref:D,className:"hidden"}),mt&&!y&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100]",role:"dialog","aria-modal":"true",children:n.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:n.jsxs(Lr,{storageKey:"ndn:autoscore:size",className:"w-full max-w-3xl",defaultWidth:720,defaultHeight:520,minWidth:420,minHeight:320,maxWidth:1400,maxHeight:900,initialFitHeight:!0,children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Autoscore"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn btn--ghost",onClick:()=>Oe(!1),children:"Close"})})]}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Click the camera overlay to autoscore. Use Manual Correction if the last auto is off."}),n.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[n.jsx("span",{className:"font-semibold",children:"Last auto:"}),n.jsx("span",{children:_||"—"}),n.jsx("button",{className:"btn",onClick:hn,disabled:Y>=3,children:"Add Auto Dart"}),de>0&&n.jsxs("span",{className:"text-sm opacity-80",children:["No-registers: ",de,"/3"]})]}),n.jsxs("div",{className:"mt-2",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Quick entry"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[n.jsx("button",{className:"btn",disabled:Y>=3,onClick:()=>{if(!et||!_||Z==="MISS"||oe===0){const U=de+1;re(U),U>=3&&nt(!0)}else re(0);xt(25,"BULL 25","BULL"),le(!1)},children:"25"}),n.jsx("button",{className:"btn",disabled:Y>=3,onClick:()=>{if(!et||!_||Z==="MISS"||oe===0){const U=de+1;re(U),U>=3&&nt(!0)}else re(0);xt(50,"INNER_BULL 50","INNER_BULL"),le(!1)},children:"50"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("input",{className:"input w-full max-w-sm",list:"autoscore-quick-list",placeholder:"Type or select (e.g., D16, T20, S5)",value:ge,onChange:U=>Tt(U.target.value.toUpperCase()),onKeyDown:U=>{if(U.key==="Enter"){const H=ge.match(/^(S|D|T)(\d{1,2})$/);H&&F(parseInt(H[2],10),H[1])}}}),n.jsx("datalist",{id:"autoscore-quick-list",children:["D","S","T"].map(U=>Array.from({length:20},(H,me)=>me+1).map(H=>n.jsx("option",{value:`${U}${H}`},`${U}${H}`)))}),n.jsx("button",{className:"btn",disabled:!ge||Y>=3,onClick:()=>{const U=ge.match(/^(S|D|T)(\d{1,2})$/);if(!U)return;const H=U[1],me=parseInt(U[2],10);F(me,H)},children:"Add"})]})]})]})})}),pe&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100]",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[n.jsxs("div",{className:"p-3 md:p-4 flex items-center justify-between",children:[n.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Manual Correction"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{We(!1)},children:"Close"})})]}),n.jsx("div",{className:"flex-1 p-3 md:p-4",children:n.jsxs("div",{className:"h-full grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"card relative flex flex-col",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Live Preview"}),n.jsx("div",{className:"relative flex-1 rounded-2xl overflow-hidden bg-black",children:n.jsx("canvas",{ref:Pt,className:"absolute inset-0 w-full h-full"})})]}),n.jsxs("div",{className:"card flex flex-col",children:[n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Type a correction or replace the last dart. The preview updates live."}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"font-semibold",children:"Last auto:"}),n.jsx("span",{children:_||"—"}),n.jsx("button",{className:"btn",onClick:hn,disabled:Y>=3,children:"Add Auto Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{className:"input flex-1",placeholder:"Manual (T20, D16, 5, 25, 50)",value:L,onChange:U=>Q(U.target.value),onKeyDown:U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),vt()),U.key==="Enter"&&U.shiftKey&&(U.preventDefault(),Zt())}}),n.jsx("button",{className:"btn btn--ghost",onClick:Zt,disabled:Y===0,children:"Replace Last"}),n.jsx("button",{className:"btn",onClick:vt,disabled:Y>=3,children:"Add"})]}),n.jsx("div",{className:"text-xs opacity-70 mb-4",children:"Press Enter to Add · Shift+Enter to Replace Last"}),n.jsxs("div",{className:"mt-auto",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Quick entry"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[n.jsx("button",{className:"btn",disabled:Y>=3,onClick:()=>{if(!et||!_||Z==="MISS"||oe===0){const U=de+1;re(U),U>=3&&nt(!0)}else re(0);xt(25,"BULL 25","BULL"),le(!1)},children:"25"}),n.jsx("button",{className:"btn",disabled:Y>=3,onClick:()=>{if(!et||!_||Z==="MISS"||oe===0){const U=de+1;re(U),U>=3&&nt(!0)}else re(0);xt(50,"INNER_BULL 50","INNER_BULL"),le(!1)},children:"50"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("input",{className:"input w-full max-w-sm",list:"manual-quick-list",placeholder:"Type or select (e.g., D16, T20, S5)",value:ve,onChange:U=>ze(U.target.value.toUpperCase()),onKeyDown:U=>{if(U.key==="Enter"){const H=ve.match(/^(S|D|T)(\d{1,2})$/);H&&F(parseInt(H[2],10),H[1])}}}),n.jsx("datalist",{id:"manual-quick-list",children:["D","S","T"].map(U=>Array.from({length:20},(H,me)=>me+1).map(H=>n.jsx("option",{value:`${U}${H}`},`${U}${H}`)))}),n.jsx("button",{className:"btn",disabled:!ve||Y>=3,onClick:()=>{const U=ve.match(/^(S|D|T)(\d{1,2})$/);if(!U)return;const H=U[1],me=parseInt(U[2],10);F(me,H)},children:"Add"})]})]})]})]})})]})}),$t&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center",children:n.jsxs("div",{className:"card w-full max-w-4xl relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>ht(!1),children:"Close"}),n.jsx("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2 text-white",children:"Scoring"}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-black/30 rounded-2xl p-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Camera"}),n.jsxs(Rh,{storageKey:"ndn:camera:size:modal",className:"relative rounded-2xl overflow-hidden bg-black",defaultWidth:480,defaultHeight:360,minWidth:320,minHeight:240,maxWidth:1600,maxHeight:900,children:[n.jsx(yt,{}),n.jsx("video",{ref:c,className:"w-full h-full object-cover",playsInline:!0,"webkit-playsinline":"true",muted:!0,autoPlay:!0}),n.jsx("canvas",{ref:b,className:"absolute inset-0 w-full h-full",onClick:Qt})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[h?n.jsx("button",{className:"btn bg-gradient-to-r from-rose-600 to-rose-700 text-white font-bold",onClick:ee,children:"Stop Camera"}):n.jsx("button",{className:"btn bg-gradient-to-r from-purple-500 to-purple-700 text-white font-bold",onClick:I,children:"Connect Camera"}),n.jsx("button",{className:"btn bg-gradient-to-r from-indigo-500 to-indigo-700 text-white font-bold",onClick:st,disabled:!h,children:"Capture Still"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:()=>{try{window.dispatchEvent(new Event("ndn:camera-reset"))}catch{}},children:"Reset Camera Size"})]})]}),n.jsxs("div",{className:"bg-black/30 rounded-2xl p-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Pending Visit"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Up to 3 darts per visit."}),n.jsx("ul",{className:"text-sm mb-2 list-disc pl-5",children:ot.length===0?n.jsx("li",{className:"opacity-60",children:"No darts yet"}):ot.map((U,H)=>n.jsx("li",{children:U.label},H))}),n.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[n.jsxs("div",{className:"font-semibold",children:["Darts: ",Y,"/3"]}),n.jsxs("div",{className:"font-semibold",children:["Total: ",Ce]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-gradient-to-r from-purple-500 to-purple-700 text-white font-bold",onClick:Ne,disabled:Y===0,children:"Undo Dart"}),n.jsx("button",{className:"btn bg-gradient-to-r from-emerald-500 to-emerald-700 text-white font-bold",onClick:ct,disabled:Y===0,children:"Commit Visit"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:()=>{ue(0),Ee(0),he([])},disabled:Y===0,children:"Clear"})]})]})]})]})}),Dt&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:n.jsxs("div",{className:"card max-w-md w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>{nt(!1),re(0)},children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2 flex items-center gap-2 text-white",children:"Recalibration Recommended"}),n.jsx("div",{className:"mb-4 text-lg font-semibold text-indigo-200",children:"We detected 3 incorrect autoscores in a row. You can recalibrate now or reset calibration and try again."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-gradient-to-r from-purple-500 to-purple-700 text-white font-bold",onClick:Ft,children:"Go to Calibrate"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:$n,children:"Reset Calibration"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:()=>{nt(!1),re(0)},children:"Dismiss"})]})]})}),a?null:n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Pending Visit"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Up to 3 darts per visit."}),n.jsx("ul",{className:"text-sm mb-2 list-disc pl-5",children:ot.length===0?n.jsx("li",{className:"opacity-60",children:"No darts yet"}):ot.map((U,H)=>n.jsx("li",{children:U.label},H))}),n.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[n.jsxs("div",{className:"font-semibold",children:["Darts: ",Y,"/3"]}),n.jsxs("div",{className:"font-semibold",children:["Total: ",Ce]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn",onClick:Ne,disabled:Y===0,children:"Undo Dart"}),n.jsx("button",{className:"btn",onClick:ct,disabled:Y===0,children:"Commit Visit"}),n.jsx("button",{className:"btn",onClick:()=>{ue(0),Ee(0),he([])},disabled:Y===0,children:"Clear"})]})]})]})}function Oh(e,t,s,r){const a=(r-90)*Math.PI/180;return{x:e+s*Math.cos(a),y:t+s*Math.sin(a)}}function _h(e){return[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5].indexOf(e)*18+9}function $w({width:e=320,height:t=320}){const s=Kx(a=>a.samples),r=m.useRef(null);return m.useEffect(()=>{const a=r.current;if(!a)return;const l=a.getContext("2d");if(!l)return;a.width=e,a.height=t,l.clearRect(0,0,e,t);const i=e/2,o=t/2,c=Math.min(e,t)/(Ge.doubleOuter*2+20),u={bullInner:Ge.bullInner*c,bullOuter:Ge.bullOuter*c,trebleInner:Ge.trebleInner*c,trebleOuter:Ge.trebleOuter*c,doubleInner:Ge.doubleInner*c,doubleOuter:Ge.doubleOuter*c};l.strokeStyle="rgba(255,255,255,0.06)",l.lineWidth=1;const d=["doubleOuter","doubleInner","trebleOuter","trebleInner","bullOuter","bullInner"];for(const y of d)l.beginPath(),l.arc(i,o,u[y],0,Math.PI*2),l.stroke();const g=[];for(const y of s){let v=Math.random()*360,C=Math.random()*u.doubleOuter;typeof y.sector=="number"&&y.sector>=1&&y.sector<=20&&(v=_h(y.sector),y.ring==="DOUBLE"?C=(u.doubleInner+u.doubleOuter)/2:y.ring==="TRIPLE"?C=(u.trebleInner+u.trebleOuter)/2:y.ring==="INNER_BULL"?C=u.bullInner*.5:y.ring==="BULL"?C=u.bullOuter*.8:C=(u.trebleOuter+u.doubleInner)/2*(.6+Math.random()*.4));const D=Oh(i,o,C,v);g.push({x:D.x,y:D.y,w:1})}for(const y of g){const v=l.createRadialGradient(y.x,y.y,1,y.x,y.y,60);v.addColorStop(0,"rgba(255,0,0,0.9)"),v.addColorStop(.3,"rgba(255,100,0,0.5)"),v.addColorStop(1,"rgba(255,100,0,0)"),l.fillStyle=v,l.beginPath(),l.arc(y.x,y.y,60,0,Math.PI*2),l.fill()}l.fillStyle="rgba(255,255,255,0.85)",l.font="12px ui-sans-serif";const x={};for(const y of s)y.sector&&(x[y.sector]=(x[y.sector]||0)+1);for(const y of Object.keys(x)){const v=Number(y),C=_h(v),D=Oh(i,o,u.trebleOuter+18,C);l.fillText(String(x[v]),D.x-6,D.y+4)}},[s,e,t]),n.jsx("canvas",{ref:r,style:{width:"100%",height:"auto",borderRadius:8,background:"#081018"}})}const xs=[...Array.from({length:20},(e,t)=>({label:`D${t+1}`,score:(t+1)*2})),{label:"DBULL",score:50,isBull:!0}];function Tu(e,t){const s=xs[t];return!!s&&e===s.score}function Nr(e){const t=e.trim().toUpperCase();if(!t)return null;if(t==="50"||t==="BULL"||t==="DBULL"||t==="IBULL")return 50;if(t==="25"||t==="OBULL")return 25;const s=t.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!s)return null;const r=s[1]||"S",a=parseInt(s[2],10);return a<1||a>20?null:a*(r==="S"?1:r==="D"?2:3)}const on=[...Array.from({length:20},(e,t)=>t+1),25,50],Ti=[20,19,18,17,16,15,25];function oa(){const e={};return Ti.forEach(t=>{e[t]=0}),{marks:e,points:0}}function Jx(e,t,s,r,a=()=>!1){let l=null,i=0;if(s==="BULL"||s==="INNER_BULL"||t===25||t===50)l=25,i=s==="INNER_BULL"||t===50?2:1;else if(typeof r=="number"&&r>=15&&r<=20)l=r,s==="TRIPLE"?i=3:s==="DOUBLE"?i=2:i=1;else if(t){const y=[20,19,18,17,16,15];for(const v of y){if(t===v){l=v,i=1;break}if(t===v*2){l=v,i=2;break}if(t===v*3){l=v,i=3;break}}!l&&(t===25||t===50)&&(l=25,i=t===50?2:1)}if(!l)return 0;const o=e.marks[l];let c=Math.max(0,3-o);const u=Math.min(c,i),d=Math.max(0,i-u),g=o+u;e.marks[l]=g>3?3:g;let x=0;return d>0&&!a(l)&&(l===25?s==="INNER_BULL"?x+=50*d:x+=25*d:x+=l*d),e.points+=x,x}function Fw(e){return Ti.every(t=>(e.marks[t]||0)>=3)}function Cr(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function zw(e){return e.round}function qx(e,t,s,r){if(e.finished)return 0;const a=zw(e);let l=0;return typeof r=="number"&&r===a?s==="TRIPLE"?(l=a*3,e.turnHits.triples++):s==="DOUBLE"?(l=a*2,e.turnHits.doubles++):s==="SINGLE"&&(l=a*1,e.turnHits.singles++):!r&&(t===a||t===a*2||t===a*3)&&(t===a*3?(l=a*3,e.turnHits.triples++):t===a*2?(l=a*2,e.turnHits.doubles++):t===a&&(l=a,e.turnHits.singles++)),e.score+=l,l}function Yx(e){if(!e.finished){if(e.turnHits.singles>0&&e.turnHits.doubles>0&&e.turnHits.triples>0){e.shanghaiAchieved=!0,e.finished=!0;return}const t=e.round+1;t>20?e.finished=!0:e.round=t}e.turnHits={singles:0,doubles:0,triples:0}}function Er(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function cc(e){return e.targets[e.stage]||null}function Xx(e,t,s,r){if(e.finished)return 0;const a=cc(e);if(!a)return 0;let l=0;switch(a.kind){case"NUMBER":{typeof r=="number"&&r===a.num?s==="TRIPLE"?l=a.num*3:s==="DOUBLE"?l=a.num*2:s==="SINGLE"&&(l=a.num):!r&&(t===a.num||t===a.num*2||t===a.num*3)&&(l=t),l>0&&(e.hitThisRound=!0);break}case"DOUBLE":{(s==="DOUBLE"&&r===a.num||t===a.num*2)&&(l=a.num*2,e.hitThisRound=!0);break}case"TRIPLE":{(s==="TRIPLE"&&r===a.num||t===a.num*3)&&(l=a.num*3,e.hitThisRound=!0);break}case"BULL":{(s==="BULL"||s==="INNER_BULL"||t===25||t===50)&&(l=s==="INNER_BULL"||t===50?50:25,e.hitThisRound=!0);break}case"ANY_NUMBER":{t>0&&(l=t,e.hitThisRound=!0);break}}return e.score+=l,l}function Qx(e){e.finished||(e.hitThisRound||(e.score=Math.floor(e.score/2)),e.hitThisRound=!1,e.stage+=1,e.stage>=e.targets.length&&(e.finished=!0))}function Tr(){return{round:1,score:0,target:"HIGH",finished:!1}}function Zx(e,t,s,r){if(e.finished)return 0;let a=0;if(e.target==="HIGH")if(s==="INNER_BULL")a=50;else if(typeof r=="number"){const i=r*(s==="TRIPLE"?3:s==="DOUBLE"?2:1);r>=20&&(a=i)}else t>=40&&(a=t);else if(typeof r=="number"){const i=r*(s==="TRIPLE"?3:s==="DOUBLE"?2:1);r<=10&&(a=i)}else t>0&&t<=30&&(a=t);return e.score+=a,a}function eg(e){if(!e.finished){if(e.round+=1,e.round>10){e.finished=!0;return}e.target=e.target==="HIGH"?"LOW":"HIGH"}}function tg(e,t=3){return{number:e,lives:t,isKiller:!1,eliminated:!1}}function Hw(e){const t=Array.from({length:20},(r,a)=>a+1),s={};for(const r of e){const a=Math.floor(Math.random()*t.length),l=t.splice(a,1)[0];s[r]=l}return s}function Mu(e,t,s,r){const a=t[e];if(!a||!r||!s)return{becameKiller:!1};if(!a.isKiller&&s==="DOUBLE"&&r===a.number)return a.isKiller=!0,{becameKiller:!0};if(a.isKiller&&(s==="DOUBLE"||s==="TRIPLE")){const l=Object.keys(t).find(i=>i!==e&&!t[i].eliminated&&t[i].number===r);if(l){const i=t[l],o=s==="TRIPLE"?2:1;return i.lives=Math.max(0,i.lives-o),i.lives===0&&(i.eliminated=!0),{becameKiller:!1,victimId:l,livesRemoved:o}}}return{becameKiller:!1}}function Iu(e){const t=Object.entries(e).filter(([,s])=>!s.eliminated&&s.lives>0);return t.length===1?t[0][0]:null}function ri(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function ng(e,t,s,r){if(e.finished)return 0;let a=0;if(typeof r=="number"&&r===e.inning?s==="TRIPLE"?a=3:s==="DOUBLE"?a=2:a=1:!r&&(t===e.inning||t===e.inning*2||t===e.inning*3)&&(a=t===e.inning*3?3:t===e.inning*2?2:1),e.score+=a,e.dartsThisInning+=1,e.dartsThisInning>=3){const l=e.inning+1;l>9?e.finished=!0:(e.inning=l,e.dartsThisInning=0)}return a}const sg={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function ai(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function rg(e,t,s,r){if(e.finished)return!1;const a=sg[e.hole];if(e.dartsThisHole+=1,typeof r=="number"&&r===a&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")||!r&&(t===a||t===a*2||t===a*3)){e.strokes+=e.dartsThisHole;const i=e.hole+1;return i>18?e.finished=!0:(e.hole=i,e.dartsThisHole=0),!0}if(e.dartsThisHole>=3){e.strokes+=3;const i=e.hole+1;i>18?e.finished=!0:(e.hole=i,e.dartsThisHole=0)}return!1}const li={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function Du(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function Ww(e){const t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[s,r,a]of t)if(e[s]&&e[s]===e[r]&&e[s]===e[a])return e[s];return e.every(s=>s)?"Draw":null}function ag(e,t,s,r,a){if(e.finished||e.board[t])return!1;const l=li[t];let i=!1;if(l.type==="BULL"?i=r==="BULL"||r==="INNER_BULL"||s===25||s===50:l.type==="NUM"&&typeof l.num=="number"&&(typeof a=="number"&&a===l.num||!a&&(s===l.num||s===l.num*2||s===l.num*3))&&(i=!0),!i)return!1;e.board[t]=e.turn;const o=Ww(e.board);return o?(e.finished=!0,e.winner=o,!0):(e.turn=e.turn==="X"?"O":"X",!0)}const Pc=[20,19,18,17,16,15,14,13,12,25];function ii(){const e={};return Pc.forEach(t=>{e[t]=0}),{marks:e,points:0}}function lg(e,t,s,r,a=()=>!1){let l=null,i=0;if(s==="BULL"||s==="INNER_BULL"||t===25||t===50)l=25,i=s==="INNER_BULL"||t===50?2:1;else if(typeof r=="number"&&r>=12&&r<=20)l=r,s==="TRIPLE"?i=3:s==="DOUBLE"?i=2:i=1;else if(t){for(const y of[20,19,18,17,16,15,14,13,12]){if(t===y){l=y,i=1;break}if(t===y*2){l=y,i=2;break}if(t===y*3){l=y,i=3;break}}!l&&(t===25||t===50)&&(l=25,i=t===50?2:1)}if(!l)return 0;const o=e.marks[l],c=Math.max(0,3-o),u=Math.min(c,i),d=Math.max(0,i-u),g=o+u;e.marks[l]=g>3?3:g;let x=0;return d>0&&!a(l)&&(l===25?s==="INNER_BULL"?x+=50*d:x+=25*d:x+=l*d),e.points+=x,x}function Vw(e){return Pc.every(t=>(e.marks[t]||0)>=3)}const Uh=["X01","Double Practice"],Gw=["Around the Clock","Cricket","Halve It","Shanghai","High-Low","Killer","Bob's 27","Count-Up","High Score","Low Score","Checkout 170","Checkout 121","Treble Practice"],Kw=["Easy","Medium","Hardened"];function oi(e,t,s){return Math.max(t,Math.min(s,e))}function Jw(e,t){let s=0;if(t==="Easy"){const r=[22,26,41,45,60];s=r[Math.floor(Math.random()*r.length)]}else t==="Medium"?s=Math.round(oi(60+(Math.random()*30-15),30,100)):s=Math.round(oi(80+(Math.random()*20-10),50,120));return e<=0?0:s>e?[100,85,81,60,57,45,41,26,22,20,1].find(a=>a<=e)??0:s}function qw({onClose:e}){return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs("div",{className:"card max-w-lg w-full relative",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:e,children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations"}),n.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[n.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),n.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),n.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),n.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),n.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),n.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),n.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const Yw="http://localhost:8787";function Xw({user:e}){var df,uf,mf,ff,hf;const{offlineLayout:t}=ss(),[s,r]=m.useState("X01"),[a,l]=m.useState(501),[i,o]=m.useState("None"),[c,u]=m.useState(!1),[d,g]=m.useState(!1),[x,y]=m.useState(a),[v,C]=m.useState(a),[D,b]=m.useState(!1),[h,w]=m.useState(!1),[E,p]=m.useState(1),[S,P]=m.useState(0),[N,q]=m.useState(0),[G,_]=m.useState(null),[te,L]=m.useState(1),[Q,oe]=m.useState(1),[R,Z]=m.useState([]),[$,Y]=m.useState(2e3),ue=xl(),[Ce,Ee]=m.useState(!1),[ot,he]=m.useState(t==="modern"),[Ze,ft]=m.useState(t==="modern");m.useEffect(()=>{he(t==="modern"),ft(t==="modern")},[t]);const[Ae,ut]=m.useState(1),[ge,Tt]=m.useState(!0),[ve,ze]=m.useState(0),[de,re]=m.useState(0),[Dt,nt]=m.useState(0),[et,le]=m.useState(0),[je,ye]=m.useState(0),[pe,We]=m.useState(oa()),[mt,Oe]=m.useState(Cr()),[$t,ht]=m.useState(Er()),[Pt,I]=m.useState(Tr()),[ee,st]=m.useState(0),[yt,dn]=m.useState(1),[Qt,rt]=m.useState(27),[Nt,xt]=m.useState(0),[hn,vt]=m.useState(0),[Zt,Ft]=m.useState(!1),[$n,F]=m.useState(1),[Ne,ct]=m.useState(0),[U,H]=m.useState(0),me=8,[be,Se]=m.useState(1),[Be,He]=m.useState(0),[_e,Ke]=m.useState(0),zt=10,[Lt,sn]=m.useState(1),[Ss,Mt]=m.useState(0),[qs,va]=m.useState(0),Cs=10,[Jr,wn]=m.useState(170),[yl,O]=m.useState(0),[X,ne]=m.useState(0),[K,V]=m.useState(0),[De,we]=m.useState(121),[at,Ye]=m.useState(0),[Te,kt]=m.useState(0),[rn,At]=m.useState(0),[jn,pn]=m.useState(20),[Bs,Yn]=m.useState(0),[an,xn]=m.useState(0),[$s,Le]=m.useState(ri()),[Ln,pt]=m.useState(ai()),[Nn,Fn]=m.useState(Du()),[en,os]=m.useState(ii()),[lt,Es]=m.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[cs,An]=m.useState({}),[Fs,Xn]=m.useState({}),[gn,Ys]=m.useState(!1),[Rn,ds]=m.useState(0),[qr,Qn]=m.useState(0),[us,Je]=m.useState(null),[St,fe]=m.useState(""),[Ct,Rt]=m.useState(0),[bt,Et]=m.useState(0),[qt,kn]=m.useState(0),[pr,Xs]=m.useState(a),[it,Qs]=m.useState(0),[Yr,Ts]=m.useState(0),[xr,gr]=m.useState(0);m.useRef(null);const[Ms,ba]=m.useState(0),[Xr,vl]=m.useState(0),[zn,ms]=m.useState(0),[Zs,Is]=m.useState(0),[er,bl]=m.useState(0),[wa,wl]=m.useState(0),[Qr,jl]=m.useState(0),[yr,Ri]=m.useState(0),[ja,Nl]=m.useState(0),[Zr,kl]=m.useState(0),[Sl,Cl]=m.useState(0),[El,Tl]=m.useState(0),[Oi,Na]=m.useState(0),[_i,ka]=m.useState(0),[Ui,Sa]=m.useState(0),[Bi,Ca]=m.useState(0),[$i,Ea]=m.useState(0),[Fi,Ta]=m.useState(0),[zi,Ml]=m.useState(0),[Hi,Il]=m.useState(0),[Wi,Ma]=m.useState(!1),[yn,un]=m.useState(""),[Dl,Ia]=m.useState(""),{favoriteDouble:Pl,callerEnabled:Vi,callerVoice:Gi,callerVolume:f,speakCheckoutOnly:k,rememberLastOffline:M,setLastOffline:T,autoStartOffline:J,cameraScale:ae,setCameraScale:ce,cameraAspect:z="wide",setCameraAspect:Ot,cameraEnabled:Pe,textSize:wt,boxSize:ln,autoscoreProvider:_t}=ss(),Re=_t==="manual",Da=(j=>{switch(j){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(wt),tr=m.useRef(null),nr=m.useRef(null),Pa=m.useRef(null),[sr,La]=m.useState("first"),[ea,fs]=m.useState(1),Ac=m.useRef(null);m.useEffect(()=>{const j=Math.max(1,Math.floor(Number(ea)||1)),A=sr==="first"?j:Math.max(1,Math.ceil(j/2));p(A)},[sr,ea]),m.useEffect(()=>{if(!Ze){ut(1);return}const j=()=>{const W=tr.current,ie=nr.current;if(!W||!ie)return;const Fe=Pa.current?Pa.current.getBoundingClientRect().height:0,Ve=Math.max(0,W.clientHeight-Fe-6),Ie=Math.max(0,W.clientWidth-8),Me=ie.getBoundingClientRect(),Ue=Ae||1,qe=Me.height/Ue,tn=Me.width/Ue,hs=Ve>0?Ve/qe:1,ta=Ie>0?Ie/tn:1,Ds=Math.min(1,Math.max(.5,Math.min(hs,ta)));ut(Ds)};j();const A=window.ResizeObserver,B=A?new A(()=>j()):null;return B&&tr.current&&B.observe(tr.current),B&&nr.current&&B.observe(nr.current),window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j);try{B&&tr.current&&B.unobserve(tr.current)}catch{}try{B&&nr.current&&B.unobserve(nr.current)}catch{}}},[Ze,Ae]),m.useEffect(()=>{const j=A=>{var W;const B=(W=A==null?void 0:A.detail)==null?void 0:W.mode;B&&(r(B),Aa())};return window.addEventListener("ndn:auto-start",j),()=>window.removeEventListener("ndn:auto-start",j)},[]),m.useEffect(()=>{const j=A=>{var Fe,Ve,Ie;const B=(Fe=A==null?void 0:A.detail)==null?void 0:Fe.formatType,W=(Ve=A==null?void 0:A.detail)==null?void 0:Ve.formatCount,ie=(Ie=A==null?void 0:A.detail)==null?void 0:Ie.startScore;(B==="first"||B==="best")&&La(B),typeof W=="number"&&isFinite(W)&&fs(Math.max(1,Math.floor(W))),typeof ie=="number"&&isFinite(ie)&&l(Math.max(1,Math.floor(ie)))};return window.addEventListener("ndn:offline-format",j),()=>window.removeEventListener("ndn:offline-format",j)},[]),m.useEffect(()=>{if(!J)return;const j=setTimeout(()=>Aa(),50);return()=>clearTimeout(j)},[J]),m.useEffect(()=>{if(!Ce||ge||i==="None"||xr<=0)return;let j,A=performance.now();const B=W=>{const ie=W-A;A=W,gr(Fe=>{const Ve=Fe-ie;if(Ve<=0){let Ie=0,Me=v;for(;Ie<3&&Me>0;){const Ue=Jw(Me,i),qe=oi(Ue-Ie*20,0,Math.min(60,Me)),tn=Me-qe;if(vl(qe),ba(Ds=>Ds+1),kl(Ds=>Ds+1),tn<0){Me=v,ms(0),Is(0);break}ms(Ds=>Ds+qe),Tl(Ds=>Ds+qe);const hs=Me,ta=tn;if(hs>50&&ta<=50?Is(1):hs<=50&&Is(Ds=>Ds+1),Me=tn,Ie+=1,Me===0)break}if(C(Me),Me===0){zn===180?Ca(qe=>qe+1):zn>=140?Ea(qe=>qe+1):zn>=100&&Ta(qe=>qe+1);const Ue=v;Ue<=170&&Il(qe=>Math.max(qe,Ue)),v<=50&&(jl(qe=>qe+(Zs>0?Zs:1)),Ri(qe=>qe+1)),ms(0),Is(0),_("ai"),w(!0)}return Me>0&&Ie>=3&&(zn===180?Ca(Ue=>Ue+1):zn>=140?Ea(Ue=>Ue+1):zn>=100&&Ta(Ue=>Ue+1),ms(0),Is(0)),Tt(!0),0}return Ve}),xr>0&&(j=requestAnimationFrame(B))};return j=requestAnimationFrame(B),()=>cancelAnimationFrame(j)},[Ce,ge,i,xr,v]);function Aa(){g(!0),y(a),C(a),b(!1),Ee(!0),Tt(!0),ze(0),Rt(0),Et(0),kn(0),Xs(a),Qs(0),Ts(0),gr(0),ba(0),vl(0),ms(0),_(null),P(0),q(0),Z([]),Nl(0),kl(0),Cl(0),Tl(0),Na(0),ka(0),Sa(0),Ca(0),Ea(0),Ta(0),Ml(0),Il(0),bl(0),wl(0),jl(0),Ri(0);const j=Math.max(1,Math.floor(Number(ea)||1));if(p(sr==="first"?j:Math.max(1,Math.ceil(j/2))),M)try{T({mode:s,x01Start:a,firstTo:E,aiLevel:i})}catch{}}function fg(){y(a),C(a),b(!1),Ee(!0),Tt(!0),ze(0),Rt(0),Et(0),kn(0),Xs(a),Qs(0),Ts(0),gr(0),ba(0),vl(0),ms(0),_(null)}function Bm(j){kn(0),Xs(j===0?a:x),Ts(0),i!=="None"?(Tt(!1),gr($)):Tt(!1)}function Ki(j){const A=x-j,B=qt+1;if(Et(j),Rt(Ie=>Ie+1),Nl(Ie=>Ie+1),A<0){y(pr),Bm(pr),ze(0),Qs(0),Ts(0);return}y(A),Vi&&Po((e==null?void 0:e.username)||"Player",j,Math.max(A,0),Gi,{volume:f,checkoutOnly:k}),kn(B),Qs(Ie=>Ie+j),Cl(Ie=>Ie+j),ze(0);const W=x,ie=A,Fe=W>50&&ie<=50,Ve=W<=50;if(Fe?Ts(1):Ve&&Ts(Ie=>Ie+1),A===0){it+j===180?Na(Me=>Me+1):it+j>=140?ka(Me=>Me+1):it+j>=100&&Sa(Me=>Me+1);const Ie=pr;Ie<=170&&Ml(Me=>Math.max(Me,Ie)),W<=50&&(bl(Me=>Me+(Yr>0?Yr:1)),wl(Me=>Me+1)),_("player"),w(!0);return}B>=3&&(it+j===180?Na(Ie=>Ie+1):it+j>=140?ka(Ie=>Ie+1):it+j>=100&&Sa(Ie=>Ie+1),Bm(A),Qs(0),Ts(0))}function $m(){const j=oi(Math.round(Number(ve)||0),0,60);Ki(j)}function Fm(j){const A=oi(Math.round(j||0),0,60);if(Et(A),Rt(B=>B+1),Nl(B=>B+1),Tu(A,de)){const B=Dt+1;nt(B),re(W=>Math.min(20,W+1)),B>=21&&(_("player"),w(!0))}ze(0)}function zm(){Fm(Number(ve))}function Hm(){const j=Nr(yn);if(j==null){alert("Enter like D16, 50, 25, T20");return}Fm(j),un("")}function Wm(j,A,B){if(Zt)return;const W=yt,ie=A==="DOUBLE"&&B===W||!A&&j===W*2;ie&&vt(Fe=>Fe+1),xt(Fe=>{const Ve=Fe+1;if(Ve>=3){const Ie=hn+(ie?1:0);Ie>0?rt(Ue=>Ue+Ie*W*2):rt(Ue=>Ue-W*2);const Me=W+1;return dn(Me),vt(0),Me>20&&Ft(!0),0}return Ve})}function Vm(){Wm(Math.max(0,ve|0)),ze(0)}function Gm(){dn(1),rt(27),xt(0),vt(0),Ft(!1)}function Rc(j){ct(A=>A+Math.max(0,j|0)),H(A=>{const B=A+1;return B>=3?(F(W=>W+1),0):B})}function Oc(j){He(A=>A+Math.max(0,j|0)),Ke(A=>{const B=A+1;return B>=3?(Se(W=>W+1),0):B})}function _c(j){Mt(A=>A+Math.max(0,j|0)),va(A=>{const B=A+1;return B>=3?(sn(W=>W+1),0):B})}function Km(j,A,B,W,ie,Fe,Ve,Ie){const Me=j-Ve;if(!(Me<0))if(Me===0){if(Ie==="DOUBLE"||Ie==="INNER_BULL"){Fe(Ue=>Ue+1),ie(Ue=>Ue+1),W(()=>0),A(j);return}}else A(Me);W(Ue=>{const qe=Ue+1;return qe>=3?(ie(tn=>tn+1),0):qe})}function Jm(j,A){Km(Jr,wn,yl,O,ne,V,j,A),yl+1>=3&&wn(170)}function qm(j,A){Km(De,we,at,Ye,kt,At,j,A),at+1>=3&&we(121)}function Ji(j){const A=Nr(yn);if(A==null){alert("Enter like T20, D16, 25, 50");return}const B=yn.trim().toUpperCase(),W=B.startsWith("D")||B==="50"||B==="BULL"||B==="DBULL"||B==="IBULL"||B.includes("INNER");j?Jm(A,W?"DOUBLE":void 0):qm(A,W?"DOUBLE":void 0),un("")}function hg(){wn(170),O(0),ne(0),V(0)}function pg(){we(121),Ye(0),kt(0),At(0)}function Uc(j,A,B){A==="TRIPLE"&&B===jn?Yn(W=>W+1):!A&&j===jn*3&&Yn(W=>W+1),xn(W=>W+1)}function xg(){Yn(0),xn(0)}function gg(j,A,B){Le(W=>{const ie={...W};return ng(ie,j,A,B),ie})}function yg(){Le(ri())}function vg(j,A,B){pt(W=>{const ie={...W};return rg(ie,j,A,B),ie})}function bg(){pt(ai())}function wg(j,A,B,W){Fn(ie=>{const Fe={...ie,board:[...ie.board]};return ag(Fe,j,A,B,W),Fe})}function jg(){Fn(Du())}function Ng(j,A,B){os(W=>{const ie={...W,marks:{...W.marks}};return lg(ie,j,A,B,()=>!1),ie})}function Ym(){os(ii())}function Bc(j,A,B){const W=on[et];let ie=!1;if(typeof B=="number"&&B===W&&(A==="SINGLE"||A==="DOUBLE"||A==="TRIPLE")&&(ie=!0),W===25&&(A==="BULL"||j===25)&&(ie=!0),W===50&&(A==="INNER_BULL"||j===50)&&(ie=!0),ie||(j===W||j===W*2||j===W*3)&&(ie=!0),ie){const Fe=je+1;ye(Fe),le(Ve=>Ve+1)}}function Xm(){Bc(Math.max(0,ve|0)),ze(0)}function Qm(){const j=Nr(yn);if(j==null){alert("Enter like T20, D5, 25, 50");return}Bc(j),un("")}function Zm(j,A,B){We(W=>{const ie={...W,marks:{...W.marks}};return Jx(ie,j,A,B,()=>!1),ie}),st(W=>{const ie=W+1;return ie>=3?0:ie})}function ef(){Zm(Math.max(0,ve|0)),ze(0)}function tf(j,A,B){Oe(W=>{const ie={...W,turnHits:{...W.turnHits}};return qx(ie,j,A,B),ie}),st(W=>{const ie=W+1;return ie>=3?(Oe(Fe=>{const Ve={...Fe,turnHits:{...Fe.turnHits}};return Yx(Ve),Ve}),0):ie})}function nf(){tf(Math.max(0,ve|0)),ze(0)}function sf(j,A,B){ht(W=>{const ie={...W,targets:[...W.targets]};return Xx(ie,j,A,B),ie}),st(W=>{const ie=W+1;return ie>=3?(ht(Fe=>{const Ve={...Fe,targets:[...Fe.targets]};return Qx(Ve),Ve}),0):ie})}function rf(){sf(Math.max(0,ve|0)),ze(0)}function af(j,A,B){I(W=>{const ie={...W};return Zx(ie,j,A,B),ie}),st(W=>{const ie=W+1;return ie>=3?(I(Fe=>{const Ve={...Fe};return eg(Ve),Ve}),0):ie})}function lf(){af(Math.max(0,ve|0)),ze(0)}function of(){const j=yn.trim().toUpperCase();if(!j)return null;if(j==="50"||j==="BULL"||j==="DBULL"||j==="IBULL")return 50;if(j==="25"||j==="OBULL")return 25;const A=j.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!A)return null;const B=A[1]||"S",W=parseInt(A[2],10);return W<1||W>20?null:W*(B==="S"?1:B==="D"?2:3)}function $c(){const j=of();if(j==null){alert("Enter like T20, D16, 5, 25, 50");return}Ki(j),un("")}function kg(){const j=Dl.trim().split(`
`).map(A=>A.trim()).filter(A=>A);if(j.length!==0){for(const A of j){const B=Nr(A);if(B==null){alert(`Invalid score: ${A}`);return}Ki(B)}Ia("")}}function Sg(){qt!==0&&(y(j=>j+bt),kn(j=>Math.max(0,j-1)))}function cf(){const j=of();if(j==null){alert("Enter like T20, D16, 5, 25, 50");return}if(qt===0){$c();return}const A=bt;y(B=>B+A),kn(B=>Math.max(0,B-1)),setTimeout(()=>Ki(j),0),un("")}function Cg(){const j=G??"player",A=j==="player"?Yr||void 0:Zs||void 0;Z([...R,{winner:j,doubleDarts:te,checkoutDarts:Q,doublesAtt:A,doublesHit:1}]),w(!1);let W=S,ie=N;if(G==="player"?W+=1:G==="ai"&&(ie+=1),P(W),q(ie),_(null),W>=E||ie>=E){try{e1(s,j==="player")}catch{}Ee(!1),g(!1),y(a),C(a),Ma(!0);return}fg()}const Fc=!Uh.includes(s)&&!(e!=null&&e.fullAccess||e!=null&&e.admin);return n.jsxs("div",{className:"card relative overflow-hidden",children:[n.jsxs("h2",{className:"text-2xl font-bold text-brand-700 mb-4",children:["Offline Game Modes ",t==="classic"?n.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle",children:"Classic layout"}):n.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),n.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[n.jsx("label",{className:"font-semibold",children:"Select game mode:"}),n.jsxs("select",{className:"input w-full",value:s,onChange:j=>r(j.target.value),children:[Uh.map(j=>n.jsx("option",{value:j,children:j},j)),Gw.map(j=>n.jsxs("option",{value:j,disabled:!(e!=null&&e.fullAccess||e!=null&&e.admin),children:[j," ",e!=null&&e.fullAccess||e!=null&&e.admin?"":"(Premium)"]},j))]}),!(e!=null&&e.fullAccess)&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[n.jsx("span",{children:"🔒"}),n.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),s==="X01"&&n.jsxs(n.Fragment,{children:[n.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),n.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:a,onChange:j=>l(Number(j.target.value))}),n.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),n.jsxs("select",{className:"input w-full",value:i,onChange:j=>o(j.target.value),children:[n.jsx("option",{value:"None",children:"None"}),Kw.map(j=>n.jsx("option",{value:j,children:j},j))]}),i!=="None"&&n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[n.jsxs("div",{className:"sm:col-span-2",children:[n.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),n.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:$/1e3,onChange:j=>Y(Math.round(Number(j.target.value)*1e3))})]}),n.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),n.jsx("button",{className:"btn mt-2",onClick:()=>u(!0),children:"X01 Rules & Regulations!"})]}),s==="Double Practice"&&n.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 → D20 → DBULL in as few darts as possible. AI and X01 settings don’t apply."})]}),!d&&n.jsx("button",{className:"btn",disabled:Fc,title:Fc?"PREMIUM required for this mode":"",onClick:Aa,children:"Start Match"}),Ce&&n.jsx("div",{className:`absolute inset-0 z-[1000] ${ot?"":"flex items-center justify-center p-3 sm:p-4"}`,children:n.jsx(Lr,{storageKey:"ndn:modal:offline-match",className:`${ot?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:ot,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:n.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pr-1 pt-2 pb-2",style:{overflowY:Ze?"hidden":"auto"},ref:j=>{tr.current=j},children:[n.jsxs("div",{ref:j=>{Pa.current=j},className:"sticky top-0 relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm",children:[n.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),n.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:[n.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),n.jsxs("span",{className:"font-medium whitespace-nowrap",children:[s,s==="X01"?` / ${a}`:""]}),n.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",E," · Legs ",S,"-",N]}),n.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${t==="modern"?"bg-emerald-500/15 text-emerald-200 border-emerald-400/30":"bg-white/10 text-white/70 border-white/20"}`,children:t==="modern"?"Modern layout":"Classic layout"})]}),n.jsxs("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:[n.jsxs("div",{className:"hidden items-center gap-2 mr-2 text-xs",children:[n.jsx("span",{className:"opacity-80",children:"Cam"}),n.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>ce(Math.max(.5,Math.round((ae-.05)*100)/100)),title:"Decrease camera size",children:"−"}),n.jsxs("span",{className:"w-9 text-center",children:[Math.round(ae*100),"%"]}),n.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>ce(Math.min(1.25,Math.round((ae+.05)*100)/100)),title:"Increase camera size",children:"+"})]}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:Ze?"Actual Size":"Fit All",onClick:()=>ft(j=>!j),children:Ze?"Actual Size":"Fit All"}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:ot?"Restore":"Maximize",onClick:()=>he(j=>!j),children:ot?"Restore":"Maximize"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Aa()},children:"Restart"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>{Ee(!1),g(!1)},children:"Quit"})]})]}),n.jsxs("div",{ref:j=>{nr.current=j},className:"will-change-transform",style:Ze?{transform:`scale(${Ae})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,Ae))}em`}:void 0,children:[n.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:s==="X01"?"X01 Match":s}),n.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",s]}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",a]}),n.jsxs("div",{ref:Ac,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[n.jsx("span",{children:"Format:"}),(()=>{const j=x!==a||v!==a||qt>0,A=`px-2 py-0.5 rounded border text-xs ${j?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{type:"button",className:`${A} ${sr==="first"?"bg-indigo-500/20 text-indigo-100 border-indigo-400/30":"bg-white/10 text-white/80 border-white/20"}`,onClick:()=>{j||La("first")},title:"First to N",children:"First to"}),n.jsx("button",{type:"button",className:`${A} ${sr==="best"?"bg-indigo-500/20 text-indigo-100 border-indigo-400/30":"bg-white/10 text-white/80 border-white/20"}`,onClick:()=>{j||La("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),n.jsx("input",{className:`input w-16 text-center ${j?"opacity-50":""}`,type:"number",min:1,step:1,value:ea,onChange:B=>fs(Math.max(1,Math.floor(Number(B.target.value)||1))),disabled:j,title:sr==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",S,"–",N]})]}),s!=="X01"?n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[s==="Double Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"Current Target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:((df=xs[de])==null?void 0:df.label)||"—"})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Dt," / 21"]})]}),s==="Around the Clock"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"Current Target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:on[et]===25?"25 (Outer Bull)":on[et]===50?"50 (Inner Bull)":on[et]||"—"})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[je," / ",on.length]})]}),s==="Cricket"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket — Close 20–15 and Bull; overflow scores points"}),n.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:Ti.map(j=>{var A;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:j===25?"Bull":j}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((A=pe.marks)==null?void 0:A[j])||0)," / 3"]})]},j)})}),n.jsxs("div",{className:"text-sm",children:["Points: ",n.jsx("span",{className:"font-semibold",children:pe.points})]}),Fw(pe)&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{We(oa()),st(0)},children:"Reset"})]})]}),s==="Shanghai"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Round"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:mt.round})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",mt.score]}),mt.finished&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{Oe(Cr()),st(0)},children:"Reset"})]})]}),s==="Halve It"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Stage"}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[$t.stage+1,"/",$t.targets.length]})]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:(()=>{const j=cc($t);return j?j.kind==="ANY_NUMBER"?"Any":j.kind==="BULL"?"Bull":j.kind==="DOUBLE"||j.kind==="TRIPLE"||j.kind==="NUMBER"?`${j.kind} ${j.num}`:"—":"—"})()})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",$t.score]}),$t.finished&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{ht(Er()),st(0)},children:"Reset"})]})]}),s==="High-Low"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Pt.round," · Target ",Pt.target]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Pt.score]}),Pt.finished&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{I(Tr()),st(0)},children:"Reset"})]})]}),s==="Bob's 27"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Target"}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",yt]})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Qt]}),Zt&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:Gm,children:"Reset"})]})]}),s==="Count-Up"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",$n,"/8"]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ne]})]}),s==="High Score"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",be,"/10"]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Be]})]}),s==="Low Score"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Lt,"/10"]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ss]})]}),s==="Checkout 170"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Jr}),n.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",X," · Successes: ",K]})]}),s==="Checkout 121"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:De}),n.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Te," · Successes: ",rn]})]}),s==="Treble Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",jn]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",Bs]})]}),s==="Baseball"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:$s.inning}),n.jsxs("div",{className:"text-sm",children:["Score: ",n.jsx("span",{className:"font-semibold",children:$s.score})]})]}),s==="Golf"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Ln.hole}),n.jsxs("div",{className:"text-sm",children:["Strokes: ",n.jsx("span",{className:"font-semibold",children:Ln.strokes})]})]}),s==="Tic Tac Toe"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Nn.turn}),Nn.finished&&n.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",Nn.winner||"—"]})]}),s==="American Cricket"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20–12 and Bull; overflow scores points"}),n.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:Pc.map(j=>{var A;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:j===25?"Bull":j}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((A=en.marks)==null?void 0:A[j])||0)," / 3"]})]},j)})}),n.jsxs("div",{className:"text-sm",children:["Points: ",n.jsx("span",{className:"font-semibold",children:en.points})]}),Vw(en)&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:Ym,children:"Reset"})]})]}),s==="Killer"&&n.jsx(n.Fragment,{children:gn?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Turn"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:((uf=lt[Rn])==null?void 0:uf.name)||"—"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:us?`${((mf=lt.find(j=>j.id===us))==null?void 0:mf.name)||"Winner"} Wins`:St||"Ready"})]}):n.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):t==="modern"?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 mb-2 items-stretch",children:[n.jsxs("div",{className:"flex flex-col gap-2 min-w-0",children:[n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col",children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"You Remain"}),ge?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:x}),n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-x/a)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:bt})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:Ct>0?((a-x)/Ct*3).toFixed(1):"0.0"})]}),n.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[n.jsxs("span",{children:["Darts thrown: ",Ct]}),n.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(j=>n.jsx("span",{className:`w-2 h-2 rounded-full ${j<qt?"bg-emerald-400":"bg-white/20"}`},j))})]}),n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",er," · Hit ",wa]})]}),x<=170&&x>0&&(()=>{const A=ic(x,Pl)[0]||"—";return n.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[n.jsx("span",{className:"opacity-70",children:"Checkout"}),n.jsx("span",{className:"font-semibold",children:A})]})})()]}),n.jsxs("div",{className:`${ln==="small"?"p-2":ln==="large"?"p-4":"p-3"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${wt==="small"?"text-xs":wt==="large"?"text-base":"text-sm"}`,children:[n.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const j=ge?(e==null?void 0:e.username)||"You":i==="None"?"—":`${i} AI`,A=ge?x:i==="None"?0:v,B=ge?bt:Xr,W=ge?it:zn,ie=ge?Ct:Ms,Fe=a-(ge?x:i==="None"?a:v),Ve=ie>0?Fe/ie*3:0,Ie=`${S}-${N}`,Me=R.length>0?`${Math.min(...R.map(Ue=>Ue.doubleDarts+(Ue.checkoutDarts||0)))||0} darts`:"—";return n.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[n.jsx("div",{className:"opacity-80",children:"Current score"}),n.jsx("div",{className:"font-mono text-right",children:Ie}),n.jsx("div",{className:"opacity-80",children:"Current thrower"}),n.jsx("div",{className:"text-right font-semibold text-lg",children:j}),n.jsx("div",{className:"opacity-80",children:"Score remaining"}),n.jsx("div",{className:"text-right font-mono font-bold text-xl",children:A}),n.jsx("div",{className:"opacity-80",children:"3-dart avg"}),n.jsx("div",{className:"text-right font-mono",children:Ve.toFixed(1)}),n.jsx("div",{className:"opacity-80",children:"Last score"}),n.jsx("div",{className:"text-right font-mono",children:W||B}),n.jsx("div",{className:"opacity-80",children:"Best leg"}),n.jsx("div",{className:"text-right",children:Me})]})})()]}),n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col",children:[n.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[n.jsxs("span",{children:[i==="None"?"Opponent":`${i} AI`," Remain"]}),ge?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:i!=="None"?v:"N/A"}),i!=="None"&&n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-v/a)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:i==="None"?0:Xr})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:i!=="None"?Ms>0?((a-v)/Ms*3).toFixed(1):"0.0":"—"})]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",Ms]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",Qr," · Hit ",yr]})]})]})]}),n.jsx("div",{className:"md:col-span-2 min-w-0 space-y-2",children:Re?n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"text-sm font-semibold mb-1",children:"Manual scoring active"}),n.jsx("div",{className:"text-xs opacity-70",children:"Camera previews are disabled. Use the manual entry controls below to record your turn."})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex items-center gap-1.5 mt-1",children:n.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[n.jsx("span",{className:"opacity-70",children:"Cam"}),n.jsx("button",{className:`btn ${Da}`,onClick:()=>ce(Math.max(.5,Math.round((ae-.05)*100)/100)),children:"−"}),n.jsxs("span",{className:`btn ${Da} min-w-[2.5rem] text-center`,children:[Math.round(ae*100),"%"]}),n.jsx("button",{className:`btn ${Da}`,onClick:()=>ce(Math.min(1.25,Math.round((ae+.05)*100)/100)),children:"+"}),n.jsx("span",{className:"opacity-50",children:"|"}),n.jsx("button",{className:`btn ${Da}`,title:"Toggle camera aspect",onClick:()=>Ot(z==="square"?"wide":"square"),children:z==="square"?"Square":"Wide"})]})}),n.jsx("div",{className:"flex items-stretch justify-end min-w-0 md:min-h-[45vh]",children:n.jsx(oc,{label:"Your Board",autoStart:!0,className:"min-w-0 h-full",style:{minHeight:"45vh"},fill:!0})})]})})]}):n.jsx("div",{className:"grid grid-cols-1 md:[grid-template-columns:1fr_1.2fr_1fr] gap-2 mb-2 items-stretch min-w-0",children:n.jsxs("div",{className:"flex items-stretch justify-center md:px-3 min-w-0",children:[n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"You Remain"}),ge?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:x}),n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-x/a)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:bt})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:Ct>0?((a-x)/Ct*3).toFixed(1):"0.0"})]}),n.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[n.jsxs("span",{children:["Darts thrown: ",Ct]}),n.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(j=>n.jsx("span",{className:`w-2 h-2 rounded-full ${j<qt?"bg-emerald-400":"bg-white/20"}`},j))})]}),n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",er," · Hit ",wa]})]}),x<=170&&x>0&&(()=>{const A=ic(x,Pl)[0]||"—";return n.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[n.jsx("span",{className:"opacity-70",children:"Checkout"}),n.jsx("span",{className:"font-semibold",children:A})]})})()]}),n.jsx("div",{className:"flex items-stretch justify-end md:px-3 min-w-0 md:min-h-[45vh]",children:n.jsx(oc,{label:"Your Board",autoStart:!0,className:"min-w-0 h-full",style:{minHeight:"45vh"},fill:!0})}),n.jsxs("div",{className:`mt-2 ${ln==="small"?"p-2":ln==="large"?"p-4":"p-3"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${wt==="small"?"text-xs":wt==="large"?"text-base":"text-sm"}`,children:[n.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const j=ge?(e==null?void 0:e.username)||"You":i==="None"?"—":`${i} AI`,A=ge?x:i==="None"?0:v,B=ge?bt:Xr,W=ge?it:zn,ie=ge?Ct:Ms,Fe=a-(ge?x:i==="None"?a:v),Ve=ie>0?Fe/ie*3:0,Ie=`${S}-${N}`,Me=R.length>0?`${Math.min(...R.map(Ue=>Ue.doubleDarts+(Ue.checkoutDarts||0)))||0} darts`:"—";return n.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[n.jsx("div",{className:"opacity-80",children:"Current score"}),n.jsx("div",{className:"font-mono text-right",children:Ie}),n.jsx("div",{className:"opacity-80",children:"Current thrower"}),n.jsx("div",{className:"text-right font-semibold text-lg",children:j}),n.jsx("div",{className:"opacity-80",children:"Score remaining"}),n.jsx("div",{className:"text-right font-mono font-bold text-xl",children:A}),n.jsx("div",{className:"opacity-80",children:"3-dart avg"}),n.jsx("div",{className:"text-right font-mono",children:Ve.toFixed(1)}),n.jsx("div",{className:"opacity-80",children:"Last score"}),n.jsx("div",{className:"text-right font-mono",children:W||B}),n.jsx("div",{className:"opacity-80",children:"Best leg"}),n.jsx("div",{className:"text-right",children:Me})]})})()]}),n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[n.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[n.jsxs("span",{children:[i==="None"?"Opponent":`${i} AI`," Remain"]}),ge?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:i!=="None"?v:"N/A"}),i!=="None"&&n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-v/a)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:i==="None"?0:Xr})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:i!=="None"?Ms>0?((a-v)/Ms*3).toFixed(1):"0.0":"—"})]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",Ms]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",Qr," · Hit ",yr]})]})]})]})}),s!=="X01"?n.jsxs("div",{className:"space-y-2",children:[s==="Double Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"font-semibold",children:["Target: ",n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:((ff=xs[de])==null?void 0:ff.label)||"—"})]}),Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,onAutoDart:(j,A)=>{if((A==="DOUBLE"||A==="INNER_BULL")&&Tu(j,de)){const W=Dt+1,ie=de+1;nt(W),re(ie),W>=xs.length&&setTimeout(()=>{nt(0),re(0)},250)}},immediateAutoCommit:!0})}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&zm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:zm,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{j.key==="Enter"&&Hm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Hm,children:"Add"})]})]}),n.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",Dt," of 21"]})]}),s==="Around the Clock"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"font-semibold",children:["Target: ",n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:on[et]===25?"25 (Outer Bull)":on[et]===50?"50 (Inner Bull)":on[et]||"—"})]}),Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{Bc(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&Xm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Xm,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{j.key==="Enter"&&Qm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Qm,children:"Add"})]}),je>=on.length&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{ye(0),le(0)},children:"Reset"})]})]}),s==="Cricket"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{Zm(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&ef()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ef,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{We(oa()),st(0)},children:"Reset"})]})]}),s==="Shanghai"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{tf(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&nf()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:nf,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Oe(Cr()),st(0)},children:"Reset"})]})]}),s==="Halve It"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{sf(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&rf()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:rf,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ht(Er()),st(0)},children:"Reset"})]})]}),s==="High-Low"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{af(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&lf()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:lf,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{I(Tr()),st(0)},children:"Reset"})]})]}),s==="Bob's 27"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{Wm(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&Vm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Vm,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Gm,children:"Reset"})]})]}),s==="Count-Up"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:j=>Rc(j)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&(Rc(ve),ze(0))}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Rc(ve),ze(0)},children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{F(1),ct(0),H(0)},children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",$n,"/",me]})]}),s==="High Score"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:j=>Oc(j)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&(Oc(ve),ze(0))}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Oc(ve),ze(0)},children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Se(1),He(0),Ke(0)},children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",be,"/",zt]})]}),s==="Low Score"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:j=>_c(j)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&(_c(ve),ze(0))}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{_c(ve),ze(0)},children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{sn(1),Mt(0),va(0)},children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Lt,"/",Cs]})]}),s==="Checkout 170"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A)=>Jm(j,A==="MISS"?void 0:A)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{j.key==="Enter"&&Ji(!0)}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ji(!0),children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:hg,children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Jr," · Attempts: ",X," · Successes: ",K]})]}),s==="Checkout 121"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A)=>qm(j,A==="MISS"?void 0:A)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{j.key==="Enter"&&Ji(!1)}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ji(!1),children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:pg,children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",De," · Attempts: ",Te," · Successes: ",rn]})]}),s==="Treble Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm",children:"Target"}),n.jsx("select",{className:"input w-24",value:jn,onChange:j=>pn(parseInt(j.target.value,10)),children:Array.from({length:20},(j,A)=>A+1).map(j=>n.jsx("option",{value:j,children:j},j))}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:xg,children:"Reset"})]}),Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{Uc(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{if(j.key==="Enter"){const A=Nr(yn);A!=null&&Uc(A,void 0,void 0),un("")}}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const j=Nr(yn);j!=null&&Uc(j,void 0,void 0),un("")},children:"Add Dart"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",Bs," · Darts: ",an]})]}),s==="Baseball"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{gg(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:yg,children:"Reset"})})]}),s==="Golf"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{vg(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:bg,children:"Reset"})})]}),s==="Tic Tac Toe"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(j,A)=>A).map(j=>n.jsx("button",{className:`h-16 rounded-xl border ${Nn.board[j]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(Nn.finished||Nn.board[j])return;const A=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),B=A%3===0?"TRIPLE":A%2===0?"DOUBLE":"SINGLE",W=j,ie=li[W],Fe=ie.type==="BULL"?null:ie.num||null;wg(W,A,B,Fe)},children:Nn.board[j]||""},j))}),Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:jg,children:"Reset"})})]}),s==="American Cricket"&&n.jsxs(n.Fragment,{children:[Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{Ng(j,A==="MISS"?void 0:A,(B==null?void 0:B.sector)??null)}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ym,children:"Reset"})})]}),s==="Killer"&&n.jsx(n.Fragment,{children:gn?n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:lt.map(j=>{const A=cs[j.id],B=Fs[j.id];return n.jsxs("div",{className:`p-2 rounded-xl border ${A!=null&&A.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[n.jsxs("div",{className:"flex items-center justify-between text-xs",children:[n.jsx("div",{className:"font-semibold",children:j.name}),n.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${A!=null&&A.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:A!=null&&A.isKiller?"Killer":"Not Killer"})]}),n.jsxs("div",{className:"mt-1 text-sm",children:["Number: ",n.jsx("span",{className:"font-semibold",children:B})]}),n.jsxs("div",{className:"text-sm",children:["Lives: ",n.jsx("span",{className:"font-semibold",children:(A==null?void 0:A.lives)??0})]})]},j.id)})}),Pe&&n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(j,A,B)=>{if(us)return;const W=A==="MISS"?void 0:A,ie=(B==null?void 0:B.sector)??null,Fe=lt[Rn];Fe&&(An(Ve=>{const Ie={};Object.keys(Ve).forEach(qe=>Ie[qe]={...Ve[qe]});const Me=Mu(Fe.id,Ie,W,ie);if(Me.becameKiller)fe(`${Fe.name} became a Killer`);else if(Me.victimId){const qe=lt.find(tn=>tn.id===Me.victimId);fe(`${Fe.name} hit ${qe==null?void 0:qe.name}'s ${Fs[Me.victimId]} (${Me.livesRemoved} life${(Me.livesRemoved||0)>1?"s":""})`)}else fe("No effect");const Ue=Iu(Ie);return Ue&&Je(Ue),Ie}),Qn(Ve=>{const Ie=Ve+1;if(Ie>=3){let Me=Rn;for(let Ue=1;Ue<=lt.length;Ue++){const qe=(Rn+Ue)%lt.length,tn=lt[qe].id,hs=cs[tn];if(hs&&!hs.eliminated&&hs.lives>0){Me=qe;break}}return ds(Me),0}return Ie}))}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{if(j.key==="Enter"){if(us)return;const B=yn.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!B){un("");return}const W=B[1]||"S",ie=parseInt(B[2],10),Fe=W==="D"?"DOUBLE":W==="T"?"TRIPLE":"SINGLE",Ve=lt[Rn];An(Ie=>{const Me={};Object.keys(Ie).forEach(tn=>Me[tn]={...Ie[tn]});const Ue=Mu(Ve.id,Me,Fe,ie);if(Ue.becameKiller)fe(`${Ve.name} became a Killer`);else if(Ue.victimId){const tn=lt.find(hs=>hs.id===Ue.victimId);fe(`${Ve.name} hit ${tn==null?void 0:tn.name}'s ${Fs[Ue.victimId]} (${Ue.livesRemoved} life${(Ue.livesRemoved||0)>1?"s":""})`)}else fe("No effect");const qe=Iu(Me);return qe&&Je(qe),Me}),un(""),Qn(Ie=>{const Me=Ie+1;if(Me>=3){let Ue=Rn;for(let qe=1;qe<=lt.length;qe++){const tn=(Rn+qe)%lt.length,hs=lt[tn].id,ta=cs[hs];if(ta&&!ta.eliminated&&ta.lives>0){Ue=tn;break}}return ds(Ue),0}return Me})}}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let j=Rn;for(let A=1;A<=lt.length;A++){const B=(Rn+A)%lt.length,W=lt[B].id,ie=cs[W];if(ie&&!ie.eliminated&&ie.lives>0){j=B;break}}ds(j),Qn(0)},children:"Next Player"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{An({}),Xn({}),Ys(!1),ds(0),Qn(0),Je(null),fe("")},children:"Reset"})]}),us&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner: ",(hf=lt.find(j=>j.id===us))==null?void 0:hf.name," ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{An({}),Xn({}),Ys(!1),ds(0),Qn(0),Je(null),fe("")},children:"Play Again"})]})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"font-semibold",children:"Players"}),n.jsx("div",{className:"space-y-1",children:lt.map((j,A)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input",value:j.name,onChange:B=>{const W=B.target.value;Es(ie=>ie.map((Fe,Ve)=>Ve===A?{...Fe,name:W}:Fe))}}),n.jsx("button",{className:"btn px-2 py-1",onClick:()=>Es(B=>B.filter((W,ie)=>ie!==A)),disabled:lt.length<=2,children:"Remove"})]},j.id))}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn px-2 py-1",onClick:()=>Es(j=>{const A=`p${j.length+1}`;return[...j,{id:A,name:`Player ${j.length+1}`}]}),children:"Add Player"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(lt.length<2){alert("Need at least 2 players");return}const j=lt.map(W=>W.id),A=Hw(j),B={};j.forEach(W=>{B[W]=tg(A[W])}),Xn(A),An(B),ds(0),Qn(0),Je(null),fe("Assigned numbers"),Ys(!0)},children:"Assign Numbers & Start"})]})]})})]}):ge?n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"font-semibold",children:"Your Turn"}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:ve,onChange:j=>ze(Number(j.target.value||0)),onKeyDown:j=>{j.key==="Enter"&&(j.shiftKey?Sg():$m())}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$m,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D16, 5, 25, 50)",value:yn,onChange:j=>un(j.target.value),onKeyDown:j=>{j.key==="Enter"&&(j.shiftKey?cf():$c())}}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:cf,disabled:qt===0,children:"Replace Last"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$c,children:"Add"})]}),n.jsxs("div",{children:[n.jsx("textarea",{className:"input w-full h-24 resize-none",placeholder:`Type scores manually (one per line, e.g. T20
D16
5
25
50) - No camera needed!`,value:Dl,onChange:j=>Ia(j.target.value)}),n.jsxs("div",{className:"flex gap-2 mt-1",children:[n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:kg,children:"Add All Scores"}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Ia(""),children:"Clear"})]})]})]}),n.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Enter to Add · Shift+Enter to Replace Last"})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"font-semibold",children:[i==="None"?"Opponent":`${i} AI`," Turn"]}),i!=="None"?n.jsxs("div",{className:"text-sm text-slate-300",children:["Throwing in ",Math.ceil(xr/1e3),"s..."]}):n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn",onClick:()=>Tt(!0),children:"Switch Back to You"})})]}),n.jsx("div",{className:"h-1"})]})]})})}),c&&n.jsx(qw,{onClose:()=>u(!1)}),Fc&&n.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),n.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:"🔒"}),n.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),n.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),n.jsxs("button",{onClick:async()=>{try{const A=await(await fetch(`${Yw}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e==null?void 0:e.email})})).json();A.ok&&A.url?(window.location.href=A.url,A.development&&ue("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):A.error==="STRIPE_NOT_CONFIGURED"?ue("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):ue("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{ue("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM · ",ux(mx(),5)]})]})]}),h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs(Lr,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,children:[n.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),n.jsx("label",{className:"block mb-1",children:"Darts to hit double:"}),n.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(j=>n.jsx("button",{className:`btn ${te===j?"bg-brand-600":""}`,onClick:()=>L(j),children:j},j))}),n.jsx("label",{className:"block mb-1",children:"Darts for checkout:"}),n.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(j=>n.jsx("button",{className:`btn ${Q===j?"bg-brand-600":""}`,onClick:()=>oe(j),children:j},j))}),n.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[n.jsx("button",{className:"btn w-full",onClick:Cg,children:"Submit"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{w(!1),Aa()},children:"Rematch"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{w(!1),Ee(!1),g(!1)},children:"Back to Menu"})]})]})}),Wi&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:n.jsxs(Lr,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,children:[n.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),n.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[s," · ",a," start · First to ",E]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[n.jsx("div",{className:"text-sm font-semibold mb-1",children:"You"}),n.jsx("div",{className:"text-3xl font-extrabold",children:S}),n.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),n.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"3-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:ja>0?(Sl/ja*3).toFixed(1):"0.0"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"1-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:ja>0?(Sl/ja).toFixed(2):"0.00"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"180s"}),n.jsx("div",{className:"font-semibold",children:Oi})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"140+"}),n.jsx("div",{className:"font-semibold",children:_i})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"100+"}),n.jsx("div",{className:"font-semibold",children:Ui})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"High Checkout"}),n.jsx("div",{className:"font-semibold",children:zi||"—"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Att"}),n.jsx("div",{className:"font-semibold",children:er})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Hit"}),n.jsx("div",{className:"font-semibold",children:wa})]})]})]}),n.jsx("div",{className:"hidden md:flex items-center justify-center",children:n.jsxs("div",{className:"text-4xl font-black",children:[S," – ",N]})}),n.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[n.jsx("div",{className:"text-sm font-semibold mb-1",children:i==="None"?"Opponent":`${i} AI`}),n.jsx("div",{className:"text-3xl font-extrabold",children:N}),n.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),n.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"3-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:Zr>0?(El/Zr*3).toFixed(1):"0.0"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"1-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:Zr>0?(El/Zr).toFixed(2):"0.00"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"180s"}),n.jsx("div",{className:"font-semibold",children:Bi})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"140+"}),n.jsx("div",{className:"font-semibold",children:$i})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"100+"}),n.jsx("div",{className:"font-semibold",children:Fi})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"High Checkout"}),n.jsx("div",{className:"font-semibold",children:Hi||"—"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Att"}),n.jsx("div",{className:"font-semibold",children:Qr})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Hit"}),n.jsx("div",{className:"font-semibold",children:yr})]})]})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:R.map((j,A)=>n.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${j.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",A+1,": ",j.winner==="player"?"You":i==="None"?"Opp":"AI"," · Dbl ",j.doubleDarts," · CO ",j.checkoutDarts]},A))})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Shot Heat Map"}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black p-3",children:n.jsx($w,{})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>Ma(!1),children:"Close"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{Ma(!1),Aa()},children:"Rematch"})]})]})}),R.length>0&&n.jsxs("div",{className:"mt-4",children:[n.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),n.jsx("ul",{children:R.map((j,A)=>n.jsxs("li",{children:["Leg ",A+1,": Double darts: ",j.doubleDarts,", Checkout darts: ",j.checkoutDarts]},A))})]})]})}const ig="ndn:messages:inbox",og="ndn:messages:unread";function Qw(){try{const e=localStorage.getItem(ig),t=e?JSON.parse(e):[],s=Number(localStorage.getItem(og)||"0")||0;return{inbox:Array.isArray(t)?t.filter(a=>a&&typeof a.id=="string").slice(0,200):[],unread:s}}catch{return{inbox:[],unread:0}}}function xo(e,t){try{localStorage.setItem(ig,JSON.stringify(e))}catch{}try{localStorage.setItem(og,String(t))}catch{}}const Bh=Qw(),Pu=ya((e,t)=>({inbox:Bh.inbox,unread:Bh.unread,inGame:!1,setInGame:s=>e({inGame:s}),add:s=>e(r=>{const a=r.inbox.some(o=>o.id===s.id&&o.ts===s.ts),l=a?r.inbox:[s,...r.inbox].slice(0,200),i=r.unread+(a?0:1);return xo(l,i),{inbox:l,unread:i}}),load:s=>e(r=>{const a=[...s].sort((l,i)=>i.ts-l.ts).slice(0,200);return xo(a,r.unread),{inbox:a,unread:r.unread}}),markAllRead:()=>{const s=t();xo(s.inbox,0),e({unread:0})},remove:s=>e(r=>{const a=r.inbox.filter(i=>i.id!==s),l=r.unread;return xo(a,l),{inbox:a,unread:l}})})),cg=[/\b(f+[\W_]*u+[\W_]*c+[\W_]*k+)\b/gi,/\b(s+[\W_]*h+[\W_]*i+[\W_]*t+)\b/gi,/\b(b+[\W_]*i+[\W_]*t+[\W_]*c+[\W_]*h+)\b/gi,/\b(a+[\W_]*s+[\W_]*s+[\W_]*h+[\W_]*o+[\W_]*l+[\W_]*e+)\b/gi,/\b(d+[\W_]*a+[\W_]*m+[\W_]*n+)\b/gi,/\b(c+[\W_]*r+[\W_]*a+[\W_]*p+)\b/gi,/\b(p+[\W_]*i+[\W_]*s+[\W_]*s+)\b/gi];function Zw(e){return e.replace(/[\p{L}\p{N}]/gu,"*")}function dg(e){if(!e)return e;let t=e;for(const s of cg)t=t.replace(s,r=>Zw(r));return t}function ej(e){return e?cg.some(t=>t.test(e)):!1}function Lc({tabs:e,active:t,onChange:s,className:r}){return n.jsxs("div",{className:`relative ${r||""}`,children:[n.jsx("div",{className:"absolute inset-0 rounded-xl bg-white/5 backdrop-blur-md border border-white/10 pointer-events-none"}),n.jsx("div",{className:"relative overflow-x-auto no-scrollbar py-1 px-1",children:n.jsx("div",{className:"flex items-center gap-2 min-w-max",children:e.map(a=>{const l=a.key===t;return n.jsx("button",{type:"button",onClick:()=>s(a.key),className:`transition-all select-none whitespace-nowrap rounded-full px-4 py-2 text-sm font-semibold shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60 active:scale-[0.98]
                  ${l?"bg-gradient-to-r from-indigo-500 to-fuchsia-500 text-white shadow-indigo-500/30":"bg-white/10 text-slate-100 hover:bg-white/15"}
                `,"aria-pressed":l,children:a.label},a.key)})})}),n.jsx("style",{children:`
        /* Hide scrollbars on WebKit/Firefox for a cleaner pill row */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      `})]})}function tj(e){if(!e)return"";const t=Math.floor((Date.now()-e)/1e3);if(t<60)return`${t}s ago`;const s=Math.floor(t/60);if(s<60)return`${s}m ago`;const r=Math.floor(s/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}function nj({user:e}){const t=xl(),s=String((e==null?void 0:e.email)||"").toLowerCase(),[r,a]=m.useState([]),[l,i]=m.useState([]),[o,c]=m.useState([]),[u,d]=m.useState(""),[g,x]=m.useState("all"),[y,v]=m.useState(!1),C=Pu(),[D,b]=m.useState([]),[h,w]=m.useState([]),[E,p]=m.useState({show:!1});async function S(){if(s)try{const[L,Q,oe,R]=await Promise.all([fetch(`/api/friends/list?email=${encodeURIComponent(s)}`).then(Z=>Z.json()),fetch(`/api/friends/suggested?email=${encodeURIComponent(s)}`).then(Z=>Z.json()),fetch(`/api/friends/requests?email=${encodeURIComponent(s)}`).then(Z=>Z.json()),fetch(`/api/friends/outgoing?email=${encodeURIComponent(s)}`).then(Z=>Z.json())]);a(L.friends||[]),i(Q.suggestions||[]),b(oe.requests||[]),w(R.requests||[])}catch{}}m.useEffect(()=>{S()},[s]);async function P(L){if(d(L),!L){c([]);return}try{const oe=await(await fetch(`/api/friends/search?q=${encodeURIComponent(L)}`)).json();c(oe.results||[])}catch{}}async function N(L){if(!(!s||!L)){v(!0);try{await fetch("/api/friends/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,friend:L})}),await S(),d(""),c([]),t("Friend added",{type:"success"})}finally{v(!1)}}}async function q(L){if(!(!s||!L)){v(!0);try{await fetch("/api/friends/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,friend:L})}),await S(),t("Friend removed",{type:"info"})}finally{v(!1)}}}const G=m.useMemo(()=>g==="all"?r:r.filter(L=>(L.status||"offline")===g),[r,g]);async function _(L){if(!L){t("Room unavailable",{type:"error"});return}try{const Q=new CustomEvent("ndn:spectate-request",{detail:{roomId:L}});window.dispatchEvent(Q),t("Opening spectator view…",{type:"info"})}catch{}}const te=D.length+h.length;return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Friends"}),n.jsx("p",{className:"mb-2 text-brand-600",children:"Manage your friends. See who’s online, in-game, or offline; find new teammates; and invite people to play."}),n.jsxs("div",{className:"text-xs opacity-70 mb-3",children:["Online: ",r.filter(L=>L.status==="online").length," · In-game: ",r.filter(L=>L.status==="ingame").length," · Offline: ",r.filter(L=>!L.status||L.status==="offline").length]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[n.jsxs("div",{className:"md:col-span-2 p-3 rounded-2xl bg-black/30 border border-white/10",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("div",{className:"font-semibold text-white/90",children:"Your Friends"})}),n.jsx(Lc,{tabs:[{key:"all",label:"All"},{key:"online",label:"Online"},{key:"ingame",label:"In-Game"},{key:"offline",label:"Offline"},{key:"requests",label:`Requests ${te>0?"("+te+")":""}`}],active:g,onChange:L=>x(L),className:"mb-3"}),g==="requests"?n.jsx("ul",{className:"space-y-2",children:te>0?n.jsxs(n.Fragment,{children:[D.length>0&&D.map(L=>n.jsxs("li",{className:"p-3 rounded bg-black/20 flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-semibold text-lg",children:L.fromUsername||L.fromEmail||"Unknown User"}),n.jsx("span",{className:"text-xs bg-blue-600/20 text-blue-400 px-2 py-1 rounded",children:"Incoming"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{v(!0);try{if((await fetch("/api/friends/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,requester:L.fromEmail})})).ok){b(R=>R.filter(Z=>Z.id!==L.id));const oe={email:L.fromEmail,username:L.fromUsername,status:"offline"};a(R=>[...R,oe]),w(R=>R.filter(Z=>Z.toEmail!==L.fromEmail)),t("Friend request accepted",{type:"success"}),setTimeout(()=>S(),100)}else t("Failed to accept request",{type:"error"})}catch{t("Error accepting request",{type:"error"})}finally{v(!1)}},children:"Accept"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:async()=>{v(!0);try{(await fetch("/api/friends/decline",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,requester:L.fromEmail})})).ok?(b(oe=>oe.filter(R=>R.id!==L.id)),w(oe=>oe.filter(R=>R.toEmail!==L.fromEmail)),t("Friend request declined",{type:"info"}),setTimeout(()=>S(),100)):t("Failed to decline request",{type:"error"})}finally{v(!1)}},children:"Decline"})]})]},`incoming-${L.id||L.fromEmail}`)),h.length>0&&h.map(L=>n.jsxs("li",{className:"p-3 rounded bg-black/20 flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-semibold text-lg",children:L.toUsername||L.toEmail||"Unknown User"}),n.jsx("span",{className:"text-xs bg-amber-600/20 text-amber-400 px-2 py-1 rounded",children:"Pending"})]}),n.jsx("button",{className:"btn bg-slate-600 hover:bg-slate-700 self-start",onClick:async()=>{v(!0);try{(await fetch("/api/friends/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,friend:L.toEmail})})).ok?(w(oe=>oe.filter(R=>R.id!==L.id)),t("Friend request cancelled",{type:"info"}),setTimeout(()=>S(),100)):t("Failed to cancel request",{type:"error"})}finally{v(!1)}},children:"Cancel"})]},`outgoing-${L.id||L.toEmail}`))]}):n.jsx("li",{className:"text-sm opacity-70",children:"No friend requests yet."})}):n.jsxs("ul",{className:"space-y-2",children:[G.map(L=>n.jsxs("li",{className:"p-2 rounded bg-black/20 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${L.status==="online"?"bg-emerald-400":L.status==="ingame"?"bg-amber-400":"bg-slate-400"}`}),n.jsx("span",{className:"font-semibold",children:L.username||L.email}),n.jsxs("span",{className:"text-xs opacity-70",children:[L.status||"offline",L.status!=="online"&&L.lastSeen?` · ${tj(L.lastSeen)}`:""]}),L.status==="ingame"&&L.match&&n.jsxs("span",{className:"text-[10px] opacity-70 px-2 py-0.5 rounded bg-indigo-500/20 border border-indigo-600/30",children:[L.match.game," ",L.match.mode==="firstto"?"FT":"BO"," ",L.match.value,L.match.game==="X01"&&L.match.startingScore?` · ${L.match.startingScore}`:""]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[L.status==="ingame"&&L.roomId&&n.jsx("button",{className:"btn",onClick:()=>_(L.roomId),children:"Spectate"}),n.jsx("button",{className:"btn",disabled:y||L.status!=="online"&&L.status!=="ingame",onClick:async()=>{v(!0);try{const oe=await(await fetch("/api/friends/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromEmail:s,toEmail:L.email,game:"X01",mode:"bestof",value:3,startingScore:501})})).json().catch(()=>({}));oe!=null&&oe.delivered?t("Invite sent",{type:"success"}):t("Friend is offline; invite queued",{type:"info"})}finally{v(!1)}},children:"Invite"}),n.jsx("button",{className:"btn",disabled:y,onClick:()=>p({show:!0,toUser:L.username||L.email,toEmail:L.email}),children:"Message"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:y,onClick:()=>q(L.email),children:"Remove"})]})]},L.email)),G.length===0&&n.jsxs("li",{className:"text-sm opacity-70",children:["No friends ",g!=="all"?`in ${g}`:""," yet."]})]})]}),n.jsxs("div",{className:"p-3 rounded-2xl bg-black/20 border border-white/10",children:[n.jsx("div",{className:"font-semibold mb-2 text-white/90",children:"Find Friends"}),n.jsx("input",{className:"input w-full mb-2",placeholder:"Search by name or email",value:u,onChange:L=>P(L.target.value)}),n.jsxs("ul",{className:"space-y-1 mb-3 max-h-48 overflow-auto",children:[o.map(L=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/10",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${L.status==="online"?"bg-emerald-400":L.status==="ingame"?"bg-amber-400":"bg-slate-400"}`}),n.jsx("span",{children:L.username||L.email})]}),n.jsx("button",{className:"btn",disabled:y,onClick:()=>N(L.email),children:"Add"})]},L.email)),o.length===0&&n.jsx("li",{className:"text-xs opacity-60",children:"Type to search…"})]}),n.jsx("div",{className:"font-semibold mb-1 text-white/90",children:"Suggested"}),n.jsxs("ul",{className:"space-y-1 max-h-48 overflow-auto",children:[l.map(L=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/10",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${L.status==="online"?"bg-emerald-400":L.status==="ingame"?"bg-amber-400":"bg-slate-400"}`}),n.jsx("span",{children:L.username||L.email})]}),n.jsx("button",{className:"btn",disabled:y,onClick:()=>N(L.email),children:"Add"})]},L.email)),l.length===0&&n.jsx("li",{className:"text-xs opacity-60",children:"No suggestions right now."})]})]})]}),n.jsxs("div",{className:"p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:"Messages"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>C.markAllRead(),children:"Mark all read"})]}),C.inbox.length===0?n.jsx("div",{className:"text-sm opacity-70",children:"No messages yet."}):n.jsx("ul",{className:"space-y-2 max-h-72 overflow-auto",children:C.inbox.map(L=>n.jsxs("li",{className:"p-2 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:L.from})," ",n.jsxs("span",{className:"opacity-70 text-xs",children:["· ",new Date(L.ts).toLocaleString()]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn px-2 py-1 text-xs",onClick:()=>p({show:!0,toUser:L.from,toEmail:L.from,replyTo:L.from}),children:"Reply"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-2 py-1 text-xs",title:"Delete this message",onClick:()=>C.remove(L.id),children:"Delete"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-2 py-1 text-xs",onClick:async()=>{const Q=prompt("Report reason (what happened)?");if(Q)try{await fetch("/api/friends/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reporterEmail:s,offenderEmail:L.from,reason:Q,messageId:L.id})}),t("Report sent to admin",{type:"info"})}catch{}},children:"Report"})]})]}),n.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:dg(L.message)})]},L.id))})]}),E.show&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsx("div",{className:"text-center mb-4",children:n.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Type Message To ",E.toUser]})}),n.jsx("textarea",{className:"w-full h-32 bg-slate-700 border border-slate-600 rounded p-3 text-white placeholder-slate-400 resize-none",placeholder:"Type your message here...",id:"message-input",autoFocus:!0}),n.jsxs("div",{className:"flex gap-3 mt-4",children:[n.jsx("button",{className:"flex-1 btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{var oe;const L=document.getElementById("message-input"),Q=(oe=L==null?void 0:L.value)==null?void 0:oe.trim();if(Q){v(!0);try{await fetch("/api/friends/message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromEmail:s,toEmail:E.toEmail,message:Q})}),t("Message sent",{type:"success"}),p({show:!1})}catch{t("Failed to send message",{type:"error"})}finally{v(!1)}}},disabled:y,children:"Send"}),n.jsx("button",{className:"flex-1 btn bg-slate-600 hover:bg-slate-700",onClick:()=>p({show:!1}),children:"Cancel"})]})]})})]})}function sj(){const e=wu(s=>s.toasts),t=wu(s=>s.remove);return e.length?n.jsxs(n.Fragment,{children:[e.filter(s=>s.type==="success").map(s=>n.jsx("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50",children:n.jsx("div",{className:"p-4 rounded-lg shadow-lg border text-sm bg-emerald-700/90 border-emerald-500/60 text-white max-w-sm text-center",children:n.jsx("div",{className:"flex items-center justify-center gap-2",children:n.jsx("span",{className:"flex-1 font-semibold",children:s.message})})})},s.id)),e.filter(s=>s.type!=="success").length>0&&n.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2 sm:right-4 sm:left-auto left-1/2 -translate-x-1/2 sm:translate-x-0 w-[calc(100%-1.5rem)] sm:w-auto max-w-sm",children:e.filter(s=>s.type!=="success").map(s=>n.jsx("div",{className:`p-3 rounded-lg shadow-lg border text-sm ${s.type==="error"?"bg-rose-700/80 border-rose-500/60 text-white":"bg-black/70 border-slate-700 text-slate-100"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"flex-1",children:s.message}),n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>t(s.id),children:"Dismiss"})]})},s.id))})]}):null}function Lu({data:e,height:t=220,barWidth:s=28,gap:r=6,showValues:a=!1}){const l=Math.max(1,...e.map(o=>o.value)),i=e.length*(s+r);return n.jsx("div",{className:"w-full overflow-x-auto",children:n.jsx("div",{className:"relative",style:{height:t,width:Math.max(600,i)},children:n.jsx("div",{className:"absolute inset-0 flex items-end",children:e.map((o,c)=>{const u=Math.round(o.value/l*(t-40));return n.jsxs("div",{className:"flex flex-col items-center justify-end",style:{width:s,marginRight:r},children:[n.jsx("div",{className:"w-full rounded-t-md bg-gradient-to-b from-indigo-400 to-fuchsia-500 shadow-sm",style:{height:u},title:`${o.label}: ${o.value}`}),a&&n.jsx("div",{className:"text-[10px] mt-1 opacity-80",children:o.value}),n.jsx("div",{className:"text-[10px] mt-1 opacity-70 select-none",children:o.label})]},c)})})})})}const rj=["X01","Double Practice"],br=["Around the Clock","Cricket","Halve It","Shanghai","High-Low","Killer","Bob's 27","Count-Up","High Score","Low Score","Checkout 170","Checkout 121","Treble Practice","Baseball","Golf","Tic Tac Toe","American Cricket"],ml=[...rj,...br],aj="daviesfamily108@gmail.com";function lj({user:e}){var Pt;const[t,s]=m.useState([]),[r,a]=m.useState(""),[l,i]=m.useState(null),[o,c]=m.useState(""),[u,d]=m.useState(!1),[g,x]=m.useState([]),[y,v]=m.useState([]),[C,D]=m.useState(""),[b,h]=m.useState([]),[w,E]=m.useState({title:"Official Tournament",game:"X01",mode:"bestof",value:3,description:"",startAt:new Date(Date.now()+2*60*60*1e3).toISOString().slice(0,16),checkinMinutes:30,capacity:16,prizeType:"premium",prizeAmount:3,currency:"GBP",prizeNotes:""}),[p,S]=m.useState({reset:{},reminder:{},confirmEmail:{},changed:{}}),[P,N]=m.useState({open:!1}),[q,G]=m.useState("general"),_=((Pt=e==null?void 0:e.email)==null?void 0:Pt.toLowerCase())===aj,[te,L]=m.useState([]),[Q,oe]=m.useState([]),[R,Z]=m.useState([]),[$,Y]=m.useState(null),[ue,Ce]=m.useState(0);m.useEffect(()=>{const I=()=>Ce(ee=>ee+1);return window.addEventListener("ndn:stats-updated",I),()=>window.removeEventListener("ndn:stats-updated",I)},[]);const Ee=m.useMemo(()=>Im(ml),[ue]),ot=m.useMemo(()=>ml.map(I=>{var ee,st;return{label:I,value:((ee=Ee[I])==null?void 0:ee.played)||0,won:((st=Ee[I])==null?void 0:st.won)||0}}),[Ee]);async function he(){try{const ee=await(await fetch("/api/admins")).json();if(s(Array.isArray(ee.admins)?ee.admins:[]),_){const st=await fetch(`/api/admin/status?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);st.ok&&i(await st.json());const yt=await fetch(`/api/admin/tournaments?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(yt.ok){const Nt=await yt.json();x(Array.isArray(Nt.tournaments)?Nt.tournaments:[])}const dn=await fetch(`/api/admin/reports?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(dn.ok){const Nt=await dn.json();oe(Array.isArray(Nt.reports)?Nt.reports:[])}const Qt=await fetch(`/api/admin/premium-winners?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(Qt.ok){const Nt=await Qt.json();L(Array.isArray(Nt.winners)?Nt.winners:[])}const rt=await fetch(`/api/admin/wallet/withdrawals?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(rt.ok){const Nt=await rt.json();v(Array.isArray(Nt.withdrawals)?Nt.withdrawals:[])}}}catch{}}m.useEffect(()=>{he()},[]);async function Ze(){r&&(await fetch("/api/admins/grant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,requesterEmail:e==null?void 0:e.email})}),a(""),he())}async function ft(I){await fetch("/api/admins/revoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:I,requesterEmail:e==null?void 0:e.email})}),he()}async function Ae(I,ee){I&&(await fetch("/api/admin/premium/grant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:I,days:ee,requesterEmail:e==null?void 0:e.email})}),await he())}async function ut(I){await fetch("/api/admin/premium/revoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:I,requesterEmail:e==null?void 0:e.email})}),await he()}async function ge(I){d(!0);try{await fetch("/api/admin/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:I,requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function Tt(){if(o.trim()){d(!0);try{await fetch("/api/admin/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:o,requesterEmail:e==null?void 0:e.email})}),c(""),await he()}finally{d(!1)}}}async function ve(){if(C.trim())try{const I=await fetch(`/api/admin/users/search?q=${encodeURIComponent(C)}&requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(I.ok){const ee=await I.json();h(Array.isArray(ee.users)?ee.users:[])}}catch(I){console.error("Search failed:",I)}}async function ze(I){try{await fetch("/api/admin/users/ban",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:I,requesterEmail:e==null?void 0:e.email})}),await ve()}catch(ee){console.error("Ban failed:",ee)}}async function de(I){try{await fetch("/api/admin/users/unban",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:I,requesterEmail:e==null?void 0:e.email})}),await ve()}catch(ee){console.error("Unban failed:",ee)}}async function re(){d(!0);try{const I=new Date(w.startAt).getTime();await fetch("/api/tournaments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:w.title,game:w.game,mode:w.mode,value:Number(w.value),description:w.description,startAt:I,checkinMinutes:Number(w.checkinMinutes),capacity:Number(w.capacity),creatorEmail:e==null?void 0:e.email,creatorName:e==null?void 0:e.username,requesterEmail:e==null?void 0:e.email,official:!0,prizeType:w.prizeType,prizeAmount:Number(w.prizeAmount||0),currency:w.currency,prizeNotes:w.prizeNotes})}),await he()}finally{d(!1)}}async function Dt(I,ee){d(!0);try{await fetch("/api/admin/tournaments/winner",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I,winnerEmail:ee,requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function nt(I){d(!0);try{await fetch("/api/admin/tournaments/mark-paid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I,requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function et(I){d(!0);try{await fetch("/api/admin/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I,requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function le(){d(!0);try{await fetch("/api/admin/tournaments/reseed-weekly",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function je(I,ee){d(!0);try{await fetch("/api/admin/wallet/withdrawals/decide",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:I,approve:ee,requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function ye(I){d(!0);try{await fetch("/api/admin/matches/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:I,requesterEmail:e==null?void 0:e.email})}),await he()}finally{d(!1)}}async function pe(){try{const I=await fetch(`/api/admin/logs?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(I.ok){const ee=await I.json();ee!=null&&ee.ok&&Z(ee.logs||[])}}catch(I){console.error("Failed to fetch logs:",I)}}async function We(){try{const I=await fetch(`/api/admin/system-health?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(I.ok){const ee=await I.json();ee!=null&&ee.ok&&Y(ee.health)}}catch(I){console.error("Failed to fetch system health:",I)}}async function mt(){try{const I=await fetch(`/api/admin/email-copy?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(I.ok){const ee=await I.json();ee!=null&&ee.ok&&S(ee.copy||p)}}catch{}}m.useEffect(()=>{_&&mt()},[_]),m.useEffect(()=>{_&&(q==="general"||q==="maintenance")&&(pe(),We())},[_,q]);async function Oe(I,ee){await fetch("/api/admin/email-copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requesterEmail:e==null?void 0:e.email,kind:I,...ee})}),await mt()}async function $t(I){try{const st=await(await fetch(`/api/email/preview?kind=${encodeURIComponent(I)}&requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`)).text();N({open:!0,kind:I,html:st})}catch{N({open:!0,kind:I,html:'<!doctype html><html><body style="font-family:sans-serif;padding:16px">Failed to load preview.</body></html>'})}}m.useEffect(()=>{if(!P.open)return;function I(ee){ee.key==="Escape"&&N({open:!1})}return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[P.open]);function ht({kind:I,label:ee}){const st=I==="confirm-email"?"confirmEmail":I==="changed"?"changed":I,yt=(p==null?void 0:p[st])||{title:"",intro:"",buttonLabel:""},[dn,Qt]=m.useState(yt.title||""),[rt,Nt]=m.useState(yt.intro||""),[xt,hn]=m.useState(yt.buttonLabel||"");return m.useEffect(()=>{Qt(yt.title||""),Nt(yt.intro||""),hn(yt.buttonLabel||"")},[yt.title,yt.intro,yt.buttonLabel]),n.jsxs("div",{className:"p-2 rounded bg-black/20 space-y-2",children:[n.jsx("div",{className:"font-semibold",children:ee}),n.jsx("input",{className:"input w-full",placeholder:"Title (optional)",value:dn,onChange:vt=>Qt(vt.target.value)}),n.jsx("textarea",{className:"input w-full",rows:2,placeholder:"Intro line (optional)",value:rt,onChange:vt=>Nt(vt.target.value)}),n.jsx("input",{className:"input w-full",placeholder:"Button label (optional)",value:xt,onChange:vt=>hn(vt.target.value)}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("a",{className:"btn",href:`/api/email/preview?kind=${encodeURIComponent(I)}&requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`,target:"_blank",rel:"noreferrer",children:"Preview"}),n.jsx("button",{className:"btn",type:"button",onClick:()=>$t(I),children:"Popup"}),n.jsx("button",{className:"btn",onClick:()=>Oe(I,{title:dn,intro:rt,buttonLabel:xt}),children:"Save"})]})]})}return _?n.jsxs("div",{className:"space-y-4",children:[_&&n.jsx(Lc,{tabs:[{key:"general",label:"General"},{key:"maintenance",label:"Maintenance"},{key:"premium",label:"Premium"}],active:q,onChange:I=>G(I),className:"mb-4"}),q==="general"&&n.jsxs(n.Fragment,{children:[_&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Game Usage"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Bar height shows total plays per mode. Wins are listed under each label. This helps decide which modes to keep or iterate on."}),n.jsxs("div",{className:"rounded-xl border border-indigo-500/40 bg-indigo-500/10 p-3",children:[n.jsx(Lu,{data:ot.map(I=>({label:I.label,value:I.value}))}),n.jsx("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 text-[11px] opacity-80",children:ot.map((I,ee)=>n.jsxs("div",{className:"flex items-center justify-between px-2 py-1 rounded-md bg-white/5 border border-white/10",children:[n.jsx("span",{className:"truncate mr-2",children:I.label}),n.jsxs("span",{className:"whitespace-nowrap",children:["Played ",I.value," · Won ",I.won]})]},ee))})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Admin Control"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Grant or revoke Admin to trusted users. Only the owner can perform these actions."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"user@example.com",value:r,onChange:I=>a(I.target.value)}),n.jsx("button",{className:"btn",disabled:u,onClick:Ze,children:"Grant"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:u,onClick:()=>ft(r),children:"Revoke"})]}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Current Admins:"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.map(I=>n.jsx("div",{className:"px-2 py-1 rounded bg-indigo-600/20 border border-indigo-500/40 text-sm",children:I},I))}),n.jsx("hr",{className:"border-indigo-500/20 my-4"}),n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Premium Access Control"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Grant or revoke Premium subscription access to users (grants 30 days)."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"user@example.com",value:r,onChange:I=>a(I.target.value)}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",disabled:u||!r.trim(),onClick:()=>Ae(r,30),children:"Grant Premium"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:u,onClick:()=>ut(r),children:"Revoke Premium"})]}),n.jsx("div",{className:"text-sm opacity-80",children:"Premium grants provide 30 days of unlimited access to all features."})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Tournament Premium Winners"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Users who have won premium prizes in tournaments and need access granted."}),n.jsxs("div",{className:"space-y-2",children:[g.filter(I=>I.status==="completed"&&I.winnerEmail&&I.prizeType==="premium").map(I=>{const ee=te.find(yt=>yt.email===I.winnerEmail),st=ee&&!ee.expired;return n.jsxs("div",{className:"p-3 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:I.title}),n.jsx("div",{className:"text-xs opacity-70",children:new Date(I.startAt).toLocaleDateString()})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:I.winnerEmail}),n.jsxs("div",{className:"text-xs opacity-70",children:["Prize: ",I.prizeAmount," month",I.prizeAmount>1?"s":""," PREMIUM"]})]}),n.jsx("div",{className:"flex items-center gap-2",children:st?n.jsx("span",{className:"px-2 py-1 rounded bg-emerald-600 text-xs",children:"Access Granted"}):n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-xs",disabled:u,onClick:()=>Ae(I.winnerEmail,I.prizeAmount*30*24*60*60*1e3),children:"Grant Access"})})]})]},I.id)}),g.filter(I=>I.status==="completed"&&I.winnerEmail&&I.prizeType==="premium").length===0&&n.jsx("div",{className:"text-center py-4 text-sm opacity-60",children:"No completed premium tournaments."})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Announcements"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Send a message to all users. This will appear as a toast notification."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{className:"input flex-1",placeholder:"Announcement message...",value:o,onChange:I=>c(I.target.value)}),n.jsx("button",{className:"btn",disabled:u||!o.trim(),onClick:Tt,children:"Send"})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"User Search"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Search for users by email or name."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"Search users...",value:C,onChange:I=>D(I.target.value)}),n.jsx("button",{className:"btn",disabled:u,onClick:ve,children:"Search"})]}),b.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Results:"}),b.map(I=>n.jsx("div",{className:"p-2 rounded bg-black/20 text-sm flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:I.name||"No name"}),n.jsx("div",{className:"opacity-70",children:I.email}),n.jsxs("div",{className:"opacity-60 text-xs",children:["Joined ",new Date(I.createdAt).toLocaleDateString()]})]})},I.email))]})]}),_&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Tournaments Management"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-2",children:"Create Official"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("input",{className:"input w-full",placeholder:"Title",value:w.title,onChange:I=>E(ee=>({...ee,title:I.target.value}))}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsx("select",{className:"input",value:w.game,onChange:I=>E(ee=>({...ee,game:I.target.value})),children:["X01","Around the Clock","Cricket","Halve It","Shanghai","High-Low"].map(I=>n.jsx("option",{value:I,children:I},I))}),n.jsxs("select",{className:"input",value:w.mode,onChange:I=>E(ee=>({...ee,mode:I.target.value})),children:[n.jsx("option",{value:"bestof",children:"Best of"}),n.jsx("option",{value:"firstto",children:"First to"})]}),n.jsx("input",{className:"input",type:"number",min:1,value:w.value,onChange:I=>E(ee=>({...ee,value:Number(I.target.value)}))})]}),n.jsx("textarea",{className:"input w-full",rows:2,placeholder:"Description",value:w.description,onChange:I=>E(ee=>({...ee,description:I.target.value}))}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsx("input",{className:"input",type:"datetime-local",value:w.startAt,onChange:I=>E(ee=>({...ee,startAt:I.target.value}))}),n.jsx("input",{className:"input",type:"number",min:0,value:w.checkinMinutes,onChange:I=>E(ee=>({...ee,checkinMinutes:Number(I.target.value)}))})]}),n.jsx("input",{className:"input w-full",type:"number",min:6,max:64,value:w.capacity,onChange:I=>E(ee=>({...ee,capacity:Number(I.target.value)}))}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[n.jsxs("select",{className:"input",value:w.prizeType,onChange:I=>{const ee=I.target.value;E(st=>({...st,prizeType:ee,prizeAmount:ee==="premium"?3:0}))},children:[n.jsx("option",{value:"premium",children:"PREMIUM"}),n.jsx("option",{value:"cash",children:"Cash"})]}),w.prizeType==="premium"?n.jsxs("select",{className:"input",value:w.prizeAmount,onChange:I=>E(ee=>({...ee,prizeAmount:Number(I.target.value)})),children:[n.jsx("option",{value:1,children:"1 month"}),n.jsx("option",{value:3,children:"3 months"})]}):n.jsx("input",{className:"input",type:"number",min:0,value:w.prizeAmount,onChange:I=>E(ee=>({...ee,prizeAmount:Number(I.target.value)}))}),n.jsxs("select",{className:"input",disabled:w.prizeType!=="cash",value:w.currency,onChange:I=>E(ee=>({...ee,currency:I.target.value})),children:[n.jsx("option",{value:"GBP",children:"GBP"}),n.jsx("option",{value:"USD",children:"USD"}),n.jsx("option",{value:"EUR",children:"EUR"}),n.jsx("option",{value:"CAD",children:"CAD"}),n.jsx("option",{value:"AUD",children:"AUD"})]})]}),n.jsx("input",{className:"input w-full",placeholder:"Prize notes (optional)",value:w.prizeNotes,onChange:I=>E(ee=>({...ee,prizeNotes:I.target.value}))}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{className:"btn",disabled:u,onClick:re,children:"Create"})})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-2",children:"Existing"}),n.jsxs("ul",{className:"space-y-2",children:[g.map(I=>n.jsxs("li",{className:"p-2 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"font-semibold",children:I.title}),n.jsx("div",{className:"opacity-70",children:I.status})]}),n.jsxs("div",{className:"opacity-80",children:[I.game," · ",I.mode==="firstto"?"FT":"BO"," ",I.value," · ",new Date(I.startAt).toLocaleString()," · ",I.capacity," cap"]}),I.prize&&n.jsxs("div",{className:"text-xs mt-1",children:["Prize: ",I.prizeType==="cash"&&I.prizeAmount?`${I.currency||"USD"} ${I.prizeAmount}`:`${I.prizeAmount||3} month${(I.prizeAmount||3)>1?"s":""} PREMIUM`," ",I.prizeType==="cash"&&I.status==="completed"&&I.payoutStatus&&n.jsx("span",{className:`ml-2 px-1.5 py-0.5 rounded ${I.payoutStatus==="paid"?"bg-emerald-600":"bg-amber-600"}`,children:I.payoutStatus})]}),n.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn",disabled:u||I.status!=="scheduled",onClick:()=>Dt(I.id,prompt("Winner email?")||""),children:"Set Winner"}),I.prizeType==="cash"&&I.status==="completed"&&I.payoutStatus!=="paid"&&n.jsx("button",{className:"btn",disabled:u,onClick:()=>nt(I.id),children:"Mark Paid"})]})]},I.id)),g.length===0&&n.jsx("li",{className:"opacity-60",children:"No tournaments."})]}),n.jsx("div",{className:"mt-3 flex justify-end",children:n.jsx("button",{className:"btn",disabled:u,onClick:le,children:"Reseed Weekly Giveaway"})})]})]})]}),_&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Email Templates"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Customize titles, intro lines, and button text. Previews open in a new tab or as a popup."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[n.jsx(ht,{kind:"reset",label:"Password reset"}),n.jsx(ht,{kind:"reminder",label:"Password reset reminder"}),n.jsx(ht,{kind:"confirm-email",label:"Confirm new email"}),n.jsx(ht,{kind:"changed",label:"Password changed notice"})]})]})]}),q==="maintenance"&&_&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"User Management"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Ban or unban users. Use with caution."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"user@example.com",value:C,onChange:I=>D(I.target.value)}),n.jsx("button",{className:"btn",disabled:u,onClick:ve,children:"Search"})]}),b.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Results:"}),b.map(I=>n.jsxs("div",{className:"p-2 rounded bg-black/20 text-sm flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:I.name||"No name"}),n.jsx("div",{className:"opacity-70",children:I.email}),n.jsxs("div",{className:"opacity-60 text-xs",children:["Joined ",new Date(I.createdAt).toLocaleDateString()]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-red-600 hover:bg-red-700 text-xs",onClick:()=>ze(I.email),children:"Ban"}),n.jsx("button",{className:"btn bg-green-600 hover:bg-green-700 text-xs",onClick:()=>de(I.email),children:"Unban"})]})]},I.email))]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Withdrawals"}),n.jsxs("ul",{className:"space-y-2",children:[y.map(I=>n.jsxs("li",{className:"p-2 rounded bg-black/20 text-sm flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-mono text-xs",children:I.id}),n.jsxs("div",{children:[I.email," · ",I.currency," ",(I.amountCents/100).toFixed(2)]}),n.jsxs("div",{className:"opacity-70",children:[I.status," · ",new Date(I.requestedAt).toLocaleString()]})]}),n.jsx("div",{className:"flex gap-2",children:I.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",disabled:u,onClick:()=>je(I.id,!0),children:"Approve"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:u,onClick:()=>je(I.id,!1),children:"Reject"})]})})]},I.id)),y.length===0&&n.jsx("li",{className:"opacity-60",children:"No withdrawal requests."})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"System Health"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Current status of system components and services."}),$?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"Database"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.database?"bg-emerald-600":"bg-red-600"}`,children:$.database?"Ready":"Down"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"WebSocket"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.websocket?"bg-emerald-600":"bg-red-600"}`,children:$.websocket?"Ready":"Down"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"HTTPS"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.https?"bg-emerald-600":"bg-amber-600"}`,children:$.https?"Enabled":"HTTP Only"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"Maintenance Mode"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.maintenance?"bg-red-600":"bg-emerald-600"}`,children:$.maintenance?"Active":"Normal"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"font-semibold",children:"Uptime:"})," ",Math.floor($.uptime/3600),"h ",Math.floor($.uptime%3600/60),"m"]}),n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"font-semibold",children:"Memory:"})," ",Math.round($.memory.heapUsed/1024/1024),"MB used"]}),n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"font-semibold",children:"Version:"})," ",$.version]}),n.jsx("div",{className:"flex gap-2 mt-3",children:n.jsx("button",{className:"btn",onClick:We,children:"Refresh"})})]})]}):n.jsxs("div",{className:"text-center py-4",children:[n.jsx("div",{className:"text-sm opacity-60 mb-2",children:"Loading system health..."}),n.jsx("button",{className:"btn",onClick:We,children:"Load Health Status"})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"User Reports"}),n.jsxs("ul",{className:"space-y-2",children:[Q.map(I=>n.jsx("li",{className:"p-2 rounded bg-black/20 text-sm",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-mono text-xs",children:I.id}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:I.reporter})," → ",n.jsx("span",{className:"font-semibold",children:I.offender})," · ",new Date(I.ts).toLocaleString()]}),n.jsxs("div",{className:"opacity-80",children:["Reason: ",I.reason]}),I.messageId&&n.jsxs("div",{className:"opacity-60 text-xs",children:["Message ID: ",I.messageId]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${I.status==="open"?"bg-amber-600":"bg-emerald-600"}`,children:I.status}),I.status==="open"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",disabled:u,onClick:async()=>{await fetch("/api/admin/reports/resolve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:I.id,action:"resolved",requesterEmail:e==null?void 0:e.email})}),await he()},children:"Resolve"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:u,onClick:async()=>{const ee=prompt("Enter notes for action taken (e.g., warning, block):")||"";await fetch("/api/admin/reports/resolve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:I.id,action:"actioned",notes:ee,requesterEmail:e==null?void 0:e.email})}),await he()},children:"Action"})]})]})]})},I.id)),Q.length===0&&n.jsx("li",{className:"opacity-60",children:"No reports."})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"System Health"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Current status of system components and services."}),$?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"Database"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.database?"bg-emerald-600":"bg-red-600"}`,children:$.database?"Ready":"Down"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"WebSocket"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.websocket?"bg-emerald-600":"bg-red-600"}`,children:$.websocket?"Ready":"Down"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"HTTPS"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.https?"bg-emerald-600":"bg-amber-600"}`,children:$.https?"Enabled":"HTTP Only"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:"Maintenance Mode"}),n.jsx("span",{className:`px-2 py-1 rounded text-xs ${$.maintenance?"bg-red-600":"bg-emerald-600"}`,children:$.maintenance?"Active":"Normal"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"font-semibold",children:"Uptime:"})," ",Math.floor($.uptime/3600),"h ",Math.floor($.uptime%3600/60),"m"]}),n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"font-semibold",children:"Memory:"})," ",Math.round($.memory.heapUsed/1024/1024),"MB used"]}),n.jsxs("div",{className:"text-sm",children:[n.jsx("span",{className:"font-semibold",children:"Version:"})," ",$.version]}),n.jsx("div",{className:"flex gap-2 mt-3",children:n.jsx("button",{className:"btn",onClick:We,children:"Refresh"})})]})]}):n.jsxs("div",{className:"text-center py-4",children:[n.jsx("div",{className:"text-sm opacity-60 mb-2",children:"Loading system health..."}),n.jsx("button",{className:"btn",onClick:We,children:"Load Health Status"})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Open Matches"}),n.jsxs("ul",{className:"space-y-1",children:[((l==null?void 0:l.matches)||[]).map(I=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"font-mono text-xs",children:I.id}),n.jsx("span",{className:"opacity-80",children:I.creatorName}),n.jsxs("span",{className:"opacity-60",children:[I.game," ",I.mode==="firstto"?"FT":"BO"," ",I.value," ",I.game==="X01"?`/${I.startingScore}`:""]})]}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:u,onClick:()=>ye(I.id),children:"Remove"})]},I.id)),(!(l!=null&&l.matches)||l.matches.length===0)&&n.jsx("li",{className:"text-sm opacity-60",children:"No open matches."})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Dangerous Operations"}),n.jsx("div",{className:"text-sm opacity-80 mb-3 text-red-400",children:"⚠️ These operations can cause data loss or service disruption. Use with extreme caution."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-2 text-red-400",children:"Tournament Deletion"}),n.jsxs("ul",{className:"space-y-2",children:[g.map(I=>n.jsxs("li",{className:"p-2 rounded bg-red-900/20 border border-red-500/40 text-sm",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"font-semibold",children:I.title}),n.jsx("div",{className:"opacity-70",children:I.status})]}),n.jsxs("div",{className:"opacity-80",children:[I.game," · ",I.mode==="firstto"?"FT":"BO"," ",I.value]}),n.jsx("div",{className:"mt-2",children:n.jsx("button",{className:"btn bg-red-600 hover:bg-red-700 text-xs",disabled:u,onClick:()=>et(I.id),children:"Delete Tournament"})})]},I.id)),g.length===0&&n.jsx("li",{className:"opacity-60",children:"No tournaments."})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-2 text-red-400",children:"System Maintenance"}),n.jsx("div",{className:"space-y-2",children:n.jsxs("div",{className:"p-3 rounded bg-red-900/20 border border-red-500/40",children:[n.jsx("div",{className:"font-semibold text-red-400 mb-2",children:"Maintenance Mode"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Put the entire site into maintenance mode. Users won't be able to access games or create matches."}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`px-2 py-1 rounded text-xs ${l!=null&&l.maintenance?"bg-red-600":"bg-green-600"}`,children:l!=null&&l.maintenance?"MAINTENANCE ACTIVE":"NORMAL OPERATION"}),n.jsx("button",{className:`btn ${l!=null&&l.maintenance?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,disabled:u,onClick:()=>ge(!(l!=null&&l.maintenance)),children:l!=null&&l.maintenance?"Disable":"Enable"})]})]})})]})]})]})]}),q==="premium"&&_&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Premium Subscription Grants"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Grant or revoke premium subscriptions for users (grants 30 days)."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"user@example.com",value:r,onChange:I=>a(I.target.value)}),n.jsx("button",{className:"btn",disabled:u||!r.trim(),onClick:()=>Ae(r,30),children:"Grant"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:u,onClick:()=>ut(r),children:"Revoke"})]}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Premium users get 30 days of access to all features."})]}),n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Premium Winners"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Users who have won premium through tournaments."}),n.jsxs("div",{className:"space-y-2",children:[te.map(I=>n.jsxs("div",{className:"p-2 rounded bg-black/20 text-sm flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:I.name||"No name"}),n.jsx("div",{className:"opacity-70",children:I.email}),n.jsxs("div",{className:"opacity-60 text-xs",children:["Expires ",new Date(I.expiresAt).toLocaleDateString()]})]}),n.jsx("div",{className:"flex gap-2",children:I.expired?n.jsx("span",{className:"px-2 py-1 rounded bg-amber-600 text-xs",children:"Premium Expired"}):n.jsx("span",{className:"px-2 py-1 rounded bg-emerald-600 text-xs",children:"Premium Active"})})]},I.email)),te.length===0&&n.jsx("div",{className:"opacity-60",children:"No premium winners."})]})]})]}),P.open&&n.jsxs("div",{className:"fixed inset-0 z-[1000]",onClick:()=>N({open:!1}),children:[n.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm"}),n.jsx("div",{className:"absolute inset-0 p-4 md:p-8 overflow-auto flex items-start md:items-center justify-center",children:n.jsxs("div",{className:"w-full max-w-3xl bg-[#0b1020] rounded-2xl border border-indigo-500/40 shadow-2xl",onClick:I=>I.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-indigo-500/20",children:[n.jsxs("div",{className:"font-semibold",children:["Preview: ",P.kind]}),n.jsx("button",{className:"btn",onClick:()=>N({open:!1}),children:"Close"})]}),n.jsx("div",{className:"p-0 bg-black/30",children:n.jsx("iframe",{title:"Email Preview",style:{width:"100%",height:"70vh",border:"0",background:"transparent"},srcDoc:P.html||""})}),n.jsx("div",{className:"px-4 py-3 border-t border-indigo-500/20 text-xs opacity-70",children:"Click outside this panel or press Esc to close."})]})})]})]}):n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Admin"}),n.jsx("div",{className:"text-sm opacity-80",children:"You don’t have permission to manage admins."})]})}function ij({user:e}){const{favoriteDouble:t,callerEnabled:s,callerVoice:r,callerVolume:a,speakCheckoutOnly:l,avgMode:i,autoStartOffline:o,rememberLastOffline:c,reducedMotion:u,compactHeader:d,allowSpectate:g,cameraScale:x,cameraAspect:y,autoscoreProvider:v,autoscoreWsUrl:C,calibrationGuide:D,preferredCameraId:b,preferredCameraLabel:h,cameraEnabled:w,offlineLayout:E,textSize:p,boxSize:S,setFavoriteDouble:P,setCallerEnabled:N,setCallerVoice:q,setCallerVolume:G,setSpeakCheckoutOnly:_,setAvgMode:te,setAutoStartOffline:L,setRememberLastOffline:Q,setReducedMotion:oe,setCompactHeader:R,setAllowSpectate:Z,setCameraScale:$,setCameraAspect:Y,setAutoscoreProvider:ue,setAutoscoreWsUrl:Ce,setCalibrationGuide:Ee,setPreferredCamera:ot,setCameraEnabled:he,setOfflineLayout:Ze,setTextSize:ft,setBoxSize:Ae}=ss(),[ut,ge]=m.useState([{key:"first180",label:"First 180",unlocked:!1,icon:"🎯",desc:"Score 180 in a match."},{key:"hundredGames",label:"100 Games Played",unlocked:!1,icon:"🏅",desc:"Play 100 games."},{key:"tournamentWin",label:"Tournament Winner",unlocked:!1,icon:"🥇",desc:"Win a tournament."},{key:"bestLeg",label:"Best Leg",unlocked:!1,icon:"⚡",desc:"Finish a leg in 12 darts or less."},{key:"comeback",label:"Comeback",unlocked:!1,icon:"🔥",desc:"Win after trailing by 3 legs."}]);m.useEffect(()=>{const F=(e==null?void 0:e.username)||"";F&&ge(Ne=>Ne.map(ct=>({...ct,unlocked:!!localStorage.getItem(`ndn:achieve:${ct.key}:${F}`)})))},[e==null?void 0:e.username]);const[Tt,ve]=m.useState(!1),[ze,de]=m.useState(""),[re,Dt]=m.useState(""),[nt,et]=m.useState(""),[le,je]=m.useState(""),[ye,pe]=m.useState(""),[We,mt]=m.useState(!0),[Oe,$t]=m.useState(null),[ht,Pt]=m.useState([{text:"Hi! I'm your Nine Dart Nation assistant. How can I help you today?",isUser:!1}]),[I,ee]=m.useState("");m.useEffect(()=>{const F=(e==null?void 0:e.username)||"";if(F)try{de(localStorage.getItem(`ndn:bio:favPlayer:${F}`)||""),Dt(localStorage.getItem(`ndn:bio:favTeam:${F}`)||""),et(localStorage.getItem(`ndn:bio:favDarts:${F}`)||""),je(localStorage.getItem(`ndn:bio:bio:${F}`)||""),pe(localStorage.getItem(`ndn:bio:profilePhoto:${F}`)||""),mt(localStorage.getItem(`ndn:settings:allowAnalytics:${F}`)!=="false")}catch{}},[e==null?void 0:e.username]),m.useEffect(()=>{e!=null&&e.email&&Gt(`/api/subscription?email=${encodeURIComponent(e.email)}`).then(F=>F.json()).then($t).catch(()=>{})},[e==null?void 0:e.email]);const st=()=>{const F=(e==null?void 0:e.username)||"";if(F)try{localStorage.setItem(`ndn:bio:favPlayer:${F}`,ze),localStorage.setItem(`ndn:bio:favTeam:${F}`,re),localStorage.setItem(`ndn:bio:favDarts:${F}`,nt),localStorage.setItem(`ndn:bio:bio:${F}`,le),localStorage.setItem(`ndn:bio:profilePhoto:${F}`,ye);try{window.dispatchEvent(new CustomEvent("ndn:avatar-updated",{detail:{username:F,avatar:ye}}))}catch{}localStorage.setItem(`ndn:settings:allowAnalytics:${F}`,We.toString()),ve(!1)}catch{}},yt=F=>{try{window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:F}}))}catch(Ne){console.error("Navigation failed:",Ne)}},dn=F=>{const Ne=F.toLowerCase();return Ne.includes("username")||Ne.includes("change name")?{text:"You can change your username once for free.",links:[{text:"Go to Settings > Account",tab:"settings"}]}:Ne.includes("premium")||Ne.includes("upgrade")||Ne.includes("subscription")?{text:"Premium unlocks all game modes and features.",links:[{text:"Go to Online Play",tab:"online"}]}:Ne.includes("calibrat")||Ne.includes("camera")||Ne.includes("vision")?{text:"Set up your camera properly in Settings.",links:[{text:"Go to Settings > Camera & Vision",tab:"settings"}]}:Ne.includes("voice")||Ne.includes("caller")||Ne.includes("audio")?{text:"Enable voice calling in Settings.",links:[{text:"Go to Settings > Audio & Voice",tab:"settings"}]}:Ne.includes("friend")||Ne.includes("play together")?{text:"Add friends to play together.",links:[{text:"Go to Friends",tab:"friends"}]}:Ne.includes("stat")||Ne.includes("score")||Ne.includes("performance")?{text:"View your statistics and performance.",links:[{text:"Go to Stats",tab:"stats"}]}:Ne.includes("setting")||Ne.includes("customiz")||Ne.includes("configur")?{text:"Customize your experience.",links:[{text:"Go to Settings",tab:"settings"}]}:Ne.includes("tournament")||Ne.includes("competition")?{text:"Check out tournaments and competitions.",links:[{text:"Go to Tournaments",tab:"tournaments"}]}:Ne.includes("help")||Ne.includes("support")||Ne.includes("faq")?{text:"You're already in the help section! Check the Support section above for more resources.",links:[{text:"Scroll to Support",tab:"settings"}]}:Ne.includes("how to play")||Ne.includes("game")||Ne.includes("start")?{text:"To play darts, select a game mode from the menu. For online play, join a match. For offline, start a local game.",links:[{text:"Play Online",tab:"online"},{text:"Play Offline",tab:"offline"}]}:{text:"I'm not sure about that. Try asking about playing, calibration, premium, username changes, voice settings, friends, stats, or settings."}},Qt=()=>{if(!I.trim())return;const F=I.toLowerCase();Pt(ct=>[...ct,{text:I,isUser:!0}]),ee("");const Ne=dn(F);setTimeout(()=>{Pt(ct=>[...ct,{text:Ne,isUser:!1}])},500)},[rt,Nt]=m.useState(""),[xt,hn]=m.useState(!1),[vt,Zt]=m.useState(""),[Ft,$n]=m.useState([]);return m.useEffect(()=>{const F=()=>{const Ne=speechSynthesis.getVoices();$n(Ne.filter(ct=>ct.lang.startsWith("en")))};F(),speechSynthesis.onvoiceschanged=F},[]),n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-red-500/40 bg-red-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2 text-black",children:[n.jsx(hd,{className:"w-5 h-5"})," Account"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"flex justify-center",children:n.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("ndn:logout")),className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Logout"})}),n.jsxs("div",{className:"border-t border-red-500/20 pt-3",children:[n.jsxs("div",{className:"font-medium mb-2 text-black",children:["Change Username (",(()=>{const F=(e==null?void 0:e.usernameChangeCount)||0;return F<2?`${2-F} free changes remaining`:"£2 per change"})(),")"]}),n.jsx("div",{className:"text-sm text-black mb-2",children:"You can change your username up to 2 times for free. Additional changes cost £2 each."}),(e==null?void 0:e.usernameChangeCount)>=2&&!rt.trim()?n.jsx("div",{className:"text-amber-400 text-sm mb-2",children:"⚠️ Additional username changes cost £2"}):null,n.jsx("input",{className:"input w-full mb-2",type:"text",placeholder:"New username",value:rt,onChange:F=>Nt(F.target.value),disabled:xt}),vt&&n.jsx("div",{className:"text-red-400 text-sm mb-2",children:vt}),n.jsx("button",{onClick:async()=>{if(Zt(""),!rt.trim()){Zt("Username required");return}if(rt.length<3||rt.length>20){Zt("Username must be 3-20 characters");return}((e==null?void 0:e.usernameChangeCount)||0)<2?(localStorage.setItem("pendingUsernameChange",rt.trim()),window.location.href="/?username-change=free"):window.location.href="https://buy.stripe.com/eVq4gB3XqeNS0iw6vAfnO02"},disabled:xt||!rt.trim(),className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:xt?"Processing...":((e==null?void 0:e.usernameChangeCount)||0)<2?"Change Username (FREE)":"Change Username (£2)"})]})]})]})}),Oe&&n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-green-500/40 bg-green-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2 text-black",children:[n.jsx(kh,{className:"w-5 h-5"})," Premium"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"text-sm",children:[n.jsxs("div",{className:"font-medium",children:["Status: ",Oe.fullAccess?"Active":"Inactive"]}),Oe.source&&n.jsxs("div",{className:"text-xs opacity-80",children:["Source: ",Oe.source]}),Oe.expiresAt&&n.jsxs("div",{className:"text-xs opacity-80",children:["Expires: ",new Date(Oe.expiresAt).toLocaleDateString()]}),Oe.renewalWarning&&n.jsxs("div",{className:"text-amber-600 text-xs mt-2 p-2 bg-amber-100 rounded",children:["⚠️ ",Oe.renewalWarning]})]}),Oe.source==="tournament"&&n.jsx("div",{className:"flex justify-center",children:n.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to cancel your premium subscription? You will lose access to premium features."))try{await Gt("/api/admin/premium/revoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,requesterEmail:e.email})});const F=await Gt(`/api/subscription?email=${encodeURIComponent(e.email)}`);$t(await F.json())}catch{alert("Failed to cancel premium. Please try again.")}},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Cancel Premium"})})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"font-semibold flex items-center gap-2",children:[n.jsx(hd,{className:"w-5 h-5 text-brand-400"})," Profile Bio"]}),Tt?n.jsxs("button",{onClick:st,className:"flex items-center gap-2 px-3 py-1 bg-green-500/20 hover:bg-green-500/30 rounded-lg text-green-400 text-sm transition-colors",children:[n.jsx(ub,{className:"w-4 h-4"})," Save"]}):n.jsxs("button",{onClick:()=>ve(!0),className:"flex items-center gap-2 px-3 py-1 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-400 text-sm transition-colors",children:[n.jsx(cb,{className:"w-4 h-4"})," Edit"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Favourite Player:"}),Tt?n.jsx("input",{className:"input w-full",type:"text",value:ze,onChange:F=>de(F.target.value),placeholder:"e.g. Michael van Gerwen"}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[2.5rem] flex items-center",children:ze||"Not set"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Favourite Football Team:"}),Tt?n.jsx("input",{className:"input w-full",type:"text",value:re,onChange:F=>Dt(F.target.value),placeholder:"e.g. Manchester United"}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[2.5rem] flex items-center",children:re||"Not set"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Favourite Darts:"}),Tt?n.jsx("input",{className:"input w-full",type:"text",value:nt,onChange:F=>et(F.target.value),placeholder:"e.g. Unicorn Phase 5, 24g"}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[2.5rem] flex items-center",children:nt||"Not set"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Short Bio / Quote:"}),Tt?n.jsx("textarea",{className:"input w-full",value:le,onChange:F=>je(F.target.value),placeholder:"Write something about yourself...",rows:3}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[4rem] flex items-start",children:le||"No bio set"})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-cyan-500/40 bg-cyan-500/10",children:[n.jsxs("div",{className:"font-semibold mb-2 flex items-center gap-2",children:[n.jsx(hd,{className:"w-5 h-5 text-cyan-400"})," Profile Photo"]}),n.jsxs("div",{children:[ye&&n.jsx("div",{className:"mb-2",children:n.jsx("img",{src:ye,alt:"Profile",className:"w-16 h-16 rounded-full object-cover"})}),n.jsx("input",{type:"file",accept:"image/*",onChange:F=>{var ct;const Ne=(ct=F.target.files)==null?void 0:ct[0];if(Ne){const U=new FileReader;U.onload=H=>{var Se;const me=(Se=H.target)==null?void 0:Se.result;pe(me);const be=(e==null?void 0:e.username)||"";be&&localStorage.setItem(`ndn:bio:profilePhoto:${be}`,me);try{window.dispatchEvent(new CustomEvent("ndn:avatar-updated",{detail:{username:be,avatar:me}}))}catch{}},U.readAsDataURL(Ne)}},className:"hidden",id:"profile-photo-upload"}),n.jsx("label",{htmlFor:"profile-photo-upload",className:"btn bg-cyan-600 hover:bg-cyan-700 cursor-pointer",children:ye?"Change Photo":"Upload Photo"})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-green-500/40 bg-green-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(ab,{className:"w-5 h-5 text-green-400"})," Game Preferences"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Favourite Double:"}),n.jsxs("select",{className:"input w-full",value:t,onChange:F=>P(F.target.value),children:[n.jsx("option",{value:"any",children:"Any Double"}),n.jsx("option",{value:"D20",children:"Double 20"}),n.jsx("option",{value:"D19",children:"Double 19"}),n.jsx("option",{value:"D18",children:"Double 18"}),n.jsx("option",{value:"D17",children:"Double 17"}),n.jsx("option",{value:"D16",children:"Double 16"}),n.jsx("option",{value:"D15",children:"Double 15"}),n.jsx("option",{value:"D14",children:"Double 14"}),n.jsx("option",{value:"D13",children:"Double 13"}),n.jsx("option",{value:"D12",children:"Double 12"}),n.jsx("option",{value:"D11",children:"Double 11"}),n.jsx("option",{value:"D10",children:"Double 10"}),n.jsx("option",{value:"D9",children:"Double 9"}),n.jsx("option",{value:"D8",children:"Double 8"}),n.jsx("option",{value:"D7",children:"Double 7"}),n.jsx("option",{value:"D6",children:"Double 6"}),n.jsx("option",{value:"D5",children:"Double 5"}),n.jsx("option",{value:"D4",children:"Double 4"}),n.jsx("option",{value:"D3",children:"Double 3"}),n.jsx("option",{value:"D2",children:"Double 2"}),n.jsx("option",{value:"D1",children:"Double 1"}),n.jsx("option",{value:"DB",children:"Bullseye"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Average Display Mode:"}),n.jsxs("select",{className:"input w-full",value:i,onChange:F=>te(F.target.value),children:[n.jsx("option",{value:"all-time",children:"All Time Average"}),n.jsx("option",{value:"24h",children:"24 Hour Average"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"autoStartOffline",checked:o,onChange:F=>L(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"autoStartOffline",className:"text-sm",children:"Auto-start offline games"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"rememberLastOffline",checked:c,onChange:F=>Q(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"rememberLastOffline",className:"text-sm",children:"Remember last offline game settings"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Offline Game Layout:"}),n.jsxs("select",{className:"input w-full",value:E||"classic",onChange:F=>Ze(F.target.value),children:[n.jsx("option",{value:"classic",children:"Classic Layout"}),n.jsx("option",{value:"modern",children:"Modern Layout"})]})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-purple-500/40 bg-purple-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(fb,{className:"w-5 h-5 text-purple-400"})," Audio & Voice"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"callerEnabled",checked:s,onChange:F=>N(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"callerEnabled",className:"text-sm font-medium",children:"Enable Voice Caller"})]}),s&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Voice:"}),n.jsx("select",{className:"input w-full",value:r,onChange:F=>q(F.target.value),children:Ft.map(F=>n.jsxs("option",{value:F.name,children:[F.name," (",F.lang,")"]},F.name))}),n.jsx("button",{onClick:()=>{const F=new SpeechSynthesisUtterance("Test voice: 180 scored!");F.voice=Ft.find(Ne=>Ne.name===r)||null,F.volume=a,speechSynthesis.speak(F)},className:"btn bg-blue-600 hover:bg-blue-700 mt-2",children:"Test Voice"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 text-sm font-medium",children:["Volume: ",Math.round(a*100),"%"]}),n.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:a,onChange:F=>G(parseFloat(F.target.value)),className:"w-full"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"speakCheckoutOnly",checked:l,onChange:F=>_(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"speakCheckoutOnly",className:"text-sm",children:"Only announce checkouts"})]})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-blue-500/40 bg-blue-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(tx,{className:"w-5 h-5 text-blue-400"})," Camera & Vision"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"cameraEnabled",checked:w,onChange:F=>he(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"cameraEnabled",className:"text-sm",children:"Enable camera for scoring"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 text-sm font-medium",children:["Camera Scale: ",x.toFixed(2),"x"]}),n.jsx("input",{type:"range",min:"0.5",max:"1.25",step:"0.05",value:x,onChange:F=>$(parseFloat(F.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Camera Aspect Ratio:"}),n.jsxs("select",{className:"input w-full",value:y||"wide",onChange:F=>Y(F.target.value),children:[n.jsx("option",{value:"wide",children:"Wide (16:9)"}),n.jsx("option",{value:"square",children:"Square (1:1)"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Text Size:"}),n.jsxs("select",{className:"input w-full",value:p,onChange:F=>ft(F.target.value),children:[n.jsx("option",{value:"small",children:"Small"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"large",children:"Large"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Box Size:"}),n.jsxs("select",{className:"input w-full",value:S,onChange:F=>Ae(F.target.value),children:[n.jsx("option",{value:"small",children:"Small"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"large",children:"Large"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"calibrationGuide",checked:D,onChange:F=>Ee(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"calibrationGuide",className:"text-sm",children:"Show calibration guide"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Autoscore Provider:"}),n.jsxs("select",{className:"input w-full",value:v||"built-in",onChange:F=>ue(F.target.value),children:[n.jsx("option",{value:"built-in",children:"Built-in Vision"}),n.jsx("option",{value:"manual",children:"Manual scoring only"}),n.jsx("option",{value:"external-ws",children:"External WebSocket"})]})]}),v==="manual"&&n.jsx("div",{className:"text-xs opacity-70",children:"Camera previews and autoscore overlays are hidden while manual scoring is selected. Use the score inputs or keyboard shortcuts to record each visit."}),v==="external-ws"&&n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"External WebSocket URL:"}),n.jsx("input",{className:"input w-full",type:"url",value:C||"",onChange:F=>Ce(F.target.value),placeholder:"ws://localhost:8080"})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-orange-500/40 bg-orange-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(sx,{className:"w-5 h-5 text-orange-400"})," UI & Accessibility"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"reducedMotion",checked:u,onChange:F=>oe(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"reducedMotion",className:"text-sm",children:"Reduce motion/animations"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"compactHeader",checked:d,onChange:F=>R(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"compactHeader",className:"text-sm",children:"Compact header layout"})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-pink-500/40 bg-pink-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(ob,{className:"w-5 h-5 text-pink-400"})," Online & Social"]}),n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"allowSpectate",checked:g,onChange:F=>Z(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"allowSpectate",className:"text-sm",children:"Allow others to spectate my games"})]})})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-yellow-500/40 bg-yellow-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2 text-yellow-700",children:[n.jsx(ti,{className:"w-5 h-5"})," Achievements & Badges"]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ut.map(F=>n.jsxs("div",{className:`flex flex-col items-center p-3 rounded-xl border ${F.unlocked?"border-emerald-400 bg-emerald-500/10":"border-slate-400 bg-slate-700/10"}`,children:[n.jsx("div",{className:"text-3xl mb-2",children:F.icon}),n.jsx("div",{className:`font-bold mb-1 text-center ${F.unlocked?"text-emerald-400":"text-slate-400"}`,children:F.label}),n.jsx("div",{className:"text-xs text-slate-300 text-center mb-2",children:F.desc}),!F.unlocked&&n.jsx("div",{className:"text-xs text-amber-400 font-medium",children:"🔒 Locked"}),F.unlocked&&n.jsx("div",{className:"text-xs text-emerald-400 font-medium",children:"✅ Unlocked!"})]},F.key))})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-gray-500/40 bg-gray-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(ti,{className:"w-5 h-5 text-gray-400"})," Data & Privacy"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"allowAnalytics",checked:We,onChange:F=>mt(F.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"allowAnalytics",className:"text-sm",children:"Allow anonymous usage analytics"})]}),n.jsx("div",{children:n.jsx("button",{onClick:()=>{const F={username:e==null?void 0:e.username,email:e==null?void 0:e.email,favPlayer:ze,favTeam:re,favDarts:nt,bio:le,profilePhoto:ye,settings:{favoriteDouble:t,avgMode:i,autoStartOffline:o,rememberLastOffline:c,reducedMotion:u,compactHeader:d,allowSpectate:g,cameraScale:x,cameraAspect:y,autoscoreProvider:v,autoscoreWsUrl:C,calibrationGuide:D,callerEnabled:s,callerVoice:r,callerVolume:a,speakCheckoutOnly:l,textSize:p}},Ne=new Blob([JSON.stringify(F,null,2)],{type:"application/json"}),ct=URL.createObjectURL(Ne),U=document.createElement("a");U.href=ct,U.download="ninedartnation-data.json",U.click(),URL.revokeObjectURL(ct)},className:"btn bg-blue-600 hover:bg-blue-700",children:"Export My Data"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&alert("Account deletion not yet implemented. Please contact support.")},className:"btn bg-red-600 hover:bg-red-700",children:"Delete Account"})})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-red-500/40 bg-red-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(kh,{className:"w-5 h-5 text-red-400"})," Privacy & Copyright Notice"]}),n.jsx("div",{className:"space-y-3 text-sm text-slate-300",children:n.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3",children:[n.jsx("p",{className:"font-semibold text-red-300 mb-2",children:"⚠️ IMPORTANT LEGAL NOTICE"}),n.jsxs("p",{className:"mb-2",children:[n.jsx("strong",{children:"Copyright Protection:"})," All code, assets, and intellectual property in Nine Dart Nation are protected by copyright law. Unauthorized copying, modification, or distribution of this software is strictly prohibited."]}),n.jsxs("p",{className:"mb-2",children:[n.jsx("strong",{children:"Legal Consequences:"})," Any attempt to edit, reverse-engineer, or redistribute this code will result in immediate legal action, including but not limited to copyright infringement lawsuits and potential criminal charges."]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Privacy:"})," Your personal data and gameplay information are protected. Any unauthorized access or data collection violates privacy laws and will be prosecuted to the full extent of the law."]})]})})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-teal-500/40 bg-teal-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(ti,{className:"w-5 h-5 text-teal-400"})," Support & Help"]}),n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-slate-300 mb-2",children:"Need help? Contact us:"}),n.jsx("a",{href:"mailto:support@ninedartnation.com",className:"btn bg-teal-600 hover:bg-teal-700",children:"Email Support"})]})})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-blue-500/40 bg-blue-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(nx,{className:"w-5 h-5 text-blue-400"})," Help Assistant"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-slate-800 rounded-lg p-4 max-h-96 overflow-y-auto space-y-3",children:ht.map((F,Ne)=>n.jsx("div",{className:`flex ${F.isUser?"justify-end":"justify-start"}`,children:n.jsx("div",{className:`max-w-xs px-3 py-2 rounded-lg ${F.isUser?"bg-blue-600 text-white":"bg-slate-700 text-slate-200"}`,children:typeof F.text=="string"?F.text:n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{children:F.text.text}),F.text.links&&n.jsx("div",{className:"space-y-1",children:F.text.links.map((ct,U)=>n.jsx("button",{onClick:()=>yt(ct.tab),className:"block w-full text-left text-blue-300 hover:text-blue-200 underline text-sm",children:ct.text},U))})]})})},Ne))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:I,onChange:F=>ee(F.target.value),onKeyPress:F=>F.key==="Enter"&&Qt(),placeholder:"Ask me anything...",className:"flex-1 input"}),n.jsx("button",{onClick:Qt,className:"btn bg-blue-600 hover:bg-blue-700",children:n.jsx(rx,{className:"w-4 h-4"})})]})]})]})})]})}const Cd={};function oj({onAuth:e}){const[t,s]=m.useState("signin"),[r,a]=m.useState(""),[l,i]=m.useState(""),[o,c]=m.useState(""),[u,d]=m.useState(""),[g,x]=m.useState(""),[y,v]=m.useState(!1),[C,D]=m.useState(!1),b="http://localhost:8787";async function h(S){if(S.preventDefault(),x(""),D(!0),!l||!o){x("Username and password required."),D(!1);return}try{const P=await fetch(`${b}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:o})}),N=await P.json();P.ok&&(N!=null&&N.user)&&(N!=null&&N.token)?(localStorage.setItem("authToken",N.token),e(N.user)):x((N==null?void 0:N.error)||"Invalid username or password.")}catch{x("Network error.")}finally{D(!1)}}async function w(S){if(S.preventDefault(),x(""),D(!0),!r||!l||!o){x("Email, username, and password required."),D(!1);return}try{const P=await fetch(`${b}/api/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,username:l,password:o})}),N=await P.json();P.ok&&(N!=null&&N.user)&&(N!=null&&N.token)?(localStorage.setItem("authToken",N.token),e(N.user)):x((N==null?void 0:N.error)||"Signup failed.")}catch{x("Network error.")}finally{D(!1)}}async function E(S){if(S.preventDefault(),x(""),D(!0),!r||!r.includes("@")){x("Enter your email address."),D(!1);return}try{const N=await(await fetch(`${b}/api/auth/send-reset`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})})).json();if(!(N!=null&&N.ok))throw new Error((N==null?void 0:N.error)||"Failed to send reset email");x("Password reset link sent to your email.")}catch(P){x((P==null?void 0:P.message)||"Failed to send reset email")}finally{D(!1)}}async function p(S){if(S.preventDefault(),x(""),D(!0),!r||!r.includes("@")){x("Enter your email address."),D(!1);return}try{const N=await(await fetch(`${b}/api/auth/send-username`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})})).json();if(!(N!=null&&N.ok))throw new Error((N==null?void 0:N.error)||"Failed to send username email");x("Your username has been emailed to you.")}catch(P){x((P==null?void 0:P.message)||"Failed to send username email")}finally{D(!1)}}return n.jsxs("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[n.jsx("div",{className:"background-animated"}),n.jsxs("div",{className:"relative z-10 w-full max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6 p-4",children:[n.jsxs("form",{className:"card w-full space-y-4",onSubmit:t==="signin"?h:t==="signup"?w:E,children:[n.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 mb-2 text-center",children:[n.jsx("h1",{className:"logo text-center",children:"NINE-DART-NATION 🎯"}),n.jsx("span",{className:"badge",children:"Welcome"})]}),n.jsx("h2",{className:"text-2xl font-bold",children:t==="signin"?"Sign In":t==="signup"?"Create Account":"Reset Password"}),(t==="signup"||t==="reset")&&n.jsx("input",{className:"input w-full",type:"email",placeholder:"Email",value:r,onChange:S=>a(S.target.value),required:!0}),t!=="reset"&&n.jsx("input",{className:"input w-full",type:"text",placeholder:"Username",value:l,onChange:S=>i(S.target.value),required:!0}),t!=="reset"&&n.jsxs("div",{className:"relative",children:[n.jsx("input",{className:"input w-full pr-10",type:y?"text":"password",placeholder:"Password",value:o,onChange:S=>c(S.target.value),autoComplete:"current-password",required:!0,onFocus:()=>v(!1),onBlur:()=>v(!1)}),n.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white",tabIndex:-1,onMouseDown:S=>{S.preventDefault(),v(!0)},onMouseUp:S=>{S.preventDefault(),v(!1)},onMouseLeave:()=>v(!1),onTouchStart:S=>{S.preventDefault(),v(!0)},onTouchEnd:S=>{S.preventDefault(),v(!1)},"aria-label":"Toggle password visibility",children:y?n.jsx(rb,{className:"w-5 h-5"}):n.jsx(sx,{className:"w-5 h-5"})})]}),t==="signup"&&n.jsx("input",{className:"input w-full",type:"text",placeholder:"Password Reminder (optional)",value:u,onChange:S=>d(S.target.value)}),g&&n.jsx("div",{className:"text-red-400 font-semibold text-sm",children:g}),n.jsx("button",{className:"btn w-full",type:"submit",disabled:C,children:C?"Signing In...":t==="signin"?"Sign In":t==="signup"?"Sign Up":"Send Reset Link"}),t==="reset"&&n.jsx("button",{className:"btn w-full mt-2 bg-white/10 hover:bg-white/20",type:"button",onClick:p,disabled:C,children:"Email me my username"}),n.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[n.jsx("button",{type:"button",className:"underline",onClick:()=>s(t==="signin"?"signup":"signin"),disabled:C,children:t==="signin"?"Need an account? Sign Up":"Already have an account? Sign In"}),n.jsx("button",{type:"button",className:"underline",onClick:()=>s("reset"),disabled:C,children:"Forgot password?"})]}),n.jsx("div",{className:"text-xs text-slate-200/80",children:"Tip: Use the admin demo credentials to explore admin features."})]}),n.jsxs("aside",{className:"card w-full",children:[n.jsx("h3",{className:"text-xl font-bold mb-3",children:"What’s inside"}),n.jsxs("ul",{className:"space-y-3",children:[n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(bu,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Online & Friends"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Challenge friends, chat, and join leagues."})]})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(sb,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Deep Stats"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Track 3-dart averages, best legs, and more."})]})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(Mo,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Game Modes"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Start with 3 free online games upon signup. After that, PREMIUM is required to play all games."})]})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(mb,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Premium Perks"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Polished UI, upcoming features, and early access."})]})]})]}),n.jsxs("a",{href:(Cd==null?void 0:Cd.VITE_DISCORD_INVITE_URL)||"https://discord.gg/8GtbZ6RU",target:"_blank",rel:"noopener noreferrer",className:"btn mt-4 flex items-center justify-center gap-2",children:[n.jsx(sc,{className:"w-5 h-5"})," Join BullseyeDartsLeague"]})]})]})]})}const cj=m.createContext({theme:"default",setTheme:e=>{}}),$h="ndn_theme";function dj({children:e}){const[t,s]=m.useState("default");return m.useEffect(()=>{try{const r=localStorage.getItem($h);r&&s(r)}catch{}},[]),m.useEffect(()=>{try{localStorage.setItem($h,t)}catch{}},[t]),n.jsx(cj.Provider,{value:{theme:t,setTheme:s},children:n.jsx("div",{className:`theme-${t}`,children:e})})}const ug=m.createContext(null);function uj({children:e}){const[t,s]=m.useState(!1),[r,a]=m.useState("connecting"),l=m.useRef(null),i=m.useRef(new Set),o=m.useRef(!0),c=m.useRef(0),u=m.useRef(null),d=m.useRef(null),g=m.useRef(null),x=m.useRef(0),y=()=>{if(g.current)return g.current;const E="ws://localhost:8787";if(E.length>0){const q=E.endsWith("/ws")?E:E.replace(/\/$/,"")+"/ws";return g.current=[q],g.current}const p=window.location.protocol==="https:"?"wss":"ws",S=window.location.hostname,N=[`${p}://${window.location.host}`+"/ws",`${p}://${S}/ws`,`${p}://${S}:8787/ws`,`${p}://${S}:3000/ws`];return g.current=Array.from(new Set(N)),g.current},v=()=>{const E=y();return x.current=(x.current+1)%E.length,E[x.current]},C=()=>{const E=y();return E[x.current]||E[0]},D=m.useCallback(()=>{if(l.current&&(l.current.readyState===WebSocket.OPEN||l.current.readyState===WebSocket.CONNECTING))return;a("connecting");const p=`${C()}`,S=new WebSocket(p);l.current=S,S.onopen=()=>{s(!0),a("connected"),c.current=0,d.current&&clearInterval(d.current),d.current=setInterval(()=>{var P,N;try{((P=l.current)==null?void 0:P.readyState)===WebSocket.OPEN&&((N=l.current)==null||N.send(JSON.stringify({type:"ping",t:Date.now()})))}catch{}},2e4)},S.onmessage=P=>{try{const N=JSON.parse(P.data);i.current.forEach(q=>{try{q(N)}catch{}})}catch{}},S.onerror=()=>{},S.onclose=()=>{if(s(!1),a("disconnected"),d.current&&(clearInterval(d.current),d.current=null),!o.current)return;const P=(c.current||0)+1;c.current=P,P%2===0&&v();const N=1e3*Math.pow(2,P-1),q=Math.floor(Math.random()*1e3);let G=Math.min(3e4,N+q);P===1&&(G=0),u.current&&clearTimeout(u.current),G===0?D():u.current=setTimeout(D,G)}},[]);m.useEffect(()=>{o.current=!0,D();const E=()=>{var S;o.current=!1;try{(S=l.current)==null||S.close()}catch{}};window.addEventListener("beforeunload",E);const p=()=>{document.visibilityState==="visible"&&(t||D())};return document.addEventListener("visibilitychange",p),window.addEventListener("online",D),()=>{var S;o.current=!1,u.current&&clearTimeout(u.current),d.current&&clearInterval(d.current);try{(S=l.current)==null||S.close()}catch{}document.removeEventListener("visibilitychange",p),window.removeEventListener("online",D),window.removeEventListener("beforeunload",E)}},[D]);const b=m.useCallback(E=>{try{l.current&&l.current.readyState===WebSocket.OPEN&&l.current.send(typeof E=="string"?E:JSON.stringify(E))}catch{}},[]),h=m.useCallback(E=>(i.current.add(E),()=>{i.current.delete(E)}),[]),w=m.useMemo(()=>({connected:t,status:r,send:b,addListener:h}),[t,r,b,h]);return n.jsx(ug.Provider,{value:w,children:e})}function Um(){const e=m.useContext(ug);if(!e)throw new Error("useWS must be used within WSProvider");return e}function mj({status:e,title:t,size:s=12}){const r=s;return e==="connecting"?n.jsx("span",{role:"img","aria-label":"Connecting",title:t||"Connecting…",className:"inline-flex items-center justify-center",style:{width:r,height:r},children:n.jsxs("svg",{width:r,height:r,viewBox:"0 0 24 24",className:"animate-spin","aria-hidden":"true",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#A7F3D0",strokeWidth:"3",fill:"none",opacity:"0.35"}),n.jsx("path",{d:"M22 12a10 10 0 0 0-10-10",stroke:"#34D399",strokeWidth:"3",strokeLinecap:"round",fill:"none"})]})}):e==="connected"?n.jsx("span",{role:"img","aria-label":"Connected",title:t||"Connected",className:"inline-flex items-center justify-center",style:{width:r,height:r},children:n.jsx("svg",{width:r,height:r,viewBox:"0 0 24 24","aria-hidden":"true",children:n.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#34D399"})})}):n.jsx("span",{role:"img","aria-label":"Disconnected",title:t||"Not connected",className:"inline-flex items-center justify-center",style:{width:r,height:r},children:n.jsxs("svg",{width:r,height:r,viewBox:"0 0 24 24","aria-hidden":"true",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#F87171",opacity:"0.15"}),n.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"#F87171",strokeWidth:"2",fill:"none"}),n.jsx("rect",{x:"6",y:"11",width:"12",height:"2",rx:"1",fill:"#F87171"})]})})}const mg="ndn:blocked:v1";function fj(){try{const e=localStorage.getItem(mg);return e?JSON.parse(e):{}}catch{return{}}}function Fh(e){try{localStorage.setItem(mg,JSON.stringify(e))}catch{}}const hj=ya((e,t)=>({blocked:fj(),isBlocked:s=>!!t().blocked[(s||"").toLowerCase()],block:s=>e(r=>{const a={...r.blocked};return a[(s||"").toLowerCase()]=Date.now(),Fh(a),{blocked:a}}),unblock:s=>e(r=>{const a={...r.blocked};return delete a[(s||"").toLowerCase()],Fh(a),{blocked:a}}),all:()=>Object.keys(t().blocked)}));function pj({user:e}){var Zr,kl,Sl,Cl,El,Tl,Oi,Na,_i,ka,Ui,Sa,Bi,Ca,$i,Ea,Fi,Ta,zi,Ml,Hi,Il,Wi,Ma,yn,un,Dl,Ia,Pl,Vi,Gi;const t="http://localhost:8787",s=xl(),r=(()=>{try{return Um()}catch{return null}})(),a=hj(),[l,i]=m.useState("room-1"),[o,c]=m.useState(!1),[u,d]=m.useState([]),[g,x]=m.useState(!1),[y,v]=m.useState(!1),C=m.useRef(null),[D,b]=m.useState(null),h=m.useRef(null),w=m.useRef(0),E=m.useRef(null),p=m.useRef(!0),S=m.useRef(0),P=m.useRef(!1),N=si(),q=Pu(),{favoriteDouble:G,callerEnabled:_,callerVoice:te,callerVolume:L,speakCheckoutOnly:Q,allowSpectate:oe,cameraScale:R,setCameraScale:Z,cameraEnabled:$,textSize:Y,boxSize:ue,autoscoreProvider:Ce}=ss(),Ee=Ce==="manual",he=(f=>{switch(f){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(Y),[Ze,ft]=m.useState(2),[Ae,ut]=m.useState(!1),[ge,Tt]=m.useState([]),[ve,ze]=m.useState(0),[de,re]=m.useState(0),[Dt,nt]=m.useState(0),[et,le]=m.useState(0),[je,ye]=m.useState(""),[pe,We]=m.useState(0),[mt,Oe]=m.useState(0),[$t,ht]=m.useState(""),[Pt,I]=m.useState(null),[ee,st]=m.useState(null),yt=m.useRef(null),[dn,Qt]=m.useState(""),[rt,Nt]=m.useState({}),[xt,hn]=m.useState({}),[vt,Zt]=m.useState({}),[Ft,$n]=m.useState({}),[F,Ne]=m.useState({}),[ct,U]=m.useState({}),[H,me]=m.useState({}),[be,Se]=m.useState({}),[Be,He]=m.useState(()=>Du()),[_e,Ke]=m.useState(0),[zt,Lt]=m.useState(()=>{try{const f=navigator.userAgent||"";return/Android|iPhone|iPad|iPod|Mobile/i.test(f)}catch{return!1}}),[sn,Ss]=m.useState(null),Mt=m.useRef(null),qs=m.useRef(null);function va(){var f,k;try{if(!qs.current){const M=window.AudioContext||window.webkitAudioContext;M&&(qs.current=new M)}(k=(f=qs.current)==null?void 0:f.resume)==null||k.call(f).catch(()=>{})}catch{}}function Cs(f,k,M=0,T=.05){const J=qs.current;if(!J)return;const ae=J.createOscillator(),ce=J.createGain();ae.type="square",ae.frequency.value=f,ce.gain.value=T,ae.connect(ce),ce.connect(J.destination);const z=J.currentTime+M;ae.start(z),ae.stop(z+k/1e3)}function Jr(f){va(),qs.current&&(f==="180"?(Cs(880,110,0,.06),Cs(1175,110,.06,.06),Cs(1568,140,.12,.06)):(Cs(659,140,0,.07),Cs(784,140,.08,.07),Cs(987,200,.16,.07)))}function wn(f,k){const M=Date.now(),T=Mt.current;T&&T.kind===f&&T.by===k&&M-T.ts<500||(Mt.current={kind:f,by:k,ts:M},Ss({kind:f,by:k,turnIdx:N.currentPlayerIdx,ts:M}),Jr(f))}const[yl,O]=m.useState(!1),[X,ne]=m.useState([]),[K,V]=m.useState("bestof"),[De,we]=m.useState(5),[at,Ye]=m.useState(501),[Te,kt]=m.useState(null),[rn,At]=m.useState("");function jn(f){At(f),setTimeout(()=>At(""),4e3);try{s(f||"Stripe checkout failed",{type:"error"})}catch{}}const[pn,Bs]=m.useState(null),[Yn,an]=m.useState(null),[xn,$s]=m.useState("X01"),[Le,Ln]=m.useState("X01"),[pt,Nn]=m.useState(!1),Fn=e!=null&&e.username&&!(e!=null&&e.fullAccess)?ix(e.username):1/0,en=!(e!=null&&e.fullAccess)&&Fn<=0,[os,lt]=m.useState("all"),[Es,cs]=m.useState("all"),[An,Fs]=m.useState("all"),[Xn,gn]=m.useState(!1),[Ys,Rn]=m.useState(10),{H:ds}=Om(),qr=e!=null&&e.username?Dr(e.username):0,Qn=Pu(f=>f.unread),us=(X||[]).filter(f=>!(os!=="all"&&f.mode!==os||Es!=="all"&&Number(f.startingScore)!==Number(Es)||An!=="all"&&f.game!==An||Xn&&(!qr||!f.creatorAvg||Math.abs(Number(f.creatorAvg)-Number(qr))>Ys)));m.useEffect(()=>{const f=k=>{const M=(k==null?void 0:k.detail)||{};M.game&&$s(M.game),(M.mode==="bestof"||M.mode==="firstto")&&V(M.mode),typeof M.value=="number"&&isFinite(M.value)&&we(Math.max(1,Math.floor(M.value))),typeof M.start=="number"&&isFinite(M.start)&&Ye(Math.max(1,Math.floor(M.start))),O(!0)};return window.addEventListener("ndn:online-demo",f),()=>window.removeEventListener("ndn:online-demo",f)},[]),m.useEffect(()=>{const f=String((e==null?void 0:e.email)||"").toLowerCase();f&&Gt(`/api/friends/messages?email=${encodeURIComponent(f)}`).then(k=>k.json()).then(k=>{k!=null&&k.ok&&Array.isArray(k.messages)&&q.load(k.messages)}).catch(()=>{})},[e==null?void 0:e.email]),m.useEffect(()=>{const f=k=>{try{const M=(k==null?void 0:k.detail)||{},T=Number(M.start||501);N.newMatch([(e==null?void 0:e.username)||"You","Opponent"],T,l),N.addVisit(60,3),N.nextPlayer(),N.addVisit(85,3),N.nextPlayer(),N.addVisit(100,3),Ln("X01"),ut(!0)}catch{}};return window.addEventListener("ndn:online-match-demo",f),()=>window.removeEventListener("ndn:online-match-demo",f)},[]),m.useEffect(()=>(p.current=!0,Je(),()=>{var f;p.current=!1,E.current&&clearTimeout(E.current);try{(f=h.current)==null||f.close()}catch{}}),[]),m.useEffect(()=>{q.setInGame(N.inProgress)},[N.inProgress]),m.useEffect(()=>{sn&&N.currentPlayerIdx!==sn.turnIdx&&Ss(null)},[N.currentPlayerIdx,sn==null?void 0:sn.turnIdx]),m.useEffect(()=>{try{r&&r.connected?r.send({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:oe}):h.current&&h.current.readyState===WebSocket.OPEN&&h.current.send(JSON.stringify({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:oe}))}catch{}},[oe,r==null?void 0:r.connected]),m.useEffect(()=>{const f=k=>{var T,J;const M=(T=k==null?void 0:k.detail)==null?void 0:T.roomId;M&&(i(M),r?r.send({type:"spectate",roomId:M}):(J=h.current)==null||J.send(JSON.stringify({type:"spectate",roomId:M})),ut(!0),O(!1))};return window.addEventListener("ndn:spectate-room",f),()=>window.removeEventListener("ndn:spectate-room",f)},[r]);function Je(){if(r){r.connected&&(r.send({type:"join",roomId:l}),r.send({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:oe}),r.send({type:"list-matches"}),c(!0));return}try{if(h.current&&(h.current.readyState===WebSocket.OPEN||h.current.readyState===WebSocket.CONNECTING))return}catch{}const f="ws://localhost:8787",k=window.location.protocol==="https:"?"wss":"ws",M=window.location.hostname,T=`${k}://${M}${window.location.port?"":":8787"}`,J=f.length>0?f:T,ae=new WebSocket(J);h.current=ae,ae.onopen=()=>{c(!0),w.current=0,P.current?s("Reconnected to lobby",{type:"success"}):(s("Connected to lobby",{type:"success"}),P.current=!0),ae.send(JSON.stringify({type:"join",roomId:l})),ae.send(JSON.stringify({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:oe})),ae.send(JSON.stringify({type:"list-matches"}))},ae.onmessage=ce=>{var Ot;const z=JSON.parse(ce.data);if(z.type==="state"){N.importState(z.payload);const Pe=Number(z.payload._dpIndex),wt=Number(z.payload._dpHits);Number.isFinite(Pe)&&nt(Math.max(0,Pe)),Number.isFinite(wt)&&le(Math.max(0,wt));const ln=Number(z.payload._atcIndex),_t=Number(z.payload._atcHits);Number.isFinite(ln)&&We(Math.max(0,ln)),Number.isFinite(_t)&&Oe(Math.max(0,_t));try{const Re=z.payload._cricketById;Re&&typeof Re=="object"&&Nt(Re)}catch{}try{const Re=z.payload._shanghaiById;Re&&typeof Re=="object"&&hn(Re)}catch{}try{const Re=z.payload._halveById;Re&&typeof Re=="object"&&Zt(Re)}catch{}try{const Re=z.payload._highlowById;Re&&typeof Re=="object"&&$n(Re)}catch{}try{const Re=z.payload._killerById;Re&&typeof Re=="object"&&Ne(Re)}catch{}try{const Re=z.payload._amCricketById;Re&&typeof Re=="object"&&U(Re)}catch{}try{const Re=z.payload._baseballById;Re&&typeof Re=="object"&&me(Re)}catch{}try{const Re=z.payload._golfById;Re&&typeof Re=="object"&&Se(Re)}catch{}try{const Re=z.payload._tttState;Re&&typeof Re=="object"&&He(Re)}catch{}try{const Re=Number(z.payload._turnDarts);Number.isFinite(Re)&&Ke(Math.max(0,Re))}catch{}}else if(z.type==="joined")z.id&&b(z.id);else if(z.type==="presence"||z.type==="peer-joined")Tt(Pe=>{const wt=new Set(Pe);return z.id&&wt.add(z.id),Array.from(wt)});else if(z.type==="chat"){const Pe=!!(z.from&&D&&z.from===D),wt=Pe?(e==null?void 0:e.username)||"me":z.from||"peer",ln=String(z.from||"");if(!Pe&&ln&&a.isBlocked(ln))return;if(Pe&&C.current&&String(z.message||"")===C.current.text){C.current=null;return}d(_t=>[..._t,{from:wt,message:z.message,fromId:ln||void 0}])}else if(z.type==="matches")ne(Array.isArray(z.matches)?z.matches:[]);else if(z.type==="invite")kt({matchId:z.matchId,fromId:z.fromId,fromName:z.fromName,calibrated:!!z.calibrated,boardPreview:z.boardPreview||null,game:z.game,mode:z.mode,value:z.value,startingScore:z.startingScore});else if(z.type==="match-start")i(z.roomId),ae.send(JSON.stringify({type:"join",roomId:z.roomId})),ut(!0),O(!1),(Ot=z.match)!=null&&Ot.game&&Ln(z.match.game),e!=null&&e.username&&!(e!=null&&e.fullAccess)&&Sh(e.username);else if(z.type==="declined")s("Invite declined",{type:"info"});else if(z.type==="error"){const Pe=typeof z.message=="string"?z.message:"Action not allowed";if(At(Pe),z.code==="SPECTATE_NOT_ALLOWED")try{s("This player has spectating turned off.",{type:"error"})}catch{}z.code==="NOT_FOUND"&&pn&&an({game:pn.game,mode:pn.mode,value:pn.value,startingScore:pn.startingScore}),setTimeout(()=>At(""),3500)}else if(z.type==="friend-invite")confirm(`${z.fromName||z.fromEmail} invited you to play ${z.game||"X01"} (${z.mode==="firstto"?"First To":"Best Of"} ${z.value||1}). Accept?`)?ae.send(JSON.stringify({type:"start-friend-match",toEmail:z.fromEmail,game:z.game,mode:z.mode,value:z.value,startingScore:z.startingScore})):s("Invite declined",{type:"info"});else if(z.type==="friend-message")q.add({id:z.id||`${z.ts}-${z.from}`,from:z.from,message:z.message,ts:z.ts||Date.now()}),N.inProgress||s(`${z.from}: ${z.message}`,{type:"info"});else if(z.type==="celebration"){const Pe=z.by||"Player",wt=z.kind==="leg"?"leg":"180";wn(wt,Pe)}else if(z.type==="cam-code")console.log("Received cam-code:",z.code),I(z.code),s(`Pairing code: ${z.code}`,{type:"info"});else if(z.type==="cam-peer-joined")console.log("Mobile peer joined for code:",z.code),Nl(z.code);else if(z.type==="cam-answer"){console.log("Received cam-answer");const Pe=window.mobilePC;Pe&&Pe.setRemoteDescription(new RTCSessionDescription(z.payload))}else if(z.type==="cam-ice"){console.log("Received cam-ice");const Pe=window.mobilePC;Pe&&Pe.addIceCandidate(z.payload)}},ae.onclose=()=>{if(c(!1),!p.current)return;const ce=(w.current||0)+1;w.current=ce;const z=Math.min(3e4,1e3*Math.pow(2,ce-1)),Ot=Date.now();Ot-S.current>4e3&&(s(`Disconnected. Reconnecting in ${Math.round(z/1e3)}s...`,{type:"error"}),S.current=Ot),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{Je()},z)}}function St(){var tr,nr,Pa,sr,La,ea;const f=N.players||[],k=N.currentPlayerIdx||0,M=f[k],T=(nr=M==null?void 0:M.legs)==null?void 0:nr[((tr=M==null?void 0:M.legs)==null?void 0:tr.length)-1],J=T?T.totalScoreRemaining:N.startingScore,ae=(T==null?void 0:T.dartsThrown)||0,ce=T?T.totalScoreStart-T.totalScoreRemaining:0,z=ae>0?ce/ae*3:0,Ot=((sr=(Pa=T==null?void 0:T.visits)==null?void 0:Pa[T.visits.length-1])==null?void 0:sr.score)??0;let Pe="ÔÇö";f.length===2?Pe=`${((La=f[0])==null?void 0:La.legsWon)||0}-${((ea=f[1])==null?void 0:ea.legsWon)||0}`:f.length>2&&(Pe=f.map(fs=>`${fs.name}:${fs.legsWon||0}`).join(" = "));const wt=N.bestLegThisMatch,ln=wt?`${wt.darts} darts${(()=>{const fs=f.find(Ac=>Ac.id===wt.playerId);return fs?` (${fs.name})`:""})()}`:"-",Re=(fs=>{switch(fs){case"small":return"text-xs";case"large":return"text-base";default:return"text-sm"}})(Y),Da=(fs=>{switch(fs){case"small":return"p-2";case"large":return"p-4";default:return"p-3"}})(ue);return n.jsxs("div",{className:`${Da} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${Re}`,children:[n.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),n.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[n.jsx("div",{className:"opacity-80",children:"Current score"}),n.jsx("div",{className:"font-mono text-right",children:Pe}),n.jsx("div",{className:"opacity-80",children:"Current thrower"}),n.jsx("div",{className:"text-right font-semibold",children:(M==null?void 0:M.name)||"ÔÇö"}),n.jsx("div",{className:"opacity-80",children:"Score remaining"}),n.jsx("div",{className:"text-right font-mono font-bold text-lg",children:J}),n.jsx("div",{className:"opacity-80",children:"3-dart avg"}),n.jsx("div",{className:"text-right font-mono",children:z.toFixed(1)}),n.jsx("div",{className:"opacity-80",children:"Last score"}),n.jsx("div",{className:"text-right font-mono",children:Ot}),n.jsx("div",{className:"opacity-80",children:"Best leg"}),n.jsx("div",{className:"text-right",children:ln})]})]})}m.useEffect(()=>{if(!r)return;c(r.connected);const f=r.addListener(k=>{var M;try{if(k.type==="state"){N.importState(k.payload);try{const T=Number(k.payload._dpIndex),J=Number(k.payload._dpHits);Number.isFinite(T)&&nt(Math.max(0,T)),Number.isFinite(J)&&le(Math.max(0,J))}catch{}try{const T=Number(k.payload._atcIndex),J=Number(k.payload._atcHits);Number.isFinite(T)&&We(Math.max(0,T)),Number.isFinite(J)&&Oe(Math.max(0,J))}catch{}try{const T=k.payload._cricketById;T&&typeof T=="object"&&Nt(T)}catch{}try{const T=k.payload._shanghaiById;T&&typeof T=="object"&&hn(T)}catch{}try{const T=k.payload._halveById;T&&typeof T=="object"&&Zt(T)}catch{}try{const T=k.payload._highlowById;T&&typeof T=="object"&&$n(T)}catch{}try{const T=k.payload._killerById;T&&typeof T=="object"&&Ne(T)}catch{}try{const T=k.payload._amCricketById;T&&typeof T=="object"&&U(T)}catch{}try{const T=k.payload._baseballById;T&&typeof T=="object"&&me(T)}catch{}try{const T=k.payload._golfById;T&&typeof T=="object"&&Se(T)}catch{}try{const T=k.payload._tttState;T&&typeof T=="object"&&He(T)}catch{}try{const T=Number(k.payload._turnDarts);Number.isFinite(T)&&Ke(Math.max(0,T))}catch{}}else if(k.type==="joined")k.id&&b(k.id);else if(k.type==="presence"||k.type==="peer-joined")Tt(T=>Array.from(new Set([...T||[],k.id].filter(Boolean))));else if(k.type==="chat"){const T=!!(k.from&&D&&k.from===D),J=T?(e==null?void 0:e.username)||"me":k.from||"peer",ae=String(k.from||"");if(!T&&ae&&a.isBlocked(ae))return;d(ce=>[...ce,{from:J,message:k.message,fromId:ae||void 0}])}else if(k.type==="matches")ne(Array.isArray(k.matches)?k.matches:[]);else if(k.type==="invite")kt({matchId:k.matchId,fromId:k.fromId,fromName:k.fromName,calibrated:!!k.calibrated,boardPreview:k.boardPreview||null,game:k.game,mode:k.mode,value:k.value,startingScore:k.startingScore});else if(k.type==="match-start")i(k.roomId),r.send({type:"join",roomId:k.roomId}),ut(!0),O(!1),(M=k.match)!=null&&M.game&&Ln(k.match.game),e!=null&&e.username&&!(e!=null&&e.fullAccess)&&Sh(e.username);else if(k.type==="declined")s("Invite declined",{type:"info"});else if(k.type==="error"){const T=typeof k.message=="string"?k.message:"Action not allowed";if(At(T),k.code==="SPECTATE_NOT_ALLOWED")try{s("This player has spectating turned off.",{type:"error"})}catch{}k.code==="NOT_FOUND"&&pn&&an({game:pn.game,mode:pn.mode,value:pn.value,startingScore:pn.startingScore}),setTimeout(()=>At(""),3500)}else if(k.type==="friend-invite")confirm(`${k.fromName||k.fromEmail} invited you to play ${k.game||"X01"} (${k.mode==="firstto"?"First To":"Best Of"} ${k.value||1}). Accept?`)?r.send({type:"start-friend-match",toEmail:k.fromEmail,game:k.game,mode:k.mode,value:k.value,startingScore:k.startingScore}):s("Invite declined",{type:"info"});else if(k.type==="friend-message")q.add({id:k.id||`${k.ts}-${k.from}`,from:k.from,message:k.message,ts:k.ts||Date.now()}),N.inProgress||s(`${k.from}: ${k.message}`,{type:"info"});else if(k.type==="celebration"){const T=k.by||"Player",J=k.kind==="leg"?"leg":"180";wn(J,T)}}catch{}});return r.connected&&(r.send({type:"join",roomId:l}),r.send({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:oe}),r.send({type:"list-matches"})),()=>{f()}},[r==null?void 0:r.connected]);function fe(){if(r){r.send({type:"state",payload:{...N,_turnIdx:ve,_participants:ge,_dpIndex:Dt,_dpHits:et,_atcIndex:pe,_atcHits:mt,_cricketById:rt,_shanghaiById:xt,_halveById:vt,_highlowById:Ft,_killerById:F,_amCricketById:ct,_baseballById:H,_golfById:be,_tttState:Be,_turnDarts:_e}});return}const f=h.current;!f||f.readyState!==WebSocket.OPEN||f.send(JSON.stringify({type:"state",payload:{...N,_turnIdx:ve,_participants:ge,_dpIndex:Dt,_dpHits:et,_atcIndex:pe,_atcHits:mt,_cricketById:rt,_shanghaiById:xt,_halveById:vt,_highlowById:Ft,_killerById:F,_amCricketById:ct,_baseballById:H,_golfById:be,_tttState:Be,_turnDarts:_e}}))}function Ct(f){const k=(e==null?void 0:e.username)||"me";if(d(T=>[...T,{from:k,message:f,fromId:D||"self"}]),C.current={text:f,ts:Date.now()},r){r.send({type:"chat",message:f});return}const M=h.current;!M||M.readyState!==WebSocket.OPEN||M.send(JSON.stringify({type:"chat",message:f}))}function Rt(f){var M;if(Tu(f,Dt)){const T=et+1,J=Dt+1;le(T),nt(J);try{if(T>=xs.length){const ae=((M=N.players[N.currentPlayerIdx])==null?void 0:M.name)||"Player";wn("leg",ae),le(0),nt(0)}}catch{}}fe()}function bt(){const f=Math.max(0,Math.floor(de|0));Rt(f),re(0)}function Et(){const f=Nr(je);f!=null&&(Rt(f),ye(""))}function qt(f,k,M){const T=on[pe];return T==null?!1:typeof M=="number"&&M>=1&&M<=20&&M===T&&(k==="SINGLE"||k==="DOUBLE"||k==="TRIPLE")?!0:T===25?k==="BULL"||f===25:T===50?k==="INNER_BULL"||f===50:f===T||f===T*2||f===T*3}function kn(f,k,M){var T;if(qt(f,k,M)){const J=mt+1,ae=pe+1;Oe(J),We(ae);try{if(J>=on.length){const ce=((T=N.players[N.currentPlayerIdx])==null?void 0:T.name)||"Player";wn("leg",ce),Oe(0),We(0)}}catch{}}fe()}function pr(){const f=Math.max(0,Math.floor(de|0));kn(f),re(0)}function Xs(){const f=Nr($t);f!=null&&(kn(f),ht(""))}function it(){const f=N.players[N.currentPlayerIdx];return(f==null?void 0:f.id)??String(N.currentPlayerIdx)}function Qs(f){rt[f]||Nt(k=>({...k,[f]:oa()}))}function Yr(f){xt[f]||hn(k=>({...k,[f]:Cr()}))}function Ts(f){vt[f]||Zt(k=>({...k,[f]:Er()}))}function xr(f){Ft[f]||$n(k=>({...k,[f]:Tr()}))}function gr(f){if(!F[f]){const k=new Set(Object.values(F||{}).map(J=>J.number)),M=[];for(let J=1;J<=20;J++)k.has(J)||M.push(J);const T=M.length>0?M[Math.floor(Math.random()*M.length)]:20;Ne(J=>({...J,[f]:tg(T,3)}))}}function Ms(f){ct[f]||U(k=>({...k,[f]:ii()}))}function ba(f){H[f]||me(k=>({...k,[f]:ri()}))}function Xr(f){be[f]||Se(k=>({...k,[f]:ai()}))}m.useEffect(()=>{Ke(0)},[N.currentPlayerIdx,Le]);function vl(f,k){const M=N.players.filter(T=>T.id!==k);return M.length===0?!1:M.every(T=>{var J,ae;return(((ae=(J=rt[T.id])==null?void 0:J.marks)==null?void 0:ae[f])||0)>=3})}function zn(f,k,M){const T=it();Qs(T),Nt(ae=>{const ce={...ae},z={...ce[T]||oa()};return Jx(z,f,k,M,Ot=>vl(Ot,T)),ce[T]=z,ce});const J=_e+1;Ke(J),J>=3&&(Ke(0),N.nextPlayer()),fe()}function ms(f,k,M){const T=it();Yr(T),hn(ae=>{const ce={...ae},z={...ce[T]||Cr()};return qx(z,f,k,M),ce[T]=z,ce});const J=_e+1;Ke(J),J>=3&&(hn(ae=>{const ce={...ae},z={...ce[T]||Cr()};return Yx(z),ce[T]=z,ce}),Ke(0),N.nextPlayer()),fe()}function Zs(f,k,M){const T=it();Ts(T),Zt(ae=>{const ce={...ae},z={...ce[T]||Er()};return Xx(z,f,k,M),ce[T]=z,ce});const J=_e+1;Ke(J),J>=3&&(Zt(ae=>{const ce={...ae},z={...ce[T]||Er()};return Qx(z),ce[T]=z,ce}),Ke(0),N.nextPlayer()),fe()}function Is(f,k,M){const T=it();xr(T),$n(ae=>{const ce={...ae},z={...ce[T]||Tr()};return Zx(z,f,k,M),ce[T]=z,ce});const J=_e+1;Ke(J),J>=3&&($n(ae=>{const ce={...ae},z={...ce[T]||Tr()};return eg(z),ce[T]=z,ce}),Ke(0),N.nextPlayer()),fe()}function er(f,k){const M=it();N.players.forEach(J=>gr(J.id)),Ne(J=>{var z;const ae={};for(const[Ot,Pe]of Object.entries(J))ae[Ot]={...Pe};Mu(M,ae,f,k);const ce=Iu(ae);if(ce)try{wn("leg",((z=N.players.find(Ot=>Ot.id===ce))==null?void 0:z.name)||"Player")}catch{}return ae});const T=_e+1;Ke(T),T>=3&&(Ke(0),N.nextPlayer()),fe()}function bl(f,k,M){const T=it();Ms(T),U(ae=>{const ce={...ae},Ot={...ce[T]||ii()};return lg(Ot,f,k,M,wt=>N.players.filter(ln=>ln.id!==T).every(ln=>{var _t,Re;return(((Re=(_t=ct[ln.id])==null?void 0:_t.marks)==null?void 0:Re[wt])||0)>=3})),ce[T]=Ot,ce});const J=_e+1;Ke(J),J>=3&&(Ke(0),N.nextPlayer()),fe()}function wa(f,k,M){const T=it();ba(T),me(ae=>{const ce={...ae},z={...ce[T]||ri()};return ng(z,f,k,M),ce[T]=z,ce});const J=_e+1;Ke(J),J>=3&&(Ke(0),N.nextPlayer()),fe()}function wl(f,k,M){const T=it();Xr(T),Se(ae=>{const ce={...ae},z={...ce[T]||ai()};return rg(z,f,k,M),ce[T]=z,ce});const J=_e+1;Ke(J),J>=3&&(Ke(0),N.nextPlayer()),fe()}function Qr(f,k,M,T){He(ae=>{const ce={...ae,board:[...ae.board]};return ag(ce,f,k,M,T),ce});const J=_e+1;Ke(J),J>=3&&(Ke(0),N.nextPlayer()),fe()}function jl(){try{window.dispatchEvent(new Event("ndn:open-manual"))}catch{}}function yr(f){const k=Math.max(0,f|0);N.addVisit(k,3),re(0);const M=N.players[N.currentPlayerIdx],T=M.legs[M.legs.length-1];try{k===180&&wn("180",(M==null?void 0:M.name)||"Player"),T&&T.totalScoreRemaining===0&&wn("leg",(M==null?void 0:M.name)||"Player")}catch{}if(T&&T.totalScoreRemaining===0?N.endLeg(k):N.nextPlayer(),_){const J=T?T.totalScoreRemaining:N.startingScore;Po((e==null?void 0:e.username)||"Player",k,Math.max(0,J),te,{volume:L,checkoutOnly:Q})}e!=null&&e.username&&(M==null?void 0:M.name)===e.username&&ia(e.username,3,k),fe()}function Ri(f,k){var T;const M={type:"report",offenderId:f,reason:"Inappropriate language",message:k};try{r?r.send(M):(T=h.current)==null||T.send(JSON.stringify(M))}catch{}try{s("Report submitted",{type:"info"})}catch{}}async function ja(){var f,k;try{const M=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1}),T=(f=M.getVideoTracks)==null?void 0:f.call(M)[0],J=document.createElement("video");J.srcObject=M,await J.play().catch(()=>{}),await new Promise(wt=>setTimeout(wt,120));const ae=Math.min(320,J.videoWidth||320),ce=Math.max(1,Math.floor((J.videoHeight||180)*(ae/Math.max(1,J.videoWidth||320)))),z=document.createElement("canvas");z.width=ae,z.height=ce,z.getContext("2d").drawImage(J,0,0,ae,ce);const Pe=z.toDataURL("image/jpeg",.7);try{T&&T.stop()}catch{}try{(k=M.getTracks)==null||k.call(M).forEach(wt=>wt.stop())}catch{}return Pe}catch{return null}}const Nl=async f=>{console.log("Starting WebRTC for code:",f);try{const k=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});k.ontrack=T=>{console.log("Received track:",T.streams[0]),st(T.streams[0]),yt.current&&(yt.current.srcObject=T.streams[0],console.log("Set video srcObject"))},k.onicecandidate=T=>{T.candidate&&(console.log("Sending ICE candidate"),r?r.send({type:"cam-ice",code:f,payload:T.candidate}):h.current&&h.current.readyState===WebSocket.OPEN&&h.current.send(JSON.stringify({type:"cam-ice",code:f,payload:T.candidate})))},k.onconnectionstatechange=()=>console.log("Connection state:",k.connectionState);const M=await k.createOffer();if(await k.setLocalDescription(M),console.log("Sending offer"),r)console.log("Sending offer via wsGlobal"),r.send({type:"cam-offer",code:f,payload:M});else if(h.current&&h.current.readyState===WebSocket.OPEN)console.log("Sending offer via wsRef"),h.current.send(JSON.stringify({type:"cam-offer",code:f,payload:M}));else{console.log("WS not available, POSTing offer to /cam/signal");try{await Gt(`/cam/signal/${f}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"cam-offer",payload:M,source:"desktop"})})}catch(T){console.warn("REST offer failed",T)}}window.mobilePC=k}catch(k){console.error("WebRTC error:",k),s("Failed to start mobile camera",{type:"error"})}};return n.jsxs("div",{className:"card flex flex-col min-h-[85vh] relative overflow-hidden",children:[n.jsx("h2",{className:"text-xl font-semibold mb-1",children:"Online Play"}),Qn>0&&!N.inProgress&&n.jsxs("div",{className:"mb-3 text-sm px-3 py-2 rounded bg-amber-600/30 border border-amber-500/40",children:["You have ",Qn," unread message",Qn>1?"s":"",". Check the Friends tab."]}),n.jsx("div",{className:"relative",children:n.jsxs("div",{className:"rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-2 flex items-center gap-2 overflow-x-auto no-scrollbar",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-xs opacity-70 shrink-0",children:"Room"}),n.jsx("input",{className:"input w-28",value:l,onChange:f=>i(f.target.value),placeholder:"room-1"})]}),o?n.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full bg-emerald-600/20 text-emerald-200 border border-emerald-400/40 shrink-0",children:"Connected"}):n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 shrink-0",onClick:Je,children:"Connect"}),n.jsx("button",{className:"btn shrink-0",onClick:fe,disabled:!o,children:"Sync"}),n.jsx("button",{className:"text-[11px] px-3 py-1 rounded-full bg-indigo-500/25 text-indigo-100 border border-indigo-400/40 hover:bg-indigo-500/40 shrink-0",title:"Open a simulated online match demo",onClick:()=>{try{window.dispatchEvent(new CustomEvent("ndn:online-match-demo",{detail:{game:"X01",start:501}}))}catch{}},children:"DEMO"}),o&&n.jsx("button",{className:"btn shrink-0",onClick:()=>ut(!0),disabled:en,title:en?"Weekly free games used":"",children:"Open Match"})]})}),n.jsx("div",{className:`mt-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-end ${!o||en?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,role:"button",title:o?en?"Weekly free games used":"Create a new match":"Connect to the lobby first",onClick:()=>{var f;!o||en||(O(!0),r?r.send({type:"list-matches"}):(f=h.current)==null||f.send(JSON.stringify({type:"list-matches"})))},children:n.jsx("button",{className:"btn",disabled:!o||en,children:"Create Match +"})}),n.jsx("p",{className:"text-sm text-slate-600 mt-3",children:"Open this app on another device and join the same Room ID to sync scores."}),!(e!=null&&e.fullAccess)&&n.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Weekly free online games remaining: ",Fn===1/0?"ÔÇö":Fn]}),!(e!=null&&e.fullAccess)&&Fn!==1/0&&Fn<=0&&n.jsx("div",{className:"mt-2 p-2 rounded-lg bg-rose-700/30 border border-rose-600/40 text-rose-200 text-sm",children:"You've used your 3 free online games this week. PREMIUM required to continue."}),rn&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-rose-700/30 border border-rose-600/40 text-rose-200 text-sm font-semibold flex items-center gap-2",children:[n.jsx("span",{className:"material-icons text-rose-300",children:"error_outline"}),rn]}),Yn&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-indigo-700/30 border border-indigo-600/40 text-indigo-100 text-sm flex items-center justify-between gap-2",children:[n.jsx("div",{children:"That room is full or no longer available. Create a new clean room with the same settings?"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{var ae,ce;const{game:f,mode:k,value:M,startingScore:T}=Yn,J=e!=null&&e.username?Dr(e.username):0;r?(r.send({type:"create-match",game:f,mode:k,value:M,startingScore:T||501,creatorAvg:J}),r.send({type:"list-matches"})):((ae=h.current)==null||ae.send(JSON.stringify({type:"create-match",game:f,mode:k,value:M,startingScore:T||501,creatorAvg:J})),(ce=h.current)==null||ce.send(JSON.stringify({type:"list-matches"}))),an(null)},children:"Create New Match"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>an(null),children:"Dismiss"})]})]}),o&&n.jsxs("div",{className:"mt-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10 flex-1 overflow-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("div",{className:"font-semibold",children:"World Lobby"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"text-xs opacity-80",children:["Matches: ",us.length]}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{var f;return r?r.send({type:"list-matches"}):(f=h.current)==null?void 0:f.send(JSON.stringify({type:"list-matches"}))},children:"Refresh"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",title:o?en?"Weekly free games used":"Create a new match":"Connect to the lobby first",disabled:!o||en,onClick:()=>{var f;!o||en||(O(!0),r?r.send({type:"list-matches"}):(f=h.current)==null||f.send(JSON.stringify({type:"list-matches"})))},children:"Create Match +"})]})]}),n.jsxs("div",{className:"space-y-3 mb-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Mode"}),n.jsx(Lc,{tabs:[{key:"all",label:"All"},{key:"bestof",label:"Best of"},{key:"firstto",label:"First to"}],active:os,onChange:f=>lt(f)})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Game"}),n.jsxs("select",{className:"input w-full",value:An,onChange:f=>Fs(f.target.value),children:[n.jsx("option",{value:"all",children:"All"}),ml.map(f=>n.jsx("option",{value:f,children:f},f))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Starting Score"}),n.jsxs("select",{className:"input w-full",value:Es,onChange:f=>{const k=f.target.value;cs(k==="all"?"all":Number(k))},disabled:An!=="all"&&An!=="X01",children:[n.jsx("option",{value:"all",children:"All"}),n.jsx("option",{value:"301",children:"301"}),n.jsx("option",{value:"501",children:"501"}),n.jsx("option",{value:"701",children:"701"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Opponent near my avg"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{id:"nearavg",type:"checkbox",className:"accent-purple-500",checked:Xn,onChange:f=>gn(f.target.checked),disabled:!qr}),n.jsx("label",{htmlFor:"nearavg",className:"cursor-pointer text-sm",children:"Near my average"}),n.jsx("input",{className:"input w-24",type:"number",min:5,max:40,step:1,value:Ys,onChange:f=>Rn(parseInt(f.target.value||"10")),disabled:!Xn})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex-1 max-w-sm",children:[n.jsx("label",{className:`block text-xs opacity-70 mb-1 ${Xn?"":"opacity-40"}`,children:"Avg tolerance (±)"}),n.jsx("input",{className:"w-full",type:"range",min:1,max:50,value:Ys,onChange:f=>Rn(parseInt(f.target.value||"10")),disabled:!Xn}),n.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["± ",Ys]})]}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{lt("all"),Fs("all"),cs("all"),gn(!1),Rn(10)},children:"Reset"})]})]}),us.length===0?n.jsx("div",{className:"text-sm text-slate-300",children:"No games waiting. Create one!"}):n.jsx("div",{className:"space-y-2",children:us.map(f=>n.jsxs("div",{className:"p-3 rounded-lg bg-black/20 flex items-center justify-between relative",children:[n.jsxs("div",{className:"text-sm",children:[n.jsxs("div",{children:[f.game||"X01"," ",f.game==="X01"?` ${f.startingScore}`:""," - ",f.mode==="bestof"?`Best Of ${f.value}`:`First To ${f.value}`," - Created by ",f.creatorName]}),f.requireCalibration&&n.jsx("div",{className:"text-[11px] inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-300 border border-emerald-600/30 mt-1",children:"Calibration required"}),f.creatorAvg?n.jsxs("div",{className:"text-xs opacity-70",children:["Creator avg: ",Number(f.creatorAvg).toFixed(1)]}):null,n.jsxs("div",{className:"text-xs opacity-70",children:["ID: ",f.id]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn px-3 py-1 text-sm bg-green-600 hover:bg-green-700",disabled:en||!(e!=null&&e.fullAccess)&&br.includes(f.game)||!!f.requireCalibration&&!ds,title:!(e!=null&&e.fullAccess)&&br.includes(f.game)?"PREMIUM game":en?"Weekly free games used":f.requireCalibration&&!ds?"Calibration required":"",onClick:async()=>{var T;Bs({game:f.game,mode:f.mode,value:f.value,startingScore:f.startingScore});const k=!!ds,M=await ja();try{r?r.send({type:"join-match",matchId:f.id,calibrated:k,boardPreview:M}):(T=h.current)==null||T.send(JSON.stringify({type:"join-match",matchId:f.id,calibrated:k,boardPreview:M}))}catch(J){jn((J==null?void 0:J.message)||"Failed to create Stripe checkout session. Please try again later.")}},children:"Join Now!"}),D&&f.creatorId===D&&n.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Close this match",onClick:()=>{var k;r?r.send({type:"cancel-match",matchId:f.id}):(k=h.current)==null||k.send(JSON.stringify({type:"cancel-match",matchId:f.id}))},"aria-label":"Close match",children:"×"})]})]},f.id))})]}),!(e!=null&&e.fullAccess)&&Fn!==1/0&&Fn<=0&&n.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),n.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:"­ƒöÆ"}),n.jsx("div",{className:"font-semibold",children:"Online play locked"}),n.jsx("div",{className:"text-sm text-slate-200/80",children:"YouÔÇÖve used your 3 free online games this week. Upgrade to PREMIUM to play all modes."}),n.jsxs("button",{onClick:async()=>{try{const k=await(await fetch(`${t}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e==null?void 0:e.email})})).json();k.ok&&k.url?window.location.href=k.url:alert("Failed to create payment session: "+(k.error||"Unknown error"))}catch{alert("Network error")}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM = ",ux(mx(),5)]})]})]}),Ae&&n.jsxs("div",{className:"fixed inset-0 z-50",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),n.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[n.jsxs("div",{className:"p-2 md:p-3 flex items-center justify-between",children:[n.jsx("div",{children:n.jsx("h3",{className:"text-xl md:text-2xl font-bold",children:"Online Match"})}),n.jsx("button",{className:"btn px-3 py-1",onClick:()=>ut(!1),children:"Close"})]}),n.jsx("div",{className:"relative flex-1 overflow-hidden p-2 md:p-3",children:n.jsxs("div",{className:"card w-full h-full overflow-hidden relative p-2.5 md:p-3",children:[sn&&n.jsxs("div",{className:"absolute inset-0 pointer-events-none flex items-start justify-center pt-8 z-20",children:[n.jsxs("div",{className:`px-4 py-2 rounded-full text-lg font-bold shadow ${sn.kind==="leg"?"bg-indigo-500/20 border border-indigo-400/40 text-indigo-100":"bg-emerald-500/20 border border-emerald-400/40 text-emerald-100"}`,children:[sn.kind==="leg"?"­ƒÅü LEG WON ÔÇö ":"­ƒÄ» ONE HUNDRED AND EIGHTY! ÔÇö ",sn.by]}),sn.kind==="leg"&&n.jsxs(n.Fragment,{children:[n.jsx("style",{children:"@keyframes ndn-confetti-fall{0%{transform:translateY(-10%) rotate(0deg);opacity:1}100%{transform:translateY(120%) rotate(360deg);opacity:0}}"}),n.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(24)].map((f,k)=>{const M=Math.random()*100,T=Math.random()*.2,J=1.2+Math.random()*.8,ae=6+Math.random()*6,ce=Math.floor(Math.random()*360);return n.jsx("span",{style:{position:"absolute",top:0,left:M+"%",width:ae,height:ae,background:`hsl(${ce} 90% 60%)`,borderRadius:2,animation:`ndn-confetti-fall ${J}s ease-out ${T}s forwards`}},k)})})]})]}),n.jsxs("div",{className:"mb-1.5 text-xs md:text-sm flex items-center justify-between gap-2",children:[n.jsxs("span",{children:["Participants: ",ge.length||1]}),n.jsx("button",{className:"text-[11px] px-2 py-0.5 rounded-full bg-slate-700/50 hover:bg-slate-700 border border-slate-600",onClick:()=>Lt(f=>!f),title:zt?"Switch to full multi-player view":"Switch to compact player-by-player view",children:zt?"Full view":"Compact view"})]}),zt?n.jsxs("div",{className:"mb-3",children:[(()=>{var Ot;const f=N.currentPlayerIdx,k=N.players[f];if(!k)return null;const M=k.legs[k.legs.length-1],T=M?M.totalScoreRemaining:N.startingScore,J=(e==null?void 0:e.username)&&k.name===e.username,ae=M&&M.visits.length?M.visits[M.visits.length-1].score:0,ce=M?M.dartsThrown:0,z=ce>0?(((M==null?void 0:M.totalScoreStart)??N.startingScore)-T)/ce*3:0;return Le==="X01"?n.jsxs("div",{className:`p-4 rounded-xl bg-brand-50 text-black ${f===N.currentPlayerIdx?"ring-2 ring-brand-400":""}`,children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:k.name}),n.jsx("span",{className:`px-2 py-0.5 rounded-full ${f===N.currentPlayerIdx?"bg-emerald-500/20 text-emerald-300":"bg-slate-500/20 text-slate-300"} text-xs font-bold`,children:f===N.currentPlayerIdx?"THROWING":"WAITING TO THROW"})]}),n.jsx("div",{className:"text-4xl font-extrabold",children:T}),n.jsxs("div",{className:"text-sm mt-1",children:["Last score: ",n.jsx("span",{className:"font-semibold",children:ae})]}),n.jsxs("div",{className:"text-sm",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:z.toFixed(1)})]}),J&&f===N.currentPlayerIdx&&T<=170&&T>0&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-indigo-50 border border-indigo-200 text-indigo-900 text-sm",children:["Checkout suggestions (fav ",G,"): ",ic(T,G).join("  ÔÇó  ")||"ÔÇö"]})]}):n.jsxs("div",{className:`p-4 rounded-xl bg-brand-50 text-black ${f===N.currentPlayerIdx?"ring-2 ring-brand-400":""}`,children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:k.name}),n.jsx("span",{className:`px-2 py-0.5 rounded-full ${f===N.currentPlayerIdx?"bg-emerald-500/20 text-emerald-300":"bg-slate-500/20 text-slate-300"} text-xs font-bold`,children:f===N.currentPlayerIdx?"THROWING":"WAITING TO THROW"})]}),n.jsx("div",{className:"text-sm opacity-80",children:Le}),Le==="Double Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mt-1 text-xs flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:((Ot=xs[Dt])==null?void 0:Ot.label)||"ÔÇö"})]}),n.jsxs("div",{className:"text-3xl font-extrabold",children:[et," / ",xs.length]})]}),Le==="Around the Clock"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mt-1 text-xs flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:on[pe]===25?"25 (Outer Bull)":on[pe]===50?"50 (Inner Bull)":on[pe]||"ÔÇö"})]}),n.jsxs("div",{className:"text-3xl font-extrabold",children:[mt," / ",on.length]})]})]})})(),N.players.length>1&&n.jsxs("div",{className:"mt-2 text-xs text-slate-400",children:["Next up: ",(Zr=N.players[(N.currentPlayerIdx+1)%N.players.length])==null?void 0:Zr.name]})]}):n.jsx(n.Fragment,{children:n.jsx("div",{className:"mb-3 flex flex-wrap items-center gap-2",children:N.players.map((f,k)=>{var J,ae,ce,z,Ot,Pe,wt,ln;const M=f.legs[f.legs.length-1],T=M?M.totalScoreRemaining:N.startingScore;return n.jsxs("div",{className:`px-2 py-1 rounded bg-black/20 border border-slate-700/40 text-xs ${k===N.currentPlayerIdx?"ring-1 ring-brand-400":""}`,children:[n.jsx("span",{className:"font-semibold",children:f.name}),Le==="X01"?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"opacity-70",children:" = "}),n.jsx("span",{className:"font-mono",children:T})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"opacity-70",children:" = "}),n.jsx("span",{className:"font-mono",children:Le==="Double Practice"?`${et}/${xs.length}`:Le==="Around the Clock"?`${mt}/${on.length}`:Le==="Cricket"?`${((J=rt[f.id])==null?void 0:J.points)||0} pts`:Le==="Shanghai"?`${((ae=xt[f.id])==null?void 0:ae.score)||0} pts = R${((ce=xt[f.id])==null?void 0:ce.round)||1}`:Le==="Halve It"?`${((z=vt[f.id])==null?void 0:z.score)||0} pts = S${(((Ot=vt[f.id])==null?void 0:Ot.stage)||0)+1}`:Le==="High-Low"?`${((Pe=Ft[f.id])==null?void 0:Pe.score)||0} pts = ${((wt=Ft[f.id])==null?void 0:wt.target)||"HIGH"}`:Le==="Killer"?(()=>{const _t=F[f.id];return _t?`#${_t.number} = ${_t.lives}ÔØñ ${_t.isKiller?"= K":""}`:"ÔÇö"})():Le==="American Cricket"?`${((ln=ct[f.id])==null?void 0:ln.points)||0} pts`:Le==="Baseball"?(()=>{const _t=H[f.id];return _t?`R${_t.score} = I${_t.inning}`:"ÔÇö"})():Le==="Golf"?(()=>{const _t=be[f.id];return _t?`S${_t.strokes} = H${_t.hole}`:"ÔÇö"})():Le==="Tic Tac Toe"?(()=>{const _t=(Be.board||[]).filter(Ll=>Ll==="X").length,Re=(Be.board||[]).filter(Ll=>Ll==="O").length;return`X${_t}-O${Re}`})():Le})]})]},`strip-${f.id}`)})})}),zt?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("button",{className:`btn ${he}`,onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-autoscore"))}catch{}},children:"Autoscore"}),n.jsx("button",{className:`btn ${he}`,onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-scoring"))}catch{}},children:"Scoring"}),n.jsx("button",{className:`btn ${he}`,onClick:jl,children:"Manual Correction"}),!Ee&&n.jsx("button",{className:`btn ${he}`,onClick:()=>{console.log("Sending cam-create"),r?r.send({type:"cam-create"}):h.current&&h.current.readyState===WebSocket.OPEN?h.current.send(JSON.stringify({type:"cam-create"})):s("Not connected to server",{type:"error"})},children:"Pair Phone"}),!Ee&&Pt&&n.jsxs("div",{className:"ml-2 text-sm bg-blue-900/50 p-2 rounded",children:[n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Mobile pairing code: "}),n.jsx("span",{className:"font-mono font-bold text-lg",children:Pt})]}),n.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["On your phone, go to: ",n.jsxs("a",{href:`/mobile-cam.html?code=${Pt}`,target:"_blank",className:"underline",children:[window.location.origin,"/mobile-cam.html?code=",Pt]})]})]}),!Ee&&n.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[11px]",children:[n.jsx("span",{className:"opacity-70",children:"Cam size"}),n.jsx("button",{className:`btn ${he}`,onClick:()=>Z(Math.max(.5,Math.round((R-.05)*100)/100)),children:"−"}),n.jsxs("span",{className:`btn ${he} min-w-[2.5rem] text-center`,children:[Math.round(R*100),"%"]}),n.jsx("button",{className:`btn ${he}`,onClick:()=>Z(Math.min(1.25,Math.round((R+.05)*100)/100)),children:"+"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mt-2 items-start",children:[n.jsx("div",{className:"order-1",children:n.jsx(St,{})}),n.jsx("div",{className:"order-2",children:$?n.jsxs("div",{className:"min-w-[260px] relative z-10 overflow-hidden",style:{maxHeight:"min(50vh, 400px)"},children:[n.jsx(oc,{label:"Your Board",autoStart:(e==null?void 0:e.username)&&((kl=N.players[N.currentPlayerIdx])==null?void 0:kl.name)===e.username}),ee&&n.jsxs("div",{className:"mt-2",children:[n.jsx("video",{ref:yt,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-auto max-h-32 object-cover rounded border"}),n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Mobile Camera"})]})]}):n.jsx("div",{className:"text-xs opacity-60",children:"Camera disabled in settings"})})]}),n.jsxs("div",{className:"font-semibold",children:["Current: ",((Sl=N.players[N.currentPlayerIdx])==null?void 0:Sl.name)||"ÔÇö"]}),Le==="X01"&&$&&(e!=null&&e.username)&&((Cl=N.players[N.currentPlayerIdx])==null?void 0:Cl.name)===e.username?n.jsxs(n.Fragment,{children:[n.jsx(Xe,{hideInlinePanels:!0,showToolbar:!1,onVisitCommitted:(f,k,M)=>{if(_){const J=N.players[N.currentPlayerIdx],ae=J==null?void 0:J.legs[J.legs.length-1],ce=ae?ae.totalScoreRemaining:N.startingScore;Po((e==null?void 0:e.username)||"Player",f,Math.max(0,ce),te,{volume:L,checkoutOnly:Q})}const T=N.players[N.currentPlayerIdx];e!=null&&e.username&&(T==null?void 0:T.name)===e.username&&ia(e.username,k,f);try{f===180&&wn("180",(T==null?void 0:T.name)||"Player"),M&&wn("leg",(T==null?void 0:T.name)||"Player")}catch{}M||N.nextPlayer(),fe()}}),n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>yr(de),children:"Submit Visit"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs bg-slate-700 hover:bg-slate-800",onClick:()=>{N.undoVisit(),fe()},children:"Undo"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mt-1.5 text-xs",children:[n.jsx("span",{className:"opacity-70",children:"Quick:"}),[180,140,100,60].map(f=>n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>yr(f),children:f},f))]}),n.jsxs("div",{className:"mt-2 flex items-center gap-1.5 mb-2",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>x(!0),children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>v(!0),children:"Messages"})]})]}):Le==="Double Practice"&&(e!=null&&e.username)&&((El=N.players[N.currentPlayerIdx])==null?void 0:El.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Double Practice ÔÇö Hit doubles D1ÔåÆD20ÔåÆDBULL"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:((Tl=xs[Dt])==null?void 0:Tl.label)||"ÔÇö"})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:[et," / ",xs.length]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k)=>{(k==="DOUBLE"||k==="INNER_BULL")&&Rt(f)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&bt()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:bt,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[n.jsx("input",{className:"input w-40 text-sm",placeholder:"Manual (D16, 50, 25, T20)",value:je,onChange:f=>ye(f.target.value),onKeyDown:f=>{f.key==="Enter"&&Et()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:Et,children:"Add"})]})]}):Le==="Around the Clock"&&(e!=null&&e.username)&&((Oi=N.players[N.currentPlayerIdx])==null?void 0:Oi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Around the Clock ÔÇö Hit 1ÔåÆ20 then 25 (outer) and 50 (inner)"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:on[pe]===25?"25 (Outer Bull)":on[pe]===50?"50 (Inner Bull)":on[pe]||"ÔÇö"})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:[mt," / ",on.length]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{kn(f,k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&pr()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:pr,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[n.jsx("input",{className:"input w-40 text-sm",placeholder:"Manual (T20, D5, 25, 50)",value:$t,onChange:f=>ht(f.target.value),onKeyDown:f=>{f.key==="Enter"&&Xs()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:Xs,children:"Add"})]})]}):Le==="Cricket"&&(e!=null&&e.username)&&((Na=N.players[N.currentPlayerIdx])==null?void 0:Na.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Cricket ÔÇö Close 15-20 and Bull; overflow scores points"}),(()=>{const f=it();Qs(f);const k=rt[f]||oa();return n.jsx("div",{className:"mb-2 grid grid-cols-7 gap-1 text-center text-[11px]",children:Ti.map(M=>{var T;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:M===25?"Bull":M}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((T=k.marks)==null?void 0:T[M])||0)," / 3"]})]},M)})})})(),n.jsxs("div",{className:"text-sm mb-2",children:["Points: ",n.jsx("span",{className:"font-semibold",children:((_i=rt[it()])==null?void 0:_i.points)||0})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{zn(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&(zn(Math.max(0,de|0)),re(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{zn(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Shanghai"&&(e!=null&&e.username)&&((ka=N.players[N.currentPlayerIdx])==null?void 0:ka.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();Yr(f);const k=xt[f]||Cr();return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Shanghai ÔÇö Hit only the round's number; Single/Double/Triple score"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Round"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:k.round})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:["Score: ",k.score]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{ms(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&(ms(Math.max(0,de|0)),re(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{ms(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Halve It"&&(e!=null&&e.username)&&((Ui=N.players[N.currentPlayerIdx])==null?void 0:Ui.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();Ts(f);const k=vt[f]||Er(),M=cc(k);return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Halve It ÔÇö Hit the target each round or your score halves"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Stage"}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[k.stage+1,"/",k.targets.length]})]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:(()=>{const T=M;return T?T.kind==="ANY_NUMBER"?"Any":T.kind==="BULL"?"Bull":T.kind==="DOUBLE"||T.kind==="TRIPLE"||T.kind==="NUMBER"?`${T.kind} ${T.num}`:"ÔÇö":"ÔÇö"})()})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:["Score: ",k.score]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{Zs(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&(Zs(Math.max(0,de|0)),re(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{Zs(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="High-Low"&&(e!=null&&e.username)&&((Sa=N.players[N.currentPlayerIdx])==null?void 0:Sa.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();xr(f);const k=Ft[f]||Tr();return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"High-Low ÔÇö Alternate aiming for high then low segments"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Round"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:k.round})]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:k.target})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:["Score: ",k.score]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{Is(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&(Is(Math.max(0,de|0)),re(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{Is(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="American Cricket"&&(e!=null&&e.username)&&((Bi=N.players[N.currentPlayerIdx])==null?void 0:Bi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"American Cricket ÔÇö Close 12-20 and Bull; overflow scores"}),(()=>{const f=it();Ms(f);const k=ct[f]||ii();return n.jsx("div",{className:"mb-2 grid grid-cols-5 gap-1 text-center text-[11px]",children:Pc.map(M=>{var T;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:M===25?"Bull":M}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((T=k.marks)==null?void 0:T[M])||0)," / 3"]})]},M)})})})(),n.jsxs("div",{className:"text-sm mb-2",children:["Points: ",n.jsx("span",{className:"font-semibold",children:((Ca=ct[it()])==null?void 0:Ca.points)||0})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{bl(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{bl(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Baseball"&&(e!=null&&e.username)&&(($i=N.players[N.currentPlayerIdx])==null?void 0:$i.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();ba(f);const k=H[f]||ri();return n.jsxs("div",{className:"text-xs mb-1.5",children:["Baseball ÔÇö Inning ",k.inning," ÔÇó Runs ",k.score]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{wa(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{wa(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Golf"&&(e!=null&&e.username)&&((Ea=N.players[N.currentPlayerIdx])==null?void 0:Ea.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();Xr(f);const k=be[f]||ai();return n.jsxs("div",{className:"text-xs mb-1.5",children:["Golf ÔÇö Hole ",k.hole," (target ",sg[k.hole],") ÔÇó Strokes ",k.strokes]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{wl(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{wl(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Tic Tac Toe"&&(e!=null&&e.username)&&((Fi=N.players[N.currentPlayerIdx])==null?void 0:Fi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Tic Tac Toe ÔÇö Tap a cell to claim by hitting its target"}),n.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(f,k)=>k).map(f=>n.jsx("button",{className:`h-12 rounded-xl border ${Be.board[f]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(Be.finished||Be.board[f])return;const k=li[f],M=Number(dn||0),T=M%3===0?"TRIPLE":M%2===0?"DOUBLE":"SINGLE",J=k.type==="BULL"?null:k.num||null;Qr(f,M,T,J),Qt("")},children:Be.board[f]||""},f))}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-40 text-sm",placeholder:"Enter dart score (e.g. 20, 40, 60, 25, 50)",value:dn,onChange:f=>Qt(f.target.value),onKeyDown:f=>{if(f.key==="Enter"){const k=Array.from({length:9},(M,T)=>T).find(M=>!Be.board[M]&&!Be.finished);if(k!==void 0){const M=li[k],T=Number(dn||0),J=T%3===0?"TRIPLE":T%2===0?"DOUBLE":"SINGLE",ae=M.type==="BULL"?null:M.num||null;Qr(k,T,J,ae),Qt("")}}}}),n.jsx("button",{className:"btn",onClick:()=>{const f=Array.from({length:9},(k,M)=>M).find(k=>!Be.board[k]&&!Be.finished);if(f!==void 0){const k=li[f],M=Number(dn||0),T=M%3===0?"TRIPLE":M%2===0?"DOUBLE":"SINGLE",J=k.type==="BULL"?null:k.num||null;Qr(f,M,T,J),Qt("")}},children:"Claim Cell"})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{}})})]}):Le==="Killer"&&(e!=null&&e.username)&&((Ta=N.players[N.currentPlayerIdx])==null?void 0:Ta.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Killer ÔÇö Hit your own double to become Killer; then remove othersÔÇÖ lives by hitting their doubles/triples."}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Your number"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:(()=>{var k;const f=it();return N.players.forEach(M=>gr(M.id)),((k=F[f])==null?void 0:k.number)||"ÔÇö"})()})]}),n.jsxs("div",{className:"text-sm",children:["Lives: ",n.jsx("span",{className:"font-semibold",children:(()=>{var k;const f=it();return((k=F[f])==null?void 0:k.lives)??"ÔÇö"})()})," ",(()=>{var k;const f=it();return(k=F[f])!=null&&k.isKiller?n.jsx("span",{className:"ml-2 text-emerald-300",children:"KILLER"}):null})()]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{er(k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&(er("SINGLE",Math.max(0,de|0)),re(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{er("SINGLE",Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):e!=null&&e.username&&((zi=N.players[N.currentPlayerIdx])==null?void 0:zi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsxs("div",{className:"text-xs mb-1.5",children:[Le," (online) ÔÇö manual turn entry"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{const f=Math.max(0,de|0);N.addVisit(f,3),re(0),N.nextPlayer(),fe()},children:"Submit"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs bg-slate-700 hover:bg-slate-800",onClick:()=>{N.undoVisit(),fe()},children:"Undo"})]})]}):n.jsx("div",{className:"p-4 rounded-xl bg-slate-800/30 border border-slate-700/40 text-center text-slate-300 font-semibold",children:"WAITING TO THROW"}),n.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>x(!0),children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>v(!0),children:"Messages"})]})]}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[n.jsx("div",{className:"space-y-1.5",children:n.jsx(St,{})}),n.jsxs("div",{className:`md:col-span-${Ze} space-y-1.5 relative`,children:[n.jsxs("div",{className:"flex items-center gap-1.5 mt-2",children:[n.jsx("button",{className:`btn ${he}`,onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-autoscore"))}catch{}},children:"Autoscore"}),n.jsx("button",{className:`btn ${he}`,onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-scoring"))}catch{}},children:"Scoring"}),n.jsx("button",{className:`btn ${he}`,onClick:jl,children:"Manual Correction"}),n.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[n.jsx("span",{className:"text-xs opacity-70",children:"Cam"}),n.jsx("button",{className:`btn ${he}`,onClick:()=>Z(Math.max(.5,Math.round((R-.05)*100)/100)),children:"−"}),n.jsxs("span",{className:`btn ${he} bg-transparent border-slate-600 text-center min-w-[3rem]`,children:[Math.round(R*100),"%"]}),n.jsx("button",{className:`btn ${he}`,onClick:()=>Z(Math.min(1.25,Math.round((R+.05)*100)/100)),children:"+"}),n.jsx("button",{className:`btn ${he}`,onClick:()=>ft(Ze===2?3:2),title:Ze===2?"Expand camera":"Shrink camera",children:Ze===2?"↔":"↙"})]})]}),n.jsxs("div",{className:"mt-2 relative",children:[n.jsx("div",{className:"w-full max-w-full",children:n.jsx(oc,{label:"Your Board",autoStart:(e==null?void 0:e.username)&&((Ml=N.players[N.currentPlayerIdx])==null?void 0:Ml.name)===e.username})}),Ze<3&&n.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize bg-slate-600/20 hover:bg-slate-600/40 transition-colors flex items-center justify-center group",onMouseDown:f=>{f.preventDefault();const k=f.clientX,M=Ze,T=ae=>{ae.clientX-k>50&&M===2&&ft(3)},J=()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",J)};document.addEventListener("mousemove",T),document.addEventListener("mouseup",J)},children:n.jsx("div",{className:"w-0.5 h-8 bg-slate-400 group-hover:bg-slate-300 transition-colors"})})]}),n.jsxs("div",{className:"font-semibold text-sm md:text-base",children:["Current: ",((Hi=N.players[N.currentPlayerIdx])==null?void 0:Hi.name)||"ÔÇö"]}),Le==="X01"&&(e!=null&&e.username)&&((Il=N.players[N.currentPlayerIdx])==null?void 0:Il.name)===e.username?n.jsxs(n.Fragment,{children:[n.jsx(Xe,{hideInlinePanels:!0,showToolbar:!1,onVisitCommitted:(f,k,M)=>{if(_){const J=N.players[N.currentPlayerIdx],ae=J==null?void 0:J.legs[J.legs.length-1],ce=ae?ae.totalScoreRemaining:N.startingScore;Po((e==null?void 0:e.username)||"Player",f,Math.max(0,ce),te,{volume:L,checkoutOnly:Q})}const T=N.players[N.currentPlayerIdx];e!=null&&e.username&&(T==null?void 0:T.name)===e.username&&ia(e.username,k,f);try{f===180&&wn("180",(T==null?void 0:T.name)||"Player"),M&&wn("leg",(T==null?void 0:T.name)||"Player")}catch{}M||N.nextPlayer(),fe()}}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>yr(de),children:"Submit Visit (Manual)"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{N.undoVisit(),fe()},children:"Undo"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2 text-sm",children:[n.jsx("span",{className:"opacity-70",children:"Quick:"}),[180,140,100,60].map(f=>n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>yr(f),children:f},f))]}),(()=>{var T,J;const f=N.players[N.currentPlayerIdx],k=(J=f==null?void 0:f.legs)==null?void 0:J[((T=f.legs)==null?void 0:T.length)-1],M=k?k.totalScoreRemaining:N.startingScore;return M>0&&M<=170?n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-indigo-50 border border-indigo-200 text-indigo-900 text-sm",children:["Checkout suggestions (fav ",G,"): ",ic(M,G).join("  ÔÇó  ")||"ÔÇö"]}):null})()]}):Le==="Double Practice"&&(e!=null&&e.username)&&((Wi=N.players[N.currentPlayerIdx])==null?void 0:Wi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-sm mb-2",children:"Double Practice ÔÇö Hit doubles D1ÔåÆD20ÔåÆDBULL"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:((Ma=xs[Dt])==null?void 0:Ma.label)||"ÔÇö"})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:[et," / ",xs.length]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k)=>{(k==="DOUBLE"||k==="INNER_BULL")&&Rt(f)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0")),onKeyDown:f=>{f.key==="Enter"&&bt()}}),n.jsx("button",{className:"btn",onClick:bt,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:je,onChange:f=>ye(f.target.value),onKeyDown:f=>{f.key==="Enter"&&Et()}}),n.jsx("button",{className:"btn",onClick:Et,children:"Add"})]})]}):Le==="Cricket"&&(e!=null&&e.username)&&((yn=N.players[N.currentPlayerIdx])==null?void 0:yn.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-sm mb-2",children:"Cricket ÔÇö Close 15-20 and Bull; overflow scores points"}),(()=>{const f=it();Qs(f);const k=rt[f]||oa();return n.jsx("div",{className:"mb-2 grid grid-cols-7 gap-1 text-center text-[11px]",children:Ti.map(M=>{var T;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:M===25?"Bull":M}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((T=k.marks)==null?void 0:T[M])||0)," / 3"]})]},M)})})})(),n.jsxs("div",{className:"text-sm mb-2",children:["Points: ",n.jsx("span",{className:"font-semibold",children:((un=rt[it()])==null?void 0:un.points)||0})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{zn(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{zn(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Shanghai"&&(e!=null&&e.username)&&((Dl=N.players[N.currentPlayerIdx])==null?void 0:Dl.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();Yr(f);const k=xt[f]||Cr();return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"text-sm mb-2",children:["Shanghai ÔÇö Round ",k.round," ÔÇó Score ",k.score]})})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{ms(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{ms(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Halve It"&&(e!=null&&e.username)&&((Ia=N.players[N.currentPlayerIdx])==null?void 0:Ia.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();Ts(f);const k=vt[f]||Er(),M=cc(k);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-sm mb-2",children:["Halve It ÔÇö Stage ",k.stage+1,"/",k.targets.length," ÔÇó Score ",k.score]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:(()=>{const T=M;return T?T.kind==="ANY_NUMBER"?"Any":T.kind==="BULL"?"Bull":T.kind==="DOUBLE"||T.kind==="TRIPLE"||T.kind==="NUMBER"?`${T.kind} ${T.num}`:"ÔÇö":"ÔÇö"})()})]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{Zs(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{Zs(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="High-Low"&&(e!=null&&e.username)&&((Pl=N.players[N.currentPlayerIdx])==null?void 0:Pl.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();xr(f);const k=Ft[f]||Tr();return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"text-sm mb-2",children:["High-Low ÔÇö Round ",k.round," ÔÇó Target ",k.target," ÔÇó Score ",k.score]})})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{Is(f,k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{Is(Math.max(0,de|0)),re(0)},children:"Add Dart"})]})]}):Le==="Killer"&&(e!=null&&e.username)&&((Vi=N.players[N.currentPlayerIdx])==null?void 0:Vi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const f=it();N.players.forEach(M=>gr(M.id));const k=F[f];return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Killer ÔÇö Hit your own double to become Killer; then remove othersÔÇÖ lives by hitting their doubles/triples."}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Your number"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:(k==null?void 0:k.number)||"ÔÇö"})]}),n.jsxs("div",{className:"text-sm",children:["Lives: ",n.jsx("span",{className:"font-semibold",children:(k==null?void 0:k.lives)??"ÔÇö"})," ",k!=null&&k.isKiller?n.jsx("span",{className:"ml-2 text-emerald-300",children:"KILLER"}):null]}),n.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-3 gap-1 text-[11px]",children:N.players.map(M=>{const T=F[M.id];return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80 truncate",children:M.name}),n.jsx("span",{className:"font-mono",children:T?`#${T.number} = ${T.lives}ÔØñ${T.isKiller?" = K":""}`:"ÔÇö"})]},M.id)})})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 my-2",children:n.jsx(Xe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(f,k,M)=>{er(k==="MISS"?void 0:k,(M==null?void 0:M.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{er("SINGLE",Math.max(0,de|0)),re(0)},children:"Add Dart"})]}),n.jsx("div",{className:"text-xs opacity-70",children:"Tip: Only doubles/triples on the opponentsÔÇÖ numbers remove lives. To become Killer, hit your own double."})]}):e!=null&&e.username&&((Gi=N.players[N.currentPlayerIdx])==null?void 0:Gi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsxs("div",{className:"text-sm mb-2",children:[Le," (online) ÔÇö manual turn entry"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:de,onChange:f=>re(parseInt(f.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{const f=Math.max(0,de|0);N.addVisit(f,3),re(0),N.nextPlayer(),fe()},children:"Submit"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{N.undoVisit(),fe()},children:"Undo"})]})]}):n.jsx("div",{className:"p-4 rounded-xl bg-slate-800/30 border border-slate-700/40 text-center text-slate-300 font-semibold",children:"WAITING TO THROW"})]}),n.jsx("div",{className:"md:col-span-1",children:n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>x(!0),children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>v(!0),children:"Messages"})]})})]})]})})]})]}),yl&&n.jsx("div",{className:"fixed inset-0 bg-black/70 z-50",children:n.jsx("div",{className:"w-full h-full flex items-stretch justify-stretch p-0",children:n.jsxs(Lr,{storageKey:"ndn:modal:create-match",className:"w-full h-full rounded-none !border-0 !shadow-none relative",fullScreen:!0,children:[n.jsx("div",{className:"flex items-center justify-between mb-3 sticky top-0 bg-slate-900/80 backdrop-blur border-b border-slate-700 z-10 px-2 py-2",children:n.jsx("h3",{className:"text-xl font-bold",children:"Create Match"})}),n.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-2 md:gap-4 overflow-auto px-2",style:{maxHeight:"calc(100vh - 120px)"},children:[n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Game"}),n.jsx("select",{className:"input w-full",value:xn,onChange:f=>$s(f.target.value),children:ml.map(f=>n.jsxs("option",{value:f,disabled:!(e!=null&&e.fullAccess)&&br.includes(f),children:[f," ",!(e!=null&&e.fullAccess)&&br.includes(f)?"(PREMIUM)":""]},f))})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Mode"}),n.jsxs("select",{className:"input w-full",value:K,onChange:f=>V(f.target.value),children:[n.jsx("option",{value:"bestof",children:"Best Of"}),n.jsx("option",{value:"firstto",children:"First To"})]})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Value"}),xn==="X01"?n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"flex flex-wrap gap-1",children:[101,201,301,401,501].map(f=>n.jsx("button",{className:`btn px-2 py-1 text-xs ${De===f?"bg-purple-600 hover:bg-purple-700":""}`,onClick:()=>we(f),children:f},f))}),n.jsx("input",{className:"input w-full",type:"number",min:1,value:De,onChange:f=>we(parseInt(f.target.value||"1")),placeholder:"Or enter custom value"})]}):n.jsx("input",{className:"input w-full",type:"number",min:1,value:De,onChange:f=>we(parseInt(f.target.value||"1"))}),n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Example: Best Of 5 — first to 3"})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Starting Score"}),xn==="X01"?n.jsx("select",{className:"input w-full",value:at,onChange:f=>Ye(parseInt(f.target.value||"501")),children:[301,501,701].map(f=>n.jsx("option",{value:f,children:f},f))}):n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Starting score applies to X01 only"})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Require Calibration"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{id:"calibreq",type:"checkbox",className:"accent-purple-500",checked:pt,onChange:f=>Nn(f.target.checked)}),n.jsx("label",{htmlFor:"calibreq",className:"text-sm opacity-80",children:"Players must be calibrated"})]})]}),n.jsx("div",{className:"col-span-1",children:n.jsxs("div",{className:"p-3 rounded-lg bg-black/20 border border-slate-700/40",children:[n.jsx("div",{className:"text-xs text-slate-300 uppercase tracking-wide mb-1",children:"Summary"}),n.jsxs("div",{className:"text-sm font-semibold",children:[xn," — ",K==="bestof"?`Best Of ${De}`:`First To ${De}`," ",xn==="X01"?`— ${at}`:""]}),!(e!=null&&e.fullAccess)&&br.includes(xn)&&n.jsx("div",{className:"text-xs text-rose-300 mt-1",children:"PREMIUM required"})]})})]}),n.jsxs("div",{className:"sticky bottom-0 bg-slate-900/80 backdrop-blur border-t border-slate-700 z-10 px-2 py-2",children:[n.jsx("button",{className:"btn w-full",disabled:!(e!=null&&e.fullAccess)&&br.includes(xn),title:!(e!=null&&e.fullAccess)&&br.includes(xn)?"PREMIUM game":"",onClick:()=>{var k,M;const f=e!=null&&e.username?Dr(e.username):0;r?(r.send({type:"create-match",game:xn,mode:K,value:De,startingScore:at,creatorAvg:f,requireCalibration:pt}),O(!1),r.send({type:"list-matches"})):((k=h.current)==null||k.send(JSON.stringify({type:"create-match",game:xn,mode:K,value:De,startingScore:at,creatorAvg:f,requireCalibration:pt})),O(!1),(M=h.current)==null||M.send(JSON.stringify({type:"list-matches"})))},children:"START GAME!"}),n.jsx("div",{className:"flex justify-center mt-2",children:n.jsx("button",{className:"btn px-2 py-1",onClick:()=>O(!1),children:"Close"})})]})]})})}),Te&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs(Lr,{storageKey:"ndn:modal:invite",className:"w-full relative",defaultWidth:620,defaultHeight:420,minWidth:520,minHeight:320,maxWidth:1e3,maxHeight:800,children:[n.jsx("h3",{className:"text-xl font-bold mb-1",children:"Incoming Match Request"}),n.jsxs("div",{className:"text-sm mb-2",children:[n.jsx("span",{className:"font-semibold",children:Te.fromName})," wants to join your match.",n.jsx("span",{className:`ml-2 text-xs px-2 py-0.5 rounded ${Te.calibrated?"bg-emerald-500/20 text-emerald-300 border border-emerald-600/30":"bg-amber-500/20 text-amber-200 border border-amber-600/30"}`,children:Te.calibrated?"Calibrated":"Not calibrated"})]}),(Te.game||Te.mode)&&n.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[Te.game||"X01"," ÔÇó ",Te.mode==="firstto"?`First To ${Te.value}`:`Best Of ${Te.value}`," ",Te.game==="X01"&&Te.startingScore?`ÔÇó ${Te.startingScore}`:""]}),Te.boardPreview?n.jsx("div",{className:"mb-3",children:n.jsx("img",{src:Te.boardPreview,alt:"Board preview",className:"rounded-lg w-full max-h-64 object-contain bg-black/40 border border-slate-700"})}):n.jsx("div",{className:"mb-3 text-xs opacity-60",children:"No camera preview provided."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{var f;r?r.send({type:"invite-response",matchId:Te.matchId,accept:!0,toId:Te.fromId}):(f=h.current)==null||f.send(JSON.stringify({type:"invite-response",matchId:Te.matchId,accept:!0,toId:Te.fromId})),kt(null)},children:"Accept"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>{var f;r?r.send({type:"invite-response",matchId:Te.matchId,accept:!1,toId:Te.fromId}):(f=h.current)==null||f.send(JSON.stringify({type:"invite-response",matchId:Te.matchId,accept:!1,toId:Te.fromId})),kt(null)},children:"Decline"})]})]})}),g&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:n.jsxs(Lr,{storageKey:"ndn:modal:quick-chat",className:"w-full relative",defaultWidth:520,defaultHeight:280,minWidth:360,minHeight:220,maxWidth:900,maxHeight:700,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-1 text-sm",onClick:()=>x(!1),children:"Close"})]}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:["Good luck!","Good game!","Nice darts!","Well played!","Ready?"].map(f=>n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{Ct(f),x(!1)},disabled:!o,children:f},f))})]})}),y&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:n.jsxs(Lr,{storageKey:"ndn:modal:messages",className:"w-full relative",defaultWidth:560,defaultHeight:360,minWidth:380,minHeight:260,maxWidth:1e3,maxHeight:800,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Messages"}),n.jsx("button",{className:"btn px-2 py-1 text-sm",onClick:()=>v(!1),children:"Close"})]}),n.jsx(xj,{items:u.slice(-30).filter(f=>!a.isBlocked(String(f.fromId||""))).map((f,k)=>({key:String(k),from:f.from,id:String(f.fromId||f.from),text:f.message})),onDelete:f=>d(k=>k.filter((M,T)=>T!==f)),onReport:f=>{const M=u.slice(-30).filter(T=>!a.isBlocked(String(T.fromId||"")))[f];M&&Ri(null,M.message)},onBlock:f=>{const M=u.slice(-30).filter(T=>!a.isBlocked(String(T.fromId||"")))[f];if(M){try{a.block(String(M.fromId||M.from))}catch{}d(T=>T.filter(J=>String(J.fromId||J.from)!==String(M.fromId||M.from)));try{s(`${M.from} blocked`,{type:"info"})}catch{}}}})]})})]})}function xj({items:e,onDelete:t,onReport:s,onBlock:r}){const a=(()=>{try{const u=navigator.userAgent||"";return/Android|iPhone|iPad|iPod|Mobile/i.test(u)}catch{return!1}})(),[l,i]=m.useState(null),[o,c]=m.useState(null);return n.jsx("div",{className:"h-24 overflow-auto text-sm divide-y divide-slate-700/40",children:e.length===0?n.jsx("div",{className:"opacity-60 py-1",children:"No messages yet."}):e.map((u,d)=>{const g=dg(u.text),x=ej(u.text);return n.jsxs("div",{className:"relative group px-1 py-1 flex items-start gap-2",onTouchStart:a?y=>{const v=y.touches[0];i({x:v.clientX,y:v.clientY,i:d,t:Date.now()})}:void 0,onTouchMove:a?y=>{if(!l||l.i!==d)return;y.touches[0].clientX-l.x<-40&&c(d)}:void 0,onTouchEnd:a?()=>{const y=l?Date.now()-l.t:0;(o===d||y>600)&&(t(d),c(null)),i(null)}:void 0,children:[n.jsxs("span",{className:"text-slate-400 shrink-0",children:["[",u.from,"]"]}),n.jsx("span",{className:"text-white break-words whitespace-pre-wrap flex-1",children:g}),!a&&n.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1 ml-2",children:[n.jsx("button",{className:"w-5 h-5 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center",title:"Delete message","aria-label":"Delete message",onClick:()=>t(d),children:"├ù"}),r&&n.jsx("button",{className:"px-1.5 py-0.5 rounded bg-slate-700 hover:bg-slate-800 text-slate-100 text-[11px]",onClick:()=>r(d),title:"Block sender",children:"Block"}),n.jsx("button",{className:"px-1.5 py-0.5 rounded bg-amber-600/40 hover:bg-amber-600/60 text-amber-100 text-[11px]",onClick:()=>s(d),title:"Report message",children:"Report"})]}),x&&n.jsx("span",{className:"ml-2 text-[10px] px-1 rounded bg-rose-600/30 text-rose-200 border border-rose-600/40",children:"Filtered"})]},u.key)})})}function gj({user:e}){const{players:t,inProgress:s,startingScore:r,newMatch:a}=si(),[l,i]=m.useState("x01"),[o,c]=m.useState("Player 1, Player 2"),[u,d]=m.useState(501),[g,x]=m.useState([]),[y,v]=m.useState(""),[C,D]=m.useState(!1),[b,h]=m.useState(""),[w,E]=m.useState([]),[p,S]=m.useState(!1),P=String((e==null?void 0:e.email)||"").toLowerCase();m.useEffect(()=>{let _=!1;async function te(){try{if(!P)return;const oe=await(await fetch(`/api/friends/list?email=${encodeURIComponent(P)}`)).json().catch(()=>({friends:[]}));_||x(oe.friends||[])}catch{}}te();const L=setInterval(te,2e4);return()=>{_=!0,clearInterval(L)}},[P]),m.useEffect(()=>{try{const _=P?`ndn:stats:opponent:${P}`:"ndn:stats:opponent",te=localStorage.getItem(_);te&&v(te)}catch{}},[P]),m.useEffect(()=>{try{const _=P?`ndn:stats:opponent:${P}`:"ndn:stats:opponent";y?localStorage.setItem(_,y):localStorage.removeItem(_)}catch{}},[y,P]);async function N(_){if(h(_),!_.trim()){E([]);return}S(!0);try{const L=await(await fetch(`/api/friends/search?q=${encodeURIComponent(_)}`)).json().catch(()=>({results:[]}));E(L.results||[])}finally{S(!1)}}const q=m.useMemo(()=>{const _=new Map;if(l==="x01")for(const L of t)for(const Q of L.legs)for(const oe of Q.visits){const R=Math.max(0,Math.min(180,oe.score));_.set(R,(_.get(R)??0)+1)}const te=Array.from(_.entries()).sort((L,Q)=>L[0]-Q[0]);return te.length===0&&l==="x01"?([0,26,41,60,81,100,120,140,160,180].forEach(L=>_.set(L,0)),Array.from(_.entries()).sort((L,Q)=>L[0]-Q[0]).map(([L,Q])=>({label:L,value:Q}))):te.map(([L,Q])=>({label:L,value:Q}))},[t,l]),G=m.useMemo(()=>{const _=Im(ml);return ml.map(te=>{const L=_[te]||{played:0,won:0};return{label:te,value:L.played,extra:L.won}})},[l]);return m.useEffect(()=>{const _=()=>i(te=>te);return window.addEventListener("ndn:stats-updated",_),()=>window.removeEventListener("ndn:stats-updated",_)},[]),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Match Stats"}),n.jsx("span",{className:"text-xs opacity-70",children:"View"})]}),n.jsx(Lc,{tabs:[{key:"x01",label:"X01"},{key:"other",label:"Other Modes"}],active:l,onChange:_=>i(_)})]}),t.length===0&&n.jsxs("div",{className:"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-2",children:"No match data yet"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Start a quick X01 match to generate stats. Stats like Best/Worst 3-dart are finalized when you end the game."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-end",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-slate-300 mb-1",children:"Players (comma separated)"}),n.jsx("input",{className:"input w-full",value:o,onChange:_=>c(_.target.value)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-slate-300 mb-1",children:"Starting Score"}),n.jsx("input",{className:"input w-full",type:"number",value:u,onChange:_=>d(parseInt(_.target.value||"501"))})]}),n.jsx("div",{children:n.jsx("button",{className:"btn w-full",onClick:()=>{const _=o.split(",").map(te=>te.trim()).filter(Boolean);if(!_.length)return alert("Enter at least one player");a(_,u)},children:"Start Match"})})]})]}),s&&n.jsx("div",{className:"mb-3 p-2 rounded-lg text-sm border border-amber-500/40 bg-amber-500/10 text-amber-200",children:"Note: Detailed leg stats are finalized at the end of the game."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.map((_,te)=>n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:te===1&&!y?_.name||"Opponent":te===1&&y?y:_.name}),te===1&&n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[n.jsx("button",{className:"text-[11px] px-3 py-1 rounded-full bg-white/5 border border-white/10 hover:bg-white/10",onClick:()=>D(L=>!L),title:"Search user to compare",children:"Select Friend"}),g.slice(0,6).map(L=>{const Q=L.username||L.email,oe=y===Q;return n.jsx("button",{className:`text-[11px] px-3 py-1 rounded-full border ${oe?"bg-indigo-500/30 border-indigo-400/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>v(Q),title:`Compare vs ${Q}`,children:Q},L.email)}),g.length===0&&n.jsx("button",{className:"text-[11px] px-3 py-1 rounded-full bg-white/5 border border-white/10",disabled:!0,children:"Find friends to compare"})]})]}),te===1&&C&&n.jsxs("div",{className:"mb-2 p-2 rounded-lg bg-black/20 border border-white/10",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{className:"input flex-1 py-1",placeholder:"Search by name or email",value:b,onChange:L=>N(L.target.value)}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>N(b),disabled:p,children:"Search"})]}),n.jsxs("ul",{className:"max-h-40 overflow-auto space-y-1",children:[w.map(L=>{const Q=L.username||L.email;return n.jsx("li",{children:n.jsx("button",{className:"w-full text-left px-2 py-1 rounded bg-white/5 hover:bg-white/10 border border-white/10 text-sm",onClick:()=>{v(Q),D(!1)},children:Q})},L.email)}),!w.length&&n.jsx("li",{className:"text-xs opacity-70",children:b.trim()?"No results":"Type to search…"})]})]}),te===1&&y?n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 3-Dart"}),n.jsx("div",{className:"font-semibold",children:jt(Zn(y).best3||0)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Worst 3-Dart"}),n.jsx("div",{className:"font-semibold",children:jt(Zn(y).worst3||0)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 9-Dart (fewest darts)"}),n.jsx("div",{className:"font-semibold",children:(()=>{const L=Zn(y);return L.bestLegDarts?`${L.bestLegDarts} darts`:"—"})()})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best Checkout"}),n.jsx("div",{className:"font-semibold",children:Zn(y).bestCheckout||"—"})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Averages (All-time vs Monthly)"}),n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["3-dart: ",jt(Dr(y))," · ",jt(yd(y))]}),n.jsxs("span",{children:["First 9: ",jt(gd(y))," · ",jt(vd(y))]})]})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"All-time snapshot"}),(()=>{const L=Zn(y);return n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["Best 3-dart: ",jt(L.best3||0)]}),n.jsxs("span",{children:["Worst 3-dart: ",jt(L.worst3||0)]}),n.jsxs("span",{children:["Best leg: ",L.bestLegDarts||0," darts"]}),n.jsxs("span",{children:["Best checkout: ",L.bestCheckout||0]})]})})()]})]}):n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 3-Dart"}),n.jsx("div",{className:"font-semibold",children:jt(_.bestThreeDartAvg)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Worst 3-Dart"}),n.jsx("div",{className:"font-semibold",children:jt(_.worstThreeDartAvg)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 9-Dart (fewest darts)"}),n.jsx("div",{className:"font-semibold",children:_.bestNineDart?`${_.bestNineDart.darts} darts`:"—"})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best Checkout"}),n.jsx("div",{className:"font-semibold",children:_.bestCheckout??"—"})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Averages (All-time vs Monthly)"}),n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["3-dart: ",jt(Dr(_.name))," · ",jt(yd(_.name))]}),n.jsxs("span",{children:["First 9: ",jt(gd(_.name))," · ",jt(vd(_.name))]})]})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"All-time snapshot"}),(()=>{const L=Zn(_.name);return n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["Best 3-dart: ",jt(L.best3||0)]}),n.jsxs("span",{children:["Worst 3-dart: ",jt(L.worst3||0)]}),n.jsxs("span",{children:["Best leg: ",L.bestLegDarts||0," darts"]}),n.jsxs("span",{children:["Best checkout: ",L.bestCheckout||0]})]})})()]})]})]},_.id)),t.length<=1&&n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:"Opponent"}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[g.slice(0,6).map(_=>{const te=_.username||_.email,L=y===(_.username||_.email);return n.jsx("button",{className:`text-[11px] px-3 py-1 rounded-full border ${L?"bg-indigo-500/30 border-indigo-400/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>v(te),title:`Compare vs ${te}`,children:te},_.email)}),g.length===0&&n.jsx("span",{className:"text-xs opacity-70",children:"Add friends to compare stats."})]})]}),y?n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Comparing to"}),n.jsx("div",{className:"font-semibold",children:y})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 3-Dart"}),n.jsx("div",{className:"font-semibold",children:jt(Dr(y))})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Worst 3-Dart"}),n.jsx("div",{className:"font-semibold",children:jt(Zn(y).worst3||0)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 9-Dart (fewest darts)"}),n.jsx("div",{className:"font-semibold",children:(()=>{const _=Zn(y);return _.bestLegDarts?`${_.bestLegDarts} darts`:"—"})()})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best Checkout"}),n.jsx("div",{className:"font-semibold",children:Zn(y).bestCheckout||"—"})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Averages (All-time vs Monthly)"}),n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["3-dart: ",jt(Dr(y))," · ",jt(yd(y))]}),n.jsxs("span",{children:["First 9: ",jt(gd(y))," · ",jt(vd(y))]})]})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"All-time snapshot"}),(()=>{const _=Zn(y);return n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["Best 3-dart: ",jt(_.best3||0)]}),n.jsxs("span",{children:["Worst 3-dart: ",jt(_.worst3||0)]}),n.jsxs("span",{children:["Best leg: ",_.bestLegDarts||0," darts"]}),n.jsxs("span",{children:["Best checkout: ",_.bestCheckout||0]})]})})()]})]}):n.jsx("div",{className:"text-sm opacity-70",children:"Select a friend above to compare."})]})]}),n.jsxs("div",{className:"mt-6",children:[n.jsxs("div",{className:"mb-2 text-sm opacity-80",children:["Score Distribution (",l.toUpperCase(),"): Visits by scored points"]}),n.jsx("div",{className:"rounded-xl border border-indigo-500/40 bg-indigo-500/10 p-3",children:n.jsx(Lu,{data:q,showValues:!1})})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("div",{className:"mb-2 text-sm opacity-80",children:"Other Modes: games played (bar height) with wins shown beneath each label"}),n.jsxs("div",{className:"rounded-xl border border-indigo-500/40 bg-indigo-500/10 p-3",children:[n.jsx(Lu,{data:G.map(_=>({label:_.label,value:_.value})),showValues:!1}),n.jsx("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 text-[11px] opacity-80",children:G.map((_,te)=>n.jsxs("div",{className:"flex items-center justify-between px-2 py-1 rounded-md bg-white/5 border border-white/10",children:[n.jsx("span",{className:"truncate mr-2",children:_.label}),n.jsxs("span",{className:"whitespace-nowrap",children:["Played ",_.value," · Won ",_.extra]})]},te))})]})]})]})}function yj({user:e}){const t=xl(),s=(()=>{try{return Um()}catch{return null}})(),[r,a]=m.useState([]),[l,i]=m.useState(!1),[o,c]=m.useState(""),[u,d]=m.useState(null),[g,x]=m.useState(!1),[y,v]=m.useState({open:!1,t:null}),[C,D]=m.useState({open:!1,t:null}),[b,h]=m.useState({title:"Community X01 Tournament",game:"X01",mode:"bestof",value:3,description:"",startAt:new Date(Date.now()+2*60*60*1e3).toISOString().slice(0,16),checkinMinutes:15,capacity:8,startingScore:501}),w=(()=>{try{return"ontouchstart"in window||(navigator.maxTouchPoints||0)>0}catch{return!1}})();async function E(){try{const Z=await(await Gt("/api/tournaments")).json();a(Array.isArray(Z.tournaments)?Z.tournaments:[])}catch{}}m.useEffect(()=>{E()},[]),m.useEffect(()=>{if(!s)return;const R=s.addListener(Z=>{try{Z.type==="tournaments"&&a(Z.tournaments||[]),Z.type==="tournament-win"&&Z.message&&t(Z.message,{type:"success",timeout:1e4})}catch{}});return()=>{R()}},[s==null?void 0:s.connected]);const p=String((e==null?void 0:e.email)||"").toLowerCase();m.useEffect(()=>{let R=!1;async function Z(){if(!p){d(null);return}try{const Y=await(await Gt(`/api/subscription?email=${encodeURIComponent(p)}`)).json();R||((Y==null?void 0:Y.source)==="tournament"&&typeof Y.expiresAt=="number"&&Y.expiresAt>Date.now()?d(Y.expiresAt):d(null))}catch{R||d(null)}}return Z(),()=>{R=!0}},[p]);function S(R){var Z;return!!((Z=R.participants)!=null&&Z.some($=>$.email===p))}async function P(R){p&&D({open:!0,t:R})}async function N(){const R=C.t;if(!(!R||!p)){D({open:!1,t:null}),i(!0);try{let Z=await Gt("/api/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:R.id,requesterEmail:p})});if(!Z.ok&&Z.status===403&&String(p)==="daviesfamily108@gmail.com"&&(Z=await Gt("/api/admin/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:R.id,requesterEmail:p})})),!Z.ok){let $="Delete failed";try{const Y=await Z.json();Y!=null&&Y.error&&($=`Delete failed: ${String(Y.error)}`)}catch{}t($,{type:"error"});return}t("Tournament deleted",{type:"success"}),await E()}finally{i(!1)}}}async function q(R){if(p){i(!0);try{const Z=await Gt("/api/tournaments/join",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:R.id,email:p,username:e==null?void 0:e.username})});if(!Z.ok){let $={};try{$=await Z.json()}catch{}($==null?void 0:$.error)==="WINNER_COOLDOWN"&&typeof $.until=="number"?(c(`You're a recent NDN tournament winner. You can re-enter after ${oe($.until)}.`),setTimeout(()=>c(""),6e3),t("Join blocked: winner cooldown active",{type:"error"})):($==null?void 0:$.error)==="ALREADY_IN_TOURNAMENT"?(c(String($.message||"You can only join one tournament at a time.")),setTimeout(()=>c(""),6e3),t("Join blocked: already in another tournament",{type:"error"})):$!=null&&$.error&&(c(String($.error)),setTimeout(()=>c(""),3500),t(`Join failed: ${String($.error)}`,{type:"error"}));return}t("Joined tournament",{type:"success"}),await E()}finally{i(!1)}}}async function G(R){if(p){i(!0);try{const Z=await Gt("/api/tournaments/leave",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:R.id,email:p})});if(!Z.ok){let $={};try{$=await Z.json()}catch{}$!=null&&$.error?t(`Leave failed: ${String($.error)}`,{type:"error"}):Z.status===404?t("Leave failed (endpoint not found). Restart the server to enable /api/tournaments/leave.",{type:"error"}):t("Leave failed. Please try again.",{type:"error"});return}t("Left tournament",{type:"success"}),a($=>$.map(Y=>Y.id===R.id?{...Y,participants:(Y.participants||[]).filter(ue=>ue.email!==p)}:Y)),await E()}finally{i(!1)}}}async function _(){i(!0);try{const R=new Date(b.startAt).getTime();await Gt("/api/tournaments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b.title,game:b.game,mode:b.mode,value:Number(b.value),description:b.description,startAt:R,checkinMinutes:Number(b.checkinMinutes),capacity:Number(b.capacity),startingScore:b.game==="X01"?Number(b.startingScore||501):void 0,creatorEmail:e==null?void 0:e.email,creatorName:e==null?void 0:e.username})}),x(!1),t("Tournament created",{type:"success"}),await E()}finally{i(!1)}}m.useEffect(()=>{if(!g)return;const R=Z=>{Z.key==="Escape"&&x(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[g]);const te=m.useMemo(()=>r.filter(R=>R.official),[r]),L=m.useMemo(()=>r.filter(R=>!R.official),[r]),Q=m.useMemo(()=>te.filter(Z=>Z.status==="scheduled").sort((Z,$)=>Z.startAt-$.startAt)[0]||null,[te]);function oe(R){return new Date(R).toLocaleString()}return n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"flex items-center justify-between mb-3",children:n.jsx("h2",{className:"text-2xl font-bold",children:"Tournaments"})}),n.jsx("div",{className:"mb-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-end",children:n.jsx("button",{className:"btn",onClick:()=>x(!0),children:"Create Tournament +"})}),n.jsx("div",{className:"mb-2 text-sm font-semibold text-slate-300",children:"World Lobby"}),Q&&n.jsx("div",{className:"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm uppercase tracking-wide text-indigo-300 font-semibold",children:"Weekly Official Tournament"}),n.jsx("div",{className:"font-bold",children:Q.title}),n.jsxs("div",{className:"text-sm opacity-80",children:[Q.game,Q.game==="X01"&&Q.startingScore?`/${Q.startingScore}`:""," · ",Q.mode==="firstto"?"First to":"Best of"," ",Q.value," · Starts ",oe(Q.startAt)," · Cap ",Q.capacity," · Joined ",Q.participants.length]}),Q.prize&&n.jsxs("div",{className:"text-xs mt-1",children:["Prize: ",Q.prizeType==="cash"&&Q.prizeAmount?`${Q.currency||"USD"} ${Q.prizeAmount}`:"3 months PREMIUM"]}),Q.status!=="scheduled"&&n.jsxs("div",{className:"text-xs",children:["Status: ",Q.status]}),u&&u>Date.now()&&n.jsxs("div",{className:"text-xs text-rose-300",children:["Recent winners can re-enter after ",oe(u),"."]})]}),n.jsx("div",{className:"shrink-0",children:n.jsx("button",{className:`btn ${S(Q)?"bg-emerald-600 hover:bg-emerald-600":""}`,title:S(Q)?"Double-click to leave this tournament":Q.official&&u&&u>Date.now()?`Recent winners can re-enter after ${oe(u)}`:"",disabled:l||Q.status!=="scheduled"||!S(Q)&&(Q.participants.length>=Q.capacity||!!u&&u>Date.now()),onClick:()=>{S(Q)?w&&v({open:!0,t:Q}):q(Q)},onDoubleClick:()=>{!w&&S(Q)&&v({open:!0,t:Q})},"aria-label":S(Q)?"Already Joined":"Join Now",children:S(Q)?"Already Joined!":"Join Now"})})]})}),o&&n.jsx("div",{className:"mb-3 p-2 rounded-lg bg-amber-700/30 border border-amber-600/40 text-amber-200 text-sm",children:o}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("section",{children:[n.jsx("div",{className:"font-semibold mb-1",children:"Official"}),n.jsx("div",{className:"text-xs opacity-70 mb-2",children:u&&u>Date.now()?n.jsxs(n.Fragment,{children:["You’re a recent NDN tournament winner — to keep it fair, you can re-enter after ",oe(u),"."]}):n.jsx(n.Fragment,{children:"Note: Weekly winners can re-enter once their 3 months of PREMIUM ends."})}),n.jsxs("ul",{className:"space-y-2",children:[te.map(R=>n.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsxs("div",{className:"font-semibold",children:[R.title," ",R.prize&&n.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 align-middle",children:[n.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-500 text-black",children:"Prize"}),n.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-full bg-slate-600 text-white text-[10px] leading-none cursor-help",title:R.prizeType==="cash"?"Official cash prize tournament — payout handled by admin.":"Weekly winners get 3 months of PREMIUM and can re-enter once their prize period ends.","aria-label":"Prize info",children:"i"})]})]}),n.jsxs("div",{className:"text-sm opacity-80",children:[R.game,R.game==="X01"&&R.startingScore?`/${R.startingScore}`:""," · ",R.mode==="firstto"?"First to":"Best of"," ",R.value," · ",oe(R.startAt)," · Cap ",R.capacity," · Joined ",R.participants.length]}),R.prize&&n.jsxs("div",{className:"text-xs",children:["Prize: ",R.prizeType==="cash"&&R.prizeAmount?`${R.currency||"USD"} ${R.prizeAmount}`:"3 months PREMIUM",R.status==="completed"&&R.prizeType==="cash"&&R.payoutStatus&&n.jsx("span",{className:`ml-2 px-2 py-0.5 rounded ${R.payoutStatus==="paid"?"bg-emerald-600":"bg-amber-600"}`,children:R.payoutStatus==="paid"?"Paid":"Pending"})]}),R.status!=="scheduled"&&n.jsxs("div",{className:"text-xs",children:["Status: ",R.status]}),S(R)&&n.jsx("div",{className:"text-xs text-emerald-400 font-semibold",children:"Already Joined"}),R.official&&u&&u>Date.now()&&n.jsxs("div",{className:"text-xs text-rose-300",children:["Cooldown active until ",oe(u),"."]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:`btn ${S(R)?"bg-emerald-600 hover:bg-emerald-600":""}`,title:S(R)?"Double-click to leave this tournament":R.official&&u&&u>Date.now()?`Recent winners can re-enter after ${oe(u)}`:"",disabled:l||R.status!=="scheduled"||!S(R)&&(R.participants.length>=R.capacity||R.official&&!!u&&u>Date.now()),onClick:()=>{S(R)?w&&v({open:!0,t:R}):q(R)},onDoubleClick:()=>{!w&&S(R)&&v({open:!0,t:R})},"aria-label":S(R)?"Already Joined":"Join Now",children:S(R)?"Already Joined!":"Join Now"}),R.status==="scheduled"&&p&&R.creatorEmail&&String(R.creatorEmail).toLowerCase()===p&&n.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Delete this tournament",onClick:()=>P(R),"aria-label":"Delete tournament",children:"×"})]})]},R.id)),te.length===0&&n.jsx("li",{className:"text-sm opacity-60",children:"No official tournaments yet."})]})]}),n.jsxs("section",{children:[n.jsx("div",{className:"font-semibold mb-1",children:"Community"}),n.jsxs("ul",{className:"space-y-2",children:[L.map(R=>n.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx("div",{className:"font-semibold",children:R.title}),n.jsxs("div",{className:"text-sm opacity-80",children:[R.game,R.game==="X01"&&R.startingScore?`/${R.startingScore}`:""," · ",R.mode==="firstto"?"First to":"Best of"," ",R.value," · ",oe(R.startAt)," · Cap ",R.capacity," · Joined ",R.participants.length]}),R.description&&n.jsx("div",{className:"text-xs opacity-80",children:R.description}),S(R)&&n.jsx("div",{className:"text-xs text-emerald-400 font-semibold",children:"Already Joined"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn",title:S(R)?"Double-click to leave this tournament":"",disabled:l||R.status!=="scheduled"||!S(R)&&R.participants.length>=R.capacity,onClick:()=>{S(R)?w&&v({open:!0,t:R}):q(R)},onDoubleClick:()=>{!w&&S(R)&&v({open:!0,t:R})},children:S(R)?"Already Joined":"Join Now"}),R.status==="scheduled"&&p&&R.creatorEmail&&String(R.creatorEmail).toLowerCase()===p&&n.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Delete this tournament",onClick:()=>P(R),"aria-label":"Delete tournament",children:"×"})]})]},R.id)),L.length===0&&n.jsx("li",{className:"text-sm opacity-60",children:"No community tournaments yet."})]})]})]}),g&&n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"card relative",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h3",{className:"text-xl font-semibold",children:"Create Tournament"}),n.jsx("button",{className:"btn",onClick:()=>x(!1),children:"Close"})]}),n.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-2 md:gap-4 pr-1",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Title"}),n.jsx("input",{className:"input w-full",value:b.title,onChange:R=>h(Z=>({...Z,title:R.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Game"}),n.jsx("select",{className:"input w-full",value:b.game,onChange:R=>h(Z=>({...Z,game:R.target.value})),children:["X01","Around the Clock","Cricket","Halve It","Shanghai","High-Low","Killer"].map(R=>n.jsx("option",{value:R,children:R},R))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Mode"}),n.jsxs("select",{className:"input w-full",value:b.mode,onChange:R=>h(Z=>({...Z,mode:R.target.value})),children:[n.jsx("option",{value:"bestof",children:"Best of"}),n.jsx("option",{value:"firstto",children:"First to"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Number"}),n.jsx("input",{className:"input w-full",type:"number",min:1,value:b.value,onChange:R=>h(Z=>({...Z,value:Number(R.target.value)}))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Description"}),n.jsx("textarea",{className:"input w-full",rows:5,value:b.description,onChange:R=>h(Z=>({...Z,description:R.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Start time"}),n.jsx("input",{className:"input w-full",type:"datetime-local",value:b.startAt,onChange:R=>h(Z=>({...Z,startAt:R.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Check-in reminder (min)"}),n.jsx("input",{className:"input w-full",type:"number",min:0,value:b.checkinMinutes,onChange:R=>h(Z=>({...Z,checkinMinutes:Number(R.target.value)}))})]})]}),b.game==="X01"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"X01 Starting Score"}),n.jsx("select",{className:"input w-full",value:String(b.startingScore),onChange:R=>h(Z=>({...Z,startingScore:Number(R.target.value)})),children:[301,501,701].map(R=>n.jsx("option",{value:R,children:R},R))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Capacity"}),n.jsx("input",{className:"input w-full",type:"number",min:6,max:64,value:b.capacity,onChange:R=>h(Z=>({...Z,capacity:Number(R.target.value)}))})]}),n.jsx("div",{className:"text-xs opacity-70",children:"Note: community tournaments do not award prizes."}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{className:"btn",disabled:l,onClick:_,children:"Create"})})]})]})}),y.open&&y.t&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>v({open:!1,t:null})}),n.jsxs("div",{className:"relative card p-4 w-[360px] max-w-[90vw]",children:[n.jsx("div",{className:"text-lg font-semibold mb-2",children:"Leave tournament?"}),n.jsxs("div",{className:"text-sm opacity-80 mb-4",children:["Are you sure you want to remove yourself from “",y.t.title,"”?"]}),n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>v({open:!1,t:null}),children:"Decline"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{const R=y.t;v({open:!1,t:null}),await G(R)},children:"Accept"})]})]})]}),C.open&&C.t&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-semibold mb-4 text-white",children:"Delete Tournament"}),n.jsxs("div",{className:"text-slate-300 mb-6",children:["Are you sure you want to delete ",n.jsxs("span",{className:"font-semibold text-white",children:['"',C.t.title,'"']}),"?",n.jsx("br",{}),n.jsx("span",{className:"text-sm text-slate-400",children:"This action cannot be undone."})]}),n.jsxs("div",{className:"flex gap-3 justify-center",children:[n.jsx("button",{className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",onClick:()=>D({open:!1,t:null}),children:"Decline"}),n.jsx("button",{className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",onClick:N,children:"Continue"})]})]})})})]})}function vj({user:e}){const[t,s]=m.useState(null),[r,a]=m.useState(!0),[l,i]=m.useState(null),o="http://localhost:8787",c=xl();if(m.useEffect(()=>{(async()=>{try{const g=e!=null&&e.email?`?email=${encodeURIComponent(e.email)}`:"",x=await fetch(`${o}/api/subscription`+g);if(!x.ok)throw new Error("Failed to fetch subscription");const y=await x.json();s(y)}catch(g){i(g instanceof Error?g.message:"Something went wrong")}finally{a(!1)}})()},[e==null?void 0:e.email]),r)return n.jsx("div",{className:"card",children:n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500 mx-auto mb-4"}),n.jsx("p",{children:"Loading subscription..."})]})});if(l)return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-red-300 mb-2",children:"Subscription Error"}),n.jsx("p",{className:"mb-4 text-red-200",children:l}),n.jsx("button",{onClick:()=>window.location.reload(),className:"btn bg-red-600 hover:bg-red-700",children:"Retry"})]});const u=t==null?void 0:t.fullAccess;return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-indigo-300 mb-2",children:u?"PREMIUM Active":"PREMIUM"}),u?n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"bg-green-500/20 border border-green-500/40 rounded-lg p-4 mb-4",children:[n.jsx("div",{className:"flex items-center gap-2 text-green-300 font-semibold mb-2",children:"✅ PREMIUM Access Active"}),n.jsx("p",{className:"text-green-200 text-sm",children:"You have full access to all premium features!"}),(t==null?void 0:t.source)&&n.jsxs("p",{className:"text-green-200 text-xs mt-1",children:["Source: ",t.source,(t==null?void 0:t.expiresAt)&&` (expires: ${new Date(t.expiresAt).toLocaleDateString()})`]})]}),n.jsx("h3",{className:"text-lg font-semibold mb-2 text-indigo-200",children:"Your Benefits:"})]}):n.jsx("p",{className:"mb-2 text-indigo-200",children:"Unlock every game mode known to darts, advanced stats, and premium features."}),n.jsxs("ul",{className:"mb-4",children:[n.jsx("li",{children:"All game modes (including paid/advanced)"}),n.jsx("li",{children:"Online play with all rules and variations"}),n.jsx("li",{children:"Advanced analytics and leaderboards"}),n.jsx("li",{children:"Premium camera modes and autoscoring"})]}),!u&&n.jsx("button",{onClick:async()=>{try{const g=await(await fetch(`${o}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})})).json();g.ok&&g.url?window.location.href=g.url:g.error==="STRIPE_NOT_CONFIGURED"?c("Premium purchases are not available. Payment link not configured.",{type:"error",timeout:4e3}):c("Failed to get payment link. Please try again.",{type:"error",timeout:4e3})}catch{c("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold shadow-lg hover:scale-105 transition",children:"Subscribe to PREMIUM"})]})}function bj({open:e,onClose:t,width:s=700,title:r,footer:a,children:l,side:i="right"}){return m.useEffect(()=>{function o(c){c.key==="Escape"&&t()}return e&&document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[e,t]),n.jsxs("div",{className:`fixed inset-0 z-50 ${e?"":"pointer-events-none"}`,"aria-hidden":!e,children:[n.jsx("div",{className:`absolute inset-0 bg-black/60 transition-opacity ${e?"opacity-100":"opacity-0"}`,onClick:t}),n.jsxs("div",{className:`absolute top-0 ${i==="right"?"right-0 border-l":"left-0 border-r"} h-full bg-slate-900 border-slate-700 shadow-2xl w-full sm:w-auto flex flex-col transition-transform duration-200 ${e?"translate-x-0":i==="right"?"translate-x-full":"-translate-x-full"}`,style:{width:typeof s=="number"?`${s}px`:s},role:"dialog","aria-modal":"true",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-700 sticky top-0 bg-slate-900 z-10",children:[n.jsx("div",{className:"text-lg font-semibold",children:r}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:t,children:"Close"})]}),n.jsx("div",{className:"flex-1 overflow-auto p-4",children:l}),a&&n.jsx("div",{className:"px-4 py-3 border-t border-slate-700 sticky bottom-0 bg-slate-900 z-10",children:a})]})]})}function wj({user:e}){const t=dx(e==null?void 0:e.email),[s,r]=m.useState(null),[a,l]=m.useState(""),[i,o]=m.useState("");async function c(){try{const g=await Gt("/readyz");r(await g.json())}catch{}}if(m.useEffect(()=>{c();const g=setInterval(c,5e3);return()=>clearInterval(g)},[]),!t)return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Ops"}),n.jsx("div",{children:"Restricted"})]});async function u(g){o("");try{const x=await Gt("/api/admin/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:g,requesterEmail:e==null?void 0:e.email})}),y=await x.json();!x.ok||!(y!=null&&y.ok)?o((y==null?void 0:y.error)||"Failed"):o(`Maintenance ${g?"enabled":"disabled"}`)}catch{o("Network error")}}async function d(){o("");const g=a.trim();if(g)try{const x=await Gt("/api/admin/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:g,requesterEmail:e==null?void 0:e.email})}),y=await x.json();!x.ok||!(y!=null&&y.ok)?o((y==null?void 0:y.error)||"Failed"):o("Announcement broadcasted"),l("")}catch{o("Network error")}}return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Ops"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Readiness"}),n.jsxs("div",{className:"text-sm",children:["HTTP: ",n.jsx("span",{className:`font-semibold ${s!=null&&s.ok?"text-emerald-300":"text-rose-300"}`,children:String(!!(s!=null&&s.ok))})]}),n.jsxs("div",{className:"text-sm",children:["WS: ",n.jsx("span",{className:`font-semibold ${s!=null&&s.ws?"text-emerald-300":"text-rose-300"}`,children:String(!!(s!=null&&s.ws))})]}),n.jsxs("div",{className:"text-sm",children:["Clients: ",n.jsx("span",{className:"font-semibold",children:(s==null?void 0:s.clients)??0})]}),n.jsxs("div",{className:"text-sm",children:["Rooms: ",n.jsx("span",{className:"font-semibold",children:(s==null?void 0:s.rooms)??0})]}),n.jsxs("div",{className:"text-sm",children:["Heap Used: ",n.jsxs("span",{className:"font-semibold",children:[s!=null&&s.mem?Math.round(s.mem.heapUsed/1024/1024):0," MB"]})]})]}),n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Maintenance"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn",onClick:()=>u(!0),children:"Enable"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>u(!1),children:"Disable"})]})]}),n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Announcement"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{className:"input flex-1",placeholder:"Message to broadcast",value:a,onChange:g=>l(g.target.value)}),n.jsx("button",{className:"btn",onClick:d,children:"Send"})]})]})]}),i&&n.jsx("div",{className:"text-xs mt-2",children:i}),n.jsx("div",{className:"text-xs opacity-70 mt-2",children:"✅ Clustering enabled! For 1.5k+ concurrent users, deploy behind a reverse proxy (NGINX/Cloudflare) with sticky sessions for WebSockets. Set NODE_WORKERS environment variable to control worker count."})]})}function jj({}){const[e,t]=m.useState(!1),[s,r]=m.useState([{text:"Hi! I'm your Nine Dart Nation assistant. How can I help you today?",isUser:!1}]),[a,l]=m.useState(""),i=u=>{try{window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:u}})),t(!1)}catch(d){console.error("Navigation failed:",d)}},o=u=>{const d=u.toLowerCase();return d.includes("username")||d.includes("change name")?{text:"You can change your username once for free.",links:[{text:"Go to Settings > Account",tab:"settings"}]}:d.includes("premium")||d.includes("upgrade")||d.includes("subscription")?{text:"Premium unlocks all game modes and features.",links:[{text:"Go to Online Play",tab:"online"}]}:d.includes("calibrat")||d.includes("camera")||d.includes("vision")?{text:"Set up your camera properly in Settings.",links:[{text:"Go to Settings > Camera & Vision",tab:"settings"}]}:d.includes("voice")||d.includes("caller")||d.includes("audio")?{text:"Enable voice calling in Settings.",links:[{text:"Go to Settings > Audio & Voice",tab:"settings"}]}:d.includes("friend")||d.includes("play together")?{text:"Add friends to play together.",links:[{text:"Go to Friends",tab:"friends"}]}:d.includes("stat")||d.includes("score")||d.includes("performance")?{text:"View your statistics and performance.",links:[{text:"Go to Stats",tab:"stats"}]}:d.includes("setting")||d.includes("customiz")||d.includes("configur")?{text:"Customize your experience.",links:[{text:"Go to Settings",tab:"settings"}]}:d.includes("tournament")||d.includes("competition")?{text:"Check out tournaments and competitions.",links:[{text:"Go to Tournaments",tab:"tournaments"}]}:d.includes("help")||d.includes("support")||d.includes("faq")?{text:"You're already in the help section! Check Settings for more resources.",links:[{text:"Go to Settings > Support",tab:"settings"}]}:d.includes("how to play")||d.includes("game")||d.includes("start")?{text:"To play darts, select a game mode from the menu. For online play, join a match. For offline, start a local game.",links:[{text:"Play Online",tab:"online"},{text:"Play Offline",tab:"offline"}]}:{text:"I'm not sure about that. Try asking about playing, calibration, premium, username changes, voice settings, friends, stats, or settings."}},c=()=>{if(!a.trim())return;const u=a.toLowerCase();r(g=>[...g,{text:a,isUser:!0}]),l("");const d=o(u);setTimeout(()=>{r(g=>[...g,{text:d,isUser:!1}])},500)};return n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>t(!0),className:"fixed bottom-4 right-4 z-50 bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-full shadow-lg transition-colors",title:"Help Assistant",children:n.jsx(nx,{className:"w-6 h-6"})}),e&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-end p-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>t(!1)}),n.jsxs("div",{className:"relative bg-slate-800 rounded-lg shadow-xl w-full max-w-md h-96 flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(sc,{className:"w-5 h-5 text-blue-400"}),n.jsx("span",{className:"font-semibold",children:"Help Assistant"})]}),n.jsx("button",{onClick:()=>t(!1),className:"text-slate-400 hover:text-white",children:n.jsx(hb,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:s.map((u,d)=>n.jsx("div",{className:`flex ${u.isUser?"justify-end":"justify-start"}`,children:n.jsx("div",{className:`max-w-xs px-3 py-2 rounded-lg ${u.isUser?"bg-blue-600 text-white":"bg-slate-700 text-slate-200"}`,children:typeof u.text=="string"?u.text:n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{children:u.text.text}),u.text.links&&n.jsx("div",{className:"space-y-1",children:u.text.links.map((g,x)=>n.jsx("button",{onClick:()=>i(g.tab),className:"block w-full text-left text-blue-300 hover:text-blue-200 underline text-sm",children:g.text},x))})]})})},d))}),n.jsx("div",{className:"p-4 border-t border-slate-700",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:a,onChange:u=>l(u.target.value),onKeyPress:u=>u.key==="Enter"&&c(),placeholder:"Ask me anything...",className:"flex-1 input"}),n.jsx("button",{onClick:c,className:"btn bg-blue-600 hover:bg-blue-700",children:n.jsx(rx,{className:"w-4 h-4"})})]})})]})]})]})}function Nj(){const e=m.useRef(null),[t,s]=m.useState(""),[r,a]=m.useState(!1),[l,i]=m.useState(null),o=(()=>{try{return Um()}catch{return null}})(),[c,u]=m.useState("score"),[d,g]=m.useState(!1),[x,y]=m.useState(!1),[v,C]=m.useState(null),[D,b]=m.useState(0),{avgMode:h}=ss();m.useEffect(()=>{const p=localStorage.getItem("authToken");p&&fetch("http://localhost:8787/api/auth/me",{headers:{Authorization:`Bearer ${p}`}}).then(P=>P.json()).then(P=>{P!=null&&P.user?(C(P.user),w(P.user)):localStorage.removeItem("authToken")}).catch(()=>{})},[]),m.useEffect(()=>{const p=()=>{try{localStorage.removeItem("mockUser"),localStorage.removeItem("authToken")}catch{}C(null),u("score")};return window.addEventListener("ndn:logout",p),()=>window.removeEventListener("ndn:logout",p)},[]),m.useEffect(()=>{if(!(v!=null&&v.username))return;const p=()=>b(h==="24h"?s1(v.username):Dr(v.username));p();const S=()=>p();return window.addEventListener("ndn:stats-updated",S),()=>window.removeEventListener("ndn:stats-updated",S)},[v==null?void 0:v.username,h]),m.useEffect(()=>{if(!(v!=null&&v.username)){s("");return}const p=localStorage.getItem(`ndn:bio:profilePhoto:${v.username}`);s(p||"")},[v==null?void 0:v.username]),m.useEffect(()=>{const p=q=>{var G;(G=q.key)!=null&&G.startsWith("ndn:bio:profilePhoto:")&&(v!=null&&v.username)&&q.key.endsWith(v.username)&&s(q.newValue||"")},S=q=>{var G,_;if(((G=q.detail)==null?void 0:G.username)===(v==null?void 0:v.username)&&s(((_=q.detail)==null?void 0:_.avatar)||""),v!=null&&v.username){const te=localStorage.getItem(`ndn:bio:profilePhoto:${v.username}`);s(te||"")}},P=()=>{if(!document.hidden&&(v!=null&&v.username)){const q=localStorage.getItem(`ndn:bio:profilePhoto:${v.username}`);s(q||"")}},N=setInterval(()=>{if(v!=null&&v.username){const q=localStorage.getItem(`ndn:bio:profilePhoto:${v.username}`);q&&q!==t&&s(q)}},2e3);return window.addEventListener("storage",p),window.addEventListener("ndn:avatar-updated",S),document.addEventListener("visibilitychange",P),()=>{window.removeEventListener("storage",p),window.removeEventListener("ndn:avatar-updated",S),document.removeEventListener("visibilitychange",P),clearInterval(N)}},[v==null?void 0:v.username,t]),m.useEffect(()=>{const p=new URLSearchParams(window.location.search),S=p.get("paid"),P=p.get("username-change");if(S==="1"||S==="username-change"||P==="free"){const N=localStorage.getItem("pendingUsernameChange");N&&(v!=null&&v.email)&&fetch("http://localhost:8787/api/change-username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:v.email,newUsername:N})}).then(G=>G.json()).then(G=>{G.ok?(alert("Username changed successfully!"),localStorage.removeItem("pendingUsernameChange"),G.token&&localStorage.setItem("authToken",G.token),G.user&&C(G.user),window.history.replaceState({},document.title,window.location.pathname)):alert("Failed to change username: "+(G.error||"Unknown error"))}).catch(()=>{alert("Network error while changing username")})}},[v==null?void 0:v.email]),m.useEffect(()=>{new URLSearchParams(window.location.search).get("subscription")==="success"&&(v!=null&&v.email)&&fetch("http://localhost:8787/api/auth/me",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}}).then(N=>N.json()).then(N=>{N!=null&&N.user&&(C(N.user),alert("Premium subscription activated successfully!"),window.history.replaceState({},document.title,window.location.pathname))}).catch(()=>{alert("Subscription activated, but failed to refresh user data. Please refresh the page.")})},[v==null?void 0:v.email]),m.useEffect(()=>{const p=()=>{const N=window.innerWidth,q=window.matchMedia("(max-width: 768px)").matches,G=window.matchMedia("(max-width: 1024px) and (min-width: 769px)").matches,_=/Mobi|Android|iPhone|iPad|iPod|Mobile|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent||""),te=/iPad|Android(?=.*\bMobile\b)|Tablet|PlayBook|Silk/i.test(navigator.userAgent||""),L="ontouchstart"in window||navigator.maxTouchPoints>0,Q=N<769,oe=G&&L||te||N>=769&&N<=1024&&L,Z=q||_||Q||N<769&&L||oe;g(Z)};p(),window.addEventListener("resize",p),window.addEventListener("orientationchange",p);const S=window.matchMedia("(max-width: 768px)"),P=window.matchMedia("(max-width: 1024px) and (min-width: 769px)");try{S.addEventListener("change",p),P.addEventListener("change",p)}catch{}return()=>{window.removeEventListener("resize",p),window.removeEventListener("orientationchange",p);try{S.removeEventListener("change",p),P.removeEventListener("change",p)}catch{}}},[]),m.useEffect(()=>{const p=()=>{try{localStorage.removeItem("ndn:avatar")}catch{}C(null),u("score")};return window.addEventListener("ndn:logout",p),()=>window.removeEventListener("ndn:logout",p)},[]),m.useEffect(()=>{const p=S=>{var P;try{const N=String(((P=S==null?void 0:S.detail)==null?void 0:P.username)||"").trim();if(!N)return;C(q=>q&&{...q,username:N});try{const q=((v==null?void 0:v.email)||"").toLowerCase();o&&N&&q&&o.send({type:"presence",username:N,email:q})}catch{}}catch{}};return window.addEventListener("ndn:username-changed",p),()=>window.removeEventListener("ndn:username-changed",p)},[o,v==null?void 0:v.email]),m.useEffect(()=>{const p=S=>{var P;try{const N=String(((P=S==null?void 0:S.detail)==null?void 0:P.tab)||"").trim();N&&["score","offline","online","stats","settings","admin","tournaments","friends"].includes(N)&&u(N)}catch{}};return window.addEventListener("ndn:change-tab",p),()=>window.removeEventListener("ndn:change-tab",p)},[]);async function w(p){try{const S=p!=null&&p.email?`?email=${encodeURIComponent(p.email)}`:"",P=await fetch("/api/subscription"+S);if(!P.ok)return;const N=await P.json();C({...p,fullAccess:!!(N!=null&&N.fullAccess)})}catch{}}if(!v)return n.jsx(oj,{onAuth:p=>{C(p),w(p)}});const E=`https://ui-avatars.com/api/?name=${encodeURIComponent(v.username||"NDN")}&background=8F43EE&color=fff&bold=true&rounded=true&size=64`;return n.jsxs(dj,{children:[n.jsxs("div",{ref:e,className:`${v!=null&&v.fullAccess?"premium-body":""} h-screen overflow-hidden p-1 xs:p-2 sm:p-3 md:p-4`,children:[n.jsx(sj,{}),n.jsxs("div",{className:"max-w-[1400px] mx-auto grid grid-cols-1 lg:grid-cols-[auto,1fr] gap-2 xs:gap-3 sm:gap-4 h-full overflow-hidden",children:[!d&&n.jsx("div",{className:"relative hidden lg:block",style:{width:240},children:n.jsx(fx,{active:c,onChange:p=>{u(p)},user:v})}),n.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[n.jsx("div",{className:"pt-1 xs:pt-2",children:n.jsxs("header",{id:"ndn-header",className:"header glass flex-col xs:flex-col sm:flex-row gap-2 xs:gap-2 sm:gap-3",children:[n.jsx("div",{className:"flex items-center gap-2 order-1",children:n.jsx("h1",{className:"text-lg xs:text-xl sm:text-xl md:text-2xl font-bold text-brand-700 whitespace-nowrap cursor-pointer select-none",onClick:()=>{d&&u("score")},title:d?"Go Home":void 0,children:"NINE-DART-NATION 🎯"})}),n.jsxs("div",{className:"order-3 xs:order-3 sm:order-2 w-full sm:w-auto flex-1 flex flex-col items-center justify-center text-center sm:text-left !text-black",children:[n.jsxs("span",{className:"text-sm xs:text-base sm:text-base md:text-lg font-semibold flex items-center gap-2 max-w-full truncate !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:[n.jsx("span",{className:"hidden xs:inline !text-black",children:"Welcome"}),n.jsx("img",{src:t||E,alt:"avatar",className:"w-5 h-5 xs:w-6 xs:h-6 sm:w-6 sm:h-6 md:w-7 md:h-7 rounded-full ring-2 ring-white/20"}),n.jsxs("span",{className:"truncate !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:[v.username,"🎯"]})]}),n.jsxs("span",{className:"hidden xs:inline text-xs xs:text-xs sm:text-xs md:text-sm !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:["All-time 3-dart avg: ",n.jsx("span",{className:"font-semibold !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:D.toFixed(2)})]}),d&&n.jsx("button",{className:"btn px-3 py-1 xs:px-3 xs:py-1 sm:px-3 sm:py-1 mt-1 text-sm xs:text-sm","aria-label":"Open navigation",onClick:()=>y(!0),children:"☰ Menu"})]}),n.jsxs("div",{className:"order-2 md:order-3 ml-0 md:ml-auto flex items-center gap-2 flex-wrap",children:[n.jsx("button",{className:"px-3 py-1 text-sm rounded-full bg-white/5 hover:bg-white/10 border border-white/10",onClick:()=>{const p=e.current;p&&(document.fullscreenElement?document.exitFullscreen().catch(()=>{}):p.requestFullscreen().catch(()=>{}))},title:r?"Exit Full Screen":"Enter Full Screen",children:r?"Exit Full Screen":"Full Screen"}),c==="online"&&n.jsx("button",{className:"text-[10px] md:text-xs px-3 py-1 rounded-full bg-indigo-500/25 text-indigo-100 border border-indigo-400/40 hover:bg-indigo-500/40",title:"Open a simulated online match",onClick:()=>{setTimeout(()=>{try{window.dispatchEvent(new CustomEvent("ndn:online-match-demo",{detail:{game:"X01",start:501}}))}catch{}},40)},children:"ONLINE DEMO"}),o?n.jsx("span",{className:"ml-0 md:ml-2",children:n.jsx(mj,{status:o.status})}):null,l!=null&&l.https?n.jsx("span",{className:"text-[10px] md:text-xs px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/40",title:`Phone HTTPS active on :${l.port}`,children:"HTTPS READY"}):n.jsx("span",{className:"text-[10px] md:text-xs px-3 py-1 rounded-full bg-slate-600/30 text-slate-300 border border-slate-400/30",title:"Enable HTTPS for iPhone camera pairing",children:"HTTP ONLY"})]})]})}),d&&n.jsx(kj,{open:x,onClose:()=>y(!1),active:c,onChange:p=>{u(p),y(!1)},user:v}),n.jsxs("main",{id:"ndn-main-scroll",className:"space-y-4 flex-1 overflow-y-auto pr-1",children:[c==="settings"&&n.jsx(Hs,{children:n.jsx(ij,{user:v})}),c==="score"&&n.jsx(Hs,{children:n.jsx(l1,{user:v})}),c==="online"&&n.jsx(Hs,{children:n.jsx(pj,{user:v})}),c==="offline"&&n.jsx(Hs,{children:n.jsx(Xw,{user:v})}),c==="calibrate"&&n.jsx(Hs,{children:n.jsx(Mw,{})}),c==="friends"&&n.jsx(Hs,{children:n.jsx(nj,{user:v})}),c==="stats"&&n.jsx(Hs,{children:n.jsx(gj,{user:v})}),c==="tournaments"&&n.jsx(Hs,{children:n.jsx(yj,{user:v})}),c==="admin"&&n.jsx(Hs,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx(lj,{user:v}),n.jsx(wj,{user:v})]})}),c==="fullaccess"&&n.jsx(Hs,{children:n.jsx(vj,{user:v})})]})]})]})]}),n.jsx(jj,{})]})}function kj({open:e,onClose:t,active:s,onChange:r,user:a}){return n.jsx(bj,{open:e,onClose:t,width:320,side:"left",title:"Navigate",children:n.jsx("div",{className:"mt-2",children:n.jsx(fx,{active:s,onChange:r,user:a,className:"flex relative static max-h-[80vh] w-full"})})})}function Sj(e){return e.length>=10&&/\d/.test(e)&&/[^A-Za-z0-9]/.test(e)}function Cj(){const[e,t]=m.useState(""),[s,r]=m.useState(""),[a,l]=m.useState(""),[i,o]=m.useState(""),[c,u]=m.useState("");m.useEffect(()=>{try{const x=new URLSearchParams(window.location.search).get("token")||"";t(x)}catch{}},[]);async function d(g){if(g.preventDefault(),o(""),u(""),!e){o("Missing or invalid reset token.");return}if(!s||s!==a){o("Passwords do not match.");return}if(!Sj(s)){o("Password must be at least 10 chars and include a number and symbol.");return}try{const y=await(await fetch("/api/auth/confirm-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,newPassword:s})})).json();if(!(y!=null&&y.ok))throw new Error((y==null?void 0:y.error)||"Reset failed");u("Password changed. You can now sign in.")}catch(x){o((x==null?void 0:x.message)||"Reset failed")}}return n.jsxs("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[n.jsx("div",{className:"background-animated"}),n.jsx("div",{className:"relative z-10 w-full max-w-lg mx-auto p-4",children:n.jsxs("form",{className:"card w-full space-y-4",onSubmit:d,children:[n.jsx("div",{className:"flex flex-col items-center justify-center gap-2 mb-2 text-center",children:n.jsx("h1",{className:"logo text-center",children:"Reset your password"})}),!e&&n.jsx("div",{className:"text-red-400",children:"This reset link is missing a token. Please use the link from your email."}),n.jsx("input",{className:"input w-full",type:"password",placeholder:"New password",value:s,onChange:g=>r(g.target.value),required:!0}),n.jsx("input",{className:"input w-full",type:"password",placeholder:"Confirm password",value:a,onChange:g=>l(g.target.value),required:!0}),i&&n.jsx("div",{className:"text-red-400 font-semibold text-sm",children:i}),c&&n.jsx("div",{className:"text-emerald-400 font-semibold text-sm",children:c}),n.jsx("button",{className:"btn w-full",type:"submit",disabled:!e,children:"Change Password"}),n.jsx("a",{className:"underline text-sm text-center",href:"/",children:"Back to sign in"})]})})]})}class Ej extends m.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,message:String((t==null?void 0:t.message)||t)}}componentDidCatch(t,s){console.error("[ErrorBoundary]",t,s)}render(){return this.state.hasError?n.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:n.jsxs("div",{className:"card max-w-lg w-full text-center",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Something went wrong"}),n.jsx("p",{className:"opacity-80 mb-4",children:"Please refresh the page. If this persists, let us know."}),this.state.message&&n.jsx("pre",{className:"text-xs bg-black/40 rounded p-2 overflow-auto text-left",children:this.state.message}),n.jsx("button",{className:"btn mt-4",onClick:()=>window.location.reload(),children:"Reload"})]})}):this.props.children}}try{window.React=window.React||{}}catch{}Nb();Ed.createRoot(document.getElementById("root")).render(n.jsx(m.StrictMode,{children:n.jsx(Ej,{children:n.jsx(uj,{children:n.jsx(Tj,{})})})}));function Tj(){return window.location.pathname==="/reset"?n.jsx(Cj,{}):n.jsx(Nj,{})}
//# sourceMappingURL=index-DNeMgKYF.js.map
