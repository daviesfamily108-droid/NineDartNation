import{j as e,k as Ge,u as q,l as te,$ as Ke,n as ve,s as Ae,M as Ye,a0 as Qe,G as Ue,D as Xe,P as qe,m as Te,o as Je,L as Ze,R as et,B as tt}from"./index-zYyjKDd0.js";import{r as n}from"./ui-HJtpxRqe.js";import{A as se,a as st,P as at}from"./aroundTheClock-BzZ4LFMk.js";const lt=[...se].reverse();function Pe(g){return g===25?"Outer Bull":g===50?"Inner Bull":String(g)}function $e({direction:g,onPickDirection:C,currentTargetIndex:j,isUsersTurn:o,onTurnComplete:W,onDartHit:w,completed:H,playerName:O}){const T=g==="bull-to-1"?lt:se,i=T.length,v=j>=i,[l,m]=n.useState([null,null,null]),x=l.filter(a=>a!==null).length,r=l.filter(a=>a==="hit").length,[P,R]=n.useState([]),c=j,_=T[c]??null,N=n.useCallback(()=>{m([null,null,null]),R([])},[]),u=n.useCallback(a=>{if(x>=3||v)return;const h=[...l];h[x]=a,m(h);let J=0;if(a==="hit"&&(J=T[c]??0,R($=>[...$,J]),w()),x+1>=3){const $=h.filter(z=>z==="hit").length,E=a==="hit"?[...P,J].reduce((z,ae)=>z+ae,0):P.reduce((z,ae)=>z+ae,0);setTimeout(()=>{W($,E),N()},350)}},[l,x,v,T,c,P,w,W,N]);if(!g)return e.jsxs("div",{className:"relative w-full rounded-2xl border-2 border-dashed border-indigo-400/40 bg-indigo-500/5 p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"text-indigo-300/70 text-xs sm:text-sm uppercase tracking-widest font-semibold mb-4",children:"Choose Direction"}),e.jsx("p",{className:"text-white/70 text-sm mb-6",children:"The first thrower picks the order for both players."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs("button",{type:"button",className:"px-6 py-4 rounded-2xl border border-emerald-400/40 bg-emerald-500/10 hover:bg-emerald-500/20 active:scale-95 transition-all text-center",onClick:()=>C("1-to-bull"),children:[e.jsx("div",{className:"font-bold text-emerald-200 text-lg",children:"1 â†’ Bull"}),e.jsx("div",{className:"text-emerald-300/60 text-xs mt-1",children:"Start at 1, finish on Bullseye"})]}),e.jsxs("button",{type:"button",className:"px-6 py-4 rounded-2xl border border-amber-400/40 bg-amber-500/10 hover:bg-amber-500/20 active:scale-95 transition-all text-center",onClick:()=>C("bull-to-1"),children:[e.jsx("div",{className:"font-bold text-amber-200 text-lg",children:"Bull â†’ 1"}),e.jsx("div",{className:"text-amber-300/60 text-xs mt-1",children:"Start at Bullseye, finish on 1"})]})]})]});if(v&&x===0)return e.jsxs("div",{className:"relative w-full rounded-2xl border border-emerald-400/30 bg-emerald-500/10 p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸŽ¯"}),e.jsx("div",{className:"font-bold text-emerald-200 text-xl",children:"Around the Clock Complete!"}),e.jsxs("div",{className:"text-emerald-300/60 text-sm mt-2",children:["All ",i," targets hit"]})]});const d=i>0?Math.round(H/i*100):0,Q=T.slice(c+1,c+6),y=x>=3;return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"relative rounded-2xl border border-white/10 bg-slate-950/70 p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wider text-slate-400 font-semibold",children:"Progress"}),e.jsxs("span",{className:"text-xs text-slate-400 tabular-nums font-medium",children:[H," / ",i," (",d,"%)"]})]}),e.jsx("div",{className:"h-2 rounded-full bg-white/10 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-emerald-500 to-emerald-400 transition-all duration-300",style:{width:`${d}%`}})}),e.jsxs("div",{className:"mt-2 text-[10px] text-slate-500",children:["Direction:"," ",g==="1-to-bull"?"1 â†’ 20 â†’ Bull":"Bull â†’ 20 â†’ 1"]})]}),o&&e.jsx("div",{className:"flex items-center justify-center gap-3",children:l.map((a,h)=>e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs("div",{className:"text-[9px] uppercase tracking-wider text-slate-500 font-semibold",children:["Dart ",h+1]}),e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold border-2 transition-all ${a==="hit"?"bg-emerald-500/20 border-emerald-400/60 text-emerald-300":a==="miss"?"bg-rose-500/20 border-rose-400/60 text-rose-300":h===x?"bg-white/10 border-white/30 text-white/60 animate-pulse":"bg-white/5 border-white/10 text-white/20"}`,children:a==="hit"?"âœ“":a==="miss"?"âœ—":"â€¢"})]},h))}),e.jsxs("div",{className:`relative w-full rounded-2xl border-2 p-6 sm:p-8 text-center transition-all ${o&&!y?"border-emerald-400/40 bg-emerald-500/5":o&&y?"border-amber-400/40 bg-amber-500/5":"border-white/10 bg-white/5 opacity-60"}`,children:[O&&e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-slate-400 mb-1",children:o?"Your target":`${O}'s target`}),e.jsx("div",{className:"text-emerald-300/60 text-xs sm:text-sm uppercase tracking-widest font-semibold mb-2",children:y?"Turn Complete":`Current Target â€” Dart ${x+1} of 3`}),e.jsx("div",{className:"font-mono text-6xl sm:text-7xl font-black text-white leading-none mb-4",children:v?"âœ“":_!=null?Pe(_):"â€”"}),o&&!y&&!v&&e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{type:"button",className:"flex-1 max-w-[10rem] py-4 rounded-2xl text-lg font-bold bg-emerald-600 hover:bg-emerald-500 active:bg-emerald-400 border border-emerald-400/30 text-white shadow-lg shadow-emerald-600/30 transition-all active:scale-95",onClick:()=>u("hit"),children:"âœ“ Hit"}),e.jsx("button",{type:"button",className:"flex-1 max-w-[10rem] py-4 rounded-2xl text-lg font-bold bg-rose-600/80 hover:bg-rose-500 active:bg-rose-400 border border-rose-400/30 text-white shadow-lg shadow-rose-600/20 transition-all active:scale-95",onClick:()=>u("miss"),children:"âœ— Miss"})]}),o&&y&&e.jsx("div",{className:"text-sm text-amber-200/70 mt-2 animate-pulse",children:"Submitting turnâ€¦"}),!o&&e.jsx("div",{className:"text-sm text-white/40 mt-2",children:"Waiting for opponentâ€¦"})]}),o&&x>0&&e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-emerald-300 font-semibold",children:["Hits: ",r]}),e.jsxs("span",{className:"text-rose-300 font-semibold",children:["Misses: ",x-r]})]}),Q.length>0&&e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-wider text-slate-500 font-semibold whitespace-nowrap",children:"Next:"}),e.jsx("div",{className:"flex gap-1.5 flex-wrap",children:Q.map((a,h)=>e.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-white/5 border border-white/10 text-xs text-white/60 font-medium tabular-nums",children:Pe(a)},h))})]})]})}function xt({user:g,showStartShowcase:C,onShowStartShowcaseChange:j,onCommitVisit:o,onQuit:W,onPause:w,onResume:H,onPauseDurationSelected:O,onStateChange:T,localPlayerIndexOverride:i,gameModeOverride:v,isOnline:l,remoteStream:m,remoteFrame:x}){const r=Ge();q(t=>t.hideInGameSidebar??!0),te(t=>t.setPaused),te(),Ke();const[P,R]=n.useState(null),c=x??null,_=n.useRef(null);n.useEffect(()=>{const t=_.current;if(!(!t||!m))return t.srcObject=m,t.play().catch(()=>{}),()=>{t.srcObject=null}},[m]);const N=q(t=>t.lastOffline?.x01Start||501),u=q(t=>t.user),d=ve(g,"")||ve(u,"")||g?.email?.split("@")[0]||u?.email?.split("@")[0]||"You",Q=typeof i=="number"&&i>=0?i:(r.players||[]).findIndex(t=>t?.name&&t.name===d),y=Q>=0?Q:0,a=(r.currentPlayerIdx??0)===y,h=r.players?.[y],J=h?.legs?.[h.legs.length-1],k=J?.totalScoreRemaining??r.startingScore??N,$=(r.players||[]).findIndex((t,s)=>s!==y),E=(r.players||[])[$>=0?$:0],z=E?.legs?.[E.legs.length-1],ae=z?.totalScoreRemaining??r.startingScore??N,ce=n.useMemo(()=>{const t=s=>{if(!s)return{lastVisit:0,avg3:0};let p=0,b=0;for(const D of s.legs||[])p+=(D.totalScoreStart??0)-(D.totalScoreRemaining??0),b+=(D.visits||[]).reduce((S,L)=>S+(L.darts||0)-(L.preOpenDarts||0),0);const f=(s.legs?.[s.legs.length-1]?.visits||[]).slice(-1)[0];return{lastVisit:f?.score??f?.visitTotal??0,avg3:b>0?p/b*3:0}};return{local:t(h),away:t(E)}},[h,E,J?.visits?.length,z?.visits?.length]),le=a?k:ae,F=v||r?.game||"X01",M=F==="X01",be=st(F,r),re=F==="Around the Clock",[Z,Ee]=n.useState(null),[de,Ie]=n.useState({});Z==="bull-to-1"?[...se].reverse():se;const je=de[y]??0,Ne=de[$>=0?$:1]??0,me=n.useMemo(()=>{const t=(s,p)=>{const b=be[p];if(M){const f=s?.legs?.[s.legs.length-1];return{primary:String(f?.totalScoreRemaining??r.startingScore??N),primaryLabel:"Remaining"}}if(F==="Around the Clock"){const f=p===0?y:$>=0?$:1,D=de[f]??0,S=Z==="bull-to-1"?[...se].reverse():se,L=S[D],ne=D>=S.length?"Done!":L===25?"Outer Bull":L===50?"Inner Bull":String(L);return{primary:D>=S.length?"âœ“":ne,primaryLabel:D>=S.length?"Complete":`Target ${D+1}/${S.length}`}}if(F==="Cricket"||F==="American Cricket")return{primary:String(b?.points??0),primaryLabel:"Points"};if(F==="Killer"){const f=b?.lives??0;return{primary:b?.eliminated?"OUT":String(f),primaryLabel:b?.eliminated?"Eliminated":"Lives"}}return{primary:String(b?.score??b?.points??0),primaryLabel:"Score"}};return{local:t(h,y),away:t(E,$>=0?$:0)}},[M,F,be,h,E,y,$,r.startingScore,N,de,Z]),Le=q(t=>t.callerEnabled),Be=q(t=>t.callerVoice),Re=q(t=>t.callerVolume),Ve=q(t=>t.speakCheckoutOnly),[ye,xe]=n.useState(!1),ue=te(t=>t.setPaused),ge=te(t=>t.paused),pe=te(t=>t.pauseEndsAt);te(t=>t.pauseInitiator);const[it,He]=n.useState(Date.now());n.useEffect(()=>(document.documentElement.setAttribute("data-ndn-ingame","true"),()=>{document.documentElement.removeAttribute("data-ndn-ingame")}),[]),n.useEffect(()=>{if(!ge||!pe)return;const t=setInterval(()=>{const s=Date.now();He(s),s>=pe&&ue(!1,null)},250);return()=>clearInterval(t)},[ge,pe,ue]);const Oe=n.useMemo(()=>{if(!M||k>170||k<=0)return null;const t=Ae(k);return t&&t.length>0?t:null},[M,k]),ke=n.useMemo(()=>{if(!M||le>170||le<=0)return null;const t=Ae(le);return t&&t.length>0?t:null},[M,le]),G=M?180:999,fe=n.useMemo(()=>(r.players||[]).map(s=>({name:s.name||"Player",legsWon:s.legsWon||0})),[r.players]),Fe=n.useMemo(()=>(r.players||[]).some(t=>(t.legs||[]).some(s=>(s.visits||[]).length>0)),[r.players]),De=typeof C=="boolean"?C&&!Fe:!1,Se=t=>{j?.(t)},[he,U]=n.useState(!1),[I,V]=n.useState(""),K=n.useRef(null),[Y,A]=n.useState(0),B=M&&a&&k<=60&&k>0;n.useEffect(()=>{he&&K.current&&K.current.focus()},[he]);const[we,Ce]=n.useState(null),[ot,We]=n.useState(0);n.useEffect(()=>{a?(Ce(null),We(0)):Ce(Date.now())},[a]),n.useEffect(()=>{if(!we)return;const t=setInterval(()=>{We(Math.floor((Date.now()-we)/1e3))},1e3);return()=>clearInterval(t)},[we]);const X=(t,s,p)=>{const b=r.players?.[r.currentPlayerIdx],f=b?.legs?.[b.legs.length-1],D=f?f.totalScoreRemaining:r.startingScore,S=typeof t=="number"?t:0;let L=D-S;(!Number.isFinite(L)||L<0)&&(L=0);const ne=L===0&&S>0,ee={visitTotal:S,...p||{}};if(ee.doubleWindowDarts==null){let ie=0;D<=50?ie=s:D<=170&&(ie=ne||L<=50?1:0),ee.doubleWindowDarts=ie}if(ee.finishedByDouble==null&&(ee.finishedByDouble=ne),o){o(S,s,ee);return}if(Le){const ie=b?.name||ve(g,"Player");try{Je(ie,S,L,Be,{volume:Re,checkoutOnly:Ve})}catch{}}r.addVisit(S,s,ee),ne?r.endLeg(S):r.nextPlayer(),T?.()},_e=n.useCallback(()=>{const t=r.currentPlayerIdx??y;Ie(s=>({...s,[t]:(s[t]??0)+1}))},[r.currentPlayerIdx,y]),ze=n.useCallback((t,s)=>{X(s,3,{visitTotal:s,atcHit:t>0,atcHits:t})},[]),Me=n.useCallback(()=>{try{const t=[];if((r.players||[]).forEach(b=>{(b.legs||[]).forEach(f=>{if(f?.finished){const D=(f.visits||[]).slice(-1)[0];t.push({ts:f.endTime||Date.now(),visit:D,player:b})}})}),!t.length)return null;const s=t.sort((b,f)=>f.ts-b.ts)[0],p=(s.visit?.entries||[]).slice(-1)[0];if(p?.label)return p.label;if(p?.ring==="DOUBLE"&&typeof p?.value=="number")return`Double ${p.value/2}`;if(typeof s.visit?.visitTotal=="number")return`Checkout ${s.visit.visitTotal}`}catch{}return null},[r.players]);return n.useEffect(()=>{if(r.inProgress){R(null);return}if(!P?.label){const t=Me();t&&R(s=>({...s,label:t}))}},[r.inProgress,Me,P?.label]),e.jsxs("div",{className:"ndn-game-shell ndn-page ndn-ingame-active relative",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-32 -left-32 w-96 h-96 rounded-full bg-indigo-600/10 blur-[120px]"}),e.jsx("div",{className:"absolute -bottom-32 -right-32 w-96 h-96 rounded-full bg-amber-500/8 blur-[120px]"})]}),De&&e.jsx(Ye,{open:De,players:r.players||[],onDone:()=>{Se(!1)},onRequestClose:()=>{Se(!1)},showCalibrationDefault:!0}),e.jsx("div",{className:"z-20 mb-1 shrink-0",children:e.jsxs("div",{className:"relative flex items-center justify-between gap-2 px-3 sm:px-5 py-1.5 rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl shadow-lg",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-2xl bg-gradient-to-r from-indigo-500/10 via-transparent to-amber-500/10"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm leading-none z-10",children:[l&&e.jsx("span",{className:"px-2.5 py-1 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-[10px] sm:text-xs font-semibold tracking-wide",children:"ðŸŒ Online"}),e.jsxs("span",{className:"px-3 py-1 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-xs font-semibold tracking-wide",children:[F,M?` / ${r.startingScore||N}`:""]}),fe.length>=2&&e.jsxs("span",{className:"font-bold text-white/90 text-sm tabular-nums",children:["Legs: ",fe[0].legsWon," â€“ ",fe[1].legsWon]})]}),e.jsxs("div",{className:"flex items-center gap-2 z-10",children:[e.jsx(Qe,{}),e.jsx("button",{className:"px-4 py-1.5 rounded-xl text-sm font-semibold bg-rose-600/90 hover:bg-rose-500 text-white border border-rose-400/30 shadow-lg shadow-rose-500/20 transition-all",onClick:()=>xe(!0),children:"â¸ Quit / Pause"})]})]})}),e.jsxs("div",{className:"relative mb-1 rounded-2xl border border-white/10 overflow-hidden shrink-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-950/80 via-slate-900/90 to-amber-950/80"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(255,255,255,0.03),transparent_70%)]"}),e.jsxs("div",{className:"relative grid grid-cols-[minmax(0,1fr)_auto_minmax(0,1fr)] items-center py-1.5 px-3 sm:px-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("div",{className:`text-xs font-bold uppercase tracking-widest ${a?"text-emerald-400":"text-slate-400"}`,children:h?.name||"You"}),M&&e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 tabular-nums",children:["(",h?.legsWon||0,")"]}),a&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"})]}),e.jsx("div",{className:`font-mono text-3xl sm:text-4xl font-black tabular-nums leading-none ${a?"text-white":"text-white/60"}`,children:me.local.primary}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 text-[10px]",children:[e.jsx("span",{className:"uppercase tracking-wider text-slate-500 font-medium",children:me.local.primaryLabel}),ce.local.avg3>0&&e.jsxs("span",{className:"text-slate-400 tabular-nums",children:["Avg: ",ce.local.avg3.toFixed(1)]})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center px-3",children:[e.jsx("div",{className:"w-px h-3 bg-gradient-to-b from-transparent via-white/20 to-transparent"}),e.jsx("div",{className:"text-xs font-black text-white/30 tracking-widest my-0.5",children:"VS"}),e.jsx("div",{className:"w-px h-3 bg-gradient-to-b from-transparent via-white/20 to-transparent"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("div",{className:`text-xs font-bold uppercase tracking-widest ${a?"text-slate-400":"text-amber-400"}`,children:E?.name||"Opponent"}),M&&e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 tabular-nums",children:["(",E?.legsWon||0,")"]}),!a&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse"})]}),e.jsx("div",{className:`font-mono text-3xl sm:text-4xl font-black tabular-nums leading-none ${a?"text-white/60":"text-white"}`,children:me.away.primary}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 text-[10px]",children:[e.jsx("span",{className:"uppercase tracking-wider text-slate-500 font-medium",children:me.away.primaryLabel}),ce.away.avg3>0&&e.jsxs("span",{className:"text-slate-400 tabular-nums",children:["Avg: ",ce.away.avg3.toFixed(1)]})]})]})]}),ke&&e.jsxs("div",{className:`relative border-t px-3 py-1 flex items-center gap-2 ${a?"border-emerald-400/20 bg-emerald-500/10":"border-amber-400/20 bg-amber-500/10"}`,children:[e.jsxs("span",{className:`text-[10px] sm:text-xs uppercase tracking-wider font-semibold whitespace-nowrap ${a?"text-emerald-300/80":"text-amber-300/80"}`,children:["Checkout ",le,":"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:ke.map((t,s)=>e.jsx("span",{className:`px-2 py-0.5 rounded-lg text-xs sm:text-sm font-medium ${a?"bg-emerald-500/20 border border-emerald-400/20 text-emerald-100":"bg-amber-500/20 border border-amber-400/20 text-amber-100"}`,children:t},s))})]})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto pb-28 sm:pb-20",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr] gap-2 min-h-0",children:[e.jsxs("div",{className:"relative rounded-2xl border border-white/10 bg-slate-950/70 shadow-2xl ring-1 ring-white/5 p-2 sm:p-3 overflow-hidden",children:[e.jsx("div",{className:`pointer-events-none absolute inset-0 bg-gradient-to-br ${a?"from-emerald-500/[0.03]":"from-white/[0.02]"} to-transparent`}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-white/90 tracking-wide",children:"Scoreboard"}),e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] sm:text-xs font-semibold ${a?"bg-emerald-500/20 border border-emerald-400/30 text-emerald-300 animate-pulse":"bg-amber-500/20 border border-amber-400/30 text-amber-300"}`,children:a?"â— Your turn":`${E?.name||"Opponent"}â€™s turn`})]}),e.jsx(Ue,{gameMode:F,players:be})]}),l&&e.jsxs("div",{className:"relative rounded-2xl border border-white/10 bg-slate-950/70 shadow-2xl ring-1 ring-white/5 overflow-hidden flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-1 border-b border-white/5 bg-white/5 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full shadow-lg animate-pulse ${a?"bg-emerald-400 shadow-emerald-400/50":"bg-amber-400 shadow-amber-400/50"}`}),e.jsx("span",{className:"text-xs font-semibold text-white/80",children:a?"Your Board":`${E?.name||"Opponent"}â€™s Board`})]}),e.jsx("span",{className:`text-[10px] font-medium ${a?"text-emerald-300":"text-amber-300"}`,children:a?"â— Live":"â— Waiting"})]}),e.jsxs("div",{className:"relative flex-1 min-h-0 bg-black",children:[e.jsx("div",{className:`h-full ${a||!m&&!c?"":"hidden"}`,children:e.jsx(Xe,{hideInlinePanels:!0,forceAutoStart:!0})}),!a&&m&&e.jsx("video",{ref:_,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-contain"}),!a&&!m&&c&&e.jsx("img",{id:"ndn-opponent-frame",src:c,alt:"Opponent board",className:"w-full h-full object-contain"}),!a&&!m&&!c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-white/30 text-xs uppercase tracking-wider mb-1",children:"Opponent's camera not available"}),e.jsx("div",{className:"text-white/20 text-[10px]",children:"Showing your board instead"})]})})]})]})]}),!a&&re&&Z&&e.jsx($e,{direction:Z,onPickDirection:()=>{},currentTargetIndex:Ne,isUsersTurn:!1,onTurnComplete:()=>{},onDartHit:()=>{},completed:Ne,playerName:E?.name||"Opponent"}),a&&re&&e.jsx($e,{direction:Z,onPickDirection:t=>Ee(t),currentTargetIndex:je,isUsersTurn:a,onTurnComplete:ze,onDartHit:_e,completed:je,playerName:h?.name||"You"}),a&&!re&&e.jsx("div",{className:"flex flex-wrap gap-1.5 justify-center",children:(M?[180,140,100,85,60,45,26,0]:[100,80,60,45,26,20,10,0]).map(t=>e.jsx("button",{className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white/5 hover:bg-white/10 active:bg-white/15 border border-white/10 text-white/90 transition-all active:scale-95",onClick:()=>{const s=k-t===0&&t>0;X(t,3,{visitTotal:t,...B?{doubleWindowDarts:Y,finishedByDouble:s}:{}}),A(0)},children:t},t))}),P?.label&&e.jsxs("div",{className:"rounded-2xl border border-emerald-400/30 bg-emerald-500/10 px-4 py-3 text-center",children:[e.jsx("span",{className:"text-xs text-emerald-400/70 uppercase tracking-wider font-semibold",children:M?"Winning Double":"Winning Shot"}),e.jsx("div",{className:"text-lg font-bold text-emerald-200 mt-0.5",children:P.label})]})]})}),he&&!re&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-8",onClick:()=>U(!1),onKeyDown:t=>{t.key==="Escape"&&U(!1)},children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full max-w-sm mx-auto rounded-3xl border border-white/10 bg-slate-900/95 backdrop-blur-xl shadow-2xl p-4 sm:p-6 animate-[slideUp_0.2s_ease-out]",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"mb-4 rounded-2xl bg-black/40 border border-white/10 p-4 text-center",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-widest text-slate-400 mb-1",children:"Score"}),e.jsx("input",{ref:K,type:"number",inputMode:"numeric",pattern:"[0-9]*",className:"w-full bg-transparent font-mono text-5xl sm:text-6xl font-black text-white tabular-nums min-h-[3.5rem] leading-none text-center outline-none border-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none placeholder:text-white/20",placeholder:"0",value:I,onChange:t=>{const s=t.target.value.replace(/[^0-9]/g,"");(s===""||Number(s)<=G)&&V(s)},onKeyDown:t=>{if(t.key==="ArrowUp"&&B){t.preventDefault(),A(s=>Math.min(3,s+1));return}if(t.key==="ArrowDown"&&B){t.preventDefault(),A(s=>Math.max(0,s-1));return}if(t.key==="Enter"){t.preventDefault();const s=Math.max(0,Math.min(G,Number(I)||0)),p=k-s===0&&s>0;X(s,3,{visitTotal:s,...B?{doubleWindowDarts:Y,finishedByDouble:p}:{}}),V(""),A(0),U(!1)}}}),I&&Oe&&Number(I)===k&&e.jsx("div",{className:"mt-2 text-xs text-emerald-300 font-semibold",children:"âœ“ Checkout!"})]}),B&&e.jsxs("div",{className:"mb-3 rounded-xl bg-amber-500/10 border border-amber-400/20 px-3 py-2 flex items-center justify-between select-none",children:[e.jsx("span",{className:"text-xs font-semibold text-amber-300/80 uppercase tracking-wide",children:"Darts at Double"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"w-8 h-8 rounded-lg bg-white/5 hover:bg-white/15 active:bg-white/20 border border-white/10 text-white/80 text-base font-bold transition-all active:scale-90",onClick:()=>{A(t=>Math.max(0,t-1)),K.current?.focus()},"aria-label":"Decrease darts at double",children:"âˆ’"}),e.jsx("span",{className:"w-8 text-center font-mono text-2xl font-black text-amber-300 tabular-nums",children:Y}),e.jsx("button",{className:"w-8 h-8 rounded-lg bg-white/5 hover:bg-white/15 active:bg-white/20 border border-white/10 text-white/80 text-base font-bold transition-all active:scale-90",onClick:()=>{A(t=>Math.min(3,t+1)),K.current?.focus()},"aria-label":"Increase darts at double",children:"+"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[[1,2,3,4,5,6,7,8,9].map(t=>e.jsx("button",{className:"py-3.5 rounded-xl text-xl font-bold bg-white/5 hover:bg-white/10 active:bg-white/20 border border-white/10 text-white transition-all active:scale-95",onClick:()=>{const s=I+String(t);Number(s)<=G&&V(s),K.current?.focus()},children:t},t)),e.jsx("button",{className:"py-3.5 rounded-xl text-lg font-bold bg-white/5 hover:bg-white/10 active:bg-white/20 border border-white/10 text-white/60 transition-all active:scale-95",onClick:()=>{V(t=>t.slice(0,-1)),K.current?.focus()},children:"âŒ«"}),e.jsx("button",{className:"py-3.5 rounded-xl text-xl font-bold bg-white/5 hover:bg-white/10 active:bg-white/20 border border-white/10 text-white transition-all active:scale-95",onClick:()=>{const t=I+"0";Number(t)<=G&&V(t),K.current?.focus()},children:"0"}),e.jsx("button",{className:"py-3.5 rounded-xl text-lg font-bold bg-emerald-600 hover:bg-emerald-500 active:bg-emerald-400 border border-emerald-400/30 text-white shadow-lg shadow-emerald-600/30 transition-all active:scale-95",onClick:()=>{const t=Math.max(0,Math.min(G,Number(I)||0)),s=k-t===0&&t>0;X(t,3,{visitTotal:t,...B?{doubleWindowDarts:Y,finishedByDouble:s}:{}}),V(""),A(0),U(!1)},children:"âœ“"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-3",children:(M?[180,140,100,85,60,45,26,0]:[100,80,60,45,26,20,10,0]).map(t=>e.jsx("button",{className:"px-3 py-1.5 rounded-lg text-xs font-bold bg-white/5 hover:bg-white/10 border border-white/10 text-white/80 transition-all active:scale-95",onClick:()=>{const s=k-t===0&&t>0;X(t,3,{visitTotal:t,...B?{doubleWindowDarts:Y,finishedByDouble:s}:{}}),V(""),A(0),U(!1)},children:t},t))}),e.jsx("button",{className:"w-full py-2.5 rounded-xl text-sm font-semibold text-white/50 hover:text-white/80 hover:bg-white/5 transition-all",onClick:()=>U(!1),children:"Cancel"})]})]}),!re&&!he&&!ye&&!ge&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-30 bg-slate-900/95 backdrop-blur-xl border-t border-white/10 px-3 py-2 safe-bottom",style:{paddingBottom:"max(0.5rem, env(safe-area-inset-bottom, 0px))"},children:e.jsxs("div",{className:"flex items-center gap-2 max-w-lg mx-auto",children:[e.jsx("input",{type:"number",inputMode:"numeric",pattern:"[0-9]*",className:`flex-1 border rounded-xl px-4 py-3 font-mono text-xl font-bold text-center outline-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none placeholder:text-white/30 ${a?"bg-white/5 border-white/15 text-white focus:border-emerald-400/50 focus:ring-1 focus:ring-emerald-400/30":"bg-white/3 border-white/10 text-white/50"}`,placeholder:a?"Type score...":"Waiting for opponent...",value:I,disabled:!a,onChange:t=>{const s=t.target.value.replace(/[^0-9]/g,"");(s===""||Number(s)<=G)&&V(s)},onKeyDown:t=>{if(t.key==="ArrowUp"&&B){t.preventDefault(),A(s=>Math.min(3,s+1));return}if(t.key==="ArrowDown"&&B){t.preventDefault(),A(s=>Math.max(0,s-1));return}if(t.key==="Enter"){t.preventDefault();const s=Math.max(0,Math.min(G,Number(I)||0));if(I!==""){const p=k-s===0&&s>0;X(s,3,{visitTotal:s,...B?{doubleWindowDarts:Y,finishedByDouble:p}:{}}),V(""),A(0)}}}}),B&&e.jsxs("div",{className:"flex flex-col items-center gap-0.5 select-none",children:[e.jsx("div",{className:"text-[9px] uppercase tracking-wider text-amber-300/70 font-semibold whitespace-nowrap",children:"Darts@Dbl"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"w-7 h-7 rounded-lg bg-white/5 hover:bg-white/15 active:bg-white/20 border border-white/10 text-white/80 text-sm font-bold transition-all active:scale-90",onClick:()=>A(t=>Math.max(0,t-1)),"aria-label":"Decrease darts at double",children:"âˆ’"}),e.jsx("span",{className:"w-6 text-center font-mono text-lg font-black text-amber-300 tabular-nums",children:Y}),e.jsx("button",{className:"w-7 h-7 rounded-lg bg-white/5 hover:bg-white/15 active:bg-white/20 border border-white/10 text-white/80 text-sm font-bold transition-all active:scale-90",onClick:()=>A(t=>Math.min(3,t+1)),"aria-label":"Increase darts at double",children:"+"})]})]}),e.jsx("button",{className:`px-5 py-3 rounded-xl text-sm font-bold text-white border transition-all active:scale-95 whitespace-nowrap ${a&&I!==""?"bg-emerald-600 hover:bg-emerald-500 active:bg-emerald-400 border-emerald-400/30 shadow-lg shadow-emerald-600/20":"bg-slate-700 border-white/10 opacity-50 cursor-not-allowed"}`,disabled:!a||I==="",onClick:()=>{const t=Math.max(0,Math.min(G,Number(I)||0)),s=k-t===0&&t>0;X(t,3,{visitTotal:t,...B?{doubleWindowDarts:Y,finishedByDouble:s}:{}}),V(""),A(0)},children:"Submit"}),a&&e.jsx("button",{className:"px-3 py-3 rounded-xl text-sm font-semibold bg-white/5 hover:bg-white/10 text-white/70 border border-white/10 transition-all",onClick:()=>{V(""),U(!0)},children:"âŒ¨"})]})}),ye&&e.jsx(qe,{onClose:()=>xe(!1),onQuit:()=>{if(xe(!1),W)W();else{try{r.endGame()}catch{}try{window.dispatchEvent(new Event("ndn:match-quit"))}catch{}}},onPause:()=>{try{ue(!0,null,d)}catch{}try{Te({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:d})}catch{}w&&w(),xe(!1)}}),e.jsx(at,{localPlayerName:d,onResume:()=>{ue(!1,null);try{Te({type:"unpause"})}catch{}H&&H()},onDurationSelected:(t,s)=>{O&&O(t,s)}})]})}const oe=[{min:0,max:39,label:"0+"},{min:40,max:59,label:"40+"},{min:60,max:79,label:"60+"},{min:80,max:99,label:"80+"},{min:100,max:119,label:"100+"},{min:120,max:139,label:"120+"},{min:140,max:179,label:"140+"},{min:180,max:180,label:"180"}];function rt(g){const C=new Array(oe.length).fill(0);for(const j of g.legs||[])for(const o of j.visits||[]){const W=o?.score||o?.visitTotal||0;for(let w=oe.length-1;w>=0;w--)if(W>=oe[w].min&&W<=oe[w].max){C[w]++;break}}return oe.map((j,o)=>({label:j.label,value:C[o]}))}function nt(g){let C=0,j=0,o=null,W=null,w=0,H=0,O=0,T=0,i=0,v=0,l=0,m=0,x=0;for(const c of g.legs||[]){C+=c.totalScoreStart-c.totalScoreRemaining;const _=(c.visits||[]).reduce((u,d)=>u+(d.darts||0),0);j+=_,c.finished&&((o===null||c.dartsThrown<o)&&(o=c.dartsThrown),(W===null||c.dartsThrown>W)&&(W=c.dartsThrown));let N=0;for(const u of c.visits||[]){const d=u?.score||u?.visitTotal||0;i++,d===180&&(w+=1),d>=140&&d<180&&(H+=1),d>=100&&(O+=1),d>T&&(T=d),N<9&&(m+=Math.min(u.darts||3,9-N),x+=d),N+=u.darts||3,u.doubleWindowDarts&&(v+=u.doubleWindowDarts),u.finishedByDouble&&(l+=1)}}const r=j>0?C/j*3:0,P=m>0?x/m*3:0,R=v>0?l/v*100:0;return{points:C,darts:j,threeDA:r,bestLeg:o,worstLeg:W,oneEighties:w,oneForties:H,tons:O,highestVisit:T,totalVisits:i,firstNineAvg:P,checkoutAttempts:v,checkoutsHit:l,checkoutPct:R}}function ut({open:g,onClose:C,title:j="Match Summary",players:o,centerScore:W,doublesStats:w,allowRematch:H,onRematch:O,winnerName:T}){if(!g)return null;const i=o.map((l,m)=>{const x=nt(l),r=rt(l),P=w?.[l.id]||{},R=Math.max(0,Number(P.dartsAtDouble||x.checkoutAttempts||0)),c=Math.max(0,Number(P.doublesHit||x.checkoutsHit||0)),_=R>0?Math.round(c/R*100):null,N=o[1-m],u=N?Ze(l.name,N.name):null,d=u&&u.played?u.diffA:0,Q=`${d>0?"+":""}${d}`;return{id:l.id,name:l.name,legsWon:l.legsWon,...x,distribution:r,dartsAtDouble:R,doublesHit:c,doublePct:_,legDiffStr:Q}}),v=T||(i.length===2&&i[0].legsWon!==i[1].legsWon?i[0].legsWon>i[1].legsWon?i[0].name:i[1].name:null);return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[120] p-4",children:e.jsxs(et,{storageKey:"ndn:modal:match-summary",className:"ndn-modal w-full relative overflow-hidden",defaultWidth:960,defaultHeight:780,minWidth:640,minHeight:520,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[v&&e.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-amber-500/20 via-yellow-400/30 to-amber-500/20 py-3 text-center border-b border-yellow-400/30",children:e.jsxs("div",{className:"text-2xl font-black text-yellow-300 tracking-tight",children:["ðŸ† ",v," WINS! ðŸ†"]})}),e.jsxs("div",{className:v?"pt-14":"",children:[e.jsx("h3",{className:"text-2xl font-extrabold mb-1 text-center",children:j}),e.jsx("div",{className:"text-sm opacity-80 mb-4 text-center",children:o.map(l=>l.name).join(" vs ")}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mb-6",children:[i[0]&&e.jsx("div",{className:`text-5xl font-black ${i[0].legsWon>(i[1]?.legsWon||0)?"text-emerald-400":"text-white"}`,children:i[0].legsWon}),e.jsx("div",{className:"text-3xl font-bold text-white/50",children:"â€“"}),i[1]&&e.jsx("div",{className:`text-5xl font-black ${i[1].legsWon>(i[0]?.legsWon||0)?"text-emerald-400":"text-white"}`,children:i[1].legsWon})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:i.map((l,m)=>e.jsxs("div",{className:`p-4 rounded-2xl border ${l.legsWon>(i[1-m]?.legsWon||0)?"bg-emerald-500/10 border-emerald-400/30":"bg-white/5 border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-lg font-bold",children:l.name}),l.legsWon>(i[1-m]?.legsWon||0)&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-emerald-500/20 text-emerald-300 border border-emerald-400/30",children:"Winner"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-white/5 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-300",children:l.threeDA.toFixed(1)}),e.jsx("div",{className:"text-[10px] opacity-70",children:"3-Dart Avg"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-white/5 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-300",children:l.firstNineAvg.toFixed(1)}),e.jsx("div",{className:"text-[10px] opacity-70",children:"First 9 Avg"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-white/5 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-300",children:l.doublePct!==null?`${l.doublePct}%`:"â€”"}),e.jsx("div",{className:"text-[10px] opacity-70",children:"Checkout %"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold text-rose-300",children:l.oneEighties}),e.jsx("div",{className:"opacity-60",children:"180's"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.oneForties}),e.jsx("div",{className:"opacity-60",children:"140+"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.tons}),e.jsx("div",{className:"opacity-60",children:"100+"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.highestVisit}),e.jsx("div",{className:"opacity-60",children:"High"})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-xs mt-2",children:[e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.bestLeg||"â€”"}),e.jsx("div",{className:"opacity-60",children:"Best Leg"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.worstLeg||"â€”"}),e.jsx("div",{className:"opacity-60",children:"Worst Leg"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.darts}),e.jsx("div",{className:"opacity-60",children:"Darts"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:"font-bold",children:l.dartsAtDouble}),e.jsx("div",{className:"opacity-60",children:"At Double"})]}),e.jsxs("div",{className:"p-1.5 rounded bg-white/5 text-center",children:[e.jsx("div",{className:`font-bold ${l.legDiffStr.startsWith("+")?"text-emerald-300":l.legDiffStr.startsWith("-")?"text-rose-300":""}`,children:l.legDiffStr}),e.jsx("div",{className:"opacity-60",children:"Leg Diff"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-[10px] opacity-60 mb-1 text-center",children:"Score Distribution"}),e.jsx(tt,{data:l.distribution,height:90,barWidth:20,gap:3,showValues:!0})]})]},l.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-600 py-3 text-sm font-semibold",onClick:C,children:"Close"}),H&&e.jsx("button",{className:"btn bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-500 hover:to-emerald-400 py-3 text-sm font-semibold",onClick:O,children:"ðŸ”„ Rematch"})]})]})})}function ht(){}export{xt as I,ut as M,ht as o};
//# sourceMappingURL=matchWindow-_tMJLG5T.js.map
