import{i as W,U as P,j as e,R as L}from"./index-B9xzhtT-.js";import{f as w}from"./stats-X3jz_E9o.js";import{M as E}from"./MatchControls-BkOdC589.js";import"./vendor-D3F3s8fL.js";import"./ui-DygUIHRq.js";function C({matchActions:n}={}){const{players:m,currentPlayerIdx:x,addVisit:b,undoVisit:S,endLeg:j,nextPlayer:p,endGame:D,inProgress:N,startingScore:u,bestLegThisMatch:v}=W(),y=P(t=>t.entries),M=t=>{try{const s=m[t],r=s?.legs?.[s.legs.length-1],a=r?.visits?.[r.visits.length-1]?.entries;return Array.isArray(a)?a:null}catch{return null}};function R(){try{const t={ts:Date.now(),players:m.map(s=>{const r=s.legs.reduce((c,l)=>{c.points+=l.totalScoreStart-l.totalScoreRemaining;const o=(l.visits||[]).reduce((g,d)=>g+(d.darts||0),0);return c.darts+=o,c},{points:0,darts:0}),i=r.darts,a=i>0?r.points/i*3:0;return{id:s.id,name:s.name,legsWon:s.legsWon,dartsThrown:i,avg:Math.round(a*100)/100}}),winner:m.reduce((s,r)=>r.legsWon>(s?.legsWon||0)?r:s,m[0])?.name};try{localStorage.setItem("ndn_last_match",JSON.stringify(t))}catch{}}catch{}(n?.endGame??D)()}return e.jsx(L,{storageKey:"ndn:modal:scoreboard",className:"ndn-modal w-full h-full relative",defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-3",children:e.jsx("div",{className:"ndn-hscroll",children:e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3",children:e.jsxs("div",{className:"col-span-2 card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Score Input"}),N?e.jsx(E,{inProgress:N,startingScore:u,pendingEntries:y,onAddVisit:(t,s)=>{const r=m[x],i=r.legs[r.legs.length-1];let l=(i?i.totalScoreRemaining:u)-(typeof t=="number"?t:0);(!Number.isFinite(l)||l<0)&&(l=0),n?.addVisit?n.addVisit(t,s):b(t,s),l===0?n?.endLeg?n.endLeg(t):j(t):(n?.nextPlayer??p)()},onUndo:()=>(n?.undoVisit??S)(),onEndLeg:(t,s,r)=>{const i=typeof t=="number"?t:0,a=typeof s=="number"?Math.max(0,s):0;n?.addVisit?n.addVisit(i,a,{visitTotal:i,doubleWindowDarts:r?.doubleDarts??0}):b(i,a,{visitTotal:i,doubleWindowDarts:r?.doubleDarts??0}),(n?.endLeg??j)(i)},onNextPlayer:()=>(n?.nextPlayer??p)(),onEndGame:R,quickButtons:[180,140,100,60]}):e.jsx("p",{className:"text-slate-600",children:"No game in progress."}),e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map((t,s)=>{const r=t.legs[t.legs.length-1],i=r?r.totalScoreRemaining:u,a=t.legs.reduce((o,g)=>{o.points+=g.totalScoreStart-g.totalScoreRemaining;const d=(g.visits||[]).reduce((h,f)=>h+(f.darts||0),0);return o.darts+=d,o},{points:0,darts:0}),c=a.darts,l=c>0?a.points/c*3:0;return e.jsxs("div",{className:`card glass transition-shadow transition-all duration-150 ease-out ${s===x?"ring-2 ring-brand-400":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold",children:t.name}),e.jsxs("span",{className:"badge w-32 justify-center",children:["Legs Won: ",t.legsWon]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-1 h-3 w-full","aria-hidden":!0,children:[0,1,2].map(o=>{const g=M(s),d=s===x?y[o]??null:g?.[o]??null,h=d==null,f=d!=null&&(typeof d.ring=="string"?d.ring!=="MISS":typeof d.value=="number"?d.value>0:!0),V=`visit-dot ${s===x&&!h?"active":"inactive"} ${h?"bg-gray-400/60":f?"bg-emerald-400":"bg-rose-500"}`;return e.jsx("span",{className:V},o)})}),e.jsx("div",{className:"text-2xl font-bold",children:i}),e.jsx("div",{className:"h-1 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70 transition-all duration-200 ease-out",style:{width:`${Math.max(0,Math.min(100,(1-i/u)*100))}%`}})})]}),e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Darts"}),e.jsx("div",{className:"text-xl font-bold",children:c})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"text-xl font-bold",children:w(t.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg (Match)"}),e.jsx("div",{className:"text-xl font-bold",children:w(l)})]})]})]},t.id)})}),v&&e.jsxs("div",{className:"mt-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsx("strong",{children:"Best Leg (this match):"})," Player"," ",m.find(t=>t.id===v.playerId)?.name," ","in ",v.darts," darts"]})]})})})})})}export{C as default};
//# sourceMappingURL=Scoreboard-BhYWie0A.js.map
