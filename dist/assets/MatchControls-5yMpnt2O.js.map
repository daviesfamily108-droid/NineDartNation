{"version":3,"file":"MatchControls-5yMpnt2O.js","sources":["../../src/components/ui/ScoreNumberPad.tsx","../../src/components/MatchControls.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\n\ninterface ScoreNumberPadProps {\n  value: string;\n  onChange: (next: string) => void;\n  onSubmit?: () => void;\n  disabled?: boolean;\n  label?: string;\n  helperText?: string;\n  maxLength?: number;\n  className?: string;\n}\n\nconst DIGITS = [\"7\", \"8\", \"9\", \"4\", \"5\", \"6\", \"1\", \"2\", \"3\", \"0\"];\n\nexport default function ScoreNumberPad({\n  value,\n  onChange,\n  onSubmit,\n  disabled = false,\n  label = \"Number pad\",\n  helperText,\n  maxLength = 3,\n  className = \"\",\n}: ScoreNumberPadProps) {\n  const appendDigit = (digit: string) => {\n    const base = value === \"0\" ? \"\" : (value ?? \"\");\n    const next = `${base}${digit}`;\n    const trimmed = maxLength > 0 ? next.slice(0, maxLength) : next;\n    onChange(trimmed);\n  };\n\n  useEffect(() => {\n    if (disabled) return;\n    const isEditableTarget = (target: EventTarget | null) => {\n      if (!target || !(target as HTMLElement).tagName) return false;\n      const el = target as HTMLElement;\n      const tag = el.tagName.toLowerCase();\n      if (tag === \"input\" || tag === \"textarea\" || tag === \"select\")\n        return true;\n      return !!el.getAttribute(\"contenteditable\");\n    };\n    const handler = (e: KeyboardEvent) => {\n      if (e.defaultPrevented) return;\n      if (isEditableTarget(e.target)) return;\n      if (e.metaKey || e.ctrlKey || e.altKey) return;\n      if (e.key >= \"0\" && e.key <= \"9\") {\n        e.preventDefault();\n        appendDigit(e.key);\n        return;\n      }\n      if (e.key === \"Backspace\") {\n        e.preventDefault();\n        onChange((value || \"\").slice(0, -1));\n        return;\n      }\n      if (e.key === \"Escape\") {\n        e.preventDefault();\n        onChange(\"\");\n        return;\n      }\n      if (e.key === \"Enter\" && onSubmit) {\n        e.preventDefault();\n        onSubmit();\n      }\n    };\n    window.addEventListener(\"keydown\", handler);\n    return () => window.removeEventListener(\"keydown\", handler);\n  }, [appendDigit, disabled, onChange, onSubmit, value]);\n\n  return (\n    <div className={className}>\n      {label && <div className=\"text-sm font-semibold mb-2\">{label}</div>}\n      <div className=\"grid grid-cols-3 gap-2 max-w-sm\">\n        {DIGITS.map((digit) => (\n          <button\n            key={digit}\n            className=\"btn text-lg\"\n            onClick={() => appendDigit(digit)}\n            disabled={disabled}\n          >\n            {digit}\n          </button>\n        ))}\n        <button\n          className=\"btn bg-rose-600 hover:bg-rose-700 text-white\"\n          onClick={() => onChange(\"\")}\n          disabled={disabled}\n        >\n          Clear\n        </button>\n        <button\n          className=\"btn bg-slate-600 hover:bg-slate-700 text-white\"\n          onClick={() => onChange((value || \"\").slice(0, -1))}\n          disabled={disabled}\n        >\n          Back\n        </button>\n        <button\n          className=\"btn bg-emerald-600 hover:bg-emerald-700 text-white\"\n          onClick={() => onSubmit && onSubmit()}\n          disabled={disabled || !onSubmit}\n        >\n          Enter\n        </button>\n      </div>\n      {helperText && (\n        <div className=\"text-xs opacity-70 mt-2\">{helperText}</div>\n      )}\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\nimport { Undo2 } from \"lucide-react\";\nimport ScoreNumberPad from \"./ui/ScoreNumberPad\";\n\ninterface MatchControlsProps {\n  inProgress?: boolean;\n  startingScore?: number;\n  pendingEntries?: Array<any>;\n  onAddVisit: (score: number, darts: number) => void;\n  onUndo?: () => void;\n  onEndLeg?: (score?: number, darts?: number, meta?: any) => void;\n  onNextPlayer?: () => void;\n  onEndGame?: () => void;\n  showDartsSelect?: boolean;\n  showCheckoutSelectors?: boolean;\n  quickButtons?: number[];\n}\n\nexport default function MatchControls({\n  inProgress = true,\n  startingScore: _startingScore = 501,\n  pendingEntries: _pendingEntries = [],\n  onAddVisit,\n  onUndo,\n  onEndLeg,\n  onNextPlayer,\n  onEndGame,\n  showDartsSelect = true,\n  showCheckoutSelectors = true,\n  quickButtons = [180, 140, 100, 60],\n}: MatchControlsProps) {\n  const [scoreInput, setScoreInput] = useState<string>(\"0\");\n  const [darts, setDarts] = useState<number>(3);\n  const [checkoutDarts, setCheckoutDarts] = useState<number>(3);\n  const [doubleDarts, setDoubleDarts] = useState<number>(1);\n  const parsedScore = Number(scoreInput || 0);\n  const safeScore = Number.isFinite(parsedScore) ? parsedScore : 0;\n  const commitScore = () => {\n    onAddVisit(Math.max(0, safeScore), darts);\n    setScoreInput(\"0\");\n  };\n\n  if (!inProgress) {\n    return <p className=\"text-slate-600\">No game in progress.</p>;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex flex-wrap items-center gap-2\">\n        <input\n          className=\"input w-32\"\n          type=\"number\"\n          value={scoreInput}\n          onChange={(e) => setScoreInput(e.target.value)}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") {\n              e.preventDefault();\n              commitScore();\n            }\n          }}\n          placeholder=\"Score\"\n        />\n        {showDartsSelect && (\n          <select\n            className=\"input\"\n            value={darts}\n            onChange={(e) => setDarts(parseInt(e.target.value))}\n          >\n            <option value={1}>1 dart</option>\n            <option value={2}>2 darts</option>\n            <option value={3}>3 darts</option>\n          </select>\n        )}\n        <button className=\"btn\" onClick={commitScore}>\n          Add Visit âž•\n        </button>\n        <button\n          className=\"px-3 py-2 rounded-xl border border-slate-200\"\n          onClick={() => onUndo && onUndo()}\n          title=\"Undo\"\n        >\n          <Undo2 className=\"w-4 h-4\" />\n        </button>\n      </div>\n      {quickButtons && quickButtons.length > 0 && (\n        <div className=\"flex flex-wrap items-center gap-2 mt-2 text-xs\">\n          <span className=\"opacity-70\">Quick:</span>\n          {quickButtons.map((v) => (\n            <button\n              key={String(v)}\n              className=\"btn px-2 py-0.5 text-xs\"\n              onClick={() => onAddVisit(v, 3)}\n            >\n              {v}\n            </button>\n          ))}\n        </div>\n      )}\n      <ScoreNumberPad\n        value={scoreInput}\n        onChange={setScoreInput}\n        onSubmit={commitScore}\n        helperText=\"Tap numbers then press Enter to submit.\"\n      />\n      <div className=\"flex flex-wrap items-center gap-2\">\n        <button\n          className=\"btn\"\n          onClick={() => {\n            onEndLeg &&\n              onEndLeg(Math.max(0, safeScore), checkoutDarts, {\n                doubleDarts,\n              });\n            setScoreInput(\"0\");\n          }}\n        >\n          End Leg (Checkout {safeScore || 0}) ï¿½\n        </button>\n        <button\n          className=\"btn bg-slate-700 hover:bg-slate-800\"\n          onClick={() => onNextPlayer && onNextPlayer()}\n        >\n          Next Player ðŸ‘¤\n        </button>\n        <button\n          className=\"btn bg-emerald-600 hover:bg-emerald-700\"\n          onClick={() => {\n            onEndGame && onEndGame();\n          }}\n        >\n          End Game ï¿½\n        </button>\n      </div>\n      {showCheckoutSelectors && (\n        <div className=\"grid gap-3 text-sm\">\n          <div>\n            <div className=\"text-xs text-white/60 mb-1\">\n              Darts used at double\n            </div>\n            <div className=\"flex flex-wrap gap-2\">\n              {[0, 1, 2, 3].map((n) => (\n                <button\n                  key={`double-${n}`}\n                  className={`btn px-3 py-1 text-sm ${doubleDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                  onClick={() => setDoubleDarts(n)}\n                >\n                  {n}\n                </button>\n              ))}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-white/60 mb-1\">Darts at checkout</div>\n            <div className=\"flex flex-wrap gap-2\">\n              {[0, 1, 2, 3].map((n) => (\n                <button\n                  key={`checkout-${n}`}\n                  className={`btn px-3 py-1 text-sm ${checkoutDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                  onClick={() => setCheckoutDarts(n)}\n                >\n                  {n}\n                </button>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["DIGITS","ScoreNumberPad","value","onChange","onSubmit","disabled","label","helperText","maxLength","className","appendDigit","digit","next","trimmed","useEffect","isEditableTarget","target","el","tag","handler","e","jsxs","jsx","MatchControls","inProgress","_startingScore","_pendingEntries","onAddVisit","onUndo","onEndLeg","onNextPlayer","onEndGame","showDartsSelect","showCheckoutSelectors","quickButtons","scoreInput","setScoreInput","useState","darts","setDarts","checkoutDarts","setCheckoutDarts","doubleDarts","setDoubleDarts","parsedScore","safeScore","commitScore","Undo2","v","n"],"mappings":"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"}