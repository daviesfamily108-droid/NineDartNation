import{b as al,c as il,i as ll,d as ol,e as cl,j as e,G as dl,f as oi,u as Ie,h as _a,k as ul,l as ml,m as xl,r as hl,n as fl,B as St,o as bl,a as pl,p as Ga,q as za,s as gl,R as ws,t as vl,v as jl,w as Nl}from"./index-Dj7mIiiu.js";import{l as nn,R as Xa,m as yl,n as wl,Z as Sl,r}from"./ui-Vpbk6UnN.js";import{u as Cl,C as _,R as kl}from"./CameraView-DUD7umIa.js";import{M as Dl}from"./MatchStartShowcase-DcDlfoQh.js";import{u as Tl,a as Ss}from"./match-BLqxJLcc.js";import{M as Al}from"./MatchControls-DirKBMH4.js";import"./vendor-D3F3s8fL.js";import"./pendingVisit-BrAUqCO5.js";const Ll=["D1","D2","D3","D4","D5","D6","D7","D8","D9","D10","D11","D12","D13","D14","D15","D16","D17","D18","D19","D20","DB"];function Ml(s){return s==="DB"?50:Number(s.slice(1))*2}function Rl(s){return Ll.includes(s)?Ml(s):32}function El(s,a="D16"){if(s>170||s<=1)return[];const o={170:["T20 T20 DB"],167:["T20 T19 DB"],164:["T20 T18 DB"],161:["T20 T17 DB"],160:["T20 T20 D20"],158:["T20 T20 D19"],157:["T20 T19 D20"],156:["T20 T20 D18"],155:["T20 T19 D19"],154:["T20 T18 D20"],153:["T20 T19 D18"],152:["T20 T20 D16"],151:["T20 T17 D20"],150:["T20 T18 D18"],149:["T20 T19 D16"],148:["T20 T16 D20"],147:["T20 T17 D18"],146:["T20 T18 D16"],145:["T20 T15 D20"],144:["T20 T20 D12"],141:["T20 T19 D12"],140:["T20 T20 D10"],137:["T20 T19 D10"],136:["T20 T20 D8"],132:["BULL T14 D20","T20 T12 D8"],130:["T20 T20 D5","T20 T18 D8"],129:["T19 T16 D12"],128:["T18 T14 D16"],127:["T20 T17 D8"],126:["T19 T19 D6"],121:["T20 11 D20","T20 T15 D8"],120:["T20 20 D20","T20 S20 D20"],110:["T20 10 D20"],100:["T20 D20"],99:["T19 10 D16","T19 S10 D16"],97:["T19 D20"],96:["T20 D18"],95:["T19 D19"],94:["T18 D20"],92:["T20 D16"],90:["T18 D18","T20 D15"],86:["T18 D16"],84:["T20 D12","T16 D18"],82:["BULL D16","T14 D20"],81:["T19 D12"],80:["T20 D10","D20 D20"],78:["T18 D12"],76:["T20 D8","T16 D14"],74:["T14 D16","T18 D10"],72:["T16 D12","T20 D6"],70:["T18 D8","S20 BULL"],68:["T20 D4","T16 D10"],66:["T10 D18","T14 D12"],64:["T16 D8","D16 D16"],62:["T10 D16","T12 D13"],60:["20 D20","S20 D20"],58:["18 D20","S18 D20"],56:["16 D20","S16 D20"],54:["14 D20","S14 D20"],52:["20 D16","S20 D16"],50:["BULL","10 D20"],48:["16 D16","S16 D16"],46:["14 D16"],44:["12 D16"],42:["10 D16"],40:["D20"],38:["D19"],36:["D18"],34:["D17"],32:["D16"],30:["D15"],28:["D14"],26:["D13"],24:["D12"],22:["D11"],20:["D10"],18:["D9"],16:["D8"],14:["D7"],12:["D6"],10:["D5"],8:["D4"],6:["D3"],4:["D2"],2:["D1"]};if(o[s])return o[s];const m=Rl(a),i=[];for(const d of[60,57,54,51,48])if(s-d===m){i.push(`T${d/3} ${a}`);break}if(!i.length){for(const d of[20,19,18,17,16,15])if(s-d===m){i.push(`${d} ${a}`);break}}return i}function rn(s,a,o,m,i){try{const d=window.speechSynthesis;if(!d)return;const x=new SpeechSynthesisUtterance,k=o<=170&&o>0,F=a===180;if(!(!i?.checkoutOnly||k||F))return;if(F?(x.text=`${s}! One eighty!`,x.rate=1.04,x.pitch=1.15):k?(x.text=`${s}, ${o} remaining.`,x.rate=1,x.pitch=1):a===0?(x.text=`${s}, no score.`,x.rate=1,x.pitch=1):(x.text=`${s}, ${a}.`,x.rate=1,x.pitch=1),m){const I=d.getVoices().find(V=>V.name===m);I&&(x.voice=I)}typeof i?.volume=="number"?x.volume=Math.max(0,Math.min(1,i.volume)):x.volume=1;try{d.cancel()}catch{}d.speak(x)}catch{}}function Il({gameMode:s,compact:a=!1,onRecalibrate:o}){const{H:m,errorPx:i}=al(),d=il(s,i),x=ll(s,i),{quality:k,text:F}=ol(s,i),P=cl(s),I=dl[s];if(!m||!i)return a?e.jsxs("div",{className:"text-xs px-2 py-1 rounded bg-slate-600/40 text-slate-300 inline-flex items-center gap-1 border border-slate-500/30",children:[e.jsx(nn,{className:"w-3 h-3"}),"Not calibrated"]}):e.jsxs("div",{className:"px-3 py-2 rounded bg-red-500/20 border border-red-600/30 flex items-center gap-2",children:[e.jsx(nn,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-red-300",children:"Calibration Required"}),e.jsxs("div",{className:"text-xs opacity-80",children:["Please calibrate before playing ",s]})]}),o&&e.jsx("button",{className:"btn px-2 py-1 text-xs bg-red-600 hover:bg-red-700",onClick:o,children:"Calibrate"})]});const V=x?"bg-emerald-500/20 border-emerald-600/30":"bg-amber-500/20 border-amber-600/30",$=x?"text-emerald-300":"text-amber-300",y=x?yl:nn;return a?e.jsxs("div",{className:`text-xs px-2 py-1 rounded inline-flex items-center gap-1 border ${V} ${$}`,children:[Xa.createElement(y,{className:"w-3 h-3"}),e.jsx("span",{children:F}),!x&&P&&e.jsx("span",{className:"w-3 h-3 cursor-help",title:P,children:e.jsx(wl,{className:"w-3 h-3 inline"})})]}):e.jsxs("div",{className:`px-3 py-2 rounded border ${V} space-y-1`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Xa.createElement(y,{className:`w-4 h-4 ${x?"text-emerald-400":"text-amber-400"} flex-shrink-0`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:`font-medium ${x?"text-emerald-300":"text-amber-300"}`,children:["Calibration for ",s]}),e.jsxs("div",{className:"text-xs opacity-80",children:["Error: ",Math.round(i),"px | ",F]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1.5 rounded bg-black/30 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${x?"bg-emerald-500":"bg-amber-500"}`,style:{width:`${Math.min(100,d)}%`}})}),e.jsxs("span",{className:"text-xs font-mono",children:[Math.round(d),"%"]})]}),I&&e.jsx("div",{className:"text-xs opacity-75",children:e.jsxs("div",{children:["Tolerance: Â±",I.tolerancePx,"px | Min: ",I.minConfidence,"%"]})}),e.jsxs("div",{className:"space-y-1",children:[!x&&e.jsxs("div",{className:"text-xs px-2 py-1 rounded bg-amber-900/30 text-amber-200 border border-amber-600/20 flex items-center gap-1",children:[e.jsx(nn,{className:"w-3 h-3 flex-shrink-0"}),"Calibration quality is below minimum for ",s]}),P&&e.jsxs("div",{className:"text-xs px-2 py-1 rounded bg-blue-900/30 text-blue-200 border border-blue-600/20 flex items-center gap-1",children:[e.jsx(Sl,{className:"w-3 h-3 flex-shrink-0"}),P]})]}),!x&&o&&e.jsxs("button",{className:"w-full btn px-2 py-1 text-sm mt-2 bg-amber-600 hover:bg-amber-700",onClick:o,children:["Recalibrate for ",s]})]})}function qa({label:s,autoStart:a,scale:o,className:m,aspect:i="inherit",style:d,fill:x=!1}){const k=r.useRef(null),F=oi(),[P,I]=r.useState(!1),[V,$]=r.useState(null),[y,A]=r.useState(null),[X,N]=r.useState(null),te=r.useRef(null),se=r.useCallback((h,S="local")=>{try{h?(F.setMediaStream(h),k.current&&F.setVideoElementRef(k.current),F.setMode(S),F.setStreaming(!0),te.current=S):te.current&&te.current!=="phone"&&(F.setStreaming(!1),F.setMediaStream(null),te.current=null)}catch(C){console.warn("[CameraTile] Failed to register stream with camera session:",C)}},[F]),J=Ie(h=>h.preferredCameraLabel),[ue,ke]=r.useState(()=>J==="Phone Camera"?"phone":localStorage.getItem("ndn:camera:mode")||"local"),[Fe,De]=r.useState(null),[qe,Pe]=r.useState(!1),[Ye,me]=r.useState(null),[L,oe]=r.useState(null),[f,ut]=r.useState(!0),[E,He]=r.useState([]),[U,Je]=r.useState(!1),[Be,ne]=r.useState([]),[Qe,$e]=r.useState(!1),W=Ie(h=>h.autoscoreProvider),q=Ie(h=>h.cameraEnabled),G=Ie(h=>h.setPreferredCameraLocked),rt=Ie(h=>h.preferredCameraLocked),mt=Ie(h=>h.setPreferredCamera),xt=Ie(h=>h.preferredCameraId);if(W==="manual"){const S=[x?"rounded-2xl overflow-hidden bg-black w-full flex flex-col":"rounded-2xl overflow-hidden bg-black w-full mx-auto",m].filter(Boolean).join(" ").trim(),C={...d||{}};return!x&&C.aspectRatio===void 0&&C.height===void 0&&C.minHeight===void 0&&(C.aspectRatio="4 / 3"),e.jsx("div",{className:S,style:C,children:e.jsx("div",{className:"flex-1 w-full h-full flex items-center justify-center bg-slate-900 text-slate-200 text-xs p-4 text-center",children:"Manual scoring mode active â€” camera feeds are disabled."})})}r.useEffect(()=>{const h=window.location.hostname;(h==="localhost"||h==="127.0.0.1")&&_a("/api/hosts").then(S=>S.json()).then(S=>{const C=Array.isArray(S?.hosts)&&S.hosts.find(D=>D);C&&me(C)}).catch(()=>{}),_a("/api/https-info").then(S=>S.json()).then(S=>{S&&typeof S.https=="boolean"&&oe({https:!!S.https,port:Number(S.port)||8788})}).catch(()=>{})},[]);const kt=r.useMemo(()=>{const h=y||"____",S="ws://localhost:8787";if(S.length>0)try{const Re=new URL(S);return`${`${Re.protocol==="wss:"?"https":"http"}://${Re.host}${Re.pathname.endsWith("/ws")?"":Re.pathname}`.replace(/\/?ws$/i,"")}/mobile-cam.html?code=${h}`}catch{}const C=Ye||window.location.hostname,D=!!L?.https,H=D?L?.port||8788:8787;return`${D?"https":"http"}://${C}:${H}/mobile-cam.html?code=${h}`},[y,Ye,L]);r.useEffect(()=>{localStorage.setItem("ndn:camera:mode",ue)},[ue]);const[z,Ze]=r.useState(null);r.useEffect(()=>{Ie.getState().ignorePreferredCameraSync||z&&Date.now()-z<3e4||J==="Phone Camera"&&ue!=="phone"&&ke("phone")},[J,ue,z]),r.useEffect(()=>{if(!(!q||W&&W!=="built-in"&&W!=="external-ws")&&a!==void 0){if(a){let h=!1;const S=J||"default",C=window.setTimeout(()=>{h||P||Te().catch(D=>console.warn(`[CameraTile] Auto-start failed for ${S}:`,D))},200);return()=>{h=!0,window.clearTimeout(C)}}Q()}},[a,P,q,W,J,Te,Q]),r.useEffect(()=>{const h=async()=>{try{if(!(J==="Phone Camera"&&(!z||Date.now()-z>=3e4)||ue==="phone"))return;const D=F.getMediaStream(),H=k.current;if(!H||!D)return;H.srcObject!==D&&(H.srcObject=D),H.muted=!0,H.playsInline=!0;try{await H.play()}catch{}I(!0)}catch{}};h();const S=setInterval(h,800);return()=>clearInterval(S)},[J,ue,F,F.isStreaming]);async function Te(){if(ue==="wifi")return M();if(J==="Phone Camera"||ue==="phone"){const h=F.getMediaStream();if(h&&k.current)try{k.current.srcObject=h,await k.current.play(),I(!0);return}catch{}if(ue==="phone")try{await Ve();return}catch{}}try{const{preferredCameraId:h,setPreferredCamera:S}=Ie.getState(),C=h?{video:{deviceId:{exact:h}},audio:!1}:{video:!0,audio:!1};let D;try{D=await navigator.mediaDevices.getUserMedia(C)}catch(H){const Ae=H&&(H.name||H.code)||"";if(h&&(Ae==="OverconstrainedError"||Ae==="NotFoundError"))D=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});else throw H}k.current&&(k.current.srcObject=D,await k.current.play(),I(!0),se(D,"local"))}catch{}}function Q(){k.current&&k.current.srcObject&&(k.current.srcObject.getTracks().forEach(S=>S.stop()),k.current.srcObject=null,I(!1),se(null))}async function M(){Je(!0);try{const h=await ul();He(h),h.length===0&&alert("No wifi scoring devices found on your network. Make sure devices are powered on and connected to the same network.")}catch(h){console.error("Wifi device discovery failed:",h),alert("Failed to discover wifi devices. Please check your network connection.")}finally{Je(!1)}}async function re(h){try{He(C=>C.map(D=>D.id===h.id?{...D,status:"connecting"}:D));const S=await ml(h);if(S&&k.current)k.current.srcObject=S,await k.current.play(),I(!0),se(S,"wifi"),He(C=>C.map(D=>D.id===h.id?{...D,status:"online"}:D));else throw new Error("Failed to get video stream")}catch(S){console.error("Failed to connect to wifi device:",S),alert(`Failed to connect to ${h.name}. Please check the device and try again.`),He(C=>C.map(D=>D.id===h.id?{...D,status:"offline"}:D))}}async function ve(){$e(!0);try{const h=await xl();ne(h);const S=await hl();S&&ne(C=>[...C,S]),h.length===0&&!S&&alert("No USB scoring devices found. Please connect a device and try again.")}catch(h){console.error("USB device discovery failed:",h),alert("Failed to discover USB devices. Please check device connections.")}finally{$e(!1)}}async function Cs(h){try{ne(C=>C.map(D=>D.id===h.id?{...D,status:"connecting"}:D));const S=await fl(h);if(S&&k.current)k.current.srcObject=S,await k.current.play(),I(!0),ke("wifi"),se(S,"wifi"),ne(C=>C.map(D=>D.id===h.id?{...D,status:"online"}:D));else throw new Error("Failed to get video stream")}catch(S){console.error("Failed to connect to USB device:",S),alert(`Failed to connect to ${h.name}. Please check the device and try again.`),ne(C=>C.map(D=>D.id===h.id?{...D,status:"offline"}:D))}}const Dt=r.useCallback(h=>{try{ke(h==="usb"?"wifi":h),Ze(Date.now());try{if(h==="local"){try{mt(xt,"Local",!0)}catch{}try{G(!0)}catch{}}else if(h==="phone"){try{mt(void 0,"Phone Camera",!0)}catch{}try{G(!0)}catch{}}else if(h==="wifi"||h==="usb"){try{mt(void 0,"WiFi/USB",!0)}catch{}try{G(!0)}catch{}}}catch{}h==="local"?Te().catch(()=>{}):h==="phone"?Ve():h==="wifi"?M():h==="usb"&&ve()}catch(S){console.warn("[CameraTile] handleModeSelect failed",S)}},[Te,Ve,M,ve,mt,G,xt]);r.useEffect(()=>{const h=S=>{try{const C=S&&S.detail&&S.detail.mode;C&&["local","phone","wifi","usb"].includes(C)?(Dt(C),Te().catch(()=>{})):Te().catch(()=>{})}catch{}};return window.addEventListener("ndn:start-camera",h),()=>{window.removeEventListener("ndn:start-camera",h)}},[Te,Dt]);function le(){if(V&&V.readyState===WebSocket.OPEN)return V;const h="ws://localhost:8787",S=h.length>0?h.endsWith("/ws")?h:h.replace(/\/$/,"")+"/ws":void 0,C=window.location.protocol==="https:"?"wss":"ws",D=`${C}://${window.location.host}/ws`,H=window.location.hostname,Ae=H==="localhost"||H==="127.0.0.1",Re=H.endsWith("onrender.com"),ks="wss://ninedartnation.onrender.com/ws";let ce=S;ce||(Ae?ce=`${C}://${H}:8787/ws`:Re?ce=D:ce=ks),ce||(ce=D);const ht=new WebSocket(ce);return $(ht),ht}async function Ve(){ke("phone"),Pe(!1);const h=le();h.readyState===WebSocket.OPEN?h.send(JSON.stringify({type:"cam-create"})):h.onopen=()=>h.send(JSON.stringify({type:"cam-create"})),h.onmessage=async S=>{const C=JSON.parse(S.data);if(C.type==="cam-code")A(C.code),C.expiresAt&&De(C.expiresAt);else if(C.type==="cam-peer-joined"){Pe(!0);const D=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});N(D),D.onicecandidate=Ae=>{Ae.candidate&&y&&h.send(JSON.stringify({type:"cam-ice",code:y,payload:Ae.candidate}))},D.ontrack=Ae=>{if(k.current){const Re=Ae.streams?.[0];Re&&(k.current.srcObject=Re,k.current.play().catch(()=>{}),I(!0))}};const H=await D.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!0});await D.setLocalDescription(H),y&&h.send(JSON.stringify({type:"cam-offer",code:y,payload:H}))}else if(C.type==="cam-answer")X&&await X.setRemoteDescription(new RTCSessionDescription(C.payload));else if(C.type==="cam-ice"&&X)try{await X.addIceCandidate(C.payload)}catch{}}}function Tt(){A(null),De(null),Pe(!1),V&&V.readyState===WebSocket.OPEN?V.send(JSON.stringify({type:"cam-create"})):Ve();try{G(!0)}catch{}}function xe(){if(Q(),A(null),Pe(!1),De(null),X){try{X.close()}catch{}N(null)}}return e.jsx(Fl,{label:s,autoStart:a,start:Te,stopAll:xe,startPhonePairing:Ve,startWifiConnection:M,startUsbConnection:ve,connectToWifiDevice:re,connectToUsbDevice:Cs,videoRef:k,streaming:P,mode:ue,setMode:ke,pairCode:y,mobileUrl:kt,regenerateCode:Tt,httpsInfo:L,showTips:f,setShowTips:ut,wifiDevices:E,usbDevices:Be,discoveringWifi:U,discoveringUsb:Qe,scaleOverride:o,className:m,aspect:i,style:d,fill:x,onModeSelect:Dt,preferredCameraLocked:rt})}function Fl(s){const a=oi(),{cameraScale:o,cameraAspect:m}=Ie(),{label:i,start:d,stopAll:x,startPhonePairing:k,startWifiConnection:F,startUsbConnection:P,connectToWifiDevice:I,connectToUsbDevice:V,videoRef:$,streaming:y,mode:A,setMode:X,onModeSelect:N,pairCode:te,mobileUrl:se,regenerateCode:J,httpsInfo:ue,showTips:ke,setShowTips:Fe,wifiDevices:De,usbDevices:qe,discoveringWifi:Pe,discoveringUsb:Ye,className:me,aspect:L,style:oe,fill:f,preferredCameraLocked:ut}=s,E={local:"Local",phone:"PhoneCam",wifi:"Wi-Fi/USB"},He=r.useMemo(()=>[{id:"local",title:"Local camera",description:"Use the desktop webcam or capture card.",action:()=>{N&&N("local")}},{id:"phone",title:"PhoneCam",description:"Stream from your phone via the mobile link.",action:()=>{N&&N("phone")}},{id:"wifi",title:"Wi-Fi/USB",description:"Connect to scoring devices on your local network.",action:()=>{N&&N("wifi")}},{id:"usb",title:"USB",description:"Connect a USB capture device (treated like WiFi mode).",action:()=>{N&&N("usb")}}],[X,d,k,F,P]),[U,Je]=r.useState(null),Be=r.useRef(null);r.useEffect(()=>()=>{Be.current&&window.clearTimeout(Be.current)},[]);const{cameraFitMode:ne}=Ie(),Qe=f?"fill":ne||"fill",$e=(()=>{const M=Number(s.scaleOverride??o??1),re=Math.max(.5,Math.min(1.25,M));return Qe==="fill"?Math.max(1,re):re})(),W=f&&Qe==="fill"?"free":L&&L!=="inherit"?L:m||"wide",q=W!=="free",G=q?W==="square"?"aspect-square":W==="portrait"?"aspect-[3/4]":W==="classic"?"aspect-[4/3]":"aspect-video":"",mt=[f?"rounded-3xl overflow-hidden bg-transparent w-full flex flex-col shadow-2xl border border-slate-700/30":"rounded-3xl overflow-hidden bg-transparent w-full mx-auto flex flex-col shadow-2xl border border-slate-700/30",me].filter(Boolean).join(" ").trim(),xt={...oe||{}},kt=f?"relative flex-1 min-h-[420px] bg-black":"relative w-full bg-black",z={style:{transform:`scale(${$e})`,transformOrigin:"center"}},Ze=A==="wifi"&&qe.some(M=>M.status==="online"),Te=(()=>{const re=Qe==="fit"?"absolute inset-0 w-full h-full object-contain object-center bg-transparent":"absolute inset-0 w-full h-full object-cover object-center bg-transparent";return f?q?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:`relative w-full max-w-full max-h-full ${G}`,children:e.jsx("video",{ref:$,className:re,...z})})}):e.jsx("video",{ref:$,className:re,...z}):q?e.jsx("div",{className:`relative w-full ${G}`,children:e.jsx("video",{ref:$,className:re,...z})}):e.jsx("video",{ref:$,className:re,...z})})();async function Q(M,re){if(M)try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(M);else{const ve=document.createElement("textarea");ve.value=M,ve.style.position="fixed",ve.style.opacity="0",document.body.appendChild(ve),ve.focus(),ve.select(),document.execCommand("copy"),document.body.removeChild(ve)}Je(re),Be.current&&window.clearTimeout(Be.current),Be.current=window.setTimeout(()=>Je(null),1500)}catch(ve){console.warn("Copy to clipboard failed:",ve),Je(null)}}return e.jsxs("div",{className:mt,style:xt,children:[e.jsxs("div",{className:kt,children:[Te,a.isStreaming&&A==="phone"&&e.jsxs("div",{className:"absolute top-4 left-4 z-10 flex items-center gap-2 px-3 py-1.5 rounded-full bg-black/70 backdrop-blur border border-rose-500/60 text-xs text-rose-200 font-semibold shadow-lg",children:[e.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full bg-rose-500 animate-pulse"}),e.jsx("span",{children:"REC"})]})]}),e.jsxs("div",{className:"px-3 py-2 flex items-center justify-between bg-gradient-to-r from-slate-900 to-slate-800 text-white text-[11px] gap-2 border-t border-slate-700/50",children:[e.jsxs("span",{className:"truncate font-medium",children:[i||(y?A==="phone"?"PHONE LIVE":A==="wifi"?"WIFI LIVE":"LIVE":"Camera"),ut&&e.jsx("span",{className:"ml-2 text-xs opacity-80",children:"ðŸ”’"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!y&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-semibold transition-all ${A==="local"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-200 hover:bg-slate-600"}`,onClick:()=>N("local"),children:"Local"}),e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-semibold transition-all ${A==="phone"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-200 hover:bg-slate-600"}`,onClick:()=>N("phone"),children:"Phone"}),e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-semibold transition-all ${A==="wifi"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-200 hover:bg-slate-600"}`,onClick:()=>N("wifi"),children:"WiFi"}),e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-semibold transition-all ${A==="wifi"?"bg-emerald-500 text-white":"bg-slate-700 text-slate-200 hover:bg-slate-600"}`,onClick:()=>N("usb"),children:"USB"})]}),y?e.jsx("button",{className:"px-2 py-1 rounded-md text-xs font-semibold bg-rose-500 text-white hover:bg-rose-600 transition-all",onClick:x,children:"Stop"}):null]})]}),A==="phone"&&te&&!y&&e.jsxs("div",{className:"p-2 text-white text-[10px] bg-black/50",children:[e.jsx("div",{className:"text-xs opacity-80",children:"Launch on your mobile:"}),e.jsxs("button",{type:"button",className:"mt-1 w-full text-left px-2 py-1 rounded bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center gap-2",onClick:()=>Q(se,"link"),title:"Copy mobile camera link",children:[e.jsx("span",{className:"flex-1 min-w-0 font-mono break-all",children:se}),e.jsx("span",{className:"text-[9px] uppercase tracking-wide whitespace-nowrap text-emerald-200",children:U==="link"?"Copied!":"Copy"})]}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("a",{href:se,target:"_blank",rel:"noreferrer",className:"px-2 py-1 rounded border border-indigo-500/30 text-indigo-100 hover:bg-indigo-500/20 transition",children:"Open link"}),e.jsxs("button",{type:"button",className:"flex-1 text-left px-2 py-1 rounded bg-white/5 border border-white/10 hover:bg-white/10 transition flex items-center justify-between gap-2",onClick:()=>Q(te,"code"),title:"Copy pairing code",children:[e.jsx("span",{className:"font-mono tracking-[0.3em] text-sm",children:te}),e.jsx("span",{className:"text-[9px] uppercase tracking-wide whitespace-nowrap text-emerald-200",children:U==="code"?"Copied!":"Copy"})]})]}),e.jsx("div",{className:"mt-1 flex items-center gap-2",children:e.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700",onClick:J,children:"Regenerate"})}),ke&&e.jsxs("div",{className:"mt-2 p-2 rounded bg-slate-900/60 border border-slate-700/50 text-slate-200",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Troubleshooting"}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[e.jsx("li",{children:"Phone and desktop must be on the same Wiâ€‘Fi network."}),e.jsxs("li",{children:["Allow the server through your firewall (ports 8787 and ",ue?.https?ue.port:8788,")."]}),e.jsx("li",{children:"On iPhone, use HTTPS links (QR will prefer https when enabled)."})]}),e.jsx("div",{className:"mt-2 text-right",children:e.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>Fe(!1),children:"Hide tips"})})]})]}),A==="wifi"&&!y&&e.jsxs("div",{className:"p-2 text-white text-[10px] bg-black/50",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Scoring Devices"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"font-medium mb-1",children:"WiFi Devices"}),Pe?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),e.jsx("span",{children:"Scanning network..."})]}):De.length>0?e.jsxs("div",{className:"space-y-1",children:[De.map(M=>e.jsxs("div",{className:"flex items-center justify-between p-1 rounded bg-slate-900/60",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:M.name}),e.jsxs("div",{className:"opacity-70 text-[9px]",children:[M.ip,":",M.port]})]}),e.jsx("button",{className:`px-1 py-0.5 rounded text-[9px] ${M.status==="connecting"?"bg-yellow-600":M.status==="online"?"bg-green-600":"bg-blue-600"}`,onClick:()=>I(M),disabled:M.status==="connecting",children:M.status==="connecting"?"...":"Connect"})]},M.id)),e.jsx("div",{className:"text-center mt-2",children:e.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:F,children:"Rescan WiFi"})})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-1 opacity-70",children:"No WiFi devices found"}),e.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:F,children:"Scan WiFi"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium mb-1",children:"USB Devices"}),Ye?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),e.jsx("span",{children:"Scanning USB..."})]}):qe.length>0?e.jsxs("div",{className:"space-y-1",children:[qe.map(M=>e.jsxs("div",{className:"flex items-center justify-between p-1 rounded bg-slate-900/60",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:M.name}),e.jsx("div",{className:"opacity-70 text-[9px]",children:M.type.toUpperCase()})]}),e.jsx("button",{className:`px-1 py-0.5 rounded text-[9px] ${M.status==="connecting"?"bg-yellow-600":M.status==="online"?"bg-green-600":"bg-blue-600"}`,onClick:()=>V(M),disabled:M.status==="connecting",children:M.status==="connecting"?"...":"Connect"})]},M.id)),e.jsx("div",{className:"text-center mt-2",children:e.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:P,children:"Rescan USB"})})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-1 opacity-70",children:"No USB devices found"}),e.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700 text-[9px]",onClick:P,children:"Scan USB"})]})]})]}),!y&&e.jsxs("div",{className:"mt-3 p-3 rounded-2xl bg-white border border-slate-200 shadow-sm text-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-500",children:"Camera modes"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reconnect camera"})]}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Current: ",E[A]||"Local"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Tap a mode to restart the feed or switch inputs."}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:He.map(M=>{const re=M.id==="usb"?Ze:M.id===A;return e.jsxs("button",{type:"button",onClick:M.action,className:`text-left p-3 rounded-2xl border ${re?"border-emerald-500 bg-emerald-50 shadow":"border-slate-200 bg-white/80 hover:bg-slate-50"} transition`,children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:M.title}),e.jsx("div",{className:"text-[11px] text-slate-600 mt-1",children:M.description}),re&&e.jsx("div",{className:"text-[10px] text-emerald-500 mt-2",children:"Active"})]},M.id)})})]})]})}function Ya(s,a,o,m){const i=(m-90)*Math.PI/180;return{x:s+o*Math.cos(i),y:a+o*Math.sin(i)}}function Ja(s){return[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5].indexOf(s)*18+9}function Pl({width:s=320,height:a=320}){const o=Cl(i=>i.samples),m=r.useRef(null);return r.useEffect(()=>{const i=m.current;if(!i)return;const d=i.getContext("2d");if(!d)return;i.width=s,i.height=a,d.clearRect(0,0,s,a);const x=s/2,k=a/2,F=Math.min(s,a)/(St.doubleOuter*2+20),P={bullInner:St.bullInner*F,bullOuter:St.bullOuter*F,trebleInner:St.trebleInner*F,trebleOuter:St.trebleOuter*F,doubleInner:St.doubleInner*F,doubleOuter:St.doubleOuter*F};d.strokeStyle="rgba(255,255,255,0.06)",d.lineWidth=1;const I=["doubleOuter","doubleInner","trebleOuter","trebleInner","bullOuter","bullInner"];for(const y of I)d.beginPath(),d.arc(x,k,P[y],0,Math.PI*2),d.stroke();const V=[];for(const y of o){let A=Math.random()*360,X=Math.random()*P.doubleOuter;typeof y.sector=="number"&&y.sector>=1&&y.sector<=20&&(A=Ja(y.sector),y.ring==="DOUBLE"?X=(P.doubleInner+P.doubleOuter)/2:y.ring==="TRIPLE"?X=(P.trebleInner+P.trebleOuter)/2:y.ring==="INNER_BULL"?X=P.bullInner*.5:y.ring==="BULL"?X=P.bullOuter*.8:X=(P.trebleOuter+P.doubleInner)/2*(.6+Math.random()*.4));const N=Ya(x,k,X,A);V.push({x:N.x,y:N.y,w:1})}for(const y of V){const A=d.createRadialGradient(y.x,y.y,1,y.x,y.y,60);A.addColorStop(0,"rgba(255,0,0,0.9)"),A.addColorStop(.3,"rgba(255,100,0,0.5)"),A.addColorStop(1,"rgba(255,100,0,0)"),d.fillStyle=A,d.beginPath(),d.arc(y.x,y.y,60,0,Math.PI*2),d.fill()}d.fillStyle="rgba(255,255,255,0.85)",d.font="12px ui-sans-serif";const $={};for(const y of o)y.sector&&($[y.sector]=($[y.sector]||0)+1);for(const y of Object.keys($)){const A=Number(y),X=Ja(A),N=Ya(x,k,P.trebleOuter+18,X);d.fillText(String($[A]),N.x-6,N.y+4)}},[o,s,a]),e.jsx("canvas",{ref:m,style:{width:"100%",height:"auto",borderRadius:8,background:"#081018"}})}const an=[...Array.from({length:20},(s,a)=>({label:`D${a+1}`,score:(a+1)*2})),{label:"DBULL",score:50,isBull:!0}];function Qa(s,a){const o=an[a];return!!o&&s===o.score}function Xt(s){const a=s.trim().toUpperCase();if(!a)return null;if(a==="50"||a==="BULL"||a==="DBULL"||a==="IBULL")return 50;if(a==="25"||a==="OBULL")return 25;const o=a.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!o)return null;const m=o[1]||"S",i=parseInt(o[2],10);return i<1||i>20?null:i*(m==="S"?1:m==="D"?2:3)}const dt=[...Array.from({length:20},(s,a)=>a+1),25,50],mr=[20,19,18,17,16,15,25];function tr(){const s={};return mr.forEach(a=>{s[a]=0}),{marks:s,points:0}}function Bl(s,a,o,m,i=()=>!1){let d=null,x=0;if(o==="BULL"||o==="INNER_BULL"||a===25||a===50)d=25,x=o==="INNER_BULL"||a===50?2:1;else if(typeof m=="number"&&m>=15&&m<=20)d=m,o==="TRIPLE"?x=3:o==="DOUBLE"?x=2:x=1;else if(a){const y=[20,19,18,17,16,15];for(const A of y){if(a===A){d=A,x=1;break}if(a===A*2){d=A,x=2;break}if(a===A*3){d=A,x=3;break}}!d&&(a===25||a===50)&&(d=25,x=a===50?2:1)}if(!d)return 0;const k=s.marks[d];let F=Math.max(0,3-k);const P=Math.min(F,x),I=Math.max(0,x-P),V=k+P;s.marks[d]=V>3?3:V;let $=0;return I>0&&!i(d)&&(d===25?o==="INNER_BULL"?$+=50*I:$+=25*I:$+=d*I),s.points+=$,$}function Ol(s){return mr.every(a=>(s.marks[a]||0)>=3)}function sr(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function Ul(s){return s.round}function Hl(s,a,o,m){if(s.finished)return 0;const i=Ul(s);let d=0;return typeof m=="number"&&m===i?o==="TRIPLE"?(d=i*3,s.turnHits.triples++):o==="DOUBLE"?(d=i*2,s.turnHits.doubles++):o==="SINGLE"&&(d=i*1,s.turnHits.singles++):!m&&(a===i||a===i*2||a===i*3)&&(a===i*3?(d=i*3,s.turnHits.triples++):a===i*2?(d=i*2,s.turnHits.doubles++):a===i&&(d=i,s.turnHits.singles++)),s.score+=d,d}function $l(s){if(!s.finished){if(s.turnHits.singles>0&&s.turnHits.doubles>0&&s.turnHits.triples>0){s.shanghaiAchieved=!0,s.finished=!0;return}const a=s.round+1;a>20?s.finished=!0:s.round=a}s.turnHits={singles:0,doubles:0,triples:0}}function nr(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function ci(s){return s.targets[s.stage]||null}function Vl(s,a,o,m){if(s.finished)return 0;const i=ci(s);if(!i)return 0;let d=0;switch(i.kind){case"NUMBER":{typeof m=="number"&&m===i.num?o==="TRIPLE"?d=i.num*3:o==="DOUBLE"?d=i.num*2:o==="SINGLE"&&(d=i.num):!m&&(a===i.num||a===i.num*2||a===i.num*3)&&(d=a),d>0&&(s.hitThisRound=!0);break}case"DOUBLE":{(o==="DOUBLE"&&m===i.num||a===i.num*2)&&(d=i.num*2,s.hitThisRound=!0);break}case"TRIPLE":{(o==="TRIPLE"&&m===i.num||a===i.num*3)&&(d=i.num*3,s.hitThisRound=!0);break}case"BULL":{(o==="BULL"||o==="INNER_BULL"||a===25||a===50)&&(d=o==="INNER_BULL"||a===50?50:25,s.hitThisRound=!0);break}case"ANY_NUMBER":{a>0&&(d=a,s.hitThisRound=!0);break}}return s.score+=d,d}function Wl(s){s.finished||(s.hitThisRound||(s.score=Math.floor(s.score/2)),s.hitThisRound=!1,s.stage+=1,s.stage>=s.targets.length&&(s.finished=!0))}function rr(){return{round:1,score:0,target:"HIGH",finished:!1}}function Kl(s,a,o,m){if(s.finished)return 0;let i=0;if(s.target==="HIGH")if(o==="INNER_BULL")i=50;else if(typeof m=="number"){const x=m*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);m>=20&&(i=x)}else a>=40&&(i=a);else if(typeof m=="number"){const x=m*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);m<=10&&(i=x)}else a>0&&a<=30&&(i=a);return s.score+=i,i}function _l(s){if(!s.finished){if(s.round+=1,s.round>10){s.finished=!0;return}s.target=s.target==="HIGH"?"LOW":"HIGH"}}function Gl(s,a=3){return{number:s,lives:a,isKiller:!1,eliminated:!1}}function zl(s){const a=Array.from({length:20},(m,i)=>i+1),o={};for(const m of s){const i=Math.floor(Math.random()*a.length),d=a.splice(i,1)[0];o[m]=d}return o}function Za(s,a,o,m){const i=a[s];if(!i||!m||!o)return{becameKiller:!1};if(!i.isKiller&&o==="DOUBLE"&&m===i.number)return i.isKiller=!0,{becameKiller:!0};if(i.isKiller&&(o==="DOUBLE"||o==="TRIPLE")){const d=Object.keys(a).find(x=>x!==s&&!a[x].eliminated&&a[x].number===m);if(d){const x=a[d],k=o==="TRIPLE"?2:1;return x.lives=Math.max(0,x.lives-k),x.lives===0&&(x.eliminated=!0),{becameKiller:!1,victimId:d,livesRemoved:k}}}return{becameKiller:!1}}function ei(s){const a=Object.entries(s).filter(([,o])=>!o.eliminated&&o.lives>0);return a.length===1?a[0][0]:null}function ti(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function Xl(s,a,o,m){if(s.finished)return 0;let i=0;if(typeof m=="number"&&m===s.inning?o==="TRIPLE"?i=3:o==="DOUBLE"?i=2:i=1:!m&&(a===s.inning||a===s.inning*2||a===s.inning*3)&&(i=a===s.inning*3?3:a===s.inning*2?2:1),s.score+=i,s.dartsThisInning+=1,s.dartsThisInning>=3){const d=s.inning+1;d>9?s.finished=!0:(s.inning=d,s.dartsThisInning=0)}return i}const ql={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function si(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function Yl(s,a,o,m){if(s.finished)return!1;const i=ql[s.hole];if(s.dartsThisHole+=1,typeof m=="number"&&m===i&&(o==="SINGLE"||o==="DOUBLE"||o==="TRIPLE")||!m&&(a===i||a===i*2||a===i*3)){s.strokes+=s.dartsThisHole;const x=s.hole+1;return x>18?s.finished=!0:(s.hole=x,s.dartsThisHole=0),!0}if(s.dartsThisHole>=3){s.strokes+=3;const x=s.hole+1;x>18?s.finished=!0:(s.hole=x,s.dartsThisHole=0)}return!1}const di={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function ni(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function Jl(s){const a=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[o,m,i]of a)if(s[o]&&s[o]===s[m]&&s[o]===s[i])return s[o];return s.every(o=>o)?"Draw":null}function Ql(s,a,o,m,i){if(s.finished||s.board[a])return!1;const d=di[a];let x=!1;if(d.type==="BULL"?x=m==="BULL"||m==="INNER_BULL"||o===25||o===50:d.type==="NUM"&&typeof d.num=="number"&&(typeof i=="number"&&i===d.num||!i&&(o===d.num||o===d.num*2||o===d.num*3))&&(x=!0),!x)return!1;s.board[a]=s.turn;const k=Jl(s.board);return k?(s.finished=!0,s.winner=k,!0):(s.turn=s.turn==="X"?"O":"X",!0)}function ir(){return{targetIndex:0,darts:0,finished:!1}}const ui=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],ar=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function Zl(s){return ui[s.targetIndex]}function lr(s,a,o){if(s.finished)return s;const m=Zl(s);if(!(o==="SINGLE"&&a===m||o==="DOUBLE"&&a===m||o==="TRIPLE"&&a===m||o==="INNER_BULL"&&m===25))return s;const d=s.targetIndex+1,x=d>=ui.length;return{targetIndex:d,darts:s.darts+1,finished:x}}function ri(s,a){return lr(s,a,"SINGLE")}function eo(){return ir()}function or(s=50){return{score:0,darts:0,finished:!1,target:s}}const to=[5,10,15,20,25,50];function so(s){return to.includes(s)}function cr(s,a,o){if(s.finished)return s;if(!so(a))return{...s,darts:s.darts+1};const m=s.score+a,i=m>=s.target;return{score:i?s.target:m,darts:s.darts+1,finished:i,target:s.target}}function ai(s,a){return cr(s,a)}function no(s=50){return or(s)}function dr(s=70){return{score:0,darts:0,finished:!1,target:s}}const ro=[7,14,21];function ao(s){return ro.includes(s)}function ur(s,a,o){if(s.finished)return s;if(!ao(a))return{...s,darts:s.darts+1};const m=s.score+a,i=m>=s.target;return{score:i?s.target:m,darts:s.darts+1,finished:i,target:s.target}}function ii(s,a){return ur(s,a)}function io(s=70){return dr(s)}const xr=[20,19,18,17,16,15,14,13,12,25];function li(){const s={};return xr.forEach(a=>{s[a]=0}),{marks:s,points:0}}function lo(s,a,o,m,i=()=>!1){let d=null,x=0;if(o==="BULL"||o==="INNER_BULL"||a===25||a===50)d=25,x=o==="INNER_BULL"||a===50?2:1;else if(typeof m=="number"&&m>=12&&m<=20)d=m,o==="TRIPLE"?x=3:o==="DOUBLE"?x=2:x=1;else if(a){for(const y of[20,19,18,17,16,15,14,13,12]){if(a===y){d=y,x=1;break}if(a===y*2){d=y,x=2;break}if(a===y*3){d=y,x=3;break}}!d&&(a===25||a===50)&&(d=25,x=a===50?2:1)}if(!d)return 0;const k=s.marks[d],F=Math.max(0,3-k),P=Math.min(F,x),I=Math.max(0,x-P),V=k+P;s.marks[d]=V>3?3:V;let $=0;return I>0&&!i(d)&&(d===25?o==="INNER_BULL"?$+=50*I:$+=25*I:$+=d*I),s.points+=$,$}function oo(s){return xr.every(a=>(s.marks[a]||0)>=3)}function co({left:s,right:a,className:o="",sticky:m=!0}){return e.jsxs("div",{className:`${m?"sticky top-0":""} card relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm ${o}`,children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),e.jsx("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:s}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:a})]})}function ze({gameMode:s,players:a,matchScore:o,gameRules:m}){return!a||a.length===0?null:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-3",children:a.map((i,d)=>e.jsxs("div",{className:`rounded-lg border p-3 ${i.isCurrentTurn?"border-emerald-500/40 bg-emerald-500/10":"border-slate-500/40 bg-slate-500/10"}`,children:[e.jsx("div",{className:`text-sm font-semibold mb-2 uppercase tracking-wide ${i.isCurrentTurn?"text-emerald-300":"text-slate-300"}`,children:i.name}),e.jsxs("div",{className:"space-y-1 text-sm",children:[s==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Legs Won",value:`â— ${i.legsWon||0}`,highlight:!0}),e.jsx(B,{label:"Score",value:i.score||0,mono:!0,bold:!0}),e.jsx(B,{label:"Last Score",value:i.lastScore||"0",mono:!0}),e.jsx(B,{label:"C/Out Rate",value:`${i.checkoutRate||0}%`,mono:!0}),e.jsx(B,{label:"Best Leg",value:i.bestLeg||"â€”",mono:!0}),i.matchAvg!==void 0&&i.allTimeAvg!==void 0&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-t border-white/20 pt-1 mt-1",children:[e.jsx(B,{label:"Match Avg",value:i.matchAvg.toFixed(2),mono:!0,bold:!0,highlight:i.matchAvg>0}),e.jsx(uo,{matchAvg:i.matchAvg,allTimeAvg:i.allTimeAvg})]})})]}),(s==="Cricket"||s==="American Cricket")&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Closed",value:mo(i.closed),mono:!0}),e.jsx(B,{label:"Points",value:i.points||0,mono:!0,bold:!0}),e.jsx(B,{label:"Status",value:xo(i),highlight:i.isCurrentTurn})]}),(s==="Shanghai"||s==="Halve It")&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:s==="Shanghai"?"Round":"Stage",value:i.round||1,mono:!0}),e.jsx(B,{label:"Target",value:i.target||"â€”",mono:!0}),e.jsx(B,{label:"Score",value:i.score||0,mono:!0,bold:!0})]}),s==="Killer"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Target #",value:i.number||"â€”",mono:!0,bold:!0}),e.jsx(B,{label:"Lives",value:i.lives||0,mono:!0,bold:!0}),i.eliminated&&e.jsx(B,{label:"Status",value:"ELIMINATED",highlight:!1})]}),s==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Round",value:i.round||1,mono:!0}),e.jsx(B,{label:"Target",value:i.target||"High",mono:!0}),e.jsx(B,{label:"Score",value:i.score||0,mono:!0,bold:!0})]}),(s==="Double Practice"||s==="Treble Practice"||s==="Around the Clock")&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Target",value:i.target||"â€”",mono:!0,bold:!0}),e.jsx(B,{label:"Hits",value:i.hits||0,mono:!0,bold:!0}),i.totalNeeded&&e.jsx(B,{label:"Progress",value:`${i.hits||0} / ${i.totalNeeded}`,mono:!0})]}),(s==="Count-Up"||s==="High Score"||s==="Low Score")&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Round",value:i.round||1,mono:!0}),e.jsx(B,{label:"Score",value:i.score||0,mono:!0,bold:!0}),s==="High Score"&&e.jsx(B,{label:"Best",value:i.bestScore||0,mono:!0})]}),(s==="Checkout 170"||s==="Checkout 121")&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Remaining",value:i.remaining||0,mono:!0,bold:!0}),e.jsx(B,{label:"Attempts",value:i.attempts||0,mono:!0}),e.jsx(B,{label:"Successes",value:i.successes||0,mono:!0})]}),s==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Target",value:`D${i.target||1}`,mono:!0,bold:!0}),e.jsx(B,{label:"Score",value:i.score||0,mono:!0,bold:!0})]}),s==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Inning",value:i.inning||1,mono:!0}),e.jsx(B,{label:"Score",value:i.score||0,mono:!0,bold:!0})]}),s==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Hole",value:i.hole||1,mono:!0}),e.jsx(B,{label:"Strokes",value:i.strokes||0,mono:!0,bold:!0})]}),s==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx(B,{label:"Turn",value:i.turn||1,mono:!0}),i.winner&&e.jsx(B,{label:"Result",value:"WINNER!",highlight:!0})]}),o&&(s==="X01"||s==="Cricket"||s==="American Cricket")&&d===1&&e.jsx("div",{className:"border-t border-white/10 pt-1 mt-1",children:e.jsx(B,{label:"Match",value:o,mono:!0,bold:!0,highlight:!0})})]})]},d))})}function B({label:s,value:a,mono:o=!1,bold:m=!1,highlight:i=!1}){return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"opacity-70",children:[s,":"]}),e.jsx("span",{className:`${o?"font-mono":""} ${m?"font-semibold":""} ${i?"text-emerald-300":""}`,children:a})]})}function uo({matchAvg:s,allTimeAvg:a}){const o=s-a,m=o>0,i=Math.abs(o)<.01;let d="",x="text-slate-300";return i?(d="= All-time",x="text-slate-300"):m?(d=`+${o.toFixed(2)} vs avg`,x="text-emerald-400"):(d=`${o.toFixed(2)} vs avg`,x="text-orange-400"),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"opacity-70",children:"AVG vs Avg:"}),e.jsx("span",{className:`font-mono font-semibold ${x}`,children:d})]})}function mo(s){return!s||Object.keys(s).length===0?"â€”":Object.entries(s).filter(([o,m])=>m===3).map(([o])=>o==="25"?"B":o).join(",")||"â€”"}function xo(s){if(!s.closed)return"Starting";const a=Object.values(s.closed).filter(o=>o===3).length;return a===0?"No marks":a<7?`${a}/7`:"Closing in"}function Me(s){return(a,o)=>{s(a)}}function ho(s){const{match:a,commitManualVisitTotal:o,endTurn:m}=s;return{addVisit:(i,d=3,x)=>{if(o){o(i);return}try{a.addVisit(i,d,x)}catch{a.addVisit(i,d)}},undoVisit:()=>{a.undoVisit()},nextPlayer:()=>{if(m)try{m(0)}catch{a.nextPlayer()}else a.nextPlayer()},endLeg:i=>{typeof i=="number"?a.endLeg(i):a.endLeg(0)},endGame:()=>{a.endGame()}}}function Ct(s,a,o,m,i,d,x,k,F,P,I,V,$,y,A,X,N,te,se,J,ue,ke,Fe,De,qe,Pe,Ye){return r.useMemo(()=>{const me=[];if(s==="X01"){let L=0,oe=0,f=0;if(te&&te.length>0){for(const ne of te)ne.dartsThrown&&ne.totalScored&&(oe+=ne.dartsThrown,f+=ne.totalScored);oe>0&&(L=f/oe*3)}const Be=(V??0)>0?k??0:P??null??(d??0);if(me.push({name:"You",isCurrentTurn:!!se,legsWon:m||0,score:a||0,lastScore:Be,checkoutRate:A&&A>0?Math.round((y||0)/A*100):0,bestLeg:te&&te.length>0?`${Math.min(...te.map(ne=>ne.doubleDarts+(ne.checkoutDarts||0)))||0} darts`:"â€”",matchAvg:L,allTimeAvg:bl("You")||0}),J&&J!=="None"){const G=($??0)>0?F??0:I??null??(x??0);me.push({name:`${J} AI`,isCurrentTurn:!se,legsWon:i||0,score:o||0,lastScore:G,checkoutRate:N&&N>0?Math.round((X||0)/N*100):0,bestLeg:"â€”"})}}return s==="Cricket"&&(me.push({name:"You",isCurrentTurn:!!se,closed:ke?.marks||{},points:ke?.points||0}),J&&J!=="None"&&me.push({name:`${J} AI`,isCurrentTurn:!se,closed:{},points:0})),s==="Shanghai"&&(me.push({name:"You",isCurrentTurn:!!se,round:Fe?.round||1,target:Fe?.target||1,score:Fe?.score||0}),J&&J!=="None"&&me.push({name:`${J} AI`,isCurrentTurn:!se,round:Fe?.round||1,target:Fe?.target||1,score:0})),s==="Killer"&&De&&De.length>0&&De.forEach((L,oe)=>{const f=qe?.[L.id];me.push({name:L.name,isCurrentTurn:oe===Ye,number:Pe?.[L.id],lives:f?.lives||0,eliminated:f?.eliminated||!1})}),me},[s,a,o,m,i,d,x,k,F,P,I,V,$,y,A,X,N,te,se,J,ke,Fe,De,qe,Pe,Ye])}const fo=["Easy","Medium","Hardened"];function Xe(s,a,o){return Math.max(a,Math.min(o,s))}const bo=6500;function po(s,a){let o=0;if(a==="Easy"){const m=[22,26,41,45,60];o=m[Math.floor(Math.random()*m.length)]}else a==="Medium"?o=Math.round(Xe(60+(Math.random()*30-15),30,100)):o=Math.round(Xe(80+(Math.random()*20-10),50,120));return s<=0?0:o>s?[100,85,81,60,57,45,41,26,22,20,1].find(i=>i<=s)??0:o}function go({onClose:s}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:s,children:"Close"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const vo="http://localhost:8787";function Vo({user:s}){const{offlineLayout:a,favoriteDouble:o,callerEnabled:m,callerVoice:i,callerVolume:d,speakCheckoutOnly:x,rememberLastOffline:k,setLastOffline:F,autoStartOffline:P,cameraScale:I,setCameraScale:V,cameraAspect:$="wide",setCameraAspect:y,cameraFitMode:A="fill",setCameraFitMode:X,cameraEnabled:N,textSize:te,boxSize:se,autoscoreProvider:J,autoCommitMode:ue="wait-for-clear",matchType:ke="singles",setMatchType:Fe,teamAName:De="Team A",setTeamAName:qe,teamBName:Pe="Team B",setTeamBName:Ye}=Ie(),me=J==="manual",L=N&&!me,oe=N&&!me&&ue!=="immediate",[f,ut]=r.useState("X01"),[E,He]=r.useState(501),[U,Je]=r.useState("None"),[Be,ne]=r.useState(!1),[Qe,$e]=r.useState(!1),[W,q]=r.useState(E),[G,rt]=r.useState(E),[mt,xt]=r.useState(!1),[kt,z]=r.useState(!1),[Ze,Te]=r.useState(1),[Q,M]=r.useState(0),re=Tl(),[ve,Cs]=r.useState(!1),Dt=r.useRef(!1),[le,Ve]=r.useState(0),[Tt,xe]=r.useState(null),[h,S]=r.useState(1),[C,D]=r.useState(1),[H,Ae]=r.useState([]),[Re,ks]=r.useState(2e3),ce=pl(),[ht,qt]=r.useState(!1),[Yt,hr]=r.useState(a==="modern"),[Jt,fr]=r.useState(a==="modern");r.useEffect(()=>{hr(a==="modern"),fr(a==="modern")},[a]),r.useEffect(()=>{A!=="fit"&&X("fit")},[A,X]);const[Ds,br]=r.useState(1),[jo,pr]=r.useState(!1),[ee,Qt]=r.useState(!0);r.useEffect(()=>{const t=()=>Ut(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[O,R]=r.useState(0),[Zt,ln]=r.useState(0),[on,cn]=r.useState(0),[ft,gr]=r.useState(0),[vr,jr]=r.useState(0),[es,dn]=r.useState(tr()),[Ts,As]=r.useState(sr()),[ts,Ls]=r.useState(nr()),[Ms,Rs]=r.useState(rr()),[No,Ee]=r.useState(0),[Nr,yr]=r.useState(1),[mi,un]=r.useState(27),[yo,wr]=r.useState(0),[xi,mn]=r.useState(0),[Sr,Cr]=r.useState(!1),[kr,Dr]=r.useState(1),[hi,Tr]=r.useState(0),[wo,Ar]=r.useState(0),fi=8,[Lr,Mr]=r.useState(1),[bi,Rr]=r.useState(0),[So,Er]=r.useState(0),pi=10,[Ir,Fr]=r.useState(1),[gi,Pr]=r.useState(0),[Co,Br]=r.useState(0),vi=10,[xn,hn]=r.useState(170),[Or,Ur]=r.useState(0),[Hr,$r]=r.useState(0),[Vr,Wr]=r.useState(0),[fn,bn]=r.useState(121),[Kr,_r]=r.useState(0),[Gr,zr]=r.useState(0),[Xr,qr]=r.useState(0),[bt,pn]=r.useState(20),[gn,vn]=r.useState(0),[Yr,jn]=r.useState(0),[ss,ji]=r.useState(30),[Jr,Nn]=r.useState(!1),[Qr,Zr]=r.useState(ti()),[ea,ta]=r.useState(si()),[pt,sa]=r.useState(ni()),[yn,na]=r.useState(li()),[Z,wn]=r.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[ns,rs]=r.useState({}),[Es,Sn]=r.useState({}),[ra,Cn]=r.useState(!1),[We,At]=r.useState(0),[ko,Lt]=r.useState(0),[Mt,as]=r.useState(null),[Ni,et]=r.useState(""),[Is,Do]=r.useState(ir()),[gt,is]=r.useState(ir()),[ls,To]=r.useState(or(50)),[Oe,os]=r.useState(or(50)),[cs,Ao]=r.useState(dr(70)),[Ue,ds]=r.useState(dr(70)),[Fs,vt]=r.useState(0),[tt,at]=r.useState(0),[ae,he]=r.useState(0),[kn,us]=r.useState(E),[Ke,Se]=r.useState(0),[Rt,st]=r.useState(null),[Ps,je]=r.useState(0),jt=r.useRef(0),yi=r.useRef(0),fe=r.useRef(W),be=r.useRef(ae),Ne=r.useRef(Ke),Nt=r.useRef(kn),pe=r.useRef(Ps);r.useEffect(()=>{fe.current=W},[W]),r.useEffect(()=>{be.current=ae},[ae]),r.useEffect(()=>{Ne.current=Ke},[Ke]),r.useEffect(()=>{Nt.current=kn},[kn]),r.useEffect(()=>{pe.current=Ps},[Ps]);const[wi,ms]=r.useState(0);r.useRef(null);const[Bs,Dn]=r.useState(0),[yt,Os]=r.useState(0),[Et,wt]=r.useState(0),[It,nt]=r.useState(0),[Ft,Pt]=r.useState(null),[Tn,Bt]=r.useState(0),[xs,hs]=r.useState(0),[An,Us]=r.useState(0),[fs,aa]=r.useState(0),[Ln,ia]=r.useState(0),[bs,Ot]=r.useState(0),[ps,la]=r.useState(0),[Mn,gs]=r.useState(0),[Rn,oa]=r.useState(0),[ca,Hs]=r.useState(0),[Si,$s]=r.useState(0),[Ci,Vs]=r.useState(0),[da,En]=r.useState(0),[ki,In]=r.useState(0),[Di,Fn]=r.useState(0),[Ti,Ws]=r.useState(0),[Ai,ua]=r.useState(0),[Li,Pn]=r.useState(!1),[ge,de]=r.useState(""),[Bn,vs]=r.useState(""),[Lo,Mo]=r.useState(""),[ma,xa]=r.useState(""),[ha,On]=r.useState(""),[fa,Un]=r.useState(""),[Ks,Hn]=r.useState(null),[Mi,Ut]=r.useState(!1),[Ri,ba]=r.useState({}),[Ei,js]=r.useState(!1),it=r.useRef(null),$n=r.useRef(null),_e=r.useCallback(()=>{const t=$n.current;t&&(clearTimeout(t),$n.current=null)},[]),_s=r.useCallback(t=>{if(!m)return;const n=s?.username||"Player";try{rn(n,t.visitTotal,Math.max(t.remaining,0),i,{volume:d,checkoutOnly:x})}catch{}},[m,i,d,x,s?.username]),Gs=r.useCallback((t,n)=>{js(!1);const{visitTotal:l,darts:c,preRemaining:u,remaining:v,doubleAttempts:g,finished:T,doubleWindow:p,highestCheckout:j}=t;T?(q(0),fe.current=0,typeof j=="number"&&j>0&&Ws(b=>Math.max(b,j))):(q(v),fe.current=v),st(l),l===180?Hs(b=>b+1):l>=140?$s(b=>b+1):l>=100&&Vs(b=>b+1),p&&g>0&&(hs(b=>b+g),T&&Us(b=>b+1)),t.announced||_s(t);try{Ss.getState().recordVisit("offline-x01",c,l,{preRemaining:u,postRemaining:T?0:v,finish:T,bust:!1})}catch{}T&&(xe("player"),z(!0)),Gt(T?0:v),Se(0),Ne.current=0,he(0),be.current=0,je(0),pe.current=0},[Gt,Ws,xe,q,st,Se,he,je,z,Hs,$s,Vs,hs,Us,_s]),Ht=r.useCallback(t=>{const n=it.current;n&&(it.current=null,_e(),Gs(n,t))},[_e,Gs]),pa=r.useCallback(t=>{_s(t),it.current={...t,announced:!0},js(!0),_e(),$n.current=setTimeout(()=>Ht("timeout"),bo)},[_e,Ht,_s]);r.useEffect(()=>{if(!oe)return;const t=()=>Ht("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[oe,Ht]),r.useEffect(()=>{oe||Ht("timeout")},[oe,Ht]),r.useEffect(()=>()=>_e(),[_e]),r.useEffect(()=>{if(ae===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}jt.current=0}yi.current=ae},[ae]);const lt=s?.username||"Player 1",$t=U==="None"?"Player 2":U,zs=Ct("X01",W,G,Q,le,tt,yt,Ke,Et,Rt,Ft,ae,It,An,xs,Ln,fs,H,ee,U),Ii=Ct("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,es),Fi=Ct("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ee,U,void 0,es,Ts),Pi=Ct("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Z,ns,Es,We),Bi=Ct("Scam"),Oi=Ct("Fives"),Ui=Ct("Sevens"),Xs=r.useMemo(()=>{const t=zs||[],n=ae>0?Ke:Rt??tt,l=It>0?Et:Ft??yt;return t.length===0?{name:ee?lt:$t,isCurrentTurn:!0,legsWon:ee?Q:le,score:ee?W:G,lastScore:ee?n:l}:t.find(c=>c.isCurrentTurn)??t[0]},[zs,ee,lt,$t,Q,le,W,G,ae,Ke,Rt,tt,Et,Ft,yt,It]),ga=r.useMemo(()=>{if(!Xs)return[];const{matchAvg:t,allTimeAvg:n,...l}=Xs;return[{...l,matchAvg:void 0,allTimeAvg:void 0}]},[Xs]),Hi=ee?$t:lt,$i=Xs?.name??(ee?lt:$t),Vi=ee?W:G,Wi=ee?ae>0?Ke:Rt??tt:It>0?Et:Ft??yt,K=r.useCallback((t,n=1)=>{!t||n<=0||ba(l=>({...l,[t]:(l[t]||0)+n}))},[]),Y=r.useCallback(t=>{t&&ba(n=>n[t]===void 0?n:{...n,[t]:0})},[]);Ri[f];const Ki=t=>{if(!t.trim())return null;const n=Number(t);return Number.isFinite(n)?Xe(Math.round(n),0,E):null},_i=t=>{if(!t.trim())return null;const n=Number(t);return Number.isFinite(n)?Math.max(0,Math.round(n)):null},va=r.useCallback(()=>{it.current&&(it.current=null),_e(),js(!1)},[_e]);r.useCallback(t=>{const n=Xe(t,0,E);va(),q(n),fe.current=n;const l=n===0?E:n;us(l),Nt.current=l,Se(0),Ne.current=0,he(0),be.current=0,je(0),pe.current=0,st(null),at(0),R(0),jt.current=0,n===0?(xe("player"),z(!0)):(xe(null),z(!1))},[va,q,E,us,Se,he,je,st,at,R,xe,z]);const ja=t=>{const l=Ki(ma);if(l===null){ce(`Enter a number between 0 and ${E}`,{type:"error",timeout:2500});return}rt(l),wt(0),nt(0),Pt(null),Bt(0),Os(0),xa(""),xe(null),z(!1)},Na=r.useCallback((t,n)=>{t==="player"?(M(n),On("")):(Ve(n),Un("")),xe(null),z(!1)},[Ve,Un,On,xe,M,z]),qs=t=>{const l=_i(t==="player"?ha:fa);if(l===null){ce("Enter a non-negative whole number for legs",{type:"error",timeout:2500});return}Hn({target:t,value:l,stage:1})},Gi=r.useCallback(()=>{Hn(t=>t&&(t.stage===1?{...t,stage:2}:(Na(t.target,t.value),null)))},[Na]),Ns=r.useCallback(()=>{Hn(null)},[]);r.useEffect(()=>{if(!Ks)return;const t=n=>{n.key==="Escape"&&(n.preventDefault(),Ns())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[Ns,Ks]);const ot=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(te),Vt=r.useRef(null),Wt=r.useRef(null),Vn=r.useRef(null),[Kt,Wn]=r.useState("first"),[Ys,ya]=r.useState(1),zi=r.useRef(null);r.useEffect(()=>{const t=Math.max(1,Math.floor(Number(Ys)||1)),n=Kt==="first"?t:Math.max(1,Math.ceil(t/2));Te(n)},[Kt,Ys]),r.useEffect(()=>{if(!Jt){br(1),pr(!1);return}const t=()=>{const c=Vt.current,u=Wt.current;if(!c||!u)return;const v=Vn.current?Vn.current.getBoundingClientRect().height:0,g=Math.max(0,c.clientHeight-v-6),T=Math.max(0,c.clientWidth-8),p=u.getBoundingClientRect(),j=Ds||1,b=p.height/j,w=p.width/j,we=g>0?g/b:1,Ge=T>0?T/w:1,ct=Math.min(1,Math.max(.5,Math.min(we,Ge))),Ce=b*ct,ie=g>0&&Ce-g>1;pr(ie),br(ct)};t();const n=window.ResizeObserver,l=n?new n(()=>t()):null;return l&&Vt.current&&l.observe(Vt.current),l&&Wt.current&&l.observe(Wt.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{l&&Vt.current&&l.unobserve(Vt.current)}catch{}try{l&&Wt.current&&l.unobserve(Wt.current)}catch{}}},[Jt,Ds]),r.useEffect(()=>{const t=n=>{const l=n?.detail?.mode;l&&(ut(l),_t())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),r.useEffect(()=>{const t=n=>{const l=n?.detail?.formatType,c=n?.detail?.formatCount,u=n?.detail?.startScore;(l==="first"||l==="best")&&Wn(l),typeof c=="number"&&isFinite(c)&&ya(Math.max(1,Math.floor(c))),typeof u=="number"&&isFinite(u)&&He(Math.max(1,Math.floor(u)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),r.useEffect(()=>{if(!P)return;const t=setTimeout(()=>_t(),50);return()=>clearTimeout(t)},[P]),r.useEffect(()=>{if(!ht||ee||U==="None"||wi<=0)return;let t,n=performance.now();const l=c=>{const u=c-n;n=c,ms(v=>{const g=v-u;if(g<=0){let T=0,p=0,j=G;for(nt(0);T<3&&j>0;){const b=po(j,U),w=Xe(b-T*20,0,Math.min(60,j)),we=j-w;if(Os(w),Dn(Ce=>Ce+1),la(Ce=>Ce+1),we<0){j=G,wt(0),Bt(0),p=0,Pt(0),nt(0);break}p+=w,wt(Ce=>Ce+w),oa(Ce=>Ce+w);const Ge=j,ct=we;if(Ge>50&&ct<=50?Bt(1):Ge<=50&&Bt(Ce=>Ce+1),j=we,T+=1,nt(T),j===0)break}if(rt(j),j===0){p===180?En(w=>w+1):p>=140?In(w=>w+1):p>=100&&Fn(w=>w+1);const b=G;b<=170&&ua(w=>Math.max(w,b)),G<=50&&(aa(w=>w+(Tn>0?Tn:1)),ia(w=>w+1)),Pt(p),wt(0),Bt(0),nt(0),xe("ai"),z(!0)}return j>0&&T>=3&&(p===180?En(b=>b+1):p>=140?In(b=>b+1):p>=100&&Fn(b=>b+1),Pt(p),wt(0),Bt(0),nt(0)),nt(0),Qt(!0),0}return g}),t=requestAnimationFrame(l)};return t=requestAnimationFrame(l),()=>cancelAnimationFrame(t)},[ht,ee,U,G]),r.useEffect(()=>{re.inProgress&&(Dt.current||(Cs(!0),Dt.current=!0))},[re.inProgress]);function _t(){$e(!0),q(E),fe.current=E,rt(E),xt(!1),qt(!0),Qt(!0),R(0),vt(0),at(0),he(0),be.current=0,us(E),Se(0),st(null),je(0),ms(0),Dn(0),Os(0),wt(0),nt(0),Pt(null),xe(null),M(0),Ve(0),Ae([]),vn(0),jn(0),Nn(!1),Ot(0),la(0),gs(0),oa(0),Hs(0),$s(0),Vs(0),En(0),In(0),Fn(0),Ws(0),ua(0),hs(0),Us(0),aa(0),ia(0),Y("X01");const t=Math.max(1,Math.floor(Number(Ys)||1));if(Te(Kt==="first"?t:Math.max(1,Math.ceil(t/2))),k)try{F({mode:f,x01Start:E,firstTo:Ze,aiLevel:U})}catch{}}function Xi(){q(E),fe.current=E,rt(E),xt(!1),qt(!0),Qt(!0),R(0),vt(0),at(0),he(0),be.current=0,us(E),Se(0),Nt.current=E,Ne.current=0,st(null),je(0),pe.current=0,pe.current=0,ms(0),Dn(0),Os(0),wt(0),nt(0),Pt(null),xe(null)}function Gt(t){he(0),be.current=0,us(t===0?E:t),Nt.current=t===0?E:t,je(0),pe.current=0,U!=="None"?(Qt(!1),ms(Re)):(ms(0),Qt(!0))}function zt(t){if(oe&&it.current){Ei||js(!0),ce("Remove your darts before starting the next throw",{type:"info",timeout:1800});return}K("X01");const n=fe.current,l=be.current,c=Ne.current,u=Nt.current,v=pe.current,g=n-t,T=l+1;if(at(t),vt(ie=>ie+1),Ot(ie=>ie+1),g<0){try{const ie=n,er=u;Ss.getState().recordVisit("offline-x01",T,0,{preRemaining:ie,postRemaining:er,bust:!0,finish:!1})}catch{}if(q(u),fe.current=u,n<=50){const ie=(v||0)+1;hs(er=>er+ie)}if(m)try{rn(s?.username||"Player",0,Math.max(u,0),i,{volume:d,checkoutOnly:x})}catch{}st(0),R(0),Se(0),Ne.current=0,je(0),pe.current=0,Gt(u);return}q(g),fe.current=g,he(T),be.current=T;const p=c+t;Se(p),Ne.current=p,gs(ie=>ie+t),R(0);const j=n,b=g,w=j>50&&b<=50,we=j<=50;w?(je(1),pe.current=1):we&&(je(ie=>ie+1),pe.current=(v||0)+1);const Ge=pe.current||0,ct=j<=50,Ce=ct?Math.max(Ge,Math.min(T,3)):0;if(g===0){const ie={visitTotal:p,darts:T,preRemaining:n,remaining:0,doubleAttempts:Ce,finished:!0,doubleWindow:ct,highestCheckout:u<=170?u:null};oe?pa(ie):Gs(ie,"immediate");return}if(T>=3){const ie={visitTotal:p,darts:T,preRemaining:n,remaining:g,doubleAttempts:Ce,finished:!1,doubleWindow:ct,highestCheckout:null};oe?pa(ie):Gs(ie,"immediate");return}}function Js(){const t=Xe(Math.round(Number(O)||0),0,60);zt(t)}function ye(t){if(!Number.isFinite(t))return!1;const n=Nt.current,l=fe.current,c=be.current,u=Ne.current,v=c>0||u>0;v&&(q(n),fe.current=n,he(0),be.current=0,Se(0),Ne.current=0,je(0),pe.current=0,at(0),R(0),vt(b=>Math.max(0,b-c)),Ot(b=>Math.max(0,b-c)),gs(b=>Math.max(0,b-u)),jt.current=0);const g=v?n:l,T=g<=170?170:180,p=Xe(Math.round(t),0,T);K("X01",3),vt(b=>b+3),Ot(b=>b+3),he(3),be.current=3,Se(p),Ne.current=p,st(p),p===180?Hs(b=>b+1):p>=140?$s(b=>b+1):p>=100&&Vs(b=>b+1);const j=g-p;if(j<0){if(m)try{rn(lt,0,Math.max(n,0),i,{volume:d,checkoutOnly:x})}catch{}try{Ss.getState().recordVisit("offline-x01",3,0,{preRemaining:g,postRemaining:n,bust:!0,finish:!1})}catch{}return q(n),fe.current=n,st(0),Se(0),Ne.current=0,he(0),be.current=0,je(0),pe.current=0,Gt(n),!0}if(q(j),fe.current=j,gs(b=>b+p),m)try{rn(lt,p,Math.max(j,0),i,{volume:d,checkoutOnly:x})}catch{}if(g<=50&&(hs(b=>b+3),j===0&&Us(b=>b+1)),j===0){g<=170&&Ws(b=>Math.max(b,g));try{Ss.getState().recordVisit("offline-x01",3,p,{preRemaining:g,postRemaining:0,finish:!0,bust:!1})}catch{}return xe("player"),z(!0),he(0),be.current=0,Se(0),Ne.current=0,je(0),pe.current=0,!0}try{Ss.getState().recordVisit("offline-x01",3,p,{preRemaining:g,postRemaining:j,finish:!1,bust:!1})}catch{}return Gt(j),Se(0),Ne.current=0,he(0),be.current=0,je(0),pe.current=0,!0}const Le=ho({match:re,commitManualVisitTotal:ye,endTurn:Gt}),[Qs,Zs]=r.useState(""),wa=t=>{if(!t){Zs("");return}const n=t.replace(/[^0-9]/g,"");if(!n){Zs("");return}const l=Number(n);if(!Number.isFinite(l))return;const c=fe.current<=170?170:180,u=Xe(Math.round(l),0,c);Zs(String(u))};function en(){if(!Qs){alert("Enter a number 0â€“180 for visit total");return}const t=Number(Qs);if(!Number.isFinite(t)){alert("Enter a number 0â€“180 for visit total");return}const n=fe.current<=170?170:180,l=Xe(Math.round(t),0,n);t>n&&ce(`Visit totals cannot exceed ${n}.`,{type:"info",timeout:2200}),ye(l)&&Zs("")}const Kn=r.useCallback(()=>{it.current&&(it.current=null,_e(),js(!1));const t=be.current,n=Ne.current,l=Nt.current;t===0&&n===0||(q(l),fe.current=l,he(0),be.current=0,Se(0),Ne.current=0,je(0),pe.current=0,at(0),R(0),vt(c=>Math.max(0,c-t)),Ot(c=>Math.max(0,c-t)),gs(c=>Math.max(0,c-n)),jt.current=0)},[_e]);r.useEffect(()=>{const t=n=>{const l=n?.detail;!l||l?.source==="offline-play"||Kn()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[Kn]);function Sa(t){K("Double Practice");const n=Xe(Math.round(t||0),0,60);if(at(n),vt(l=>l+1),Ot(l=>l+1),Qa(n,Zt)){const l=on+1;cn(l),ln(c=>Math.min(20,c+1)),l>=21&&(xe("player"),z(!0))}R(0)}function Ca(){Sa(Number(O))}function ka(){const t=Xt(ge);if(t==null){alert("Enter like D16, 50, 25, T20");return}Sa(t),de("")}function Da(t,n,l){if(Sr)return;K("Bob's 27");const c=Nr,u=n==="DOUBLE"&&l===c||!n&&t===c*2;u&&mn(v=>v+1),wr(v=>{const g=v+1;if(g>=3){const T=xi+(u?1:0);T>0?un(j=>j+T*c*2):un(j=>j-c*2);const p=c+1;return yr(p),mn(0),p>20&&Cr(!0),0}return g})}function Ta(){Da(Math.max(0,O|0)),R(0)}function Aa(){yr(1),un(27),wr(0),mn(0),Cr(!1),Y("Bob's 27")}function _n(t){K("Count-Up"),Tr(n=>n+Math.max(0,t|0)),Ar(n=>{const l=n+1;return l>=3?(Dr(c=>c+1),0):l})}function Gn(t){K("High Score"),Rr(n=>n+Math.max(0,t|0)),Er(n=>{const l=n+1;return l>=3?(Mr(c=>c+1),0):l})}function zn(t){K("Low Score"),Pr(n=>n+Math.max(0,t|0)),Br(n=>{const l=n+1;return l>=3?(Fr(c=>c+1),0):l})}function La(t,n,l,c,u,v,g,T){const p=t-g;if(!(p<0))if(p===0){if(T==="DOUBLE"||T==="INNER_BULL"){v(j=>j+1),u(j=>j+1),c(()=>0),n(t);return}n(p)}else n(p);c(j=>{const b=j+1;return b>=3?(u(w=>w+1),0):b})}function Ma(t,n){K("Checkout 170"),La(xn,hn,Or,Ur,$r,Wr,t,n),Or+1>=3&&hn(170)}function Ra(t,n){K("Checkout 121"),La(fn,bn,Kr,_r,zr,qr,t,n),Kr+1>=3&&bn(121)}function tn(t){const n=Xt(ge);if(n==null){alert("Enter like T20, D16, 25, 50");return}const l=ge.trim().toUpperCase(),c=l.startsWith("D")||l==="50"||l==="BULL"||l==="DBULL"||l==="IBULL"||l.includes("INNER");t?Ma(n,c?"DOUBLE":void 0):Ra(n,c?"DOUBLE":void 0),de("")}function qi(){hn(170),Ur(0),$r(0),Wr(0),Y("Checkout 170")}function Yi(){bn(121),_r(0),zr(0),qr(0),Y("Checkout 121")}function Xn(t,n,l){if(Jr)return;K("Treble Practice"),(n==="TRIPLE"&&l===bt||!n&&t===bt*3)&&vn(u=>u+1),jn(u=>{const v=u+1;if(v%3===0&&[20,19,18].includes(bt)){const g=[20,19,18],T=g.indexOf(bt),p=g[(T+1)%g.length];pn(p)}return ss>0&&v>=ss&&Nn(!0),v})}function Ea(){vn(0),jn(0),Nn(!1),Y("Treble Practice")}function Ji(t,n,l){K("Baseball"),Zr(c=>{const u={...c};return Xl(u,t,n,l),u})}function Qi(){Zr(ti()),Y("Baseball")}function Zi(t,n,l){K("Golf"),ta(c=>{const u={...c};return Yl(u,t,n,l),u})}function el(){ta(si()),Y("Golf")}function tl(t,n,l,c){K("Tic Tac Toe"),sa(u=>{const v={...u,board:[...u.board]};return Ql(v,t,n,l,c),v})}function sl(){sa(ni()),Y("Tic Tac Toe")}function nl(t,n,l){K("American Cricket"),na(c=>{const u={...c,marks:{...c.marks}};return lo(u,t,n,l,()=>!1),u})}function Ia(){na(li()),Y("American Cricket")}function qn(t,n,l){K("Around the Clock");const c=dt[ft];let u=!1;if(typeof l=="number"&&l===c&&(n==="SINGLE"||n==="DOUBLE"||n==="TRIPLE")&&(u=!0),c===25&&(n==="BULL"||t===25)&&(u=!0),c===50&&(n==="INNER_BULL"||t===50)&&(u=!0),u||(t===c||t===c*2||t===c*3)&&(u=!0),u){const v=vr+1;jr(v),gr(g=>g+1)}}function Fa(){qn(Math.max(0,O|0)),R(0)}function Pa(){const t=Xt(ge);if(t==null){alert("Enter like T20, D5, 25, 50");return}qn(t),de("")}function Yn(t,n,l){K("Cricket"),dn(c=>{const u={...c,marks:{...c.marks}};return Bl(u,t,n,l,()=>!1),u}),Ee(c=>{const u=c+1;return u>=3?0:u})}function Ba(){Yn(Math.max(0,O|0)),R(0)}function Jn(t,n,l){K("Shanghai"),As(c=>{const u={...c,turnHits:{...c.turnHits}};return Hl(u,t,n,l),u}),Ee(c=>{const u=c+1;return u>=3?(As(v=>{const g={...v,turnHits:{...v.turnHits}};return $l(g),g}),0):u})}function Oa(){Jn(Math.max(0,O|0)),R(0)}function Ua(t,n,l){K("Halve It"),Ls(c=>{const u={...c,targets:[...c.targets]};return Vl(u,t,n,l),u}),Ee(c=>{const u=c+1;return u>=3?(Ls(v=>{const g={...v,targets:[...v.targets]};return Wl(g),g}),0):u})}function Ha(){Ua(Math.max(0,O|0)),R(0)}function $a(t,n,l){K("High-Low"),Rs(c=>{const u={...c};return Kl(u,t,n,l),u}),Ee(c=>{const u=c+1;return u>=3?(Rs(v=>{const g={...v};return _l(g),g}),0):u})}function Va(){$a(Math.max(0,O|0)),R(0)}function Wa(){const t=ge.trim().toUpperCase();if(!t)return null;if(t==="50"||t==="BULL"||t==="DBULL"||t==="IBULL")return 50;if(t==="25"||t==="OBULL")return 25;const n=t.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!n)return null;const l=n[1]||"S",c=parseInt(n[2],10);return c<1||c>20?null:c*(l==="S"?1:l==="D"?2:3)}function ys(){const t=Wa();if(t==null){alert("Enter like T20, D16, 5, 25, 50");return}zt(t),de("")}function Ka(){const t=Bn.trim().split(`
`).map(n=>n.trim()).filter(n=>n);if(t.length!==0){for(const n of t){const l=Xt(n);if(l==null){alert(`Invalid score: ${n}`);return}zt(l)}vs("")}}function Qn(){ae!==0&&(q(t=>t+tt),he(t=>Math.max(0,t-1)))}function sn(){const t=Wa();if(t==null){alert("Enter like T20, D16, 5, 25, 50");return}if(ae===0){ys();return}const n=tt;q(l=>l+n),he(l=>Math.max(0,l-1)),setTimeout(()=>zt(t),0),de("")}function rl(){const t=Tt??"player",n=t==="player"?Ps||void 0:Tn||void 0,l=1,c=t==="player"?Fs:Bs;Ae([...H,{winner:t,doubleDarts:h,checkoutDarts:C,winnerDarts:c,doublesAtt:n,doublesHit:l}]),z(!1);let u=Q,v=le;if(Tt==="player"?u+=1:Tt==="ai"&&(v+=1),M(u),Ve(v),xe(null),u>=Ze||v>=Ze){try{Nl(f,t==="player")}catch{}qt(!1),$e(!1),q(E),rt(E),Pn(!0);return}Xi()}const Zn=!za.includes(f)&&!(s?.fullAccess||s?.admin);return e.jsxs("div",{className:"card ndn-game-shell relative overflow-hidden",children:[ve&&e.jsx(Dl,{players:re.players||[],onDone:()=>Cs(!1)}),e.jsxs("h2",{className:"text-3xl font-bold text-brand-700 mb-4",children:["Offline Mode ",a==="classic"?e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle",children:"Classic layout"}):e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),e.jsxs("div",{className:"ndn-shell-body",children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{className:"input w-full",value:f,onChange:t=>ut(t.target.value),children:[za.map(t=>e.jsx("option",{value:t,children:t},t)),gl.map(t=>e.jsxs("option",{value:t,disabled:!(s?.fullAccess||s?.admin),children:[t," ",s?.fullAccess||s?.admin?"":"(Premium)"]},t))]}),e.jsx(Il,{gameMode:f,compact:!0}),f==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:ss,onChange:t=>ji(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."})]}),!s?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),f==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:E,onChange:t=>He(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{className:"input w-full",value:U,onChange:t=>Je(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),fo.map(t=>e.jsx("option",{value:t,children:t},t))]}),U!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:Re/1e3,onChange:t=>ks(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>ne(!0),children:"X01 Rules & Regulations!"})]}),f==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings donâ€™t apply."})]}),!Qe&&e.jsx("button",{className:"btn",disabled:Zn,title:Zn?"PREMIUM required for this mode":"",onClick:_t,children:"Start Match"}),ht&&e.jsx("div",{className:`absolute inset-0 z-[1000] ${Yt?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(ws,{storageKey:"ndn:modal:offline-match",className:`${Yt?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:Yt,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pr-1 pt-2 pb-2",style:{overflowY:"scroll"},ref:t=>{Vt.current=t},children:[e.jsx("div",{ref:t=>{Vn.current=t},children:e.jsx(co,{left:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[f,f==="X01"?` / ${E}`:""]}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",Ze," Â· Legs ",Q,"-",le]}),e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${a==="modern"?"bg-emerald-500/15 text-emerald-200 border-emerald-400/30":"bg-white/10 text-white/70 border-white/20"}`,children:a==="modern"?"Modern layout":"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden items-center gap-2 mr-2 text-xs",children:[e.jsx("span",{className:"opacity-80",children:"Cam"}),e.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>V(Math.max(.5,Math.round((I-.05)*100)/100)),title:"Decrease camera size",children:"âˆ’"}),e.jsxs("span",{className:"w-9 text-center",children:[Math.round(I*100),"%"]}),e.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>V(Math.min(1.25,Math.round((I+.05)*100)/100)),title:"Increase camera size",children:"+"})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:Jt?"Actual Size":"Fit All",onClick:()=>fr(t=>!t),children:Jt?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:Yt?"Restore":"Maximize",onClick:()=>hr(t=>!t),children:Yt?"Restore":"Maximize"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{_t()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>{qt(!1),$e(!1)},children:"Quit"})]})})}),e.jsxs("div",{ref:t=>{Wt.current=t},className:"will-change-transform",style:Jt?{transform:`scale(${Ds})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,Ds))}em`}:void 0,children:[e.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:f==="X01"?"X01 Match":f}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",f]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",E]}),e.jsxs("div",{ref:zi,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=W!==E||G!==E||ae>0,n=`px-2 py-0.5 rounded border text-xs ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${n} ${Kt==="first"?"bg-indigo-500/20 text-indigo-100 border-indigo-400/30":"bg-white/10 text-white/80 border-white/20"}`,onClick:()=>{t||Wn("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${n} ${Kt==="best"?"bg-indigo-500/20 text-indigo-100 border-indigo-400/30":"bg-white/10 text-white/80 border-white/20"}`,onClick:()=>{t||Wn("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:Ys,onChange:l=>ya(Math.max(1,Math.floor(Number(l.target.value)||1))),disabled:t,title:Kt==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",Q,"â€“",le]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`btn ${ot}`,value:ke,onChange:t=>Fe(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${ot} w-[7.5rem]`,value:De,onChange:t=>qe(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${ot} w-[7.5rem]`,value:Pe,onChange:t=>Ye(t.target.value),placeholder:"Team B"})]})]}),f!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[f==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:an[Zt]?.label||"â€”"})]})}),f==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:dt[ft]===25?"25 (Outer Bull)":dt[ft]===50?"50 (Inner Bull)":dt[ft]||"â€”"})]})}),f==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:mr.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,es.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points: ",e.jsx("span",{className:"font-semibold",children:es.points})]}),Ol(es)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{dn(tr()),Ee(0),Y("Cricket")},children:"Reset"})]})]}),f==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:Ts.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ts.score]}),Ts.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{As(sr()),Ee(0),Y("Shanghai")},children:"Reset"})]})]}),f==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[ts.stage+1,"/",ts.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target: ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=ci(ts);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",ts.score]}),ts.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Ls(nr()),Ee(0),Y("Halve It")},children:"Reset"})]})]}),f==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Ms.round," Â· Target ",Ms.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ms.score]}),Ms.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Rs(rr()),Ee(0),Y("High-Low")},children:"Reset"})]})]}),f==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",Nr]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",mi]}),Sr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:Aa,children:"Reset"})]})]}),f==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",kr,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",hi]})]}),f==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Lr,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",bi]})]}),f==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Ir,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",gi]})]}),f==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:xn}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Hr," Â· Successes: ",Vr]})]}),f==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:fn}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Gr," Â· Successes: ",Xr]})]}),f==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",bt]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",gn]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${bt===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>pn(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:bt,onChange:t=>pn(parseInt(t.target.value,10)),children:Array.from({length:20},(t,n)=>n+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ea,children:"Reset"})]})]})}),f==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Qr.inning}),e.jsxs("div",{className:"text-sm",children:["Score: ",e.jsx("span",{className:"font-semibold",children:Qr.score})]})]}),f==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:ea.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes: ",e.jsx("span",{className:"font-semibold",children:ea.strokes})]})]}),f==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:pt.turn}),pt.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",pt.winner||"â€”"]})]}),f==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:ar[Is.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress: ",e.jsxs("span",{className:"font-semibold",children:[Is.targetIndex+1,"/",ar.length]})]}),Is.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",Is.darts," darts!"]})]}),f==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[ls.score,"/",ls.target]}),e.jsxs("div",{className:"text-sm",children:["Darts: ",e.jsx("span",{className:"font-semibold",children:ls.darts})]}),ls.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",ls.target,"!"]})]}),f==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[cs.score,"/",cs.target]}),e.jsxs("div",{className:"text-sm",children:["Darts: ",e.jsx("span",{className:"font-semibold",children:cs.darts})]}),cs.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",cs.target,"!"]})]}),f==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:xr.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,yn.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points: ",e.jsx("span",{className:"font-semibold",children:yn.points})]}),oo(yn)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:Ia,children:"Reset"})]})]}),f==="Killer"&&e.jsx(e.Fragment,{children:ra?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:Z[We]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Mt?`${Z.find(t=>t.id===Mt)?.name||"Winner"} Wins`:Ni||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):a==="modern"?e.jsx("div",{className:"space-y-3 mb-2",children:me?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Manual scoring active"}),e.jsx("div",{className:"text-xs opacity-70",children:"Camera previews are disabled. Use the manual entry controls below to record your turn."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center flex-wrap gap-1.5 mt-1",children:e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[e.jsx("span",{className:"opacity-70",children:"Cam"}),e.jsx("button",{className:`btn ${ot}`,onClick:()=>V(Math.max(.5,Math.round((I-.05)*100)/100)),children:"âˆ’"}),e.jsxs("span",{className:`btn ${ot} min-w-[2.5rem] text-center`,children:[Math.round(I*100),"%"]}),e.jsx("button",{className:`btn ${ot}`,onClick:()=>V(Math.min(1.25,Math.round((I+.05)*100)/100)),children:"+"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${ot}`,title:"Toggle fit/fill",onClick:()=>X(A==="fill"?"fit":"fill"),children:A==="fill"?"Fill":"Fit"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${ot}`,title:"Toggle camera aspect",onClick:()=>y($==="square"?"wide":"square"),children:$==="square"?"Square":"Wide"})]})}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row-reverse md:items-start md:gap-6",children:[e.jsx("div",{className:"w-full h-[260px] rounded-2xl overflow-hidden bg-black shadow-xl md:w-[48%] md:min-h-[420px]",children:e.jsx(_,{scoringMode:"x01",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{zt(t)}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-[minmax(0,1fr)_300px] md:items-start md:gap-4",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Current Shooter"}),e.jsx("div",{className:"mt-1 text-xl font-semibold text-white",children:$i}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm text-white/80",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Remaining"}),e.jsx("div",{className:"font-mono text-lg text-white",children:Vi})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Last Dart"}),e.jsx("div",{className:"font-mono text-lg text-white",children:Wi||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Match Legs"}),e.jsxs("div",{className:"font-semibold text-white",children:[Q,"-",le]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Next Up"}),e.jsx("div",{className:"font-medium text-white",children:Hi})]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(ze,{gameMode:f,players:ga,matchScore:`${Q}-${le}`})})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(ze,{gameMode:f,players:ga,matchScore:`${Q}-${le}`})}),f==="X01"&&e.jsxs("div",{className:"mt-3 md:mt-4 rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Manual Scoreboard Override"}),e.jsxs("p",{className:"mt-1 text-xs text-white/40",children:["Adjust the live totals if a dart was misread. Values are clamped between 0 and ",E,"."]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:lt}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Commit Visit"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx(Al,{inProgress:!0,startingScore:E,onAddVisit:Me(ye),quickButtons:[180,140,100,60],onNextPlayer:()=>Le?.nextPlayer(),onEndLeg:()=>{},onUndo:()=>{},showDartsSelect:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:ha,onChange:t=>On(t.target.value),onKeyDown:t=>{t.key==="Enter"&&qs("player")},placeholder:`${Q}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>qs("player"),children:"Set"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:$t}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Three Dart Edit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:E,value:ma,onChange:t=>xa(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ja()},placeholder:`${G}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>ja(),children:"Set"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:fa,onChange:t=>Un(t.target.value),onKeyDown:t=>{t.key==="Enter"&&qs("ai")},placeholder:`${le}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>qs("ai"),children:"Set"})]})]})]})]})]})]})]})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:[grid-template-columns:minmax(0,0.75fr)_minmax(0,3fr)_minmax(0,0.75fr)] gap-2 mb-2 items-stretch min-w-0",children:e.jsxs("div",{className:"flex items-stretch justify-center md:px-3 min-w-0",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"You Remain"}),ee?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:W}),e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-W/E)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",e.jsx("span",{className:"font-semibold",children:tt})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score: ",e.jsx("span",{className:"font-semibold",children:ae>0?Ke:Rt??tt})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",e.jsx("span",{className:"font-semibold",children:bs>0?(Mn/bs*3).toFixed(1):"0.0"})]}),e.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[e.jsxs("span",{children:["Darts thrown: ",Fs]}),e.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(t=>e.jsx("span",{className:`w-2 h-2 rounded-full ${t<ae?"bg-emerald-400":"bg-white/20"}`},t))})]}),e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",e.jsxs("span",{className:"font-semibold",children:["Att ",xs," Â· Hit ",An]})]}),W<=170&&W>0&&(()=>{const n=El(W,o)[0]||"â€”";return e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[e.jsx("span",{className:"opacity-70",children:"Checkout"}),e.jsx("span",{className:"font-semibold",children:n})]})})()]}),e.jsx("div",{className:"flex items-stretch justify-center md:justify-end md:px-3 min-w-0 flex-1 min-h-0 ndn-camera-tall",children:e.jsx(kl,{storageKey:"ndn:camera:tile:offline:center:v4",className:"relative rounded-2xl overflow-hidden bg-black w-full camera-fullwidth-card",defaultWidth:0,defaultHeight:0,minWidth:300,minHeight:300,maxWidth:2e3,maxHeight:1200,autoFill:!0,children:e.jsx(qa,{label:"Your Board",autoStart:!0,className:"min-w-0 h-full",aspect:"classic",fill:!0})})}),e.jsxs("div",{className:`mt-2 ${se==="small"?"p-2":se==="large"?"p-4":"p-3"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${te==="small"?"text-xs":te==="large"?"text-base":"text-sm"}`,children:[e.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const t=ee?s?.username||"You":U==="None"?"â€”":`${U} AI`,n=ee?W:U==="None"?0:G,l=ee?ae>0?Ke:Rt??tt:It>0?Et:Ft??yt,c=ee?Fs:Bs,u=E-(ee?W:U==="None"?E:G),v=c>0?u/c*3:0,g=`${Q}-${le}`,T=H.length>0?`${Math.min(...H.map(p=>p.doubleDarts+(p.checkoutDarts||0)))||0} darts`:"â€”";return e.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[e.jsx("div",{className:"opacity-80",children:"Current score"}),e.jsx("div",{className:"font-mono text-right",children:g}),e.jsx("div",{className:"opacity-80",children:"Current thrower"}),e.jsx("div",{className:"text-right font-semibold text-lg",children:t}),e.jsx("div",{className:"opacity-80",children:"Score remaining"}),e.jsx("div",{className:"text-right font-mono font-bold text-xl",children:n}),e.jsx("div",{className:"opacity-80",children:"3-dart avg"}),e.jsx("div",{className:"text-right font-mono",children:v.toFixed(1)}),e.jsx("div",{className:"opacity-80",children:"Last score"}),e.jsx("div",{className:"text-right font-mono",children:l}),e.jsx("div",{className:"opacity-80",children:"Best leg"}),e.jsx("div",{className:"text-right",children:T})]})})()]}),e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[e.jsxs("span",{children:[U==="None"?"Opponent":`${U} AI`," Remain"]}),ee?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:U!=="None"?G:"N/A"}),U!=="None"&&e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-G/E)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",e.jsx("span",{className:"font-semibold",children:U==="None"?0:yt})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score: ",e.jsx("span",{className:"font-semibold",children:U==="None"?"â€”":It>0?Et:Ft??yt})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",e.jsx("span",{className:"font-semibold",children:U!=="None"?ps>0?(Rn/ps*3).toFixed(1):"0.0":"â€”"})]}),U!=="None"&&e.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",Bs]}),U!=="None"&&e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",e.jsxs("span",{className:"font-semibold",children:["Att ",fs," Â· Hit ",Ln]})]})]})]})}),f!=="X01"?e.jsxs("div",{className:"space-y-2",children:[f==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target: ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:an[Zt]?.label||"â€”"})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,onAutoDart:(t,n)=>{if((n==="DOUBLE"||n==="INNER_BULL")&&Qa(t,Zt)){const c=on+1,u=Zt+1;cn(c),ln(u),c>=an.length&&setTimeout(()=>{cn(0),ln(0)},250)}},immediateAutoCommit:!0,onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ca()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ca,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ka()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ka,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",on," of 21"]})]}),f==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target: ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:dt[ft]===25?"25 (Outer Bull)":dt[ft]===50?"50 (Inner Bull)":dt[ft]||"â€”"})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{qn(t,n==="MISS"?void 0:n,l?.sector??null)},onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Fa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Fa,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Pa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Pa,children:"Add"})]}),vr>=dt.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{jr(0),gr(0),Y("Around the Clock")},children:"Reset"})]})]}),f==="Cricket"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Yn(t,n==="MISS"?void 0:n,l?.sector??null)},onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ba()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ba,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{dn(tr()),Ee(0),Y("Cricket")},children:"Reset"})]})]}),f==="Shanghai"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Jn(t,n==="MISS"?void 0:n,l?.sector??null)},onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Oa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Oa,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{As(sr()),Ee(0),Y("Shanghai")},children:"Reset"})]})]}),f==="Halve It"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Ua(t,n==="MISS"?void 0:n,l?.sector??null)},onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ha()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ha,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ls(nr()),Ee(0),Y("Halve It")},children:"Reset"})]})]}),f==="High-Low"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{$a(t,n==="MISS"?void 0:n,l?.sector??null)},onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Va()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Va,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Rs(rr()),Ee(0),Y("High-Low")},children:"Reset"})]})]}),f==="Bob's 27"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Da(t,n==="MISS"?void 0:n,l?.sector??null)},onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ta()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ta,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Aa,children:"Reset"})]})]}),f==="Count-Up"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:t=>_n(t),onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(_n(O),R(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{_n(O),R(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Dr(1),Tr(0),Ar(0),Y("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",kr,"/",fi]})]}),f==="High Score"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:t=>Gn(t),onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Gn(O),R(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Gn(O),R(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Mr(1),Rr(0),Er(0),Y("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Lr,"/",pi]})]}),f==="Low Score"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:t=>zn(t),onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(zn(O),R(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{zn(O),R(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Fr(1),Pr(0),Br(0),Y("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Ir,"/",vi]})]}),f==="Checkout 170"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n)=>Ma(t,n==="MISS"?void 0:n),onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{t.key==="Enter"&&tn(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>tn(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:qi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",xn," Â· Attempts: ",Hr," Â· Successes: ",Vr]})]}),f==="Checkout 121"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n)=>Ra(t,n==="MISS"?void 0:n),onAddVisit:Me(ye),onEndLeg:t=>Le.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{t.key==="Enter"&&tn(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>tn(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Yi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",fn," Â· Attempts: ",Gr," Â· Successes: ",Xr]})]}),f==="Treble Practice"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Xn(t,n==="MISS"?void 0:n,l?.sector??null)}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const n=Xt(ge);n!=null&&Xn(n,void 0,void 0),de("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=Xt(ge);t!=null&&Xn(t,void 0,void 0),de("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",gn," Â· Misses: ",Math.max(0,Yr-gn)," Â· Darts: ",Yr,ss>0?`/${ss}`:""]}),Jr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",e.jsx("button",{className:"ml-2 underline",onClick:Ea,children:"Reset"})]})]}),f==="Baseball"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Ji(t,n==="MISS"?void 0:n,l?.sector??null)}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Qi,children:"Reset"})})]}),f==="Golf"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{Zi(t,n==="MISS"?void 0:n,l?.sector??null)}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:el,children:"Reset"})})]}),f==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,n)=>n).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${pt.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(pt.finished||pt.board[t])return;const n=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),l=n%3===0?"TRIPLE":n%2===0?"DOUBLE":"SINGLE",c=t,u=di[c],v=u.type==="BULL"?null:u.num||null;tl(c,n,l,v)},children:pt.board[t]||""},t))}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:sl,children:"Reset"})})]}),f==="American Cricket"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{nl(t,n==="MISS"?void 0:n,l?.sector??null)}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ia,children:"Reset"})})]}),f==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target: ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:ar[gt.targetIndex]})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{const c=n==="MISS"?void 0:n;K("Scam"),is(lr(gt,t,c))}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(K("Scam"),is(ri(gt,O)),R(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{K("Scam"),is(ri(gt,O)),R(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{is(eo()),Y("Scam")},children:"Reset"})]}),gt.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",gt.darts," darts!"]})]}),f==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score: ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[Oe.score,"/",Oe.target]})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{K("Fives"),os(cr(Oe,t))}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(K("Fives"),os(ai(Oe,O)),R(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{K("Fives"),os(ai(Oe,O)),R(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{os(no(Oe.target)),Y("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts: ",Oe.darts]}),Oe.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",Oe.target," in ",Oe.darts," darts!"]})]}),f==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score: ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[Ue.score,"/",Ue.target]})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{K("Sevens"),ds(ur(Ue,t))}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(K("Sevens"),ds(ii(Ue,O)),R(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{K("Sevens"),ds(ii(Ue,O)),R(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ds(io(Ue.target)),Y("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts: ",Ue.darts]}),Ue.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",Ue.target," in ",Ue.darts," darts!"]})]}),f==="Killer"&&e.jsx(e.Fragment,{children:ra?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Z.map(t=>{const n=ns[t.id],l=Es[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${n?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${n?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:n?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number: ",e.jsx("span",{className:"font-semibold",children:l})]}),e.jsxs("div",{className:"text-sm",children:["Lives: ",e.jsx("span",{className:"font-semibold",children:n?.lives??0})]})]},t.id)})}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{if(Mt)return;const c=n==="MISS"?void 0:n,u=l?.sector??null,v=Z[We];v&&(rs(g=>{const T={};Object.keys(g).forEach(b=>T[b]={...g[b]});const p=Za(v.id,T,c,u);if(p.becameKiller)et(`${v.name} became a Killer`);else if(p.victimId){const b=Z.find(w=>w.id===p.victimId);et(`${v.name} hit ${b?.name}'s ${Es[p.victimId]} (${p.livesRemoved} life${(p.livesRemoved||0)>1?"s":""})`)}else et("No effect");const j=ei(T);return j&&as(j),T}),Lt(g=>{const T=g+1;if(T>=3){let p=We;for(let j=1;j<=Z.length;j++){const b=(We+j)%Z.length,w=Z[b].id,we=ns[w];if(we&&!we.eliminated&&we.lives>0){p=b;break}}return At(p),0}return T}))}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(Mt)return;const l=ge.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!l){de("");return}const c=l[1]||"S",u=parseInt(l[2],10),v=c==="D"?"DOUBLE":c==="T"?"TRIPLE":"SINGLE",g=Z[We];rs(T=>{const p={};Object.keys(T).forEach(w=>p[w]={...T[w]});const j=Za(g.id,p,v,u);if(j.becameKiller)et(`${g.name} became a Killer`);else if(j.victimId){const w=Z.find(we=>we.id===j.victimId);et(`${g.name} hit ${w?.name}'s ${Es[j.victimId]} (${j.livesRemoved} life${(j.livesRemoved||0)>1?"s":""})`)}else et("No effect");const b=ei(p);return b&&as(b),p}),de(""),Lt(T=>{const p=T+1;if(p>=3){let j=We;for(let b=1;b<=Z.length;b++){const w=(We+b)%Z.length,we=Z[w].id,Ge=ns[we];if(Ge&&!Ge.eliminated&&Ge.lives>0){j=w;break}}return At(j),0}return p})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=We;for(let n=1;n<=Z.length;n++){const l=(We+n)%Z.length,c=Z[l].id,u=ns[c];if(u&&!u.eliminated&&u.lives>0){t=l;break}}At(t),Lt(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{rs({}),Sn({}),Cn(!1),At(0),Lt(0),as(null),et("")},children:"Reset"})]}),Mt&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner: ",Z.find(t=>t.id===Mt)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{rs({}),Sn({}),Cn(!1),At(0),Lt(0),as(null),et("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:Z.map((t,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:l=>{const c=l.target.value;wn(u=>u.map((v,g)=>g===n?{...v,name:c}:v))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>wn(l=>l.filter((c,u)=>u!==n)),disabled:Z.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>wn(t=>{const n=`p${t.length+1}`;return[...t,{id:n,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(Z.length<2){alert("Need at least 2 players");return}const t=Z.map(c=>c.id),n=zl(t),l={};t.forEach(c=>{l[c]=Gl(n[c])}),Sn(n),rs(l),At(0),Lt(0),as(null),et("Assigned numbers"),Cn(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-3 min-h-0 flex-1 text-[14px]",children:[e.jsxs("div",{className:"basis-1/2 shrink-0 min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",children:[e.jsx("div",{className:"text-sm font-semibold opacity-80",children:"Scoreboard"}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ze,{gameMode:f,players:zs,matchScore:`${Q}-${le}`})}),ee&&e.jsxs("div",{className:"p-4 rounded-2xl bg-slate-900/60 border border-white/10 text-slate-100 shadow-lg backdrop-blur-sm flex-shrink-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("h4",{className:"text-sm font-semibold tracking-wide uppercase text-indigo-200",children:"Manual Scoring"}),e.jsx("span",{className:"text-xs text-white/60",children:"Override a visit or enter dart-by-dart scores."})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Single Dart"}),e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:60,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?Qn():Js())},placeholder:"60"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Js,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Three Dart Edit"}),e.jsx("input",{className:"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:W<=170?170:180,value:Qs,onChange:t=>wa(t.target.value),onKeyDown:t=>{t.key==="Enter"&&en()},placeholder:"100"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:en,children:"Commit Visit"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:Qn,children:"Undo Visit"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Manual"}),e.jsx("input",{className:"input w-28 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?sn():ys())},placeholder:"T20"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ys,children:"Apply"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:sn,disabled:ae===0,children:"Replace Last"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/60",children:"Multi-entry (one per line)"}),e.jsx("textarea",{className:"mt-2 w-full rounded-xl bg-slate-950/70 border border-white/10 text-sm text-slate-100 placeholder-white/40 p-3 focus:outline-none focus:border-emerald-400/60 focus:ring-2 focus:ring-emerald-500/30",rows:3,value:Bn,onChange:t=>vs(t.target.value),placeholder:`T20
D16
25`}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ka,children:"Apply All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>vs(""),children:"Clear"})]})]}),e.jsx("div",{className:"pt-2 border-t border-white/10 mt-3",children:e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:Kn,disabled:ae===0&&Ke===0,children:"Clear Current Visit"})})]})]})]}),N&&e.jsx("div",{className:"basis-1/2 shrink-0 min-w-0 rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n)=>{const l=n??"MISS",c=Number.isFinite(t)?Math.max(0,t):0,u=Date.now();if(c<=0){if(l!=="MISS"||u-(jt.current||0)<1200)return;jt.current=u}else jt.current=0;zt(c)}})})]}),f==="X01"&&!N&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:f,players:zs,matchScore:`${Q}-${le}`})}),f==="Cricket"&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:"Cricket",players:Ii})}),f==="Cricket"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{t>0&&Yn(t,n==="MISS"?void 0:n,l?.sector??null)}})}),f==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:"Shanghai",players:Fi})}),f==="Shanghai"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{t>0&&Jn(t,n==="MISS"?void 0:n,l?.sector??null)}})}),f==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:"Killer",players:Pi})}),f==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:"Scam",players:Bi})}),f==="Scam"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{t>0&&is(lr(gt,t,n))}})}),f==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:"Fives",players:Oi})}),f==="Fives"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{t>0&&os(cr(Oe,t))}})}),f==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(ze,{gameMode:"Sevens",players:Ui})}),f==="Sevens"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(_,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,n,l)=>{t>0&&ds(ur(Ue,t))}})}),e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:O,onChange:t=>R(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?Qn():Js())}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Js,title:"Add a single dart (0â€“60)",children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:W<=170?170:180,placeholder:"Visit total (0â€“180)",value:Qs,onChange:t=>wa(t.target.value),onKeyDown:t=>{t.key==="Enter"&&en()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:en,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D16, 5, 25, 50)",value:ge,onChange:t=>de(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.shiftKey?sn():ys())}}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:sn,disabled:ae===0,children:"Replace Last"}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ys,children:"Add"})]}),e.jsxs("div",{children:[e.jsx("textarea",{className:"input w-full h-24 resize-none",placeholder:`Type scores manually (one per line, e.g. T20
D16
5
25
50) - No camera needed!`,value:Bn,onChange:t=>vs(t.target.value)}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ka,children:"Add All Scores"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>vs(""),children:"Clear"})]})]})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Enter to Add Â· Shift+Enter to Replace Last"})]}),e.jsx("div",{className:"h-1"})]})]})})}),Be&&e.jsx(go,{onClose:()=>ne(!1)}),Zn&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const n=await(await fetch(`${vo}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s?.email})})).json();n.ok&&n.url?(window.location.href=n.url,n.development&&ce("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):n.error==="STRIPE_NOT_CONFIGURED"?ce("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):ce("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{ce("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â· ",vl(jl(),5)]})]})]}),Mi&&typeof document<"u"?Ga.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>Ut(!1),children:e.jsx(ws,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>Ut(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>Ut(!1),children:"Close"})]}),e.jsx(qa,{fill:!0,user:s,playerScore:W,aiScore:G,x01Score:E,inMatch:Qe,showWinPopup:kt,pendingLegWinner:Tt,playerDartsThrown:Fs,aiDartsThrown:Bs,totalPlayerDarts:bs,totalAiDarts:ps,totalPlayerPoints:Mn,totalAiPoints:Rn,player180s:ca,player140s:Si,player100s:Ci,ai180s:da,ai140s:ki,ai100s:Di,playerHighestCheckout:Ti,aiHighestCheckout:Ai,onClose:()=>Ut(!1),onOpen:()=>Ut(!0),layout:a})]})})}),document.body):null,Ks&&typeof document<"u"?Ga.createPortal((()=>{const{target:t,value:n,stage:l}=Ks,c=t==="player"?lt:$t,u=t==="player"?Q:le;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:Ns,children:e.jsx(ws,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:Ns,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",l," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:l===1?e.jsxs(e.Fragment,{children:["Set ",c,"'s legs to ",e.jsx("span",{className:"font-semibold text-white",children:n}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",c,"'s legs to ",e.jsx("span",{className:"font-semibold text-white",children:n}),". Select ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:u})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:Ns,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Gi,children:"Yes"})]})]})})})})(),document.body):null,kt&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs(ws,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsx("label",{className:"block mb-1",children:"Darts to hit double:"}),e.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(t=>e.jsx("button",{className:`btn ${h===t?"bg-brand-600":""}`,onClick:()=>S(t),children:t},t))}),e.jsx("label",{className:"block mb-1",children:"Darts for checkout:"}),e.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(t=>e.jsx("button",{className:`btn ${C===t?"bg-brand-600":""}`,onClick:()=>D(t),children:t},t))}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:rl,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{z(!1),_t()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{z(!1),qt(!1),$e(!1)},children:"Back to Menu"})]})]})}),Li&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(ws,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[f," Â· ",E," start Â· First to ",Ze]}),(()=>{const t=bs>0?Mn/bs*3:0,n=t*3,l=(()=>{const b=H.filter(w=>w.winner==="player"&&typeof w.winnerDarts=="number").map(w=>w.winnerDarts);return b.length?`${Math.min(...b)} darts`:"â€”"})(),c=(()=>{const b=H.filter(w=>w.winner==="player"&&typeof w.winnerDarts=="number").map(w=>w.winnerDarts);return b.length?`${Math.max(...b)} darts`:"â€”"})(),u=xs>0?Math.round(An/xs*100):0,v=ps>0?Rn/ps*3:0,g=v*3,T=(()=>{const b=H.filter(w=>w.winner==="ai"&&typeof w.winnerDarts=="number").map(w=>w.winnerDarts);return b.length?`${Math.min(...b)} darts`:"â€”"})(),p=(()=>{const b=H.filter(w=>w.winner==="ai"&&typeof w.winnerDarts=="number").map(w=>w.winnerDarts);return b.length?`${Math.max(...b)} darts`:"â€”"})(),j=fs>0?Math.round(Ln/fs*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:s?.username||"You"}),e.jsx("div",{className:"text-3xl font-extrabold",children:Q}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 9DA"}),e.jsx("div",{className:"font-semibold",children:n.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:xs})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[u,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:l})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:c})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ca})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[Q," â€“ ",le]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:U==="None"?"Opponent":`${U} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:le}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:v.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 9DA"}),e.jsx("div",{className:"font-semibold",children:g.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:fs})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[j,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:T})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:da})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:H.map((t,n)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",n+1,": ",t.winner==="player"?"You":U==="None"?"Opp":"AI"," Â· Dbl ",t.doubleDarts," Â· CO ",t.checkoutDarts]},n))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Shot Heat Map"}),e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black p-3",children:e.jsx(Pl,{})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>Pn(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{Pn(!1),_t()},children:"Rematch"})]})]})}),H.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:H.map((t,n)=>e.jsxs("li",{children:["Leg ",n+1,": Double darts: ",t.doubleDarts,", Checkout darts: ",t.checkoutDarts]},n))})]})]})]})}export{Vo as default};
//# sourceMappingURL=OfflinePlay-COzAwYbj.js.map
