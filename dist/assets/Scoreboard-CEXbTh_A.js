import{i as W,a3 as D,j as e,R as L,t as E}from"./index-BKEuFezv.js";import{f as y}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";import"./ui-DwoKAdU7.js";function B({matchActions:l}={}){const{players:m,currentPlayerIdx:x,addVisit:w,undoVisit:S,endLeg:j,nextPlayer:b,endGame:R,inProgress:N,startingScore:h,bestLegThisMatch:v}=W(),p=D(t=>t.entries),P=t=>{try{const s=m[t],n=s?.legs?.[s.legs.length-1],o=n?.visits?.[n.visits.length-1]?.entries;return Array.isArray(o)?o:null}catch{return null}};function M(){try{const t={ts:Date.now(),players:m.map(s=>{const n=s.legs.reduce((c,i)=>{c.points+=i.totalScoreStart-i.totalScoreRemaining;const d=(i.visits||[]).reduce((g,a)=>g+(a.darts||0),0);return c.darts+=d,c},{points:0,darts:0}),r=n.darts,o=r>0?n.points/r*3:0;return{id:s.id,name:s.name,legsWon:s.legsWon,dartsThrown:r,avg:Math.round(o*100)/100}}),winner:m.reduce((s,n)=>n.legsWon>(s?.legsWon||0)?n:s,m[0])?.name};try{localStorage.setItem("ndn_last_match",JSON.stringify(t))}catch{}}catch{}(l?.endGame??R)()}return e.jsx(L,{storageKey:"ndn:modal:scoreboard",className:"ndn-modal w-full h-full relative",defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-3",children:e.jsx("div",{className:"ndn-hscroll",children:e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3",children:e.jsxs("div",{className:"col-span-2 card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Score Input"}),N?e.jsx(E,{inProgress:N,startingScore:h,pendingEntries:p,onAddVisit:(t,s)=>{const n=m[x],r=n.legs[n.legs.length-1];let i=(r?r.totalScoreRemaining:h)-(typeof t=="number"?t:0);(!Number.isFinite(i)||i<0)&&(i=0),l?.addVisit?l.addVisit(t,s):w(t,s),i===0?l?.endLeg?l.endLeg(t):j(t):(l?.nextPlayer??b)()},onUndo:()=>(l?.undoVisit??S)(),onEndLeg:t=>{(l?.endLeg??j)(t??0)},onNextPlayer:()=>(l?.nextPlayer??b)(),onEndGame:M,quickButtons:[180,140,100,60]}):e.jsx("p",{className:"text-slate-600",children:"No game in progress."}),e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map((t,s)=>{const n=t.legs[t.legs.length-1],r=n?n.totalScoreRemaining:h,o=t.legs.reduce((d,g)=>{d.points+=g.totalScoreStart-g.totalScoreRemaining;const a=(g.visits||[]).reduce((u,f)=>u+(f.darts||0),0);return d.darts+=a,d},{points:0,darts:0}),c=o.darts,i=c>0?o.points/c*3:0;return e.jsxs("div",{className:`card glass transition-shadow transition-all duration-150 ease-out ${s===x?"ring-2 ring-brand-400":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold",children:t.name}),e.jsxs("span",{className:"badge w-32 justify-center",children:["Legs Won: ",t.legsWon]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-1 h-3 w-full","aria-hidden":!0,children:[0,1,2].map(d=>{const g=P(s),a=s===x?p[d]??null:g?.[d]??null,u=a==null,f=a!=null&&(typeof a.ring=="string"?a.ring!=="MISS":typeof a.value=="number"?a.value>0:!0),V=`visit-dot ${s===x&&!u?"active":"inactive"} ${u?"bg-gray-400/60":f?"bg-emerald-400":"bg-rose-500"}`;return e.jsx("span",{className:V},d)})}),e.jsx("div",{className:"text-2xl font-bold",children:r}),e.jsx("div",{className:"h-1 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70 transition-all duration-200 ease-out",style:{width:`${Math.max(0,Math.min(100,(1-r/h)*100))}%`}})})]}),e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Darts"}),e.jsx("div",{className:"text-xl font-bold",children:c})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"text-xl font-bold",children:y(t.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg (Match)"}),e.jsx("div",{className:"text-xl font-bold",children:y(i)})]})]})]},t.id)})}),v&&e.jsxs("div",{className:"mt-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsx("strong",{children:"Best Leg (this match):"})," Player"," ",m.find(t=>t.id===v.playerId)?.name," ","in ",v.darts," darts"]})]})})})})})}export{B as default};
//# sourceMappingURL=Scoreboard-CEXbTh_A.js.map
