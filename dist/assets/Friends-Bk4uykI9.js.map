{"version":3,"file":"Friends-Bk4uykI9.js","sources":["../../src/store/messages.ts","../../src/utils/profanity.ts","../../src/components/Friends.tsx"],"sourcesContent":["import { create } from \"zustand\";\n\nexport type DM = { id: string; from: string; message: string; ts: number };\n\ntype MessagesState = {\n  inbox: DM[];\n  unread: number;\n  inGame: boolean;\n  setInGame: (v: boolean) => void;\n  add: (m: DM) => void;\n  load: (arr: DM[]) => void;\n  markAllRead: () => void;\n  remove: (id: string) => void;\n};\n\nconst LS_INBOX = \"ndn:messages:inbox\";\nconst LS_UNREAD = \"ndn:messages:unread\";\n\nfunction loadInitial() {\n  try {\n    const raw = localStorage.getItem(LS_INBOX);\n    const arr = raw ? (JSON.parse(raw) as DM[]) : [];\n    const unread = Number(localStorage.getItem(LS_UNREAD) || \"0\") || 0;\n    // sanitize\n    const inbox = Array.isArray(arr)\n      ? arr.filter((m) => m && typeof m.id === \"string\").slice(0, 200)\n      : [];\n    return { inbox, unread };\n  } catch {\n    return { inbox: [], unread: 0 };\n  }\n}\n\nfunction save(inbox: DM[], unread: number) {\n  try {\n    localStorage.setItem(LS_INBOX, JSON.stringify(inbox));\n  } catch {}\n  try {\n    localStorage.setItem(LS_UNREAD, String(unread));\n  } catch {}\n}\n\nconst initial = loadInitial();\n\nexport const useMessages = create<MessagesState>((set, get) => ({\n  inbox: initial.inbox,\n  unread: initial.unread,\n  inGame: false,\n  setInGame: (v) => set({ inGame: v }),\n  add: (m) =>\n    set((s) => {\n      const exists = s.inbox.some((x) => x.id === m.id && x.ts === m.ts);\n      const list = exists ? s.inbox : [m, ...s.inbox].slice(0, 200);\n      const unread = s.unread + (exists ? 0 : 1);\n      save(list, unread);\n      return { inbox: list, unread };\n    }),\n  load: (arr) =>\n    set((s) => {\n      const sorted = [...arr].sort((a, b) => b.ts - a.ts).slice(0, 200);\n      save(sorted, s.unread);\n      return { inbox: sorted, unread: s.unread };\n    }),\n  markAllRead: () => {\n    const s = get();\n    save(s.inbox, 0);\n    set({ unread: 0 });\n  },\n  remove: (id) =>\n    set((s) => {\n      const list = s.inbox.filter((m) => m.id !== id);\n      const unread = s.unread; // keep unread count stable on deletion from history\n      save(list, unread);\n      return { inbox: list, unread };\n    }),\n}));\n","// Simple profanity filter: replaces detected profane words with asterisks of the same length.\n// Note: This is a lightweight heuristic and not exhaustive.\n\nconst patterns: RegExp[] = [\n  /\\b(f+[\\W_]*u+[\\W_]*c+[\\W_]*k+)\\b/gi,\n  /\\b(s+[\\W_]*h+[\\W_]*i+[\\W_]*t+)\\b/gi,\n  /\\b(b+[\\W_]*i+[\\W_]*t+[\\W_]*c+[\\W_]*h+)\\b/gi,\n  /\\b(a+[\\W_]*s+[\\W_]*s+[\\W_]*h+[\\W_]*o+[\\W_]*l+[\\W_]*e+)\\b/gi,\n  /\\b(d+[\\W_]*a+[\\W_]*m+[\\W_]*n+)\\b/gi,\n  /\\b(c+[\\W_]*r+[\\W_]*a+[\\W_]*p+)\\b/gi,\n  /\\b(p+[\\W_]*i+[\\W_]*s+[\\W_]*s+)\\b/gi,\n];\n\nfunction starify(match: string) {\n  // Preserve whitespace/punct positions; just replace letters/numbers with *\n  return match.replace(/[\\p{L}\\p{N}]/gu, \"*\");\n}\n\nexport function censorProfanity(input: string): string {\n  if (!input) return input;\n  let out = input;\n  for (const re of patterns) {\n    out = out.replace(re, (m) => starify(m));\n  }\n  return out;\n}\n\nexport function containsProfanity(input: string): boolean {\n  if (!input) return false;\n  return patterns.some((re) => re.test(input));\n}\n","import { useEffect, useMemo, useState } from \"react\";\nimport { useToast } from \"../store/toast\";\nimport { useMessages } from \"../store/messages\";\nimport { censorProfanity } from \"../utils/profanity\";\nimport TabPills from \"./ui/TabPills\";\nimport { labelForMode } from \"../utils/games\";\n\ntype Friend = {\n  email: string;\n  username?: string;\n  status?: \"online\" | \"offline\" | \"ingame\";\n  lastSeen?: number;\n  roomId?: string | null;\n  match?: {\n    game: string;\n    mode: string;\n    value: number;\n    startingScore?: number;\n  } | null;\n};\n\nfunction timeAgo(ts?: number) {\n  if (!ts) return \"\";\n  const s = Math.floor((Date.now() - ts) / 1000);\n  if (s < 60) return `${s}s ago`;\n  const m = Math.floor(s / 60);\n  if (m < 60) return `${m}m ago`;\n  const h = Math.floor(m / 60);\n  if (h < 24) return `${h}h ago`;\n  const d = Math.floor(h / 24);\n  return `${d}d ago`;\n}\n\nexport default function Friends({ user }: { user?: any }) {\n  const toast = useToast();\n  const email = String(user?.email || \"\").toLowerCase();\n  const [friends, setFriends] = useState<Friend[]>([]);\n  const [suggested, setSuggested] = useState<Friend[]>([]);\n  const [results, setResults] = useState<Friend[]>([]);\n  const [q, setQ] = useState(\"\");\n  const [filter, setFilter] = useState<\n    \"all\" | \"online\" | \"offline\" | \"ingame\" | \"requests\"\n  >(\"all\");\n  const [loading, setLoading] = useState(false);\n  const msgs = useMessages();\n  const [requests, setRequests] = useState<\n    Array<{\n      id: string;\n      fromEmail: string;\n      fromUsername: string;\n      toEmail: string;\n      toUsername: string;\n      requestedAt: number;\n    }>\n  >([]);\n  const [outgoingRequests, setOutgoingRequests] = useState<\n    Array<{\n      id: string;\n      fromEmail: string;\n      fromUsername: string;\n      toEmail: string;\n      toUsername: string;\n      requestedAt: number;\n    }>\n  >([]);\n  const [messagePopup, setMessagePopup] = useState<{\n    show: boolean;\n    toUser?: string;\n    toEmail?: string;\n    replyTo?: string;\n  }>({ show: false });\n\n  async function refresh() {\n    if (!email) return;\n    try {\n      const [fl, sg, rq, out] = await Promise.all([\n        fetch(`/api/friends/list?email=${encodeURIComponent(email)}`).then(\n          (r) => r.json(),\n        ),\n        fetch(`/api/friends/suggested?email=${encodeURIComponent(email)}`).then(\n          (r) => r.json(),\n        ),\n        fetch(`/api/friends/requests?email=${encodeURIComponent(email)}`).then(\n          (r) => r.json(),\n        ),\n        fetch(`/api/friends/outgoing?email=${encodeURIComponent(email)}`).then(\n          (r) => r.json(),\n        ),\n      ]);\n      setFriends(fl.friends || []);\n      setSuggested(sg.suggestions || []);\n      setRequests(rq.requests || []);\n      setOutgoingRequests(out.requests || []);\n    } catch {}\n  }\n\n  useEffect(() => {\n    refresh();\n  }, [email]);\n\n  async function search(term: string) {\n    setQ(term);\n    if (!term) {\n      setResults([]);\n      return;\n    }\n    try {\n      const res = await fetch(\n        `/api/friends/search?q=${encodeURIComponent(term)}`,\n      );\n      const data = await res.json();\n      setResults(data.results || []);\n    } catch {}\n  }\n\n  async function addFriend(target: string) {\n    if (!email || !target) return;\n    setLoading(true);\n    try {\n      await fetch(\"/api/friends/add\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, friend: target }),\n      });\n      await refresh();\n      setQ(\"\");\n      setResults([]);\n      toast(\"Friend added\", { type: \"success\" });\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function removeFriend(target: string) {\n    if (!email || !target) return;\n    setLoading(true);\n    try {\n      await fetch(\"/api/friends/remove\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, friend: target }),\n      });\n      await refresh();\n      toast(\"Friend removed\", { type: \"info\" });\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function acceptFriend(requestId: string) {\n    try {\n      await fetch(\"/api/friends/accept\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, requestId }),\n      });\n      await refresh();\n      toast(\"Friend request accepted\", { type: \"success\" });\n    } catch {}\n  }\n\n  async function declineFriend(requestId: string) {\n    try {\n      await fetch(\"/api/friends/decline\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, requestId }),\n      });\n      await refresh();\n      toast(\"Friend request declined\", { type: \"info\" });\n    } catch {}\n  }\n\n  async function cancelRequest(requestId: string) {\n    try {\n      await fetch(\"/api/friends/cancel\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ email, requestId }),\n      });\n      await refresh();\n      toast(\"Friend request cancelled\", { type: \"info\" });\n    } catch {}\n  }\n\n  async function sendMessage() {\n    const input = document.getElementById(\n      \"message-input\",\n    ) as HTMLTextAreaElement;\n    const message = input?.value;\n    if (!message || !messagePopup.toEmail) return;\n    try {\n      await fetch(\"/api/friends/message\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          fromEmail: email,\n          toEmail: messagePopup.toEmail,\n          message,\n        }),\n      });\n      setMessagePopup({ show: false });\n      toast(\"Message sent\", { type: \"success\" });\n    } catch {}\n  }\n\n  const filtered = useMemo(() => {\n    if (filter === \"all\") return friends;\n    return friends.filter((f) => (f.status || \"offline\") === filter);\n  }, [friends, filter]);\n\n  const statusSummary = useMemo(() => {\n    const summary = { online: 0, ingame: 0, offline: 0 };\n    for (const f of friends) {\n      if (f.status === \"online\") summary.online += 1;\n      else if (f.status === \"ingame\") summary.ingame += 1;\n      else summary.offline += 1;\n    }\n    return summary;\n  }, [friends]);\n\n  async function spectate(roomId?: string | null) {\n    if (!roomId) {\n      toast(\"Room unavailable\", { type: \"error\" });\n      return;\n    }\n    try {\n      const ev = new CustomEvent(\"ndn:spectate-request\", {\n        detail: { roomId },\n      });\n      window.dispatchEvent(ev);\n      toast(\"Opening spectator view...\", { type: \"info\" });\n    } catch {}\n  }\n\n  // Friend Requests pill: use real requests data\n  const requestsCount = requests.length + outgoingRequests.length;\n  return (\n    <div className=\"card ndn-game-shell\">\n      <h2 className=\"text-2xl font-bold text-brand-700 mb-2\">Friends üë•</h2>\n      <p className=\"mb-2 text-brand-600\">\n        Manage your friends. See who's online, in-game, or offline; find new\n        teammates; and invite people to play.\n      </p>\n      <div className=\"grid gap-3 mb-4 grid-cols-2 sm:grid-cols-4\">\n        {[\n          {\n            label: \"Online\",\n            value: statusSummary.online,\n            accent: \"bg-emerald-500/10 border-emerald-500/40\",\n          },\n          {\n            label: \"In-Game\",\n            value: statusSummary.ingame,\n            accent: \"bg-amber-500/10 border-amber-500/40\",\n          },\n          {\n            label: \"Offline\",\n            value: statusSummary.offline,\n            accent: \"bg-slate-500/10 border-slate-500/40\",\n          },\n          {\n            label: \"Requests\",\n            value: requestsCount,\n            accent: \"bg-indigo-500/10 border-indigo-500/40\",\n          },\n        ].map((stat) => (\n          <div\n            key={stat.label}\n            className={`rounded-2xl border px-3 py-2 text-center ${stat.accent}`}\n          >\n            <div className=\"text-xs uppercase tracking-[0.3em] text-slate-400\">\n              {stat.label}\n            </div>\n            <div className=\"text-2xl font-semibold text-white\">\n              {stat.value}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4\">\n        <div className=\"md:col-span-2 p-4 rounded-[28px] bg-gradient-to-br from-slate-900/80 to-indigo-900/60 border border-white/10 shadow-2xl\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"font-semibold text-white/90\">Your Friends üë•</div>\n          </div>\n          <TabPills\n            tabs={[\n              { key: \"all\", label: \"All üë•\" },\n              { key: \"online\", label: \"Online üü¢\" },\n              { key: \"ingame\", label: \"In-Game üéÆ\" },\n              { key: \"offline\", label: \"Offline ‚ö™\" },\n              {\n                key: \"requests\",\n                label: `Requests ${requestsCount > 0 ? \"(\" + requestsCount + \")\" : \"\"} üì©`,\n              },\n            ]}\n            active={filter}\n            onChange={(k) => setFilter(k as any)}\n            className=\"mb-3\"\n          />\n          {filter === \"requests\" ? (\n            <ul className=\"space-y-3\">\n              {requestsCount > 0 ? (\n                <>\n                  {/* Incoming requests */}\n                  {requests.length > 0 &&\n                    requests.map((r) => (\n                      <li\n                        key={`incoming-${r.id || r.fromEmail}`}\n                        className=\"p-3 rounded-2xl border border-white/10 bg-slate-900/40 flex flex-col gap-3\"\n                      >\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-semibold text-lg\">\n                            {r.fromUsername || r.fromEmail || \"Unknown User\"}\n                          </span>\n                          <span className=\"text-xs bg-blue-600/20 text-blue-400 px-2 py-1 rounded\">\n                            Incoming\n                          </span>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <button\n                            onClick={() => acceptFriend(r.id)}\n                            className=\"px-3 py-1 rounded-lg bg-emerald-500/20 text-emerald-400 text-xs font-bold hover:bg-emerald-500/30 transition-colors\"\n                          >\n                            Accept ‚úÖ\n                          </button>\n                          <button\n                            onClick={() => declineFriend(r.id)}\n                            className=\"px-3 py-1 rounded-lg bg-rose-500/20 text-rose-400 text-xs font-bold hover:bg-rose-500/30 transition-colors\"\n                          >\n                            Decline ‚ùå\n                          </button>\n                        </div>\n                      </li>\n                    ))}\n                  {/* Outgoing requests */}\n                  {outgoingRequests.length > 0 &&\n                    outgoingRequests.map((r) => (\n                      <li\n                        key={`outgoing-${r.id || r.toEmail}`}\n                        className=\"p-3 rounded-2xl border border-white/10 bg-slate-900/40 flex flex-col gap-3\"\n                      >\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-semibold text-lg\">\n                            {r.toUsername || r.toEmail || \"Unknown User\"}\n                          </span>\n                          <div className=\"px-3 py-1 rounded-lg bg-white/5 text-white/40 text-xs font-bold\">\n                            Pending ‚è≥\n                          </div>\n                        </div>\n                        <button\n                          onClick={() => cancelRequest(r.id)}\n                          className=\"px-3 py-1 rounded-lg bg-rose-500/20 text-rose-400 text-xs font-bold hover:bg-rose-500/30 transition-colors\"\n                        >\n                          Cancel ‚úñÔ∏è\n                        </button>\n                      </li>\n                    ))}\n                </>\n              ) : (\n                <li className=\"text-sm opacity-70\">No friend requests yet.</li>\n              )}\n            </ul>\n          ) : (\n            <ul className=\"space-y-3\">\n              {filtered.map((f) => (\n                <li\n                  key={f.email}\n                  className=\"rounded-2xl border border-white/10 bg-slate-900/40 p-4 flex flex-col gap-3 shadow-lg\"\n                >\n                  <div className=\"flex flex-wrap items-center justify-between gap-3\">\n                    <div>\n                      <div className=\"flex items-center gap-2\">\n                        <span\n                          className={`inline-block w-2.5 h-2.5 rounded-full ${\n                            f.status === \"online\"\n                              ? \"bg-emerald-400\"\n                              : f.status === \"ingame\"\n                                ? \"bg-amber-400\"\n                                : \"bg-slate-400\"\n                          }`}\n                        ></span>\n                        <span className=\"font-semibold text-white\">\n                          {f.username || f.email}\n                        </span>\n                      </div>\n                      <div className=\"text-xs text-slate-400\">\n                        {f.status || \"offline\"}\n                        {f.status !== \"online\" && f.lastSeen\n                          ? ` ¬∑ ${timeAgo(f.lastSeen)}`\n                          : \"\"}\n                      </div>\n                      {f.status === \"ingame\" && f.match && (\n                        <div className=\"text-[11px] inline-flex items-center gap-1 mt-2 rounded-full border border-indigo-500/40 bg-indigo-500/10 px-3 py-0.5 text-indigo-200\">\n                          <span className=\"font-medium\">Live Match</span>\n                          <span>\n                            {f.match.game} {labelForMode(f.match.mode)}{\" \"}\n                            {f.match.value}\n                            {f.match.game === \"X01\" && f.match.startingScore\n                              ? ` ¬∑ ${f.match.startingScore}`\n                              : \"\"}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"flex gap-2 flex-wrap\">\n                      {f.status === \"ingame\" && f.roomId && (\n                        <button\n                          onClick={() => spectate(f.roomId)}\n                          className=\"px-3 py-1 rounded-lg bg-indigo-500/20 text-indigo-400 text-xs font-bold hover:bg-indigo-500/30 transition-colors\"\n                        >\n                          Spectate üëÅÔ∏è\n                        </button>\n                      )}\n                      <button\n                        onClick={() => {\n                          setMessagePopup({\n                            show: true,\n                            toEmail: f.email,\n                            toUser: f.username || f.email,\n                          });\n                        }}\n                        className=\"flex-1 px-3 py-2 rounded-xl bg-indigo-500/20 text-indigo-400 text-xs font-bold hover:bg-indigo-500/30 transition-colors\"\n                      >\n                        Message üí¨\n                      </button>\n                      <button\n                        onClick={() => removeFriend(f.email)}\n                        className=\"px-3 py-2 rounded-xl bg-rose-500/20 text-rose-400 text-xs font-bold hover:bg-rose-500/30 transition-colors\"\n                        title=\"Remove Friend\"\n                      >\n                        Remove üóëÔ∏è\n                      </button>\n                    </div>\n                  </div>\n                </li>\n              ))}\n              {filtered.length === 0 && (\n                <li className=\"text-sm opacity-70\">\n                  No friends {filter !== \"all\" ? `in ${filter}` : \"\"} yet.\n                </li>\n              )}\n            </ul>\n          )}\n        </div>\n\n        <div className=\"p-4 rounded-[28px] bg-slate-950/70 border border-white/10 shadow-xl\">\n          <div className=\"font-semibold mb-2 text-white/90\">Find Friends</div>\n          <input\n            className=\"input w-full mb-2\"\n            placeholder=\"Search by name or email\"\n            value={q}\n            onChange={(e) => search(e.target.value)}\n          />\n          <ul className=\"space-y-2 mb-3 max-h-48 overflow-auto\">\n            {results.map((r) => (\n              <li\n                key={r.email}\n                className=\"flex items-center justify-between gap-2 p-3 rounded-2xl border border-white/10 bg-slate-900/40\"\n              >\n                <div className=\"flex items-center gap-2\">\n                  <span\n                    className={`inline-block w-2 h-2 rounded-full ${r.status === \"online\" ? \"bg-emerald-400\" : r.status === \"ingame\" ? \"bg-amber-400\" : \"bg-slate-400\"}`}\n                  ></span>\n                  <span>{r.username || r.email}</span>\n                </div>\n                <button\n                  onClick={() => addFriend(r.email)}\n                  disabled={loading}\n                  className={`px-4 py-2 rounded-xl text-white text-sm font-bold transition-colors ${loading ? \"bg-indigo-900/40 cursor-not-allowed\" : \"bg-indigo-600 hover:bg-indigo-500\"}`}\n                >\n                  {loading ? \"Working‚Ä¶\" : \"Add ‚ûï\"}\n                </button>\n              </li>\n            ))}\n            {results.length === 0 && (\n              <li className=\"text-xs opacity-60\">Type to search...</li>\n            )}\n          </ul>\n          <div className=\"font-semibold mb-1 text-white/90\">Suggested</div>\n          <ul className=\"space-y-2 max-h-48 overflow-auto\">\n            {suggested.map((s) => (\n              <li\n                key={s.email}\n                className=\"flex items-center justify-between gap-2 p-3 rounded-2xl border border-white/10 bg-slate-900/40\"\n              >\n                <div className=\"flex items-center gap-2\">\n                  <span\n                    className={`inline-block w-2 h-2 rounded-full ${s.status === \"online\" ? \"bg-emerald-400\" : s.status === \"ingame\" ? \"bg-amber-400\" : \"bg-slate-400\"}`}\n                  ></span>\n                  <span>{s.username || s.email}</span>\n                </div>\n                <button\n                  onClick={() => addFriend(s.email)}\n                  disabled={loading}\n                  className={`px-4 py-2 rounded-xl text-white text-sm font-bold transition-colors ${loading ? \"bg-indigo-900/40 cursor-not-allowed\" : \"bg-indigo-600 hover:bg-indigo-500\"}`}\n                >\n                  {loading ? \"Working‚Ä¶\" : \"Add ‚ûï\"}\n                </button>\n              </li>\n            ))}\n            {suggested.length === 0 && (\n              <li className=\"text-xs opacity-60\">No suggestions right now.</li>\n            )}\n          </ul>\n        </div>\n      </div>\n\n      {/* Direct Messages */}\n      <div className=\"p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <div className=\"font-semibold\">Messages üí¨</div>\n          <button\n            onClick={() => msgs.markAllRead()}\n            className=\"text-xs text-indigo-400 font-bold hover:text-indigo-300 transition-colors\"\n          >\n            Mark all read ‚úÖ\n          </button>\n        </div>\n        {msgs.inbox.length === 0 ? (\n          <div className=\"text-sm opacity-70\">No messages yet.</div>\n        ) : (\n          <ul className=\"space-y-2 max-h-72 overflow-auto\">\n            {msgs.inbox.map((m) => (\n              <li key={m.id} className=\"p-2 rounded bg-black/20 text-sm\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <span className=\"font-semibold\">{m.from}</span>{\" \"}\n                    <span className=\"opacity-70 text-xs\">\n                      ¬∑ {new Date(m.ts).toLocaleString()}\n                    </span>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => {\n                        setMessagePopup({\n                          show: true,\n                          toEmail: m.from,\n                          toUser: m.from,\n                        });\n                      }}\n                      className=\"px-3 py-1 rounded-lg bg-indigo-500/20 text-indigo-400 text-xs font-bold hover:bg-indigo-500/30 transition-colors\"\n                    >\n                      Reply ‚Ü©Ô∏è\n                    </button>\n                    <button\n                      onClick={() => msgs.remove(m.id)}\n                      className=\"px-3 py-1 rounded-lg bg-rose-500/20 text-rose-400 text-xs font-bold hover:bg-rose-500/30 transition-colors\"\n                    >\n                      Delete üóëÔ∏è\n                    </button>\n                    <button\n                      className=\"btn bg-rose-600 hover:bg-rose-700 px-2 py-1 text-xs\"\n                      onClick={async () => {\n                        const reason = prompt(\"Report reason (what happened)?\");\n                        if (!reason) return;\n                        try {\n                          await fetch(\"/api/friends/report\", {\n                            method: \"POST\",\n                            headers: { \"Content-Type\": \"application/json\" },\n                            body: JSON.stringify({\n                              reporterEmail: email,\n                              offenderEmail: m.from,\n                              reason,\n                              messageId: m.id,\n                            }),\n                          });\n                          toast(\"Report sent to admin\", { type: \"info\" });\n                        } catch {}\n                      }}\n                    >\n                      Report\n                    </button>\n                  </div>\n                </div>\n                <div className=\"mt-1 whitespace-pre-wrap break-words\">\n                  {censorProfanity(m.message)}\n                </div>\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n\n      {/* Message Popup */}\n      {messagePopup.show && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4\">\n            <div className=\"text-center mb-4\">\n              <h3 className=\"text-lg font-semibold text-white\">\n                Send Message ‚úâÔ∏è\n              </h3>\n            </div>\n            {/* eslint-disable jsx-a11y/no-autofocus */}\n            <textarea\n              className=\"w-full h-32 bg-slate-700 border border-slate-600 rounded p-3 text-white placeholder-slate-400 resize-none\"\n              placeholder=\"Type your message here...\"\n              id=\"message-input\"\n              autoFocus\n            />\n            {/* eslint-enable jsx-a11y/no-autofocus */}\n            <div className=\"flex gap-3 mt-4\">\n              <button\n                onClick={sendMessage}\n                className=\"px-6 py-2 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-500 transition-colors\"\n              >\n                Send Message üì§\n              </button>\n              <button\n                className=\"btn bg-slate-600 hover:bg-slate-700\"\n                onClick={() => setMessagePopup({ show: false })}\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["LS_INBOX","LS_UNREAD","loadInitial","raw","arr","unread","m","save","inbox","initial","useMessages","create","set","get","v","s","exists","x","list","sorted","a","b","id","patterns","starify","match","censorProfanity","input","out","re","timeAgo","ts","h","Friends","user","toast","useToast","email","friends","setFriends","useState","suggested","setSuggested","results","setResults","q","setQ","filter","setFilter","loading","setLoading","msgs","requests","setRequests","outgoingRequests","setOutgoingRequests","messagePopup","setMessagePopup","refresh","fl","sg","rq","r","useEffect","search","term","data","addFriend","target","removeFriend","acceptFriend","requestId","declineFriend","cancelRequest","sendMessage","message","filtered","useMemo","f","statusSummary","summary","spectate","roomId","ev","requestsCount","jsxs","jsx","stat","TabPills","k","Fragment","labelForMode","reason"],"mappings":"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"}