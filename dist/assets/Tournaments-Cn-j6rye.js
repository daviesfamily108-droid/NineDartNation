import{j as e,B as ie,i as oe,u as _,k as G,O as qe,Q as Fe,l as Ye,M as ge,S as Qe,C as Le,U as Ke,G as He,P as Ze,m as Oe,n as et,o as tt,e as st,F as at,E as Re,V as nt,a as V}from"./index-CMUmc1rS.js";import{r as n}from"./ui-DygUIHRq.js";import{o as rt,l as lt}from"./matchWindow-CmM3madn.js";import{M as it}from"./MatchControls-C038Tlq5.js";import"./vendor-D3F3s8fL.js";function ot({t:l,onJoin:g,onLeave:u,joined:i,disabled:U}){return e.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"font-semibold",children:[l.title,l.official&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded bg-amber-500 text-black text-xs",children:"Official"})]}),e.jsxs("div",{className:"text-sm opacity-80",children:[l.game,l.game==="X01"?"/501":""," Â· ",ie(l.mode)," ",l.value," Â·"," ",new Date(l.startAt).toLocaleString()," Â· Cap ",l.capacity," Â· Joined"," ",l.participants?.length||0]}),e.jsxs("div",{className:"text-xs opacity-60 mt-1",children:["Created by: ",l.creatorName||l.creatorEmail||"Unknown"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:`btn ${i?"bg-emerald-600 hover:bg-emerald-600":""}`,disabled:U,onClick:()=>i?u&&u(l):g&&g(l),children:i?"Already Joined! âœ…":"Join Now âš”ï¸"})})]})}function ct({user:l,showStartShowcase:g,onShowStartShowcaseChange:u}){const i=oe();_(a=>a.hideInGameSidebar??!0),G(a=>a.setPaused),G(),qe();const[U,ce]=n.useState(null),[Ce]=n.useState(null),te=_(a=>a.lastOffline?.x01Start||501),se=_(a=>a.user),B=l?.username||l?.name||l?.displayName||l?.email?.split("@")[0]||se?.username||se?.name||se?.displayName||se?.email?.split("@")[0],X=(i.players||[]).findIndex(a=>a?.name&&a.name===B),P=X>=0?X:0,c=(i.currentPlayerIdx??0)===P,E=i.players?.[P],M=E?.legs?.[E.legs.length-1]?.totalScoreRemaining??i.startingScore??te,q=(i.players||[]).findIndex((a,o)=>o!==P),I=(i.players||[])[q>=0?q:0],h=I?.legs?.[I.legs.length-1]?.totalScoreRemaining??i.startingScore??te,N=(i?.game||"X01")??"X01",ae=Fe(N,i),R=_(a=>a.callerEnabled),je=_(a=>a.callerVoice),de=_(a=>a.callerVolume),me=_(a=>a.speakCheckoutOnly),[ue,A]=n.useState(!1),F=G(a=>a.setPaused),m=G(a=>a.paused),y=G(a=>a.pauseEndsAt),p=G(a=>a.pauseInitiator),[ne,xe]=n.useState(Date.now());n.useEffect(()=>(document.documentElement.setAttribute("data-ndn-ingame","true"),()=>{document.documentElement.removeAttribute("data-ndn-ingame")}),[]),n.useEffect(()=>{if(!m||!y)return;const a=setInterval(()=>{const o=Date.now();xe(o),o>=y&&F(!1,null)},250);return()=>clearInterval(a)},[m,y,F]);const Y=n.useMemo(()=>{if(N!=="X01"||M>170||M<=0)return null;const a=Ye(M);return a&&a.length>0?a:null},[N,M]),D=n.useMemo(()=>(i.players||[]).map(o=>({name:o.name||"Player",legsWon:o.legsWon||0})),[i.players]),z=typeof g=="boolean"?g:!0,Q=a=>{u?.(a)},$=n.useRef(!0);n.useEffect(()=>{$.current&&Q(!0)},[]);const ve=(a,o,S)=>{const v=i.players?.[i.currentPlayerIdx],w=v?.legs?.[v.legs.length-1],L=w?w.totalScoreRemaining:i.startingScore,k=typeof a=="number"?a:0;let j=L-k;if((!Number.isFinite(j)||j<0)&&(j=0),R){const K=v?.name||et(l,"Player");try{tt(K,k,j,je,{volume:de,checkoutOnly:me})}catch{}}i.addVisit(k,o,S??{visitTotal:k}),j===0?i.endLeg(k):i.nextPlayer()},J=n.useCallback(()=>{try{const a=[];if((i.players||[]).forEach(v=>{(v.legs||[]).forEach(w=>{if(w?.finished){const L=(w.visits||[]).slice(-1)[0];a.push({ts:w.endTime||Date.now(),visit:L,player:v})}})}),!a.length)return null;const o=a.sort((v,w)=>w.ts-v.ts)[0],S=(o.visit?.entries||[]).slice(-1)[0];if(S?.label)return S.label;if(S?.ring==="DOUBLE"&&typeof S?.value=="number")return`Double ${S.value/2}`;if(typeof o.visit?.visitTotal=="number")return`Checkout ${o.visit.visitTotal}`}catch{}return null},[i.players]);return n.useEffect(()=>{if(i.inProgress){ce(null);return}if(!U?.label){const a=J();a&&ce(o=>({...o,label:a}))}},[i.inProgress,J,U?.label]),e.jsxs("div",{className:"card ndn-game-shell ndn-page ndn-ingame-active relative overflow-hidden md:overflow-hidden overflow-y-auto",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-32 -left-32 w-96 h-96 rounded-full bg-indigo-600/10 blur-[120px]"}),e.jsx("div",{className:"absolute -bottom-32 -right-32 w-96 h-96 rounded-full bg-amber-500/8 blur-[120px]"})]}),z&&e.jsx(ge,{open:z,players:i.players||[],onDone:()=>{$.current=!1,Q(!1)},onRequestClose:()=>{$.current=!1,Q(!1)},showCalibrationDefault:!0}),e.jsx("div",{className:"sticky top-0 z-20 mb-3",children:e.jsxs("div",{className:"relative flex items-center justify-between gap-2 px-3 sm:px-5 py-2.5 rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl shadow-lg",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-2xl bg-gradient-to-r from-indigo-500/10 via-transparent to-amber-500/10"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm leading-none z-10",children:[e.jsxs("span",{className:"px-3 py-1 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-xs font-semibold tracking-wide",children:[N,N==="X01"?` / ${i.startingScore||te}`:""]}),D.length>=2&&e.jsxs("span",{className:"font-bold text-white/90 text-sm tabular-nums",children:["Legs: ",D[0].legsWon," â€“ ",D[1].legsWon]})]}),e.jsxs("div",{className:"flex items-center gap-2 z-10",children:[e.jsx(Qe,{}),e.jsx("button",{className:"px-4 py-1.5 rounded-xl text-sm font-semibold bg-rose-600/90 hover:bg-rose-500 text-white border border-rose-400/30 shadow-lg shadow-rose-500/20 transition-all",onClick:()=>A(!0),children:"â¸ Quit / Pause"})]})]})}),e.jsxs("div",{className:"relative mb-4 rounded-2xl border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-950/80 via-slate-900/90 to-amber-950/80"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(255,255,255,0.03),transparent_70%)]"}),e.jsxs("div",{className:"relative grid grid-cols-[1fr_auto_1fr] items-center py-4 sm:py-6 px-3 sm:px-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:`text-xs sm:text-sm font-bold uppercase tracking-widest ${c?"text-emerald-400":"text-slate-400"}`,children:E?.name||"You"}),e.jsx("div",{className:`font-mono text-5xl sm:text-7xl md:text-8xl font-black tabular-nums leading-none ${c?"text-white":"text-white/60"}`,children:M}),c&&e.jsx("div",{className:"mt-1 px-3 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/40 text-emerald-300 text-[10px] sm:text-xs font-semibold uppercase tracking-wider animate-pulse",children:"â— Throwing"}),e.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-400 tabular-nums",children:["Legs: ",E?.legsWon||0]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 px-3 sm:px-6",children:[e.jsx("div",{className:"w-px h-8 sm:h-12 bg-gradient-to-b from-transparent via-white/20 to-transparent"}),e.jsx("div",{className:"text-lg sm:text-2xl font-black text-white/30 tracking-widest",children:"VS"}),e.jsx("div",{className:"w-px h-8 sm:h-12 bg-gradient-to-b from-transparent via-white/20 to-transparent"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:`text-xs sm:text-sm font-bold uppercase tracking-widest ${c?"text-slate-400":"text-amber-400"}`,children:I?.name||"Opponent"}),e.jsx("div",{className:`font-mono text-5xl sm:text-7xl md:text-8xl font-black tabular-nums leading-none ${c?"text-white/60":"text-white"}`,children:h}),!c&&e.jsx("div",{className:"mt-1 px-3 py-0.5 rounded-full bg-amber-500/20 border border-amber-400/40 text-amber-300 text-[10px] sm:text-xs font-semibold uppercase tracking-wider animate-pulse",children:"â— Throwing"}),e.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-400 tabular-nums",children:["Legs: ",I?.legsWon||0]})]})]}),Y&&e.jsxs("div",{className:"relative border-t border-emerald-400/20 bg-emerald-500/10 px-4 py-2 flex items-center gap-3",children:[e.jsxs("span",{className:"text-[10px] sm:text-xs uppercase tracking-wider text-emerald-300/80 font-semibold whitespace-nowrap",children:["Checkout ",M,":"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:Y.map((a,o)=>e.jsx("span",{className:"px-2 py-0.5 rounded-lg bg-emerald-500/20 border border-emerald-400/20 text-emerald-100 text-xs sm:text-sm font-medium",children:a},o))})]})]}),e.jsx("div",{className:"ndn-shell-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr] gap-3 md:gap-4 items-stretch",children:[e.jsx("div",{className:"min-w-0",children:e.jsxs("div",{className:"relative rounded-2xl border border-white/10 bg-slate-950/70 shadow-2xl ring-1 ring-white/5 h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-white/5 bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-emerald-400 shadow-lg shadow-emerald-400/50":"bg-amber-400 shadow-lg shadow-amber-400/50"}`}),e.jsx("span",{className:"text-xs sm:text-sm font-semibold text-white/80",children:c?"Your Camera":"Opponent Camera"})]}),e.jsx("span",{className:`text-[10px] sm:text-xs font-medium ${c?"text-emerald-300":"text-amber-300"}`,children:c?"LIVE â€” Your turn":"Waitingâ€¦"})]}),e.jsxs("div",{className:"relative min-h-[10rem] max-h-[40vh] md:max-h-none md:flex-1 bg-black",children:[c?e.jsx(Le,{hideInlinePanels:!0,forceAutoStart:!0,onAddVisit:ve,onEndLeg:a=>{try{i.endLeg(a??0)}catch{}},onVisitCommitted:(a,o,S,v)=>{if(!S)return;const w=v?.frame??Ce??null;ce({label:v?.label||J()||void 0,ring:v?.ring,frame:w,ts:Date.now()});try{i.endGame()}catch{}}}):e.jsx(Le,{hideInlinePanels:!0,forceAutoStart:!0}),N==="X01"&&!c&&e.jsx(Ke,{checkoutRemaining:M,away:{side:"Away",name:I?.name||"Away",legsWon:I?.legsWon||0,remaining:h},home:{side:"Home",name:E?.name||"Home",legsWon:E?.legsWon||0,remaining:M}})]})]})}),e.jsxs("div",{className:"min-w-0 flex flex-col gap-3",children:[e.jsxs("div",{className:"relative rounded-2xl border border-white/10 bg-slate-950/70 shadow-2xl ring-1 ring-white/5 p-3 sm:p-4 overflow-hidden",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-br from-white/[0.02] to-transparent"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm sm:text-base font-bold text-white/90 tracking-wide",children:"Your Scoreboard"}),e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] sm:text-xs font-semibold ${c?"bg-emerald-500/20 border border-emerald-400/30 text-emerald-300":"bg-slate-500/20 border border-slate-400/20 text-slate-400"}`,children:c?"Your turn":"Opponent's turn"})]}),e.jsx(He,{gameMode:N,players:ae})]}),e.jsxs("div",{className:`relative rounded-2xl border shadow-2xl ring-1 ring-white/5 p-3 sm:p-4 overflow-hidden transition-all ${c?"border-white/10 bg-slate-950/70":"border-white/5 bg-slate-950/40 opacity-60"}`,children:[e.jsx("div",{className:`pointer-events-none absolute inset-0 bg-gradient-to-br ${c?"from-emerald-500/[0.03]":"from-slate-500/[0.02]"} to-transparent`}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`text-xs font-semibold uppercase tracking-wider ${c?"text-emerald-300/60":"text-slate-400/60"}`,children:"Score Entry"}),!c&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-slate-500/10 border border-slate-400/20",children:[e.jsxs("svg",{className:"w-3 h-3 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:[e.jsx("rect",{x:"5",y:"11",width:"14",height:"11",rx:"2"}),e.jsx("path",{d:"M12 3a4 4 0 0 0-4 4v4h8V7a4 4 0 0 0-4-4z"})]}),e.jsx("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wider",children:"Waiting for opponent"})]})]}),c?e.jsx(it,{inProgress:!0,startingScore:i.startingScore||te,onAddVisit:(a,o)=>ve(a,o,{visitTotal:a}),quickButtons:[180,140,100,60],onNextPlayer:()=>i.nextPlayer(),onEndLeg:a=>{try{i.endLeg(a??0)}catch{}},onEndGame:()=>{try{i.endGame()}catch{}},onUndo:()=>{},showDartsSelect:!0}):e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("input",{type:"text",className:"w-full text-center text-xl font-bold rounded-xl border border-white/5 bg-white/5 text-white/30 px-4 py-3 cursor-not-allowed",placeholder:"Locked",disabled:!0,readOnly:!0}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-[10px] text-white/30 uppercase tracking-wider self-center",children:"Quick:"}),[180,140,100,60].map(a=>e.jsx("button",{className:"px-3 py-1.5 rounded-lg text-xs font-semibold border border-white/5 bg-white/[0.02] text-white/20 cursor-not-allowed",disabled:!0,children:a},a))]})]})]}),U?.label&&e.jsxs("div",{className:"rounded-2xl border border-emerald-400/30 bg-emerald-500/10 px-4 py-3 text-center",children:[e.jsx("span",{className:"text-xs text-emerald-400/70 uppercase tracking-wider font-semibold",children:"Winning Double"}),e.jsx("div",{className:"text-lg font-bold text-emerald-200 mt-0.5",children:U.label})]})]})]})}),ue&&e.jsx(Ze,{onClose:()=>A(!1),onQuit:()=>{A(!1);try{i.endGame()}catch{}try{window.dispatchEvent(new Event("ndn:match-quit"))}catch{}},onPause:a=>{const o=Date.now()+a*60*1e3;try{F(!0,o,B)}catch{}try{Oe({type:"pause",pauseEndsAt:o,pauseStartedAt:Date.now(),pauseInitiator:B})}catch{}A(!1)}}),m&&y&&(()=>{const a=Math.max(0,y-ne),o=Math.ceil(a/1e3),S=Math.floor(o/60).toString().padStart(2,"0"),v=(o%60).toString().padStart(2,"0"),w=G.getState().pauseStartedAt??ne,L=Math.max(1,y-w),k=Math.max(0,Math.min(100,a/L*100)),j=!p||p===B;return e.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/80 backdrop-blur-md",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-80 h-80 rounded-full bg-amber-500/10 blur-[100px]"})}),e.jsxs("div",{className:"relative rounded-3xl border border-amber-400/20 bg-slate-900/95 p-8 sm:p-10 shadow-2xl shadow-amber-500/10 max-w-sm w-full mx-4",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-3xl bg-gradient-to-b from-white/[0.04] to-transparent"}),e.jsxs("div",{className:"relative flex flex-col items-center gap-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-14 sm:w-6 sm:h-16 rounded-md bg-amber-400 shadow-lg shadow-amber-400/30"}),e.jsx("div",{className:"w-5 h-14 sm:w-6 sm:h-16 rounded-md bg-amber-400 shadow-lg shadow-amber-400/30"})]}),e.jsx("div",{className:"text-amber-300 text-lg sm:text-xl font-bold uppercase tracking-[0.2em]",children:"Match Paused"}),p&&e.jsxs("div",{className:"text-sm text-amber-200/60",children:["Paused by ",e.jsx("span",{className:"font-semibold text-amber-200/90",children:p})]}),e.jsxs("div",{className:"font-mono text-6xl sm:text-7xl font-black text-white tabular-nums leading-none",children:[S,":",v]}),e.jsx("div",{className:"w-full h-2 rounded-full bg-white/10 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-amber-400 to-amber-500 transition-all duration-300",style:{width:`${k}%`}})}),e.jsx("div",{className:"text-[10px] sm:text-xs text-amber-200/40 uppercase tracking-wider",children:"Resuming when timer expires"}),j?e.jsx("button",{className:"mt-1 px-8 py-3 rounded-2xl text-base font-bold bg-emerald-600 hover:bg-emerald-500 text-white border border-emerald-400/30 shadow-lg shadow-emerald-500/20 transition-all",onClick:()=>{F(!1,null);try{Oe({type:"unpause"})}catch{}},children:"â–¶ Resume Match"}):e.jsxs("div",{className:"mt-1 text-sm text-amber-200/50 italic",children:["Only ",e.jsx("span",{className:"font-semibold text-amber-200/80",children:p})," can resume"]})]})]})]})})()]})}const $e=["X01","Cricket","Killer"],dt=l=>typeof l=="string"?l.toLowerCase().includes("integration"):typeof l=="number"?l.toString().toLowerCase().includes("integration"):!1,mt=l=>l?[l.title,l.description,l.creatorName,l.creatorEmail].some(u=>dt(u)):!1,ee=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0);function bt({user:l}){const g=st(),u=(()=>{try{return at()}catch{return null}})(),{matchType:i="singles",setMatchType:U,teamAName:ce="Team A",setTeamAName:Ce,teamBName:te="Team B",setTeamBName:se}=_(),[B,X]=n.useState([]),[P,c]=n.useState(!1),[E,C]=n.useState(""),[M,q]=n.useState(null),[I,ye]=n.useState(null),[h,N]=n.useState(null),[ae,R]=n.useState(!1),[je,de]=n.useState(!1),[me,ue]=n.useState(!1);n.useRef(!1);const A=oe(t=>t.inProgress),F=oe(t=>t.roomId);if(A)return e.jsx(ct,{user:l});n.useEffect(()=>{if(A)try{const t=oe.getState();if((t?.game||"X01")!=="X01"||!t.roomId)return;const r=`ndn:matchWindowOpened:${t.roomId}`;if(window.sessionStorage.getItem(r)==="1")return;window.sessionStorage.setItem(r,"1"),rt()}catch{}},[A,F]);const[m,y]=n.useState({title:"",game:"X01",mode:"501",value:0,description:"",startAt:new Date().toISOString().slice(0,16),checkinMinutes:15,capacity:16,startingScore:501,requireCalibration:!1}),[p,ne]=n.useState(null),[xe,Y]=n.useState(30),[D,z]=n.useState(null),[Q,$]=n.useState({}),[ve,J]=n.useState(!1),[a,o]=n.useState(!1),[S,v]=n.useState(null),[w,L]=n.useState(null),[k,j]=n.useState({open:!1,t:null}),[K,we]=n.useState({open:!1,t:null}),Ne=n.useRef(!1);n.useRef(null);const[Je,We]=n.useState({});n.useEffect(()=>u?u.addListener(s=>{try{if(s?.type==="match-prestart"){const r=s.match||null;r&&(r.prestartEndsAt=s.prestartEndsAt);try{r?.creatorId&&r?.creatorName&&We(T=>({...T,[r.creatorId]:r.creatorName}))}catch{}Ne.current=!0,ne(r);const b=s.prestartEndsAt||Date.now();Y(Math.max(0,Math.ceil(((b||Date.now())-Date.now())/1e3))),setTimeout(()=>{Ne.current=!1},0),z(null),$({}),J(!1),o(!1),L(null)}if(s?.type==="match-start"&&p&&s.roomId===p.id&&(ne(null),z(null),$({})),s?.type==="prestart-choice-notify"){const{roomId:r,playerId:b,choice:T}=s;if(!r||!T)return;$(Xe=>({...Xe||{},[b]:T}))}s?.type==="prestart-bull"&&(J(!0),o(!1),v(null)),s?.type==="prestart-bull-winner"&&(L(s.winnerId||null),J(!1),o(!1)),s?.type==="prestart-bull-tie"&&(L(null),J(!1),o(!1))}catch{}}):void 0,[u,D,p]),n.useEffect(()=>{if(!p||Ne.current||p.prestartEndsAt)return;Y(30),z(null),$({});const t=setInterval(()=>Y(s=>Math.max(0,s-1)),1e3);return()=>clearInterval(t)},[p]);const Te=oe(t=>({players:t.players,currentPlayerIdx:t.currentPlayerIdx,roomId:t.roomId}));n.useEffect(()=>{A&&ue(!0)},[A]);const Pe=t=>{z(t);try{u?.connected&&p?.id&&u.send({type:"prestart-choice",roomId:p.id,choice:t})}catch{}};async function W(){try{if(I&&Date.now()-I<3e3)return;const s=await(await V("/api/tournaments")).json(),r=Array.isArray(s.tournaments)?s.tournaments:[];X(r);try{console.debug("[Tournaments] refresh fetched",r.length,"tournaments"),console.log("[Tournaments] fetched list:",r)}catch{}q(null),ye(Date.now())}catch(t){try{typeof window<"u"&&q(String(t?.message||t))}catch{typeof window<"u"&&q("unknown")}}}n.useEffect(()=>{W()},[]),n.useEffect(()=>{try{u?.connected&&W()}catch{}},[u?.connected]),n.useEffect(()=>{if(!u)return;const t=u.addListener(s=>{try{if(s.type==="tournaments"&&(X(s.tournaments||[]),ye(Date.now())),s.type==="tournaments")try{console.debug("[Tournaments] WS tournaments update, num=",(s.tournaments||[]).length)}catch{}s.type==="tournament-win"&&s.message&&g(s.message,{type:"success",timeout:1e4})}catch{}});return()=>{t()}},[u?.connected]),n.useEffect(()=>{try{if(u?.connected){try{u.send({type:"list-tournaments"})}catch{}W()}}catch{}},[u?.connected]),n.useEffect(()=>{let t=null;try{(!u||!u.connected)&&(t=window.setInterval(()=>{W()},1e4))}catch{}return()=>{t&&clearInterval(t)}},[u?.connected]);const f=String(l?.email||"").toLowerCase(),Ae=f==="daviesfamily108@gmail.com",_e=()=>{lt({players:["Tournament A","Tournament B"],startingScore:501,roomId:"tournament-demo",visits:[{score:45},{score:81},{score:140}]})},x=t=>!t||!f?!1:(Array.isArray(t.participants)?t.participants:[]).some(r=>String(r?.email||"").toLowerCase()===f),Ue=()=>e.jsxs("div",{className:"mb-3 p-2 rounded-lg bg-slate-900/40 border border-white/10 text-white text-xs flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Default match"}),e.jsx("span",{className:"btn py-1 px-2 bg-indigo-500/30 border border-indigo-400/50 text-indigo-100",children:"Singles"}),e.jsx("span",{className:"text-xs opacity-60 ml-2",children:"(tournaments use Singles only)"})]});n.useEffect(()=>{let t=!1;async function s(){if(!f){N(null);return}try{const b=await(await V(`/api/subscription?email=${encodeURIComponent(f)}`)).json();t||(b?.source==="tournament"&&typeof b.expiresAt=="number"&&b.expiresAt>Date.now()?N(b.expiresAt):N(null))}catch{t||N(null)}}return s(),()=>{t=!0}},[f]);async function De(t){f&&we({open:!0,t})}async function Be(){const t=K.t;if(!(!t||!f)){we({open:!1,t:null}),c(!0);try{let s=await V("/api/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:t.id,requesterEmail:f})});if(!s.ok&&s.status===403&&String(f)==="daviesfamily108@gmail.com"&&(s=await V("/api/admin/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:t.id,requesterEmail:f})})),!s.ok){let r="Delete failed";try{const b=await s.json();b?.error&&(r=`Delete failed: ${String(b.error)}`)}catch{}g(r,{type:"error"});return}g("Tournament deleted",{type:"success"}),await W()}finally{c(!1)}}}async function he(t){if(f){c(!0);try{const s=await V("/api/tournaments/join",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:t.id,email:f,username:l?.username})});if(!s.ok){let r={};try{r=await s.json()}catch{}r?.error==="WINNER_COOLDOWN"&&typeof r.until=="number"?(C(`You're a recent NDN tournament winner. You can re-enter after ${O(r.until)}.`),setTimeout(()=>C(""),6e3),g("Join blocked: winner cooldown active",{type:"error"})):r?.error==="ALREADY_IN_TOURNAMENT"?(C(String(r.message||"You can only join one tournament at a time.")),setTimeout(()=>C(""),6e3),g("Join blocked: already in another tournament",{type:"error"})):r?.error&&(C(String(r.error)),setTimeout(()=>C(""),3500),g(`Join failed: ${String(r.error)}`,{type:"error"}));return}g("Joined tournament",{type:"success"}),await W()}finally{c(!1)}}}async function Ee(t){if(f){c(!0);try{const s=await V("/api/tournaments/leave",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:t.id,email:f})});if(!s.ok){let r={};try{r=await s.json()}catch{}r?.error?g(`Leave failed: ${String(r.error)}`,{type:"error"}):s.status===404?g("Leave failed (endpoint not found). Restart the server to enable /api/tournaments/leave.",{type:"error"}):g("Leave failed. Please try again.",{type:"error"});return}g("Left tournament",{type:"success"}),X(r=>r.map(b=>b.id===t.id?{...b,participants:(b.participants||[]).filter(T=>T.email!==f)}:b)),await W()}finally{c(!1)}}}async function ze(){c(!0);try{const t=new Date(m.startAt).getTime(),s=await V("/api/tournaments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:m.title,game:m.game,mode:m.mode,value:Number(m.value),description:m.description,startAt:t,checkinMinutes:Number(m.checkinMinutes),capacity:Number(m.capacity),startingScore:m.game==="X01"?Number(m.startingScore||501):void 0,requireCalibration:!!m.requireCalibration,creatorEmail:l?.email,creatorName:l?.username})});if(!s.ok){let r="";try{const T=await s.json();T?.error?r=String(T.error):T?.details&&(r=String(T.details))}catch{}const b=r?`Create failed: ${r}`:"Create failed. Please try again.";C(b),g(b,{type:"error"}),setTimeout(()=>C(""),6e3);return}try{const r=await s.json();if(!r?.ok){const b=r?.error?`Create failed: ${String(r.error)}`:"Create failed. Please try again.";C(b),g(b,{type:"error"}),setTimeout(()=>C(""),6e3);return}}catch{}R(!1),g("Tournament created",{type:"success"}),await W()}finally{c(!1)}}n.useEffect(()=>{if(!ae)return;const t=s=>{s.key==="Escape"&&R(!1)};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[ae]);const H=n.useMemo(()=>B.filter(t=>!mt(t)),[B]),pe=n.useMemo(()=>H.filter(t=>t.official),[H]),Se=n.useMemo(()=>H.filter(t=>!t.official),[H]),ke=n.useMemo(()=>H.filter(t=>t.status==="scheduled"&&!t.official),[H]),[re,Me]=n.useState(1),Z=16,fe=Math.ceil(ke.length/Z),Ge=ke.slice((re-1)*Z,re*Z),[le,Ie]=n.useState(1),be=Math.ceil(Se.length/Z),Ve=Se.slice((le-1)*Z,le*Z),d=n.useMemo(()=>pe.filter(s=>s.status==="scheduled").sort((s,r)=>s.startAt-r.startAt)[0]||null,[pe]);function O(t){return new Date(t).toLocaleString()}return e.jsxs("div",{className:"card ndn-game-shell ndn-page",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h2",{className:"text-2xl font-bold ndn-section-title",children:"Tournaments ðŸŽ¯"})}),e.jsxs("div",{className:"ndn-shell-body",children:[e.jsxs("div",{className:"mb-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-between gap-2 flex-wrap",children:[e.jsx("div",{className:"min-w-0",children:e.jsx(Ue,{})}),e.jsxs("div",{className:"shrink-0",children:[e.jsx("button",{className:"btn",onClick:()=>R(!0),children:"Create Tournament + ðŸŽ¯"}),Ae&&e.jsx("button",{className:"btn btn-ghost ml-2",onClick:()=>de(!0),children:"Demo Start Showcase ðŸŽ¯"}),Ae&&e.jsx("button",{className:"btn btn-ghost ml-2",onClick:_e,children:"Demo In-Game ðŸŽ®"})]})]}),je&&e.jsx(ge,{players:[{id:"0",name:"Demo A",legsWon:0,legs:[]},{id:"1",name:"Demo B",legsWon:0,legs:[]}],user:l,onDone:()=>de(!1)}),me&&e.jsx(ge,{players:Te.players||[],user:l,onDone:()=>ue(!1)}),e.jsx("div",{className:"mb-2 text-sm font-semibold text-slate-300",children:"World Lobby"}),e.jsxs("div",{className:"mb-3 p-3 rounded-xl border border-slate-700 bg-black/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold",children:"Created Game Lobby"}),e.jsx("div",{className:"text-xs opacity-60",children:"All tournaments created by users and admins"})]}),e.jsxs("ul",{className:"space-y-2",children:[ke.length===0&&e.jsx("li",{className:"text-sm opacity-60",children:"No created tournaments yet."}),Ge.map(t=>e.jsx(ot,{t,onJoin:s=>he(s),onLeave:s=>Ee(s),joined:x(t),disabled:P||t.status!=="scheduled"||!x(t)&&t.participants.length>=t.capacity},t.id))]}),fe>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[e.jsx("button",{className:"text-slate-300 hover:text-white transition-colors",onClick:()=>Me(t=>Math.max(t-1,1)),disabled:re===1,children:"â† Previous"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-slate-400",children:["Page ",re," of ",fe]}),e.jsx("button",{className:"text-slate-300 hover:text-white transition-colors",onClick:()=>Me(t=>Math.min(t+1,fe)),disabled:re===fe,children:"Next â†’"})]})]})]}),d&&e.jsx("div",{className:"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm uppercase tracking-wide text-indigo-300 font-semibold",children:"Weekly Official Tournament ðŸŽ¯"}),e.jsx("div",{className:"font-bold",children:d.title}),e.jsxs("div",{className:"text-sm opacity-80",children:[d.game,d.game==="X01"&&d.startingScore?`/${d.startingScore}`:""," ","Â· ",ie(d.mode)," ",d.value," Â· Starts ",O(d.startAt)," Â· Cap"," ",d.capacity," Â· Joined"," ",d.participants.length]}),d.prize&&e.jsx("div",{className:"text-xs mt-1",children:"Prize: 3 months PREMIUM"}),d.status!=="scheduled"&&e.jsxs("div",{className:"text-xs",children:["Status: ",d.status]}),h&&h>Date.now()&&e.jsxs("div",{className:"text-xs text-rose-300",children:["Recent winners can re-enter after ",O(h),"."]})]}),e.jsx("div",{className:"shrink-0",children:e.jsx("button",{className:`btn ${x(d)?"bg-emerald-600 hover:bg-emerald-600":""}`,title:x(d)?"Double-click to leave this tournament":d.official&&h&&h>Date.now()?`Recent winners can re-enter after ${O(h)}`:"",disabled:P||d.status!=="scheduled"||!x(d)&&(d.participants.length>=d.capacity||!!h&&h>Date.now()),onClick:()=>{x(d)?ee&&j({open:!0,t:d}):he(d)},onDoubleClick:()=>{!ee&&x(d)&&j({open:!0,t:d})},"aria-label":x(d)?"Already Joined":"Join Now",children:x(d)?"Already Joined! ðŸŽ¯":"Join Now ðŸŽ¯"})})]})}),E&&e.jsx("div",{className:"mb-3 p-2 rounded-lg bg-amber-700/30 border border-amber-600/40 text-amber-200 text-sm",children:E}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("section",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Official ðŸŽ¯"}),e.jsx("div",{className:"text-xs opacity-70 mb-2",children:h&&h>Date.now()?e.jsxs(e.Fragment,{children:["Youâ€™re a recent NDN tournament winner â€” to keep it fair, you can re-enter after ",O(h),"."]}):e.jsx(e.Fragment,{children:"Note: Weekly winners can re-enter once their 3 months of PREMIUM ends."})}),e.jsxs("ul",{className:"space-y-2",children:[pe.map(t=>e.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"font-semibold",children:[t.title," ",t.prize&&e.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 align-middle",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-500 text-black",children:"Prize"}),e.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-full bg-slate-600 text-white text-[10px] leading-none cursor-help",title:"Weekly winners get 3 months of PREMIUM and can re-enter once their prize period ends.","aria-label":"Prize info",children:"i"})]})]}),e.jsxs("div",{className:"text-sm opacity-80",children:[t.game,t.game==="X01"&&t.startingScore?`/${t.startingScore}`:""," ","Â· ",ie(t.mode)," ",t.value," Â· ",O(t.startAt)," Â· Cap ",t.capacity," Â· Joined ",t.participants.length]}),t.prize&&e.jsx("div",{className:"text-xs",children:"Prize: 3 months PREMIUM"}),t.status!=="scheduled"&&e.jsxs("div",{className:"text-xs",children:["Status: ",t.status]}),x(t)&&e.jsx("div",{className:"text-xs text-emerald-400 font-semibold",children:"Already Joined"}),t.official&&h&&h>Date.now()&&e.jsxs("div",{className:"text-xs text-rose-300",children:["Cooldown active until ",O(h),"."]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:`btn ${x(t)?"bg-emerald-600 hover:bg-emerald-600":""}`,title:x(t)?"Double-click to leave this tournament":t.official&&h&&h>Date.now()?`Recent winners can re-enter after ${O(h)}`:"",disabled:P||t.status!=="scheduled"||!x(t)&&(t.participants.length>=t.capacity||t.official&&!!h&&h>Date.now()),onClick:()=>{x(t)?ee&&j({open:!0,t}):he(t)},onDoubleClick:()=>{!ee&&x(t)&&j({open:!0,t})},"aria-label":x(t)?"Already Joined":"Join Now",children:x(t)?"Already Joined! ðŸŽ¯":"Join Now ðŸŽ¯"}),t.status==="scheduled"&&f&&(t.creatorEmail&&String(t.creatorEmail).toLowerCase()===f||f==="daviesfamily108@gmail.com")&&e.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Delete this tournament",onClick:()=>De(t),"aria-label":"Delete tournament",children:"Ã—"})]})]},t.id)),pe.length===0&&e.jsx("li",{className:"text-sm opacity-60",children:"No official tournaments yet."})]})]}),e.jsxs("section",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Community ðŸŽ¯"}),e.jsxs("ul",{className:"space-y-2",children:[Ve.map(t=>e.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("div",{className:"font-semibold",children:t.title}),e.jsxs("div",{className:"text-sm opacity-80",children:[t.game,t.game==="X01"&&t.startingScore?`/${t.startingScore}`:""," ","Â· ",ie(t.mode)," ",t.value," Â· ",O(t.startAt)," Â· Cap ",t.capacity," Â· Joined ",t.participants.length]}),t.description&&e.jsx("div",{className:"text-xs opacity-80",children:t.description}),x(t)&&e.jsx("div",{className:"text-xs text-emerald-400 font-semibold",children:"Already Joined"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn",title:x(t)?"Double-click to leave this tournament":"",disabled:P||t.status!=="scheduled"||!x(t)&&t.participants.length>=t.capacity,onClick:()=>{x(t)?ee&&j({open:!0,t}):he(t)},onDoubleClick:()=>{!ee&&x(t)&&j({open:!0,t})},children:x(t)?"Already Joined":"Join Now"}),t.status==="scheduled"&&f&&(t.creatorEmail&&String(t.creatorEmail).toLowerCase()===f||f==="daviesfamily108@gmail.com")&&e.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Delete this tournament",onClick:()=>De(t),"aria-label":"Delete tournament",children:"Ã—"})]})]},t.id)),Se.length===0&&e.jsx("li",{className:"text-sm opacity-60",children:"No community tournaments yet."})]}),be>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4 pt-2 border-t border-white/10",children:[e.jsx("button",{className:"btn btn-sm btn-ghost",disabled:le===1,onClick:()=>Ie(t=>Math.max(1,t-1)),children:"Previous"}),e.jsxs("span",{className:"text-sm opacity-70",children:["Page ",le," of ",be]}),e.jsx("button",{className:"btn btn-sm btn-ghost",disabled:le===be,onClick:()=>Ie(t=>Math.min(be,t+1)),children:"Next"})]})]})]}),ae&&e.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"create-tournament-heading",tabIndex:-1,className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 p-4",onClick:t=>{t.target===t.currentTarget&&R(!1)},children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{id:"create-tournament-heading",className:"text-2xl font-semibold",children:"Create Tournament ðŸŽ¯"}),e.jsx("button",{className:"btn",onClick:()=>R(!1),children:"Close âœ•"})]}),e.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-2 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Title"}),e.jsx("input",{className:"input w-full",value:m.title,onChange:t=>y(s=>({...s,title:t.target.value})),placeholder:"Enter tournament title"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Game"}),e.jsx("select",{className:"input w-full",value:m.game,onChange:t=>y(s=>({...s,game:t.target.value})),children:($e.filter(t=>Re.includes(t)).length?$e:Re).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Mode"}),e.jsx("select",{className:"input w-full",value:m.mode,onChange:t=>y(s=>({...s,mode:t.target.value})),children:nt(m.game).map(t=>e.jsx("option",{value:String(t),children:ie(String(t))},String(t)))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Number"}),e.jsx("input",{className:"input w-full",type:"number",min:1,value:m.value,onChange:t=>y(s=>({...s,value:Number(t.target.value)}))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Description"}),e.jsx("textarea",{className:"input w-full",rows:5,value:m.description,onChange:t=>y(s=>({...s,description:t.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Start time"}),e.jsx("input",{className:"input w-full",type:"datetime-local",value:m.startAt,onChange:t=>y(s=>({...s,startAt:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Check-in reminder (min)"}),e.jsx("input",{className:"input w-full",type:"number",min:0,value:m.checkinMinutes,onChange:t=>y(s=>({...s,checkinMinutes:Number(t.target.value)}))})]})]}),m.game==="X01"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"X01 Starting Score"}),e.jsx("select",{className:"input w-full",value:String(m.startingScore),onChange:t=>y(s=>({...s,startingScore:Number(t.target.value)})),children:[301,501,701].map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"accent-purple-500",checked:!!m.requireCalibration,onChange:t=>y(s=>({...s,requireCalibration:!!t.target.checked}))}),e.jsx("span",{className:"font-semibold",children:"Require Camera"})]}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"If checked, players must have a camera connected to join matches spawned from this tournament."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Capacity"}),e.jsx("input",{className:"input w-full",type:"number",min:6,max:64,value:m.capacity,onChange:t=>y(s=>({...s,capacity:Number(t.target.value)}))})]}),e.jsx("div",{className:"text-xs opacity-70",children:"Note: community tournaments do not award prizes."}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>R(!1),children:"Cancel"}),e.jsx("button",{className:"btn",disabled:P,onClick:ze,children:P?"Creating...":"Create Tournament"})]})]})]})}),p&&e.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"join-heading",tabIndex:-1,className:"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4",children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full",children:[e.jsx("div",{id:"join-heading",className:"text-lg font-bold mb-2",children:"Match Ready"}),e.jsxs("div",{className:"mb-3",children:[p.game," - ",p.modeType," Â· ",p.legs," legs"]}),e.jsxs("div",{className:"text-sm opacity-80 mb-3",children:["Created by ",p.createdBy]}),p.startingScore&&e.jsxs("div",{className:"mb-3",children:["Starting score:"," ",e.jsx("span",{className:"font-mono",children:p.startingScore})]}),e.jsx(ge,{open:me,players:Te.players,user:l,onRequestClose:()=>{},onDone:()=>{}}),e.jsxs("div",{className:"mb-3",children:["Timer: ",e.jsxs("span",{className:"font-mono",children:[xe,"s"]})]}),(xe<=15||p?.prestartEndsAt)&&e.jsxs("div",{className:"mb-3",children:["Choose:"," ",e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`btn ${D==="bull"?"btn-primary":"btn-ghost"}`,onClick:()=>Pe("bull"),children:"Bull Up"}),e.jsx("button",{className:`btn ${D==="skip"?"btn-primary":"btn-ghost"}`,onClick:()=>Pe("skip"),children:"Skip"})]}),e.jsx("div",{className:"text-xs opacity-70 mt-2",children:D?`You chose: ${D}`:"Please choose Bull Up or Skip before accepting"}),Object.keys(Q).length>0&&e.jsx("div",{className:"text-xs opacity-70 mt-2",role:"status","aria-live":"polite",children:Object.entries(Q).map(([t,s])=>e.jsxs("div",{children:[Je[t]||t," chose: ",s]},t))}),D==="skip"&&e.jsx("div",{className:"text-xs opacity-70 mt-2",children:"Skip requires both players to click Skip. Waiting for opponent..."})]})]})}),k.open&&k.t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>j({open:!1,t:null})}),e.jsxs("div",{className:"relative card p-4 w-[360px] max-w-[90vw]",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:"Leave tournament?"}),e.jsxs("div",{className:"text-sm opacity-80 mb-4",children:["Are you sure you want to remove yourself from â€œ",k.t.title,"â€?"]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>j({open:!1,t:null}),children:"Decline"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{const t=k.t;j({open:!1,t:null}),await Ee(t)},children:"Accept"})]})]})]}),K.open&&K.t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold mb-4 text-white",children:"Delete Tournament"}),e.jsxs("div",{className:"text-slate-300 mb-6",children:["Are you sure you want to delete"," ",e.jsxs("span",{className:"font-semibold text-white",children:['"',K.t.title,'"']}),"?",e.jsx("br",{}),e.jsx("span",{className:"text-sm text-slate-400",children:"This action cannot be undone."})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",onClick:()=>we({open:!1,t:null}),children:"Decline"}),e.jsx("button",{className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",onClick:Be,children:"Continue"})]})]})})})]})]})}export{bt as default};
//# sourceMappingURL=Tournaments-Cn-j6rye.js.map
