import{b as pl,u as bl,i as gl,e as vl,k as jl,l as Zr,m as Jr,n as pt,o as Wn,p as Is,j as e,M as Nl,r as ei,q as ti,t as yl,R as bt,G as wl,P as Sl,C as M,v as Ie,w as kl,x as Cl,h as Dl,y as Al,z as Ml}from"./index-B9xzhtT-.js";import{r as a}from"./ui-DygUIHRq.js";import{o as Ll}from"./matchWindow-BTByH8j6.js";import{M as Tl,S as El}from"./MatchControls-BkOdC589.js";import{f as si}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const Ps=[...Array.from({length:20},(n,i)=>({label:`D${i+1}`,score:(i+1)*2})),{label:"DBULL",score:50,isBull:!0}];function ni(n,i){const o=Ps[i];return!!o&&n===o.score}function qt(n){const i=n.trim().toUpperCase();if(!i)return null;if(i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL")return 50;if(i==="25"||i==="OBULL")return 25;const o=i.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!o)return null;const x=o[1]||"S",c=parseInt(o[2],10);return c<1||c>20?null:c*(x==="S"?1:x==="D"?2:3)}const Pe=[...Array.from({length:20},(n,i)=>i+1),25,50],na=[20,19,18,17,16,15,25];function Gn(){const n={};return na.forEach(i=>{n[i]=0}),{marks:n,points:0}}function Rl(n,i,o,x,c=()=>!1){let m=null,p=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)m=25,p=o==="INNER_BULL"||i===50?2:1;else if(typeof x=="number"&&x>=15&&x<=20)m=x,o==="TRIPLE"?p=3:o==="DOUBLE"?p=2:p=1;else if(i){const Q=[20,19,18,17,16,15];for(const K of Q){if(i===K){m=K,p=1;break}if(i===K*2){m=K,p=2;break}if(i===K*3){m=K,p=3;break}}!m&&(i===25||i===50)&&(m=25,p=i===50?2:1)}if(!m)return 0;const _=n.marks[m],De=Math.max(0,3-_),me=Math.min(De,p),P=Math.max(0,p-me),Y=_+me;n.marks[m]=Y>3?3:Y;let U=0;return P>0&&!c(m)&&(m===25?o==="INNER_BULL"?U+=50*P:U+=25*P:U+=m*P),n.points+=U,U}function Il(n){return na.every(i=>(n.marks[i]||0)>=3)}function zn(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function Pl(n){return n.round}function Fl(n,i,o,x){if(n.finished)return 0;const c=Pl(n);let m=0;return typeof x=="number"&&x===c?o==="TRIPLE"?(m=c*3,n.turnHits.triples++):o==="DOUBLE"?(m=c*2,n.turnHits.doubles++):o==="SINGLE"&&(m=c*1,n.turnHits.singles++):!x&&(i===c||i===c*2||i===c*3)&&(i===c*3?(m=c*3,n.turnHits.triples++):i===c*2?(m=c*2,n.turnHits.doubles++):i===c&&(m=c,n.turnHits.singles++)),n.score+=m,m}function Bl(n){if(!n.finished){if(n.turnHits.singles>0&&n.turnHits.doubles>0&&n.turnHits.triples>0){n.shanghaiAchieved=!0,n.finished=!0;return}const i=n.round+1;i>20?n.finished=!0:n.round=i}n.turnHits={singles:0,doubles:0,triples:0}}function Xn(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function hi(n){return n.targets[n.stage]||null}function Hl(n,i,o,x){if(n.finished)return 0;const c=hi(n);if(!c)return 0;let m=0;switch(c.kind){case"NUMBER":{typeof x=="number"&&x===c.num?o==="TRIPLE"?m=c.num*3:o==="DOUBLE"?m=c.num*2:o==="SINGLE"&&(m=c.num):!x&&(i===c.num||i===c.num*2||i===c.num*3)&&(m=i),m>0&&(n.hitThisRound=!0);break}case"DOUBLE":{(o==="DOUBLE"&&x===c.num||i===c.num*2)&&(m=c.num*2,n.hitThisRound=!0);break}case"TRIPLE":{(o==="TRIPLE"&&x===c.num||i===c.num*3)&&(m=c.num*3,n.hitThisRound=!0);break}case"BULL":{(o==="BULL"||o==="INNER_BULL"||i===25||i===50)&&(m=o==="INNER_BULL"||i===50?50:25,n.hitThisRound=!0);break}case"ANY_NUMBER":{i>0&&(m=i,n.hitThisRound=!0);break}}return n.score+=m,m}function Vl(n){n.finished||(n.hitThisRound||(n.score=Math.floor(n.score/2)),n.hitThisRound=!1,n.stage+=1,n.stage>=n.targets.length&&(n.finished=!0))}function qn(){return{round:1,score:0,target:"HIGH",finished:!1}}function Ol(n,i,o,x){if(n.finished)return 0;let c=0;if(n.target==="HIGH")if(o==="INNER_BULL")c=50;else if(typeof x=="number"){const p=x*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);x>=20&&(c=p)}else i>=40&&(c=i);else if(typeof x=="number"){const p=x*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);x<=10&&(c=p)}else i>0&&i<=30&&(c=i);return n.score+=c,c}function Ul(n){if(!n.finished){if(n.round+=1,n.round>10){n.finished=!0;return}n.target=n.target==="HIGH"?"LOW":"HIGH"}}function $l(n,i=3){return{number:n,lives:i,isKiller:!1,eliminated:!1}}function _l(n){const i=Array.from({length:20},(x,c)=>c+1),o={};for(const x of n){const c=Math.floor(Math.random()*i.length),m=i.splice(c,1)[0];o[x]=m}return o}function ai(n,i,o,x){const c=i[n];if(!c||!x||!o)return{becameKiller:!1};if(!c.isKiller&&o==="DOUBLE"&&x===c.number)return c.isKiller=!0,{becameKiller:!0};if(c.isKiller&&(o==="DOUBLE"||o==="TRIPLE")){const m=Object.keys(i).find(p=>p!==n&&!i[p].eliminated&&i[p].number===x);if(m){const p=i[m],_=o==="TRIPLE"?2:1;return p.lives=Math.max(0,p.lives-_),p.lives===0&&(p.eliminated=!0),{becameKiller:!1,victimId:m,livesRemoved:_}}}return{becameKiller:!1}}function ri(n){const i=Object.entries(n).filter(([,o])=>!o.eliminated&&o.lives>0);return i.length===1?i[0][0]:null}function ii(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function Kl(n,i,o,x){if(n.finished)return 0;let c=0;if(typeof x=="number"&&x===n.inning?o==="TRIPLE"?c=3:o==="DOUBLE"?c=2:c=1:!x&&(i===n.inning||i===n.inning*2||i===n.inning*3)&&(c=i===n.inning*3?3:i===n.inning*2?2:1),n.score+=c,n.dartsThisInning+=1,n.dartsThisInning>=3){const m=n.inning+1;m>9?n.finished=!0:(n.inning=m,n.dartsThisInning=0)}return c}const Wl={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function li(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function Gl(n,i,o,x){if(n.finished)return!1;const c=Wl[n.hole];if(n.dartsThisHole+=1,typeof x=="number"&&x===c&&(o==="SINGLE"||o==="DOUBLE"||o==="TRIPLE")||!x&&(i===c||i===c*2||i===c*3)){n.strokes+=n.dartsThisHole;const p=n.hole+1;return p>18?n.finished=!0:(n.hole=p,n.dartsThisHole=0),!0}if(n.dartsThisHole>=3){n.strokes+=3;const p=n.hole+1;p>18?n.finished=!0:(n.hole=p,n.dartsThisHole=0)}return!1}const fi={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function oi(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function zl(n){const i=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[o,x,c]of i)if(n[o]&&n[o]===n[x]&&n[o]===n[c])return n[o];return n.every(o=>o)?"Draw":null}function Xl(n,i,o,x,c){if(n.finished||n.board[i])return!1;const m=fi[i];let p=!1;if(m.type==="BULL"?p=x==="BULL"||x==="INNER_BULL"||o===25||o===50:m.type==="NUM"&&typeof m.num=="number"&&(typeof c=="number"&&c===m.num||!c&&(o===m.num||o===m.num*2||o===m.num*3))&&(p=!0),!p)return!1;n.board[i]=n.turn;const _=zl(n.board);return _?(n.finished=!0,n.winner=_,!0):(n.turn=n.turn==="X"?"O":"X",!0)}function Qn(){return{targetIndex:0,darts:0,finished:!1}}const pi=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],Yn=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function ql(n){return pi[n.targetIndex]}function Zn(n,i,o){if(n.finished)return n;const x=ql(n);if(!(o==="SINGLE"&&i===x||o==="DOUBLE"&&i===x||o==="TRIPLE"&&i===x||o==="INNER_BULL"&&x===25))return n;const m=n.targetIndex+1,p=m>=pi.length;return{targetIndex:m,darts:n.darts+1,finished:p}}function ci(n,i){return Zn(n,i,"SINGLE")}function Yl(){return Qn()}function Jn(n=50){return{score:0,darts:0,finished:!1,target:n}}const Ql=[5,10,15,20,25,50];function Zl(n){return Ql.includes(n)}function ea(n,i,o){if(n.finished)return n;if(!Zl(i))return{...n,darts:n.darts+1};const x=n.score+i,c=x>=n.target;return{score:c?n.target:x,darts:n.darts+1,finished:c,target:n.target}}function di(n,i){return ea(n,i)}function Jl(n=50){return Jn(n)}function ta(n=70){return{score:0,darts:0,finished:!1,target:n}}const eo=[7,14,21];function to(n){return eo.includes(n)}function sa(n,i,o){if(n.finished)return n;if(!to(i))return{...n,darts:n.darts+1};const x=n.score+i,c=x>=n.target;return{score:c?n.target:x,darts:n.darts+1,finished:c,target:n.target}}function mi(n,i){return sa(n,i)}function so(n=70){return ta(n)}const aa=[20,19,18,17,16,15,14,13,12,25];function ui(){const n={};return aa.forEach(i=>{n[i]=0}),{marks:n,points:0}}function no(n,i,o,x,c=()=>!1){let m=null,p=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)m=25,p=o==="INNER_BULL"||i===50?2:1;else if(typeof x=="number"&&x>=12&&x<=20)m=x,o==="TRIPLE"?p=3:o==="DOUBLE"?p=2:p=1;else if(i){for(const Q of[20,19,18,17,16,15,14,13,12]){if(i===Q){m=Q,p=1;break}if(i===Q*2){m=Q,p=2;break}if(i===Q*3){m=Q,p=3;break}}!m&&(i===25||i===50)&&(m=25,p=i===50?2:1)}if(!m)return 0;const _=n.marks[m],De=Math.max(0,3-_),me=Math.min(De,p),P=Math.max(0,p-me),Y=_+me;n.marks[m]=Y>3?3:Y;let U=0;return P>0&&!c(m)&&(m===25?o==="INNER_BULL"?U+=50*P:U+=25*P:U+=m*P),n.points+=U,U}function ao(n){return aa.every(i=>(n.marks[i]||0)>=3)}function W(n){return(i,o)=>{n(i)}}function ro(n){const{match:i,commitManualVisitTotal:o,endTurn:x}=n;return{addVisit:(c,m=3,p)=>{if(o){o(c);return}try{i.addVisit(c,m,p)}catch{i.addVisit(c,m)}},undoVisit:()=>{i.undoVisit()},nextPlayer:()=>{if(x)try{x(0)}catch{i.nextPlayer()}else i.nextPlayer()},endLeg:c=>{typeof c=="number"?i.endLeg(c):i.endLeg(0)},endGame:()=>{i.endGame()}}}function Ge(n,i,o,x,c,m,p,_,De,me,P,Y,U,Q,K,ze,N,ue,ge,ae,Xe,gt,Ae,qe,Yt,Qt,Zt){return a.useMemo(()=>{const re=[];if(n==="X01"){let S=0,ve=0,u=0;if(ue&&ue.length>0){for(const xe of ue)xe.dartsThrown&&xe.totalScored&&(ve+=xe.dartsThrown,u+=xe.totalScored);ve>0&&(S=u/ve*3)}const Hs=(Y??0)>0?_??0:me??null??(m??0);if(re.push({name:"You",isCurrentTurn:!!ge,legsWon:x||0,score:typeof i=="number"?i:typeof Xe=="number"?Xe:0,lastScore:Hs,avg:S,checkoutRate:K&&K>0?Math.round((Q||0)/K*100):0,bestLeg:ue&&ue.length>0?`${Math.min(...ue.map(xe=>xe.doubleDarts+(xe.checkoutDarts||0)))||0} darts`:"â€”",matchAvg:S,allTimeAvg:pl("You")||0}),ae&&ae!=="None"){const B=(U??0)>0?De??0:P??null??(p??0);re.push({name:`${ae} AI`,isCurrentTurn:!ge,legsWon:c||0,score:typeof o=="number"?o:typeof Xe=="number"?Xe:0,lastScore:B,avg:void 0,checkoutRate:N&&N>0?Math.round((ze||0)/N*100):0,bestLeg:"â€”"})}}return n==="Cricket"&&(re.push({name:"You",isCurrentTurn:!!ge,closed:gt?.marks||{},points:gt?.points||0}),ae&&ae!=="None"&&re.push({name:`${ae} AI`,isCurrentTurn:!ge,closed:{},points:0})),n==="Shanghai"&&(re.push({name:"You",isCurrentTurn:!!ge,round:Ae?.round||1,target:Ae?.target||1,score:Ae?.score||0}),ae&&ae!=="None"&&re.push({name:`${ae} AI`,isCurrentTurn:!ge,round:Ae?.round||1,target:Ae?.target||1,score:0})),n==="Killer"&&qe&&qe.length>0&&qe.forEach((S,ve)=>{const u=Yt?.[S.id];re.push({name:S.name,isCurrentTurn:ve===Zt,number:Qt?.[S.id],lives:u?.lives||0,eliminated:u?.eliminated||!1})}),re},[n,i,o,x,c,m,p,_,De,me,P,Y,U,Q,K,ze,N,ue,ge,ae,gt,Ae,qe,Yt,Qt,Zt])}const xi=a.memo(M),io=["Easy","Medium","Hardened"],lo=6500;function Se(n,i,o){return Math.max(i,Math.min(o,n))}function oo(n,i){let o=0;if(i==="Easy"){const x=[22,26,41,45,60];o=x[Math.floor(Math.random()*x.length)]}else i==="Medium"?o=Math.round(Se(60+(Math.random()*30-15),30,100)):o=Math.round(Se(80+(Math.random()*20-10),50,120));return n<=0?0:o>n?[100,85,81,60,57,45,41,26,22,20,1].find(c=>c<=n)??0:o}function co({onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:n,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const mo=Dl();function Fo({user:n}){const{offlineLayout:i,favoriteDouble:o,callerEnabled:x,callerVoice:c,callerVolume:m,speakCheckoutOnly:p,rememberLastOffline:_,setLastOffline:De,autoStartOffline:me,cameraScale:P,setCameraScale:Y,cameraAspect:U="wide",setCameraAspect:Q,cameraFitMode:K="fill",setCameraFitMode:ze,cameraEnabled:N,textSize:ue,boxSize:ge,autoscoreProvider:ae,autoCommitMode:Xe="wait-for-clear",matchType:gt="singles",setMatchType:Ae,teamAName:qe="Team A",setTeamAName:Yt,teamBName:Qt="Team B",setTeamBName:Zt}=bl(),re=ae==="manual",S=N&&!re,ve=N&&!re&&Xe!=="immediate",[u,Fs]=a.useState("X01"),[y,Bs]=a.useState(501),[C,ra]=a.useState("None"),[Hs,xe]=a.useState(!1),[Vs,Ye]=a.useState(!1),[F,Z]=a.useState(y),[B,vt]=a.useState(y),[uo,ia]=a.useState(!1),[la,z]=a.useState(!1),[jt,oa]=a.useState(1),[H,Jt]=a.useState(0),V=gl(),[bi,ca]=a.useState(!1),da=a.useRef(!1),[$,es]=a.useState(0),[ts,X]=a.useState(null),[ss,ma]=a.useState(1),[ns,ua]=a.useState(1),[he,xa]=a.useState([]),[ha,gi]=a.useState(2e3),Fe=vl(),[Os,Qe]=a.useState(!1),[vi,Ze]=a.useState(!1),[Us,$s]=a.useState(!1),[Nt,yt]=a.useState({player:!1,opponent:!1}),ji=jl(t=>t.setPaused);a.useEffect(()=>{const t=()=>{Qe(!1),Ye(!1),Ze(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[wt,fa]=a.useState(i==="modern"),[St,pa]=a.useState(i==="modern");a.useEffect(()=>{fa(i==="modern"),pa(i==="modern")},[i]),a.useEffect(()=>{K!=="fit"&&ze("fit")},[K,ze]);const[as,ba]=a.useState(1),[xo,ga]=a.useState(!1),[E,kt]=a.useState(!0),[Ct,Ni]=a.useState(()=>typeof window<"u"&&window.innerWidth<768),[va,_s]=a.useState(!1);a.useEffect(()=>{if(typeof window>"u")return;const t=()=>Ni(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),a.useEffect(()=>{Ct||_s(!1)},[Ct]),a.useEffect(()=>{const t=()=>dt(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[A,w]=a.useState(0),[Dt,Ks]=a.useState(0),[Ws,Gs]=a.useState(0),[Be,ja]=a.useState(0),[Na,ya]=a.useState(0),[At,zs]=a.useState(Gn()),[rs,is]=a.useState(zn()),[Mt,ls]=a.useState(Xn()),[os,cs]=a.useState(qn()),[ho,ie]=a.useState(0),[wa,Sa]=a.useState(1),[yi,Xs]=a.useState(27),[fo,ka]=a.useState(0),[wi,qs]=a.useState(0),[Ca,Da]=a.useState(!1),[Aa,Ma]=a.useState(1),[Si,La]=a.useState(0),[po,Ta]=a.useState(0),ki=8,[Ea,Ra]=a.useState(1),[Ci,Ia]=a.useState(0),[bo,Pa]=a.useState(0),Di=10,[Fa,Ba]=a.useState(1),[Ai,Ha]=a.useState(0),[go,Va]=a.useState(0),Mi=10,[Ys,Qs]=a.useState(170),[Oa,Ua]=a.useState(0),[$a,_a]=a.useState(0),[Ka,Wa]=a.useState(0),[Zs,Js]=a.useState(121),[Ga,za]=a.useState(0),[Xa,qa]=a.useState(0),[Ya,Qa]=a.useState(0),[He,en]=a.useState(20),[tn,sn]=a.useState(0),[Za,nn]=a.useState(0),[Lt,Li]=a.useState(30),[Ja,an]=a.useState(!1),[er,tr]=a.useState(ii()),[sr,nr]=a.useState(li()),[Ve,ar]=a.useState(oi()),[rn,rr]=a.useState(ui()),[I,ln]=a.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[Tt,Et]=a.useState({}),[ds,on]=a.useState({}),[ir,cn]=a.useState(!1),[je,Je]=a.useState(0),[vo,et]=a.useState(0),[tt,Rt]=a.useState(null),[Ti,ke]=a.useState(""),[ms,jo]=a.useState(Qn()),[Oe,It]=a.useState(Qn()),[Pt,No]=a.useState(Jn(50)),[fe,Ft]=a.useState(Jn(50)),[Bt,yo]=a.useState(ta(70)),[pe,Ht]=a.useState(ta(70)),[us,st]=a.useState(0),[Ue,$e]=a.useState(0),[G,J]=a.useState(0),[dn,Vt]=a.useState(y),[Ne,le]=a.useState(0),[nt,Me]=a.useState(null),[xs,ee]=a.useState(0),hs=a.useRef(0),Ei=a.useRef(0),oe=a.useRef(F),q=a.useRef(G),ce=a.useRef(Ne),at=a.useRef(dn),de=a.useRef(xs);a.useEffect(()=>{oe.current=F},[F]),a.useEffect(()=>{q.current=G},[G]),a.useEffect(()=>{ce.current=Ne},[Ne]),a.useEffect(()=>{at.current=dn},[dn]),a.useEffect(()=>{de.current=xs},[xs]);const[Ri,Ot]=a.useState(0);a.useRef(null);const[fs,mn]=a.useState(0),[_e,ps]=a.useState(0),[rt,Ke]=a.useState(0),[it,Ce]=a.useState(0),[lt,ot]=a.useState(null),[un,ct]=a.useState(0),[Ut,$t]=a.useState(0),[xn,bs]=a.useState(0),[_t,lr]=a.useState(0),[hn,or]=a.useState(0),[Kt,Wt]=a.useState(0),[Gt,cr]=a.useState(0),[fn,gs]=a.useState(0),[pn,dr]=a.useState(0),[mr,vs]=a.useState(0),[Ii,js]=a.useState(0),[Pi,Ns]=a.useState(0),[ur,bn]=a.useState(0),[Fi,gn]=a.useState(0),[Bi,vn]=a.useState(0),[Hi,ys]=a.useState(0),[Vi,xr]=a.useState(0),[ws,Ss]=a.useState(null),[Oi,Le]=a.useState(!1),[Ui,jn]=a.useState(!1),[te,se]=a.useState(""),[wo,So]=a.useState(""),[ko,Co]=a.useState(""),[hr,fr]=a.useState(""),[pr,Nn]=a.useState(""),[br,yn]=a.useState(""),[ks,wn]=a.useState(null),[$i,dt]=a.useState(!1),[_i,gr]=a.useState({}),[Do,Cs]=a.useState(!1),We=a.useRef(null),Sn=a.useRef(null),ye=a.useCallback(()=>{const t=Sn.current;t&&(clearTimeout(t),Sn.current=null)},[]),Ki=a.useCallback(t=>{if(t>0&&t<=60){const s=Zr(t,o);Ss({remaining:t,routes:s}),Le(!0)}else Ss(null),Le(!1)},[o]),kn=a.useCallback(()=>{try{Jr({type:"quit"})}catch{}Qe(!1),Ye(!1),Ze(!1),$s(!1),yt({player:!1,opponent:!1})},[]);a.useEffect(()=>{Us&&Nt.player&&Nt.opponent&&kn()},[kn,Nt,Us]);const vr=a.useCallback(t=>{if(!x)return;const s=pt(n,"Player");try{Wn(s,t.visitTotal,Math.max(t.remaining,0),c,{volume:m,checkoutOnly:p})}catch{}},[x,c,m,p,n]),jr=a.useCallback((t,s)=>{Cs(!1);const{visitTotal:r,darts:l,preRemaining:d,remaining:b,doubleAttempts:g,finished:j,doubleWindow:f,highestCheckout:h}=t;j?(Z(0),oe.current=0,typeof h=="number"&&h>0&&ys(v=>Math.max(v,h))):(Z(b),oe.current=b),Me(r),r===180?vs(v=>v+1):r>=140?js(v=>v+1):r>=100&&Ns(v=>v+1),f&&g>0&&($t(v=>v+g),j&&bs(v=>v+1)),t.announced||vr(t);try{Is.getState().recordVisit("offline-x01",l,r,{preRemaining:d,postRemaining:j?0:b,finish:j,bust:!1})}catch{}try{V.addVisit(r,l,{visitTotal:r}),j&&V.endLeg(d)}catch{}j&&(X("player"),z(!0)),Xt(j?0:b),le(0),ce.current=0,J(0),q.current=0,ee(0),de.current=0},[Xt,ys,X,Z,Me,le,J,ee,z,vs,js,Ns,$t,bs,vr]),mt=a.useCallback(t=>{const s=We.current;s&&(We.current=null,ye(),jr(s,t))},[ye,jr]);a.useCallback(t=>{We.current={...t,announced:!1},Cs(!0),ye(),Sn.current=setTimeout(()=>mt("timeout"),lo)},[ye,mt]),a.useEffect(()=>{if(!ve)return;const t=()=>mt("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[ve,mt]),a.useEffect(()=>{ve||mt("timeout")},[ve,mt]),a.useEffect(()=>()=>ye(),[ye]),a.useEffect(()=>{if(G===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}hs.current=0}Ei.current=G},[G]);const we=pt(n,"Player 1"),Te=C==="None"?"Player 2":C,Wi=E?we:Te,Gi=E?Te:we,zi=E?H:$,Xi=E?$:H,Ds=Ge("X01",F,B,H,$,Ue,_e,Ne,rt,nt,lt,G,it,xn,Ut,hn,_t,he,E,C,y),Nr=Ge("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,At),Cn=Ge("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,E,C,void 0,At,rs),Dn=Ge("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,I,Tt,ds,je),An=Ge("Scam"),Mn=Ge("Fives"),Ln=Ge("Sevens");a.useMemo(()=>{switch(u){case"Cricket":return Nr;case"Shanghai":return Cn;case"Killer":return Dn;case"Scam":return An;case"Fives":return Mn;case"Sevens":return Ln;default:return Ds}},[u,Nr,Cn,Dn,An,Mn,Ln,Ds]);const qi=u==="X01"?`${H}-${$}`:void 0,As=a.useMemo(()=>{const t=Ds||[],s=G>0?Ne:nt??Ue,r=it>0?rt:lt??_e;return t.length===0?{name:E?we:Te,isCurrentTurn:!0,legsWon:E?H:$,score:E?F:B,lastScore:E?s:r}:t.find(l=>l.isCurrentTurn)??t[0]},[Ds,E,we,Te,H,$,F,B,G,Ne,nt,Ue,rt,lt,_e,it]),Tn=a.useMemo(()=>{if(!As)return[];const{matchAvg:t,allTimeAvg:s,...r}=As;return[{...r,matchAvg:void 0,allTimeAvg:void 0}]},[As]),Yi=E?Te:we,Qi=As?.name??(E?we:Te),En=E?F:B,yr=E?G>0?Ne:nt??Ue:it>0?rt:lt??_e,Ms=V.players?.[V.currentPlayerIdx];let wr=0,Sr=0;if(Ms&&Ms.legs&&Ms.legs.length>0){for(const t of Ms.legs)if(Array.isArray(t.visits))for(const s of t.visits)wr+=s.score||0,Sr+=s.darts||0}const Zi=wr+(Ne||0),kr=Sr+(G||0),Ji=kr>0?Zi/kr*3:0,Ee=a.useCallback(t=>Math.max(0,Math.min(99,Math.round(t||0))).toString(),[]),L=a.useCallback((t,s=1)=>{!t||s<=0||gr(r=>({...r,[t]:(r[t]||0)+s}))},[]),R=a.useCallback(t=>{t&&gr(s=>s[t]===void 0?s:{...s,[t]:0})},[]);_i[u];const el=t=>{if(!t.trim())return null;const s=Number(t);return Number.isFinite(s)?Se(Math.round(s),0,y):null},tl=t=>{if(!t.trim())return null;const s=Number(t);return Number.isFinite(s)?Math.max(0,Math.round(s)):null},Cr=a.useCallback(()=>{We.current&&(We.current=null),ye(),Cs(!1)},[ye]);a.useCallback(t=>{const s=Se(t,0,y);Cr(),Z(s),oe.current=s;const r=s===0?y:s;Vt(r),at.current=r,le(0),ce.current=0,J(0),q.current=0,ee(0),de.current=0,Me(null),$e(0),w(0),hs.current=0,s===0?(X("player"),z(!0)):(X(null),z(!1))},[Cr,Z,y,Vt,le,J,ee,Me,$e,w,X,z]);const Dr=t=>{const r=el(hr);if(r===null){Fe(`Enter a number between 0 and ${y}`,{type:"error",timeout:2500});return}vt(r),Ke(0),Ce(0),ot(null),ct(0),ps(0),fr(""),X(null),z(!1)},Ar=a.useCallback((t,s)=>{t==="player"?(Jt(s),Nn("")):(es(s),yn("")),X(null),z(!1)},[es,yn,Nn,X,Jt,z]),Ls=t=>{const r=tl(t==="player"?pr:br);if(r===null){Fe("Enter a non-negative whole number for legs",{type:"error",timeout:2500});return}wn({target:t,value:r,stage:1})},sl=a.useCallback(()=>{wn(t=>t&&(t.stage===1?{...t,stage:2}:(Ar(t.target,t.value),null)))},[Ar]),zt=a.useCallback(()=>{wn(null)},[]);a.useEffect(()=>{if(!ks)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),zt())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[zt,ks]);const Re=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(ue),ut=a.useRef(null),xt=a.useRef(null),Rn=a.useRef(null),[ht,In]=a.useState("first"),[Ts,Mr]=a.useState(1),nl=a.useRef(null);a.useEffect(()=>{const t=Math.max(1,Math.floor(Number(Ts)||1)),s=ht==="first"?t:Math.max(1,Math.ceil(t/2));oa(s)},[ht,Ts]),a.useEffect(()=>{if(!St){ba(1),ga(!1);return}const t=()=>{const l=ut.current,d=xt.current;if(!l||!d)return;const b=Rn.current?Rn.current.getBoundingClientRect().height:0,g=Math.max(0,l.clientHeight-b-6),j=Math.max(0,l.clientWidth-8),f=d.getBoundingClientRect(),h=as||1,v=f.height/h,k=f.width/h,T=g>0?g/v:1,D=j>0?j/k:1,Rs=Math.min(1,Math.max(.5,Math.min(T,D))),be=v*Rs,fl=g>0&&be-g>1;ga(fl),ba(Rs)};t();const s=window.ResizeObserver,r=s?new s(()=>t()):null;return r&&ut.current&&r.observe(ut.current),r&&xt.current&&r.observe(xt.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{r&&ut.current&&r.unobserve(ut.current)}catch{}try{r&&xt.current&&r.unobserve(xt.current)}catch{}}},[St,as]),a.useEffect(()=>{const t=s=>{const r=s?.detail?.mode;r&&(Fs(r),ft())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),a.useEffect(()=>{const t=s=>{const r=s?.detail?.formatType,l=s?.detail?.formatCount,d=s?.detail?.startScore;(r==="first"||r==="best")&&In(r),typeof l=="number"&&isFinite(l)&&Mr(Math.max(1,Math.floor(l))),typeof d=="number"&&isFinite(d)&&Bs(Math.max(1,Math.floor(d)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),a.useEffect(()=>{if(!me)return;const t=setTimeout(()=>ft(),50);return()=>clearTimeout(t)},[me]),a.useEffect(()=>{if(!Os||E||C==="None"||Ri<=0)return;let t,s=performance.now();const r=l=>{const d=l-s;s=l,Ot(b=>{const g=b-d;if(g<=0){let j=0,f=0,h=B;for(Ce(0);j<3&&h>0;){const v=oo(h,C),k=Se(v-j*20,0,Math.min(60,h)),T=h-k;if(ps(k),mn(be=>be+1),cr(be=>be+1),T<0){h=B,Ke(0),ct(0),f=0,ot(0),Ce(0);break}f+=k,Ke(be=>be+k),dr(be=>be+k);const D=h,Rs=T;if(D>50&&Rs<=50?ct(1):D<=50&&ct(be=>be+1),h=T,j+=1,Ce(j),h===0)break}if(vt(h),h===0){f===180?bn(k=>k+1):f>=140?gn(k=>k+1):f>=100&&vn(k=>k+1);const v=B;v<=170&&xr(k=>Math.max(k,v)),B<=50&&(lr(k=>k+(un>0?un:1)),or(k=>k+1)),ot(f),Ke(0),ct(0),Ce(0),X("ai"),z(!0)}return h>0&&j>=3&&(f===180?bn(v=>v+1):f>=140?gn(v=>v+1):f>=100&&vn(v=>v+1),ot(f),Ke(0),ct(0),Ce(0)),Ce(0),kt(!0),0}return g}),t=requestAnimationFrame(r)};return t=requestAnimationFrame(r),()=>cancelAnimationFrame(t)},[Os,E,C,B]),a.useEffect(()=>{V.inProgress&&(da.current||(ca(!0),da.current=!0))},[V.inProgress]);function ft(){Ye(!0),Z(y),oe.current=y,vt(y),ia(!1),Qe(!0),kt(!0),w(0),st(0),$e(0),J(0),q.current=0,Vt(y),le(0),Me(null),ee(0),Ot(0),mn(0),ps(0),Ke(0),Ce(0),ot(null),X(null),Jt(0),es(0),xa([]),sn(0),nn(0),an(!1),Wt(0),cr(0),gs(0),dr(0),vs(0),js(0),Ns(0),bn(0),gn(0),vn(0),ys(0),xr(0),$t(0),bs(0),lr(0),or(0),R("X01");const t=Math.max(1,Math.floor(Number(Ts)||1));if(oa(ht==="first"?t:Math.max(1,Math.ceil(t/2))),_)try{De({mode:u,x01Start:y,firstTo:jt,aiLevel:C})}catch{}const s=pt(n,"You"),r=C!=="None"?`AI (${C})`:"Opponent",l=C!=="None"?[s,r]:[s];V.newMatch(l,y,`offline-${Date.now()}`);try{Ll()}catch{}}function al(){Z(y),oe.current=y,vt(y),ia(!1),Ss(null),Le(!1),Qe(!0),kt(!0),w(0),st(0),$e(0),J(0),q.current=0,Vt(y),le(0),at.current=y,ce.current=0,Me(null),ee(0),de.current=0,de.current=0,Ot(0),mn(0),ps(0),Ke(0),Ce(0),ot(null),X(null)}function Xt(t){Ki(t),J(0),q.current=0,Vt(t===0?y:t),at.current=t===0?y:t,ee(0),de.current=0,C!=="None"?(kt(!1),Ot(ha)):(Ot(0),kt(!0))}function O(t){if(!Number.isFinite(t))return!1;const s=at.current,r=oe.current,l=q.current,d=ce.current,b=l>0||d>0;b&&(Z(s),oe.current=s,J(0),q.current=0,le(0),ce.current=0,ee(0),de.current=0,$e(0),w(0),st(D=>Math.max(0,D-l)),Wt(D=>Math.max(0,D-l)),gs(D=>Math.max(0,D-d)),hs.current=0);const g=b?s:r,j=g<=170?170:180,f=Se(Math.round(t),0,j),h=g-f,v=Se(Math.round(ns||0),0,3),k=Se(Math.round(ss||0),0,3),T=h===0?v:3;if(L("X01",T),st(D=>D+T),Wt(D=>D+T),J(T),q.current=T,le(f),ce.current=f,Me(f),f===180?vs(D=>D+1):f>=140?js(D=>D+1):f>=100&&Ns(D=>D+1),h<0){if(x)try{Wn(we,0,Math.max(s,0),c,{volume:m,checkoutOnly:p})}catch{}try{Is.getState().recordVisit("offline-x01",T,0,{preRemaining:g,postRemaining:s,bust:!0,finish:!1})}catch{}Z(s),oe.current=s,Me(0),le(0),ce.current=0,J(0),q.current=0,ee(0),de.current=0;try{V.addVisit(0,T)}catch{}return Xt(s),!0}if(Z(h),oe.current=h,gs(D=>D+f),x)try{Wn(we,f,Math.max(h,0),c,{volume:m,checkoutOnly:p})}catch{}if(h===0?($t(D=>D+k),bs(D=>D+1),ee(k),de.current=k):g<=50&&$t(D=>D+3),h===0){g<=170&&ys(D=>Math.max(D,g)),Ss(null),Le(!1);try{Is.getState().recordVisit("offline-x01",T,f,{preRemaining:g,postRemaining:0,finish:!0,bust:!1})}catch{}try{V.addVisit(f,T),V.endLeg(g)}catch{}return X("player"),z(!0),J(0),q.current=0,le(0),ce.current=0,ee(0),de.current=0,!0}try{Is.getState().recordVisit("offline-x01",T,f,{preRemaining:g,postRemaining:h,finish:!1,bust:!1})}catch{}try{V.addVisit(f,T)}catch{}return Xt(h),le(0),ce.current=0,J(0),q.current=0,ee(0),de.current=0,!0}const ne=ro({match:V,commitManualVisitTotal:O,endTurn:Xt}),[Pn,Lr]=a.useState(""),Tr=t=>{Lr(t)},Fn=()=>{const t=parseInt(Pn,10);if(isNaN(t)||t<0||t>180){alert("Enter a number 0-180 for visit total");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=oe.current<=170?170:180,r=Se(Math.round(t),0,s);t>s&&Fe(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),O(r)&&Lr("")},Er=a.useCallback(()=>{We.current&&(We.current=null,ye(),Cs(!1));const t=q.current,s=ce.current,r=at.current;t===0&&s===0||(Z(r),oe.current=r,J(0),q.current=0,le(0),ce.current=0,ee(0),de.current=0,$e(0),w(0),st(l=>Math.max(0,l-t)),Wt(l=>Math.max(0,l-t)),gs(l=>Math.max(0,l-s)),hs.current=0)},[ye]);a.useEffect(()=>{const t=s=>{const r=s?.detail;!r||r?.source==="offline-play"||Er()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[Er]);function Rr(t){L("Double Practice");const s=Se(Math.round(t||0),0,60);if($e(s),st(r=>r+1),Wt(r=>r+1),ni(s,Dt)){const r=Ws+1;Gs(r),Ks(l=>Math.min(20,l+1)),r>=21&&(X("player"),z(!0))}w(0)}function Ir(){Rr(Number(A))}function Pr(){const t=qt(te);if(t==null){alert("Enter like D16, 50, 25, T20");return}Rr(t),se("")}function Fr(t,s,r){if(Ca)return!1;L("Bob's 27");const l=wa,d=s==="DOUBLE"&&r===l||!s&&t===l*2;return d&&qs(b=>b+1),ka(b=>{const g=b+1;if(g>=3){const j=wi+(d?1:0);j>0?Xs(h=>h+j*l*2):Xs(h=>h-l*2);const f=l+1;return Sa(f),qs(0),f>20&&Da(!0),0}return g}),!0}function Br(){Fr(Math.max(0,A|0)),w(0)}function Hr(){Sa(1),Xs(27),ka(0),qs(0),Da(!1),R("Bob's 27")}function Bn(t){return L("Count-Up"),La(s=>s+Math.max(0,t|0)),Ta(s=>{const r=s+1;return r>=3?(Ma(l=>l+1),0):r}),!0}function Hn(t){return L("High Score"),Ia(s=>s+Math.max(0,t|0)),Pa(s=>{const r=s+1;return r>=3?(Ra(l=>l+1),0):r}),!0}function Vn(t){return L("Low Score"),Ha(s=>s+Math.max(0,t|0)),Va(s=>{const r=s+1;return r>=3?(Ba(l=>l+1),0):r}),!0}function Vr(t,s,r,l,d,b,g,j){const f=t-g;if(!(f<0))if(f===0){if(j==="DOUBLE"||j==="INNER_BULL"){b(h=>h+1),d(h=>h+1),l(()=>0),s(t);return}s(f)}else s(f);l(h=>{const v=h+1;return v>=3?(d(k=>k+1),0):v})}function Or(t,s){return L("Checkout 170"),Vr(Ys,Qs,Oa,Ua,_a,Wa,t,s),Oa+1>=3&&Qs(170),!0}function Ur(t,s){return L("Checkout 121"),Vr(Zs,Js,Ga,za,qa,Qa,t,s),Ga+1>=3&&Js(121),!0}function Es(t){const s=qt(te);if(s==null){alert("Enter like T20, D16, 25, 50");return}const r=te.trim().toUpperCase(),l=r.startsWith("D")||r==="50"||r==="BULL"||r==="DBULL"||r==="IBULL"||r.includes("INNER");t?Or(s,l?"DOUBLE":void 0):Ur(s,l?"DOUBLE":void 0),se("")}function rl(){Qs(170),Ua(0),_a(0),Wa(0),R("Checkout 170")}function il(){Js(121),za(0),qa(0),Qa(0),R("Checkout 121")}function On(t,s,r){return Ja?!1:(L("Treble Practice"),(s==="TRIPLE"&&r===He||!s&&t===He*3)&&sn(d=>d+1),nn(d=>{const b=d+1;if(b%3===0&&[20,19,18].includes(He)){const g=["T20","T19","T18"],j=g.indexOf(`T${He}`),f=g[(j+1)%g.length];en(Number(f.replace("T","")))}return Lt>0&&b>=Lt&&an(!0),b}),!0)}function $r(){sn(0),nn(0),an(!1),R("Treble Practice")}function ll(t,s,r){return L("Baseball"),tr(l=>{const d={...l};return Kl(d,t,s,r),d}),!0}function ol(){tr(ii()),R("Baseball")}function cl(t,s,r){return L("Golf"),nr(l=>{const d={...l};return Gl(d,t,s,r),d}),!0}function dl(){nr(li()),R("Golf")}function ml(t,s,r,l){return L("Tic Tac Toe"),ar(d=>{const b={...d,board:[...d.board]};return Xl(b,t,s,r,l),b}),!0}function ul(){ar(oi()),R("Tic Tac Toe")}function xl(t,s,r){return L("American Cricket"),rr(l=>{const d={...l,marks:{...l.marks}};return no(d,t,s,r,()=>!1),d}),!0}function _r(){rr(ui()),R("American Cricket")}function Un(t,s,r){L("Around the Clock");const l=Pe[Be];let d=!1;if(typeof r=="number"&&r===l&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(d=!0),l===25&&(s==="BULL"||t===25)&&(d=!0),l===50&&(s==="INNER_BULL"||t===50)&&(d=!0),d||(t===l||t===l*2||t===l*3)&&(d=!0),d){const b=Na+1;return ya(b),ja(g=>g+1),!0}return!0}function Kr(){Un(Math.max(0,A|0)),w(0)}function Wr(){const t=qt(te);if(t==null){alert("Enter like T20, D5, 25, 50");return}Un(t),se("")}function $n(t,s,r){return L("Cricket"),zs(l=>{const d={...l,marks:{...l.marks}};return Rl(d,t,s,r,()=>!1),d}),ie(l=>{const d=l+1;return d>=3?0:d}),!0}function Gr(){$n(Math.max(0,A|0)),w(0)}function _n(t,s,r){return L("Shanghai"),is(l=>{const d={...l,turnHits:{...l.turnHits}};return Fl(d,t,s,r),d}),ie(l=>{const d=l+1;return d>=3?(is(b=>{const g={...b,turnHits:{...b.turnHits}};return Bl(g),g}),0):d}),!0}function zr(){_n(Math.max(0,A|0)),w(0)}function Xr(t,s,r){return L("Halve It"),ls(l=>{const d={...l,targets:[...l.targets]};return Hl(d,t,s,r),d}),ie(l=>{const d=l+1;return d>=3?(ls(b=>{const g={...b,targets:[...b.targets]};return Vl(g),g}),0):d}),!0}function qr(){Xr(Math.max(0,A|0)),w(0)}function Yr(t,s,r){return L("High-Low"),cs(l=>{const d={...l};return Ol(d,t,s,r),d}),ie(l=>{const d=l+1;return d>=3?(cs(b=>{const g={...b};return Ul(g),g}),0):d}),!0}function Qr(){Yr(Math.max(0,A|0)),w(0)}function hl(){const t=ts??"player",s=t==="player"?xs||void 0:un||void 0,r=1,l=t==="player"?us:fs;xa([...he,{winner:t,doubleDarts:ss,checkoutDarts:ns,winnerDarts:l,doublesAtt:s,doublesHit:r}]),z(!1);let d=H,b=$;if(ts==="player"?d+=1:ts==="ai"&&(b+=1),Jt(d),es(b),X(null),d>=jt||b>=jt){try{Ml(u,t==="player")}catch{}try{V.endGame()}catch{}Qe(!1),Ye(!1),Z(y),vt(y),jn(!0);return}al()}const Kn=!ti.includes(u)&&!(n?.fullAccess||n?.admin);return e.jsxs("div",{className:"card ndn-game-shell ndn-page relative overflow-hidden md:overflow-hidden overflow-y-auto",children:[bi&&e.jsx(Nl,{players:V.players||[],user:n,onDone:()=>ca(!1)}),e.jsxs("h2",{className:"text-3xl font-bold text-brand-700 mb-4 ndn-section-title",children:["Offline Mode ï¿½"," ",i==="classic"?e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle",children:"Classic layout"}):e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),e.jsxs("div",{className:"ndn-shell-body",children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:u,onChange:t=>Fs(t.target.value),children:[ti.map(t=>e.jsx("option",{value:t,children:t},t)),yl.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t," ",n?.fullAccess||n?.admin?"":"(Premium)"]},t))]}),u==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:Lt,onChange:t=>Li(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."}),N&&!Ct&&e.jsx("div",{className:"hidden md:block w-[360px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2",style:{willChange:"transform, opacity"},children:e.jsx(xi,{scoringMode:"x01",showToolbar:S,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:W(O),onAutoDart:(t,s,r)=>{}})})})]}),!n?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),u==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:y,onChange:t=>Bs(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:C,onChange:t=>ra(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),io.map(t=>e.jsx("option",{value:t,children:t},t))]}),C!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:ha/1e3,onChange:t=>gi(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>xe(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),u==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!Vs&&e.jsx("button",{className:"btn",disabled:Kn,title:Kn?"PREMIUM required for this mode":"",onClick:ft,children:"Start Match ðŸš€"}),Os&&e.jsx("div",{className:`fixed inset-0 z-[1000] ${wt?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(bt,{storageKey:"ndn:modal:offline-match",className:`${wt?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:wt,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex h-full",children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 -ml-2 sm:-ml-3",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{ut.current=t},children:[e.jsx("div",{ref:t=>{Rn.current=t},children:e.jsx(wl,{className:"w-full",left:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[u,u==="X01"?` / ${y}`:""]}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",jt," Â· Legs ",H,"-",$]}),e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${i==="modern"?"bg-emerald-500/15 text-emerald-200 border-emerald-400/30":"bg-white/10 text-white/70 border-white/20"}`,children:i==="modern"?"Modern layout":"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mr-2 text-xs",children:[e.jsx("span",{className:"opacity-80",children:"Cam"}),e.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>Y(Math.max(.5,Math.round((P-.05)*100)/100)),title:"Decrease camera size",children:"âˆ’"}),e.jsxs("span",{className:"w-9 text-center",children:[Math.round(P*100),"%"]}),e.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>Y(Math.min(1.25,Math.round((P+.05)*100)/100)),title:"Increase camera size",children:"+"})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:St?"Actual Size":"Fit All",onClick:()=>pa(t=>!t),children:St?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:wt?"Restore":"Maximize",onClick:()=>fa(t=>!t),children:wt?"Restore":"Maximize"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ft()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>Ze(!0),children:"Quit"})]})})}),vi&&e.jsx(Sl,{onClose:()=>Ze(!1),onQuit:()=>{if(C==="None"){Ze(!1),yt({player:!0,opponent:!1}),$s(!0);return}kn()},onPause:t=>{const s=Date.now()+t*60*1e3;try{ji(!0,s),Jr({type:"pause",pauseEndsAt:s,pauseStartedAt:Date.now()})}catch{}Ze(!1)}}),Us&&e.jsx("div",{className:"fixed inset-0 z-[170] flex items-center justify-center bg-black/70 p-4",children:e.jsxs(bt,{storageKey:"ndn:modal:offline-quit-confirm",className:"w-full relative",defaultWidth:460,defaultHeight:320,minWidth:360,minHeight:260,maxWidth:720,maxHeight:520,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Confirm Quit (Both Players)"}),e.jsx("p",{className:"text-sm text-slate-200 mb-4",children:"Both players must accept to end the match. If either player wants to continue, the match will keep going."}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("button",{className:`btn w-full ${Nt.player?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>yt(t=>({...t,player:!0})),children:[pt(n,"Player 1")," Accepts"]}),e.jsxs("button",{className:`btn w-full ${Nt.opponent?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>yt(t=>({...t,opponent:!0})),children:[C==="None"?"Opponent":`${C} AI`," Accepts"]}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 w-full",onClick:()=>{yt({player:!1,opponent:!1}),$s(!1)},children:"Continue Match"})]})]})}),u==="X01"&&Oi&&ws&&e.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center bg-black/70 p-4",onClick:()=>Le(!1),children:e.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl",onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key==="Escape")&&(t.preventDefault(),Le(!1))},tabIndex:-1,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-emerald-200/70",children:"Checkout box"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-100",children:[ws.remaining," left"]})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Le(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ss===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>ma(t),children:Ee(t)},`double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ns===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>ua(t),children:Ee(t)},`checkout-${t}`))})]}),ws.routes.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-emerald-200/80 mb-1",children:"Suggested checkout"}),e.jsx("div",{className:"space-y-1",children:ws.routes.map(t=>e.jsx("div",{className:"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold",children:t},t))})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>Le(!1),children:"Enter"})})]})]})}),e.jsxs("div",{ref:t=>{xt.current=t},className:"will-change-transform",style:St?{transform:`scale(${as})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,as))}em`}:void 0,children:[e.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:u==="X01"?"X01 Match âš”ï¸":`${u} âš”ï¸`}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",u]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",y]}),e.jsxs("div",{ref:nl,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=F!==y||B!==y||G>0,s=`pill ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${s} ${ht==="first"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||In("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${s} ${ht==="best"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||In("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:Ts,onChange:r=>Mr(Math.max(1,Math.floor(Number(r.target.value)||1))),disabled:t,title:ht==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",H,"â€“",$]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`input input-compact font-bold ${Re}`,value:gt,onChange:t=>Ae(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${Re} w-[7.5rem]`,value:qe,onChange:t=>Yt(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${Re} w-[7.5rem]`,value:Qt,onChange:t=>Zt(t.target.value),placeholder:"Team B"})]})]}),u!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[u==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:Ps[Dt]?.label||"â€”"})]})}),u==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:Pe[Be]===25?"25 (Outer Bull)":Pe[Be]===50?"50 (Inner Bull)":Pe[Be]||"â€”"})]})}),u==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:na.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,At.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:At.points})]}),Il(At)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{zs(Gn()),ie(0),R("Cricket")},children:"Reset"})]})]}),u==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:rs.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",rs.score]}),rs.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{is(zn()),ie(0),R("Shanghai")},children:"Reset"})]})]}),u==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[Mt.stage+1,"/",Mt.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=hi(Mt);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Mt.score]}),Mt.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{ls(Xn()),ie(0),R("Halve It")},children:"Reset"})]})]}),u==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",os.round," Â· Target ",os.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",os.score]}),os.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{cs(qn()),ie(0),R("High-Low")},children:"Reset"})]})]}),u==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",wa]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",yi]}),Ca&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Hr,children:"Reset"})]})]}),u==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Aa,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Si]})]}),u==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Ea,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ci]})]}),u==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",Fa,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ai]})]}),u==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Ys}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",$a," Â· Successes:"," ",Ka]})]}),u==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Zs}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Xa," Â· Successes:"," ",Ya]})]}),u==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",He]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",tn]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${He===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>en(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:He,onChange:t=>en(parseInt(t.target.value,10)),children:Array.from({length:20},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$r,children:"Reset"})]})]})}),u==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:er.inning}),e.jsxs("div",{className:"text-sm",children:["Score:"," ",e.jsx("span",{className:"font-semibold",children:er.score})]})]}),u==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:sr.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes:"," ",e.jsx("span",{className:"font-semibold",children:sr.strokes})]})]}),u==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Ve.turn}),Ve.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",Ve.winner||"â€”"]})]}),u==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Yn[ms.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[ms.targetIndex+1,"/",Yn.length]})]}),ms.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",ms.darts," darts!"]})]}),u==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Pt.score,"/",Pt.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Pt.darts})]}),Pt.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Pt.target,"!"]})]}),u==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Bt.score,"/",Bt.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Bt.darts})]}),Bt.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Bt.target,"!"]})]}),u==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:aa.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,rn.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:rn.points})]}),ao(rn)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:_r,children:"Reset"})]})]}),u==="Killer"&&e.jsx(e.Fragment,{children:ir?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:I[je]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:tt?`${I.find(t=>t.id===tt)?.name||"Winner"} Wins`:Ti||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):i==="modern"?e.jsxs("div",{className:"space-y-3 mb-2",children:[re?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Manual scoring active"}),e.jsx("div",{className:"text-xs opacity-70",children:"Camera previews are disabled. Use the manual entry controls below to record your turn."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center flex-wrap gap-1.5 mt-1",children:e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[e.jsx("span",{className:"opacity-70",children:"Cam"}),e.jsx("button",{className:`btn ${Re}`,onClick:()=>Y(Math.max(.5,Math.round((P-.05)*100)/100)),children:"âˆ’"}),e.jsxs("span",{className:`btn ${Re} min-w-[2.5rem] text-center`,children:[Math.round(P*100),"%"]}),e.jsx("button",{className:`btn ${Re}`,onClick:()=>Y(Math.min(1.25,Math.round((P+.05)*100)/100)),children:"+"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${Re}`,title:"Toggle fit/fill",onClick:()=>ze(K==="fill"?"fit":"fill"),children:K==="fill"?"Fill":"Fit"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${Re}`,title:"Toggle camera aspect",onClick:()=>Q(U==="square"?"wide":"square"),children:U==="square"?"Square":"Wide"})]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-2.5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{"data-testid":"offline-current-shooter",className:"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Current Shooter"}),e.jsxs("div",{className:"mt-1 flex items-center gap-4",children:[e.jsx("div",{className:"text-xl font-semibold text-white",children:Qi}),e.jsx("div",{className:"ml-auto text-sm text-slate-300",children:"3-Dart Avg (Live)"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm text-white/80",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Remaining"}),e.jsx("div",{className:"font-mono text-lg text-white",children:En})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Last Dart"}),e.jsx("div",{className:"font-mono text-lg text-white",children:yr||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Match Legs"}),e.jsxs("div",{className:"font-semibold text-white",children:[H,"-",$]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Next Up"}),e.jsx("div",{className:"font-medium text-white",children:Yi})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{"data-testid":"offline-live-avg",className:"rounded-xl bg-slate-900/60 border border-white/10 p-3 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"mt-1 text-lg font-semibold",children:si(V.players?.[V.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{"data-testid":"offline-player-stats",className:"rounded-lg border p-3 bg-slate-900/50 border-white/10 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"You"}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("div",{children:["Legs Won:"," ",e.jsx("span",{className:"font-semibold",children:H})]}),e.jsxs("div",{children:["Score:"," ",e.jsx("span",{className:"font-mono",children:En})]}),e.jsxs("div",{children:["Last Score:"," ",e.jsx("span",{className:"font-mono",children:yr||0})]})]})]})]})]}),u==="X01"&&e.jsxs("div",{className:"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Manual Scoreboard Override"}),e.jsxs("p",{className:"mt-1 text-xs text-white/40",children:["Adjust the live totals if a dart was misread. Values are clamped between 0 and ",y,"."]}),e.jsxs("div",{className:"mt-2.5 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:we}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Commit Visit"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx(Tl,{inProgress:!0,startingScore:y,onAddVisit:W(O),quickButtons:[180,140,100,60],onNextPlayer:()=>ne?.nextPlayer(),onEndLeg:()=>{},onUndo:()=>{},showDartsSelect:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:pr,onChange:t=>Nn(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ls("player")},placeholder:`${H}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ls("player"),children:"Set"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:Te}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Three Dart Edit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:y,value:hr,onChange:t=>fr(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Dr()},placeholder:`${B}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Dr(),children:"Set"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:br,onChange:t=>yn(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Ls("ai")},placeholder:`${$}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ls("ai"),children:"Set"})]})]})]})]})]})]}),e.jsxs("div",{className:"hidden md:flex md:w-[320px] md:flex-shrink-0 md:flex-col md:gap-3",children:[e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black border border-white/10",children:N?e.jsx(M,{scoringMode:u==="X01"?"x01":"custom",showToolbar:S,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:W(O),onAutoDart:()=>{}}):e.jsx("div",{className:"p-4 text-sm text-slate-200 text-center",children:"Camera disabled"})}),e.jsx(Ie,{gameMode:u,players:Tn,matchScore:`${H}-${$}`})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(Ie,{gameMode:u,players:Tn,matchScore:`${H}-${$}`})}),Ct&&N&&!va&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 md:hidden",children:[e.jsx("button",{className:"btn rounded-full border border-white/20 bg-white/10 px-4 py-2 text-sm text-white",onClick:()=>_s(!0),children:"Camera"}),e.jsx("span",{className:"text-xs text-white/60",children:"Tap to open the camera tab"})]})]})]}),Ct&&N&&va&&e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-start justify-center px-3 pt-6 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/80"}),e.jsx("div",{className:"relative z-10 w-full max-w-[420px]",children:e.jsxs("div",{className:"relative h-[75vh] rounded-[28px] overflow-hidden bg-black shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(M,{scoringMode:"x01",showToolbar:S,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:W(O),onAutoDart:(t,s,r)=>{}})}),e.jsx("button",{className:"absolute top-3 right-3 rounded-full bg-black/60 p-2 text-white",onClick:()=>_s(!1),"aria-label":"Close camera tab",children:"âœ•"}),e.jsxs("div",{className:"absolute bottom-4 right-4 w-full max-w-[220px] rounded-[20px] bg-black/70 p-3 text-left text-white shadow-lg",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide text-white/60",children:"Current thrower"}),e.jsx("div",{className:"text-sm font-semibold leading-tight",children:Wi}),e.jsxs("div",{className:"text-[11px] text-white/60",children:["Legs: ",zi]}),e.jsx("div",{className:"mt-2 text-[10px] uppercase tracking-wide text-white/60",children:"Opponent"}),e.jsx("div",{className:"text-sm font-semibold leading-tight",children:Gi}),e.jsxs("div",{className:"text-[11px] text-white/60",children:["Legs: ",Xi]})]})]})})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2 items-stretch min-w-0",children:e.jsxs("div",{className:"flex items-stretch justify-center md:px-3 min-w-0",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"You Remain"}),E?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:F}),e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-F/y)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart:"," ",e.jsx("span",{className:"font-semibold",children:Ue})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score:"," ",e.jsx("span",{className:"font-semibold",children:G>0?Ne:nt??Ue})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg:"," ",e.jsx("span",{className:"font-semibold",children:Kt>0?(fn/Kt*3).toFixed(1):"0.0"})]}),e.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[e.jsxs("span",{children:["Darts thrown: ",us]}),e.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(t=>e.jsx("span",{className:`w-2 h-2 rounded-full ${t<G?"bg-emerald-400":"bg-white/20"}`},t))})]}),e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles:"," ",e.jsxs("span",{className:"font-semibold",children:["Att ",Ut," Â· Hit ",xn]})]}),F<=170&&F>0&&(()=>{const s=Zr(F,o)[0]||"â€”";return e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[e.jsx("span",{className:"opacity-70",children:"Checkout"}),e.jsx("span",{className:"font-semibold",children:s})]})})()]}),e.jsxs("div",{className:`mt-2 ${ge==="small"?"p-2":ge==="large"?"p-4":"p-3"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${ue==="small"?"text-xs":ue==="large"?"text-base":"text-sm"}`,children:[e.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const t=E?pt(n,"You"):C==="None"?"â€”":`${C} AI`,s=E?F:C==="None"?0:B,r=E?G>0?Ne:nt??Ue:it>0?rt:lt??_e,l=E?us:fs,d=y-(E?F:C==="None"?y:B),b=l>0?d/l*3:0,g=`${H}-${$}`,j=he.length>0?`${Math.min(...he.map(f=>f.doubleDarts+(f.checkoutDarts||0)))||0} darts`:"â€”";return e.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[e.jsx("div",{className:"opacity-80",children:"Current score"}),e.jsx("div",{className:"font-mono text-right",children:g}),e.jsx("div",{className:"opacity-80",children:"Current thrower"}),e.jsx("div",{className:"text-right font-semibold text-lg",children:t}),e.jsx("div",{className:"opacity-80",children:"Score remaining"}),e.jsx("div",{className:"text-right font-mono font-bold text-xl",children:s}),e.jsx("div",{className:"opacity-80",children:"3-dart avg"}),e.jsx("div",{className:"text-right font-mono",children:b.toFixed(1)}),e.jsx("div",{className:"opacity-80",children:"Last score"}),e.jsx("div",{className:"text-right font-mono",children:r}),e.jsx("div",{className:"opacity-80",children:"Best leg"}),e.jsx("div",{className:"text-right",children:j})]})})()]}),e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[e.jsxs("span",{children:[C==="None"?"Opponent":`${C} AI`," Remain"]}),E?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:C!=="None"?B:"N/A"}),C!=="None"&&e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-B/y)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart:"," ",e.jsx("span",{className:"font-semibold",children:C==="None"?0:_e})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score:"," ",e.jsx("span",{className:"font-semibold",children:C==="None"?"â€”":it>0?rt:lt??_e})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg:"," ",e.jsx("span",{className:"font-semibold",children:C!=="None"?Gt>0?(pn/Gt*3).toFixed(1):"0.0":"â€”"})]}),C!=="None"&&e.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",fs]}),C!=="None"&&e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles:"," ",e.jsxs("span",{className:"font-semibold",children:["Att ",_t," Â· Hit ",hn]})]})]})]})}),u!=="X01"?e.jsxs("div",{className:"space-y-2",children:[u==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Ps[Dt]?.label||"â€”"})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&ni(t,Dt)){const l=Ws+1,d=Dt+1;return Gs(l),Ks(d),l>=Ps.length&&setTimeout(()=>{Gs(0),Ks(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ir()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ir,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:te,onChange:t=>se(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Pr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Pr,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",Ws," of 21"]})]}),u==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Pe[Be]===25?"25 (Outer Bull)":Pe[Be]===50?"50 (Inner Bull)":Pe[Be]||"â€”"})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>Un(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Kr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Kr,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:te,onChange:t=>se(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Wr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Wr,children:"Add"})]}),Na>=Pe.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{ya(0),ja(0),R("Around the Clock")},children:"Reset"})]})]}),u==="Cricket"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>$n(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Gr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Gr,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{zs(Gn()),ie(0),R("Cricket")},children:"Reset"})]})]}),u==="Shanghai"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>_n(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&zr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:zr,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{is(zn()),ie(0),R("Shanghai")},children:"Reset"})]})]}),u==="Halve It"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>Xr(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&qr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:qr,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ls(Xn()),ie(0),R("Halve It")},children:"Reset"})]})]}),u==="High-Low"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>Yr(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Qr()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Qr,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{cs(qn()),ie(0),R("High-Low")},children:"Reset"})]})]}),u==="Bob's 27"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>Fr(t,s==="MISS"?void 0:s,r?.sector??null),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Br()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Br,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Hr,children:"Reset"})]})]}),u==="Count-Up"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:t=>Bn(t),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Bn(A),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Bn(A),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ma(1),La(0),Ta(0),R("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Aa,"/",ki]})]}),u==="High Score"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:t=>Hn(t),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Hn(A),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Hn(A),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ra(1),Ia(0),Pa(0),R("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Ea,"/",Di]})]}),u==="Low Score"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:t=>Vn(t),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Vn(A),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Vn(A),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ba(1),Ha(0),Va(0),R("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",Fa,"/",Mi]})]}),u==="Checkout 170"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s)=>Or(t,s==="MISS"?void 0:s),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:te,onChange:t=>se(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Es(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Es(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:rl,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Ys," Â· Attempts: ",$a," ","Â· Successes: ",Ka]})]}),u==="Checkout 121"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s)=>Ur(t,s==="MISS"?void 0:s),onAddVisit:W(O),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:te,onChange:t=>se(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Es(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Es(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:il,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Zs," Â· Attempts: ",Xa," ","Â· Successes: ",Ya]})]}),u==="Treble Practice"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>On(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:te,onChange:t=>se(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=qt(te);s!=null&&On(s,void 0,void 0),se("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=qt(te);t!=null&&On(t,void 0,void 0),se("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",tn," Â· Misses:"," ",Math.max(0,Za-tn)," Â· Darts:"," ",Za,Lt>0?`/${Lt}`:""]}),Ja&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:$r,children:"Reset"})]})]}),u==="Baseball"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>ll(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:ol,children:"Reset"})})]}),u==="Golf"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>cl(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:dl,children:"Reset"})})]}),u==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${Ve.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(Ve.finished||Ve.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),r=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",l=t,d=fi[l],b=d.type==="BULL"?null:d.num||null;ml(l,s,r,b)},children:Ve.board[t]||""},t))}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:ul,children:"Reset"})})]}),u==="American Cricket"&&e.jsxs(e.Fragment,{children:[N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>xl(t,s==="MISS"?void 0:s,r?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:_r,children:"Reset"})})]}),u==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Yn[Oe.targetIndex]})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{const l=s==="MISS"?void 0:s;return L("Scam"),It(Zn(Oe,t,l)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(L("Scam"),It(ci(Oe,A)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{L("Scam"),It(ci(Oe,A)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{It(Yl()),R("Scam")},children:"Reset"})]}),Oe.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",Oe.darts," darts!"]})]}),u==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[fe.score,"/",fe.target]})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>(L("Fives"),Ft(ea(fe,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(L("Fives"),Ft(di(fe,A)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{L("Fives"),Ft(di(fe,A)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ft(Jl(fe.target)),R("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",fe.darts]}),fe.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",fe.target," in"," ",fe.darts," darts!"]})]}),u==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[pe.score,"/",pe.target]})]}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>(L("Sevens"),Ht(sa(pe,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:A,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(L("Sevens"),Ht(mi(pe,A)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{L("Sevens"),Ht(mi(pe,A)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ht(so(pe.target)),R("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",pe.darts]}),pe.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",pe.target," in"," ",pe.darts," darts!"]})]}),u==="Killer"&&e.jsx(e.Fragment,{children:ir?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:I.map(t=>{const s=Tt[t.id],r=ds[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number:"," ",e.jsx("span",{className:"font-semibold",children:r})]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsx("span",{className:"font-semibold",children:s?.lives??0})]})]},t.id)})}),N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(tt)return!1;const l=s==="MISS"?void 0:s,d=r?.sector??null,b=I[je];return b?(Et(g=>{const j={};Object.keys(g).forEach(v=>j[v]={...g[v]});const f=ai(b.id,j,l,d);if(f.becameKiller)ke(`${b.name} became a Killer`);else if(f.victimId){const v=I.find(k=>k.id===f.victimId);ke(`${b.name} hit ${v?.name}'s ${ds[f.victimId]} (${f.livesRemoved} life${(f.livesRemoved||0)>1?"s":""})`)}else ke("No effect");const h=ri(j);return h&&Rt(h),j}),et(g=>{const j=g+1;if(j>=3){let f=je;for(let h=1;h<=I.length;h++){const v=(je+h)%I.length,k=I[v].id,T=Tt[k];if(T&&!T.eliminated&&T.lives>0){f=v;break}}return Je(f),0}return j}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:te,onChange:t=>se(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(tt)return;const r=te.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!r){se("");return}const l=r[1]||"S",d=parseInt(r[2],10),b=l==="D"?"DOUBLE":l==="T"?"TRIPLE":"SINGLE",g=I[je];Et(j=>{const f={};Object.keys(j).forEach(k=>f[k]={...j[k]});const h=ai(g.id,f,b,d);if(h.becameKiller)ke(`${g.name} became a Killer`);else if(h.victimId){const k=I.find(T=>T.id===h.victimId);ke(`${g.name} hit ${k?.name}'s ${ds[h.victimId]} (${h.livesRemoved} life${(h.livesRemoved||0)>1?"s":""})`)}else ke("No effect");const v=ri(f);return v&&Rt(v),f}),se(""),et(j=>{const f=j+1;if(f>=3){let h=je;for(let v=1;v<=I.length;v++){const k=(je+v)%I.length,T=I[k].id,D=Tt[T];if(D&&!D.eliminated&&D.lives>0){h=k;break}}return Je(h),0}return f})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=je;for(let s=1;s<=I.length;s++){const r=(je+s)%I.length,l=I[r].id,d=Tt[l];if(d&&!d.eliminated&&d.lives>0){t=r;break}}Je(t),et(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Et({}),on({}),cn(!1),Je(0),et(0),Rt(null),ke("")},children:"Reset"})]}),tt&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",I.find(t=>t.id===tt)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Et({}),on({}),cn(!1),Je(0),et(0),Rt(null),ke("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:I.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:r=>{const l=r.target.value;ln(d=>d.map((b,g)=>g===s?{...b,name:l}:b))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>ln(r=>r.filter((l,d)=>d!==s)),disabled:I.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>ln(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(I.length<2){alert("Need at least 2 players");return}const t=I.map(l=>l.id),s=_l(t),r={};t.forEach(l=>{r[l]=$l(s[l])}),on(s),Et(r),Je(0),et(0),Rt(null),ke("Assigned numbers"),cn(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-2",children:"Visit total"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:F<=170?170:180,placeholder:"0â€“180",value:Pn,onChange:t=>Tr(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Fn()}}),e.jsx("button",{className:"btn px-4 py-1 text-sm",onClick:Fn,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(El,{value:Pn,onChange:Tr,onSubmit:Fn,helperText:"Tap numbers then Enter to commit the visit total."})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Current score"}),e.jsx("div",{className:"text-lg font-bold text-white",children:En})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"3-dart avg"}),e.jsx("div",{className:"text-lg font-bold text-emerald-300",children:Ji.toFixed(1)})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(Ie,{gameMode:u,players:Tn,matchScore:qi})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!N&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),N?e.jsx("div",{className:"bg-black aspect-video max-h-[420px]",children:e.jsx(xi,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:()=>!1})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Tap numbers then Enter to commit a 3-dart visit."})]}),e.jsx("div",{className:"flex flex-col gap-3 min-h-0 flex-1 text-[14px]",children:e.jsx("div",{className:"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"}})}),u==="Cricket"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return $n(t,s==="MISS"?void 0:s,r?.sector??null),!0}})}),u==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(Ie,{gameMode:"Shanghai",players:Cn})}),u==="Shanghai"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return _n(t,s==="MISS"?void 0:s,r?.sector??null),!0}})}),u==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(Ie,{gameMode:"Killer",players:Dn})}),u==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(Ie,{gameMode:"Scam",players:An})}),u==="Scam"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return It(Zn(Oe,t,s)),!0}})}),u==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(Ie,{gameMode:"Fives",players:Mn})}),u==="Fives"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return Ft(ea(fe,t)),!0}})}),u==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(Ie,{gameMode:"Sevens",players:Ln})}),u==="Sevens"&&N&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(M,{scoringMode:"custom",showToolbar:S,immediateAutoCommit:!0,onAutoDart:(t,s,r)=>{if(t>0)return Ht(sa(pe,t)),!0}})})]}),e.jsx("div",{className:"h-1"})]})]})})})}),Hs&&e.jsx(co,{onClose:()=>xe(!1)}),Kn&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${mo}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&Fe("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?Fe("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):Fe("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{Fe("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",kl(Cl(),5)]})]})]}),$i&&typeof document<"u"?ei.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>dt(!1),children:e.jsx(bt,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>dt(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>dt(!1),children:"Close"})]}),e.jsx(Al,{fill:!0,user:n,playerScore:F,aiScore:B,x01Score:y,inMatch:Vs,showWinPopup:la,pendingLegWinner:ts,playerDartsThrown:us,aiDartsThrown:fs,totalPlayerDarts:Kt,totalAiDarts:Gt,totalPlayerPoints:fn,totalAiPoints:pn,player180s:mr,player140s:Ii,player100s:Pi,ai180s:ur,ai140s:Fi,ai100s:Bi,playerHighestCheckout:Hi,aiHighestCheckout:Vi,onClose:()=>dt(!1),onOpen:()=>dt(!0),layout:i})]})})}),document.body):null,ks&&typeof document<"u"?ei.createPortal((()=>{const{target:t,value:s,stage:r}=ks,l=t==="player"?we:Te,d=t==="player"?H:$;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:zt,children:e.jsx(bt,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:zt,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",r," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:r===1?e.jsxs(e.Fragment,{children:["Set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:d})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:zt,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:sl,children:"Yes"})]})]})})})})(),document.body):null,la&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]",children:e.jsxs(bt,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:si(V.players?.[V.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ss===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>ma(t),children:Ee(t)},`win-double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ns===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>ua(t),children:Ee(t)},`win-checkout-${t}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:hl,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{z(!1),ft()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{z(!1),Qe(!1),Ye(!1)},children:"Back to Menu"})]})]})}),Ui&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(bt,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[u," Â· ",y," start Â· First to ",jt]}),(()=>{const t=Kt>0?fn/Kt*3:0,s=(()=>{const f=he.filter(h=>h.winner==="player"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),r=(()=>{const f=he.filter(h=>h.winner==="player"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),l=Ut>0?Math.round(xn/Ut*100):0,d=Gt>0?pn/Gt*3:0,b=(()=>{const f=he.filter(h=>h.winner==="ai"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),g=(()=>{const f=he.filter(h=>h.winner==="ai"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),j=_t>0?Math.round(hn/_t*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:pt(n,"You")}),e.jsx("div",{className:"text-3xl font-extrabold",children:H}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:Ut})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[l,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:s})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:r})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:mr})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[H," â€“ ",$]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:C==="None"?"Opponent":`${C} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:$}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:d.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:_t})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[j,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:b})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:g})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ur})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:he.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":C==="None"?"Opp":"AI"," ","Â· Dbl ",Ee(t.doubleDarts)," Â· CO"," ",Ee(t.checkoutDarts||0)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>jn(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{jn(!1),ft()},children:"Rematch"})]})]})}),he.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:he.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",Ee(t.doubleDarts),", Checkout darts: ",Ee(t.checkoutDarts||0)]},s))})]})]})]})}export{Fo as default};
//# sourceMappingURL=OfflinePlay-Bhem7Rv4.js.map
