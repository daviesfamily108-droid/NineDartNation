import{y as b}from"./index-BjeBmmUT.js";const u="ndn:messages:inbox",l="ndn:messages:unread";function x(){try{const r=localStorage.getItem(u),a=r?JSON.parse(r):[],n=Number(localStorage.getItem(l)||"0")||0;return{inbox:Array.isArray(a)?a.filter(e=>e&&typeof e.id=="string").slice(0,200):[],unread:n}}catch{return{inbox:[],unread:0}}}function i(r,a){try{localStorage.setItem(u,JSON.stringify(r))}catch{}try{localStorage.setItem(l,String(a))}catch{}}const d=x(),m=b((r,a)=>({inbox:d.inbox,unread:d.unread,inGame:!1,setInGame:n=>r({inGame:n}),add:n=>r(t=>{const e=t.inbox.some(c=>c.id===n.id&&c.ts===n.ts),o=e?t.inbox:[n,...t.inbox].slice(0,200),s=t.unread+(e?0:1);return i(o,s),{inbox:o,unread:s}}),load:n=>r(t=>{const e=[...n].sort((o,s)=>s.ts-o.ts).slice(0,200);return i(e,t.unread),{inbox:e,unread:t.unread}}),markAllRead:()=>{const n=a();i(n.inbox,0),r({unread:0})},remove:n=>r(t=>{const e=t.inbox.filter(s=>s.id!==n),o=t.unread;return i(e,o),{inbox:e,unread:o}})}));export{m as u};
//# sourceMappingURL=messages-BHwNRRh1.js.map
