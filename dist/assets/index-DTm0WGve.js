(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();function xh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gh={exports:{}},Ro={},yh={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var si=Symbol.for("react.element"),Yx=Symbol.for("react.portal"),qx=Symbol.for("react.fragment"),Qx=Symbol.for("react.strict_mode"),Xx=Symbol.for("react.profiler"),Zx=Symbol.for("react.provider"),eg=Symbol.for("react.context"),tg=Symbol.for("react.forward_ref"),ng=Symbol.for("react.suspense"),sg=Symbol.for("react.memo"),rg=Symbol.for("react.lazy"),Wm=Symbol.iterator;function lg(e){return e===null||typeof e!="object"?null:(e=Wm&&e[Wm]||e["@@iterator"],typeof e=="function"?e:null)}var vh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bh=Object.assign,Nh={};function Vl(e,t,s){this.props=e,this.context=t,this.refs=Nh,this.updater=s||vh}Vl.prototype.isReactComponent={};Vl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Vl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wh(){}wh.prototype=Vl.prototype;function iu(e,t,s){this.props=e,this.context=t,this.refs=Nh,this.updater=s||vh}var ou=iu.prototype=new wh;ou.constructor=iu;bh(ou,Vl.prototype);ou.isPureReactComponent=!0;var Vm=Array.isArray,jh=Object.prototype.hasOwnProperty,cu={current:null},Sh={key:!0,ref:!0,__self:!0,__source:!0};function kh(e,t,s){var r,l={},a=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)jh.call(t,r)&&!Sh.hasOwnProperty(r)&&(l[r]=t[r]);var o=arguments.length-2;if(o===1)l.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];l.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)l[r]===void 0&&(l[r]=o[r]);return{$$typeof:si,type:e,key:a,ref:i,props:l,_owner:cu.current}}function ag(e,t){return{$$typeof:si,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function du(e){return typeof e=="object"&&e!==null&&e.$$typeof===si}function ig(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var Gm=/\/+/g;function pc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ig(""+e.key):t.toString(36)}function Hi(e,t,s,r,l){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case si:case Yx:i=!0}}if(i)return i=e,l=l(i),e=r===""?"."+pc(i,0):r,Vm(l)?(s="",e!=null&&(s=e.replace(Gm,"$&/")+"/"),Hi(l,t,s,"",function(d){return d})):l!=null&&(du(l)&&(l=ag(l,s+(!l.key||i&&i.key===l.key?"":(""+l.key).replace(Gm,"$&/")+"/")+e)),t.push(l)),1;if(i=0,r=r===""?".":r+":",Vm(e))for(var o=0;o<e.length;o++){a=e[o];var c=r+pc(a,o);i+=Hi(a,t,s,c,l)}else if(c=lg(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=r+pc(a,o++),i+=Hi(a,t,s,c,l);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function wi(e,t,s){if(e==null)return e;var r=[],l=0;return Hi(e,r,"","",function(a){return t.call(s,a,l++)}),r}function og(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ln={current:null},Wi={transition:null},cg={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:Wi,ReactCurrentOwner:cu};function Ch(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:wi,forEach:function(e,t,s){wi(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return wi(e,function(){t++}),t},toArray:function(e){return wi(e,function(t){return t})||[]},only:function(e){if(!du(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=Vl;Ue.Fragment=qx;Ue.Profiler=Xx;Ue.PureComponent=iu;Ue.StrictMode=Qx;Ue.Suspense=ng;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cg;Ue.act=Ch;Ue.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=bh({},e.props),l=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=cu.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)jh.call(t,c)&&!Sh.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];r.children=o}return{$$typeof:si,type:e.type,key:l,ref:a,props:r,_owner:i}};Ue.createContext=function(e){return e={$$typeof:eg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Zx,_context:e},e.Consumer=e};Ue.createElement=kh;Ue.createFactory=function(e){var t=kh.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:tg,render:e}};Ue.isValidElement=du;Ue.lazy=function(e){return{$$typeof:rg,_payload:{_status:-1,_result:e},_init:og}};Ue.memo=function(e,t){return{$$typeof:sg,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=Wi.transition;Wi.transition={};try{e()}finally{Wi.transition=t}};Ue.unstable_act=Ch;Ue.useCallback=function(e,t){return ln.current.useCallback(e,t)};Ue.useContext=function(e){return ln.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return ln.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return ln.current.useEffect(e,t)};Ue.useId=function(){return ln.current.useId()};Ue.useImperativeHandle=function(e,t,s){return ln.current.useImperativeHandle(e,t,s)};Ue.useInsertionEffect=function(e,t){return ln.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return ln.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return ln.current.useMemo(e,t)};Ue.useReducer=function(e,t,s){return ln.current.useReducer(e,t,s)};Ue.useRef=function(e){return ln.current.useRef(e)};Ue.useState=function(e){return ln.current.useState(e)};Ue.useSyncExternalStore=function(e,t,s){return ln.current.useSyncExternalStore(e,t,s)};Ue.useTransition=function(){return ln.current.useTransition()};Ue.version="18.3.1";yh.exports=Ue;var m=yh.exports;const dg=xh(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ug=m,mg=Symbol.for("react.element"),fg=Symbol.for("react.fragment"),hg=Object.prototype.hasOwnProperty,pg=ug.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xg={key:!0,ref:!0,__self:!0,__source:!0};function Eh(e,t,s){var r,l={},a=null,i=null;s!==void 0&&(a=""+s),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)hg.call(t,r)&&!xg.hasOwnProperty(r)&&(l[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)l[r]===void 0&&(l[r]=t[r]);return{$$typeof:mg,type:e,key:a,ref:i,props:l,_owner:pg.current}}Ro.Fragment=fg;Ro.jsx=Eh;Ro.jsxs=Eh;gh.exports=Ro;var n=gh.exports,ed={},Th={exports:{}},jn={},Ih={exports:{}},Dh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,X){var Z=W.length;W.push(X);e:for(;0<Z;){var ie=Z-1>>>1,J=W[ie];if(0<l(J,X))W[ie]=X,W[Z]=J,Z=ie;else break e}}function s(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var X=W[0],Z=W.pop();if(Z!==X){W[0]=Z;e:for(var ie=0,J=W.length,me=J>>>1;ie<me;){var pe=2*(ie+1)-1,Me=W[pe],Ne=pe+1,Le=W[Ne];if(0>l(Me,Z))Ne<J&&0>l(Le,Me)?(W[ie]=Le,W[Ne]=Z,ie=Ne):(W[ie]=Me,W[pe]=Z,ie=pe);else if(Ne<J&&0>l(Le,Z))W[ie]=Le,W[Ne]=Z,ie=Ne;else break e}}return X}function l(W,X){var Z=W.sortIndex-X.sortIndex;return Z!==0?Z:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],d=[],x=1,S=null,y=3,N=!1,w=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(W){for(var X=s(d);X!==null;){if(X.callback===null)r(d);else if(X.startTime<=W)r(d),X.sortIndex=X.expirationTime,t(c,X);else break;X=s(d)}}function C(W){if(T=!1,b(W),!w)if(s(c)!==null)w=!0,I(j);else{var X=s(d);X!==null&&G(C,X.startTime-W)}}function j(W,X){w=!1,T&&(T=!1,v(B),B=-1),N=!0;var Z=y;try{for(b(X),S=s(c);S!==null&&(!(S.expirationTime>X)||W&&!$());){var ie=S.callback;if(typeof ie=="function"){S.callback=null,y=S.priorityLevel;var J=ie(S.expirationTime<=X);X=e.unstable_now(),typeof J=="function"?S.callback=J:S===s(c)&&r(c),b(X)}else r(c);S=s(c)}if(S!==null)var me=!0;else{var pe=s(d);pe!==null&&G(C,pe.startTime-X),me=!1}return me}finally{S=null,y=Z,N=!1}}var f=!1,R=null,B=-1,ee=5,Y=-1;function $(){return!(e.unstable_now()-Y<ee)}function Q(){if(R!==null){var W=e.unstable_now();Y=W;var X=!0;try{X=R(!0,W)}finally{X?D():(f=!1,R=null)}}else f=!1}var D;if(typeof h=="function")D=function(){h(Q)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,de=z.port2;z.port1.onmessage=Q,D=function(){de.postMessage(null)}}else D=function(){P(Q,0)};function I(W){R=W,f||(f=!0,D())}function G(W,X){B=P(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){w||N||(w=!0,I(j))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var Z=y;y=X;try{return W()}finally{y=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Z=y;y=W;try{return X()}finally{y=Z}},e.unstable_scheduleCallback=function(W,X,Z){var ie=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ie+Z:ie):Z=ie,W){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Z+J,W={id:x++,callback:X,priorityLevel:W,startTime:Z,expirationTime:J,sortIndex:-1},Z>ie?(W.sortIndex=Z,t(d,W),s(c)===null&&W===s(d)&&(T?(v(B),B=-1):T=!0,G(C,Z-ie))):(W.sortIndex=J,t(c,W),w||N||(w=!0,I(j))),W},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(W){var X=y;return function(){var Z=y;y=X;try{return W.apply(this,arguments)}finally{y=Z}}}})(Dh);Ih.exports=Dh;var gg=Ih.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg=m,wn=gg;function q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mh=new Set,Ba={};function Pr(e,t){Ll(e,t),Ll(e+"Capture",t)}function Ll(e,t){for(Ba[e]=t,e=0;e<t.length;e++)Mh.add(t[e])}var Cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),td=Object.prototype.hasOwnProperty,vg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Km={},Jm={};function bg(e){return td.call(Jm,e)?!0:td.call(Km,e)?!1:vg.test(e)?Jm[e]=!0:(Km[e]=!0,!1)}function Ng(e,t,s,r){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function wg(e,t,s,r){if(t===null||typeof t>"u"||Ng(e,t,s,r))return!0;if(r)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function an(e,t,s,r,l,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Yt[e]=new an(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Yt[t]=new an(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Yt[e]=new an(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Yt[e]=new an(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Yt[e]=new an(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Yt[e]=new an(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Yt[e]=new an(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Yt[e]=new an(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Yt[e]=new an(e,5,!1,e.toLowerCase(),null,!1,!1)});var uu=/[\-:]([a-z])/g;function mu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(uu,mu);Yt[t]=new an(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(uu,mu);Yt[t]=new an(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(uu,mu);Yt[t]=new an(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Yt[e]=new an(e,1,!1,e.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Yt[e]=new an(e,1,!1,e.toLowerCase(),null,!0,!0)});function fu(e,t,s,r){var l=Yt.hasOwnProperty(t)?Yt[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(wg(t,s,l,r)&&(s=null),r||l===null?bg(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):l.mustUseProperty?e[l.propertyName]=s===null?l.type===3?!1:"":s:(t=l.attributeName,r=l.attributeNamespace,s===null?e.removeAttribute(t):(l=l.type,s=l===3||l===4&&s===!0?"":""+s,r?e.setAttributeNS(r,t,s):e.setAttribute(t,s))))}var Ds=yg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ji=Symbol.for("react.element"),fl=Symbol.for("react.portal"),hl=Symbol.for("react.fragment"),hu=Symbol.for("react.strict_mode"),nd=Symbol.for("react.profiler"),Lh=Symbol.for("react.provider"),Ph=Symbol.for("react.context"),pu=Symbol.for("react.forward_ref"),sd=Symbol.for("react.suspense"),rd=Symbol.for("react.suspense_list"),xu=Symbol.for("react.memo"),Us=Symbol.for("react.lazy"),Ah=Symbol.for("react.offscreen"),Ym=Symbol.iterator;function da(e){return e===null||typeof e!="object"?null:(e=Ym&&e[Ym]||e["@@iterator"],typeof e=="function"?e:null)}var jt=Object.assign,xc;function ya(e){if(xc===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);xc=t&&t[1]||""}return`
`+xc+e}var gc=!1;function yc(e,t){if(!e||gc)return"";gc=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var l=d.stack.split(`
`),a=r.stack.split(`
`),i=l.length-1,o=a.length-1;1<=i&&0<=o&&l[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(l[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||l[i]!==a[o]){var c=`
`+l[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{gc=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?ya(e):""}function jg(e){switch(e.tag){case 5:return ya(e.type);case 16:return ya("Lazy");case 13:return ya("Suspense");case 19:return ya("SuspenseList");case 0:case 2:case 15:return e=yc(e.type,!1),e;case 11:return e=yc(e.type.render,!1),e;case 1:return e=yc(e.type,!0),e;default:return""}}function ld(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case hl:return"Fragment";case fl:return"Portal";case nd:return"Profiler";case hu:return"StrictMode";case sd:return"Suspense";case rd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ph:return(e.displayName||"Context")+".Consumer";case Lh:return(e._context.displayName||"Context")+".Provider";case pu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xu:return t=e.displayName||null,t!==null?t:ld(e.type)||"Memo";case Us:t=e._payload,e=e._init;try{return ld(e(t))}catch{}}return null}function Sg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ld(t);case 8:return t===hu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function lr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Rh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kg(e){var t=Rh(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var l=s.get,a=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(i){r=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Si(e){e._valueTracker||(e._valueTracker=kg(e))}function Oh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),r="";return e&&(r=Rh(e)?e.checked?"true":"false":e.value),e=r,e!==s?(t.setValue(e),!0):!1}function ro(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ad(e,t){var s=t.checked;return jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function qm(e,t){var s=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;s=lr(t.value!=null?t.value:s),e._wrapperState={initialChecked:r,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Bh(e,t){t=t.checked,t!=null&&fu(e,"checked",t,!1)}function id(e,t){Bh(e,t);var s=lr(t.value),r=t.type;if(s!=null)r==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?od(e,t.type,s):t.hasOwnProperty("defaultValue")&&od(e,t.type,lr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Qm(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function od(e,t,s){(t!=="number"||ro(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var va=Array.isArray;function kl(e,t,s,r){if(e=e.options,t){t={};for(var l=0;l<s.length;l++)t["$"+s[l]]=!0;for(s=0;s<e.length;s++)l=t.hasOwnProperty("$"+e[s].value),e[s].selected!==l&&(e[s].selected=l),l&&r&&(e[s].defaultSelected=!0)}else{for(s=""+lr(s),t=null,l=0;l<e.length;l++){if(e[l].value===s){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function cd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(q(91));return jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xm(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(q(92));if(va(s)){if(1<s.length)throw Error(q(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:lr(s)}}function _h(e,t){var s=lr(t.value),r=lr(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),r!=null&&(e.defaultValue=""+r)}function Zm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Uh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Uh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ki,Fh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,s,r,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ki=ki||document.createElement("div"),ki.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ki.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _a(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cg=["Webkit","ms","Moz","O"];Object.keys(wa).forEach(function(e){Cg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),wa[t]=wa[e]})});function $h(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||wa.hasOwnProperty(e)&&wa[e]?(""+t).trim():t+"px"}function zh(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var r=s.indexOf("--")===0,l=$h(s,t[s],r);s==="float"&&(s="cssFloat"),r?e.setProperty(s,l):e[s]=l}}var Eg=jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ud(e,t){if(t){if(Eg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(q(62))}}function md(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fd=null;function gu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hd=null,Cl=null,El=null;function ef(e){if(e=ai(e)){if(typeof hd!="function")throw Error(q(280));var t=e.stateNode;t&&(t=Fo(t),hd(e.stateNode,e.type,t))}}function Hh(e){Cl?El?El.push(e):El=[e]:Cl=e}function Wh(){if(Cl){var e=Cl,t=El;if(El=Cl=null,ef(e),t)for(e=0;e<t.length;e++)ef(t[e])}}function Vh(e,t){return e(t)}function Gh(){}var vc=!1;function Kh(e,t,s){if(vc)return e(t,s);vc=!0;try{return Vh(e,t,s)}finally{vc=!1,(Cl!==null||El!==null)&&(Gh(),Wh())}}function Ua(e,t){var s=e.stateNode;if(s===null)return null;var r=Fo(s);if(r===null)return null;s=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(q(231,t,typeof s));return s}var pd=!1;if(Cs)try{var ua={};Object.defineProperty(ua,"passive",{get:function(){pd=!0}}),window.addEventListener("test",ua,ua),window.removeEventListener("test",ua,ua)}catch{pd=!1}function Tg(e,t,s,r,l,a,i,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(s,d)}catch(x){this.onError(x)}}var ja=!1,lo=null,ao=!1,xd=null,Ig={onError:function(e){ja=!0,lo=e}};function Dg(e,t,s,r,l,a,i,o,c){ja=!1,lo=null,Tg.apply(Ig,arguments)}function Mg(e,t,s,r,l,a,i,o,c){if(Dg.apply(this,arguments),ja){if(ja){var d=lo;ja=!1,lo=null}else throw Error(q(198));ao||(ao=!0,xd=d)}}function Ar(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function Jh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function tf(e){if(Ar(e)!==e)throw Error(q(188))}function Lg(e){var t=e.alternate;if(!t){if(t=Ar(e),t===null)throw Error(q(188));return t!==e?null:e}for(var s=e,r=t;;){var l=s.return;if(l===null)break;var a=l.alternate;if(a===null){if(r=l.return,r!==null){s=r;continue}break}if(l.child===a.child){for(a=l.child;a;){if(a===s)return tf(l),e;if(a===r)return tf(l),t;a=a.sibling}throw Error(q(188))}if(s.return!==r.return)s=l,r=a;else{for(var i=!1,o=l.child;o;){if(o===s){i=!0,s=l,r=a;break}if(o===r){i=!0,r=l,s=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===s){i=!0,s=a,r=l;break}if(o===r){i=!0,r=a,s=l;break}o=o.sibling}if(!i)throw Error(q(189))}}if(s.alternate!==r)throw Error(q(190))}if(s.tag!==3)throw Error(q(188));return s.stateNode.current===s?e:t}function Yh(e){return e=Lg(e),e!==null?qh(e):null}function qh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=qh(e);if(t!==null)return t;e=e.sibling}return null}var Qh=wn.unstable_scheduleCallback,nf=wn.unstable_cancelCallback,Pg=wn.unstable_shouldYield,Ag=wn.unstable_requestPaint,Dt=wn.unstable_now,Rg=wn.unstable_getCurrentPriorityLevel,yu=wn.unstable_ImmediatePriority,Xh=wn.unstable_UserBlockingPriority,io=wn.unstable_NormalPriority,Og=wn.unstable_LowPriority,Zh=wn.unstable_IdlePriority,Oo=null,fs=null;function Bg(e){if(fs&&typeof fs.onCommitFiberRoot=="function")try{fs.onCommitFiberRoot(Oo,e,void 0,(e.current.flags&128)===128)}catch{}}var Gn=Math.clz32?Math.clz32:Fg,_g=Math.log,Ug=Math.LN2;function Fg(e){return e>>>=0,e===0?32:31-(_g(e)/Ug|0)|0}var Ci=64,Ei=4194304;function ba(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function oo(e,t){var s=e.pendingLanes;if(s===0)return 0;var r=0,l=e.suspendedLanes,a=e.pingedLanes,i=s&268435455;if(i!==0){var o=i&~l;o!==0?r=ba(o):(a&=i,a!==0&&(r=ba(a)))}else i=s&~l,i!==0?r=ba(i):a!==0&&(r=ba(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&l)&&(l=r&-r,a=t&-t,l>=a||l===16&&(a&4194240)!==0))return t;if(r&4&&(r|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)s=31-Gn(t),l=1<<s,r|=e[s],t&=~l;return r}function $g(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zg(e,t){for(var s=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Gn(a),o=1<<i,c=l[i];c===-1?(!(o&s)||o&r)&&(l[i]=$g(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function gd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function e0(){var e=Ci;return Ci<<=1,!(Ci&4194240)&&(Ci=64),e}function bc(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function ri(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gn(t),e[t]=s}function Hg(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<s;){var l=31-Gn(s),a=1<<l;t[l]=0,r[l]=-1,e[l]=-1,s&=~a}}function vu(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var r=31-Gn(s),l=1<<r;l&t|e[r]&t&&(e[r]|=t),s&=~l}}var tt=0;function t0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var n0,bu,s0,r0,l0,yd=!1,Ti=[],Qs=null,Xs=null,Zs=null,Fa=new Map,$a=new Map,$s=[],Wg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sf(e,t){switch(e){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":Fa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$a.delete(t.pointerId)}}function ma(e,t,s,r,l,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:s,eventSystemFlags:r,nativeEvent:a,targetContainers:[l]},t!==null&&(t=ai(t),t!==null&&bu(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Vg(e,t,s,r,l){switch(t){case"focusin":return Qs=ma(Qs,e,t,s,r,l),!0;case"dragenter":return Xs=ma(Xs,e,t,s,r,l),!0;case"mouseover":return Zs=ma(Zs,e,t,s,r,l),!0;case"pointerover":var a=l.pointerId;return Fa.set(a,ma(Fa.get(a)||null,e,t,s,r,l)),!0;case"gotpointercapture":return a=l.pointerId,$a.set(a,ma($a.get(a)||null,e,t,s,r,l)),!0}return!1}function a0(e){var t=Nr(e.target);if(t!==null){var s=Ar(t);if(s!==null){if(t=s.tag,t===13){if(t=Jh(s),t!==null){e.blockedOn=t,l0(e.priority,function(){s0(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=vd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var r=new s.constructor(s.type,s);fd=r,s.target.dispatchEvent(r),fd=null}else return t=ai(s),t!==null&&bu(t),e.blockedOn=s,!1;t.shift()}return!0}function rf(e,t,s){Vi(e)&&s.delete(t)}function Gg(){yd=!1,Qs!==null&&Vi(Qs)&&(Qs=null),Xs!==null&&Vi(Xs)&&(Xs=null),Zs!==null&&Vi(Zs)&&(Zs=null),Fa.forEach(rf),$a.forEach(rf)}function fa(e,t){e.blockedOn===t&&(e.blockedOn=null,yd||(yd=!0,wn.unstable_scheduleCallback(wn.unstable_NormalPriority,Gg)))}function za(e){function t(l){return fa(l,e)}if(0<Ti.length){fa(Ti[0],e);for(var s=1;s<Ti.length;s++){var r=Ti[s];r.blockedOn===e&&(r.blockedOn=null)}}for(Qs!==null&&fa(Qs,e),Xs!==null&&fa(Xs,e),Zs!==null&&fa(Zs,e),Fa.forEach(t),$a.forEach(t),s=0;s<$s.length;s++)r=$s[s],r.blockedOn===e&&(r.blockedOn=null);for(;0<$s.length&&(s=$s[0],s.blockedOn===null);)a0(s),s.blockedOn===null&&$s.shift()}var Tl=Ds.ReactCurrentBatchConfig,co=!0;function Kg(e,t,s,r){var l=tt,a=Tl.transition;Tl.transition=null;try{tt=1,Nu(e,t,s,r)}finally{tt=l,Tl.transition=a}}function Jg(e,t,s,r){var l=tt,a=Tl.transition;Tl.transition=null;try{tt=4,Nu(e,t,s,r)}finally{tt=l,Tl.transition=a}}function Nu(e,t,s,r){if(co){var l=vd(e,t,s,r);if(l===null)Dc(e,t,r,uo,s),sf(e,r);else if(Vg(l,e,t,s,r))r.stopPropagation();else if(sf(e,r),t&4&&-1<Wg.indexOf(e)){for(;l!==null;){var a=ai(l);if(a!==null&&n0(a),a=vd(e,t,s,r),a===null&&Dc(e,t,r,uo,s),a===l)break;l=a}l!==null&&r.stopPropagation()}else Dc(e,t,r,null,s)}}var uo=null;function vd(e,t,s,r){if(uo=null,e=gu(r),e=Nr(e),e!==null)if(t=Ar(e),t===null)e=null;else if(s=t.tag,s===13){if(e=Jh(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return uo=e,null}function i0(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rg()){case yu:return 1;case Xh:return 4;case io:case Og:return 16;case Zh:return 536870912;default:return 16}default:return 16}}var Gs=null,wu=null,Gi=null;function o0(){if(Gi)return Gi;var e,t=wu,s=t.length,r,l="value"in Gs?Gs.value:Gs.textContent,a=l.length;for(e=0;e<s&&t[e]===l[e];e++);var i=s-e;for(r=1;r<=i&&t[s-r]===l[a-r];r++);return Gi=l.slice(e,1<r?1-r:void 0)}function Ki(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ii(){return!0}function lf(){return!1}function Sn(e){function t(s,r,l,a,i){this._reactName=s,this._targetInst=l,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],this[o]=s?s(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ii:lf,this.isPropagationStopped=lf,this}return jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Ii)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Ii)},persist:function(){},isPersistent:Ii}),t}var Gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ju=Sn(Gl),li=jt({},Gl,{view:0,detail:0}),Yg=Sn(li),Nc,wc,ha,Bo=jt({},li,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Su,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ha&&(ha&&e.type==="mousemove"?(Nc=e.screenX-ha.screenX,wc=e.screenY-ha.screenY):wc=Nc=0,ha=e),Nc)},movementY:function(e){return"movementY"in e?e.movementY:wc}}),af=Sn(Bo),qg=jt({},Bo,{dataTransfer:0}),Qg=Sn(qg),Xg=jt({},li,{relatedTarget:0}),jc=Sn(Xg),Zg=jt({},Gl,{animationName:0,elapsedTime:0,pseudoElement:0}),ey=Sn(Zg),ty=jt({},Gl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ny=Sn(ty),sy=jt({},Gl,{data:0}),of=Sn(sy),ry={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ly={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ay[e])?!!t[e]:!1}function Su(){return iy}var oy=jt({},li,{key:function(e){if(e.key){var t=ry[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ki(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ly[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Su,charCode:function(e){return e.type==="keypress"?Ki(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ki(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),cy=Sn(oy),dy=jt({},Bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cf=Sn(dy),uy=jt({},li,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Su}),my=Sn(uy),fy=jt({},Gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),hy=Sn(fy),py=jt({},Bo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xy=Sn(py),gy=[9,13,27,32],ku=Cs&&"CompositionEvent"in window,Sa=null;Cs&&"documentMode"in document&&(Sa=document.documentMode);var yy=Cs&&"TextEvent"in window&&!Sa,c0=Cs&&(!ku||Sa&&8<Sa&&11>=Sa),df=" ",uf=!1;function d0(e,t){switch(e){case"keyup":return gy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u0(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pl=!1;function vy(e,t){switch(e){case"compositionend":return u0(t);case"keypress":return t.which!==32?null:(uf=!0,df);case"textInput":return e=t.data,e===df&&uf?null:e;default:return null}}function by(e,t){if(pl)return e==="compositionend"||!ku&&d0(e,t)?(e=o0(),Gi=wu=Gs=null,pl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return c0&&t.locale!=="ko"?null:t.data;default:return null}}var Ny={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ny[e.type]:t==="textarea"}function m0(e,t,s,r){Hh(r),t=mo(t,"onChange"),0<t.length&&(s=new ju("onChange","change",null,s,r),e.push({event:s,listeners:t}))}var ka=null,Ha=null;function wy(e){j0(e,0)}function _o(e){var t=yl(e);if(Oh(t))return e}function jy(e,t){if(e==="change")return t}var f0=!1;if(Cs){var Sc;if(Cs){var kc="oninput"in document;if(!kc){var ff=document.createElement("div");ff.setAttribute("oninput","return;"),kc=typeof ff.oninput=="function"}Sc=kc}else Sc=!1;f0=Sc&&(!document.documentMode||9<document.documentMode)}function hf(){ka&&(ka.detachEvent("onpropertychange",h0),Ha=ka=null)}function h0(e){if(e.propertyName==="value"&&_o(Ha)){var t=[];m0(t,Ha,e,gu(e)),Kh(wy,t)}}function Sy(e,t,s){e==="focusin"?(hf(),ka=t,Ha=s,ka.attachEvent("onpropertychange",h0)):e==="focusout"&&hf()}function ky(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _o(Ha)}function Cy(e,t){if(e==="click")return _o(t)}function Ey(e,t){if(e==="input"||e==="change")return _o(t)}function Ty(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Jn=typeof Object.is=="function"?Object.is:Ty;function Wa(e,t){if(Jn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return!1;for(r=0;r<s.length;r++){var l=s[r];if(!td.call(t,l)||!Jn(e[l],t[l]))return!1}return!0}function pf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function xf(e,t){var s=pf(e);e=0;for(var r;s;){if(s.nodeType===3){if(r=e+s.textContent.length,e<=t&&r>=t)return{node:s,offset:t-e};e=r}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=pf(s)}}function p0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?p0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function x0(){for(var e=window,t=ro();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=ro(e.document)}return t}function Cu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Iy(e){var t=x0(),s=e.focusedElem,r=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&p0(s.ownerDocument.documentElement,s)){if(r!==null&&Cu(s)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=s.textContent.length,a=Math.min(r.start,l);r=r.end===void 0?a:Math.min(r.end,l),!e.extend&&a>r&&(l=r,r=a,a=l),l=xf(s,a);var i=xf(s,r);l&&i&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dy=Cs&&"documentMode"in document&&11>=document.documentMode,xl=null,bd=null,Ca=null,Nd=!1;function gf(e,t,s){var r=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Nd||xl==null||xl!==ro(r)||(r=xl,"selectionStart"in r&&Cu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ca&&Wa(Ca,r)||(Ca=r,r=mo(bd,"onSelect"),0<r.length&&(t=new ju("onSelect","select",null,t,s),e.push({event:t,listeners:r}),t.target=xl)))}function Di(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var gl={animationend:Di("Animation","AnimationEnd"),animationiteration:Di("Animation","AnimationIteration"),animationstart:Di("Animation","AnimationStart"),transitionend:Di("Transition","TransitionEnd")},Cc={},g0={};Cs&&(g0=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function Uo(e){if(Cc[e])return Cc[e];if(!gl[e])return e;var t=gl[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in g0)return Cc[e]=t[s];return e}var y0=Uo("animationend"),v0=Uo("animationiteration"),b0=Uo("animationstart"),N0=Uo("transitionend"),w0=new Map,yf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ir(e,t){w0.set(e,t),Pr(t,[e])}for(var Ec=0;Ec<yf.length;Ec++){var Tc=yf[Ec],My=Tc.toLowerCase(),Ly=Tc[0].toUpperCase()+Tc.slice(1);ir(My,"on"+Ly)}ir(y0,"onAnimationEnd");ir(v0,"onAnimationIteration");ir(b0,"onAnimationStart");ir("dblclick","onDoubleClick");ir("focusin","onFocus");ir("focusout","onBlur");ir(N0,"onTransitionEnd");Ll("onMouseEnter",["mouseout","mouseover"]);Ll("onMouseLeave",["mouseout","mouseover"]);Ll("onPointerEnter",["pointerout","pointerover"]);Ll("onPointerLeave",["pointerout","pointerover"]);Pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Py=new Set("cancel close invalid load scroll toggle".split(" ").concat(Na));function vf(e,t,s){var r=e.type||"unknown-event";e.currentTarget=s,Mg(r,t,void 0,e),e.currentTarget=null}function j0(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var r=e[s],l=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==a&&l.isPropagationStopped())break e;vf(l,o,d),a=c}else for(i=0;i<r.length;i++){if(o=r[i],c=o.instance,d=o.currentTarget,o=o.listener,c!==a&&l.isPropagationStopped())break e;vf(l,o,d),a=c}}}if(ao)throw e=xd,ao=!1,xd=null,e}function ft(e,t){var s=t[Cd];s===void 0&&(s=t[Cd]=new Set);var r=e+"__bubble";s.has(r)||(S0(t,e,2,!1),s.add(r))}function Ic(e,t,s){var r=0;t&&(r|=4),S0(s,e,r,t)}var Mi="_reactListening"+Math.random().toString(36).slice(2);function Va(e){if(!e[Mi]){e[Mi]=!0,Mh.forEach(function(s){s!=="selectionchange"&&(Py.has(s)||Ic(s,!1,e),Ic(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Mi]||(t[Mi]=!0,Ic("selectionchange",!1,t))}}function S0(e,t,s,r){switch(i0(t)){case 1:var l=Kg;break;case 4:l=Jg;break;default:l=Nu}s=l.bind(null,t,s,e),l=void 0,!pd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,s,{capture:!0,passive:l}):e.addEventListener(t,s,!0):l!==void 0?e.addEventListener(t,s,{passive:l}):e.addEventListener(t,s,!1)}function Dc(e,t,s,r,l){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var o=r.stateNode.containerInfo;if(o===l||o.nodeType===8&&o.parentNode===l)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;i=i.return}for(;o!==null;){if(i=Nr(o),i===null)return;if(c=i.tag,c===5||c===6){r=a=i;continue e}o=o.parentNode}}r=r.return}Kh(function(){var d=a,x=gu(s),S=[];e:{var y=w0.get(e);if(y!==void 0){var N=ju,w=e;switch(e){case"keypress":if(Ki(s)===0)break e;case"keydown":case"keyup":N=cy;break;case"focusin":w="focus",N=jc;break;case"focusout":w="blur",N=jc;break;case"beforeblur":case"afterblur":N=jc;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=af;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Qg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=my;break;case y0:case v0:case b0:N=ey;break;case N0:N=hy;break;case"scroll":N=Yg;break;case"wheel":N=xy;break;case"copy":case"cut":case"paste":N=ny;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=cf}var T=(t&4)!==0,P=!T&&e==="scroll",v=T?y!==null?y+"Capture":null:y;T=[];for(var h=d,b;h!==null;){b=h;var C=b.stateNode;if(b.tag===5&&C!==null&&(b=C,v!==null&&(C=Ua(h,v),C!=null&&T.push(Ga(h,C,b)))),P)break;h=h.return}0<T.length&&(y=new N(y,w,null,s,x),S.push({event:y,listeners:T}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",y&&s!==fd&&(w=s.relatedTarget||s.fromElement)&&(Nr(w)||w[Es]))break e;if((N||y)&&(y=x.window===x?x:(y=x.ownerDocument)?y.defaultView||y.parentWindow:window,N?(w=s.relatedTarget||s.toElement,N=d,w=w?Nr(w):null,w!==null&&(P=Ar(w),w!==P||w.tag!==5&&w.tag!==6)&&(w=null)):(N=null,w=d),N!==w)){if(T=af,C="onMouseLeave",v="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(T=cf,C="onPointerLeave",v="onPointerEnter",h="pointer"),P=N==null?y:yl(N),b=w==null?y:yl(w),y=new T(C,h+"leave",N,s,x),y.target=P,y.relatedTarget=b,C=null,Nr(x)===d&&(T=new T(v,h+"enter",w,s,x),T.target=b,T.relatedTarget=P,C=T),P=C,N&&w)t:{for(T=N,v=w,h=0,b=T;b;b=cl(b))h++;for(b=0,C=v;C;C=cl(C))b++;for(;0<h-b;)T=cl(T),h--;for(;0<b-h;)v=cl(v),b--;for(;h--;){if(T===v||v!==null&&T===v.alternate)break t;T=cl(T),v=cl(v)}T=null}else T=null;N!==null&&bf(S,y,N,T,!1),w!==null&&P!==null&&bf(S,P,w,T,!0)}}e:{if(y=d?yl(d):window,N=y.nodeName&&y.nodeName.toLowerCase(),N==="select"||N==="input"&&y.type==="file")var j=jy;else if(mf(y))if(f0)j=Ey;else{j=ky;var f=Sy}else(N=y.nodeName)&&N.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(j=Cy);if(j&&(j=j(e,d))){m0(S,j,s,x);break e}f&&f(e,y,d),e==="focusout"&&(f=y._wrapperState)&&f.controlled&&y.type==="number"&&od(y,"number",y.value)}switch(f=d?yl(d):window,e){case"focusin":(mf(f)||f.contentEditable==="true")&&(xl=f,bd=d,Ca=null);break;case"focusout":Ca=bd=xl=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,gf(S,s,x);break;case"selectionchange":if(Dy)break;case"keydown":case"keyup":gf(S,s,x)}var R;if(ku)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else pl?d0(e,s)&&(B="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(B="onCompositionStart");B&&(c0&&s.locale!=="ko"&&(pl||B!=="onCompositionStart"?B==="onCompositionEnd"&&pl&&(R=o0()):(Gs=x,wu="value"in Gs?Gs.value:Gs.textContent,pl=!0)),f=mo(d,B),0<f.length&&(B=new of(B,e,null,s,x),S.push({event:B,listeners:f}),R?B.data=R:(R=u0(s),R!==null&&(B.data=R)))),(R=yy?vy(e,s):by(e,s))&&(d=mo(d,"onBeforeInput"),0<d.length&&(x=new of("onBeforeInput","beforeinput",null,s,x),S.push({event:x,listeners:d}),x.data=R))}j0(S,t)})}function Ga(e,t,s){return{instance:e,listener:t,currentTarget:s}}function mo(e,t){for(var s=t+"Capture",r=[];e!==null;){var l=e,a=l.stateNode;l.tag===5&&a!==null&&(l=a,a=Ua(e,s),a!=null&&r.unshift(Ga(e,a,l)),a=Ua(e,t),a!=null&&r.push(Ga(e,a,l))),e=e.return}return r}function cl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bf(e,t,s,r,l){for(var a=t._reactName,i=[];s!==null&&s!==r;){var o=s,c=o.alternate,d=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&d!==null&&(o=d,l?(c=Ua(s,a),c!=null&&i.unshift(Ga(s,c,o))):l||(c=Ua(s,a),c!=null&&i.push(Ga(s,c,o)))),s=s.return}i.length!==0&&e.push({event:t,listeners:i})}var Ay=/\r\n?/g,Ry=/\u0000|\uFFFD/g;function Nf(e){return(typeof e=="string"?e:""+e).replace(Ay,`
`).replace(Ry,"")}function Li(e,t,s){if(t=Nf(t),Nf(e)!==t&&s)throw Error(q(425))}function fo(){}var wd=null,jd=null;function Sd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var kd=typeof setTimeout=="function"?setTimeout:void 0,Oy=typeof clearTimeout=="function"?clearTimeout:void 0,wf=typeof Promise=="function"?Promise:void 0,By=typeof queueMicrotask=="function"?queueMicrotask:typeof wf<"u"?function(e){return wf.resolve(null).then(e).catch(_y)}:kd;function _y(e){setTimeout(function(){throw e})}function Mc(e,t){var s=t,r=0;do{var l=s.nextSibling;if(e.removeChild(s),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(r===0){e.removeChild(l),za(t);return}r--}else s!=="$"&&s!=="$?"&&s!=="$!"||r++;s=l}while(s);za(t)}function er(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function jf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Kl=Math.random().toString(36).slice(2),ms="__reactFiber$"+Kl,Ka="__reactProps$"+Kl,Es="__reactContainer$"+Kl,Cd="__reactEvents$"+Kl,Uy="__reactListeners$"+Kl,Fy="__reactHandles$"+Kl;function Nr(e){var t=e[ms];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Es]||s[ms]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=jf(e);e!==null;){if(s=e[ms])return s;e=jf(e)}return t}e=s,s=e.parentNode}return null}function ai(e){return e=e[ms]||e[Es],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function Fo(e){return e[Ka]||null}var Ed=[],vl=-1;function or(e){return{current:e}}function ht(e){0>vl||(e.current=Ed[vl],Ed[vl]=null,vl--)}function ot(e,t){vl++,Ed[vl]=e.current,e.current=t}var ar={},en=or(ar),mn=or(!1),Tr=ar;function Pl(e,t){var s=e.type.contextTypes;if(!s)return ar;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},a;for(a in s)l[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function fn(e){return e=e.childContextTypes,e!=null}function ho(){ht(mn),ht(en)}function Sf(e,t,s){if(en.current!==ar)throw Error(q(168));ot(en,t),ot(mn,s)}function k0(e,t,s){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return s;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(q(108,Sg(e)||"Unknown",l));return jt({},s,r)}function po(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ar,Tr=en.current,ot(en,e),ot(mn,mn.current),!0}function kf(e,t,s){var r=e.stateNode;if(!r)throw Error(q(169));s?(e=k0(e,t,Tr),r.__reactInternalMemoizedMergedChildContext=e,ht(mn),ht(en),ot(en,e)):ht(mn),ot(mn,s)}var ws=null,$o=!1,Lc=!1;function C0(e){ws===null?ws=[e]:ws.push(e)}function $y(e){$o=!0,C0(e)}function cr(){if(!Lc&&ws!==null){Lc=!0;var e=0,t=tt;try{var s=ws;for(tt=1;e<s.length;e++){var r=s[e];do r=r(!0);while(r!==null)}ws=null,$o=!1}catch(l){throw ws!==null&&(ws=ws.slice(e+1)),Qh(yu,cr),l}finally{tt=t,Lc=!1}}return null}var bl=[],Nl=0,xo=null,go=0,Mn=[],Ln=0,Ir=null,js=1,Ss="";function yr(e,t){bl[Nl++]=go,bl[Nl++]=xo,xo=e,go=t}function E0(e,t,s){Mn[Ln++]=js,Mn[Ln++]=Ss,Mn[Ln++]=Ir,Ir=e;var r=js;e=Ss;var l=32-Gn(r)-1;r&=~(1<<l),s+=1;var a=32-Gn(t)+l;if(30<a){var i=l-l%5;a=(r&(1<<i)-1).toString(32),r>>=i,l-=i,js=1<<32-Gn(t)+l|s<<l|r,Ss=a+e}else js=1<<a|s<<l|r,Ss=e}function Eu(e){e.return!==null&&(yr(e,1),E0(e,1,0))}function Tu(e){for(;e===xo;)xo=bl[--Nl],bl[Nl]=null,go=bl[--Nl],bl[Nl]=null;for(;e===Ir;)Ir=Mn[--Ln],Mn[Ln]=null,Ss=Mn[--Ln],Mn[Ln]=null,js=Mn[--Ln],Mn[Ln]=null}var Nn=null,bn=null,xt=!1,Vn=null;function T0(e,t){var s=Pn(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Cf(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Nn=e,bn=er(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Nn=e,bn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=Ir!==null?{id:js,overflow:Ss}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=Pn(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,Nn=e,bn=null,!0):!1;default:return!1}}function Td(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Id(e){if(xt){var t=bn;if(t){var s=t;if(!Cf(e,t)){if(Td(e))throw Error(q(418));t=er(s.nextSibling);var r=Nn;t&&Cf(e,t)?T0(r,s):(e.flags=e.flags&-4097|2,xt=!1,Nn=e)}}else{if(Td(e))throw Error(q(418));e.flags=e.flags&-4097|2,xt=!1,Nn=e}}}function Ef(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Nn=e}function Pi(e){if(e!==Nn)return!1;if(!xt)return Ef(e),xt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sd(e.type,e.memoizedProps)),t&&(t=bn)){if(Td(e))throw I0(),Error(q(418));for(;t;)T0(e,t),t=er(t.nextSibling)}if(Ef(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){bn=er(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}bn=null}}else bn=Nn?er(e.stateNode.nextSibling):null;return!0}function I0(){for(var e=bn;e;)e=er(e.nextSibling)}function Al(){bn=Nn=null,xt=!1}function Iu(e){Vn===null?Vn=[e]:Vn.push(e)}var zy=Ds.ReactCurrentBatchConfig;function pa(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(q(309));var r=s.stateNode}if(!r)throw Error(q(147,e));var l=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=l.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(q(284));if(!s._owner)throw Error(q(290,e))}return e}function Ai(e,t){throw e=Object.prototype.toString.call(t),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Tf(e){var t=e._init;return t(e._payload)}function D0(e){function t(v,h){if(e){var b=v.deletions;b===null?(v.deletions=[h],v.flags|=16):b.push(h)}}function s(v,h){if(!e)return null;for(;h!==null;)t(v,h),h=h.sibling;return null}function r(v,h){for(v=new Map;h!==null;)h.key!==null?v.set(h.key,h):v.set(h.index,h),h=h.sibling;return v}function l(v,h){return v=rr(v,h),v.index=0,v.sibling=null,v}function a(v,h,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<h?(v.flags|=2,h):b):(v.flags|=2,h)):(v.flags|=1048576,h)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,h,b,C){return h===null||h.tag!==6?(h=Uc(b,v.mode,C),h.return=v,h):(h=l(h,b),h.return=v,h)}function c(v,h,b,C){var j=b.type;return j===hl?x(v,h,b.props.children,C,b.key):h!==null&&(h.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Us&&Tf(j)===h.type)?(C=l(h,b.props),C.ref=pa(v,h,b),C.return=v,C):(C=eo(b.type,b.key,b.props,null,v.mode,C),C.ref=pa(v,h,b),C.return=v,C)}function d(v,h,b,C){return h===null||h.tag!==4||h.stateNode.containerInfo!==b.containerInfo||h.stateNode.implementation!==b.implementation?(h=Fc(b,v.mode,C),h.return=v,h):(h=l(h,b.children||[]),h.return=v,h)}function x(v,h,b,C,j){return h===null||h.tag!==7?(h=Er(b,v.mode,C,j),h.return=v,h):(h=l(h,b),h.return=v,h)}function S(v,h,b){if(typeof h=="string"&&h!==""||typeof h=="number")return h=Uc(""+h,v.mode,b),h.return=v,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case ji:return b=eo(h.type,h.key,h.props,null,v.mode,b),b.ref=pa(v,null,h),b.return=v,b;case fl:return h=Fc(h,v.mode,b),h.return=v,h;case Us:var C=h._init;return S(v,C(h._payload),b)}if(va(h)||da(h))return h=Er(h,v.mode,b,null),h.return=v,h;Ai(v,h)}return null}function y(v,h,b,C){var j=h!==null?h.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:o(v,h,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ji:return b.key===j?c(v,h,b,C):null;case fl:return b.key===j?d(v,h,b,C):null;case Us:return j=b._init,y(v,h,j(b._payload),C)}if(va(b)||da(b))return j!==null?null:x(v,h,b,C,null);Ai(v,b)}return null}function N(v,h,b,C,j){if(typeof C=="string"&&C!==""||typeof C=="number")return v=v.get(b)||null,o(h,v,""+C,j);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case ji:return v=v.get(C.key===null?b:C.key)||null,c(h,v,C,j);case fl:return v=v.get(C.key===null?b:C.key)||null,d(h,v,C,j);case Us:var f=C._init;return N(v,h,b,f(C._payload),j)}if(va(C)||da(C))return v=v.get(b)||null,x(h,v,C,j,null);Ai(h,C)}return null}function w(v,h,b,C){for(var j=null,f=null,R=h,B=h=0,ee=null;R!==null&&B<b.length;B++){R.index>B?(ee=R,R=null):ee=R.sibling;var Y=y(v,R,b[B],C);if(Y===null){R===null&&(R=ee);break}e&&R&&Y.alternate===null&&t(v,R),h=a(Y,h,B),f===null?j=Y:f.sibling=Y,f=Y,R=ee}if(B===b.length)return s(v,R),xt&&yr(v,B),j;if(R===null){for(;B<b.length;B++)R=S(v,b[B],C),R!==null&&(h=a(R,h,B),f===null?j=R:f.sibling=R,f=R);return xt&&yr(v,B),j}for(R=r(v,R);B<b.length;B++)ee=N(R,v,B,b[B],C),ee!==null&&(e&&ee.alternate!==null&&R.delete(ee.key===null?B:ee.key),h=a(ee,h,B),f===null?j=ee:f.sibling=ee,f=ee);return e&&R.forEach(function($){return t(v,$)}),xt&&yr(v,B),j}function T(v,h,b,C){var j=da(b);if(typeof j!="function")throw Error(q(150));if(b=j.call(b),b==null)throw Error(q(151));for(var f=j=null,R=h,B=h=0,ee=null,Y=b.next();R!==null&&!Y.done;B++,Y=b.next()){R.index>B?(ee=R,R=null):ee=R.sibling;var $=y(v,R,Y.value,C);if($===null){R===null&&(R=ee);break}e&&R&&$.alternate===null&&t(v,R),h=a($,h,B),f===null?j=$:f.sibling=$,f=$,R=ee}if(Y.done)return s(v,R),xt&&yr(v,B),j;if(R===null){for(;!Y.done;B++,Y=b.next())Y=S(v,Y.value,C),Y!==null&&(h=a(Y,h,B),f===null?j=Y:f.sibling=Y,f=Y);return xt&&yr(v,B),j}for(R=r(v,R);!Y.done;B++,Y=b.next())Y=N(R,v,B,Y.value,C),Y!==null&&(e&&Y.alternate!==null&&R.delete(Y.key===null?B:Y.key),h=a(Y,h,B),f===null?j=Y:f.sibling=Y,f=Y);return e&&R.forEach(function(Q){return t(v,Q)}),xt&&yr(v,B),j}function P(v,h,b,C){if(typeof b=="object"&&b!==null&&b.type===hl&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ji:e:{for(var j=b.key,f=h;f!==null;){if(f.key===j){if(j=b.type,j===hl){if(f.tag===7){s(v,f.sibling),h=l(f,b.props.children),h.return=v,v=h;break e}}else if(f.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Us&&Tf(j)===f.type){s(v,f.sibling),h=l(f,b.props),h.ref=pa(v,f,b),h.return=v,v=h;break e}s(v,f);break}else t(v,f);f=f.sibling}b.type===hl?(h=Er(b.props.children,v.mode,C,b.key),h.return=v,v=h):(C=eo(b.type,b.key,b.props,null,v.mode,C),C.ref=pa(v,h,b),C.return=v,v=C)}return i(v);case fl:e:{for(f=b.key;h!==null;){if(h.key===f)if(h.tag===4&&h.stateNode.containerInfo===b.containerInfo&&h.stateNode.implementation===b.implementation){s(v,h.sibling),h=l(h,b.children||[]),h.return=v,v=h;break e}else{s(v,h);break}else t(v,h);h=h.sibling}h=Fc(b,v.mode,C),h.return=v,v=h}return i(v);case Us:return f=b._init,P(v,h,f(b._payload),C)}if(va(b))return w(v,h,b,C);if(da(b))return T(v,h,b,C);Ai(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,h!==null&&h.tag===6?(s(v,h.sibling),h=l(h,b),h.return=v,v=h):(s(v,h),h=Uc(b,v.mode,C),h.return=v,v=h),i(v)):s(v,h)}return P}var Rl=D0(!0),M0=D0(!1),yo=or(null),vo=null,wl=null,Du=null;function Mu(){Du=wl=vo=null}function Lu(e){var t=yo.current;ht(yo),e._currentValue=t}function Dd(e,t,s){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===s)break;e=e.return}}function Il(e,t){vo=e,Du=wl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(un=!0),e.firstContext=null)}function Rn(e){var t=e._currentValue;if(Du!==e)if(e={context:e,memoizedValue:t,next:null},wl===null){if(vo===null)throw Error(q(308));wl=e,vo.dependencies={lanes:0,firstContext:e}}else wl=wl.next=e;return t}var wr=null;function Pu(e){wr===null?wr=[e]:wr.push(e)}function L0(e,t,s,r){var l=t.interleaved;return l===null?(s.next=s,Pu(t)):(s.next=l.next,l.next=s),t.interleaved=s,Ts(e,r)}function Ts(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Fs=!1;function Au(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P0(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ks(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function tr(e,t,s){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ye&2){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,Ts(e,s)}return l=r.interleaved,l===null?(t.next=t,Pu(r)):(t.next=l.next,l.next=t),r.interleaved=t,Ts(e,s)}function Ji(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,s|=r,t.lanes=s,vu(e,s)}}function If(e,t){var s=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,s===r)){var l=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?l=a=i:a=a.next=i,s=s.next}while(s!==null);a===null?l=a=t:a=a.next=t}else l=a=t;s={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function bo(e,t,s,r){var l=e.updateQueue;Fs=!1;var a=l.firstBaseUpdate,i=l.lastBaseUpdate,o=l.shared.pending;if(o!==null){l.shared.pending=null;var c=o,d=c.next;c.next=null,i===null?a=d:i.next=d,i=c;var x=e.alternate;x!==null&&(x=x.updateQueue,o=x.lastBaseUpdate,o!==i&&(o===null?x.firstBaseUpdate=d:o.next=d,x.lastBaseUpdate=c))}if(a!==null){var S=l.baseState;i=0,x=d=c=null,o=a;do{var y=o.lane,N=o.eventTime;if((r&y)===y){x!==null&&(x=x.next={eventTime:N,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var w=e,T=o;switch(y=t,N=s,T.tag){case 1:if(w=T.payload,typeof w=="function"){S=w.call(N,S,y);break e}S=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=T.payload,y=typeof w=="function"?w.call(N,S,y):w,y==null)break e;S=jt({},S,y);break e;case 2:Fs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,y=l.effects,y===null?l.effects=[o]:y.push(o))}else N={eventTime:N,lane:y,tag:o.tag,payload:o.payload,callback:o.callback,next:null},x===null?(d=x=N,c=S):x=x.next=N,i|=y;if(o=o.next,o===null){if(o=l.shared.pending,o===null)break;y=o,o=y.next,y.next=null,l.lastBaseUpdate=y,l.shared.pending=null}}while(!0);if(x===null&&(c=S),l.baseState=c,l.firstBaseUpdate=d,l.lastBaseUpdate=x,t=l.shared.interleaved,t!==null){l=t;do i|=l.lane,l=l.next;while(l!==t)}else a===null&&(l.shared.lanes=0);Mr|=i,e.lanes=i,e.memoizedState=S}}function Df(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=s,typeof l!="function")throw Error(q(191,l));l.call(r)}}}var ii={},hs=or(ii),Ja=or(ii),Ya=or(ii);function jr(e){if(e===ii)throw Error(q(174));return e}function Ru(e,t){switch(ot(Ya,t),ot(Ja,e),ot(hs,ii),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dd(t,e)}ht(hs),ot(hs,t)}function Ol(){ht(hs),ht(Ja),ht(Ya)}function A0(e){jr(Ya.current);var t=jr(hs.current),s=dd(t,e.type);t!==s&&(ot(Ja,e),ot(hs,s))}function Ou(e){Ja.current===e&&(ht(hs),ht(Ja))}var Nt=or(0);function No(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Pc=[];function Bu(){for(var e=0;e<Pc.length;e++)Pc[e]._workInProgressVersionPrimary=null;Pc.length=0}var Yi=Ds.ReactCurrentDispatcher,Ac=Ds.ReactCurrentBatchConfig,Dr=0,wt=null,_t=null,zt=null,wo=!1,Ea=!1,qa=0,Hy=0;function Qt(){throw Error(q(321))}function _u(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Jn(e[s],t[s]))return!1;return!0}function Uu(e,t,s,r,l,a){if(Dr=a,wt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Yi.current=e===null||e.memoizedState===null?Ky:Jy,e=s(r,l),Ea){a=0;do{if(Ea=!1,qa=0,25<=a)throw Error(q(301));a+=1,zt=_t=null,t.updateQueue=null,Yi.current=Yy,e=s(r,l)}while(Ea)}if(Yi.current=jo,t=_t!==null&&_t.next!==null,Dr=0,zt=_t=wt=null,wo=!1,t)throw Error(q(300));return e}function Fu(){var e=qa!==0;return qa=0,e}function us(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?wt.memoizedState=zt=e:zt=zt.next=e,zt}function On(){if(_t===null){var e=wt.alternate;e=e!==null?e.memoizedState:null}else e=_t.next;var t=zt===null?wt.memoizedState:zt.next;if(t!==null)zt=t,_t=e;else{if(e===null)throw Error(q(310));_t=e,e={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},zt===null?wt.memoizedState=zt=e:zt=zt.next=e}return zt}function Qa(e,t){return typeof t=="function"?t(e):t}function Rc(e){var t=On(),s=t.queue;if(s===null)throw Error(q(311));s.lastRenderedReducer=e;var r=_t,l=r.baseQueue,a=s.pending;if(a!==null){if(l!==null){var i=l.next;l.next=a.next,a.next=i}r.baseQueue=l=a,s.pending=null}if(l!==null){a=l.next,r=r.baseState;var o=i=null,c=null,d=a;do{var x=d.lane;if((Dr&x)===x)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var S={lane:x,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=S,i=r):c=c.next=S,wt.lanes|=x,Mr|=x}d=d.next}while(d!==null&&d!==a);c===null?i=r:c.next=o,Jn(r,t.memoizedState)||(un=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,s.lastRenderedState=r}if(e=s.interleaved,e!==null){l=e;do a=l.lane,wt.lanes|=a,Mr|=a,l=l.next;while(l!==e)}else l===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function Oc(e){var t=On(),s=t.queue;if(s===null)throw Error(q(311));s.lastRenderedReducer=e;var r=s.dispatch,l=s.pending,a=t.memoizedState;if(l!==null){s.pending=null;var i=l=l.next;do a=e(a,i.action),i=i.next;while(i!==l);Jn(a,t.memoizedState)||(un=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),s.lastRenderedState=a}return[a,r]}function R0(){}function O0(e,t){var s=wt,r=On(),l=t(),a=!Jn(r.memoizedState,l);if(a&&(r.memoizedState=l,un=!0),r=r.queue,$u(U0.bind(null,s,r,e),[e]),r.getSnapshot!==t||a||zt!==null&&zt.memoizedState.tag&1){if(s.flags|=2048,Xa(9,_0.bind(null,s,r,l,t),void 0,null),Ht===null)throw Error(q(349));Dr&30||B0(s,t,l)}return l}function B0(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function _0(e,t,s,r){t.value=s,t.getSnapshot=r,F0(t)&&$0(e)}function U0(e,t,s){return s(function(){F0(t)&&$0(e)})}function F0(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Jn(e,s)}catch{return!0}}function $0(e){var t=Ts(e,1);t!==null&&Kn(t,e,1,-1)}function Mf(e){var t=us();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:e},t.queue=e,e=e.dispatch=Gy.bind(null,wt,e),[t.memoizedState,e]}function Xa(e,t,s,r){return e={tag:e,create:t,destroy:s,deps:r,next:null},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(r=s.next,s.next=e,e.next=r,t.lastEffect=e)),e}function z0(){return On().memoizedState}function qi(e,t,s,r){var l=us();wt.flags|=e,l.memoizedState=Xa(1|t,s,void 0,r===void 0?null:r)}function zo(e,t,s,r){var l=On();r=r===void 0?null:r;var a=void 0;if(_t!==null){var i=_t.memoizedState;if(a=i.destroy,r!==null&&_u(r,i.deps)){l.memoizedState=Xa(t,s,a,r);return}}wt.flags|=e,l.memoizedState=Xa(1|t,s,a,r)}function Lf(e,t){return qi(8390656,8,e,t)}function $u(e,t){return zo(2048,8,e,t)}function H0(e,t){return zo(4,2,e,t)}function W0(e,t){return zo(4,4,e,t)}function V0(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function G0(e,t,s){return s=s!=null?s.concat([e]):null,zo(4,4,V0.bind(null,t,e),s)}function zu(){}function K0(e,t){var s=On();t=t===void 0?null:t;var r=s.memoizedState;return r!==null&&t!==null&&_u(t,r[1])?r[0]:(s.memoizedState=[e,t],e)}function J0(e,t){var s=On();t=t===void 0?null:t;var r=s.memoizedState;return r!==null&&t!==null&&_u(t,r[1])?r[0]:(e=e(),s.memoizedState=[e,t],e)}function Y0(e,t,s){return Dr&21?(Jn(s,t)||(s=e0(),wt.lanes|=s,Mr|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,un=!0),e.memoizedState=s)}function Wy(e,t){var s=tt;tt=s!==0&&4>s?s:4,e(!0);var r=Ac.transition;Ac.transition={};try{e(!1),t()}finally{tt=s,Ac.transition=r}}function q0(){return On().memoizedState}function Vy(e,t,s){var r=sr(e);if(s={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null},Q0(e))X0(t,s);else if(s=L0(e,t,s,r),s!==null){var l=rn();Kn(s,e,r,l),Z0(s,t,r)}}function Gy(e,t,s){var r=sr(e),l={lane:r,action:s,hasEagerState:!1,eagerState:null,next:null};if(Q0(e))X0(t,l);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,s);if(l.hasEagerState=!0,l.eagerState=o,Jn(o,i)){var c=t.interleaved;c===null?(l.next=l,Pu(t)):(l.next=c.next,c.next=l),t.interleaved=l;return}}catch{}finally{}s=L0(e,t,l,r),s!==null&&(l=rn(),Kn(s,e,r,l),Z0(s,t,r))}}function Q0(e){var t=e.alternate;return e===wt||t!==null&&t===wt}function X0(e,t){Ea=wo=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Z0(e,t,s){if(s&4194240){var r=t.lanes;r&=e.pendingLanes,s|=r,t.lanes=s,vu(e,s)}}var jo={readContext:Rn,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},Ky={readContext:Rn,useCallback:function(e,t){return us().memoizedState=[e,t===void 0?null:t],e},useContext:Rn,useEffect:Lf,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,qi(4194308,4,V0.bind(null,t,e),s)},useLayoutEffect:function(e,t){return qi(4194308,4,e,t)},useInsertionEffect:function(e,t){return qi(4,2,e,t)},useMemo:function(e,t){var s=us();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var r=us();return t=s!==void 0?s(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Vy.bind(null,wt,e),[r.memoizedState,e]},useRef:function(e){var t=us();return e={current:e},t.memoizedState=e},useState:Mf,useDebugValue:zu,useDeferredValue:function(e){return us().memoizedState=e},useTransition:function(){var e=Mf(!1),t=e[0];return e=Wy.bind(null,e[1]),us().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var r=wt,l=us();if(xt){if(s===void 0)throw Error(q(407));s=s()}else{if(s=t(),Ht===null)throw Error(q(349));Dr&30||B0(r,t,s)}l.memoizedState=s;var a={value:s,getSnapshot:t};return l.queue=a,Lf(U0.bind(null,r,a,e),[e]),r.flags|=2048,Xa(9,_0.bind(null,r,a,s,t),void 0,null),s},useId:function(){var e=us(),t=Ht.identifierPrefix;if(xt){var s=Ss,r=js;s=(r&~(1<<32-Gn(r)-1)).toString(32)+s,t=":"+t+"R"+s,s=qa++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=Hy++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Jy={readContext:Rn,useCallback:K0,useContext:Rn,useEffect:$u,useImperativeHandle:G0,useInsertionEffect:H0,useLayoutEffect:W0,useMemo:J0,useReducer:Rc,useRef:z0,useState:function(){return Rc(Qa)},useDebugValue:zu,useDeferredValue:function(e){var t=On();return Y0(t,_t.memoizedState,e)},useTransition:function(){var e=Rc(Qa)[0],t=On().memoizedState;return[e,t]},useMutableSource:R0,useSyncExternalStore:O0,useId:q0,unstable_isNewReconciler:!1},Yy={readContext:Rn,useCallback:K0,useContext:Rn,useEffect:$u,useImperativeHandle:G0,useInsertionEffect:H0,useLayoutEffect:W0,useMemo:J0,useReducer:Oc,useRef:z0,useState:function(){return Oc(Qa)},useDebugValue:zu,useDeferredValue:function(e){var t=On();return _t===null?t.memoizedState=e:Y0(t,_t.memoizedState,e)},useTransition:function(){var e=Oc(Qa)[0],t=On().memoizedState;return[e,t]},useMutableSource:R0,useSyncExternalStore:O0,useId:q0,unstable_isNewReconciler:!1};function Hn(e,t){if(e&&e.defaultProps){t=jt({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function Md(e,t,s,r){t=e.memoizedState,s=s(r,t),s=s==null?t:jt({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ho={isMounted:function(e){return(e=e._reactInternals)?Ar(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var r=rn(),l=sr(e),a=ks(r,l);a.payload=t,s!=null&&(a.callback=s),t=tr(e,a,l),t!==null&&(Kn(t,e,l,r),Ji(t,e,l))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var r=rn(),l=sr(e),a=ks(r,l);a.tag=1,a.payload=t,s!=null&&(a.callback=s),t=tr(e,a,l),t!==null&&(Kn(t,e,l,r),Ji(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=rn(),r=sr(e),l=ks(s,r);l.tag=2,t!=null&&(l.callback=t),t=tr(e,l,r),t!==null&&(Kn(t,e,r,s),Ji(t,e,r))}};function Pf(e,t,s,r,l,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,i):t.prototype&&t.prototype.isPureReactComponent?!Wa(s,r)||!Wa(l,a):!0}function ep(e,t,s){var r=!1,l=ar,a=t.contextType;return typeof a=="object"&&a!==null?a=Rn(a):(l=fn(t)?Tr:en.current,r=t.contextTypes,a=(r=r!=null)?Pl(e,l):ar),t=new t(s,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ho,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=a),t}function Af(e,t,s,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,r),t.state!==e&&Ho.enqueueReplaceState(t,t.state,null)}function Ld(e,t,s,r){var l=e.stateNode;l.props=s,l.state=e.memoizedState,l.refs={},Au(e);var a=t.contextType;typeof a=="object"&&a!==null?l.context=Rn(a):(a=fn(t)?Tr:en.current,l.context=Pl(e,a)),l.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Md(e,t,a,s),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&Ho.enqueueReplaceState(l,l.state,null),bo(e,s,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Bl(e,t){try{var s="",r=t;do s+=jg(r),r=r.return;while(r);var l=s}catch(a){l=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:l,digest:null}}function Bc(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function Pd(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var qy=typeof WeakMap=="function"?WeakMap:Map;function tp(e,t,s){s=ks(-1,s),s.tag=3,s.payload={element:null};var r=t.value;return s.callback=function(){ko||(ko=!0,Hd=r),Pd(e,t)},s}function np(e,t,s){s=ks(-1,s),s.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;s.payload=function(){return r(l)},s.callback=function(){Pd(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){Pd(e,t),typeof r!="function"&&(nr===null?nr=new Set([this]):nr.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),s}function Rf(e,t,s){var r=e.pingCache;if(r===null){r=e.pingCache=new qy;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(s)||(l.add(s),e=dv.bind(null,e,t,s),t.then(e,e))}function Of(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Bf(e,t,s,r,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=ks(-1,1),t.tag=2,tr(s,t,1))),s.lanes|=1),e)}var Qy=Ds.ReactCurrentOwner,un=!1;function sn(e,t,s,r){t.child=e===null?M0(t,null,s,r):Rl(t,e.child,s,r)}function _f(e,t,s,r,l){s=s.render;var a=t.ref;return Il(t,l),r=Uu(e,t,s,r,a,l),s=Fu(),e!==null&&!un?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Is(e,t,l)):(xt&&s&&Eu(t),t.flags|=1,sn(e,t,r,l),t.child)}function Uf(e,t,s,r,l){if(e===null){var a=s.type;return typeof a=="function"&&!qu(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=a,sp(e,t,a,r,l)):(e=eo(s.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&l)){var i=a.memoizedProps;if(s=s.compare,s=s!==null?s:Wa,s(i,r)&&e.ref===t.ref)return Is(e,t,l)}return t.flags|=1,e=rr(a,r),e.ref=t.ref,e.return=t,t.child=e}function sp(e,t,s,r,l){if(e!==null){var a=e.memoizedProps;if(Wa(a,r)&&e.ref===t.ref)if(un=!1,t.pendingProps=r=a,(e.lanes&l)!==0)e.flags&131072&&(un=!0);else return t.lanes=e.lanes,Is(e,t,l)}return Ad(e,t,s,r,l)}function rp(e,t,s){var r=t.pendingProps,l=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(Sl,vn),vn|=s;else{if(!(s&1073741824))return e=a!==null?a.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ot(Sl,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:s,ot(Sl,vn),vn|=r}else a!==null?(r=a.baseLanes|s,t.memoizedState=null):r=s,ot(Sl,vn),vn|=r;return sn(e,t,l,s),t.child}function lp(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Ad(e,t,s,r,l){var a=fn(s)?Tr:en.current;return a=Pl(t,a),Il(t,l),s=Uu(e,t,s,r,a,l),r=Fu(),e!==null&&!un?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Is(e,t,l)):(xt&&r&&Eu(t),t.flags|=1,sn(e,t,s,l),t.child)}function Ff(e,t,s,r,l){if(fn(s)){var a=!0;po(t)}else a=!1;if(Il(t,l),t.stateNode===null)Qi(e,t),ep(t,s,r),Ld(t,s,r,l),r=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,d=s.contextType;typeof d=="object"&&d!==null?d=Rn(d):(d=fn(s)?Tr:en.current,d=Pl(t,d));var x=s.getDerivedStateFromProps,S=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function";S||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==r||c!==d)&&Af(t,i,r,d),Fs=!1;var y=t.memoizedState;i.state=y,bo(t,r,i,l),c=t.memoizedState,o!==r||y!==c||mn.current||Fs?(typeof x=="function"&&(Md(t,s,x,r),c=t.memoizedState),(o=Fs||Pf(t,s,o,r,y,c,d))?(S||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=d,r=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,P0(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:Hn(t.type,o),i.props=d,S=t.pendingProps,y=i.context,c=s.contextType,typeof c=="object"&&c!==null?c=Rn(c):(c=fn(s)?Tr:en.current,c=Pl(t,c));var N=s.getDerivedStateFromProps;(x=typeof N=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==S||y!==c)&&Af(t,i,r,c),Fs=!1,y=t.memoizedState,i.state=y,bo(t,r,i,l);var w=t.memoizedState;o!==S||y!==w||mn.current||Fs?(typeof N=="function"&&(Md(t,s,N,r),w=t.memoizedState),(d=Fs||Pf(t,s,d,r,y,w,c)||!1)?(x||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,w,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,w,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),i.props=r,i.state=w,i.context=c,r=d):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),r=!1)}return Rd(e,t,s,r,a,l)}function Rd(e,t,s,r,l,a){lp(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return l&&kf(t,s,!1),Is(e,t,a);r=t.stateNode,Qy.current=t;var o=i&&typeof s.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Rl(t,e.child,null,a),t.child=Rl(t,null,o,a)):sn(e,t,o,a),t.memoizedState=r.state,l&&kf(t,s,!0),t.child}function ap(e){var t=e.stateNode;t.pendingContext?Sf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Sf(e,t.context,!1),Ru(e,t.containerInfo)}function $f(e,t,s,r,l){return Al(),Iu(l),t.flags|=256,sn(e,t,s,r),t.child}var Od={dehydrated:null,treeContext:null,retryLane:0};function Bd(e){return{baseLanes:e,cachePool:null,transitions:null}}function ip(e,t,s){var r=t.pendingProps,l=Nt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(l&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),ot(Nt,l&1),e===null)return Id(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,a?(r=t.mode,a=t.child,i={mode:"hidden",children:i},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Go(i,r,0,null),e=Er(e,r,s,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Bd(s),t.memoizedState=Od,e):Hu(t,i));if(l=e.memoizedState,l!==null&&(o=l.dehydrated,o!==null))return Xy(e,t,i,r,o,l,s);if(a){a=r.fallback,i=t.mode,l=e.child,o=l.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=rr(l,c),r.subtreeFlags=l.subtreeFlags&14680064),o!==null?a=rr(o,a):(a=Er(a,i,s,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,i=e.child.memoizedState,i=i===null?Bd(s):{baseLanes:i.baseLanes|s,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~s,t.memoizedState=Od,r}return a=e.child,e=a.sibling,r=rr(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=s),r.return=t,r.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=r,t.memoizedState=null,r}function Hu(e,t){return t=Go({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ri(e,t,s,r){return r!==null&&Iu(r),Rl(t,e.child,null,s),e=Hu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Xy(e,t,s,r,l,a,i){if(s)return t.flags&256?(t.flags&=-257,r=Bc(Error(q(422))),Ri(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,l=t.mode,r=Go({mode:"visible",children:r.children},l,0,null),a=Er(a,l,i,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&Rl(t,e.child,null,i),t.child.memoizedState=Bd(i),t.memoizedState=Od,a);if(!(t.mode&1))return Ri(e,t,i,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(q(419)),r=Bc(a,r,void 0),Ri(e,t,i,r)}if(o=(i&e.childLanes)!==0,un||o){if(r=Ht,r!==null){switch(i&-i){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(r.suspendedLanes|i)?0:l,l!==0&&l!==a.retryLane&&(a.retryLane=l,Ts(e,l),Kn(r,e,l,-1))}return Yu(),r=Bc(Error(q(421))),Ri(e,t,i,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=uv.bind(null,e),l._reactRetry=t,null):(e=a.treeContext,bn=er(l.nextSibling),Nn=t,xt=!0,Vn=null,e!==null&&(Mn[Ln++]=js,Mn[Ln++]=Ss,Mn[Ln++]=Ir,js=e.id,Ss=e.overflow,Ir=t),t=Hu(t,r.children),t.flags|=4096,t)}function zf(e,t,s){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Dd(e.return,t,s)}function _c(e,t,s,r,l){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:s,tailMode:l}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=s,a.tailMode=l)}function op(e,t,s){var r=t.pendingProps,l=r.revealOrder,a=r.tail;if(sn(e,t,r.children,s),r=Nt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&zf(e,s,t);else if(e.tag===19)zf(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ot(Nt,r),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(s=t.child,l=null;s!==null;)e=s.alternate,e!==null&&No(e)===null&&(l=s),s=s.sibling;s=l,s===null?(l=t.child,t.child=null):(l=s.sibling,s.sibling=null),_c(t,!1,l,s,a);break;case"backwards":for(s=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&No(e)===null){t.child=l;break}e=l.sibling,l.sibling=s,s=l,l=e}_c(t,!0,s,null,a);break;case"together":_c(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Is(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),Mr|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(q(153));if(t.child!==null){for(e=t.child,s=rr(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=rr(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function Zy(e,t,s){switch(t.tag){case 3:ap(t),Al();break;case 5:A0(t);break;case 1:fn(t.type)&&po(t);break;case 4:Ru(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;ot(yo,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ot(Nt,Nt.current&1),t.flags|=128,null):s&t.child.childLanes?ip(e,t,s):(ot(Nt,Nt.current&1),e=Is(e,t,s),e!==null?e.sibling:null);ot(Nt,Nt.current&1);break;case 19:if(r=(s&t.childLanes)!==0,e.flags&128){if(r)return op(e,t,s);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),ot(Nt,Nt.current),r)break;return null;case 22:case 23:return t.lanes=0,rp(e,t,s)}return Is(e,t,s)}var cp,_d,dp,up;cp=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};_d=function(){};dp=function(e,t,s,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,jr(hs.current);var a=null;switch(s){case"input":l=ad(e,l),r=ad(e,r),a=[];break;case"select":l=jt({},l,{value:void 0}),r=jt({},r,{value:void 0}),a=[];break;case"textarea":l=cd(e,l),r=cd(e,r),a=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=fo)}ud(s,r);var i;s=null;for(d in l)if(!r.hasOwnProperty(d)&&l.hasOwnProperty(d)&&l[d]!=null)if(d==="style"){var o=l[d];for(i in o)o.hasOwnProperty(i)&&(s||(s={}),s[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ba.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(o=l!=null?l[d]:void 0,r.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(s||(s={}),s[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(s||(s={}),s[i]=c[i])}else s||(a||(a=[]),a.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ba.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ft("scroll",e),a||o===c||(a=[])):(a=a||[]).push(d,c))}s&&(a=a||[]).push("style",s);var d=a;(t.updateQueue=d)&&(t.flags|=4)}};up=function(e,t,s,r){s!==r&&(t.flags|=4)};function xa(e,t){if(!xt)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,r=0;if(t)for(var l=e.child;l!==null;)s|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)s|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=s,t}function ev(e,t,s){var r=t.pendingProps;switch(Tu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(t),null;case 1:return fn(t.type)&&ho(),Xt(t),null;case 3:return r=t.stateNode,Ol(),ht(mn),ht(en),Bu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Pi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Vn!==null&&(Gd(Vn),Vn=null))),_d(e,t),Xt(t),null;case 5:Ou(t);var l=jr(Ya.current);if(s=t.type,e!==null&&t.stateNode!=null)dp(e,t,s,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(q(166));return Xt(t),null}if(e=jr(hs.current),Pi(t)){r=t.stateNode,s=t.type;var a=t.memoizedProps;switch(r[ms]=t,r[Ka]=a,e=(t.mode&1)!==0,s){case"dialog":ft("cancel",r),ft("close",r);break;case"iframe":case"object":case"embed":ft("load",r);break;case"video":case"audio":for(l=0;l<Na.length;l++)ft(Na[l],r);break;case"source":ft("error",r);break;case"img":case"image":case"link":ft("error",r),ft("load",r);break;case"details":ft("toggle",r);break;case"input":qm(r,a),ft("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ft("invalid",r);break;case"textarea":Xm(r,a),ft("invalid",r)}ud(s,a),l=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&Li(r.textContent,o,e),l=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Li(r.textContent,o,e),l=["children",""+o]):Ba.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ft("scroll",r)}switch(s){case"input":Si(r),Qm(r,a,!0);break;case"textarea":Si(r),Zm(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=fo)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Uh(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(s,{is:r.is}):(e=i.createElement(s),s==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,s),e[ms]=t,e[Ka]=r,cp(e,t,!1,!1),t.stateNode=e;e:{switch(i=md(s,r),s){case"dialog":ft("cancel",e),ft("close",e),l=r;break;case"iframe":case"object":case"embed":ft("load",e),l=r;break;case"video":case"audio":for(l=0;l<Na.length;l++)ft(Na[l],e);l=r;break;case"source":ft("error",e),l=r;break;case"img":case"image":case"link":ft("error",e),ft("load",e),l=r;break;case"details":ft("toggle",e),l=r;break;case"input":qm(e,r),l=ad(e,r),ft("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=jt({},r,{value:void 0}),ft("invalid",e);break;case"textarea":Xm(e,r),l=cd(e,r),ft("invalid",e);break;default:l=r}ud(s,l),o=l;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?zh(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Fh(e,c)):a==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&_a(e,c):typeof c=="number"&&_a(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ba.hasOwnProperty(a)?c!=null&&a==="onScroll"&&ft("scroll",e):c!=null&&fu(e,a,c,i))}switch(s){case"input":Si(e),Qm(e,r,!1);break;case"textarea":Si(e),Zm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+lr(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?kl(e,!!r.multiple,a,!1):r.defaultValue!=null&&kl(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=fo)}switch(s){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Xt(t),null;case 6:if(e&&t.stateNode!=null)up(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(q(166));if(s=jr(Ya.current),jr(hs.current),Pi(t)){if(r=t.stateNode,s=t.memoizedProps,r[ms]=t,(a=r.nodeValue!==s)&&(e=Nn,e!==null))switch(e.tag){case 3:Li(r.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Li(r.nodeValue,s,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(s.nodeType===9?s:s.ownerDocument).createTextNode(r),r[ms]=t,t.stateNode=r}return Xt(t),null;case 13:if(ht(Nt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(xt&&bn!==null&&t.mode&1&&!(t.flags&128))I0(),Al(),t.flags|=98560,a=!1;else if(a=Pi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(q(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(q(317));a[ms]=t}else Al(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Xt(t),a=!1}else Vn!==null&&(Gd(Vn),Vn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Nt.current&1?Ut===0&&(Ut=3):Yu())),t.updateQueue!==null&&(t.flags|=4),Xt(t),null);case 4:return Ol(),_d(e,t),e===null&&Va(t.stateNode.containerInfo),Xt(t),null;case 10:return Lu(t.type._context),Xt(t),null;case 17:return fn(t.type)&&ho(),Xt(t),null;case 19:if(ht(Nt),a=t.memoizedState,a===null)return Xt(t),null;if(r=(t.flags&128)!==0,i=a.rendering,i===null)if(r)xa(a,!1);else{if(Ut!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=No(e),i!==null){for(t.flags|=128,xa(a,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=s,s=t.child;s!==null;)a=s,e=r,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return ot(Nt,Nt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Dt()>_l&&(t.flags|=128,r=!0,xa(a,!1),t.lanes=4194304)}else{if(!r)if(e=No(i),e!==null){if(t.flags|=128,r=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),xa(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!xt)return Xt(t),null}else 2*Dt()-a.renderingStartTime>_l&&s!==1073741824&&(t.flags|=128,r=!0,xa(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(s=a.last,s!==null?s.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Dt(),t.sibling=null,s=Nt.current,ot(Nt,r?s&1|2:s&1),t):(Xt(t),null);case 22:case 23:return Ju(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?vn&1073741824&&(Xt(t),t.subtreeFlags&6&&(t.flags|=8192)):Xt(t),null;case 24:return null;case 25:return null}throw Error(q(156,t.tag))}function tv(e,t){switch(Tu(t),t.tag){case 1:return fn(t.type)&&ho(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ol(),ht(mn),ht(en),Bu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ou(t),null;case 13:if(ht(Nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(q(340));Al()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ht(Nt),null;case 4:return Ol(),null;case 10:return Lu(t.type._context),null;case 22:case 23:return Ju(),null;case 24:return null;default:return null}}var Oi=!1,Zt=!1,nv=typeof WeakSet=="function"?WeakSet:Set,fe=null;function jl(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(r){Et(e,t,r)}else s.current=null}function Ud(e,t,s){try{s()}catch(r){Et(e,t,r)}}var Hf=!1;function sv(e,t){if(wd=co,e=x0(),Cu(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var r=s.getSelection&&s.getSelection();if(r&&r.rangeCount!==0){s=r.anchorNode;var l=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var i=0,o=-1,c=-1,d=0,x=0,S=e,y=null;t:for(;;){for(var N;S!==s||l!==0&&S.nodeType!==3||(o=i+l),S!==a||r!==0&&S.nodeType!==3||(c=i+r),S.nodeType===3&&(i+=S.nodeValue.length),(N=S.firstChild)!==null;)y=S,S=N;for(;;){if(S===e)break t;if(y===s&&++d===l&&(o=i),y===a&&++x===r&&(c=i),(N=S.nextSibling)!==null)break;S=y,y=S.parentNode}S=N}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(jd={focusedElem:e,selectionRange:s},co=!1,fe=t;fe!==null;)if(t=fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fe=e;else for(;fe!==null;){t=fe;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var T=w.memoizedProps,P=w.memoizedState,v=t.stateNode,h=v.getSnapshotBeforeUpdate(t.elementType===t.type?T:Hn(t.type,T),P);v.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(C){Et(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,fe=e;break}fe=t.return}return w=Hf,Hf=!1,w}function Ta(e,t,s){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var a=l.destroy;l.destroy=void 0,a!==void 0&&Ud(t,s,a)}l=l.next}while(l!==r)}}function Wo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var r=s.create;s.destroy=r()}s=s.next}while(s!==t)}}function Fd(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function mp(e){var t=e.alternate;t!==null&&(e.alternate=null,mp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ms],delete t[Ka],delete t[Cd],delete t[Uy],delete t[Fy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function fp(e){return e.tag===5||e.tag===3||e.tag===4}function Wf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||fp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $d(e,t,s){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=fo));else if(r!==4&&(e=e.child,e!==null))for($d(e,t,s),e=e.sibling;e!==null;)$d(e,t,s),e=e.sibling}function zd(e,t,s){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(zd(e,t,s),e=e.sibling;e!==null;)zd(e,t,s),e=e.sibling}var Kt=null,Wn=!1;function Bs(e,t,s){for(s=s.child;s!==null;)hp(e,t,s),s=s.sibling}function hp(e,t,s){if(fs&&typeof fs.onCommitFiberUnmount=="function")try{fs.onCommitFiberUnmount(Oo,s)}catch{}switch(s.tag){case 5:Zt||jl(s,t);case 6:var r=Kt,l=Wn;Kt=null,Bs(e,t,s),Kt=r,Wn=l,Kt!==null&&(Wn?(e=Kt,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Kt.removeChild(s.stateNode));break;case 18:Kt!==null&&(Wn?(e=Kt,s=s.stateNode,e.nodeType===8?Mc(e.parentNode,s):e.nodeType===1&&Mc(e,s),za(e)):Mc(Kt,s.stateNode));break;case 4:r=Kt,l=Wn,Kt=s.stateNode.containerInfo,Wn=!0,Bs(e,t,s),Kt=r,Wn=l;break;case 0:case 11:case 14:case 15:if(!Zt&&(r=s.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var a=l,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Ud(s,t,i),l=l.next}while(l!==r)}Bs(e,t,s);break;case 1:if(!Zt&&(jl(s,t),r=s.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=s.memoizedProps,r.state=s.memoizedState,r.componentWillUnmount()}catch(o){Et(s,t,o)}Bs(e,t,s);break;case 21:Bs(e,t,s);break;case 22:s.mode&1?(Zt=(r=Zt)||s.memoizedState!==null,Bs(e,t,s),Zt=r):Bs(e,t,s);break;default:Bs(e,t,s)}}function Vf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new nv),t.forEach(function(r){var l=mv.bind(null,e,r);s.has(r)||(s.add(r),r.then(l,l))})}}function zn(e,t){var s=t.deletions;if(s!==null)for(var r=0;r<s.length;r++){var l=s[r];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Kt=o.stateNode,Wn=!1;break e;case 3:Kt=o.stateNode.containerInfo,Wn=!0;break e;case 4:Kt=o.stateNode.containerInfo,Wn=!0;break e}o=o.return}if(Kt===null)throw Error(q(160));hp(a,i,l),Kt=null,Wn=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(d){Et(l,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)pp(t,e),t=t.sibling}function pp(e,t){var s=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(zn(t,e),cs(e),r&4){try{Ta(3,e,e.return),Wo(3,e)}catch(T){Et(e,e.return,T)}try{Ta(5,e,e.return)}catch(T){Et(e,e.return,T)}}break;case 1:zn(t,e),cs(e),r&512&&s!==null&&jl(s,s.return);break;case 5:if(zn(t,e),cs(e),r&512&&s!==null&&jl(s,s.return),e.flags&32){var l=e.stateNode;try{_a(l,"")}catch(T){Et(e,e.return,T)}}if(r&4&&(l=e.stateNode,l!=null)){var a=e.memoizedProps,i=s!==null?s.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Bh(l,a),md(o,i);var d=md(o,a);for(i=0;i<c.length;i+=2){var x=c[i],S=c[i+1];x==="style"?zh(l,S):x==="dangerouslySetInnerHTML"?Fh(l,S):x==="children"?_a(l,S):fu(l,x,S,d)}switch(o){case"input":id(l,a);break;case"textarea":_h(l,a);break;case"select":var y=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!a.multiple;var N=a.value;N!=null?kl(l,!!a.multiple,N,!1):y!==!!a.multiple&&(a.defaultValue!=null?kl(l,!!a.multiple,a.defaultValue,!0):kl(l,!!a.multiple,a.multiple?[]:"",!1))}l[Ka]=a}catch(T){Et(e,e.return,T)}}break;case 6:if(zn(t,e),cs(e),r&4){if(e.stateNode===null)throw Error(q(162));l=e.stateNode,a=e.memoizedProps;try{l.nodeValue=a}catch(T){Et(e,e.return,T)}}break;case 3:if(zn(t,e),cs(e),r&4&&s!==null&&s.memoizedState.isDehydrated)try{za(t.containerInfo)}catch(T){Et(e,e.return,T)}break;case 4:zn(t,e),cs(e);break;case 13:zn(t,e),cs(e),l=e.child,l.flags&8192&&(a=l.memoizedState!==null,l.stateNode.isHidden=a,!a||l.alternate!==null&&l.alternate.memoizedState!==null||(Gu=Dt())),r&4&&Vf(e);break;case 22:if(x=s!==null&&s.memoizedState!==null,e.mode&1?(Zt=(d=Zt)||x,zn(t,e),Zt=d):zn(t,e),cs(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!x&&e.mode&1)for(fe=e,x=e.child;x!==null;){for(S=fe=x;fe!==null;){switch(y=fe,N=y.child,y.tag){case 0:case 11:case 14:case 15:Ta(4,y,y.return);break;case 1:jl(y,y.return);var w=y.stateNode;if(typeof w.componentWillUnmount=="function"){r=y,s=y.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(T){Et(r,s,T)}}break;case 5:jl(y,y.return);break;case 22:if(y.memoizedState!==null){Kf(S);continue}}N!==null?(N.return=y,fe=N):Kf(S)}x=x.sibling}e:for(x=null,S=e;;){if(S.tag===5){if(x===null){x=S;try{l=S.stateNode,d?(a=l.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=S.stateNode,c=S.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=$h("display",i))}catch(T){Et(e,e.return,T)}}}else if(S.tag===6){if(x===null)try{S.stateNode.nodeValue=d?"":S.memoizedProps}catch(T){Et(e,e.return,T)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break e;for(;S.sibling===null;){if(S.return===null||S.return===e)break e;x===S&&(x=null),S=S.return}x===S&&(x=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:zn(t,e),cs(e),r&4&&Vf(e);break;case 21:break;default:zn(t,e),cs(e)}}function cs(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(fp(s)){var r=s;break e}s=s.return}throw Error(q(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(_a(l,""),r.flags&=-33);var a=Wf(e);zd(e,a,l);break;case 3:case 4:var i=r.stateNode.containerInfo,o=Wf(e);$d(e,o,i);break;default:throw Error(q(161))}}catch(c){Et(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function rv(e,t,s){fe=e,xp(e)}function xp(e,t,s){for(var r=(e.mode&1)!==0;fe!==null;){var l=fe,a=l.child;if(l.tag===22&&r){var i=l.memoizedState!==null||Oi;if(!i){var o=l.alternate,c=o!==null&&o.memoizedState!==null||Zt;o=Oi;var d=Zt;if(Oi=i,(Zt=c)&&!d)for(fe=l;fe!==null;)i=fe,c=i.child,i.tag===22&&i.memoizedState!==null?Jf(l):c!==null?(c.return=i,fe=c):Jf(l);for(;a!==null;)fe=a,xp(a),a=a.sibling;fe=l,Oi=o,Zt=d}Gf(e)}else l.subtreeFlags&8772&&a!==null?(a.return=l,fe=a):Gf(e)}}function Gf(e){for(;fe!==null;){var t=fe;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Zt||Wo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Zt)if(s===null)r.componentDidMount();else{var l=t.elementType===t.type?s.memoizedProps:Hn(t.type,s.memoizedProps);r.componentDidUpdate(l,s.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Df(t,a,r);break;case 3:var i=t.updateQueue;if(i!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Df(t,i,s)}break;case 5:var o=t.stateNode;if(s===null&&t.flags&4){s=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var x=d.memoizedState;if(x!==null){var S=x.dehydrated;S!==null&&za(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}Zt||t.flags&512&&Fd(t)}catch(y){Et(t,t.return,y)}}if(t===e){fe=null;break}if(s=t.sibling,s!==null){s.return=t.return,fe=s;break}fe=t.return}}function Kf(e){for(;fe!==null;){var t=fe;if(t===e){fe=null;break}var s=t.sibling;if(s!==null){s.return=t.return,fe=s;break}fe=t.return}}function Jf(e){for(;fe!==null;){var t=fe;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{Wo(4,t)}catch(c){Et(t,s,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(c){Et(t,l,c)}}var a=t.return;try{Fd(t)}catch(c){Et(t,a,c)}break;case 5:var i=t.return;try{Fd(t)}catch(c){Et(t,i,c)}}}catch(c){Et(t,t.return,c)}if(t===e){fe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,fe=o;break}fe=t.return}}var lv=Math.ceil,So=Ds.ReactCurrentDispatcher,Wu=Ds.ReactCurrentOwner,An=Ds.ReactCurrentBatchConfig,Ye=0,Ht=null,Ot=null,Jt=0,vn=0,Sl=or(0),Ut=0,Za=null,Mr=0,Vo=0,Vu=0,Ia=null,dn=null,Gu=0,_l=1/0,Ns=null,ko=!1,Hd=null,nr=null,Bi=!1,Ks=null,Co=0,Da=0,Wd=null,Xi=-1,Zi=0;function rn(){return Ye&6?Dt():Xi!==-1?Xi:Xi=Dt()}function sr(e){return e.mode&1?Ye&2&&Jt!==0?Jt&-Jt:zy.transition!==null?(Zi===0&&(Zi=e0()),Zi):(e=tt,e!==0||(e=window.event,e=e===void 0?16:i0(e.type)),e):1}function Kn(e,t,s,r){if(50<Da)throw Da=0,Wd=null,Error(q(185));ri(e,s,r),(!(Ye&2)||e!==Ht)&&(e===Ht&&(!(Ye&2)&&(Vo|=s),Ut===4&&zs(e,Jt)),hn(e,r),s===1&&Ye===0&&!(t.mode&1)&&(_l=Dt()+500,$o&&cr()))}function hn(e,t){var s=e.callbackNode;zg(e,t);var r=oo(e,e===Ht?Jt:0);if(r===0)s!==null&&nf(s),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(s!=null&&nf(s),t===1)e.tag===0?$y(Yf.bind(null,e)):C0(Yf.bind(null,e)),By(function(){!(Ye&6)&&cr()}),s=null;else{switch(t0(r)){case 1:s=yu;break;case 4:s=Xh;break;case 16:s=io;break;case 536870912:s=Zh;break;default:s=io}s=Sp(s,gp.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function gp(e,t){if(Xi=-1,Zi=0,Ye&6)throw Error(q(327));var s=e.callbackNode;if(Dl()&&e.callbackNode!==s)return null;var r=oo(e,e===Ht?Jt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Eo(e,r);else{t=r;var l=Ye;Ye|=2;var a=vp();(Ht!==e||Jt!==t)&&(Ns=null,_l=Dt()+500,Cr(e,t));do try{ov();break}catch(o){yp(e,o)}while(!0);Mu(),So.current=a,Ye=l,Ot!==null?t=0:(Ht=null,Jt=0,t=Ut)}if(t!==0){if(t===2&&(l=gd(e),l!==0&&(r=l,t=Vd(e,l))),t===1)throw s=Za,Cr(e,0),zs(e,r),hn(e,Dt()),s;if(t===6)zs(e,r);else{if(l=e.current.alternate,!(r&30)&&!av(l)&&(t=Eo(e,r),t===2&&(a=gd(e),a!==0&&(r=a,t=Vd(e,a))),t===1))throw s=Za,Cr(e,0),zs(e,r),hn(e,Dt()),s;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(q(345));case 2:vr(e,dn,Ns);break;case 3:if(zs(e,r),(r&130023424)===r&&(t=Gu+500-Dt(),10<t)){if(oo(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){rn(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=kd(vr.bind(null,e,dn,Ns),t);break}vr(e,dn,Ns);break;case 4:if(zs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var i=31-Gn(r);a=1<<i,i=t[i],i>l&&(l=i),r&=~a}if(r=l,r=Dt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lv(r/1960))-r,10<r){e.timeoutHandle=kd(vr.bind(null,e,dn,Ns),r);break}vr(e,dn,Ns);break;case 5:vr(e,dn,Ns);break;default:throw Error(q(329))}}}return hn(e,Dt()),e.callbackNode===s?gp.bind(null,e):null}function Vd(e,t){var s=Ia;return e.current.memoizedState.isDehydrated&&(Cr(e,t).flags|=256),e=Eo(e,t),e!==2&&(t=dn,dn=s,t!==null&&Gd(t)),e}function Gd(e){dn===null?dn=e:dn.push.apply(dn,e)}function av(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var r=0;r<s.length;r++){var l=s[r],a=l.getSnapshot;l=l.value;try{if(!Jn(a(),l))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zs(e,t){for(t&=~Vu,t&=~Vo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Gn(t),r=1<<s;e[s]=-1,t&=~r}}function Yf(e){if(Ye&6)throw Error(q(327));Dl();var t=oo(e,0);if(!(t&1))return hn(e,Dt()),null;var s=Eo(e,t);if(e.tag!==0&&s===2){var r=gd(e);r!==0&&(t=r,s=Vd(e,r))}if(s===1)throw s=Za,Cr(e,0),zs(e,t),hn(e,Dt()),s;if(s===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vr(e,dn,Ns),hn(e,Dt()),null}function Ku(e,t){var s=Ye;Ye|=1;try{return e(t)}finally{Ye=s,Ye===0&&(_l=Dt()+500,$o&&cr())}}function Lr(e){Ks!==null&&Ks.tag===0&&!(Ye&6)&&Dl();var t=Ye;Ye|=1;var s=An.transition,r=tt;try{if(An.transition=null,tt=1,e)return e()}finally{tt=r,An.transition=s,Ye=t,!(Ye&6)&&cr()}}function Ju(){vn=Sl.current,ht(Sl)}function Cr(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Oy(s)),Ot!==null)for(s=Ot.return;s!==null;){var r=s;switch(Tu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ho();break;case 3:Ol(),ht(mn),ht(en),Bu();break;case 5:Ou(r);break;case 4:Ol();break;case 13:ht(Nt);break;case 19:ht(Nt);break;case 10:Lu(r.type._context);break;case 22:case 23:Ju()}s=s.return}if(Ht=e,Ot=e=rr(e.current,null),Jt=vn=t,Ut=0,Za=null,Vu=Vo=Mr=0,dn=Ia=null,wr!==null){for(t=0;t<wr.length;t++)if(s=wr[t],r=s.interleaved,r!==null){s.interleaved=null;var l=r.next,a=s.pending;if(a!==null){var i=a.next;a.next=l,r.next=i}s.pending=r}wr=null}return e}function yp(e,t){do{var s=Ot;try{if(Mu(),Yi.current=jo,wo){for(var r=wt.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}wo=!1}if(Dr=0,zt=_t=wt=null,Ea=!1,qa=0,Wu.current=null,s===null||s.return===null){Ut=1,Za=t,Ot=null;break}e:{var a=e,i=s.return,o=s,c=t;if(t=Jt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,x=o,S=x.tag;if(!(x.mode&1)&&(S===0||S===11||S===15)){var y=x.alternate;y?(x.updateQueue=y.updateQueue,x.memoizedState=y.memoizedState,x.lanes=y.lanes):(x.updateQueue=null,x.memoizedState=null)}var N=Of(i);if(N!==null){N.flags&=-257,Bf(N,i,o,a,t),N.mode&1&&Rf(a,d,t),t=N,c=d;var w=t.updateQueue;if(w===null){var T=new Set;T.add(c),t.updateQueue=T}else w.add(c);break e}else{if(!(t&1)){Rf(a,d,t),Yu();break e}c=Error(q(426))}}else if(xt&&o.mode&1){var P=Of(i);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Bf(P,i,o,a,t),Iu(Bl(c,o));break e}}a=c=Bl(c,o),Ut!==4&&(Ut=2),Ia===null?Ia=[a]:Ia.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var v=tp(a,c,t);If(a,v);break e;case 1:o=c;var h=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof h.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(nr===null||!nr.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var C=np(a,o,t);If(a,C);break e}}a=a.return}while(a!==null)}Np(s)}catch(j){t=j,Ot===s&&s!==null&&(Ot=s=s.return);continue}break}while(!0)}function vp(){var e=So.current;return So.current=jo,e===null?jo:e}function Yu(){(Ut===0||Ut===3||Ut===2)&&(Ut=4),Ht===null||!(Mr&268435455)&&!(Vo&268435455)||zs(Ht,Jt)}function Eo(e,t){var s=Ye;Ye|=2;var r=vp();(Ht!==e||Jt!==t)&&(Ns=null,Cr(e,t));do try{iv();break}catch(l){yp(e,l)}while(!0);if(Mu(),Ye=s,So.current=r,Ot!==null)throw Error(q(261));return Ht=null,Jt=0,Ut}function iv(){for(;Ot!==null;)bp(Ot)}function ov(){for(;Ot!==null&&!Pg();)bp(Ot)}function bp(e){var t=jp(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?Np(e):Ot=t,Wu.current=null}function Np(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=tv(s,t),s!==null){s.flags&=32767,Ot=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ut=6,Ot=null;return}}else if(s=ev(s,t,vn),s!==null){Ot=s;return}if(t=t.sibling,t!==null){Ot=t;return}Ot=t=e}while(t!==null);Ut===0&&(Ut=5)}function vr(e,t,s){var r=tt,l=An.transition;try{An.transition=null,tt=1,cv(e,t,s,r)}finally{An.transition=l,tt=r}return null}function cv(e,t,s,r){do Dl();while(Ks!==null);if(Ye&6)throw Error(q(327));s=e.finishedWork;var l=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(Hg(e,a),e===Ht&&(Ot=Ht=null,Jt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Bi||(Bi=!0,Sp(io,function(){return Dl(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=An.transition,An.transition=null;var i=tt;tt=1;var o=Ye;Ye|=4,Wu.current=null,sv(e,s),pp(s,e),Iy(jd),co=!!wd,jd=wd=null,e.current=s,rv(s),Ag(),Ye=o,tt=i,An.transition=a}else e.current=s;if(Bi&&(Bi=!1,Ks=e,Co=l),a=e.pendingLanes,a===0&&(nr=null),Bg(s.stateNode),hn(e,Dt()),t!==null)for(r=e.onRecoverableError,s=0;s<t.length;s++)l=t[s],r(l.value,{componentStack:l.stack,digest:l.digest});if(ko)throw ko=!1,e=Hd,Hd=null,e;return Co&1&&e.tag!==0&&Dl(),a=e.pendingLanes,a&1?e===Wd?Da++:(Da=0,Wd=e):Da=0,cr(),null}function Dl(){if(Ks!==null){var e=t0(Co),t=An.transition,s=tt;try{if(An.transition=null,tt=16>e?16:e,Ks===null)var r=!1;else{if(e=Ks,Ks=null,Co=0,Ye&6)throw Error(q(331));var l=Ye;for(Ye|=4,fe=e.current;fe!==null;){var a=fe,i=a.child;if(fe.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(fe=d;fe!==null;){var x=fe;switch(x.tag){case 0:case 11:case 15:Ta(8,x,a)}var S=x.child;if(S!==null)S.return=x,fe=S;else for(;fe!==null;){x=fe;var y=x.sibling,N=x.return;if(mp(x),x===d){fe=null;break}if(y!==null){y.return=N,fe=y;break}fe=N}}}var w=a.alternate;if(w!==null){var T=w.child;if(T!==null){w.child=null;do{var P=T.sibling;T.sibling=null,T=P}while(T!==null)}}fe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,fe=i;else e:for(;fe!==null;){if(a=fe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ta(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,fe=v;break e}fe=a.return}}var h=e.current;for(fe=h;fe!==null;){i=fe;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,fe=b;else e:for(i=h;fe!==null;){if(o=fe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Wo(9,o)}}catch(j){Et(o,o.return,j)}if(o===i){fe=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,fe=C;break e}fe=o.return}}if(Ye=l,cr(),fs&&typeof fs.onPostCommitFiberRoot=="function")try{fs.onPostCommitFiberRoot(Oo,e)}catch{}r=!0}return r}finally{tt=s,An.transition=t}}return!1}function qf(e,t,s){t=Bl(s,t),t=tp(e,t,1),e=tr(e,t,1),t=rn(),e!==null&&(ri(e,1,t),hn(e,t))}function Et(e,t,s){if(e.tag===3)qf(e,e,s);else for(;t!==null;){if(t.tag===3){qf(t,e,s);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nr===null||!nr.has(r))){e=Bl(s,e),e=np(t,e,1),t=tr(t,e,1),e=rn(),t!==null&&(ri(t,1,e),hn(t,e));break}}t=t.return}}function dv(e,t,s){var r=e.pingCache;r!==null&&r.delete(t),t=rn(),e.pingedLanes|=e.suspendedLanes&s,Ht===e&&(Jt&s)===s&&(Ut===4||Ut===3&&(Jt&130023424)===Jt&&500>Dt()-Gu?Cr(e,0):Vu|=s),hn(e,t)}function wp(e,t){t===0&&(e.mode&1?(t=Ei,Ei<<=1,!(Ei&130023424)&&(Ei=4194304)):t=1);var s=rn();e=Ts(e,t),e!==null&&(ri(e,t,s),hn(e,s))}function uv(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),wp(e,s)}function mv(e,t){var s=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(s=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(t),wp(e,s)}var jp;jp=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||mn.current)un=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return un=!1,Zy(e,t,s);un=!!(e.flags&131072)}else un=!1,xt&&t.flags&1048576&&E0(t,go,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Qi(e,t),e=t.pendingProps;var l=Pl(t,en.current);Il(t,s),l=Uu(null,t,r,e,l,s);var a=Fu();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fn(r)?(a=!0,po(t)):a=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Au(t),l.updater=Ho,t.stateNode=l,l._reactInternals=t,Ld(t,r,e,s),t=Rd(null,t,r,!0,a,s)):(t.tag=0,xt&&a&&Eu(t),sn(null,t,l,s),t=t.child),t;case 16:r=t.elementType;e:{switch(Qi(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=hv(r),e=Hn(r,e),l){case 0:t=Ad(null,t,r,e,s);break e;case 1:t=Ff(null,t,r,e,s);break e;case 11:t=_f(null,t,r,e,s);break e;case 14:t=Uf(null,t,r,Hn(r.type,e),s);break e}throw Error(q(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Hn(r,l),Ad(e,t,r,l,s);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Hn(r,l),Ff(e,t,r,l,s);case 3:e:{if(ap(t),e===null)throw Error(q(387));r=t.pendingProps,a=t.memoizedState,l=a.element,P0(e,t),bo(t,r,null,s);var i=t.memoizedState;if(r=i.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){l=Bl(Error(q(423)),t),t=$f(e,t,r,s,l);break e}else if(r!==l){l=Bl(Error(q(424)),t),t=$f(e,t,r,s,l);break e}else for(bn=er(t.stateNode.containerInfo.firstChild),Nn=t,xt=!0,Vn=null,s=M0(t,null,r,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Al(),r===l){t=Is(e,t,s);break e}sn(e,t,r,s)}t=t.child}return t;case 5:return A0(t),e===null&&Id(t),r=t.type,l=t.pendingProps,a=e!==null?e.memoizedProps:null,i=l.children,Sd(r,l)?i=null:a!==null&&Sd(r,a)&&(t.flags|=32),lp(e,t),sn(e,t,i,s),t.child;case 6:return e===null&&Id(t),null;case 13:return ip(e,t,s);case 4:return Ru(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Rl(t,null,r,s):sn(e,t,r,s),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Hn(r,l),_f(e,t,r,l,s);case 7:return sn(e,t,t.pendingProps,s),t.child;case 8:return sn(e,t,t.pendingProps.children,s),t.child;case 12:return sn(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,a=t.memoizedProps,i=l.value,ot(yo,r._currentValue),r._currentValue=i,a!==null)if(Jn(a.value,i)){if(a.children===l.children&&!mn.current){t=Is(e,t,s);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=ks(-1,s&-s),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var x=d.pending;x===null?c.next=c:(c.next=x.next,x.next=c),d.pending=c}}a.lanes|=s,c=a.alternate,c!==null&&(c.lanes|=s),Dd(a.return,s,t),o.lanes|=s;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(q(341));i.lanes|=s,o=i.alternate,o!==null&&(o.lanes|=s),Dd(i,s,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}sn(e,t,l.children,s),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,Il(t,s),l=Rn(l),r=r(l),t.flags|=1,sn(e,t,r,s),t.child;case 14:return r=t.type,l=Hn(r,t.pendingProps),l=Hn(r.type,l),Uf(e,t,r,l,s);case 15:return sp(e,t,t.type,t.pendingProps,s);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Hn(r,l),Qi(e,t),t.tag=1,fn(r)?(e=!0,po(t)):e=!1,Il(t,s),ep(t,r,l),Ld(t,r,l,s),Rd(null,t,r,!0,e,s);case 19:return op(e,t,s);case 22:return rp(e,t,s)}throw Error(q(156,t.tag))};function Sp(e,t){return Qh(e,t)}function fv(e,t,s,r){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(e,t,s,r){return new fv(e,t,s,r)}function qu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function hv(e){if(typeof e=="function")return qu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===pu)return 11;if(e===xu)return 14}return 2}function rr(e,t){var s=e.alternate;return s===null?(s=Pn(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function eo(e,t,s,r,l,a){var i=2;if(r=e,typeof e=="function")qu(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case hl:return Er(s.children,l,a,t);case hu:i=8,l|=8;break;case nd:return e=Pn(12,s,t,l|2),e.elementType=nd,e.lanes=a,e;case sd:return e=Pn(13,s,t,l),e.elementType=sd,e.lanes=a,e;case rd:return e=Pn(19,s,t,l),e.elementType=rd,e.lanes=a,e;case Ah:return Go(s,l,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Lh:i=10;break e;case Ph:i=9;break e;case pu:i=11;break e;case xu:i=14;break e;case Us:i=16,r=null;break e}throw Error(q(130,e==null?e:typeof e,""))}return t=Pn(i,s,t,l),t.elementType=e,t.type=r,t.lanes=a,t}function Er(e,t,s,r){return e=Pn(7,e,r,t),e.lanes=s,e}function Go(e,t,s,r){return e=Pn(22,e,r,t),e.elementType=Ah,e.lanes=s,e.stateNode={isHidden:!1},e}function Uc(e,t,s){return e=Pn(6,e,null,t),e.lanes=s,e}function Fc(e,t,s){return t=Pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function pv(e,t,s,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bc(0),this.expirationTimes=bc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bc(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Qu(e,t,s,r,l,a,i,o,c){return e=new pv(e,t,s,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Pn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Au(a),e}function xv(e,t,s){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fl,key:r==null?null:""+r,children:e,containerInfo:t,implementation:s}}function kp(e){if(!e)return ar;e=e._reactInternals;e:{if(Ar(e)!==e||e.tag!==1)throw Error(q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(fn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(q(171))}if(e.tag===1){var s=e.type;if(fn(s))return k0(e,s,t)}return t}function Cp(e,t,s,r,l,a,i,o,c){return e=Qu(s,r,!0,e,l,a,i,o,c),e.context=kp(null),s=e.current,r=rn(),l=sr(s),a=ks(r,l),a.callback=t??null,tr(s,a,l),e.current.lanes=l,ri(e,l,r),hn(e,r),e}function Ko(e,t,s,r){var l=t.current,a=rn(),i=sr(l);return s=kp(s),t.context===null?t.context=s:t.pendingContext=s,t=ks(a,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=tr(l,t,i),e!==null&&(Kn(e,l,i,a),Ji(e,l,i)),i}function To(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Qf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Xu(e,t){Qf(e,t),(e=e.alternate)&&Qf(e,t)}function gv(){return null}var Ep=typeof reportError=="function"?reportError:function(e){console.error(e)};function Zu(e){this._internalRoot=e}Jo.prototype.render=Zu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(q(409));Ko(e,t,null,null)};Jo.prototype.unmount=Zu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Lr(function(){Ko(null,e,null,null)}),t[Es]=null}};function Jo(e){this._internalRoot=e}Jo.prototype.unstable_scheduleHydration=function(e){if(e){var t=r0();e={blockedOn:null,target:e,priority:t};for(var s=0;s<$s.length&&t!==0&&t<$s[s].priority;s++);$s.splice(s,0,e),s===0&&a0(e)}};function em(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Yo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Xf(){}function yv(e,t,s,r,l){if(l){if(typeof r=="function"){var a=r;r=function(){var d=To(i);a.call(d)}}var i=Cp(t,r,e,0,null,!1,!1,"",Xf);return e._reactRootContainer=i,e[Es]=i.current,Va(e.nodeType===8?e.parentNode:e),Lr(),i}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var o=r;r=function(){var d=To(c);o.call(d)}}var c=Qu(e,0,!1,null,null,!1,!1,"",Xf);return e._reactRootContainer=c,e[Es]=c.current,Va(e.nodeType===8?e.parentNode:e),Lr(function(){Ko(t,c,s,r)}),c}function qo(e,t,s,r,l){var a=s._reactRootContainer;if(a){var i=a;if(typeof l=="function"){var o=l;l=function(){var c=To(i);o.call(c)}}Ko(t,i,e,l)}else i=yv(s,t,e,l,r);return To(i)}n0=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ba(t.pendingLanes);s!==0&&(vu(t,s|1),hn(t,Dt()),!(Ye&6)&&(_l=Dt()+500,cr()))}break;case 13:Lr(function(){var r=Ts(e,1);if(r!==null){var l=rn();Kn(r,e,1,l)}}),Xu(e,1)}};bu=function(e){if(e.tag===13){var t=Ts(e,134217728);if(t!==null){var s=rn();Kn(t,e,134217728,s)}Xu(e,134217728)}};s0=function(e){if(e.tag===13){var t=sr(e),s=Ts(e,t);if(s!==null){var r=rn();Kn(s,e,t,r)}Xu(e,t)}};r0=function(){return tt};l0=function(e,t){var s=tt;try{return tt=e,t()}finally{tt=s}};hd=function(e,t,s){switch(t){case"input":if(id(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var r=s[t];if(r!==e&&r.form===e.form){var l=Fo(r);if(!l)throw Error(q(90));Oh(r),id(r,l)}}}break;case"textarea":_h(e,s);break;case"select":t=s.value,t!=null&&kl(e,!!s.multiple,t,!1)}};Vh=Ku;Gh=Lr;var vv={usingClientEntryPoint:!1,Events:[ai,yl,Fo,Hh,Wh,Ku]},ga={findFiberByHostInstance:Nr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bv={bundleType:ga.bundleType,version:ga.version,rendererPackageName:ga.rendererPackageName,rendererConfig:ga.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ds.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Yh(e),e===null?null:e.stateNode},findFiberByHostInstance:ga.findFiberByHostInstance||gv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_i.isDisabled&&_i.supportsFiber)try{Oo=_i.inject(bv),fs=_i}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vv;jn.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!em(t))throw Error(q(200));return xv(e,t,null,s)};jn.createRoot=function(e,t){if(!em(e))throw Error(q(299));var s=!1,r="",l=Ep;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Qu(e,1,!1,null,null,s,!1,r,l),e[Es]=t.current,Va(e.nodeType===8?e.parentNode:e),new Zu(t)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=Yh(t),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return Lr(e)};jn.hydrate=function(e,t,s){if(!Yo(t))throw Error(q(200));return qo(null,e,t,!0,s)};jn.hydrateRoot=function(e,t,s){if(!em(e))throw Error(q(405));var r=s!=null&&s.hydratedSources||null,l=!1,a="",i=Ep;if(s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),t=Cp(t,null,e,1,s??null,l,!1,a,i),e[Es]=t.current,Va(e),r)for(e=0;e<r.length;e++)s=r[e],l=s._getVersion,l=l(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,l]:t.mutableSourceEagerHydrationData.push(s,l);return new Jo(t)};jn.render=function(e,t,s){if(!Yo(t))throw Error(q(200));return qo(null,e,t,!1,s)};jn.unmountComponentAtNode=function(e){if(!Yo(e))throw Error(q(40));return e._reactRootContainer?(Lr(function(){qo(null,null,e,!1,function(){e._reactRootContainer=null,e[Es]=null})}),!0):!1};jn.unstable_batchedUpdates=Ku;jn.unstable_renderSubtreeIntoContainer=function(e,t,s,r){if(!Yo(s))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return qo(e,t,s,!1,r)};jn.version="18.3.1-next-f1338f8080-20240426";function Tp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Tp)}catch(e){console.error(e)}}Tp(),Th.exports=jn;var Ip=Th.exports,Zf=Ip;ed.createRoot=Zf.createRoot,ed.hydrateRoot=Zf.hydrateRoot;/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Dp=(...e)=>e.filter((t,s,r)=>!!t&&r.indexOf(t)===s).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:l="",children:a,iconNode:i,...o},c)=>m.createElement("svg",{ref:c,...wv,width:t,height:t,stroke:e,strokeWidth:r?Number(s)*24/Number(t):s,className:Dp("lucide",l),...o},[...i.map(([d,x])=>m.createElement(d,x)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=(e,t)=>{const s=m.forwardRef(({className:r,...l},a)=>m.createElement(jv,{ref:a,iconNode:t,className:Dp(`lucide-${Nv(e)}`,r),...l}));return s.displayName=`${e}`,s};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=Wt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Wt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=Wt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lp=Wt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Wt("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=Wt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=Wt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=Wt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=Wt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=Wt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=Wt("PoundSterling",[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=Wt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Wt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=Wt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Wt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Wt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=Wt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=Wt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),Pp=e=>`ndn_online_quota_${e}`;function no(e=new Date){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),s=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-s);const r=new Date(Date.UTC(t.getUTCFullYear(),0,1)),l=Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7),a=String(l).padStart(2,"0");return`${t.getUTCFullYear()}-${a}`}function Ap(e){try{const t=localStorage.getItem(Pp(e));if(!t)return{week:no(),used:0};const s=JSON.parse(t),r=no();return!s.week||s.week!==r?{week:r,used:0}:{week:String(s.week),used:Number(s.used)||0}}catch{return{week:no(),used:0}}}function Rv(e,t){try{localStorage.setItem(Pp(e),JSON.stringify(t))}catch{}}function th(e,t=3){const s=no(),r=Ap(e),l={week:s,used:(r.week===s?r.used:0)+1};return Rv(e,l),l}function Rp(e,t=3){const s=Ap(e);return Math.max(0,t-(s.used||0))}const Op="ndn:isAdmin:v1";function Bp(){try{const e=localStorage.getItem(Op);return e?JSON.parse(e):{}}catch{return{}}}function Ov(e,t){try{const s=Bp();s[(e||"").toLowerCase()]={v:t,ts:Date.now()},localStorage.setItem(Op,JSON.stringify(s))}catch{}}async function Bv(e){var l,a;const t=String(e||"").toLowerCase();if(!t)return!1;try{const i=String(((a=(l=import.meta)==null?void 0:l.env)==null?void 0:a.VITE_OWNER_EMAIL)||"").toLowerCase();if(i&&t===i)return!0}catch{}if(t==="daviesfamily108@gmail.com")return!0;try{const i=localStorage.getItem("ndn:forceAdmin");if(i==="1"||i==="true")return!0}catch{}const r=Bp()[t];if(r&&Date.now()-r.ts<5*60*1e3)return!!r.v;try{const o=await(await fetch(`/api/admins/check?email=${encodeURIComponent(t)}`)).json().catch(()=>({})),c=!!(o!=null&&o.isAdmin);return Ov(t,c),c}catch{return!!(r!=null&&r.v)}}function _p(e){const t=String(e||"").toLowerCase(),[s,r]=m.useState(!1);return m.useEffect(()=>{var a,i;let l=!0;if(!t){r(!1);return}try{const o=String(((i=(a=import.meta)==null?void 0:a.env)==null?void 0:i.VITE_OWNER_EMAIL)||"").toLowerCase(),c=(()=>{try{const d=localStorage.getItem("ndn:forceAdmin");return d==="1"||d==="true"}catch{return!1}})();if(o&&t===o){r(!0);return}if(c){r(!0);return}}catch{}if(t==="daviesfamily108@gmail.com"){r(!0);return}return Bv(t).then(o=>{l&&r(!!o)}),()=>{l=!1}},[t]),s}const $c={},_v=5,Uv={GBP:1,EUR:1.16,USD:1.26,AUD:1.92,NZD:2.08,CAD:1.73};function Up(e,t=_v){const s=(e||"GBP").toUpperCase(),r=Uv[s]??1,l=t*r;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:s}).format(l)}catch{return`${s} ${l.toFixed(2)}`}}function Fp(){try{const e=new Intl.NumberFormat().resolvedOptions(),t=String(e.locale).toLowerCase();return t.includes("-gb")?"GBP":t.includes("-ie")||t.includes("-de")||t.includes("-fr")||t.includes("-es")||t.includes("-it")||t.includes("-nl")?"EUR":t.includes("-us")?"USD":t.includes("-au")?"AUD":t.includes("-nz")?"NZD":t.includes("-ca")?"CAD":"GBP"}catch{return"GBP"}}const Fv=($c==null?void 0:$c.VITE_DISCORD_INVITE_URL)||"https://discord.gg/bx4KEF8U";function $v(e){const t=[{key:"score",label:"Home",icon:Ev},{key:"online",label:"Online",icon:Jd},{key:"offline",label:"Offline",icon:to},{key:"tournaments",label:"Tournaments",icon:to},{key:"friends",label:"Friends",icon:Jd},{key:"stats",label:"Stats",icon:to},{key:"calibrate",label:"Calibrate",icon:Mp},{key:"settings",label:"Settings",icon:tm}];return e!=null&&e.fullAccess||t.push({key:"fullaccess",label:"PREMIUM $",icon:Mv}),t}function $p({active:e,onChange:t,user:s,className:r}){const l=$v(s),a=_p(s==null?void 0:s.email);if(a&&!l.some(d=>d.key==="admin")){const d=l.findIndex(S=>S.key==="settings"),x={key:"admin",label:"Admin",icon:tm};d>=0?l.splice(d,0,x):l.push(x)}const[i,o]=m.useState(!1),c=s!=null&&s.username&&!(s!=null&&s.fullAccess)?Rp(s.username):1/0;return m.useEffect(()=>{if(!i)return;const d=x=>{(x.key==="Escape"||x.key==="Enter")&&o(!1)};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[i]),n.jsxs("aside",{className:`${s!=null&&s.fullAccess?"premium-sidebar":""} sidebar glass ${r?"":"w-60"} p-2 sm:p-4 rounded-2xl ${r??"hidden sm:flex"} flex-col gap-2 overflow-y-auto overflow-x-hidden ${r?"":"fixed top-2 bottom-2 sm:top-4 sm:bottom-4"}`,children:[l.map(({key:d,label:x,icon:S})=>d==="admin"&&!a?null:n.jsxs("button",{className:`tab whitespace-nowrap flex items-center justify-start gap-3 ${e===d?"tab--active":"tab--inactive"} `,onClick:()=>t(d),title:x,style:{fontWeight:700,fontSize:"1.1rem",color:e===d?"#fff":"#E5E7EB",letterSpacing:"0.02em"},children:[n.jsx(S,{className:"w-6 h-6"}),n.jsxs("span",{className:"flex items-center gap-2",children:[x,d==="online"&&!(s!=null&&s.fullAccess)&&c<=0&&n.jsxs("span",{title:"Weekly free games used",className:"inline-flex items-center gap-1 text-[0.65rem] px-2 py-0.5 rounded-full bg-rose-600 text-white",children:[n.jsx(Tv,{className:"w-3 h-3"}),"Locked"]})]})]},d)),n.jsxs("button",{className:"tab tab--compact whitespace-nowrap flex items-center justify-start gap-3 bg-[#5865F2] text-white mt-2",onClick:()=>o(!0),title:"BullseyeDartsLeague",style:{fontWeight:700,fontSize:"1.1rem",letterSpacing:"0.02em"},children:[n.jsx(Kd,{className:"w-6 h-6"}),n.jsx("span",{className:"truncate",children:"BullseyeDartsLeague"})]}),i&&Ip.createPortal(n.jsxs("div",{className:"fixed inset-0 z-[1000]",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>o(!1),onTouchStart:()=>o(!1)}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:n.jsxs("div",{role:"dialog","aria-modal":"true",className:"card max-w-md w-full relative text-left p-6 rounded-xl",children:[n.jsx("button",{className:"absolute -top-3 -right-3 btn px-3 py-1","aria-label":"Close",onClick:()=>o(!1),children:""}),n.jsxs("h3",{className:"text-xl font-bold mb-2 flex items-center gap-2 text-[#8ea1e1]",children:[n.jsx(Kd,{className:"w-6 h-6"})," BullseyeDartsLeague"]}),n.jsx("div",{className:"mb-4 text-lg font-semibold",children:"Join this fantastic Online Darts League with divisions and other cool stuff included"}),n.jsx("a",{href:Fv,target:"_blank",rel:"noopener noreferrer nofollow",className:"btn bg-[#5865F2] text-white w-full font-bold text-lg",children:"Join Discord"})]})})]}),document.body)]})}const zv={},nh=e=>{let t;const s=new Set,r=(x,S)=>{const y=typeof x=="function"?x(t):x;if(!Object.is(y,t)){const N=t;t=S??(typeof y!="object"||y===null)?y:Object.assign({},t,y),s.forEach(w=>w(t,N))}},l=()=>t,c={setState:r,getState:l,getInitialState:()=>d,subscribe:x=>(s.add(x),()=>s.delete(x)),destroy:()=>{(zv?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},d=t=e(r,l,c);return c},Hv=e=>e?nh(e):nh;var zp={exports:{}},Hp={},Wp={exports:{}},Vp={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ul=m;function Wv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vv=typeof Object.is=="function"?Object.is:Wv,Gv=Ul.useState,Kv=Ul.useEffect,Jv=Ul.useLayoutEffect,Yv=Ul.useDebugValue;function qv(e,t){var s=t(),r=Gv({inst:{value:s,getSnapshot:t}}),l=r[0].inst,a=r[1];return Jv(function(){l.value=s,l.getSnapshot=t,zc(l)&&a({inst:l})},[e,s,t]),Kv(function(){return zc(l)&&a({inst:l}),e(function(){zc(l)&&a({inst:l})})},[e]),Yv(s),s}function zc(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Vv(e,s)}catch{return!0}}function Qv(e,t){return t()}var Xv=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Qv:qv;Vp.useSyncExternalStore=Ul.useSyncExternalStore!==void 0?Ul.useSyncExternalStore:Xv;Wp.exports=Vp;var Zv=Wp.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qo=m,eb=Zv;function tb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nb=typeof Object.is=="function"?Object.is:tb,sb=eb.useSyncExternalStore,rb=Qo.useRef,lb=Qo.useEffect,ab=Qo.useMemo,ib=Qo.useDebugValue;Hp.useSyncExternalStoreWithSelector=function(e,t,s,r,l){var a=rb(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=ab(function(){function c(N){if(!d){if(d=!0,x=N,N=r(N),l!==void 0&&i.hasValue){var w=i.value;if(l(w,N))return S=w}return S=N}if(w=S,nb(x,N))return w;var T=r(N);return l!==void 0&&l(w,T)?(x=N,w):(x=N,S=T)}var d=!1,x,S,y=s===void 0?null:s;return[function(){return c(t())},y===null?void 0:function(){return c(y())}]},[t,s,r,l]);var o=sb(e,a[0],a[1]);return lb(function(){i.hasValue=!0,i.value=o},[o]),ib(o),o};zp.exports=Hp;var ob=zp.exports;const cb=xh(ob),Gp={},{useDebugValue:db}=dg,{useSyncExternalStoreWithSelector:ub}=cb;let sh=!1;const mb=e=>e;function fb(e,t=mb,s){(Gp?"production":void 0)!=="production"&&s&&!sh&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sh=!0);const r=ub(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return db(r),r}const rh=e=>{(Gp?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Hv(e):e,s=(r,l)=>fb(t,r,l);return Object.assign(s,t),s},Jl=e=>e?rh(e):rh;let hb=1;const Yd=Jl(e=>({toasts:[],push:(t,s)=>e(r=>{const l=hb++,a={id:l,message:t,type:(s==null?void 0:s.type)||"info",timeout:(s==null?void 0:s.timeout)??3e3};return a.timeout&&a.timeout>0&&setTimeout(()=>{e(i=>({toasts:i.toasts.filter(o=>o.id!==l)}))},a.timeout),{toasts:[...r.toasts,a]}}),remove:t=>e(s=>({toasts:s.toasts.filter(r=>r.id!==t)})),clear:()=>e({toasts:[]})}));function Ml(){return Yd(t=>t.push)}function st(e){return(e??0).toFixed(2)}const pb=e=>`ndn_stats_${e}`,Kp=e=>`ndn_stats_ts_${e}`;function yn(e){try{const t=localStorage.getItem(pb(e));if(!t)return{darts:0,scored:0};const s=JSON.parse(t);return{darts:Number(s.darts)||0,scored:Number(s.scored)||0,fnDarts:Number(s.fnDarts)||0,fnScored:Number(s.fnScored)||0,best3:typeof s.best3=="number"?s.best3:0,worst3:typeof s.worst3=="number"?s.worst3:0,bestLegDarts:typeof s.bestLegDarts=="number"?s.bestLegDarts:0,bestCheckout:typeof s.bestCheckout=="number"?s.bestCheckout:0,worstLegDarts:typeof s.worstLegDarts=="number"?s.worstLegDarts:0,bestFNAvg:typeof s.bestFNAvg=="number"?s.bestFNAvg:0,worstFNAvg:typeof s.worstFNAvg=="number"?s.worstFNAvg:0}}catch{return{darts:0,scored:0}}}function Js(e){const{darts:t,scored:s}=yn(e);return t?s/t*3:0}function Hc(e){const{fnDarts:t=0,fnScored:s=0}=yn(e);return t?s/t*3:0}const Jp="ndn_game_mode_stats";function nm(e){let t={};try{const s=localStorage.getItem(Jp);s&&(t=JSON.parse(s))}catch{}if(Array.isArray(e))for(const s of e)t[s]||(t[s]={played:0,won:0});return t}function xb(e){try{localStorage.setItem(Jp,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("ndn:stats-updated",{detail:{gameModes:!0}}))}catch{}}function gb(e,t){const s=nm(),r=s[e]||{played:0,won:0};r.played+=1,t&&(r.won+=1),s[e]=r,xb(s)}function Xo(e){try{const t=localStorage.getItem(Kp(e));if(!t)return[];const s=JSON.parse(t);return Array.isArray(s)?s.map(r=>({t:Number(r.t)||0,darts:Number(r.darts)||0,scored:Number(r.scored)||0,fnDarts:Number(r.fnDarts)||0,fnScored:Number(r.fnScored)||0})).filter(r=>r.t>0):[]}catch{return[]}}function yb(e,t){try{localStorage.setItem(Kp(e),JSON.stringify(t)),window.dispatchEvent(new CustomEvent("ndn:stats-updated",{detail:{name:e}}))}catch{}}function vb(e,t){const s=Date.now();return e.filter(r=>s-r.t<=t)}function Sr(e,t,s,r=Date.now(),l,a){if(t<=0)return;const i=Xo(e),o=vb([...i,{t:r,darts:t,scored:s,fnDarts:l,fnScored:a}],1e3*60*60*24*30);yb(e,o)}function bb(e,t=1e3*60*60*24){const s=Xo(e);if(!s.length)return 0;const r=Date.now();let l=0,a=0;for(const i of s)r-i.t<=t&&(l+=i.darts,a+=i.scored);return l<=0?0:a/l*3}function Nb(e,t=1e3*60*60*24*30){const s=Xo(e);if(!s.length)return 0;const r=Date.now();let l=0,a=0;for(const i of s)r-i.t<=t&&(l+=i.fnDarts||0,a+=i.fnScored||0);return l<=0?0:a/l*3}function Wc(e){const s=Xo(e);if(!s.length)return 0;const r=Date.now(),l=s.filter(d=>r-d.t<=2592e6),a=l.filter(d=>typeof d.fnDarts=="number"),i=a.length?a:l;let o=0,c=0;for(const d of i)o+=d.darts,c+=d.scored;return o<=0?0:c/o*3}function Vc(e){return Nb(e,2592e6)}const Yp="ndn_user_settings";function qd(){try{const e=localStorage.getItem(Yp);if(!e)return{favoriteDouble:"D16",callerEnabled:!0,callerVoice:"",callerVolume:1,speakCheckoutOnly:!1,avgMode:"all-time",autoStartOffline:!1,rememberLastOffline:!0,lastOffline:{mode:"X01",x01Start:501,firstTo:1,aiLevel:"None"},reducedMotion:!1,compactHeader:!1,allowSpectate:!0,cameraScale:1,cameraAspect:"wide",calibrationGuide:!0,preferredCameraId:void 0,preferredCameraLabel:void 0,offlineLayout:"modern",autoscoreProvider:"built-in",autoscoreWsUrl:""};const t=JSON.parse(e);return{favoriteDouble:t.favoriteDouble||"D16",callerEnabled:typeof t.callerEnabled=="boolean"?t.callerEnabled:!0,callerVoice:t.callerVoice||"",callerVolume:typeof t.callerVolume=="number"?Math.max(0,Math.min(1,t.callerVolume)):1,speakCheckoutOnly:!!t.speakCheckoutOnly,avgMode:t.avgMode==="24h"?"24h":"all-time",autoStartOffline:!!t.autoStartOffline,rememberLastOffline:typeof t.rememberLastOffline=="boolean"?t.rememberLastOffline:!0,lastOffline:t.lastOffline&&typeof t.lastOffline=="object"?{mode:t.lastOffline.mode||"X01",x01Start:Number(t.lastOffline.x01Start)||501,firstTo:Number(t.lastOffline.firstTo)||1,aiLevel:t.lastOffline.aiLevel||"None"}:{mode:"X01",x01Start:501,firstTo:1,aiLevel:"None"},reducedMotion:!!t.reducedMotion,compactHeader:!!t.compactHeader,allowSpectate:typeof t.allowSpectate=="boolean"?t.allowSpectate:!0,cameraScale:typeof t.cameraScale=="number"&&isFinite(t.cameraScale)?Math.max(.5,Math.min(1.25,t.cameraScale)):1,cameraAspect:t.cameraAspect==="square"?"square":"wide",autoscoreProvider:t.autoscoreProvider==="external-ws"?"external-ws":"built-in",autoscoreWsUrl:typeof t.autoscoreWsUrl=="string"?t.autoscoreWsUrl:"",calibrationGuide:typeof t.calibrationGuide=="boolean"?t.calibrationGuide:!0,preferredCameraId:typeof t.preferredCameraId=="string"?t.preferredCameraId:void 0,preferredCameraLabel:typeof t.preferredCameraLabel=="string"?t.preferredCameraLabel:void 0,offlineLayout:t.offlineLayout==="classic"?"classic":"modern"}}catch{return{favoriteDouble:"D16",callerEnabled:!0,callerVoice:"",callerVolume:1,speakCheckoutOnly:!1,avgMode:"all-time",autoStartOffline:!1,rememberLastOffline:!0,lastOffline:{mode:"X01",x01Start:501,firstTo:1,aiLevel:"None"},reducedMotion:!1,compactHeader:!1,allowSpectate:!0,cameraScale:1,cameraAspect:"wide",calibrationGuide:!0,preferredCameraId:void 0,preferredCameraLabel:void 0,offlineLayout:"modern",autoscoreProvider:"built-in",autoscoreWsUrl:""}}}function Bt(e){try{const t=qd();localStorage.setItem(Yp,JSON.stringify({...t,...e}))}catch{}}const Yn=Jl(e=>({...qd(),setFavoriteDouble:t=>{Bt({favoriteDouble:t}),e({favoriteDouble:t})},setCallerEnabled:t=>{Bt({callerEnabled:t}),e({callerEnabled:t})},setCallerVoice:t=>{Bt({callerVoice:t}),e({callerVoice:t})},setAvgMode:t=>{Bt({avgMode:t}),e({avgMode:t})},setCallerVolume:t=>{const s=Math.max(0,Math.min(1,t));Bt({callerVolume:s}),e({callerVolume:s})},setSpeakCheckoutOnly:t=>{Bt({speakCheckoutOnly:t}),e({speakCheckoutOnly:t})},setAutoStartOffline:t=>{Bt({autoStartOffline:t}),e({autoStartOffline:t})},setRememberLastOffline:t=>{Bt({rememberLastOffline:t}),e({rememberLastOffline:t})},setLastOffline:t=>{const r={...qd().lastOffline,...t};Bt({lastOffline:r}),e({lastOffline:r})},setReducedMotion:t=>{Bt({reducedMotion:t}),e({reducedMotion:t})},setCompactHeader:t=>{Bt({compactHeader:t}),e({compactHeader:t})},setAllowSpectate:t=>{Bt({allowSpectate:t}),e({allowSpectate:t})},setCameraScale:t=>{const s=Math.max(.5,Math.min(1.25,t));Bt({cameraScale:s}),e({cameraScale:s})},setCameraAspect:t=>{const s=t==="square"?"square":"wide";Bt({cameraAspect:s}),e({cameraAspect:s})},setAutoscoreProvider:t=>{Bt({autoscoreProvider:t}),e({autoscoreProvider:t})},setAutoscoreWsUrl:t=>{Bt({autoscoreWsUrl:t}),e({autoscoreWsUrl:t})},setCalibrationGuide:t=>{Bt({calibrationGuide:t}),e({calibrationGuide:t})},setPreferredCamera:(t,s)=>{Bt({preferredCameraId:t,preferredCameraLabel:s}),e({preferredCameraId:t,preferredCameraLabel:s})},setOfflineLayout:t=>{Bt({offlineLayout:t}),e({offlineLayout:t})}}));function Ui(e){try{window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:e}}))}catch{}}function wb({user:e}){const[t,s]=m.useState(!1),[r,l]=m.useState(!1),[a,i]=m.useState(""),{lastOffline:o}=Yn();return m.useEffect(()=>{const c=["The fastest televised 9-darter took roughly 25 seconds!","A perfect leg (501) can be finished in nine darts.","The inner bull is worth 50; the outer bull is 25.","Standard dartboards are made from compressed sisal fibers.","Doubles and trebles are the thin outer and middle rings.","Professional oche (throw line) distance is 7 ft 9 in (2.37 m).","Dartitis is a real condition affecting a players throwing motion.","Phil Taylor holds a record number of World Championship titles.","Checkout routes often end on a doubleclassic double-out.","The highest 3-dart score is 180 (triple 20, triple 20, triple 20)."],d=Math.floor(Math.random()*c.length);i(c[d])},[]),n.jsxs("div",{className:`${e!=null&&e.fullAccess?"premium-main":""} relative min-h-[600px] flex flex-col items-center justify-center overflow-hidden`,children:[n.jsxs("div",{className:"absolute inset-0 z-0",children:[n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-700 via-indigo-500 to-blue-600 opacity-60 blur-2xl"}),n.jsx("div",{className:"absolute top-20 left-1/4 w-40 h-40 bg-pink-400 rounded-full opacity-30 blur-2xl animate-pulse"}),n.jsx("div",{className:"absolute bottom-10 right-1/4 w-32 h-32 bg-blue-400 rounded-full opacity-30 blur-2xl animate-pulse"})]}),n.jsxs("div",{className:"relative z-10 w-full max-w-6xl mx-auto bg-white/10 backdrop-blur-lg rounded-2xl sm:rounded-3xl shadow-2xl p-4 sm:p-6 md:p-8 lg:p-10 flex flex-col items-center",children:[n.jsx("h2",{className:"text-2xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 via-purple-400 to-blue-400 mb-2 sm:mb-3 md:mb-4 drop-shadow-xl text-center leading-tight",children:"Welcome to Nine Dart Nation"}),n.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl text-white/80 mb-2 font-semibold text-center px-2",children:"Your home for competitive darts, stats, and online play."}),n.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg text-white/60 mb-3 sm:mb-4 italic text-center px-2",children:'"Where every dart counts and every player matters."'}),a&&n.jsx("div",{className:"w-full mb-4 sm:mb-6 px-2 sm:px-0",children:n.jsxs("div",{className:"mx-auto max-w-xs sm:max-w-xl rounded-full px-3 sm:px-5 py-2 text-center text-indigo-100 bg-gradient-to-r from-indigo-600/80 to-fuchsia-600/80 shadow-md",children:[n.jsx("span",{className:"font-semibold text-sm sm:text-base",children:"Did you know?"})," ",n.jsx("span",{className:"opacity-90 text-sm sm:text-base",children:a})]})}),n.jsxs("div",{className:"flex flex-wrap gap-3 sm:gap-4 md:gap-6 justify-center mb-6 md:mb-8 w-full max-w-4xl mx-auto",children:[n.jsxs("button",{onClick:()=>{Ui("offline");try{window.dispatchEvent(new CustomEvent("ndn:offline-format",{detail:{formatType:"first",formatCount:Number(o==null?void 0:o.firstTo)||1,startScore:Number(o==null?void 0:o.x01Start)||501}}))}catch{}try{setTimeout(()=>{window.dispatchEvent(new CustomEvent("ndn:auto-start",{detail:{mode:(o==null?void 0:o.mode)||"X01"}}))},50)}catch{}},className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:""})," Start New Match"]}),n.jsxs("button",{onClick:()=>Ui("stats"),className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:""})," View Stats"]}),n.jsxs("button",{onClick:()=>Ui("online"),className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-green-500 to-blue-400 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:""})," Join Online League"]}),n.jsxs("button",{onClick:()=>{Ui("offline");try{window.dispatchEvent(new CustomEvent("ndn:auto-start",{detail:{mode:"Double Practice"}}))}catch{}},className:"flex-1 min-w-[200px] sm:flex-none px-4 sm:px-6 md:px-8 py-3 md:py-4 rounded-full bg-gradient-to-r from-pink-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg md:text-xl touch-manipulation",children:[n.jsx("span",{"aria-hidden":!0,children:""})," Practice Doubles"]})]}),(()=>{const c=(e==null?void 0:e.username)||"Player 1",d=yn(c),x=!!(e!=null&&e.fullAccess),S="grid grid-cols-[120px,1fr,1fr] sm:grid-cols-[160px,1fr,1fr]",y=({label:N,left:w,right:T,lock:P})=>n.jsxs("div",{className:`relative ${S} gap-2 items-center p-2 rounded-lg ${P?"bg-white/5 border border-white/10 overflow-hidden":"bg-indigo-500/10 border border-indigo-500/40"} mb-2`,children:[n.jsx("div",{className:"text-[12px] opacity-80 pl-2 text-left",children:N}),n.jsx("div",{className:`text-sm font-semibold text-center ${P?"opacity-50 blur-[0.5px]":""}`,children:w}),n.jsx("div",{className:`text-sm font-semibold text-center ${P?"opacity-50 blur-[0.5px]":""}`,children:T}),P&&n.jsx("button",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-slate-900/35 hover:bg-slate-900/45 transition",onClick:async()=>{try{const h=await(await fetch("/api/stripe/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})})).json();h.ok&&h.url?window.open(h.url,"_blank"):h.error==="STRIPE_NOT_CONFIGURED"?Ml()("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):Ml()("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{Ml()("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},title:"Unlock with PREMIUM",children:n.jsx("span",{className:"text-[12px] font-semibold",children:"Unlock PREMIUM"})})]});return n.jsxs("div",{className:"w-full mt-2 rounded-2xl p-2 sm:p-3 bg-white/5 border border-white/10 overflow-x-auto",children:[n.jsxs("div",{className:`${S} gap-2 mb-2 px-1 items-center min-w-[280px] sm:min-w-0`,children:[n.jsx("div",{className:"text-[12px] opacity-0 select-none",children:"label"}),n.jsx("div",{className:"text-[12px] font-semibold text-center",children:"BEST"}),n.jsx("div",{className:"text-[12px] font-semibold text-center",children:"WORST"})]}),n.jsx(y,{label:"3-dart avg",left:st(d.best3||0),right:st(d.worst3||0)}),n.jsx(y,{label:"9-dart avg",left:st(d.bestFNAvg||0),right:st(d.worstFNAvg||0),lock:!x}),n.jsx(y,{label:"Leg (darts)",left:String(d.bestLegDarts||0),right:String(d.worstLegDarts||0),lock:!x}),n.jsx(y,{label:"Checkout",left:String(d.bestCheckout||0),right:"",lock:!x})]})})(),n.jsx("button",{className:"mt-6 sm:mt-8 md:mt-10 px-6 sm:px-8 md:px-10 py-3 md:py-4 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 text-base sm:text-lg md:text-xl touch-manipulation",onClick:()=>l(!0),children:"How to Play / Getting Started"})]}),n.jsx("footer",{className:"w-full py-2 md:py-2 text-center text-white/80 text-xs md:text-sm font-medium absolute bottom-0 left-0 z-20 flex items-center justify-center gap-1 md:gap-2",children:n.jsxs("button",{className:"flex items-center gap-1 md:gap-2 hover:text-white transition",onClick:()=>s(!0),children:[n.jsx("span",{children:""}),n.jsx("span",{style:{letterSpacing:"0.05em"},children:"NINEDARTNATION"})]})}),t&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs("div",{className:"card max-w-lg w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>s(!1),children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2",children:"Legal Information"}),n.jsxs("ul",{className:"list-disc pl-5 mb-2",children:[n.jsx("li",{children:"Terms & Conditions: All users must follow fair play and site rules."}),n.jsx("li",{children:"Privacy Policy: Your data is protected and never shared without consent."}),n.jsxs("li",{children:["Copyright  ",new Date().getFullYear()," NINEDARTNATION. All rights reserved."]}),n.jsx("li",{children:"Contact: support@ninedartnation.com"})]}),n.jsx("p",{className:"text-sm text-purple-200",children:"For full legal details, please contact us or visit our legal page."})]})}),r&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs("div",{className:"card max-w-lg w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>l(!1),children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2",children:"Getting Started"}),n.jsxs("ul",{className:"list-disc pl-5 mb-2",children:[n.jsx("li",{children:"Choose a game mode and invite friends or play solo."}),n.jsx("li",{children:"Track your stats and progress in the Stats tab."}),n.jsx("li",{children:"Join the BullseyeDartsLeague for online competition."}),n.jsx("li",{children:"Upgrade to PREMIUM for advanced features and modes."}),n.jsx("li",{children:"Need help? Visit the Settings tab for support and tips."})]}),n.jsx("p",{className:"text-sm text-purple-200",children:'Ready to play? Hit "Start New Match" and let the darts fly!'})]})})]})}function ds({children:e,className:t,style:s}){const r=m.useRef(null);return m.useEffect(()=>{let l=0;const a=()=>{const c=r.current;if(!c)return;const d=document.getElementById("ndn-header");if(!d){c.style.clipPath="";return}const x=document.getElementById("ndn-main-scroll"),S=x?x.scrollTop:window.scrollY||0,y=d.getBoundingClientRect().height,N=S>0?y:0;c.style.marginTop=N>0?`${N}px`:"0px"};a();const i=()=>{l&&cancelAnimationFrame(l),l=requestAnimationFrame(a)},o=document.getElementById("ndn-main-scroll");return o==null||o.addEventListener("scroll",i,{passive:!0}),window.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",i),()=>{o==null||o.removeEventListener("scroll",i),window.removeEventListener("scroll",i),window.removeEventListener("resize",i),l&&cancelAnimationFrame(l)}},[]),n.jsx("div",{ref:r,className:t,style:s,children:e})}const jb=({calibrationComplete:e})=>{const[t,s]=m.useState(!1),[r,l]=m.useState(!1);return m.useEffect(()=>{e?(s(!0),setTimeout(()=>l(!0),1200)):(s(!1),l(!1))},[e]),n.jsxs("div",{className:`flex flex-col items-center justify-center w-full h-full transition-opacity duration-700 ${r?"opacity-0":"opacity-100"}`,style:{pointerEvents:"none",position:"absolute",inset:0,zIndex:10},children:[n.jsxs("div",{className:"flex items-center justify-center",children:[n.jsx("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:`animate-spin-slow ${t?"opacity-0":"opacity-100"} transition-opacity duration-500`,style:{transition:"opacity 0.5s"},children:n.jsxs("g",{children:[n.jsx("rect",{x:"36",y:"10",width:"8",height:"40",rx:"3",fill:"#a78bfa"}),n.jsx("polygon",{points:"40,10 44,22 36,22",fill:"#f472b6"}),n.jsx("rect",{x:"36",y:"50",width:"8",height:"18",rx:"2",fill:"#22d3ee"}),n.jsx("polygon",{points:"36,68 44,68 40,78",fill:"#10b981"})]})}),t&&n.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:"absolute",style:{left:0,top:0},children:[n.jsx("circle",{cx:"40",cy:"40",r:"32",fill:"none",stroke:"#10b981",strokeWidth:"6"}),n.jsx("polyline",{points:"28,44 38,54 54,30",fill:"none",stroke:"#10b981",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round"})]})]}),n.jsx("div",{className:"mt-4 text-lg font-semibold text-indigo-200",children:t?"Calibration Complete!":"Initializing Camera..."})]})};var Yl={},Sb=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},qp={},kn={};let sm;const kb=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];kn.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};kn.getSymbolTotalCodewords=function(t){return kb[t]};kn.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};kn.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');sm=t};kn.isKanjiModeEnabled=function(){return typeof sm<"u"};kn.toSJIS=function(t){return sm(t)};var Zo={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+s)}}e.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},e.from=function(r,l){if(e.isValid(r))return r;try{return t(r)}catch{return l}}})(Zo);function Qp(){this.buffer=[],this.length=0}Qp.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let s=0;s<t;s++)this.putBit((e>>>t-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Cb=Qp;function oi(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}oi.prototype.set=function(e,t,s,r){const l=e*this.size+t;this.data[l]=s,r&&(this.reservedBit[l]=!0)};oi.prototype.get=function(e,t){return this.data[e*this.size+t]};oi.prototype.xor=function(e,t,s){this.data[e*this.size+t]^=s};oi.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var Eb=oi,Xp={};(function(e){const t=kn.getSymbolSize;e.getRowColCoords=function(r){if(r===1)return[];const l=Math.floor(r/7)+2,a=t(r),i=a===145?26:Math.ceil((a-13)/(2*l-2))*2,o=[a-7];for(let c=1;c<l-1;c++)o[c]=o[c-1]-i;return o.push(6),o.reverse()},e.getPositions=function(r){const l=[],a=e.getRowColCoords(r),i=a.length;for(let o=0;o<i;o++)for(let c=0;c<i;c++)o===0&&c===0||o===0&&c===i-1||o===i-1&&c===0||l.push([a[o],a[c]]);return l}})(Xp);var Zp={};const Tb=kn.getSymbolSize,lh=7;Zp.getPositions=function(t){const s=Tb(t);return[[0,0],[s-lh,0],[0,s-lh]]};var ex={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(l){return l!=null&&l!==""&&!isNaN(l)&&l>=0&&l<=7},e.from=function(l){return e.isValid(l)?parseInt(l,10):void 0},e.getPenaltyN1=function(l){const a=l.size;let i=0,o=0,c=0,d=null,x=null;for(let S=0;S<a;S++){o=c=0,d=x=null;for(let y=0;y<a;y++){let N=l.get(S,y);N===d?o++:(o>=5&&(i+=t.N1+(o-5)),d=N,o=1),N=l.get(y,S),N===x?c++:(c>=5&&(i+=t.N1+(c-5)),x=N,c=1)}o>=5&&(i+=t.N1+(o-5)),c>=5&&(i+=t.N1+(c-5))}return i},e.getPenaltyN2=function(l){const a=l.size;let i=0;for(let o=0;o<a-1;o++)for(let c=0;c<a-1;c++){const d=l.get(o,c)+l.get(o,c+1)+l.get(o+1,c)+l.get(o+1,c+1);(d===4||d===0)&&i++}return i*t.N2},e.getPenaltyN3=function(l){const a=l.size;let i=0,o=0,c=0;for(let d=0;d<a;d++){o=c=0;for(let x=0;x<a;x++)o=o<<1&2047|l.get(d,x),x>=10&&(o===1488||o===93)&&i++,c=c<<1&2047|l.get(x,d),x>=10&&(c===1488||c===93)&&i++}return i*t.N3},e.getPenaltyN4=function(l){let a=0;const i=l.data.length;for(let c=0;c<i;c++)a+=l.data[c];return Math.abs(Math.ceil(a*100/i/5)-10)*t.N4};function s(r,l,a){switch(r){case e.Patterns.PATTERN000:return(l+a)%2===0;case e.Patterns.PATTERN001:return l%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(l+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(l/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return l*a%2+l*a%3===0;case e.Patterns.PATTERN110:return(l*a%2+l*a%3)%2===0;case e.Patterns.PATTERN111:return(l*a%3+(l+a)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}e.applyMask=function(l,a){const i=a.size;for(let o=0;o<i;o++)for(let c=0;c<i;c++)a.isReserved(c,o)||a.xor(c,o,s(l,c,o))},e.getBestMask=function(l,a){const i=Object.keys(e.Patterns).length;let o=0,c=1/0;for(let d=0;d<i;d++){a(d),e.applyMask(d,l);const x=e.getPenaltyN1(l)+e.getPenaltyN2(l)+e.getPenaltyN3(l)+e.getPenaltyN4(l);e.applyMask(d,l),x<c&&(c=x,o=d)}return o}})(ex);var ec={};const Ys=Zo,Fi=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],$i=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];ec.getBlocksCount=function(t,s){switch(s){case Ys.L:return Fi[(t-1)*4+0];case Ys.M:return Fi[(t-1)*4+1];case Ys.Q:return Fi[(t-1)*4+2];case Ys.H:return Fi[(t-1)*4+3];default:return}};ec.getTotalCodewordsCount=function(t,s){switch(s){case Ys.L:return $i[(t-1)*4+0];case Ys.M:return $i[(t-1)*4+1];case Ys.Q:return $i[(t-1)*4+2];case Ys.H:return $i[(t-1)*4+3];default:return}};var tx={},tc={};const Ma=new Uint8Array(512),Io=new Uint8Array(256);(function(){let t=1;for(let s=0;s<255;s++)Ma[s]=t,Io[t]=s,t<<=1,t&256&&(t^=285);for(let s=255;s<512;s++)Ma[s]=Ma[s-255]})();tc.log=function(t){if(t<1)throw new Error("log("+t+")");return Io[t]};tc.exp=function(t){return Ma[t]};tc.mul=function(t,s){return t===0||s===0?0:Ma[Io[t]+Io[s]]};(function(e){const t=tc;e.mul=function(r,l){const a=new Uint8Array(r.length+l.length-1);for(let i=0;i<r.length;i++)for(let o=0;o<l.length;o++)a[i+o]^=t.mul(r[i],l[o]);return a},e.mod=function(r,l){let a=new Uint8Array(r);for(;a.length-l.length>=0;){const i=a[0];for(let c=0;c<l.length;c++)a[c]^=t.mul(l[c],i);let o=0;for(;o<a.length&&a[o]===0;)o++;a=a.slice(o)}return a},e.generateECPolynomial=function(r){let l=new Uint8Array([1]);for(let a=0;a<r;a++)l=e.mul(l,new Uint8Array([1,t.exp(a)]));return l}})(tx);const nx=tx;function rm(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}rm.prototype.initialize=function(t){this.degree=t,this.genPoly=nx.generateECPolynomial(this.degree)};rm.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(t.length+this.degree);s.set(t);const r=nx.mod(s,this.genPoly),l=this.degree-r.length;if(l>0){const a=new Uint8Array(this.degree);return a.set(r,l),a}return r};var Ib=rm,sx={},dr={},lm={};lm.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var ps={};const rx="[0-9]+",Db="[A-Z $%*+\\-./:]+";let ei="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ei=ei.replace(/u/g,"\\u");const Mb="(?:(?![A-Z0-9 $%*+\\-./:]|"+ei+`)(?:.|[\r
]))+`;ps.KANJI=new RegExp(ei,"g");ps.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");ps.BYTE=new RegExp(Mb,"g");ps.NUMERIC=new RegExp(rx,"g");ps.ALPHANUMERIC=new RegExp(Db,"g");const Lb=new RegExp("^"+ei+"$"),Pb=new RegExp("^"+rx+"$"),Ab=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");ps.testKanji=function(t){return Lb.test(t)};ps.testNumeric=function(t){return Pb.test(t)};ps.testAlphanumeric=function(t){return Ab.test(t)};(function(e){const t=lm,s=ps;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,i){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?a.ccBits[0]:i<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return s.testNumeric(a)?e.NUMERIC:s.testAlphanumeric(a)?e.ALPHANUMERIC:s.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function r(l){if(typeof l!="string")throw new Error("Param is not a string");switch(l.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+l)}}e.from=function(a,i){if(e.isValid(a))return a;try{return r(a)}catch{return i}}})(dr);(function(e){const t=kn,s=ec,r=Zo,l=dr,a=lm,i=7973,o=t.getBCHDigit(i);function c(y,N,w){for(let T=1;T<=40;T++)if(N<=e.getCapacity(T,w,y))return T}function d(y,N){return l.getCharCountIndicator(y,N)+4}function x(y,N){let w=0;return y.forEach(function(T){const P=d(T.mode,N);w+=P+T.getBitsLength()}),w}function S(y,N){for(let w=1;w<=40;w++)if(x(y,w)<=e.getCapacity(w,N,l.MIXED))return w}e.from=function(N,w){return a.isValid(N)?parseInt(N,10):w},e.getCapacity=function(N,w,T){if(!a.isValid(N))throw new Error("Invalid QR Code version");typeof T>"u"&&(T=l.BYTE);const P=t.getSymbolTotalCodewords(N),v=s.getTotalCodewordsCount(N,w),h=(P-v)*8;if(T===l.MIXED)return h;const b=h-d(T,N);switch(T){case l.NUMERIC:return Math.floor(b/10*3);case l.ALPHANUMERIC:return Math.floor(b/11*2);case l.KANJI:return Math.floor(b/13);case l.BYTE:default:return Math.floor(b/8)}},e.getBestVersionForData=function(N,w){let T;const P=r.from(w,r.M);if(Array.isArray(N)){if(N.length>1)return S(N,P);if(N.length===0)return 1;T=N[0]}else T=N;return c(T.mode,T.getLength(),P)},e.getEncodedBits=function(N){if(!a.isValid(N)||N<7)throw new Error("Invalid QR Code version");let w=N<<12;for(;t.getBCHDigit(w)-o>=0;)w^=i<<t.getBCHDigit(w)-o;return N<<12|w}})(sx);var lx={};const Qd=kn,ax=1335,Rb=21522,ah=Qd.getBCHDigit(ax);lx.getEncodedBits=function(t,s){const r=t.bit<<3|s;let l=r<<10;for(;Qd.getBCHDigit(l)-ah>=0;)l^=ax<<Qd.getBCHDigit(l)-ah;return(r<<10|l)^Rb};var ix={};const Ob=dr;function Fl(e){this.mode=Ob.NUMERIC,this.data=e.toString()}Fl.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Fl.prototype.getLength=function(){return this.data.length};Fl.prototype.getBitsLength=function(){return Fl.getBitsLength(this.data.length)};Fl.prototype.write=function(t){let s,r,l;for(s=0;s+3<=this.data.length;s+=3)r=this.data.substr(s,3),l=parseInt(r,10),t.put(l,10);const a=this.data.length-s;a>0&&(r=this.data.substr(s),l=parseInt(r,10),t.put(l,a*3+1))};var Bb=Fl;const _b=dr,Gc=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function $l(e){this.mode=_b.ALPHANUMERIC,this.data=e}$l.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};$l.prototype.getLength=function(){return this.data.length};$l.prototype.getBitsLength=function(){return $l.getBitsLength(this.data.length)};$l.prototype.write=function(t){let s;for(s=0;s+2<=this.data.length;s+=2){let r=Gc.indexOf(this.data[s])*45;r+=Gc.indexOf(this.data[s+1]),t.put(r,11)}this.data.length%2&&t.put(Gc.indexOf(this.data[s]),6)};var Ub=$l;const Fb=dr;function zl(e){this.mode=Fb.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}zl.getBitsLength=function(t){return t*8};zl.prototype.getLength=function(){return this.data.length};zl.prototype.getBitsLength=function(){return zl.getBitsLength(this.data.length)};zl.prototype.write=function(e){for(let t=0,s=this.data.length;t<s;t++)e.put(this.data[t],8)};var $b=zl;const zb=dr,Hb=kn;function Hl(e){this.mode=zb.KANJI,this.data=e}Hl.getBitsLength=function(t){return t*13};Hl.prototype.getLength=function(){return this.data.length};Hl.prototype.getBitsLength=function(){return Hl.getBitsLength(this.data.length)};Hl.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let s=Hb.toSJIS(this.data[t]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),e.put(s,13)}};var Wb=Hl,ox={exports:{}};(function(e){var t={single_source_shortest_paths:function(s,r,l){var a={},i={};i[r]=0;var o=t.PriorityQueue.make();o.push(r,0);for(var c,d,x,S,y,N,w,T,P;!o.empty();){c=o.pop(),d=c.value,S=c.cost,y=s[d]||{};for(x in y)y.hasOwnProperty(x)&&(N=y[x],w=S+N,T=i[x],P=typeof i[x]>"u",(P||T>w)&&(i[x]=w,o.push(x,w),a[x]=d))}if(typeof l<"u"&&typeof i[l]>"u"){var v=["Could not find a path from ",r," to ",l,"."].join("");throw new Error(v)}return a},extract_shortest_path_from_predecessor_list:function(s,r){for(var l=[],a=r;a;)l.push(a),s[a],a=s[a];return l.reverse(),l},find_path:function(s,r,l){var a=t.single_source_shortest_paths(s,r,l);return t.extract_shortest_path_from_predecessor_list(a,l)},PriorityQueue:{make:function(s){var r=t.PriorityQueue,l={},a;s=s||{};for(a in r)r.hasOwnProperty(a)&&(l[a]=r[a]);return l.queue=[],l.sorter=s.sorter||r.default_sorter,l},default_sorter:function(s,r){return s.cost-r.cost},push:function(s,r){var l={value:s,cost:r};this.queue.push(l),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(ox);var Vb=ox.exports;(function(e){const t=dr,s=Bb,r=Ub,l=$b,a=Wb,i=ps,o=kn,c=Vb;function d(v){return unescape(encodeURIComponent(v)).length}function x(v,h,b){const C=[];let j;for(;(j=v.exec(b))!==null;)C.push({data:j[0],index:j.index,mode:h,length:j[0].length});return C}function S(v){const h=x(i.NUMERIC,t.NUMERIC,v),b=x(i.ALPHANUMERIC,t.ALPHANUMERIC,v);let C,j;return o.isKanjiModeEnabled()?(C=x(i.BYTE,t.BYTE,v),j=x(i.KANJI,t.KANJI,v)):(C=x(i.BYTE_KANJI,t.BYTE,v),j=[]),h.concat(b,C,j).sort(function(R,B){return R.index-B.index}).map(function(R){return{data:R.data,mode:R.mode,length:R.length}})}function y(v,h){switch(h){case t.NUMERIC:return s.getBitsLength(v);case t.ALPHANUMERIC:return r.getBitsLength(v);case t.KANJI:return a.getBitsLength(v);case t.BYTE:return l.getBitsLength(v)}}function N(v){return v.reduce(function(h,b){const C=h.length-1>=0?h[h.length-1]:null;return C&&C.mode===b.mode?(h[h.length-1].data+=b.data,h):(h.push(b),h)},[])}function w(v){const h=[];for(let b=0;b<v.length;b++){const C=v[b];switch(C.mode){case t.NUMERIC:h.push([C,{data:C.data,mode:t.ALPHANUMERIC,length:C.length},{data:C.data,mode:t.BYTE,length:C.length}]);break;case t.ALPHANUMERIC:h.push([C,{data:C.data,mode:t.BYTE,length:C.length}]);break;case t.KANJI:h.push([C,{data:C.data,mode:t.BYTE,length:d(C.data)}]);break;case t.BYTE:h.push([{data:C.data,mode:t.BYTE,length:d(C.data)}])}}return h}function T(v,h){const b={},C={start:{}};let j=["start"];for(let f=0;f<v.length;f++){const R=v[f],B=[];for(let ee=0;ee<R.length;ee++){const Y=R[ee],$=""+f+ee;B.push($),b[$]={node:Y,lastCount:0},C[$]={};for(let Q=0;Q<j.length;Q++){const D=j[Q];b[D]&&b[D].node.mode===Y.mode?(C[D][$]=y(b[D].lastCount+Y.length,Y.mode)-y(b[D].lastCount,Y.mode),b[D].lastCount+=Y.length):(b[D]&&(b[D].lastCount=Y.length),C[D][$]=y(Y.length,Y.mode)+4+t.getCharCountIndicator(Y.mode,h))}}j=B}for(let f=0;f<j.length;f++)C[j[f]].end=0;return{map:C,table:b}}function P(v,h){let b;const C=t.getBestModeForData(v);if(b=t.from(h,C),b!==t.BYTE&&b.bit<C.bit)throw new Error('"'+v+'" cannot be encoded with mode '+t.toString(b)+`.
 Suggested mode is: `+t.toString(C));switch(b===t.KANJI&&!o.isKanjiModeEnabled()&&(b=t.BYTE),b){case t.NUMERIC:return new s(v);case t.ALPHANUMERIC:return new r(v);case t.KANJI:return new a(v);case t.BYTE:return new l(v)}}e.fromArray=function(h){return h.reduce(function(b,C){return typeof C=="string"?b.push(P(C,null)):C.data&&b.push(P(C.data,C.mode)),b},[])},e.fromString=function(h,b){const C=S(h,o.isKanjiModeEnabled()),j=w(C),f=T(j,b),R=c.find_path(f.map,"start","end"),B=[];for(let ee=1;ee<R.length-1;ee++)B.push(f.table[R[ee]].node);return e.fromArray(N(B))},e.rawSplit=function(h){return e.fromArray(S(h,o.isKanjiModeEnabled()))}})(ix);const nc=kn,Kc=Zo,Gb=Cb,Kb=Eb,Jb=Xp,Yb=Zp,Xd=ex,Zd=ec,qb=Ib,Do=sx,Qb=lx,Xb=dr,Jc=ix;function Zb(e,t){const s=e.size,r=Yb.getPositions(t);for(let l=0;l<r.length;l++){const a=r[l][0],i=r[l][1];for(let o=-1;o<=7;o++)if(!(a+o<=-1||s<=a+o))for(let c=-1;c<=7;c++)i+c<=-1||s<=i+c||(o>=0&&o<=6&&(c===0||c===6)||c>=0&&c<=6&&(o===0||o===6)||o>=2&&o<=4&&c>=2&&c<=4?e.set(a+o,i+c,!0,!0):e.set(a+o,i+c,!1,!0))}}function e1(e){const t=e.size;for(let s=8;s<t-8;s++){const r=s%2===0;e.set(s,6,r,!0),e.set(6,s,r,!0)}}function t1(e,t){const s=Jb.getPositions(t);for(let r=0;r<s.length;r++){const l=s[r][0],a=s[r][1];for(let i=-2;i<=2;i++)for(let o=-2;o<=2;o++)i===-2||i===2||o===-2||o===2||i===0&&o===0?e.set(l+i,a+o,!0,!0):e.set(l+i,a+o,!1,!0)}}function n1(e,t){const s=e.size,r=Do.getEncodedBits(t);let l,a,i;for(let o=0;o<18;o++)l=Math.floor(o/3),a=o%3+s-8-3,i=(r>>o&1)===1,e.set(l,a,i,!0),e.set(a,l,i,!0)}function Yc(e,t,s){const r=e.size,l=Qb.getEncodedBits(t,s);let a,i;for(a=0;a<15;a++)i=(l>>a&1)===1,a<6?e.set(a,8,i,!0):a<8?e.set(a+1,8,i,!0):e.set(r-15+a,8,i,!0),a<8?e.set(8,r-a-1,i,!0):a<9?e.set(8,15-a-1+1,i,!0):e.set(8,15-a-1,i,!0);e.set(r-8,8,1,!0)}function s1(e,t){const s=e.size;let r=-1,l=s-1,a=7,i=0;for(let o=s-1;o>0;o-=2)for(o===6&&o--;;){for(let c=0;c<2;c++)if(!e.isReserved(l,o-c)){let d=!1;i<t.length&&(d=(t[i]>>>a&1)===1),e.set(l,o-c,d),a--,a===-1&&(i++,a=7)}if(l+=r,l<0||s<=l){l-=r,r=-r;break}}}function r1(e,t,s){const r=new Gb;s.forEach(function(c){r.put(c.mode.bit,4),r.put(c.getLength(),Xb.getCharCountIndicator(c.mode,e)),c.write(r)});const l=nc.getSymbolTotalCodewords(e),a=Zd.getTotalCodewordsCount(e,t),i=(l-a)*8;for(r.getLengthInBits()+4<=i&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const o=(i-r.getLengthInBits())/8;for(let c=0;c<o;c++)r.put(c%2?17:236,8);return l1(r,e,t)}function l1(e,t,s){const r=nc.getSymbolTotalCodewords(t),l=Zd.getTotalCodewordsCount(t,s),a=r-l,i=Zd.getBlocksCount(t,s),o=r%i,c=i-o,d=Math.floor(r/i),x=Math.floor(a/i),S=x+1,y=d-x,N=new qb(y);let w=0;const T=new Array(i),P=new Array(i);let v=0;const h=new Uint8Array(e.buffer);for(let R=0;R<i;R++){const B=R<c?x:S;T[R]=h.slice(w,w+B),P[R]=N.encode(T[R]),w+=B,v=Math.max(v,B)}const b=new Uint8Array(r);let C=0,j,f;for(j=0;j<v;j++)for(f=0;f<i;f++)j<T[f].length&&(b[C++]=T[f][j]);for(j=0;j<y;j++)for(f=0;f<i;f++)b[C++]=P[f][j];return b}function a1(e,t,s,r){let l;if(Array.isArray(e))l=Jc.fromArray(e);else if(typeof e=="string"){let d=t;if(!d){const x=Jc.rawSplit(e);d=Do.getBestVersionForData(x,s)}l=Jc.fromString(e,d||40)}else throw new Error("Invalid data");const a=Do.getBestVersionForData(l,s);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=a;else if(t<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const i=r1(t,s,l),o=nc.getSymbolSize(t),c=new Kb(o);return Zb(c,t),e1(c),t1(c,t),Yc(c,s,0),t>=7&&n1(c,t),s1(c,i),isNaN(r)&&(r=Xd.getBestMask(c,Yc.bind(null,c,s))),Xd.applyMask(r,c),Yc(c,s,r),{modules:c,version:t,errorCorrectionLevel:s,maskPattern:r,segments:l}}qp.create=function(t,s){if(typeof t>"u"||t==="")throw new Error("No input text");let r=Kc.M,l,a;return typeof s<"u"&&(r=Kc.from(s.errorCorrectionLevel,Kc.M),l=Do.from(s.version),a=Xd.from(s.maskPattern),s.toSJISFunc&&nc.setToSJISFunction(s.toSJISFunc)),a1(t,l,r,a)};var cx={},am={};(function(e){function t(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let r=s.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+s);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(a){return[a,a]}))),r.length===6&&r.push("F","F");const l=parseInt(r.join(""),16);return{r:l>>24&255,g:l>>16&255,b:l>>8&255,a:l&255,hex:"#"+r.slice(0,6).join("")}}e.getOptions=function(r){r||(r={}),r.color||(r.color={});const l=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,a=r.width&&r.width>=21?r.width:void 0,i=r.scale||4;return{width:a,scale:a?4:i,margin:l,color:{dark:t(r.color.dark||"#000000ff"),light:t(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},e.getScale=function(r,l){return l.width&&l.width>=r+l.margin*2?l.width/(r+l.margin*2):l.scale},e.getImageWidth=function(r,l){const a=e.getScale(r,l);return Math.floor((r+l.margin*2)*a)},e.qrToImageData=function(r,l,a){const i=l.modules.size,o=l.modules.data,c=e.getScale(i,a),d=Math.floor((i+a.margin*2)*c),x=a.margin*c,S=[a.color.light,a.color.dark];for(let y=0;y<d;y++)for(let N=0;N<d;N++){let w=(y*d+N)*4,T=a.color.light;if(y>=x&&N>=x&&y<d-x&&N<d-x){const P=Math.floor((y-x)/c),v=Math.floor((N-x)/c);T=S[o[P*i+v]?1:0]}r[w++]=T.r,r[w++]=T.g,r[w++]=T.b,r[w]=T.a}}})(am);(function(e){const t=am;function s(l,a,i){l.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=i,a.width=i,a.style.height=i+"px",a.style.width=i+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,i,o){let c=o,d=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(d=r()),c=t.getOptions(c);const x=t.getImageWidth(a.modules.size,c),S=d.getContext("2d"),y=S.createImageData(x,x);return t.qrToImageData(y.data,a,c),s(S,d,x),S.putImageData(y,0,0),d},e.renderToDataURL=function(a,i,o){let c=o;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const d=e.render(a,i,c),x=c.type||"image/png",S=c.rendererOpts||{};return d.toDataURL(x,S.quality)}})(cx);var dx={};const i1=am;function ih(e,t){const s=e.a/255,r=t+'="'+e.hex+'"';return s<1?r+" "+t+'-opacity="'+s.toFixed(2).slice(1)+'"':r}function qc(e,t,s){let r=e+t;return typeof s<"u"&&(r+=" "+s),r}function o1(e,t,s){let r="",l=0,a=!1,i=0;for(let o=0;o<e.length;o++){const c=Math.floor(o%t),d=Math.floor(o/t);!c&&!a&&(a=!0),e[o]?(i++,o>0&&c>0&&e[o-1]||(r+=a?qc("M",c+s,.5+d+s):qc("m",l,0),l=0,a=!1),c+1<t&&e[o+1]||(r+=qc("h",i),i=0)):l++}return r}dx.render=function(t,s,r){const l=i1.getOptions(s),a=t.modules.size,i=t.modules.data,o=a+l.margin*2,c=l.color.light.a?"<path "+ih(l.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",d="<path "+ih(l.color.dark,"stroke")+' d="'+o1(i,a,l.margin)+'"/>',x='viewBox="0 0 '+o+" "+o+'"',y='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+x+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof r=="function"&&r(null,y),y};const c1=Sb,eu=qp,ux=cx,d1=dx;function im(e,t,s,r,l){const a=[].slice.call(arguments,1),i=a.length,o=typeof a[i-1]=="function";if(!o&&!c1())throw new Error("Callback required as last argument");if(o){if(i<2)throw new Error("Too few arguments provided");i===2?(l=s,s=t,t=r=void 0):i===3&&(t.getContext&&typeof l>"u"?(l=r,r=void 0):(l=r,r=s,s=t,t=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(s=t,t=r=void 0):i===2&&!t.getContext&&(r=s,s=t,t=void 0),new Promise(function(c,d){try{const x=eu.create(s,r);c(e(x,t,r))}catch(x){d(x)}})}try{const c=eu.create(s,r);l(null,e(c,t,r))}catch(c){l(c)}}Yl.create=eu.create;Yl.toCanvas=im.bind(null,ux.render);Yl.toDataURL=im.bind(null,ux.renderToDataURL);Yl.toString=im.bind(null,function(e,t,s){return d1.render(e,s)});const u1={};function mx(e,t){let s;try{s=e()}catch{return}return{getItem:l=>{var a;const i=c=>c===null?null:JSON.parse(c,void 0),o=(a=s.getItem(l))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(l,a)=>s.setItem(l,JSON.stringify(a,void 0)),removeItem:l=>s.removeItem(l)}}const ti=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(r){return ti(r)(s)},catch(r){return this}}}catch(s){return{then(r){return this},catch(r){return ti(r)(s)}}}},m1=(e,t)=>(s,r,l)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:P=>P,version:0,merge:(P,v)=>({...v,...P}),...t},i=!1;const o=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return e((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...P)},r,l);const x=ti(a.serialize),S=()=>{const P=a.partialize({...r()});let v;const h=x({state:P,version:a.version}).then(b=>d.setItem(a.name,b)).catch(b=>{v=b});if(v)throw v;return h},y=l.setState;l.setState=(P,v)=>{y(P,v),S()};const N=e((...P)=>{s(...P),S()},r,l);let w;const T=()=>{var P;if(!d)return;i=!1,o.forEach(h=>h(r()));const v=((P=a.onRehydrateStorage)==null?void 0:P.call(a,r()))||void 0;return ti(d.getItem.bind(d))(a.name).then(h=>{if(h)return a.deserialize(h)}).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==a.version){if(a.migrate)return a.migrate(h.state,h.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return h.state}).then(h=>{var b;return w=a.merge(h,(b=r())!=null?b:N),s(w,!0),S()}).then(()=>{v==null||v(w,void 0),i=!0,c.forEach(h=>h(w))}).catch(h=>{v==null||v(void 0,h)})};return l.persist={setOptions:P=>{a={...a,...P},P.getStorage&&(d=P.getStorage())},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>T(),hasHydrated:()=>i,onHydrate:P=>(o.add(P),()=>{o.delete(P)}),onFinishHydration:P=>(c.add(P),()=>{c.delete(P)})},T(),w||N},f1=(e,t)=>(s,r,l)=>{let a={storage:mx(()=>localStorage),partialize:T=>T,version:0,merge:(T,P)=>({...P,...T}),...t},i=!1;const o=new Set,c=new Set;let d=a.storage;if(!d)return e((...T)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),s(...T)},r,l);const x=()=>{const T=a.partialize({...r()});return d.setItem(a.name,{state:T,version:a.version})},S=l.setState;l.setState=(T,P)=>{S(T,P),x()};const y=e((...T)=>{s(...T),x()},r,l);l.getInitialState=()=>y;let N;const w=()=>{var T,P;if(!d)return;i=!1,o.forEach(h=>{var b;return h((b=r())!=null?b:y)});const v=((P=a.onRehydrateStorage)==null?void 0:P.call(a,(T=r())!=null?T:y))||void 0;return ti(d.getItem.bind(d))(a.name).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==a.version){if(a.migrate)return[!0,a.migrate(h.state,h.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,h.state];return[!1,void 0]}).then(h=>{var b;const[C,j]=h;if(N=a.merge(j,(b=r())!=null?b:y),s(N,!0),C)return x()}).then(()=>{v==null||v(N,void 0),N=r(),i=!0,c.forEach(h=>h(N))}).catch(h=>{v==null||v(void 0,h)})};return l.persist={setOptions:T=>{a={...a,...T},T.storage&&(d=T.storage)},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>i,onHydrate:T=>(o.add(T),()=>{o.delete(T)}),onFinishHydration:T=>(c.add(T),()=>{c.delete(T)})},a.skipHydration||w(),N||y},h1=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((u1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),m1(e,t)):f1(e,t),p1=h1,om=Jl()(p1((e,t)=>({H:null,createdAt:null,errorPx:null,imageSize:null,anchors:null,locked:!1,setCalibration:s=>e(r=>({...r,...s})),reset:()=>e({H:null,createdAt:null,errorPx:null,imageSize:null,anchors:null,locked:!1})}),{name:"ndn-calibration-v1",storage:mx(()=>localStorage),onRehydrateStorage:()=>e=>{try{if(!get().H){const s=localStorage.getItem("ndn:calibration:v1");if(s){const r=JSON.parse(s);r&&(r.H||r.imageSize)&&set({H:r.H??null,createdAt:r.createdAt??null,errorPx:r.errorPx??null,imageSize:r.imageSize??null,anchors:r.anchors??null,locked:!!r.locked})}}}catch{}}})),Je={bullInner:6.35,bullOuter:15.9,trebleInner:99,trebleOuter:107,doubleInner:162,doubleOuter:170},x1=[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5];function cm(e,t){const s=t.x,r=t.y,l=e[6]*s+e[7]*r+e[8],a=(e[0]*s+e[1]*r+e[2])/l,i=(e[3]*s+e[4]*r+e[5])/l;return{x:a,y:i}}function g1(e,t,s){return[t*e[0],t*e[1],t*e[2],s*e[3],s*e[4],s*e[5],e[6],e[7],e[8]]}function y1(e){const t=e,s=t[0],r=t[1],l=t[2],a=t[3],i=t[4],o=t[5],c=t[6],d=t[7],x=t[8],S=i*x-o*d,y=l*d-r*x,N=r*o-l*i,w=o*c-a*x,T=s*x-l*c,P=l*a-s*o,v=a*d-i*c,h=r*c-s*d,b=s*i-r*a,C=s*S+r*w+l*v;if(Math.abs(C)<1e-12)throw new Error("Singular homography");return[S/C,y/C,N/C,w/C,T/C,P/C,v/C,h/C,b/C]}function v1(e,t){if(e.length!==4||t.length!==4)throw new Error("Need exactly 4 correspondences");const s=[],r=[];for(let i=0;i<4;i++){const{x:o,y:c}=e[i],{x:d,y:x}=t[i];s.push([o,c,1,0,0,0,-d*o,-d*c]),r.push(d),s.push([0,0,0,o,c,1,-x*o,-x*c]),r.push(x)}const l=b1(s,r);return[l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],1]}function b1(e,t){const s=e.length,r=e[0].length,l=Array.from({length:r},()=>new Array(r).fill(0)),a=new Array(r).fill(0);for(let i=0;i<s;i++)for(let o=0;o<r;o++){a[o]+=e[i][o]*t[i];for(let c=0;c<r;c++)l[o][c]+=e[i][o]*e[i][c]}return N1(l,a)}function N1(e,t){const s=t.length,r=e.map((a,i)=>a.concat([t[i]]));for(let a=0;a<s;a++){let i=a;for(let o=a+1;o<s;o++)Math.abs(r[o][a])>Math.abs(r[i][a])&&(i=o);if(Math.abs(r[i][a])<1e-12)throw new Error("Singular matrix");if(i!==a){const o=r[a];r[a]=r[i],r[i]=o}for(let o=a+1;o<s;o++){const c=r[o][a]/r[a][a];for(let d=a;d<=s;d++)r[o][d]-=c*r[a][d]}}const l=new Array(s).fill(0);for(let a=s-1;a>=0;a--){let i=r[a][s];for(let o=a+1;o<s;o++)i-=r[a][o]*l[o];l[a]=i/r[a][a]}return l}function w1(){const e=Je.doubleOuter;return[{x:0,y:-e},{x:e,y:0},{x:0,y:e},{x:-e,y:0}]}function fx(e,t,s=256){const r=[];for(let l=0;l<s;l++){const a=l/s*Math.PI*2,i=cm(e,{x:t*Math.cos(a),y:t*Math.sin(a)});r.push(i)}return r}function j1(e,t,s){let r=0;for(let l=0;l<t.length;l++){const a=cm(e,t[l]),i=a.x-s[l].x,o=a.y-s[l].y;r+=i*i+o*o}return Math.sqrt(r/t.length)}function S1(e,t){const s=y1(e);return cm(s,t)}function k1(e){const t=Math.hypot(e.x,e.y);let r=Math.atan2(e.y,e.x)*180/Math.PI;r=(r+360+90)%360;const l=x1[Math.floor((360-r)%360/18)];return t<=Je.bullInner?{base:50,ring:"INNER_BULL",sector:25,mult:2}:t<=Je.bullOuter?{base:25,ring:"BULL",sector:25,mult:1}:t>=Je.doubleOuter?{base:0,ring:"MISS",sector:null,mult:0}:t>=Je.doubleInner?{base:l*2,ring:"DOUBLE",sector:l,mult:2}:t>=Je.trebleOuter?{base:l,ring:"SINGLE",sector:l,mult:1}:t>=Je.trebleInner?{base:l*3,ring:"TRIPLE",sector:l,mult:3}:{base:l,ring:"SINGLE",sector:l,mult:1}}function hx(e,t,s="#10b981",r=2){if(t.length){e.save(),e.strokeStyle=s,e.lineWidth=r,e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let l=1;l<t.length;l++)e.lineTo(t[l].x,t[l].y);e.closePath(),e.stroke(),e.restore()}}function C1(e,t,s="#f59e0b"){e.save(),e.strokeStyle=s,e.lineWidth=2,e.beginPath(),e.moveTo(t.x-8,t.y),e.lineTo(t.x+8,t.y),e.moveTo(t.x,t.y-8),e.lineTo(t.x,t.y+8),e.stroke(),e.restore()}function Mo(e,t,s){return Math.max(t,Math.min(s,e))}function E1(e,t,s){const{width:r,data:l}=e,a=[[-1,0,1],[-2,0,2],[-1,0,1]],i=[[-1,-2,-1],[0,0,0],[1,2,1]];let o=0,c=0;for(let d=-1;d<=1;d++)for(let x=-1;x<=1;x++){const S=Mo(t+x,0,r-1),N=(Mo(s+d,0,e.height-1)*r+S)*4,w=l[N],T=l[N+1],P=l[N+2],v=.299*w+.587*T+.114*P;o+=v*a[d+1][x+1],c+=v*i[d+1][x+1]}return Math.hypot(o,c)}function T1(e,t,s=6){const l=e.getContext("2d").getImageData(0,0,e.width,e.height),a=Mo(Math.round(t.x),1,e.width-2),i=Mo(Math.round(t.y),1,e.height-2);let o={x:a,y:i,mag:-1};for(let c=i-s;c<=i+s;c++)for(let d=a-s;d<=a+s;d++){if(d<=0||c<=0||d>=e.width-1||c>=e.height-1)continue;const x=E1(l,d,c);x>o.mag&&(o={x:d,y:c,mag:x})}return{x:o.x,y:o.y}}function I1(e,t,s=6){return t.map(r=>T1(e,r,s))}const dl={};function D1(){const e=m.useRef(null),t=m.useRef(null),s=m.useRef(null),r=m.useRef(null),[l,a]=m.useState(!1),[i,o]=m.useState("camera"),[c,d]=m.useState(()=>localStorage.getItem("ndn:cal:mode")||"local"),[x,S]=m.useState([]),[y,N]=m.useState(!1),[w,T]=m.useState(null),[P,v]=m.useState(1),{H:h,setCalibration:b,reset:C,errorPx:j,locked:f}=om(),{calibrationGuide:R,setCalibrationGuide:B}=Yn(),[ee,Y]=m.useState(null),[$,Q]=m.useState(!1),[D,z]=m.useState(0),[de,I]=m.useState(null),[G,W]=m.useState(null),[X,Z]=m.useState(null),[ie,J]=m.useState(Date.now()),[me,pe]=m.useState(!1),[Me,Ne]=m.useState(null),[Le,ke]=m.useState(""),[$e,ue]=m.useState(null),[xe,Re]=m.useState(null),[ct,nt]=m.useState(!0);m.useEffect(()=>{const ne=window.location.hostname;(ne==="localhost"||ne==="127.0.0.1")&&fetch("/api/hosts").then(le=>le.json()).then(le=>{const oe=Array.isArray(le==null?void 0:le.hosts)&&le.hosts.find(se=>se);oe&&ue(oe)}).catch(()=>{}),fetch("/api/https-info").then(le=>le.json()).then(le=>{le&&typeof le.https=="boolean"&&Re({https:!!le.https,port:Number(le.port)||8788})}).catch(()=>{})},[]),m.useEffect(()=>{c==="phone"&&!me&&!l&&ze()},[c]);const Ft=m.useMemo(()=>{const ne=G||"____",le=dl==null?void 0:dl.VITE_WS_URL;if(le&&le.length>0)try{const ve=new URL(le);return`${`${ve.protocol==="wss:"?"https":"http"}://${ve.host}${ve.pathname.endsWith("/ws")?"":ve.pathname}`.replace(/\/?ws$/i,"")}/mobile-cam.html?code=${ne}`}catch{}const oe=$e||window.location.hostname,se=!!(xe!=null&&xe.https),K=se?(xe==null?void 0:xe.port)||8788:8787;return`${se?"https":"http"}://${oe}:${K}/mobile-cam.html?code=${ne}`},[G,$e,xe]);m.useEffect(()=>{localStorage.setItem("ndn:cal:mode",c)},[c]),m.useEffect(()=>{if(!G){ke("");return}Yl.toDataURL(Ft,{width:160,margin:1,color:{dark:"#000000",light:"#ffffff"}}).then(ke).catch(()=>ke(""))},[Ft,G]),m.useEffect(()=>{if(!X)return;const ne=setInterval(()=>J(Date.now()),1e3);return()=>clearInterval(ne)},[X]);const M=m.useMemo(()=>X?Math.max(0,Math.ceil((X-ie)/1e3)):null,[X,ie]);m.useEffect(()=>{M!==null&&M<=0&&!me&&!l&&c==="phone"&&Mt()},[M,me,l,c]),m.useEffect(()=>()=>et(),[]);function O(){if(de&&de.readyState===WebSocket.OPEN)return de;const ne=dl==null?void 0:dl.VITE_WS_URL,le=ne&&ne.length>0?ne.endsWith("/ws")?ne:ne.replace(/\/$/,"")+"/ws":void 0,oe=window.location.protocol==="https:"?"wss":"ws",se=`${oe}://${window.location.host}/ws`,K=window.location.hostname,Oe=[se,`${oe}://${K}:8787/ws`,`${oe}://${K}:3000/ws`],ve=le||Oe[0];let We=new WebSocket(ve);return I(We),We}async function ze(){pe(!1);const ne=O();ne.readyState===WebSocket.OPEN?ne.send(JSON.stringify({type:"cam-create"})):ne.onopen=()=>ne.send(JSON.stringify({type:"cam-create"})),ne.onerror=le=>{console.error("WebSocket connection error:",le),alert("Failed to connect to camera pairing service. Please check your internet connection and try again."),pe(!1),a(!1),o("camera")},ne.onclose=le=>{console.log("WebSocket closed:",le.code,le.reason),pe(!1),a(!1),o("camera"),Me&&(Me.close(),Ne(null)),le.code!==1e3&&alert("Camera pairing connection lost. Please try pairing again.")},ne.onmessage=async le=>{const oe=JSON.parse(le.data);if(oe.type==="cam-code")W(oe.code),oe.expiresAt&&Z(oe.expiresAt);else if(oe.type==="cam-peer-joined"){pe(!0);const se=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}],iceCandidatePoolSize:10});Ne(se),se.onconnectionstatechange=()=>{console.log("WebRTC connection state:",se.connectionState),se.connectionState==="failed"||se.connectionState==="disconnected"?(console.error("WebRTC connection failed"),alert("Camera connection lost. Please try pairing again."),et()):se.connectionState==="connected"&&console.log("WebRTC connection established")},se.onicecandidate=K=>{K.candidate&&G&&ne.send(JSON.stringify({type:"cam-ice",code:G,payload:K.candidate}))},se.ontrack=K=>{var Oe;if(e.current){const ve=(Oe=K.streams)==null?void 0:Oe[0];ve&&(e.current.srcObject=ve,e.current.play().catch(We=>{console.error("Video play failed:",We),alert("Failed to start video playback. Please check your browser settings.")}),a(!0),o("capture"))}};try{const K=await se.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!0});await se.setLocalDescription(K),G&&ne.send(JSON.stringify({type:"cam-offer",code:G,payload:K}))}catch(K){console.error("Failed to create WebRTC offer:",K),alert("Failed to establish camera connection. Please try again."),et()}}else if(oe.type==="cam-answer"){if(Me)try{await Me.setRemoteDescription(new RTCSessionDescription(oe.payload))}catch(se){console.error("Failed to set remote description:",se),alert("Camera pairing failed. Please try again."),et()}}else if(oe.type==="cam-ice"){if(Me)try{await Me.addIceCandidate(oe.payload)}catch(se){console.error("Failed to add ICE candidate:",se)}}else oe.type==="cam-error"&&(console.error("Camera pairing error:",oe.code),alert(oe.code==="EXPIRED"?"Code expired. Generate a new code.":`Camera error: ${oe.code||"Unknown error"}`),et())}}async function Xe(){if(c==="phone")return ze();try{const ne=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1});e.current&&(e.current.srcObject=ne,await e.current.play()),a(!0),o("capture")}catch(ne){console.error("Camera access failed:",ne),alert(`Camera access failed: ${ne instanceof Error?ne.message:"Unknown error"}. Try refreshing the page or check camera permissions.`)}}function et(){if(e.current&&e.current.srcObject&&(e.current.srcObject.getTracks().forEach(le=>le.stop()),e.current.srcObject=null,a(!1)),Me){try{Me.close()}catch{}Ne(null)}W(null),Z(null),pe(!1)}function Mt(){W(null),Z(null),pe(!1),de&&de.readyState===WebSocket.OPEN?de.send(JSON.stringify({type:"cam-create"})):ze()}function St(){var ne;try{(ne=r.current)==null||ne.click()}catch{}}function Ze(ne){var se;const le=(se=ne.target.files)==null?void 0:se[0];if(!le)return;const oe=new Image;oe.onload=()=>{try{if(!t.current)return;const K=t.current;K.width=oe.naturalWidth,K.height=oe.naturalHeight,K.getContext("2d").drawImage(oe,0,0,K.width,K.height),N(!0),T({w:K.width,h:K.height}),o("select"),S([]),et()}catch{}},oe.onerror=()=>{alert("Could not load image. Please try a different photo.")},oe.src=URL.createObjectURL(le);try{ne.target.value=""}catch{}}function gt(){if(!e.current||!t.current)return;const ne=e.current,le=t.current;le.width=ne.videoWidth,le.height=ne.videoHeight,le.getContext("2d").drawImage(ne,0,0,le.width,le.height),N(!0),T({w:le.width,h:le.height}),o("select"),S([]),$&&setTimeout(()=>{xn()},0)}function dt(ne=x,le=null){if(!t.current||!s.current)return;const oe=t.current,se=s.current;se.width=oe.width,se.height=oe.height;const K=se.getContext("2d");K.clearRect(0,0,se.width,se.height),ne.forEach((ve,We)=>{C1(K,ve,"#f472b6"),K.save(),K.fillStyle="#f472b6",K.font="14px sans-serif",K.fillText(String(We+1),ve.x+6,ve.y-6),K.restore()});const Oe=le||h;if(Oe){const ve=[Je.bullInner,Je.bullOuter,Je.trebleInner,Je.trebleOuter,Je.doubleInner,Je.doubleOuter];for(const We of ve){const A=fx(Oe,We,360);hx(K,A,We===Je.doubleOuter?"#22d3ee":"#a78bfa",We===Je.doubleOuter?3:2)}}if(!Oe&&ee){const ve=(We,A,U=2)=>{K.save(),K.strokeStyle=A,K.lineWidth=U,K.beginPath(),K.arc(ee.cx,ee.cy,We,0,Math.PI*2),K.stroke(),K.restore()};ve(ee.doubleOuter,"#22d3ee",3),ve(ee.doubleInner,"#22d3ee",2),ve(ee.trebleOuter,"#fde047",2),ve(ee.trebleInner,"#fde047",2),ve(ee.bullOuter,"#34d399",2),ve(ee.bullInner,"#10b981",3)}if(R&&!f){K.save(),K.fillStyle="rgba(59,130,246,0.10)";const ve=Math.round(Math.min(se.width,se.height)*.08),We=se.width-ve*2,A=se.height-ve*2;K.fillRect(ve,ve,We,A),K.strokeStyle="rgba(34,197,94,0.9)",K.lineWidth=2,K.beginPath(),K.moveTo(ve,se.height/2),K.lineTo(se.width-ve,se.height/2),K.stroke(),K.beginPath(),K.moveTo(se.width/2,ve),K.lineTo(se.width/2,se.height-ve),K.stroke(),K.strokeStyle="rgba(234,179,8,0.9)",K.setLineDash([6,4]);const U=ve+30,ce=ve+30;K.beginPath(),K.moveTo(U,ce+30),K.lineTo(U+60,ce),K.stroke(),K.beginPath(),K.moveTo(se.width-U,ce+30),K.lineTo(se.width-U-60,ce),K.stroke(),K.restore(),K.save(),K.scale(1/P,1/P),K.fillStyle="rgba(255,255,255,0.85)",K.font="12px sans-serif",K.fillText("Tip: Frame board centered, edges parallel; slight top-down is okay. Keep bull near center.",ve*P,(ve+18)*P),K.restore()}}function yt(ne){if(i!=="select")return;const le=ne.target,oe=le.getBoundingClientRect(),se=ne.clientX-oe.left,K=ne.clientY-oe.top,Oe=le.width>0?le.width/oe.width:1,ve=le.height>0?le.height/oe.height:1,We=se*Oe,A=K*ve,U=[...x,{x:We,y:A}];U.length<=4&&(S(U),dt(U))}function on(){const ne=x.slice(0,-1);S(ne),dt(ne)}function qn(){if(!t.current||x.length===0)return;const ne=I1(t.current,x,8);S(ne),dt(ne)}function vt(){if(!t.current)return;if(x.length!==4)return alert("Please click 4 points: TOP, RIGHT, BOTTOM, LEFT corners of the double rim.");const ne=w1(),le=v1(ne,x);dt(x,le);const oe=j1(le,ne,x);b({H:le,createdAt:Date.now(),errorPx:oe,imageSize:{w:t.current.width,h:t.current.height},anchors:{src:ne,dst:x}}),o("computed")}function pn(){S([]),N(!1),o("camera"),dt([]),C()}async function xn(){if(!t.current)return alert("Load a photo or capture a frame first.");const ne=t.current,oe=Math.min(1,800/ne.width),se=Math.max(1,Math.round(ne.width*oe)),K=Math.max(1,Math.round(ne.height*oe)),Oe=document.createElement("canvas");Oe.width=se,Oe.height=K;const ve=Oe.getContext("2d");ve.drawImage(ne,0,0,se,K);const We=ve.getImageData(0,0,se,K),A=new Float32Array(se*K);for(let Ae=0,_e=0;Ae<We.data.length;Ae+=4,_e++){const He=We.data[Ae],kt=We.data[Ae+1],Ct=We.data[Ae+2];A[_e]=.299*He+.587*kt+.114*Ct}const U=new Float32Array(se*K),ce=new Float32Array(se*K);for(let Ae=1;Ae<K-1;Ae++)for(let _e=1;_e<se-1;_e++){const He=Ae*se+_e,kt=A[He-se-1],Ct=A[He-se],ut=A[He-se+1],mt=A[He-1],$t=A[He+1],qt=A[He+se-1],Br=A[He+se],es=A[He+se+1];U[He]=-kt-2*mt-qt+(ut+2*$t+es),ce[He]=-kt-2*Ct-ut+(qt+2*Br+es)}const je=new Float32Array(se*K);let ge=1;for(let Ae=0;Ae<je.length;Ae++){const _e=Math.hypot(U[Ae],ce[Ae]);je[Ae]=_e,_e>ge&&(ge=_e)}const Ce=Math.floor(se/2),he=Math.floor(K/2),Pe=Math.floor(Math.min(se,K)*.35),pt=Math.floor(Math.min(se,K)*.52);let Ve={score:-1,cx:Ce,cy:he,r:Math.floor((Pe+pt)/2)};const Lt=Math.max(2,Math.floor(Math.min(se,K)*.01)),Vt=Math.max(2,Math.floor(Math.min(se,K)*.01));for(let Ae=he-Math.floor(K*.08);Ae<=he+Math.floor(K*.08);Ae+=Lt)for(let _e=Ce-Math.floor(se*.08);_e<=Ce+Math.floor(se*.08);_e+=Lt)for(let He=Pe;He<=pt;He+=Vt){let kt=0;const Ct=360;for(let ut=0;ut<Ct;ut++){const mt=ut*Math.PI/180,$t=Math.round(_e+He*Math.cos(mt)),qt=Math.round(Ae+He*Math.sin(mt));$t<=0||$t>=se-1||qt<=0||qt>=K-1||(kt+=je[qt*se+$t])}kt>Ve.score&&(Ve={score:kt,cx:_e,cy:Ae,r:He})}const tn=1/oe,qe=Ve.cx*tn,Bn=Ve.cy*tn,rt=Ve.r*tn;function xs(Ae){let _e=0;const He=Ae*oe,kt=360;for(let Ct=0;Ct<kt;Ct++){const ut=Ct*Math.PI/180,mt=Math.round(Ve.cx+He*Math.cos(ut)),$t=Math.round(Ve.cy+He*Math.sin(ut));mt<=0||mt>=se-1||$t<=0||$t>=K-1||(_e+=je[$t*se+mt])}return _e}const gs={bullInner:Je.bullInner/Je.doubleOuter,bullOuter:Je.bullOuter/Je.doubleOuter,trebleInner:Je.trebleInner/Je.doubleOuter,trebleOuter:Je.trebleOuter/Je.doubleOuter,doubleInner:Je.doubleInner/Je.doubleOuter};function nn(Ae,_e=.1){const He=Math.max(1,Math.floor(Ae*(1-_e))),kt=Math.max(He+1,Math.floor(Ae*(1+_e)));let Ct=He,ut=-1;for(let mt=He;mt<=kt;mt++){const $t=xs(mt);$t>ut&&(ut=$t,Ct=mt)}return Ct}const cn=rt,Gt=nn(cn*gs.doubleInner),Ms=nn(cn*gs.trebleOuter),Ls=nn(cn*gs.trebleInner),Qn=nn(cn*gs.bullOuter),Pt=nn(cn*gs.bullInner);Y({cx:qe,cy:Bn,bullInner:Pt,bullOuter:Qn,trebleInner:Ls,trebleOuter:Ms,doubleInner:Gt,doubleOuter:cn});const At=Ae=>{let He=0;for(let kt=0;kt<180;kt++){const Ct=kt*Math.PI/90,ut=Math.round(Ve.cx+Ae*oe*Math.cos(Ct)),mt=Math.round(Ve.cy+Ae*oe*Math.sin(Ct));ut<=0||ut>=se-1||mt<=0||mt>=K-1||(He+=je[mt*se+ut])}return He/180},Ee=(At(Ve.r)+At(Ms)+At(Ls)+At(Gt)+At(Qn)+At(Pt))/(ge*6),Xn=Math.max(0,Math.min(1,Ee));z(Math.round(Xn*100));const Zn=[{x:qe,y:Bn-cn},{x:qe+cn,y:Bn},{x:qe,y:Bn+cn},{x:qe-cn,y:Bn}];S(Zn),dt(Zn);try{vt()}catch{}const Or=Xn>=.85;b({locked:Or})}m.useEffect(()=>{dt()},[y,h]),m.useEffect(()=>{if(!$||!l)return;let ne=0;const le=()=>{try{gt()}catch{}ne=requestAnimationFrame(le)};return ne=requestAnimationFrame(le),()=>cancelAnimationFrame(ne)},[$,l]);function Tt(){const{preferredCameraId:ne,preferredCameraLabel:le,setPreferredCamera:oe}=Yn(),[se,K]=m.useState([]),[Oe,ve]=m.useState("");async function We(){ve("");try{try{await navigator.mediaDevices.getUserMedia({video:!0})}catch{}const ce=(await navigator.mediaDevices.enumerateDevices()).filter(je=>je.kind==="videoinput");K(ce)}catch{ve("Unable to list cameras. Grant camera permission in your browser.")}}m.useEffect(()=>{We()},[]);const A=ne||"";return n.jsxs("div",{className:"mt-3 p-3 rounded-lg border border-indigo-500/30 bg-indigo-500/5",children:[n.jsx("div",{className:"font-semibold mb-2",children:"Select camera device"}),Oe&&n.jsx("div",{className:"text-rose-400 text-sm mb-2",children:Oe}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center text-sm",children:[n.jsx("div",{className:"col-span-2",children:n.jsxs("select",{className:"input w-full",value:A,onChange:U=>{var ge;const ce=U.target.value||void 0,je=((ge=se.find(Ce=>Ce.deviceId===ce))==null?void 0:ge.label)||"";oe(ce,je)},children:[n.jsx("option",{value:"",children:"Auto (browser default)"}),se.map(U=>{var ce,je;return n.jsxs("option",{value:U.deviceId,children:[U.label||"Camera"," ",(ce=U.label)!=null&&ce.toLowerCase().includes("omni")?"(OMNI)":""," ",(je=U.label)!=null&&je.toLowerCase().includes("vert")?"(VERT)":""]},U.deviceId)})]})}),n.jsx("div",{className:"text-right",children:n.jsx("button",{className:"btn px-2 py-1",onClick:We,children:"Refresh"})})]}),le&&n.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["Selected: ",le]}),n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Tip: OMNI and VERT cameras are supportedselect them here and then open Calibrator to align."})]})}return n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{className:"card",children:[n.jsx(Tt,{}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Board Calibrator"}),n.jsx("p",{className:"text-sm opacity-80 mb-3",children:"Click the four points where the outer edge of the double ring touches TOP, RIGHT, BOTTOM, LEFT. Then compute to fit the board overlay. Aim for error < 2px for best accuracy."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3 mb-2 items-start",children:[n.jsxs("div",{className:"md:col-span-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-xs opacity-70",children:"Video Source:"}),n.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[n.jsx("button",{className:`btn px-2 py-1 ${c==="local"?"bg-emerald-600":"bg-gray-600"} ${l?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!l&&d("local"),disabled:l,title:l?"Stop camera first to change mode":"Use local device camera",children:"Local"}),n.jsx("button",{className:`btn px-2 py-1 ${c==="phone"?"bg-emerald-600":"bg-gray-600"} ${l?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!l&&d("phone"),disabled:l,title:l?"Stop camera first to change mode":"Pair with phone camera",children:"Phone"})]}),l&&n.jsxs("span",{className:"text-xs opacity-60 ml-2",children:["(",c==="local"?"Local Camera Active":"Phone Camera Paired",")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[n.jsx("span",{className:"opacity-70",children:"View Zoom"}),n.jsx("input",{type:"range",min:50,max:200,step:5,value:Math.round((P||1)*100),onChange:ne=>v(Math.max(.5,Math.min(2,Number(ne.target.value)/100)))}),n.jsxs("span",{className:"w-10 text-center",children:[Math.round((P||1)*100),"%"]}),n.jsx("button",{className:"btn px-2 py-0.5",onClick:()=>v(1),children:"Actual"})]}),n.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[n.jsxs("label",{className:"inline-flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",className:"accent-indigo-600",checked:$,onChange:ne=>Q(ne.target.checked)})," Live auto-detect"]}),n.jsxs("span",{className:`px-2 py-0.5 rounded-full border ${D>=85?"bg-emerald-500/15 border-emerald-400/30":"bg-white/10 border-white/20"}`,children:["Confidence: ",D,"%"]})]}),n.jsxs("label",{className:"mt-2 flex items-center gap-2 text-xs",children:[n.jsx("input",{type:"checkbox",className:"accent-indigo-600",checked:R,onChange:ne=>B(ne.target.checked)}),"Show preferred-view guide overlay"]}),n.jsxs("div",{className:"flex flex-col gap-2 mt-3",children:[l?n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:et,children:"Stop Camera"}),n.jsx("button",{className:"btn",onClick:gt,disabled:!l,children:"Capture Frame"})]}):n.jsx("button",{className:"btn",onClick:Xe,children:c==="local"?"Start Camera":"Pair Phone Camera"}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("input",{ref:r,type:"file",accept:"image/*",className:"hidden",onChange:Ze}),n.jsx("button",{className:"btn",onClick:St,children:"Upload Photo"}),n.jsx("button",{className:"btn",disabled:!y,onClick:xn,children:"Auto Detect"})]}),n.jsx("button",{className:"btn",disabled:x.length!==4,onClick:vt,children:"Compute"}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("button",{className:`btn ${f?"bg-emerald-600 hover:bg-emerald-700":""}`,onClick:()=>b({locked:!f}),children:f?"Unlock":"Lock In"}),f&&n.jsxs("span",{className:"text-xs opacity-80",children:["Calibration saved",j!=null?`  error ${j.toFixed(2)}px`:""]})]}),n.jsx("button",{className:"btn",disabled:x.length===0,onClick:on,children:"Undo"}),n.jsx("button",{className:"btn",disabled:x.length===0,onClick:qn,children:"Refine Points"}),n.jsx("button",{className:"btn",onClick:pn,children:"Reset"})]})]}),n.jsx("div",{className:"md:col-span-8 flex items-center justify-end",children:n.jsxs("div",{className:"relative w-full max-w-[min(100%,60vh)] rounded-2xl overflow-hidden border border-indigo-400/30 bg-black flex items-center justify-center",style:{aspectRatio:w?`${w.w} / ${w.h}`:"16 / 9"},children:[!l&&n.jsx(jb,{calibrationComplete:i==="computed"}),n.jsxs("div",{className:"absolute inset-0",style:{transform:`scale(${P||1})`,transformOrigin:"center center"},children:[n.jsx("video",{ref:e,onLoadedMetadata:ne=>{try{const le=ne.currentTarget;le.videoWidth&&le.videoHeight&&T({w:le.videoWidth,h:le.videoHeight})}catch{}},className:`absolute inset-0 w-full h-full ${y?"opacity-0 -z-10":"opacity-100"}`}),n.jsx("canvas",{ref:t,className:`absolute inset-0 w-full h-full ${y?"opacity-100":"opacity-0 -z-10"}`}),n.jsx("canvas",{ref:s,onClick:yt,className:"absolute inset-0 w-full h-full"})]})]})})]}),c==="phone"&&!l&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-black/40 border border-white/10 text-white text-xs",children:[n.jsx("div",{children:"Open on your phone:"}),n.jsx("div",{className:"font-mono break-all",children:Ft}),n.jsxs("div",{className:"mt-1 opacity-80",children:["WS: ",de?de.readyState===1?"open":de.readyState===0?"connecting":de.readyState===2?"closing":"closed":"not started","  ",xe!=null&&xe.https?"HTTPS on":"HTTP only"]}),G&&n.jsxs("div",{children:["Code: ",n.jsx("span",{className:"font-mono",children:G})]}),Le&&n.jsx("img",{className:"mt-1 w-[160px] h-[160px] bg-white rounded",alt:"Scan to open",src:Le}),n.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[M!==null&&n.jsxs("span",{children:["Expires in ",M,"s"]}),n.jsx("button",{className:"btn px-2 py-1 text-xs",onClick:Mt,children:"Regenerate"})]}),ct&&n.jsxs("div",{className:"mt-2 p-2 rounded bg-slate-900/60 border border-slate-700/50 text-slate-200",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Troubleshooting"}),n.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[n.jsx("li",{children:"Phone and desktop must be on the same WiFi network."}),n.jsxs("li",{children:["Allow the server through your firewall (ports 8787 and ",xe!=null&&xe.https?xe.port:8788,")."]}),n.jsx("li",{children:"On iPhone, use HTTPS links (QR will prefer https when enabled)."})]}),n.jsx("div",{className:"mt-2 text-right",children:n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>nt(!1),children:"Hide tips"})})]})]}),n.jsxs("div",{className:"mt-2 text-sm opacity-80",children:[n.jsxs("div",{children:["Phase: ",i]}),n.jsxs("div",{children:["Clicked: ",x.length," / 4"]}),j!=null&&n.jsxs("div",{children:["Fit error: ",j.toFixed(2)," px"]})]})]})})}const M1=["D1","D2","D3","D4","D5","D6","D7","D8","D9","D10","D11","D12","D13","D14","D15","D16","D17","D18","D19","D20","DB"];function L1(e){return e==="DB"?50:Number(e.slice(1))*2}function P1(e){return M1.includes(e)?L1(e):32}function Lo(e,t="D16"){if(e>170||e<=1)return[];const s={170:["T20 T20 DB"],167:["T20 T19 DB"],164:["T20 T18 DB"],161:["T20 T17 DB"],160:["T20 T20 D20"],158:["T20 T20 D19"],157:["T20 T19 D20"],156:["T20 T20 D18"],155:["T20 T19 D19"],154:["T20 T18 D20"],153:["T20 T19 D18"],152:["T20 T20 D16"],151:["T20 T17 D20"],150:["T20 T18 D18"],149:["T20 T19 D16"],148:["T20 T16 D20"],147:["T20 T17 D18"],146:["T20 T18 D16"],145:["T20 T15 D20"],144:["T20 T20 D12"],141:["T20 T19 D12"],140:["T20 T20 D10"],137:["T20 T19 D10"],136:["T20 T20 D8"],132:["BULL T14 D20","T20 T12 D8"],130:["T20 T20 D5","T20 T18 D8"],129:["T19 T16 D12"],128:["T18 T14 D16"],127:["T20 T17 D8"],126:["T19 T19 D6"],121:["T20 11 D20","T20 T15 D8"],120:["T20 20 D20","T20 S20 D20"],110:["T20 10 D20"],100:["T20 D20"],99:["T19 10 D16","T19 S10 D16"],97:["T19 D20"],96:["T20 D18"],95:["T19 D19"],94:["T18 D20"],92:["T20 D16"],90:["T18 D18","T20 D15"],86:["T18 D16"],84:["T20 D12","T16 D18"],82:["BULL D16","T14 D20"],81:["T19 D12"],80:["T20 D10","D20 D20"],78:["T18 D12"],76:["T20 D8","T16 D14"],74:["T14 D16","T18 D10"],72:["T16 D12","T20 D6"],70:["T18 D8","S20 BULL"],68:["T20 D4","T16 D10"],66:["T10 D18","T14 D12"],64:["T16 D8","D16 D16"],62:["T10 D16","T12 D13"],60:["20 D20","S20 D20"],58:["18 D20","S18 D20"],56:["16 D20","S16 D20"],54:["14 D20","S14 D20"],52:["20 D16","S20 D16"],50:["BULL","10 D20"],48:["16 D16","S16 D16"],46:["14 D16"],44:["12 D16"],42:["10 D16"],40:["D20"],38:["D19"],36:["D18"],34:["D17"],32:["D16"],30:["D15"],28:["D14"],26:["D13"],24:["D12"],22:["D11"],20:["D10"],18:["D9"],16:["D8"],14:["D7"],12:["D6"],10:["D5"],8:["D4"],6:["D3"],4:["D2"],2:["D1"]};if(s[e])return s[e];const r=P1(t),l=[];for(const a of[60,57,54,51,48])if(e-a===r){l.push(`T${a/3} ${t}`);break}if(!l.length){for(const a of[20,19,18,17,16,15])if(e-a===r){l.push(`${a} ${t}`);break}}return l}function so(e,t,s,r,l){try{const a=window.speechSynthesis;if(!a)return;const i=new SpeechSynthesisUtterance,o=s<=170&&s>0;if(l!=null&&l.checkoutOnly&&!o)return;if(i.text=o?`${e}, you have ${s} remaining.`:`${t}`,r){const c=a.getVoices().find(d=>d.name===r);c&&(i.voice=c)}typeof(l==null?void 0:l.volume)=="number"&&(i.volume=Math.max(0,Math.min(1,l.volume))),i.rate=1,i.pitch=1,a.speak(i)}catch{}}const ul={};function Po({label:e,autoStart:t=!1,scale:s}){const r=m.useRef(null),[l,a]=m.useState(!1),[i,o]=m.useState(null),[c,d]=m.useState(null),[x,S]=m.useState(null),[y,N]=m.useState(()=>localStorage.getItem("ndn:camera:mode")||"local"),[w,T]=m.useState(null),[P,v]=m.useState(Date.now()),[h,b]=m.useState(!1),[C,j]=m.useState(null),[f,R]=m.useState(null),[B,ee]=m.useState(!0);m.useEffect(()=>{const Z=window.location.hostname;(Z==="localhost"||Z==="127.0.0.1")&&fetch("/api/hosts").then(ie=>ie.json()).then(ie=>{const J=Array.isArray(ie==null?void 0:ie.hosts)&&ie.hosts.find(me=>me);J&&j(J)}).catch(()=>{}),fetch("/api/https-info").then(ie=>ie.json()).then(ie=>{ie&&typeof ie.https=="boolean"&&R({https:!!ie.https,port:Number(ie.port)||8788})}).catch(()=>{})},[]);const Y=m.useMemo(()=>{const Z=c||"____",ie=ul==null?void 0:ul.VITE_WS_URL;if(ie&&ie.length>0)try{const Ne=new URL(ie);return`${`${Ne.protocol==="wss:"?"https":"http"}://${Ne.host}${Ne.pathname.endsWith("/ws")?"":Ne.pathname}`.replace(/\/?ws$/i,"")}/mobile-cam.html?code=${Z}`}catch{}const J=C||window.location.hostname,me=!!(f!=null&&f.https),pe=me?(f==null?void 0:f.port)||8788:8787;return`${me?"https":"http"}://${J}:${pe}/mobile-cam.html?code=${Z}`},[c,C,f]);m.useEffect(()=>{localStorage.setItem("ndn:camera:mode",y)},[y]);const[$,Q]=m.useState("");m.useEffect(()=>{if(!c){Q("");return}Yl.toDataURL(Y,{width:160,margin:1,color:{dark:"#000000",light:"#ffffff"}}).then(Q).catch(()=>Q(""))},[Y,c]),m.useEffect(()=>{if(!w)return;const Z=setInterval(()=>v(Date.now()),1e3);return()=>clearInterval(Z)},[w]);const D=m.useMemo(()=>w?Math.max(0,Math.ceil((w-P)/1e3)):null,[w,P]);m.useEffect(()=>{D!==null&&D<=0&&!h&&!l&&y==="phone"&&W()},[D,h,l,y]),m.useEffect(()=>{if(t)return z().catch(()=>{}),()=>de()},[t]);async function z(){var Z,ie,J;try{const{preferredCameraId:me,setPreferredCamera:pe}=Yn.getState(),Me=me?{video:{deviceId:{exact:me}},audio:!1}:{video:!0,audio:!1};let Ne;try{Ne=await navigator.mediaDevices.getUserMedia(Me)}catch(Le){const ke=Le&&(Le.name||Le.code)||"";if(me&&(ke==="OverconstrainedError"||ke==="NotFoundError"))Ne=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});else throw Le}r.current&&(r.current.srcObject=Ne,await r.current.play(),a(!0));try{const Le=await navigator.mediaDevices.enumerateDevices(),ke=(((Z=Ne.getVideoTracks)==null?void 0:Z.call(Ne))||[])[0],$e=(ie=ke==null?void 0:ke.getSettings)==null?void 0:ie.call(ke),ue=$e==null?void 0:$e.deviceId;if(ue){const xe=(J=Le.find(Re=>Re.deviceId===ue))==null?void 0:J.label;pe(ue,xe||"")}}catch{}}catch{}}function de(){r.current&&r.current.srcObject&&(r.current.srcObject.getTracks().forEach(ie=>ie.stop()),r.current.srcObject=null,a(!1))}function I(){if(i&&i.readyState===WebSocket.OPEN)return i;const Z=ul==null?void 0:ul.VITE_WS_URL,ie=Z&&Z.length>0?Z.endsWith("/ws")?Z:Z.replace(/\/$/,"")+"/ws":void 0,J=window.location.protocol==="https:"?"wss":"ws",me=`${J}://${window.location.host}/ws`,pe=window.location.hostname,Me=[me,`${J}://${pe}:8787/ws`,`${J}://${pe}:3000/ws`],Ne=ie||Me[0],Le=new WebSocket(Ne);return o(Le),Le}async function G(){N("phone"),b(!1);const Z=I();Z.readyState===WebSocket.OPEN?Z.send(JSON.stringify({type:"cam-create"})):Z.onopen=()=>Z.send(JSON.stringify({type:"cam-create"})),Z.onmessage=async ie=>{const J=JSON.parse(ie.data);if(J.type==="cam-code")d(J.code),J.expiresAt&&T(J.expiresAt);else if(J.type==="cam-peer-joined"){b(!0);const me=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});S(me),me.onicecandidate=Me=>{Me.candidate&&c&&Z.send(JSON.stringify({type:"cam-ice",code:c,payload:Me.candidate}))},me.ontrack=Me=>{var Ne;if(r.current){const Le=(Ne=Me.streams)==null?void 0:Ne[0];Le&&(r.current.srcObject=Le,r.current.play().catch(()=>{}),a(!0))}};const pe=await me.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!0});await me.setLocalDescription(pe),c&&Z.send(JSON.stringify({type:"cam-offer",code:c,payload:pe}))}else if(J.type==="cam-answer")x&&await x.setRemoteDescription(new RTCSessionDescription(J.payload));else if(J.type==="cam-ice"&&x)try{await x.addIceCandidate(J.payload)}catch{}}}function W(){d(null),T(null),b(!1),i&&i.readyState===WebSocket.OPEN?i.send(JSON.stringify({type:"cam-create"})):G()}function X(){if(de(),d(null),b(!1),T(null),x){try{x.close()}catch{}S(null)}}return n.jsx(A1,{label:e,autoStart:t,start:z,stopAll:X,startPhonePairing:G,videoRef:r,streaming:l,mode:y,setMode:N,pairCode:c,mobileUrl:Y,ttl:D,qrDataUrl:$,regenerateCode:W,httpsInfo:f,showTips:B,setShowTips:ee,scaleOverride:s})}function A1(e){const{cameraScale:t}=Yn(),s=Math.max(.5,Math.min(1.25,Number(e.scaleOverride??t??1))),{label:r,start:l,stopAll:a,startPhonePairing:i,videoRef:o,streaming:c,mode:d,setMode:x,pairCode:S,mobileUrl:y,ttl:N,qrDataUrl:w,regenerateCode:T,httpsInfo:P,showTips:v,setShowTips:h}=e;return n.jsxs("div",{className:"rounded-2xl overflow-hidden bg-black w-full mx-auto",style:{aspectRatio:"16 / 9",transform:`scale(${s})`,transformOrigin:"center"},children:[n.jsx("video",{ref:o,className:"w-full h-full object-contain object-center bg-black"}),n.jsxs("div",{className:"p-1 flex items-center justify-between bg-black/60 text-white text-[10px] gap-1",children:[n.jsx("span",{className:"truncate",children:r||(c?d==="phone"?"PHONE LIVE":"LIVE":"Camera")}),n.jsxs("div",{className:"flex items-center gap-1",children:[!c&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:`px-1 py-0.5 rounded ${d==="local"?"bg-emerald-600":"bg-slate-700"}`,onClick:()=>{x("local"),l()},children:"Local"}),n.jsx("button",{className:`px-1 py-0.5 rounded ${d==="phone"?"bg-emerald-600":"bg-slate-700"}`,onClick:i,children:"Phone"})]}),c?n.jsx("button",{className:"px-1 py-0.5 rounded bg-rose-600",onClick:a,children:"Stop"}):null]})]}),d==="phone"&&S&&!c&&n.jsxs("div",{className:"p-2 text-white text-[10px] bg-black/50",children:[n.jsx("div",{children:"Open on your phone:"}),n.jsx("div",{className:"font-mono",children:y}),n.jsxs("div",{children:["Code: ",n.jsx("span",{className:"font-mono",children:S})]}),w&&n.jsx("img",{className:"mt-1 w-[160px] h-[160px] bg-white rounded",alt:"Scan to open",src:w}),n.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[N!==null&&n.jsxs("span",{children:["Expires in ",N,"s"]}),n.jsx("button",{className:"px-1 py-0.5 rounded bg-slate-700",onClick:T,children:"Regenerate"})]}),v&&n.jsxs("div",{className:"mt-2 p-2 rounded bg-slate-900/60 border border-slate-700/50 text-slate-200",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Troubleshooting"}),n.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[n.jsx("li",{children:"Phone and desktop must be on the same WiFi network."}),n.jsxs("li",{children:["Allow the server through your firewall (ports 8787 and ",P!=null&&P.https?P.port:8788,")."]}),n.jsx("li",{children:"On iPhone, use HTTPS links (QR will prefer https when enabled)."})]}),n.jsx("div",{className:"mt-2 text-right",children:n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>h(!1),children:"Hide tips"})})]})]})]})}function R1(e){return e.dartsThrown===0?0:(e.totalScoreStart-e.totalScoreRemaining)/e.dartsThrown*3}function O1(e){const t=R1(e),s=e.finished;return{avg:t,isCompleted:s,darts:e.dartsThrown,checkout:e.checkoutScore??0}}function B1(e){if(e.legs.length===0)return;const t=[];let s,r=e.bestCheckout??0;for(const l of e.legs){if(!l.finished)continue;const a=O1(l);t.push(a.avg),(!s||a.darts<s.darts||a.darts===s.darts&&(l.endTime??0)<s.timestamp)&&(s={darts:a.darts,timestamp:l.endTime??Date.now()}),a.checkout>r&&(r=a.checkout)}t.length&&(e.bestThreeDartAvg=Math.max(...t),e.worstThreeDartAvg=Math.min(...t)),s&&(e.bestNineDart=s),e.bestCheckout=r}const La=Jl((e,t)=>({roomId:"",players:[],currentPlayerIdx:0,startingScore:501,inProgress:!1,newMatch:(s,r,l="")=>e(()=>({players:s.map((i,o)=>({id:`${o}`,name:i,legsWon:0,legs:[]})),currentPlayerIdx:0,startingScore:r,inProgress:!0,roomId:l,bestLegThisMatch:void 0})),addVisit:(s,r)=>e(l=>{if(!l.inProgress)return l;const a=l.players[l.currentPlayerIdx];let i=a.legs[a.legs.length-1];return(!i||i.finished)&&(i={visits:[],totalScoreStart:l.startingScore,totalScoreRemaining:l.startingScore,dartsThrown:0,finished:!1,checkoutScore:null,startTime:Date.now()},a.legs.push(i)),i.visits.push({darts:r,score:s}),i.dartsThrown+=r,i.totalScoreRemaining=Math.max(0,i.totalScoreRemaining-s),{...l}}),undoVisit:()=>e(s=>{const r=s.players[s.currentPlayerIdx],l=r.legs[r.legs.length-1];if(!l||l.finished||l.visits.length===0)return s;const a=l.visits.pop();return l.dartsThrown-=a.darts,l.totalScoreRemaining+=a.score,{...s}}),endLeg:s=>e(r=>{const l=r.players[r.currentPlayerIdx],a=l.legs[l.legs.length-1];if(!a||a.finished)return r;if(a.finished=!0,a.checkoutScore=s,a.endTime=Date.now(),a.totalScoreRemaining===0){l.legsWon+=1;const i=r.bestLegThisMatch;(!i||a.dartsThrown<i.darts)&&(r.bestLegThisMatch={playerId:l.id,darts:a.dartsThrown,timestamp:a.endTime})}return{...r}}),nextPlayer:()=>e(s=>({...s,currentPlayerIdx:(s.currentPlayerIdx+1)%s.players.length})),endGame:()=>e(s=>{for(const r of s.players)B1(r);return{...s,inProgress:!1}}),importState:s=>e(()=>({...s}))}));function _1(e,t){const s=S1(e,t);return k1(s)}function U1(e){try{if(!e||typeof e!="object")return null;if((e.type==="dart"||e.kind==="dart"||e.event==="dart")&&typeof e.value=="number"){const t=oh(e.ring);return ch(e.value,t)}if(typeof e.value=="number"&&e.ring){const t=oh(e.ring);return ch(e.value,t)}if(typeof e.score=="string"){const t=e.score.trim().toUpperCase();if(t==="50"||t==="DBULL"||t==="INNER_BULL")return{value:50,ring:"INNER_BULL",sector:null,mult:0};if(t==="25"||t==="BULL"||t==="OBULL")return{value:25,ring:"BULL",sector:null,mult:0};const s=t.match(/^(S|D|T)(\d{1,2})$/);if(s){const r=s[1]==="S"?1:s[1]==="D"?2:3,l=parseInt(s[2],10);if(l>=1&&l<=20)return{value:l*r,ring:r===1?"SINGLE":r===2?"DOUBLE":"TRIPLE",sector:l,mult:r}}}if(typeof e.sector=="number"&&typeof e.mult=="number"){const t=Math.max(1,Math.min(20,Math.floor(e.sector))),s=e.mult===1?1:e.mult===2?2:3;return{value:t*s,ring:s===1?"SINGLE":s===2?"DOUBLE":"TRIPLE",sector:t,mult:s}}if(e.bull){const t=String(e.bull).toLowerCase()==="inner"||e.bull===!0;return{value:t?50:25,ring:t?"INNER_BULL":"BULL",sector:null,mult:0}}}catch{}return null}function oh(e){const t=String(e||"").toUpperCase();return t.startsWith("TR")?"TRIPLE":t.startsWith("DO")?"DOUBLE":t.startsWith("SI")?"SINGLE":t==="INNER_BULL"||t==="DBULL"||t==="50"||t==="IBULL"?"INNER_BULL":t==="BULL"||t==="25"||t==="OBULL"||t==="OUTER_BULL"?"BULL":t==="MISS"||t==="0"?"MISS":"SINGLE"}function ch(e,t){const s=Math.max(0,Math.min(60,Math.round(Number(e)||0)));return t==="INNER_BULL"?{value:50,ring:t}:t==="BULL"?{value:25,ring:t}:{value:s,ring:t}}function F1(e,t){let s=null,r=!0;function l(){if(r)try{s=new WebSocket(e),s.onmessage=a=>{try{const i=JSON.parse(a.data),o=U1(i);o&&t(o)}catch{}},s.onclose=()=>{s=null,setTimeout(l,1500)},s.onerror=()=>{}}catch{setTimeout(l,2e3)}}return l(),{close:()=>{r=!1;try{s==null||s.close()}catch{}}}}function dh({storageKey:e,children:t,className:s,defaultWidth:r=640,defaultHeight:l=360,minWidth:a=320,minHeight:i=200,maxWidth:o=1600,maxHeight:c=1200}){const[d,x]=m.useState(()=>{try{const h=localStorage.getItem(e);if(h)return JSON.parse(h)}catch{}return{width:r,height:l}}),S=m.useRef(null),y=m.useRef(null);m.useEffect(()=>{function h(){try{localStorage.removeItem(e)}catch{}x({width:r,height:l})}return window.addEventListener("ndn:layout-reset",h),window.addEventListener("ndn:camera-reset",h),()=>{window.removeEventListener("ndn:layout-reset",h),window.removeEventListener("ndn:camera-reset",h)}},[e,r,l]),m.useEffect(()=>{try{localStorage.setItem(e,JSON.stringify(d))}catch{}},[d,e]);function N(h,b,C){return Math.max(b,Math.min(C,h))}function w(h,b){h.preventDefault();const C=y.current;if(!C)return;const j=C.getBoundingClientRect();S.current={x:h.clientX,y:h.clientY,w:j.width,h:j.height,dir:b},window.addEventListener("mousemove",T),window.addEventListener("mouseup",P)}function T(h){const b=S.current;if(!b)return;const C=h.clientX-b.x,j=h.clientY-b.y;let f=b.w,R=b.h;b.dir.includes("e")&&(f=N(b.w+C,a,o)),b.dir.includes("s")&&(R=N(b.h+j,i,c)),b.dir.includes("w")&&(f=N(b.w-C,a,o)),b.dir.includes("n")&&(R=N(b.h-j,i,c)),x({width:Math.round(f),height:Math.round(R)})}function P(){window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",P),S.current=null}const v={width:d.width?`${d.width}px`:void 0,height:d.height?`${d.height}px`:void 0,maxWidth:"100%",maxHeight:"80vh",position:"relative"};return n.jsxs("div",{ref:y,className:`${s||""}`,style:v,children:[t,n.jsx("div",{className:"resizer resizer-nw",onMouseDown:h=>w(h,"nw")}),n.jsx("div",{className:"resizer resizer-ne",onMouseDown:h=>w(h,"ne")}),n.jsx("div",{className:"resizer resizer-sw",onMouseDown:h=>w(h,"sw")}),n.jsx("div",{className:"resizer resizer-se",onMouseDown:h=>w(h,"se")})]})}function qs({storageKey:e,children:t,className:s,defaultWidth:r=520,defaultHeight:l,minWidth:a=360,minHeight:i=200,maxWidth:o=1100,maxHeight:c=900,fullScreen:d=!1,initialFitHeight:x=!1}){const[S,y]=m.useState(()=>{if(!d){try{const j=localStorage.getItem(e);if(j)return JSON.parse(j)}catch{}return{width:r,height:l}}return{}}),N=m.useRef(null);m.useEffect(()=>{if(d)return;function j(){var f;try{localStorage.removeItem(e)}catch{}if(x&&((f=h.current)!=null&&f.parentElement)){const R=h.current.parentElement,B=window.getComputedStyle(R),ee=parseFloat(B.paddingTop||"0")||0,Y=parseFloat(B.paddingBottom||"0")||0,$=Math.max(0,R.clientHeight-ee-Y),Q=Math.max(i,Math.min(c,Math.round($)));y({width:r,height:Q});return}y({width:r,height:l})}return window.addEventListener("ndn:layout-reset",j),()=>window.removeEventListener("ndn:layout-reset",j)},[e,r,l,d]),m.useEffect(()=>{if(!d)try{localStorage.setItem(e,JSON.stringify(S))}catch{}},[S,e,d]),m.useEffect(()=>{var $;if(d||!x)return;const j=($=h.current)==null?void 0:$.parentElement;if(!j)return;const f=window.getComputedStyle(j),R=parseFloat(f.paddingTop||"0")||0,B=parseFloat(f.paddingBottom||"0")||0,ee=Math.max(0,j.clientHeight-R-B),Y=Math.max(i,Math.min(c,Math.round(ee)));try{const Q=localStorage.getItem(e);if(Q){const D=JSON.parse(Q),z=(D==null?void 0:D.height)||0;(!z||z<Y)&&y(de=>({...de,height:Y}));return}}catch{}y(Q=>({...Q,height:Y}))},[x,d,e,i,c]);function w(j,f,R){return Math.max(f,Math.min(R,j))}function T(j,f){j.preventDefault();const R=h.current;if(!R)return;const B=R.getBoundingClientRect();N.current={x:j.clientX,y:j.clientY,w:B.width,h:B.height,dir:f},window.addEventListener("mousemove",P),window.addEventListener("mouseup",v)}function P(j){var de;const f=N.current;if(!f)return;const R=j.clientX-f.x,B=j.clientY-f.y,ee=f.dir;let Y=f.w,$=f.h,Q=1/0;const D=(de=h.current)==null?void 0:de.parentElement;if(D){const I=window.getComputedStyle(D),G=parseFloat(I.paddingTop||"0")||0,W=parseFloat(I.paddingBottom||"0")||0;Q=Math.max(0,D.clientHeight-G-W)}const z=Math.min(c,isFinite(Q)?Q:c);ee.includes("e")&&(Y=w(f.w+R,a,o)),ee.includes("s")&&($=w(f.h+B,i,z)),ee.includes("w")&&(Y=w(f.w-R,a,o)),ee.includes("n")&&($=w(f.h-B,i,z)),y({width:Math.round(Y),height:Math.round($)})}function v(){window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",v),N.current=null}const h=m.useRef(null),b=d?{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%"}:{width:S.width?`${S.width}px`:void 0,height:S.height?`${S.height}px`:void 0,maxWidth:`${o}px`,maxHeight:"100%"},C=d?"card relative ndn-modal-full":"card relative";return n.jsxs("div",{ref:h,className:`${C} ${s||""}`,style:b,children:[t,!d&&n.jsx("div",{className:"resizer resizer-nw",onMouseDown:j=>T(j,"nw")}),!d&&n.jsx("div",{className:"resizer resizer-ne",onMouseDown:j=>T(j,"ne")}),!d&&n.jsx("div",{className:"resizer resizer-sw",onMouseDown:j=>T(j,"sw")}),!d&&n.jsx("div",{className:"resizer resizer-se",onMouseDown:j=>T(j,"se")}),!d&&n.jsx("div",{className:"resizer-edge resizer-s",onMouseDown:j=>T(j,"s")})]})}function Fe({onVisitCommitted:e,showToolbar:t=!0,onAutoDart:s,immediateAutoCommit:r=!1,hideInlinePanels:l=!1,scoringMode:a="x01",onGenericDart:i,onGenericReplace:o}){const c=m.useRef(null),{preferredCameraId:d,setPreferredCamera:x,autoscoreProvider:S,autoscoreWsUrl:y}=Yn(),[N,w]=m.useState([]),T=m.useRef(null),P=m.useRef(null),[v,h]=m.useState(!1),[b,C]=m.useState(null),{H:j,imageSize:f,reset:R}=om(),[B,ee]=m.useState(""),[Y,$]=m.useState(""),[Q,D]=m.useState(0),[z,de]=m.useState("MISS"),[I,G]=m.useState(0),[W,X]=m.useState(0),[Z,ie]=m.useState([]),J=La(A=>A.addVisit),me=La(A=>A.endLeg),pe=La(A=>A),[Me,Ne]=m.useState(""),[Le,ke]=m.useState(""),[$e,ue]=m.useState(0),[xe,Re]=m.useState(!1),[ct,nt]=m.useState(!1),[Ft,M]=m.useState("auto"),[O,ze]=m.useState(!1),[Xe,et]=m.useState(!1),[Mt,St]=m.useState(!1),Ze=m.useRef(null);m.useEffect(()=>{const A=()=>et(!0);return window.addEventListener("ndn:open-autoscore",A),()=>window.removeEventListener("ndn:open-autoscore",A)},[]),m.useEffect(()=>{const A=()=>St(!0);return window.addEventListener("ndn:open-scoring",A),()=>window.removeEventListener("ndn:open-scoring",A)},[]),m.useEffect(()=>{const A=()=>{M("manual"),ze(!0)},U=()=>{M("auto"),ze(!1)};return window.addEventListener("ndn:open-manual",A),window.addEventListener("ndn:close-manual",U),()=>{window.removeEventListener("ndn:open-manual",A),window.removeEventListener("ndn:close-manual",U)}},[]),m.useEffect(()=>{if(!O)return;const A=setInterval(()=>{try{const U=c.current,ce=Ze.current;if(!U||!ce)return;const je=U.videoWidth||0,ge=U.videoHeight||0;if(!je||!ge)return;const Ce=ce.clientWidth||640,he=ce.clientHeight||360;ce.width!==Ce&&(ce.width=Ce),ce.height!==he&&(ce.height=he);const Pe=ce.getContext("2d");Pe.imageSmoothingEnabled=!0;const pt=Math.min(Ce/je,he/ge),Ve=Math.round(je*pt),Lt=Math.round(ge*pt),Vt=Math.floor((Ce-Ve)/2),tn=Math.floor((he-Lt)/2);Pe.fillStyle="#000",Pe.fillRect(0,0,Ce,he),Pe.drawImage(U,Vt,tn,Ve,Lt)}catch{}},120);return()=>clearInterval(A)},[O]),m.useEffect(()=>()=>dt(),[]);async function gt(){var A,U,ce;try{const je=d?{video:{deviceId:{exact:d}},audio:!1}:{video:!0,audio:!1};let ge;try{ge=await navigator.mediaDevices.getUserMedia(je)}catch(Ce){const he=Ce&&(Ce.name||Ce.code)||"";if(d&&(he==="OverconstrainedError"||he==="NotFoundError"))ge=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});else throw Ce}c.current&&(c.current.srcObject=ge,await c.current.play()),h(!0);try{const Ce=await navigator.mediaDevices.enumerateDevices();w(Ce.filter(Ve=>Ve.kind==="videoinput"));const he=(((A=ge.getVideoTracks)==null?void 0:A.call(ge))||[])[0],Pe=(U=he==null?void 0:he.getSettings)==null?void 0:U.call(he),pt=Pe==null?void 0:Pe.deviceId;if(pt){const Ve=(ce=Ce.find(Lt=>Lt.deviceId===pt))==null?void 0:ce.label;x(pt,Ve||"")}}catch{}}catch{alert("Camera permission denied or not available.")}}function dt(){c.current&&c.current.srcObject&&(c.current.srcObject.getTracks().forEach(U=>U.stop()),c.current.srcObject=null,h(!1))}function yt(){if(!c.current||!T.current)return;const A=c.current,U=T.current;U.width=A.videoWidth,U.height=A.videoHeight,U.getContext("2d").drawImage(A,0,0,U.width,U.height);const je=U.toDataURL("image/png");C(je)}function on(){return N.length?n.jsxs("div",{className:"absolute top-2 right-2 z-20 flex items-center gap-2 bg-black/40 rounded px-2 py-1 text-xs",children:[n.jsx("span",{children:"Cam:"}),n.jsxs("select",{className:"bg-black/20 rounded px-1 py-0.5",value:d||"",onChange:async A=>{var je;const U=A.target.value||void 0,ce=(je=N.find(ge=>ge.deviceId===U))==null?void 0:je.label;x(U,ce||""),dt(),await gt()},children:[n.jsx("option",{value:"",children:"Auto"}),N.map(A=>n.jsx("option",{value:A.deviceId,children:A.label||"Camera"},A.deviceId))]})]}):null}function qn(){if(!P.current||!c.current||!j||!f)return;const A=P.current,U=c.current,ce=U.clientWidth,je=U.clientHeight;A.width=ce,A.height=je;const ge=A.getContext("2d");ge.clearRect(0,0,ce,je);const Ce=ce/f.w,he=je/f.h,Pe=g1(j,Ce,he),pt=[Je.bullInner,Je.bullOuter,Je.trebleInner,Je.trebleOuter,Je.doubleInner,Je.doubleOuter];for(const Ve of pt){const Lt=fx(Pe,Ve,360);hx(ge,Lt,Ve===Je.doubleOuter?"#22d3ee":"#a78bfa",Ve===Je.doubleOuter?3:2)}}m.useEffect(()=>{const A=setInterval(qn,250);return()=>clearInterval(A)},[j,f,v]),m.useEffect(()=>{if(S!=="external-ws"||!y)return;const A=F1(y,U=>{if(s)try{s(U.value,U.ring,{sector:U.sector??null,mult:U.mult??0})}catch{}else{const ce=U.ring==="INNER_BULL"?"INNER_BULL 50":U.ring==="BULL"?"BULL 25":`${U.ring[0]}${U.value/(U.mult||1)||U.value} ${U.value}`;Tt(U.value,ce,U.ring)}});return()=>A.close()},[S,y]);function vt(A){if(!P.current||!j||!f)return;const U=P.current.getBoundingClientRect(),ce=A.clientX-U.left,je=A.clientY-U.top,ge=P.current.width/f.w,Ce=P.current.height/f.h,he={x:ce/ge,y:je/Ce},Pe=_1(j,he),pt=`${Pe.ring} ${Pe.base>0?Pe.base:""}`.trim();ee(pt),D(Pe.base),de(Pe.ring),nt(!0);try{r&&s&&(s(Pe.base,Pe.ring,{sector:Pe.sector,mult:Pe.mult}),nt(!1))}catch{}}function pn(A){const U=A.trim().toUpperCase();if(!U)return null;const ce=U==="BULL"||U==="50"||U==="DBULL"||U==="IBULL",je=U==="25"||U==="OBULL";if(ce)return{label:"INNER_BULL 50",value:50,ring:"INNER_BULL"};if(je)return{label:"BULL 25",value:25,ring:"BULL"};const ge=U.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!ge)return null;const Ce=ge[1]||"S",he=parseInt(ge[2],10);if(he<1||he>20)return null;const Pe=Ce==="S"?1:Ce==="D"?2:3,pt=Ce==="S"?"SINGLE":Ce==="D"?"DOUBLE":"TRIPLE";return{label:`${Ce}${he} ${he*Pe}`,value:he*Pe,ring:pt}}function xn(){const A=pe;if(!A.players.length)return A.startingScore;const U=A.players[A.currentPlayerIdx],ce=U.legs[U.legs.length-1];return ce?ce.totalScoreRemaining:A.startingScore}function Tt(A,U,ce){if(a==="custom"){if(i)try{i(A,ce,{label:U})}catch{}if(I>=3)return;const Ve=I+1;G(Ve),X(Lt=>Lt+A),ie(Lt=>[...Lt,{label:U,value:A,ring:ce}]);return}if(I>=3)return;const je=I+1,ge=W+A,he=xn()-ge,Pe=he===0&&(ce==="DOUBLE"||ce==="INNER_BULL");if(he<0||he===1||he===0&&!Pe){J(0,je),G(0),X(0),ie([]),e&&e(0,je,!1);return}if(G(je),X(ge),ie(Ve=>[...Ve,{label:U,value:A,ring:ce}]),Pe){J(ge,je),me(ge),G(0),X(0),ie([]),e&&e(ge,je,!0);return}je>=3&&(J(ge,je),G(0),X(0),ie([]),e&&e(ge,je,!1))}function ne(){if(B){if(s)try{s(Q,z,void 0)}catch{}else Tt(Q,B,z);ue(0),nt(!1)}}function le(){const A=pn(Y);if(!A){alert("Enter like T20, D16, 5, 25, 50");return}if(!ct||!B||z==="MISS"||Q===0){const U=$e+1;ue(U),U>=3&&Re(!0)}else ue(0);Tt(A.value,A.label,A.ring),$(""),nt(!1)}function oe(){var Lt,Vt,tn;const A=pn(Y);if(!A){alert("Enter like T20, D16, 5, 25, 50");return}if(I===0||Z.length===0){le();return}if(a==="custom"){if(!ct||!B||z==="MISS"||Q===0){const qe=$e+1;ue(qe),qe>=3&&Re(!0)}else ue(0);if(ie(qe=>[...qe.slice(0,-1),{label:A.label,value:A.value,ring:A.ring}]),o)try{o(A.value,A.ring,{label:A.label})}catch{}$(""),nt(!1);return}if(!ct||!B||z==="MISS"||Q===0){const qe=$e+1;ue(qe),qe>=3&&Re(!0)}else ue(0);const U=Z[Z.length-1],ce=I-1,je=W-((U==null?void 0:U.value)||0),ge=xn(),Ce=je+A.value,he=ce+1,Pe=ge-Ce,pt=Pe===0&&(A.ring==="DOUBLE"||A.ring==="INNER_BULL");if(Pe<0||Pe===1||Pe===0&&!pt){J(0,he);try{const qe=(Lt=pe.players[pe.currentPlayerIdx])==null?void 0:Lt.name;qe&&Sr(qe,he,0)}catch{}G(0),X(0),ie([]),e&&e(0,he,!1),$(""),nt(!1);return}if(G(he),X(Ce),ie(qe=>[...qe.slice(0,-1),{label:A.label,value:A.value,ring:A.ring}]),pt){J(Ce,he),me(Ce);try{const qe=(Vt=pe.players[pe.currentPlayerIdx])==null?void 0:Vt.name;qe&&Sr(qe,he,Ce)}catch{}G(0),X(0),ie([]),e&&e(Ce,he,!0),$(""),nt(!1);return}if(he>=3){J(Ce,he);try{const qe=(tn=pe.players[pe.currentPlayerIdx])==null?void 0:tn.name;qe&&Sr(qe,he,Ce)}catch{}G(0),X(0),ie([]),e&&e(Ce,he,!1)}$(""),nt(!1)}function se(){Re(!1),ue(0);try{window.dispatchEvent(new CustomEvent("ndn:request-calibrate"))}catch{}}function K(){R(),Re(!1),ue(0)}function Oe(A,U){if(I>=3)return;const ce=A*(U==="S"?1:U==="D"?2:3),je=U==="S"?"SINGLE":U==="D"?"DOUBLE":"TRIPLE";if(!ct||!B||z==="MISS"||Q===0){const ge=$e+1;ue(ge),ge>=3&&Re(!0)}else ue(0);Tt(ce,`${U}${A} ${ce}`,je),nt(!1)}function ve(){if(I===0)return;const A=Z[Z.length-1];G(U=>U-1),X(U=>U-((A==null?void 0:A.value)||0)),ie(U=>U.slice(0,-1))}function We(){var A;if(I!==0){if(a==="custom"){G(0),X(0),ie([]);return}J(W,I);try{const U=(A=pe.players[pe.currentPlayerIdx])==null?void 0:A.name;U&&Sr(U,I,W)}catch{}G(0),X(0),ie([]),e&&e(W,I,!1)}}return n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t&&n.jsx("div",{className:"lg:col-span-2",children:n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("button",{className:`btn px-3 py-1 text-sm ${Ft==="auto"?"tab--active":""}`,onClick:()=>{M("auto"),ze(!1),et(!0)},children:"Autoscore"}),n.jsx("button",{className:`btn px-3 py-1 text-sm ${Ft==="manual"?"tab--active":""}`,onClick:()=>{M("manual"),ze(!0)},title:"Open Manual Correction",children:"Manual Correction"})]})}),l?null:n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Camera"}),n.jsxs(dh,{storageKey:"ndn:camera:size",className:"relative rounded-2xl overflow-hidden bg-black",defaultWidth:720,defaultHeight:405,minWidth:480,minHeight:270,maxWidth:1600,maxHeight:900,children:[n.jsx(on,{}),n.jsx("video",{ref:c,className:"w-full h-full object-cover"}),n.jsx("canvas",{ref:P,className:"absolute inset-0 w-full h-full",onClick:vt})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[v?n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:dt,children:"Stop Camera"}):n.jsx("button",{className:"btn",onClick:gt,children:"Start Camera"}),n.jsx("button",{className:"btn",onClick:yt,disabled:!v,children:"Capture Still"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{try{window.dispatchEvent(new Event("ndn:camera-reset"))}catch{}},children:"Reset Camera Size"})]})]}),n.jsx("canvas",{ref:T,className:"hidden"}),Xe&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100]",role:"dialog","aria-modal":"true",children:n.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:n.jsxs(qs,{storageKey:"ndn:autoscore:size",className:"w-full max-w-3xl",defaultWidth:720,defaultHeight:520,minWidth:420,minHeight:320,maxWidth:1400,maxHeight:900,initialFitHeight:!0,children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Autoscore"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn btn--ghost",onClick:()=>et(!1),children:"Close"})})]}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Click the camera overlay to autoscore. Use Manual Correction if the last auto is off."}),n.jsxs("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:[n.jsx("span",{className:"font-semibold",children:"Last auto:"}),n.jsx("span",{children:B||""}),n.jsx("button",{className:"btn",onClick:ne,disabled:I>=3,children:"Add Auto Dart"}),$e>0&&n.jsxs("span",{className:"text-sm opacity-80",children:["No-registers: ",$e,"/3"]})]}),n.jsxs("div",{className:"mt-2",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Quick entry"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[n.jsx("button",{className:"btn",disabled:I>=3,onClick:()=>{if(!ct||!B||z==="MISS"||Q===0){const A=$e+1;ue(A),A>=3&&Re(!0)}else ue(0);Tt(25,"BULL 25","BULL"),nt(!1)},children:"25"}),n.jsx("button",{className:"btn",disabled:I>=3,onClick:()=>{if(!ct||!B||z==="MISS"||Q===0){const A=$e+1;ue(A),A>=3&&Re(!0)}else ue(0);Tt(50,"INNER_BULL 50","INNER_BULL"),nt(!1)},children:"50"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("input",{className:"input w-full max-w-sm",list:"autoscore-quick-list",placeholder:"Type or select (e.g., D16, T20, S5)",value:Me,onChange:A=>Ne(A.target.value.toUpperCase()),onKeyDown:A=>{if(A.key==="Enter"){const U=Me.match(/^(S|D|T)(\d{1,2})$/);U&&Oe(parseInt(U[2],10),U[1])}}}),n.jsx("datalist",{id:"autoscore-quick-list",children:["D","S","T"].map(A=>Array.from({length:20},(U,ce)=>ce+1).map(U=>n.jsx("option",{value:`${A}${U}`},`${A}${U}`)))}),n.jsx("button",{className:"btn",disabled:!Me||I>=3,onClick:()=>{const A=Me.match(/^(S|D|T)(\d{1,2})$/);if(!A)return;const U=A[1],ce=parseInt(A[2],10);Oe(ce,U)},children:"Add"})]})]})]})})}),O&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100]",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[n.jsxs("div",{className:"p-3 md:p-4 flex items-center justify-between",children:[n.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Manual Correction"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{ze(!1)},children:"Close"})})]}),n.jsx("div",{className:"flex-1 p-3 md:p-4",children:n.jsxs("div",{className:"h-full grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"card relative flex flex-col",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Live Preview"}),n.jsx("div",{className:"relative flex-1 rounded-2xl overflow-hidden bg-black",children:n.jsx("canvas",{ref:Ze,className:"absolute inset-0 w-full h-full"})})]}),n.jsxs("div",{className:"card flex flex-col",children:[n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Type a correction or replace the last dart. The preview updates live."}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"font-semibold",children:"Last auto:"}),n.jsx("span",{children:B||""}),n.jsx("button",{className:"btn",onClick:ne,disabled:I>=3,children:"Add Auto Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{className:"input flex-1",placeholder:"Manual (T20, D16, 5, 25, 50)",value:Y,onChange:A=>$(A.target.value),onKeyDown:A=>{A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),le()),A.key==="Enter"&&A.shiftKey&&(A.preventDefault(),oe())}}),n.jsx("button",{className:"btn btn--ghost",onClick:oe,disabled:I===0,children:"Replace Last"}),n.jsx("button",{className:"btn",onClick:le,disabled:I>=3,children:"Add"})]}),n.jsx("div",{className:"text-xs opacity-70 mb-4",children:"Press Enter to Add  Shift+Enter to Replace Last"}),n.jsxs("div",{className:"mt-auto",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Quick entry"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[n.jsx("button",{className:"btn",disabled:I>=3,onClick:()=>{if(!ct||!B||z==="MISS"||Q===0){const A=$e+1;ue(A),A>=3&&Re(!0)}else ue(0);Tt(25,"BULL 25","BULL"),nt(!1)},children:"25"}),n.jsx("button",{className:"btn",disabled:I>=3,onClick:()=>{if(!ct||!B||z==="MISS"||Q===0){const A=$e+1;ue(A),A>=3&&Re(!0)}else ue(0);Tt(50,"INNER_BULL 50","INNER_BULL"),nt(!1)},children:"50"})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx("input",{className:"input w-full max-w-sm",list:"manual-quick-list",placeholder:"Type or select (e.g., D16, T20, S5)",value:Le,onChange:A=>ke(A.target.value.toUpperCase()),onKeyDown:A=>{if(A.key==="Enter"){const U=Le.match(/^(S|D|T)(\d{1,2})$/);U&&Oe(parseInt(U[2],10),U[1])}}}),n.jsx("datalist",{id:"manual-quick-list",children:["D","S","T"].map(A=>Array.from({length:20},(U,ce)=>ce+1).map(U=>n.jsx("option",{value:`${A}${U}`},`${A}${U}`)))}),n.jsx("button",{className:"btn",disabled:!Le||I>=3,onClick:()=>{const A=Le.match(/^(S|D|T)(\d{1,2})$/);if(!A)return;const U=A[1],ce=parseInt(A[2],10);Oe(ce,U)},children:"Add"})]})]})]})]})})]})}),Mt&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-[100] flex items-center justify-center",children:n.jsxs("div",{className:"card w-full max-w-4xl relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>St(!1),children:"Close"}),n.jsx("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2 text-white",children:"Scoring"}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-black/30 rounded-2xl p-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Camera"}),n.jsxs(dh,{storageKey:"ndn:camera:size:modal",className:"relative rounded-2xl overflow-hidden bg-black",defaultWidth:720,defaultHeight:405,minWidth:480,minHeight:270,maxWidth:1600,maxHeight:900,children:[n.jsx(on,{}),n.jsx("video",{ref:c,className:"w-full h-full object-cover"}),n.jsx("canvas",{ref:P,className:"absolute inset-0 w-full h-full",onClick:vt})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[v?n.jsx("button",{className:"btn bg-gradient-to-r from-rose-600 to-rose-700 text-white font-bold",onClick:dt,children:"Stop Camera"}):n.jsx("button",{className:"btn bg-gradient-to-r from-purple-500 to-purple-700 text-white font-bold",onClick:gt,children:"Start Camera"}),n.jsx("button",{className:"btn bg-gradient-to-r from-indigo-500 to-indigo-700 text-white font-bold",onClick:yt,disabled:!v,children:"Capture Still"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:()=>{try{window.dispatchEvent(new Event("ndn:camera-reset"))}catch{}},children:"Reset Camera Size"})]})]}),n.jsxs("div",{className:"bg-black/30 rounded-2xl p-4",children:[n.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Pending Visit"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Up to 3 darts per visit."}),n.jsx("ul",{className:"text-sm mb-2 list-disc pl-5",children:Z.length===0?n.jsx("li",{className:"opacity-60",children:"No darts yet"}):Z.map((A,U)=>n.jsx("li",{children:A.label},U))}),n.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[n.jsxs("div",{className:"font-semibold",children:["Darts: ",I,"/3"]}),n.jsxs("div",{className:"font-semibold",children:["Total: ",W]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-gradient-to-r from-purple-500 to-purple-700 text-white font-bold",onClick:ve,disabled:I===0,children:"Undo Dart"}),n.jsx("button",{className:"btn bg-gradient-to-r from-emerald-500 to-emerald-700 text-white font-bold",onClick:We,disabled:I===0,children:"Commit Visit"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:()=>{G(0),X(0),ie([])},disabled:I===0,children:"Clear"})]})]})]})]})}),xe&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:n.jsxs("div",{className:"card max-w-md w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>{Re(!1),ue(0)},children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2 flex items-center gap-2 text-white",children:"Recalibration Recommended"}),n.jsx("div",{className:"mb-4 text-lg font-semibold text-indigo-200",children:"We detected 3 incorrect autoscores in a row. You can recalibrate now or reset calibration and try again."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-gradient-to-r from-purple-500 to-purple-700 text-white font-bold",onClick:se,children:"Go to Calibrate"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:K,children:"Reset Calibration"}),n.jsx("button",{className:"btn bg-gradient-to-r from-slate-500 to-slate-700 text-white font-bold",onClick:()=>{Re(!1),ue(0)},children:"Dismiss"})]})]})}),l?null:n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Pending Visit"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Up to 3 darts per visit."}),n.jsx("ul",{className:"text-sm mb-2 list-disc pl-5",children:Z.length===0?n.jsx("li",{className:"opacity-60",children:"No darts yet"}):Z.map((A,U)=>n.jsx("li",{children:A.label},U))}),n.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[n.jsxs("div",{className:"font-semibold",children:["Darts: ",I,"/3"]}),n.jsxs("div",{className:"font-semibold",children:["Total: ",W]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn",onClick:ve,disabled:I===0,children:"Undo Dart"}),n.jsx("button",{className:"btn",onClick:We,disabled:I===0,children:"Commit Visit"}),n.jsx("button",{className:"btn",onClick:()=>{G(0),X(0),ie([])},disabled:I===0,children:"Clear"})]})]})]})}const Dn=[...Array.from({length:20},(e,t)=>({label:`D${t+1}`,score:(t+1)*2})),{label:"DBULL",score:50,isBull:!0}];function tu(e,t){const s=Dn[t];return!!s&&e===s.score}function br(e){const t=e.trim().toUpperCase();if(!t)return null;if(t==="50"||t==="BULL"||t==="DBULL"||t==="IBULL")return 50;if(t==="25"||t==="OBULL")return 25;const s=t.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!s)return null;const r=s[1]||"S",l=parseInt(s[2],10);return l<1||l>20?null:l*(r==="S"?1:r==="D"?2:3)}const Rt=[...Array.from({length:20},(e,t)=>t+1),25,50],ni=[20,19,18,17,16,15,25];function kr(){const e={};return ni.forEach(t=>{e[t]=0}),{marks:e,points:0}}function px(e,t,s,r,l=()=>!1){let a=null,i=0;if(s==="BULL"||s==="INNER_BULL"||t===25||t===50)a=25,i=s==="INNER_BULL"||t===50?2:1;else if(typeof r=="number"&&r>=15&&r<=20)a=r,s==="TRIPLE"?i=3:s==="DOUBLE"?i=2:i=1;else if(t){const N=[20,19,18,17,16,15];for(const w of N){if(t===w){a=w,i=1;break}if(t===w*2){a=w,i=2;break}if(t===w*3){a=w,i=3;break}}!a&&(t===25||t===50)&&(a=25,i=t===50?2:1)}if(!a)return 0;const o=e.marks[a];let c=Math.max(0,3-o);const d=Math.min(c,i),x=Math.max(0,i-d),S=o+d;e.marks[a]=S>3?3:S;let y=0;return x>0&&!l(a)&&(a===25?s==="INNER_BULL"?y+=50*x:y+=25*x:y+=a*x),e.points+=y,y}function $1(e){return ni.every(t=>(e.marks[t]||0)>=3)}function Hs(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function z1(e){return e.round}function xx(e,t,s,r){if(e.finished)return 0;const l=z1(e);let a=0;return typeof r=="number"&&r===l?s==="TRIPLE"?(a=l*3,e.turnHits.triples++):s==="DOUBLE"?(a=l*2,e.turnHits.doubles++):s==="SINGLE"&&(a=l*1,e.turnHits.singles++):!r&&(t===l||t===l*2||t===l*3)&&(t===l*3?(a=l*3,e.turnHits.triples++):t===l*2?(a=l*2,e.turnHits.doubles++):t===l&&(a=l,e.turnHits.singles++)),e.score+=a,a}function gx(e){if(!e.finished){if(e.turnHits.singles>0&&e.turnHits.doubles>0&&e.turnHits.triples>0){e.shanghaiAchieved=!0,e.finished=!0;return}const t=e.round+1;t>20?e.finished=!0:e.round=t}e.turnHits={singles:0,doubles:0,triples:0}}function Ws(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function Ao(e){return e.targets[e.stage]||null}function yx(e,t,s,r){if(e.finished)return 0;const l=Ao(e);if(!l)return 0;let a=0;switch(l.kind){case"NUMBER":{typeof r=="number"&&r===l.num?s==="TRIPLE"?a=l.num*3:s==="DOUBLE"?a=l.num*2:s==="SINGLE"&&(a=l.num):!r&&(t===l.num||t===l.num*2||t===l.num*3)&&(a=t),a>0&&(e.hitThisRound=!0);break}case"DOUBLE":{(s==="DOUBLE"&&r===l.num||t===l.num*2)&&(a=l.num*2,e.hitThisRound=!0);break}case"TRIPLE":{(s==="TRIPLE"&&r===l.num||t===l.num*3)&&(a=l.num*3,e.hitThisRound=!0);break}case"BULL":{(s==="BULL"||s==="INNER_BULL"||t===25||t===50)&&(a=s==="INNER_BULL"||t===50?50:25,e.hitThisRound=!0);break}case"ANY_NUMBER":{t>0&&(a=t,e.hitThisRound=!0);break}}return e.score+=a,a}function vx(e){e.finished||(e.hitThisRound||(e.score=Math.floor(e.score/2)),e.hitThisRound=!1,e.stage+=1,e.stage>=e.targets.length&&(e.finished=!0))}function Vs(){return{round:1,score:0,target:"HIGH",finished:!1}}function bx(e,t,s,r){if(e.finished)return 0;let l=0;if(e.target==="HIGH")if(s==="INNER_BULL")l=50;else if(typeof r=="number"){const i=r*(s==="TRIPLE"?3:s==="DOUBLE"?2:1);r>=20&&(l=i)}else t>=40&&(l=t);else if(typeof r=="number"){const i=r*(s==="TRIPLE"?3:s==="DOUBLE"?2:1);r<=10&&(l=i)}else t>0&&t<=30&&(l=t);return e.score+=l,l}function Nx(e){if(!e.finished){if(e.round+=1,e.round>10){e.finished=!0;return}e.target=e.target==="HIGH"?"LOW":"HIGH"}}function wx(e,t=3){return{number:e,lives:t,isKiller:!1,eliminated:!1}}function H1(e){const t=Array.from({length:20},(r,l)=>l+1),s={};for(const r of e){const l=Math.floor(Math.random()*t.length),a=t.splice(l,1)[0];s[r]=a}return s}function nu(e,t,s,r){const l=t[e];if(!l||!r||!s)return{becameKiller:!1};if(!l.isKiller&&s==="DOUBLE"&&r===l.number)return l.isKiller=!0,{becameKiller:!0};if(l.isKiller&&(s==="DOUBLE"||s==="TRIPLE")){const a=Object.keys(t).find(i=>i!==e&&!t[i].eliminated&&t[i].number===r);if(a){const i=t[a],o=s==="TRIPLE"?2:1;return i.lives=Math.max(0,i.lives-o),i.lives===0&&(i.eliminated=!0),{becameKiller:!1,victimId:a,livesRemoved:o}}}return{becameKiller:!1}}function su(e){const t=Object.entries(e).filter(([,s])=>!s.eliminated&&s.lives>0);return t.length===1?t[0][0]:null}function Pa(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function jx(e,t,s,r){if(e.finished)return 0;let l=0;if(typeof r=="number"&&r===e.inning?s==="TRIPLE"?l=3:s==="DOUBLE"?l=2:l=1:!r&&(t===e.inning||t===e.inning*2||t===e.inning*3)&&(l=t===e.inning*3?3:t===e.inning*2?2:1),e.score+=l,e.dartsThisInning+=1,e.dartsThisInning>=3){const a=e.inning+1;a>9?e.finished=!0:(e.inning=a,e.dartsThisInning=0)}return l}const Sx={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function Aa(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function kx(e,t,s,r){if(e.finished)return!1;const l=Sx[e.hole];if(e.dartsThisHole+=1,typeof r=="number"&&r===l&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")||!r&&(t===l||t===l*2||t===l*3)){e.strokes+=e.dartsThisHole;const i=e.hole+1;return i>18?e.finished=!0:(e.hole=i,e.dartsThisHole=0),!0}if(e.dartsThisHole>=3){e.strokes+=3;const i=e.hole+1;i>18?e.finished=!0:(e.hole=i,e.dartsThisHole=0)}return!1}const dm={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function ru(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function W1(e){const t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[s,r,l]of t)if(e[s]&&e[s]===e[r]&&e[s]===e[l])return e[s];return e.every(s=>s)?"Draw":null}function Cx(e,t,s,r,l){if(e.finished||e.board[t])return!1;const a=dm[t];let i=!1;if(a.type==="BULL"?i=r==="BULL"||r==="INNER_BULL"||s===25||s===50:a.type==="NUM"&&typeof a.num=="number"&&(typeof l=="number"&&l===a.num||!l&&(s===a.num||s===a.num*2||s===a.num*3))&&(i=!0),!i)return!1;e.board[t]=e.turn;const o=W1(e.board);return o?(e.finished=!0,e.winner=o,!0):(e.turn=e.turn==="X"?"O":"X",!0)}const sc=[20,19,18,17,16,15,14,13,12,25];function Ra(){const e={};return sc.forEach(t=>{e[t]=0}),{marks:e,points:0}}function Ex(e,t,s,r,l=()=>!1){let a=null,i=0;if(s==="BULL"||s==="INNER_BULL"||t===25||t===50)a=25,i=s==="INNER_BULL"||t===50?2:1;else if(typeof r=="number"&&r>=12&&r<=20)a=r,s==="TRIPLE"?i=3:s==="DOUBLE"?i=2:i=1;else if(t){for(const N of[20,19,18,17,16,15,14,13,12]){if(t===N){a=N,i=1;break}if(t===N*2){a=N,i=2;break}if(t===N*3){a=N,i=3;break}}!a&&(t===25||t===50)&&(a=25,i=t===50?2:1)}if(!a)return 0;const o=e.marks[a],c=Math.max(0,3-o),d=Math.min(c,i),x=Math.max(0,i-d),S=o+d;e.marks[a]=S>3?3:S;let y=0;return x>0&&!l(a)&&(a===25?s==="INNER_BULL"?y+=50*x:y+=25*x:y+=a*x),e.points+=y,y}function V1(e){return sc.every(t=>(e.marks[t]||0)>=3)}const uh=["X01","Double Practice"],G1=["Around the Clock","Cricket","Halve It","Shanghai","High-Low","Killer","Bob's 27","Count-Up","High Score","Low Score","Checkout 170","Checkout 121","Treble Practice"],K1=["Easy","Medium","Hardened"];function Oa(e,t,s){return Math.max(t,Math.min(s,e))}function J1(e,t){let s=0;if(t==="Easy"){const r=[22,26,41,45,60];s=r[Math.floor(Math.random()*r.length)]}else t==="Medium"?s=Math.round(Oa(60+(Math.random()*30-15),30,100)):s=Math.round(Oa(80+(Math.random()*20-10),50,120));return e<=0?0:s>e?[100,85,81,60,57,45,41,26,22,20,1].find(l=>l<=e)??0:s}function Y1({onClose:e}){return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs("div",{className:"card max-w-lg w-full relative",children:[n.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:e,children:"Close"}),n.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations"}),n.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[n.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),n.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),n.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),n.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),n.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),n.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),n.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}function q1({user:e}){var Um,Fm,$m,zm,Hm;const{offlineLayout:t}=Yn(),[s,r]=m.useState("X01"),[l,a]=m.useState(501),[i,o]=m.useState("None"),[c,d]=m.useState(!1),[x,S]=m.useState(!1),[y,N]=m.useState(l),[w,T]=m.useState(l),[P,v]=m.useState(!1),[h,b]=m.useState(!1),[C,j]=m.useState(1),[f,R]=m.useState(0),[B,ee]=m.useState(0),[Y,$]=m.useState(null),[Q,D]=m.useState(1),[z,de]=m.useState(1),[I,G]=m.useState([]),[W,X]=m.useState(2e3),[Z,ie]=m.useState(!1),[J,me]=m.useState(t==="modern"),[pe,Me]=m.useState(t==="modern");m.useEffect(()=>{me(t==="modern"),Me(t==="modern")},[t]);const[Ne,Le]=m.useState(1),[ke,$e]=m.useState(!0),[ue,xe]=m.useState(0),[Re,ct]=m.useState(0),[nt,Ft]=m.useState(0),[M,O]=m.useState(0),[ze,Xe]=m.useState(0),[et,Mt]=m.useState(kr()),[St,Ze]=m.useState(Hs()),[gt,dt]=m.useState(Ws()),[yt,on]=m.useState(Vs()),[qn,vt]=m.useState(0),[pn,xn]=m.useState(1),[Tt,ne]=m.useState(27),[le,oe]=m.useState(0),[se,K]=m.useState(0),[Oe,ve]=m.useState(!1),[We,A]=m.useState(1),[U,ce]=m.useState(0),[je,ge]=m.useState(0),Ce=8,[he,Pe]=m.useState(1),[pt,Ve]=m.useState(0),[Lt,Vt]=m.useState(0),tn=10,[qe,Bn]=m.useState(1),[rt,xs]=m.useState(0),[gs,nn]=m.useState(0),cn=10,[Gt,Ms]=m.useState(170),[Ls,Qn]=m.useState(0),[Pt,At]=m.useState(0),[Rr,Ee]=m.useState(0),[Xn,Zn]=m.useState(121),[Or,Ae]=m.useState(0),[_e,He]=m.useState(0),[kt,Ct]=m.useState(0),[ut,mt]=m.useState(20),[$t,qt]=m.useState(0),[Br,es]=m.useState(0),[_r,Ur]=m.useState(Pa()),[Fr,$r]=m.useState(Aa()),[_n,zr]=m.useState(ru()),[Hr,Ge]=m.useState(Ra()),[bt,Ps]=m.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[ys,ts]=m.useState({}),[ql,ur]=m.useState({}),[Ql,Wr]=m.useState(!1),[Ke,ns]=m.useState(0),[ci,ss]=m.useState(0),[rs,As]=m.useState(null),[di,Cn]=m.useState(""),[Un,Vr]=m.useState(0),[En,ls]=m.useState(0),[gn,Tn]=m.useState(0),[Xl,Zl]=m.useState(l),[as,mr]=m.useState(0),[ea,is]=m.useState(0),[vs,Gr]=m.useState(0);m.useRef(null);const[os,Kr]=m.useState(0),[fr,Jr]=m.useState(0),[Fn,bs]=m.useState(0),[Yr,Rs]=m.useState(0),[qr,ta]=m.useState(0),[Qr,na]=m.useState(0),[Xr,sa]=m.useState(0),[Zr,ra]=m.useState(0),[hr,el]=m.useState(0),[pr,la]=m.useState(0),[aa,ia]=m.useState(0),[oa,ca]=m.useState(0),[ui,tl]=m.useState(0),[mi,nl]=m.useState(0),[fi,sl]=m.useState(0),[hi,u]=m.useState(0),[g,E]=m.useState(0),[k,V]=m.useState(0),[re,ae]=m.useState(0),[F,at]=m.useState(0),[lt,it]=m.useState(!1),[Qe,Ie]=m.useState(""),{favoriteDouble:we,callerEnabled:Os,callerVoice:pi,callerVolume:xi,speakCheckoutOnly:gi,rememberLastOffline:xr,setLastOffline:rc,autoStartOffline:fm,cameraScale:rl,setCameraScale:yi,cameraAspect:vi="wide",setCameraAspect:Ax}=Yn(),ll=m.useRef(null),al=m.useRef(null),lc=m.useRef(null),[il,ac]=m.useState("first"),[bi,hm]=m.useState(1),Rx=m.useRef(null);m.useEffect(()=>{const p=Math.max(1,Math.floor(Number(bi)||1)),L=il==="first"?p:Math.max(1,Math.ceil(p/2));j(L)},[il,bi]),m.useEffect(()=>{if(!pe){Le(1);return}const p=()=>{const H=ll.current,te=al.current;if(!H||!te)return;const Te=lc.current?lc.current.getBoundingClientRect().height:0,De=Math.max(0,H.clientHeight-Te-6),be=Math.max(0,H.clientWidth-8),ye=te.getBoundingClientRect(),Se=Ne||1,Be=ye.height/Se,It=ye.width/Se,In=De>0?De/Be:1,gr=be>0?be/It:1,$n=Math.min(1,Math.max(.5,Math.min(In,gr)));Le($n)};p();const L=window.ResizeObserver,_=L?new L(()=>p()):null;return _&&ll.current&&_.observe(ll.current),_&&al.current&&_.observe(al.current),window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p);try{_&&ll.current&&_.unobserve(ll.current)}catch{}try{_&&al.current&&_.unobserve(al.current)}catch{}}},[pe,Ne]),m.useEffect(()=>{const p=L=>{var H;const _=(H=L==null?void 0:L.detail)==null?void 0:H.mode;_&&(r(_),ol())};return window.addEventListener("ndn:auto-start",p),()=>window.removeEventListener("ndn:auto-start",p)},[]),m.useEffect(()=>{const p=L=>{var Te,De,be;const _=(Te=L==null?void 0:L.detail)==null?void 0:Te.formatType,H=(De=L==null?void 0:L.detail)==null?void 0:De.formatCount,te=(be=L==null?void 0:L.detail)==null?void 0:be.startScore;(_==="first"||_==="best")&&ac(_),typeof H=="number"&&isFinite(H)&&hm(Math.max(1,Math.floor(H))),typeof te=="number"&&isFinite(te)&&a(Math.max(1,Math.floor(te)))};return window.addEventListener("ndn:offline-format",p),()=>window.removeEventListener("ndn:offline-format",p)},[]),m.useEffect(()=>{if(!fm)return;const p=setTimeout(()=>ol(),50);return()=>clearTimeout(p)},[fm]),m.useEffect(()=>{if(!Z||ke||i==="None"||vs<=0)return;let p,L=performance.now();const _=H=>{const te=H-L;L=H,Gr(Te=>{const De=Te-te;if(De<=0){let be=0,ye=w;for(;be<3&&ye>0;){const Se=J1(ye,i),Be=Oa(Se-be*20,0,Math.min(60,ye)),It=ye-Be;if(Jr(Be),Kr($n=>$n+1),la($n=>$n+1),It<0){ye=w,bs(0),Rs(0);break}bs($n=>$n+Be),ca($n=>$n+Be);const In=ye,gr=It;if(In>50&&gr<=50?Rs(1):In<=50&&Rs($n=>$n+1),ye=It,be+=1,ye===0)break}if(T(ye),ye===0){Fn===180?u(Be=>Be+1):Fn>=140?E(Be=>Be+1):Fn>=100&&V(Be=>Be+1);const Se=w;Se<=170&&at(Be=>Math.max(Be,Se)),w<=50&&(sa(Be=>Be+(Yr>0?Yr:1)),ra(Be=>Be+1)),bs(0),Rs(0),$("ai"),b(!0)}return ye>0&&be>=3&&(Fn===180?u(Se=>Se+1):Fn>=140?E(Se=>Se+1):Fn>=100&&V(Se=>Se+1),bs(0),Rs(0)),$e(!0),0}return De}),vs>0&&(p=requestAnimationFrame(_))};return p=requestAnimationFrame(_),()=>cancelAnimationFrame(p)},[Z,ke,i,vs,w]);function ol(){S(!0),N(l),T(l),v(!1),ie(!0),$e(!0),xe(0),Vr(0),ls(0),Tn(0),Zl(l),mr(0),is(0),Gr(0),Kr(0),Jr(0),bs(0),$(null),R(0),ee(0),G([]),el(0),la(0),ia(0),ca(0),tl(0),nl(0),sl(0),u(0),E(0),V(0),ae(0),at(0),ta(0),na(0),sa(0),ra(0);const p=Math.max(1,Math.floor(Number(bi)||1));if(j(il==="first"?p:Math.max(1,Math.ceil(p/2))),xr)try{rc({mode:s,x01Start:l,firstTo:C,aiLevel:i})}catch{}}function Ox(){N(l),T(l),v(!1),ie(!0),$e(!0),xe(0),Vr(0),ls(0),Tn(0),Zl(l),mr(0),is(0),Gr(0),Kr(0),Jr(0),bs(0),$(null)}function pm(p){Tn(0),Zl(p===0?l:y),is(0),i!=="None"?($e(!1),Gr(W)):$e(!1)}function ic(p){const L=y-p,_=gn+1;if(ls(p),Vr(be=>be+1),el(be=>be+1),L<0){N(Xl),pm(Xl),xe(0),mr(0),is(0);return}N(L),Os&&so((e==null?void 0:e.username)||"Player",p,Math.max(L,0),pi,{volume:xi,checkoutOnly:gi}),Tn(_),mr(be=>be+p),ia(be=>be+p),xe(0);const H=y,te=L,Te=H>50&&te<=50,De=H<=50;if(Te?is(1):De&&is(be=>be+1),L===0){as+p===180?tl(ye=>ye+1):as+p>=140?nl(ye=>ye+1):as+p>=100&&sl(ye=>ye+1);const be=Xl;be<=170&&ae(ye=>Math.max(ye,be)),H<=50&&(ta(ye=>ye+(ea>0?ea:1)),na(ye=>ye+1)),$("player"),b(!0);return}_>=3&&(as+p===180?tl(be=>be+1):as+p>=140?nl(be=>be+1):as+p>=100&&sl(be=>be+1),pm(L),mr(0),is(0))}function xm(){const p=Oa(Math.round(Number(ue)||0),0,60);ic(p)}function gm(p){const L=Oa(Math.round(p||0),0,60);if(ls(L),Vr(_=>_+1),el(_=>_+1),tu(L,Re)){const _=nt+1;Ft(_),ct(H=>Math.min(20,H+1)),_>=21&&($("player"),b(!0))}xe(0)}function ym(){gm(Number(ue))}function vm(){const p=br(Qe);if(p==null){alert("Enter like D16, 50, 25, T20");return}gm(p),Ie("")}function bm(p,L,_){if(Oe)return;const H=pn,te=L==="DOUBLE"&&_===H||!L&&p===H*2;te&&K(Te=>Te+1),oe(Te=>{const De=Te+1;if(De>=3){const be=se+(te?1:0);be>0?ne(Se=>Se+be*H*2):ne(Se=>Se-H*2);const ye=H+1;return xn(ye),K(0),ye>20&&ve(!0),0}return De})}function Nm(){bm(Math.max(0,ue|0)),xe(0)}function wm(){xn(1),ne(27),oe(0),K(0),ve(!1)}function oc(p){ce(L=>L+Math.max(0,p|0)),ge(L=>{const _=L+1;return _>=3?(A(H=>H+1),0):_})}function cc(p){Ve(L=>L+Math.max(0,p|0)),Vt(L=>{const _=L+1;return _>=3?(Pe(H=>H+1),0):_})}function dc(p){xs(L=>L+Math.max(0,p|0)),nn(L=>{const _=L+1;return _>=3?(Bn(H=>H+1),0):_})}function jm(p,L,_,H,te,Te,De,be){const ye=p-De;if(!(ye<0))if(ye===0){if(be==="DOUBLE"||be==="INNER_BULL"){Te(Se=>Se+1),te(Se=>Se+1),H(()=>0),L(p);return}}else L(ye);H(Se=>{const Be=Se+1;return Be>=3?(te(It=>It+1),0):Be})}function Sm(p,L){jm(Gt,Ms,Ls,Qn,At,Ee,p,L),Ls+1>=3&&Ms(170)}function km(p,L){jm(Xn,Zn,Or,Ae,He,Ct,p,L),Or+1>=3&&Zn(121)}function Ni(p){const L=br(Qe);if(L==null){alert("Enter like T20, D16, 25, 50");return}const _=Qe.trim().toUpperCase(),H=_.startsWith("D")||_==="50"||_==="BULL"||_==="DBULL"||_==="IBULL"||_.includes("INNER");p?Sm(L,H?"DOUBLE":void 0):km(L,H?"DOUBLE":void 0),Ie("")}function Bx(){Ms(170),Qn(0),At(0),Ee(0)}function _x(){Zn(121),Ae(0),He(0),Ct(0)}function uc(p,L,_){L==="TRIPLE"&&_===ut?qt(H=>H+1):!L&&p===ut*3&&qt(H=>H+1),es(H=>H+1)}function Ux(){qt(0),es(0)}function Fx(p,L,_){Ur(H=>{const te={...H};return jx(te,p,L,_),te})}function $x(){Ur(Pa())}function zx(p,L,_){$r(H=>{const te={...H};return kx(te,p,L,_),te})}function Hx(){$r(Aa())}function Wx(p,L,_,H){zr(te=>{const Te={...te,board:[...te.board]};return Cx(Te,p,L,_,H),Te})}function Vx(){zr(ru())}function Gx(p,L,_){Ge(H=>{const te={...H,marks:{...H.marks}};return Ex(te,p,L,_,()=>!1),te})}function Cm(){Ge(Ra())}function mc(p,L,_){const H=Rt[M];let te=!1;if(typeof _=="number"&&_===H&&(L==="SINGLE"||L==="DOUBLE"||L==="TRIPLE")&&(te=!0),H===25&&(L==="BULL"||p===25)&&(te=!0),H===50&&(L==="INNER_BULL"||p===50)&&(te=!0),te||(p===H||p===H*2||p===H*3)&&(te=!0),te){const Te=ze+1;Xe(Te),O(De=>De+1)}}function Em(){mc(Math.max(0,ue|0)),xe(0)}function Tm(){const p=br(Qe);if(p==null){alert("Enter like T20, D5, 25, 50");return}mc(p),Ie("")}function Im(p,L,_){Mt(H=>{const te={...H,marks:{...H.marks}};return px(te,p,L,_,()=>!1),te}),vt(H=>{const te=H+1;return te>=3?0:te})}function Dm(){Im(Math.max(0,ue|0)),xe(0)}function Mm(p,L,_){Ze(H=>{const te={...H,turnHits:{...H.turnHits}};return xx(te,p,L,_),te}),vt(H=>{const te=H+1;return te>=3?(Ze(Te=>{const De={...Te,turnHits:{...Te.turnHits}};return gx(De),De}),0):te})}function Lm(){Mm(Math.max(0,ue|0)),xe(0)}function Pm(p,L,_){dt(H=>{const te={...H,targets:[...H.targets]};return yx(te,p,L,_),te}),vt(H=>{const te=H+1;return te>=3?(dt(Te=>{const De={...Te,targets:[...Te.targets]};return vx(De),De}),0):te})}function Am(){Pm(Math.max(0,ue|0)),xe(0)}function Rm(p,L,_){on(H=>{const te={...H};return bx(te,p,L,_),te}),vt(H=>{const te=H+1;return te>=3?(on(Te=>{const De={...Te};return Nx(De),De}),0):te})}function Om(){Rm(Math.max(0,ue|0)),xe(0)}function Bm(){const p=Qe.trim().toUpperCase();if(!p)return null;if(p==="50"||p==="BULL"||p==="DBULL"||p==="IBULL")return 50;if(p==="25"||p==="OBULL")return 25;const L=p.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!L)return null;const _=L[1]||"S",H=parseInt(L[2],10);return H<1||H>20?null:H*(_==="S"?1:_==="D"?2:3)}function fc(){const p=Bm();if(p==null){alert("Enter like T20, D16, 5, 25, 50");return}ic(p),Ie("")}function Kx(){gn!==0&&(N(p=>p+En),Tn(p=>Math.max(0,p-1)))}function _m(){const p=Bm();if(p==null){alert("Enter like T20, D16, 5, 25, 50");return}if(gn===0){fc();return}const L=En;N(_=>_+L),Tn(_=>Math.max(0,_-1)),setTimeout(()=>ic(p),0),Ie("")}function Jx(){const p=Y??"player",L=p==="player"?ea||void 0:Yr||void 0;G([...I,{winner:p,doubleDarts:Q,checkoutDarts:z,doublesAtt:L,doublesHit:1}]),b(!1);let H=f,te=B;if(Y==="player"?H+=1:Y==="ai"&&(te+=1),R(H),ee(te),$(null),H>=C||te>=C){try{gb(s,p==="player")}catch{}ie(!1),S(!1),N(l),T(l),it(!0);return}Ox()}const hc=!uh.includes(s)&&!(e!=null&&e.fullAccess||e!=null&&e.admin);return n.jsxs("div",{className:"card relative overflow-hidden",children:[n.jsxs("h2",{className:"text-2xl font-bold text-brand-700 mb-4",children:["Offline Game Modes ",t==="classic"?n.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle",children:"Classic layout"}):n.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),n.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[n.jsx("label",{className:"font-semibold",children:"Select game mode:"}),n.jsxs("select",{className:"input w-full",value:s,onChange:p=>r(p.target.value),children:[uh.map(p=>n.jsx("option",{value:p,children:p},p)),G1.map(p=>n.jsxs("option",{value:p,disabled:!(e!=null&&e.fullAccess||e!=null&&e.admin),children:[p," ",e!=null&&e.fullAccess||e!=null&&e.admin?"":"(Premium)"]},p))]}),!(e!=null&&e.fullAccess)&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),s==="X01"&&n.jsxs(n.Fragment,{children:[n.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),n.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:l,onChange:p=>a(Number(p.target.value))}),n.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),n.jsxs("select",{className:"input w-full",value:i,onChange:p=>o(p.target.value),children:[n.jsx("option",{value:"None",children:"None"}),K1.map(p=>n.jsx("option",{value:p,children:p},p))]}),i!=="None"&&n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[n.jsxs("div",{className:"sm:col-span-2",children:[n.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),n.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:W/1e3,onChange:p=>X(Math.round(Number(p.target.value)*1e3))})]}),n.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),n.jsx("button",{className:"btn mt-2",onClick:()=>d(!0),children:"X01 Rules & Regulations!"})]}),s==="Double Practice"&&n.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1  D20  DBULL in as few darts as possible. AI and X01 settings dont apply."})]}),!x&&n.jsx("button",{className:"btn",disabled:hc,title:hc?"PREMIUM required for this mode":"",onClick:ol,children:"Start Match"}),Z&&n.jsx("div",{className:`absolute inset-0 z-[1000] ${J?"":"flex items-center justify-center p-3 sm:p-4"}`,children:n.jsx(qs,{storageKey:"ndn:modal:offline-match",className:`${J?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:J,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:n.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pr-1 pt-2 pb-2",style:{overflowY:pe?"hidden":"auto"},ref:p=>{ll.current=p},children:[n.jsxs("div",{ref:p=>{lc.current=p},className:"sticky top-0 relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm",children:[n.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),n.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:[n.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),n.jsxs("span",{className:"font-medium whitespace-nowrap",children:[s,s==="X01"?` / ${l}`:""]}),n.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",C,"  Legs ",f,"-",B]}),n.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${t==="modern"?"bg-emerald-500/15 text-emerald-200 border-emerald-400/30":"bg-white/10 text-white/70 border-white/20"}`,children:t==="modern"?"Modern layout":"Classic layout"})]}),n.jsxs("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:[n.jsxs("div",{className:"hidden items-center gap-2 mr-2 text-xs",children:[n.jsx("span",{className:"opacity-80",children:"Cam"}),n.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>yi(Math.max(.5,Math.round((rl-.05)*100)/100)),title:"Decrease camera size",children:""}),n.jsxs("span",{className:"w-9 text-center",children:[Math.round(rl*100),"%"]}),n.jsx("button",{className:"btn btn--ghost px-2 py-1",onClick:()=>yi(Math.min(1.25,Math.round((rl+.05)*100)/100)),title:"Increase camera size",children:"+"})]}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:pe?"Actual Size":"Fit All",onClick:()=>Me(p=>!p),children:pe?"Actual Size":"Fit All"}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:J?"Restore":"Maximize",onClick:()=>me(p=>!p),children:J?"Restore":"Maximize"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ol()},children:"Restart"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>{ie(!1),S(!1)},children:"Quit"})]})]}),n.jsxs("div",{ref:p=>{al.current=p},className:"will-change-transform",style:pe?{transform:`scale(${Ne})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,Ne))}em`}:void 0,children:[n.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:s==="X01"?"X01 Match":s}),n.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",s]}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",l]}),n.jsxs("div",{ref:Rx,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[n.jsx("span",{children:"Format:"}),(()=>{const p=y!==l||w!==l||gn>0,L=`px-2 py-0.5 rounded border text-xs ${p?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{type:"button",className:`${L} ${il==="first"?"bg-indigo-500/20 text-indigo-100 border-indigo-400/30":"bg-white/10 text-white/80 border-white/20"}`,onClick:()=>{p||ac("first")},title:"First to N",children:"First to"}),n.jsx("button",{type:"button",className:`${L} ${il==="best"?"bg-indigo-500/20 text-indigo-100 border-indigo-400/30":"bg-white/10 text-white/80 border-white/20"}`,onClick:()=>{p||ac("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),n.jsx("input",{className:`input w-16 text-center ${p?"opacity-50":""}`,type:"number",min:1,step:1,value:bi,onChange:_=>hm(Math.max(1,Math.floor(Number(_.target.value)||1))),disabled:p,title:il==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",f,"",B]})]}),s!=="X01"?n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[s==="Double Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"Current Target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:((Um=Dn[Re])==null?void 0:Um.label)||""})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[nt," / 21"]})]}),s==="Around the Clock"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"Current Target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:Rt[M]===25?"25 (Outer Bull)":Rt[M]===50?"50 (Inner Bull)":Rt[M]||""})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[ze," / ",Rt.length]})]}),s==="Cricket"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket  Close 2015 and Bull; overflow scores points"}),n.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:ni.map(p=>{var L;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:p===25?"Bull":p}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((L=et.marks)==null?void 0:L[p])||0)," / 3"]})]},p)})}),n.jsxs("div",{className:"text-sm",children:["Points: ",n.jsx("span",{className:"font-semibold",children:et.points})]}),$1(et)&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{Mt(kr()),vt(0)},children:"Reset"})]})]}),s==="Shanghai"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Round"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:St.round})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",St.score]}),St.finished&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{Ze(Hs()),vt(0)},children:"Reset"})]})]}),s==="Halve It"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Stage"}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[gt.stage+1,"/",gt.targets.length]})]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:(()=>{const p=Ao(gt);return p?p.kind==="ANY_NUMBER"?"Any":p.kind==="BULL"?"Bull":p.kind==="DOUBLE"||p.kind==="TRIPLE"||p.kind==="NUMBER"?`${p.kind} ${p.num}`:"":""})()})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",gt.score]}),gt.finished&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{dt(Ws()),vt(0)},children:"Reset"})]})]}),s==="High-Low"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",yt.round,"  Target ",yt.target]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",yt.score]}),yt.finished&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{on(Vs()),vt(0)},children:"Reset"})]})]}),s==="Bob's 27"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Target"}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",pn]})]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Tt]}),Oe&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:wm,children:"Reset"})]})]}),s==="Count-Up"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",We,"/8"]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",U]})]}),s==="High Score"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",he,"/10"]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",pt]})]}),s==="Low Score"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",qe,"/10"]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",rt]})]}),s==="Checkout 170"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Gt}),n.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",Pt,"  Successes: ",Rr]})]}),s==="Checkout 121"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Xn}),n.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",_e,"  Successes: ",kt]})]}),s==="Treble Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",ut]}),n.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",$t]})]}),s==="Baseball"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:_r.inning}),n.jsxs("div",{className:"text-sm",children:["Score: ",n.jsx("span",{className:"font-semibold",children:_r.score})]})]}),s==="Golf"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Fr.hole}),n.jsxs("div",{className:"text-sm",children:["Strokes: ",n.jsx("span",{className:"font-semibold",children:Fr.strokes})]})]}),s==="Tic Tac Toe"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:_n.turn}),_n.finished&&n.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",_n.winner||""]})]}),s==="American Cricket"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 2012 and Bull; overflow scores points"}),n.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:sc.map(p=>{var L;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:p===25?"Bull":p}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((L=Hr.marks)==null?void 0:L[p])||0)," / 3"]})]},p)})}),n.jsxs("div",{className:"text-sm",children:["Points: ",n.jsx("span",{className:"font-semibold",children:Hr.points})]}),V1(Hr)&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:Cm,children:"Reset"})]})]}),s==="Killer"&&n.jsx(n.Fragment,{children:Ql?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{children:"Turn"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:((Fm=bt[Ke])==null?void 0:Fm.name)||""})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:rs?`${(($m=bt.find(p=>p.id===rs))==null?void 0:$m.name)||"Winner"} Wins`:di||"Ready"})]}):n.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):t==="modern"?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2 items-stretch min-w-0",children:[n.jsxs("div",{className:"flex flex-col gap-2 min-w-0",children:[n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col",children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"You Remain"}),ke?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:y}),n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-y/l)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:En})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:Un>0?((l-y)/Un*3).toFixed(1):"0.0"})]}),n.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[n.jsxs("span",{children:["Darts thrown: ",Un]}),n.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(p=>n.jsx("span",{className:`w-2 h-2 rounded-full ${p<gn?"bg-emerald-400":"bg-white/20"}`},p))})]}),n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",qr,"  Hit ",Qr]})]}),y<=170&&y>0&&(()=>{const L=Lo(y,we)[0]||"";return n.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[n.jsx("span",{className:"opacity-70",children:"Checkout"}),n.jsx("span",{className:"font-semibold",children:L})]})})()]}),n.jsxs("div",{className:"p-3 rounded-2xl bg-slate-900/40 border border-white/10 text-white text-sm",children:[n.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const p=ke?(e==null?void 0:e.username)||"You":i==="None"?"":`${i} AI`,L=ke?y:i==="None"?0:w,_=ke?En:fr,H=ke?as:Fn,te=ke?Un:os,Te=l-(ke?y:i==="None"?l:w),De=te>0?Te/te*3:0,be=`${f}-${B}`,ye=I.length>0?`${Math.min(...I.map(Se=>Se.doubleDarts+(Se.checkoutDarts||0)))||0} darts`:"";return n.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[n.jsx("div",{className:"opacity-80",children:"Current score"}),n.jsx("div",{className:"font-mono text-right",children:be}),n.jsx("div",{className:"opacity-80",children:"Current thrower"}),n.jsx("div",{className:"text-right font-semibold",children:p}),n.jsx("div",{className:"opacity-80",children:"Score remaining"}),n.jsx("div",{className:"text-right font-mono",children:L}),n.jsx("div",{className:"opacity-80",children:"3-dart avg"}),n.jsx("div",{className:"text-right font-mono",children:De.toFixed(1)}),n.jsx("div",{className:"opacity-80",children:"Last score"}),n.jsx("div",{className:"text-right font-mono",children:H||_}),n.jsx("div",{className:"opacity-80",children:"Best leg"}),n.jsx("div",{className:"text-right",children:ye})]})})()]}),n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col",children:[n.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[n.jsxs("span",{children:[i==="None"?"Opponent":`${i} AI`," Remain"]}),ke?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:i!=="None"?w:"N/A"}),i!=="None"&&n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-w/l)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:i==="None"?0:fr})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:i!=="None"?os>0?((l-w)/os*3).toFixed(1):"0.0":""})]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",os]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",Xr,"  Hit ",Zr]})]})]})]}),n.jsxs("div",{className:"md:col-span-2 min-w-0 space-y-2",children:[n.jsx("div",{className:"flex items-center gap-1.5 mt-1",children:n.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[n.jsx("span",{className:"opacity-70",children:"Cam"}),n.jsx("button",{className:"btn px-1 py-0.5",onClick:()=>yi(Math.max(.5,Math.round((rl-.05)*100)/100)),children:""}),n.jsxs("span",{className:"w-7 text-center",children:[Math.round(rl*100),"%"]}),n.jsx("button",{className:"btn px-1 py-0.5",onClick:()=>yi(Math.min(1.25,Math.round((rl+.05)*100)/100)),children:"+"}),n.jsx("span",{className:"opacity-50",children:"|"}),n.jsx("button",{className:"btn px-1 py-0.5",title:"Toggle camera aspect",onClick:()=>Ax(vi==="square"?"wide":"square"),children:vi==="square"?"Square":"Wide"})]})}),n.jsx("div",{className:"flex items-stretch justify-end min-w-0",children:n.jsx("div",{className:`w-full min-w-0 ${vi==="square"?"aspect-square":"aspect-video"} rounded-2xl overflow-hidden bg-black`,children:n.jsx(Po,{label:"Your Board",autoStart:!0})})})]})]}):n.jsx("div",{className:"grid grid-cols-1 md:[grid-template-columns:1fr_1.2fr_1fr] gap-2 mb-2 items-stretch min-w-0",children:n.jsxs("div",{className:"flex items-stretch justify-center md:px-3 min-w-0",children:[n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80",children:"You Remain"}),ke?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:y}),n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-y/l)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:En})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:Un>0?((l-y)/Un*3).toFixed(1):"0.0"})]}),n.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[n.jsxs("span",{children:["Darts thrown: ",Un]}),n.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(p=>n.jsx("span",{className:`w-2 h-2 rounded-full ${p<gn?"bg-emerald-400":"bg-white/20"}`},p))})]}),n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",qr,"  Hit ",Qr]})]}),y<=170&&y>0&&(()=>{const L=Lo(y,we)[0]||"";return n.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[n.jsx("span",{className:"opacity-70",children:"Checkout"}),n.jsx("span",{className:"font-semibold",children:L})]})})()]}),n.jsx("div",{className:"flex items-stretch justify-end md:px-3 min-w-0",children:n.jsx("div",{className:`w-full max-w-xl min-w-0 rounded-2xl overflow-hidden bg-black ${vi==="square"?"aspect-square":"aspect-video"}`,children:n.jsx(Po,{label:"Your Board",autoStart:!0})})}),n.jsxs("div",{className:"mt-2 p-3 rounded-2xl bg-slate-900/40 border border-white/10 text-white text-sm",children:[n.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const p=ke?(e==null?void 0:e.username)||"You":i==="None"?"":`${i} AI`,L=ke?y:i==="None"?0:w,_=ke?En:fr,H=ke?as:Fn,te=ke?Un:os,Te=l-(ke?y:i==="None"?l:w),De=te>0?Te/te*3:0,be=`${f}-${B}`,ye=I.length>0?`${Math.min(...I.map(Se=>Se.doubleDarts+(Se.checkoutDarts||0)))||0} darts`:"";return n.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[n.jsx("div",{className:"opacity-80",children:"Current score"}),n.jsx("div",{className:"font-mono text-right",children:be}),n.jsx("div",{className:"opacity-80",children:"Current thrower"}),n.jsx("div",{className:"text-right font-semibold",children:p}),n.jsx("div",{className:"opacity-80",children:"Score remaining"}),n.jsx("div",{className:"text-right font-mono",children:L}),n.jsx("div",{className:"opacity-80",children:"3-dart avg"}),n.jsx("div",{className:"text-right font-mono",children:De.toFixed(1)}),n.jsx("div",{className:"opacity-80",children:"Last score"}),n.jsx("div",{className:"text-right font-mono",children:H||_}),n.jsx("div",{className:"opacity-80",children:"Best leg"}),n.jsx("div",{className:"text-right",children:ye})]})})()]}),n.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[n.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[n.jsxs("span",{children:[i==="None"?"Opponent":`${i} AI`," Remain"]}),ke?n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),n.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:i!=="None"?w:"N/A"}),i!=="None"&&n.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:n.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-w/l)*100))}%`}})}),n.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart: ",n.jsx("span",{className:"font-semibold",children:i==="None"?0:fr})]}),n.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:i!=="None"?os>0?((l-w)/os*3).toFixed(1):"0.0":""})]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",os]}),i!=="None"&&n.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles: ",n.jsxs("span",{className:"font-semibold",children:["Att ",Xr,"  Hit ",Zr]})]})]})]})}),s!=="X01"?n.jsxs("div",{className:"space-y-2",children:[s==="Double Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"font-semibold",children:["Target: ",n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:((zm=Dn[Re])==null?void 0:zm.label)||""})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,onAutoDart:(p,L)=>{if((L==="DOUBLE"||L==="INNER_BULL")&&tu(p,Re)){const H=nt+1,te=Re+1;Ft(H),ct(te),H>=Dn.length&&setTimeout(()=>{Ft(0),ct(0)},250)}},immediateAutoCommit:!0})}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&ym()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ym,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{p.key==="Enter"&&vm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:vm,children:"Add"})]})]}),n.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",nt," of 21"]})]}),s==="Around the Clock"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"font-semibold",children:["Target: ",n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Rt[M]===25?"25 (Outer Bull)":Rt[M]===50?"50 (Inner Bull)":Rt[M]||""})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{mc(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&Em()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Em,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{p.key==="Enter"&&Tm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Tm,children:"Add"})]}),ze>=Rt.length&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed! ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{Xe(0),O(0)},children:"Reset"})]})]}),s==="Cricket"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{Im(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&Dm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Dm,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Mt(kr()),vt(0)},children:"Reset"})]})]}),s==="Shanghai"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{Mm(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&Lm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Lm,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ze(Hs()),vt(0)},children:"Reset"})]})]}),s==="Halve It"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{Pm(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&Am()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Am,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{dt(Ws()),vt(0)},children:"Reset"})]})]}),s==="High-Low"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{Rm(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&Om()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Om,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{on(Vs()),vt(0)},children:"Reset"})]})]}),s==="Bob's 27"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{bm(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&Nm()}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Nm,children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:wm,children:"Reset"})]})]}),s==="Count-Up"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:p=>oc(p)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&(oc(ue),xe(0))}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{oc(ue),xe(0)},children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{A(1),ce(0),ge(0)},children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",We,"/",Ce]})]}),s==="High Score"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:p=>cc(p)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&(cc(ue),xe(0))}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{cc(ue),xe(0)},children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Pe(1),Ve(0),Vt(0)},children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",he,"/",tn]})]}),s==="Low Score"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:p=>dc(p)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&(dc(ue),xe(0))}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{dc(ue),xe(0)},children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Bn(1),xs(0),nn(0)},children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",qe,"/",cn]})]}),s==="Checkout 170"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L)=>Sm(p,L==="MISS"?void 0:L)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{p.key==="Enter"&&Ni(!0)}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ni(!0),children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Bx,children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Gt,"  Attempts: ",Pt,"  Successes: ",Rr]})]}),s==="Checkout 121"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L)=>km(p,L==="MISS"?void 0:L)})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{p.key==="Enter"&&Ni(!1)}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Ni(!1),children:"Add Dart"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:_x,children:"Reset"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Xn,"  Attempts: ",_e,"  Successes: ",kt]})]}),s==="Treble Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm",children:"Target"}),n.jsx("select",{className:"input w-24",value:ut,onChange:p=>mt(parseInt(p.target.value,10)),children:Array.from({length:20},(p,L)=>L+1).map(p=>n.jsx("option",{value:p,children:p},p))}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ux,children:"Reset"})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{uc(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{if(p.key==="Enter"){const L=br(Qe);L!=null&&uc(L,void 0,void 0),Ie("")}}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const p=br(Qe);p!=null&&uc(p,void 0,void 0),Ie("")},children:"Add Dart"})]}),n.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",$t,"  Darts: ",Br]})]}),s==="Baseball"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{Fx(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:$x,children:"Reset"})})]}),s==="Golf"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{zx(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Hx,children:"Reset"})})]}),s==="Tic Tac Toe"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(p,L)=>L).map(p=>n.jsx("button",{className:`h-16 rounded-xl border ${_n.board[p]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(_n.finished||_n.board[p])return;const L=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),_=L%3===0?"TRIPLE":L%2===0?"DOUBLE":"SINGLE",H=p,te=dm[H],Te=te.type==="BULL"?null:te.num||null;Wx(H,L,_,Te)},children:_n.board[p]||""},p))}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Vx,children:"Reset"})})]}),s==="American Cricket"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{Gx(p,L==="MISS"?void 0:L,(_==null?void 0:_.sector)??null)}})}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Cm,children:"Reset"})})]}),s==="Killer"&&n.jsx(n.Fragment,{children:Ql?n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:bt.map(p=>{const L=ys[p.id],_=ql[p.id];return n.jsxs("div",{className:`p-2 rounded-xl border ${L!=null&&L.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[n.jsxs("div",{className:"flex items-center justify-between text-xs",children:[n.jsx("div",{className:"font-semibold",children:p.name}),n.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${L!=null&&L.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:L!=null&&L.isKiller?"Killer":"Not Killer"})]}),n.jsxs("div",{className:"mt-1 text-sm",children:["Number: ",n.jsx("span",{className:"font-semibold",children:_})]}),n.jsxs("div",{className:"text-sm",children:["Lives: ",n.jsx("span",{className:"font-semibold",children:(L==null?void 0:L.lives)??0})]})]},p.id)})}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(p,L,_)=>{if(rs)return;const H=L==="MISS"?void 0:L,te=(_==null?void 0:_.sector)??null,Te=bt[Ke];Te&&(ts(De=>{const be={};Object.keys(De).forEach(Be=>be[Be]={...De[Be]});const ye=nu(Te.id,be,H,te);if(ye.becameKiller)Cn(`${Te.name} became a Killer`);else if(ye.victimId){const Be=bt.find(It=>It.id===ye.victimId);Cn(`${Te.name} hit ${Be==null?void 0:Be.name}'s ${ql[ye.victimId]} (${ye.livesRemoved} life${(ye.livesRemoved||0)>1?"s":""})`)}else Cn("No effect");const Se=su(be);return Se&&As(Se),be}),ss(De=>{const be=De+1;if(be>=3){let ye=Ke;for(let Se=1;Se<=bt.length;Se++){const Be=(Ke+Se)%bt.length,It=bt[Be].id,In=ys[It];if(In&&!In.eliminated&&In.lives>0){ye=Be;break}}return ns(ye),0}return be}))}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{if(p.key==="Enter"){if(rs)return;const _=Qe.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!_){Ie("");return}const H=_[1]||"S",te=parseInt(_[2],10),Te=H==="D"?"DOUBLE":H==="T"?"TRIPLE":"SINGLE",De=bt[Ke];ts(be=>{const ye={};Object.keys(be).forEach(It=>ye[It]={...be[It]});const Se=nu(De.id,ye,Te,te);if(Se.becameKiller)Cn(`${De.name} became a Killer`);else if(Se.victimId){const It=bt.find(In=>In.id===Se.victimId);Cn(`${De.name} hit ${It==null?void 0:It.name}'s ${ql[Se.victimId]} (${Se.livesRemoved} life${(Se.livesRemoved||0)>1?"s":""})`)}else Cn("No effect");const Be=su(ye);return Be&&As(Be),ye}),Ie(""),ss(be=>{const ye=be+1;if(ye>=3){let Se=Ke;for(let Be=1;Be<=bt.length;Be++){const It=(Ke+Be)%bt.length,In=bt[It].id,gr=ys[In];if(gr&&!gr.eliminated&&gr.lives>0){Se=It;break}}return ns(Se),0}return ye})}}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let p=Ke;for(let L=1;L<=bt.length;L++){const _=(Ke+L)%bt.length,H=bt[_].id,te=ys[H];if(te&&!te.eliminated&&te.lives>0){p=_;break}}ns(p),ss(0)},children:"Next Player"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ts({}),ur({}),Wr(!1),ns(0),ss(0),As(null),Cn("")},children:"Reset"})]}),rs&&n.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner: ",(Hm=bt.find(p=>p.id===rs))==null?void 0:Hm.name," ",n.jsx("button",{className:"ml-2 underline",onClick:()=>{ts({}),ur({}),Wr(!1),ns(0),ss(0),As(null),Cn("")},children:"Play Again"})]})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"font-semibold",children:"Players"}),n.jsx("div",{className:"space-y-1",children:bt.map((p,L)=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input",value:p.name,onChange:_=>{const H=_.target.value;Ps(te=>te.map((Te,De)=>De===L?{...Te,name:H}:Te))}}),n.jsx("button",{className:"btn px-2 py-1",onClick:()=>Ps(_=>_.filter((H,te)=>te!==L)),disabled:bt.length<=2,children:"Remove"})]},p.id))}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn px-2 py-1",onClick:()=>Ps(p=>{const L=`p${p.length+1}`;return[...p,{id:L,name:`Player ${p.length+1}`}]}),children:"Add Player"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(bt.length<2){alert("Need at least 2 players");return}const p=bt.map(H=>H.id),L=H1(p),_={};p.forEach(H=>{_[H]=wx(L[H])}),ur(L),ts(_),ns(0),ss(0),As(null),Cn("Assigned numbers"),Wr(!0)},children:"Assign Numbers & Start"})]})]})})]}):ke?n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"font-semibold",children:"Your Turn"}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:ue,onChange:p=>xe(Number(p.target.value||0)),onKeyDown:p=>{p.key==="Enter"&&(p.shiftKey?Kx():xm())}}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:xm,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D16, 5, 25, 50)",value:Qe,onChange:p=>Ie(p.target.value),onKeyDown:p=>{p.key==="Enter"&&(p.shiftKey?_m():fc())}}),n.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:_m,disabled:gn===0,children:"Replace Last"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:fc,children:"Add"})]})]}),n.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Enter to Add  Shift+Enter to Replace Last"})]}):n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"font-semibold",children:[i==="None"?"Opponent":`${i} AI`," Turn"]}),i!=="None"?n.jsxs("div",{className:"text-sm text-slate-300",children:["Throwing in ",Math.ceil(vs/1e3),"s..."]}):n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn",onClick:()=>$e(!0),children:"Switch Back to You"})})]}),n.jsx("div",{className:"h-1"})]})]})})}),c&&n.jsx(Y1,{onClose:()=>d(!1)}),hc&&n.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),n.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),n.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),n.jsxs("a",{href:"https://buy.stripe.com/test_00g7vQ8Qw2gQ0wA5kk",target:"_blank",rel:"noopener noreferrer",className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM  ",Up(Fp(),5)]})]})]}),h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:n.jsxs(qs,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,children:[n.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),n.jsx("label",{className:"block mb-1",children:"Darts to hit double:"}),n.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(p=>n.jsx("button",{className:`btn ${Q===p?"bg-brand-600":""}`,onClick:()=>D(p),children:p},p))}),n.jsx("label",{className:"block mb-1",children:"Darts for checkout:"}),n.jsx("div",{className:"flex gap-2 mb-2",children:[1,2,3].map(p=>n.jsx("button",{className:`btn ${z===p?"bg-brand-600":""}`,onClick:()=>de(p),children:p},p))}),n.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[n.jsx("button",{className:"btn w-full",onClick:Jx,children:"Submit"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{b(!1),ol()},children:"Rematch"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{b(!1),ie(!1),S(!1)},children:"Back to Menu"})]})]})}),lt&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:n.jsxs(qs,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,children:[n.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),n.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[s,"  ",l," start  First to ",C]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[n.jsx("div",{className:"text-sm font-semibold mb-1",children:"You"}),n.jsx("div",{className:"text-3xl font-extrabold",children:f}),n.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),n.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"3-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:hr>0?(aa/hr*3).toFixed(1):"0.0"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"1-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:hr>0?(aa/hr).toFixed(2):"0.00"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"180s"}),n.jsx("div",{className:"font-semibold",children:ui})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"140+"}),n.jsx("div",{className:"font-semibold",children:mi})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"100+"}),n.jsx("div",{className:"font-semibold",children:fi})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"High Checkout"}),n.jsx("div",{className:"font-semibold",children:re||""})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Att"}),n.jsx("div",{className:"font-semibold",children:qr})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Hit"}),n.jsx("div",{className:"font-semibold",children:Qr})]})]})]}),n.jsx("div",{className:"hidden md:flex items-center justify-center",children:n.jsxs("div",{className:"text-4xl font-black",children:[f,"  ",B]})}),n.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[n.jsx("div",{className:"text-sm font-semibold mb-1",children:i==="None"?"Opponent":`${i} AI`}),n.jsx("div",{className:"text-3xl font-extrabold",children:B}),n.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),n.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"3-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:pr>0?(oa/pr*3).toFixed(1):"0.0"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"1-Dart Avg"}),n.jsx("div",{className:"font-semibold",children:pr>0?(oa/pr).toFixed(2):"0.00"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"180s"}),n.jsx("div",{className:"font-semibold",children:hi})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"140+"}),n.jsx("div",{className:"font-semibold",children:g})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"100+"}),n.jsx("div",{className:"font-semibold",children:k})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"High Checkout"}),n.jsx("div",{className:"font-semibold",children:F||""})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Att"}),n.jsx("div",{className:"font-semibold",children:Xr})]}),n.jsxs("div",{children:[n.jsx("span",{className:"opacity-70",children:"Dbl Hit"}),n.jsx("div",{className:"font-semibold",children:Zr})]})]})]})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:I.map((p,L)=>n.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${p.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",L+1,": ",p.winner==="player"?"You":i==="None"?"Opp":"AI","  Dbl ",p.doubleDarts,"  CO ",p.checkoutDarts]},L))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>it(!1),children:"Close"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{it(!1),ol()},children:"Rematch"})]})]})}),I.length>0&&n.jsxs("div",{className:"mt-4",children:[n.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),n.jsx("ul",{children:I.map((p,L)=>n.jsxs("li",{children:["Leg ",L+1,": Double darts: ",p.doubleDarts,", Checkout darts: ",p.checkoutDarts]},L))})]})]})}const Tx="ndn:messages:inbox",Ix="ndn:messages:unread";function Q1(){try{const e=localStorage.getItem(Tx),t=e?JSON.parse(e):[],s=Number(localStorage.getItem(Ix)||"0")||0;return{inbox:Array.isArray(t)?t.filter(l=>l&&typeof l.id=="string").slice(0,200):[],unread:s}}catch{return{inbox:[],unread:0}}}function zi(e,t){try{localStorage.setItem(Tx,JSON.stringify(e))}catch{}try{localStorage.setItem(Ix,String(t))}catch{}}const mh=Q1(),lu=Jl((e,t)=>({inbox:mh.inbox,unread:mh.unread,inGame:!1,setInGame:s=>e({inGame:s}),add:s=>e(r=>{const l=r.inbox.some(o=>o.id===s.id&&o.ts===s.ts),a=l?r.inbox:[s,...r.inbox].slice(0,200),i=r.unread+(l?0:1);return zi(a,i),{inbox:a,unread:i}}),load:s=>e(r=>{const l=[...s].sort((a,i)=>i.ts-a.ts).slice(0,200);return zi(l,r.unread),{inbox:l,unread:r.unread}}),markAllRead:()=>{const s=t();zi(s.inbox,0),e({unread:0})},remove:s=>e(r=>{const l=r.inbox.filter(i=>i.id!==s),a=r.unread;return zi(l,a),{inbox:l,unread:a}})})),Dx=[/\b(f+[\W_]*u+[\W_]*c+[\W_]*k+)\b/gi,/\b(s+[\W_]*h+[\W_]*i+[\W_]*t+)\b/gi,/\b(b+[\W_]*i+[\W_]*t+[\W_]*c+[\W_]*h+)\b/gi,/\b(a+[\W_]*s+[\W_]*s+[\W_]*h+[\W_]*o+[\W_]*l+[\W_]*e+)\b/gi,/\b(d+[\W_]*a+[\W_]*m+[\W_]*n+)\b/gi,/\b(c+[\W_]*r+[\W_]*a+[\W_]*p+)\b/gi,/\b(p+[\W_]*i+[\W_]*s+[\W_]*s+)\b/gi];function X1(e){return e.replace(/[\p{L}\p{N}]/gu,"*")}function Mx(e){if(!e)return e;let t=e;for(const s of Dx)t=t.replace(s,r=>X1(r));return t}function Z1(e){return e?Dx.some(t=>t.test(e)):!1}function um({tabs:e,active:t,onChange:s,className:r}){return n.jsxs("div",{className:`relative ${r||""}`,children:[n.jsx("div",{className:"absolute inset-0 rounded-xl bg-white/5 backdrop-blur-md border border-white/10 pointer-events-none"}),n.jsx("div",{className:"relative overflow-x-auto no-scrollbar py-1 px-1",children:n.jsx("div",{className:"flex items-center gap-2 min-w-max",children:e.map(l=>{const a=l.key===t;return n.jsx("button",{type:"button",onClick:()=>s(l.key),className:`transition-all select-none whitespace-nowrap rounded-full px-4 py-2 text-sm font-semibold shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60 active:scale-[0.98]
                  ${a?"bg-gradient-to-r from-indigo-500 to-fuchsia-500 text-white shadow-indigo-500/30":"bg-white/10 text-slate-100 hover:bg-white/15"}
                `,"aria-pressed":a,children:l.label},l.key)})})}),n.jsx("style",{children:`
        /* Hide scrollbars on WebKit/Firefox for a cleaner pill row */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      `})]})}function eN(e){if(!e)return"";const t=Math.floor((Date.now()-e)/1e3);if(t<60)return`${t}s ago`;const s=Math.floor(t/60);if(s<60)return`${s}m ago`;const r=Math.floor(s/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}function tN({user:e}){const t=Ml(),s=String((e==null?void 0:e.email)||"").toLowerCase(),[r,l]=m.useState([]),[a,i]=m.useState([]),[o,c]=m.useState([]),[d,x]=m.useState(""),[S,y]=m.useState("all"),[N,w]=m.useState(!1),T=lu(),[P,v]=m.useState([]),[h,b]=m.useState([]),[C,j]=m.useState({show:!1});async function f(){if(s)try{const[D,z,de,I]=await Promise.all([fetch(`/api/friends/list?email=${encodeURIComponent(s)}`).then(G=>G.json()),fetch(`/api/friends/suggested?email=${encodeURIComponent(s)}`).then(G=>G.json()),fetch(`/api/friends/requests?email=${encodeURIComponent(s)}`).then(G=>G.json()),fetch(`/api/friends/outgoing?email=${encodeURIComponent(s)}`).then(G=>G.json())]);l(D.friends||[]),i(z.suggestions||[]),v(de.requests||[]),b(I.requests||[])}catch{}}m.useEffect(()=>{f()},[s]);async function R(D){if(x(D),!D){c([]);return}try{const de=await(await fetch(`/api/friends/search?q=${encodeURIComponent(D)}`)).json();c(de.results||[])}catch{}}async function B(D){if(!(!s||!D)){w(!0);try{await fetch("/api/friends/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,friend:D})}),await f(),x(""),c([]),t("Friend added",{type:"success"})}finally{w(!1)}}}async function ee(D){if(!(!s||!D)){w(!0);try{await fetch("/api/friends/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,friend:D})}),await f(),t("Friend removed",{type:"info"})}finally{w(!1)}}}const Y=m.useMemo(()=>S==="all"?r:r.filter(D=>(D.status||"offline")===S),[r,S]);async function $(D){if(!D){t("Room unavailable",{type:"error"});return}try{const z=new CustomEvent("ndn:spectate-request",{detail:{roomId:D}});window.dispatchEvent(z),t("Opening spectator view",{type:"info"})}catch{}}const Q=P.length+h.length;return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Friends"}),n.jsx("p",{className:"mb-2 text-brand-600",children:"Manage your friends. See whos online, in-game, or offline; find new teammates; and invite people to play."}),n.jsxs("div",{className:"text-xs opacity-70 mb-3",children:["Online: ",r.filter(D=>D.status==="online").length,"  In-game: ",r.filter(D=>D.status==="ingame").length,"  Offline: ",r.filter(D=>!D.status||D.status==="offline").length]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[n.jsxs("div",{className:"md:col-span-2 p-3 rounded-2xl bg-black/30 border border-white/10",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("div",{className:"font-semibold text-white/90",children:"Your Friends"})}),n.jsx(um,{tabs:[{key:"all",label:"All"},{key:"online",label:"Online"},{key:"ingame",label:"In-Game"},{key:"offline",label:"Offline"},{key:"requests",label:`Requests ${Q>0?"("+Q+")":""}`}],active:S,onChange:D=>y(D),className:"mb-3"}),S==="requests"?n.jsx("ul",{className:"space-y-2",children:Q>0?n.jsxs(n.Fragment,{children:[P.length>0&&P.map(D=>n.jsxs("li",{className:"p-3 rounded bg-black/20 flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-semibold text-lg",children:D.fromUsername||D.fromEmail||"Unknown User"}),n.jsx("span",{className:"text-xs bg-blue-600/20 text-blue-400 px-2 py-1 rounded",children:"Incoming"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{w(!0);try{if((await fetch("/api/friends/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,requester:D.fromEmail})})).ok){v(I=>I.filter(G=>G.id!==D.id));const de={email:D.fromEmail,username:D.fromUsername,status:"offline"};l(I=>[...I,de]),b(I=>I.filter(G=>G.toEmail!==D.fromEmail)),t("Friend request accepted",{type:"success"}),setTimeout(()=>f(),100)}else t("Failed to accept request",{type:"error"})}catch{t("Error accepting request",{type:"error"})}finally{w(!1)}},children:"Accept"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:async()=>{w(!0);try{(await fetch("/api/friends/decline",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,requester:D.fromEmail})})).ok?(v(de=>de.filter(I=>I.id!==D.id)),b(de=>de.filter(I=>I.toEmail!==D.fromEmail)),t("Friend request declined",{type:"info"}),setTimeout(()=>f(),100)):t("Failed to decline request",{type:"error"})}finally{w(!1)}},children:"Decline"})]})]},`incoming-${D.id||D.fromEmail}`)),h.length>0&&h.map(D=>n.jsxs("li",{className:"p-3 rounded bg-black/20 flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-semibold text-lg",children:D.toUsername||D.toEmail||"Unknown User"}),n.jsx("span",{className:"text-xs bg-amber-600/20 text-amber-400 px-2 py-1 rounded",children:"Pending"})]}),n.jsx("button",{className:"btn bg-slate-600 hover:bg-slate-700 self-start",onClick:async()=>{w(!0);try{(await fetch("/api/friends/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,friend:D.toEmail})})).ok?(b(de=>de.filter(I=>I.id!==D.id)),t("Friend request cancelled",{type:"info"}),setTimeout(()=>f(),100)):t("Failed to cancel request",{type:"error"})}finally{w(!1)}},children:"Cancel"})]},`outgoing-${D.id||D.toEmail}`))]}):n.jsx("li",{className:"text-sm opacity-70",children:"No friend requests yet."})}):n.jsxs("ul",{className:"space-y-2",children:[Y.map(D=>n.jsxs("li",{className:"p-2 rounded bg-black/20 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${D.status==="online"?"bg-emerald-400":D.status==="ingame"?"bg-amber-400":"bg-slate-400"}`}),n.jsx("span",{className:"font-semibold",children:D.username||D.email}),n.jsxs("span",{className:"text-xs opacity-70",children:[D.status||"offline",D.status!=="online"&&D.lastSeen?`  ${eN(D.lastSeen)}`:""]}),D.status==="ingame"&&D.match&&n.jsxs("span",{className:"text-[10px] opacity-70 px-2 py-0.5 rounded bg-indigo-500/20 border border-indigo-600/30",children:[D.match.game," ",D.match.mode==="firstto"?"FT":"BO"," ",D.match.value,D.match.game==="X01"&&D.match.startingScore?`  ${D.match.startingScore}`:""]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[D.status==="ingame"&&D.roomId&&n.jsx("button",{className:"btn",onClick:()=>$(D.roomId),children:"Spectate"}),n.jsx("button",{className:"btn",disabled:N||D.status!=="online"&&D.status!=="ingame",onClick:async()=>{w(!0);try{const de=await(await fetch("/api/friends/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromEmail:s,toEmail:D.email,game:"X01",mode:"bestof",value:3,startingScore:501})})).json().catch(()=>({}));de!=null&&de.delivered?t("Invite sent",{type:"success"}):t("Friend is offline; invite queued",{type:"info"})}finally{w(!1)}},children:"Invite"}),n.jsx("button",{className:"btn",disabled:N,onClick:()=>j({show:!0,toUser:D.username||D.email,toEmail:D.email}),children:"Message"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:N,onClick:()=>ee(D.email),children:"Remove"})]})]},D.email)),Y.length===0&&n.jsxs("li",{className:"text-sm opacity-70",children:["No friends ",S!=="all"?`in ${S}`:""," yet."]})]})]}),n.jsxs("div",{className:"p-3 rounded-2xl bg-black/20 border border-white/10",children:[n.jsx("div",{className:"font-semibold mb-2 text-white/90",children:"Find Friends"}),n.jsx("input",{className:"input w-full mb-2",placeholder:"Search by name or email",value:d,onChange:D=>R(D.target.value)}),n.jsxs("ul",{className:"space-y-1 mb-3 max-h-48 overflow-auto",children:[o.map(D=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/10",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${D.status==="online"?"bg-emerald-400":D.status==="ingame"?"bg-amber-400":"bg-slate-400"}`}),n.jsx("span",{children:D.username||D.email})]}),n.jsx("button",{className:"btn",disabled:N,onClick:()=>B(D.email),children:"Add"})]},D.email)),o.length===0&&n.jsx("li",{className:"text-xs opacity-60",children:"Type to search"})]}),n.jsx("div",{className:"font-semibold mb-1 text-white/90",children:"Suggested"}),n.jsxs("ul",{className:"space-y-1 max-h-48 overflow-auto",children:[a.map(D=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/10",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${D.status==="online"?"bg-emerald-400":D.status==="ingame"?"bg-amber-400":"bg-slate-400"}`}),n.jsx("span",{children:D.username||D.email})]}),n.jsx("button",{className:"btn",disabled:N,onClick:()=>B(D.email),children:"Add"})]},D.email)),a.length===0&&n.jsx("li",{className:"text-xs opacity-60",children:"No suggestions right now."})]})]})]}),n.jsxs("div",{className:"p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:"Messages"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>T.markAllRead(),children:"Mark all read"})]}),T.inbox.length===0?n.jsx("div",{className:"text-sm opacity-70",children:"No messages yet."}):n.jsx("ul",{className:"space-y-2 max-h-72 overflow-auto",children:T.inbox.map(D=>n.jsxs("li",{className:"p-2 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:D.from})," ",n.jsxs("span",{className:"opacity-70 text-xs",children:[" ",new Date(D.ts).toLocaleString()]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn px-2 py-1 text-xs",onClick:()=>j({show:!0,toUser:D.from,toEmail:D.from,replyTo:D.from}),children:"Reply"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-2 py-1 text-xs",title:"Delete this message",onClick:()=>T.remove(D.id),children:"Delete"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-2 py-1 text-xs",onClick:async()=>{const z=prompt("Report reason (what happened)?");if(z)try{await fetch("/api/friends/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reporterEmail:s,offenderEmail:D.from,reason:z,messageId:D.id})}),t("Report sent to admin",{type:"info"})}catch{}},children:"Report"})]})]}),n.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:Mx(D.message)})]},D.id))})]}),C.show&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4",children:[n.jsx("div",{className:"text-center mb-4",children:n.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Type Message To ",C.toUser]})}),n.jsx("textarea",{className:"w-full h-32 bg-slate-700 border border-slate-600 rounded p-3 text-white placeholder-slate-400 resize-none",placeholder:"Type your message here...",id:"message-input",autoFocus:!0}),n.jsxs("div",{className:"flex gap-3 mt-4",children:[n.jsx("button",{className:"flex-1 btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{var de;const D=document.getElementById("message-input"),z=(de=D==null?void 0:D.value)==null?void 0:de.trim();if(z){w(!0);try{await fetch("/api/friends/message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromEmail:s,toEmail:C.toEmail,message:z})}),t("Message sent",{type:"success"}),j({show:!1})}catch{t("Failed to send message",{type:"error"})}finally{w(!1)}}},disabled:N,children:"Send"}),n.jsx("button",{className:"flex-1 btn bg-slate-600 hover:bg-slate-700",onClick:()=>j({show:!1}),children:"Cancel"})]})]})})]})}function nN(){const e=Yd(s=>s.toasts),t=Yd(s=>s.remove);return e.length?n.jsxs(n.Fragment,{children:[e.filter(s=>s.type==="success").map(s=>n.jsx("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50",children:n.jsx("div",{className:"p-4 rounded-lg shadow-lg border text-sm bg-emerald-700/90 border-emerald-500/60 text-white max-w-sm text-center",children:n.jsx("div",{className:"flex items-center justify-center gap-2",children:n.jsx("span",{className:"flex-1 font-semibold",children:s.message})})})},s.id)),e.filter(s=>s.type!=="success").length>0&&n.jsx("div",{className:"fixed bottom-4 right-4 z-50 space-y-2 sm:right-4 sm:left-auto left-1/2 -translate-x-1/2 sm:translate-x-0 w-[calc(100%-1.5rem)] sm:w-auto max-w-sm",children:e.filter(s=>s.type!=="success").map(s=>n.jsx("div",{className:`p-3 rounded-lg shadow-lg border text-sm ${s.type==="error"?"bg-rose-700/80 border-rose-500/60 text-white":"bg-black/70 border-slate-700 text-slate-100"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"flex-1",children:s.message}),n.jsx("button",{className:"btn btn--ghost px-2 py-1 text-xs",onClick:()=>t(s.id),children:"Dismiss"})]})},s.id))})]}):null}function au({data:e,height:t=220,barWidth:s=28,gap:r=6,showValues:l=!1}){const a=Math.max(1,...e.map(o=>o.value)),i=e.length*(s+r);return n.jsx("div",{className:"w-full overflow-x-auto",children:n.jsx("div",{className:"relative",style:{height:t,width:Math.max(600,i)},children:n.jsx("div",{className:"absolute inset-0 flex items-end",children:e.map((o,c)=>{const d=Math.round(o.value/a*(t-40));return n.jsxs("div",{className:"flex flex-col items-center justify-end",style:{width:s,marginRight:r},children:[n.jsx("div",{className:"w-full rounded-t-md bg-gradient-to-b from-indigo-400 to-fuchsia-500 shadow-sm",style:{height:d},title:`${o.label}: ${o.value}`}),l&&n.jsx("div",{className:"text-[10px] mt-1 opacity-80",children:o.value}),n.jsx("div",{className:"text-[10px] mt-1 opacity-70 select-none",children:o.label})]},c)})})})})}const sN=["X01","Double Practice"],_s=["Around the Clock","Cricket","Halve It","Shanghai","High-Low","Killer","Bob's 27","Count-Up","High Score","Low Score","Checkout 170","Checkout 121","Treble Practice","Baseball","Golf","Tic Tac Toe","American Cricket"],Wl=[...sN,..._s],fh="daviesfamily108@gmail.com";function rN({user:e}){var ct,nt,Ft;const[t,s]=m.useState([]),[r,l]=m.useState(""),[a,i]=m.useState(null),[o,c]=m.useState(""),[d,x]=m.useState(!1),[S,y]=m.useState([]),[N,w]=m.useState([]),[T,P]=m.useState({title:"Official Tournament",game:"X01",mode:"bestof",value:3,description:"",startAt:new Date(Date.now()+2*60*60*1e3).toISOString().slice(0,16),checkinMinutes:30,capacity:16,prizeType:"premium",prizeAmount:0,currency:"GBP",prizeNotes:""}),[v,h]=m.useState({reset:{},reminder:{},confirmEmail:{},changed:{}}),[b,C]=m.useState({open:!1}),j=((ct=e==null?void 0:e.email)==null?void 0:ct.toLowerCase())===fh,[f,R]=m.useState([]),[B,ee]=m.useState([]),[Y,$]=m.useState(0);m.useEffect(()=>{const M=()=>$(O=>O+1);return window.addEventListener("ndn:stats-updated",M),()=>window.removeEventListener("ndn:stats-updated",M)},[]);const Q=m.useMemo(()=>nm(Wl),[Y]),D=m.useMemo(()=>Wl.map(M=>{var O,ze;return{label:M,value:((O=Q[M])==null?void 0:O.played)||0,won:((ze=Q[M])==null?void 0:ze.won)||0}}),[Q]);async function z(){try{const O=await(await fetch("/api/admins")).json();if(s(Array.isArray(O.admins)?O.admins:[]),j){const ze=await fetch(`/api/admin/status?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);ze.ok&&i(await ze.json());const Xe=await fetch(`/api/admin/tournaments?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(Xe.ok){const Ze=await Xe.json();y(Array.isArray(Ze.tournaments)?Ze.tournaments:[])}const et=await fetch(`/api/admin/reports?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(et.ok){const Ze=await et.json();ee(Array.isArray(Ze.reports)?Ze.reports:[])}const Mt=await fetch(`/api/admin/premium-winners?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(Mt.ok){const Ze=await Mt.json();R(Array.isArray(Ze.winners)?Ze.winners:[])}const St=await fetch(`/api/admin/wallet/withdrawals?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(St.ok){const Ze=await St.json();w(Array.isArray(Ze.withdrawals)?Ze.withdrawals:[])}}}catch{}}m.useEffect(()=>{z()},[]);async function de(){r&&(await fetch("/api/admins/grant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,requesterEmail:e==null?void 0:e.email})}),l(""),z())}async function I(M){await fetch("/api/admins/revoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:M,requesterEmail:e==null?void 0:e.email})}),z()}async function G(M,O){M&&(await fetch("/api/admin/premium/grant",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:M,days:O,requesterEmail:e==null?void 0:e.email})}),await z())}async function W(M){await fetch("/api/admin/premium/revoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:M,requesterEmail:e==null?void 0:e.email})}),await z()}async function X(M){x(!0);try{await fetch("/api/admin/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:M,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function Z(){if(o.trim()){x(!0);try{await fetch("/api/admin/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:o,requesterEmail:e==null?void 0:e.email})}),c(""),await z()}finally{x(!1)}}}async function ie(M){x(!0);try{await fetch("/api/admin/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullAccess:M,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function J(){x(!0);try{const M=new Date(T.startAt).getTime();await fetch("/api/tournaments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:T.title,game:T.game,mode:T.mode,value:Number(T.value),description:T.description,startAt:M,checkinMinutes:Number(T.checkinMinutes),capacity:Number(T.capacity),creatorEmail:e==null?void 0:e.email,creatorName:e==null?void 0:e.username,requesterEmail:e==null?void 0:e.email,official:!0,prizeType:T.prizeType,prizeAmount:Number(T.prizeAmount||0),currency:T.currency,prizeNotes:T.prizeNotes})}),await z()}finally{x(!1)}}async function me(M,O){x(!0);try{await fetch("/api/admin/tournaments/winner",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:M,winnerEmail:O,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function pe(M){x(!0);try{await fetch("/api/admin/tournaments/mark-paid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:M,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function Me(M){x(!0);try{await fetch("/api/admin/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:M,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function Ne(){x(!0);try{await fetch("/api/admin/tournaments/reseed-weekly",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function Le(M,O){x(!0);try{await fetch("/api/admin/wallet/withdrawals/decide",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:M,approve:O,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function ke(M){x(!0);try{await fetch("/api/admin/matches/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:M,requesterEmail:e==null?void 0:e.email})}),await z()}finally{x(!1)}}async function $e(){try{const M=await fetch(`/api/admin/email-copy?requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`);if(M.ok){const O=await M.json();O!=null&&O.ok&&h(O.copy||v)}}catch{}}m.useEffect(()=>{j&&$e()},[j]);async function ue(M,O){await fetch("/api/admin/email-copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requesterEmail:e==null?void 0:e.email,kind:M,...O})}),await $e()}async function xe(M){try{const ze=await(await fetch(`/api/email/preview?kind=${encodeURIComponent(M)}&requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`)).text();C({open:!0,kind:M,html:ze})}catch{C({open:!0,kind:M,html:'<!doctype html><html><body style="font-family:sans-serif;padding:16px">Failed to load preview.</body></html>'})}}m.useEffect(()=>{if(!b.open)return;function M(O){O.key==="Escape"&&C({open:!1})}return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[b.open]);function Re({kind:M,label:O}){const ze=M==="confirm-email"?"confirmEmail":M==="changed"?"changed":M,Xe=(v==null?void 0:v[ze])||{title:"",intro:"",buttonLabel:""},[et,Mt]=m.useState(Xe.title||""),[St,Ze]=m.useState(Xe.intro||""),[gt,dt]=m.useState(Xe.buttonLabel||"");return m.useEffect(()=>{Mt(Xe.title||""),Ze(Xe.intro||""),dt(Xe.buttonLabel||"")},[Xe.title,Xe.intro,Xe.buttonLabel]),n.jsxs("div",{className:"p-2 rounded bg-black/20 space-y-2",children:[n.jsx("div",{className:"font-semibold",children:O}),n.jsx("input",{className:"input w-full",placeholder:"Title (optional)",value:et,onChange:yt=>Mt(yt.target.value)}),n.jsx("textarea",{className:"input w-full",rows:2,placeholder:"Intro line (optional)",value:St,onChange:yt=>Ze(yt.target.value)}),n.jsx("input",{className:"input w-full",placeholder:"Button label (optional)",value:gt,onChange:yt=>dt(yt.target.value)}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("a",{className:"btn",href:`/api/email/preview?kind=${encodeURIComponent(M)}&requesterEmail=${encodeURIComponent((e==null?void 0:e.email)||"")}`,target:"_blank",rel:"noreferrer",children:"Preview"}),n.jsx("button",{className:"btn",type:"button",onClick:()=>xe(M),children:"Popup"}),n.jsx("button",{className:"btn",onClick:()=>ue(M,{title:et,intro:St,buttonLabel:gt}),children:"Save"})]})]})}return j?n.jsxs("div",{className:"space-y-4",children:[j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Game Usage"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Bar height shows total plays per mode. Wins are listed under each label. This helps decide which modes to keep or iterate on."}),n.jsxs("div",{className:"rounded-xl border border-indigo-500/40 bg-indigo-500/10 p-3",children:[n.jsx(au,{data:D.map(M=>({label:M.label,value:M.value}))}),n.jsx("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 text-[11px] opacity-80",children:D.map((M,O)=>n.jsxs("div",{className:"flex items-center justify-between px-2 py-1 rounded-md bg-white/5 border border-white/10",children:[n.jsx("span",{className:"truncate mr-2",children:M.label}),n.jsxs("span",{className:"whitespace-nowrap",children:["Played ",M.value,"  Won ",M.won]})]},O))})]})]}),n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Admin Control"}),n.jsx("div",{className:"text-sm opacity-80 mb-3",children:"Grant or revoke Admin to trusted users. Only the owner can perform these actions."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"user@example.com",value:r,onChange:M=>l(M.target.value)}),n.jsx("button",{className:"btn",onClick:de,disabled:!r,children:"Grant Admin"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-1",children:"Current Admins"}),n.jsxs("ul",{className:"space-y-1",children:[t.map(M=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/20",children:[n.jsx("span",{children:M}),M.toLowerCase()!==fh&&n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>I(M),children:"Revoke"})]},M)),t.length===0&&n.jsx("li",{className:"text-sm opacity-60",children:"No admins yet."})]})]})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Premium Overrides"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Grant temporary PREMIUM to specific emails (e.g., winners, testers). Owner only."}),n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("input",{className:"input flex-1",placeholder:"user@example.com",value:r,onChange:M=>l(M.target.value)}),n.jsx("input",{className:"input w-28",type:"number",min:1,defaultValue:30,onChange:()=>{},id:"ndn-premium-days",placeholder:"Days"}),n.jsx("button",{className:"btn",onClick:()=>{const M=document.getElementById("ndn-premium-days"),O=Number((M==null?void 0:M.value)||"30");G(r,Number.isFinite(O)?O:30)},disabled:!r,children:"Grant"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-1",children:"Active Overrides"}),n.jsxs("ul",{className:"space-y-1 text-sm",children:[f.map(M=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/20",children:[n.jsxs("div",{children:[n.jsx("div",{children:M.email}),n.jsxs("div",{className:"text-xs opacity-70",children:["Expires: ",M.expiresAt?new Date(M.expiresAt).toLocaleString():""," ",M.expired?"(expired)":""]})]}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>W(M.email),children:"Revoke"})]},M.email)),f.length===0&&n.jsx("li",{className:"opacity-60",children:"No overrides."})]})]})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Server status"}),a!=null&&a.ok?n.jsxs("div",{className:"text-sm grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:["Clients: ",n.jsx("span",{className:"font-semibold",children:a.server.clients})]}),n.jsxs("div",{children:["Open matches: ",n.jsx("span",{className:"font-semibold",children:a.server.matches})]}),n.jsxs("div",{children:["Rooms: ",n.jsx("span",{className:"font-semibold",children:a.server.rooms})]}),n.jsxs("div",{children:["Premium: ",n.jsx("span",{className:"font-semibold",children:a.server.premium?"ON":"OFF"})]}),n.jsxs("div",{children:["Maintenance: ",n.jsx("span",{className:"font-semibold",children:a.server.maintenance?"ON":"OFF"})]})]}):n.jsx("div",{className:"text-sm opacity-70",children:"Loading"})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Operations"}),n.jsxs("div",{className:"flex flex-wrap gap-2 items-center mb-3",children:[n.jsx("button",{className:"btn",disabled:d,onClick:()=>{var M;return X(!((M=a==null?void 0:a.server)!=null&&M.maintenance))},children:(nt=a==null?void 0:a.server)!=null&&nt.maintenance?"Disable Maintenance":"Enable Maintenance"}),n.jsx("button",{className:"btn",disabled:d,onClick:()=>{var M;return ie(!((M=a==null?void 0:a.server)!=null&&M.premium))},children:(Ft=a==null?void 0:a.server)!=null&&Ft.premium?"Disable PREMIUM":"Enable PREMIUM"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{className:"input flex-1",placeholder:"Announcement message",value:o,onChange:M=>c(M.target.value)}),n.jsx("button",{className:"btn",disabled:d||!o.trim(),onClick:Z,children:"Broadcast"})]})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Tournaments Management"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-2",children:"Create Official"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("input",{className:"input w-full",placeholder:"Title",value:T.title,onChange:M=>P(O=>({...O,title:M.target.value}))}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsx("select",{className:"input",value:T.game,onChange:M=>P(O=>({...O,game:M.target.value})),children:["X01","Around the Clock","Cricket","Halve It","Shanghai","High-Low"].map(M=>n.jsx("option",{value:M,children:M},M))}),n.jsxs("select",{className:"input",value:T.mode,onChange:M=>P(O=>({...O,mode:M.target.value})),children:[n.jsx("option",{value:"bestof",children:"Best of"}),n.jsx("option",{value:"firstto",children:"First to"})]}),n.jsx("input",{className:"input",type:"number",min:1,value:T.value,onChange:M=>P(O=>({...O,value:Number(M.target.value)}))})]}),n.jsx("textarea",{className:"input w-full",rows:2,placeholder:"Description",value:T.description,onChange:M=>P(O=>({...O,description:M.target.value}))}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsx("input",{className:"input",type:"datetime-local",value:T.startAt,onChange:M=>P(O=>({...O,startAt:M.target.value}))}),n.jsx("input",{className:"input",type:"number",min:0,value:T.checkinMinutes,onChange:M=>P(O=>({...O,checkinMinutes:Number(M.target.value)}))})]}),n.jsx("input",{className:"input w-full",type:"number",min:6,max:64,value:T.capacity,onChange:M=>P(O=>({...O,capacity:Number(M.target.value)}))}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[n.jsxs("select",{className:"input",value:T.prizeType,onChange:M=>P(O=>({...O,prizeType:M.target.value})),children:[n.jsx("option",{value:"premium",children:"PREMIUM month"}),n.jsx("option",{value:"cash",children:"Cash"})]}),n.jsx("input",{className:"input",type:"number",min:0,disabled:T.prizeType!=="cash",value:T.prizeAmount,onChange:M=>P(O=>({...O,prizeAmount:Number(M.target.value)}))}),n.jsxs("select",{className:"input",disabled:T.prizeType!=="cash",value:T.currency,onChange:M=>P(O=>({...O,currency:M.target.value})),children:[n.jsx("option",{value:"GBP",children:"GBP"}),n.jsx("option",{value:"USD",children:"USD"}),n.jsx("option",{value:"EUR",children:"EUR"}),n.jsx("option",{value:"CAD",children:"CAD"}),n.jsx("option",{value:"AUD",children:"AUD"})]})]}),n.jsx("input",{className:"input w-full",placeholder:"Prize notes (optional)",value:T.prizeNotes,onChange:M=>P(O=>({...O,prizeNotes:M.target.value}))}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{className:"btn",disabled:d,onClick:J,children:"Create"})})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold mb-2",children:"Existing"}),n.jsxs("ul",{className:"space-y-2",children:[S.map(M=>n.jsxs("li",{className:"p-2 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"font-semibold",children:M.title}),n.jsx("div",{className:"opacity-70",children:M.status})]}),n.jsxs("div",{className:"opacity-80",children:[M.game,"  ",M.mode==="firstto"?"FT":"BO"," ",M.value,"  ",new Date(M.startAt).toLocaleString(),"  ",M.capacity," cap"]}),M.prize&&n.jsxs("div",{className:"text-xs mt-1",children:["Prize: ",M.prizeType==="cash"&&M.prizeAmount?`${M.currency||"USD"} ${M.prizeAmount}`:"1 month PREMIUM"," ",M.prizeType==="cash"&&M.status==="completed"&&M.payoutStatus&&n.jsx("span",{className:`ml-2 px-1.5 py-0.5 rounded ${M.payoutStatus==="paid"?"bg-emerald-600":"bg-amber-600"}`,children:M.payoutStatus})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Withdrawals"}),n.jsxs("ul",{className:"space-y-2",children:[N.map(O=>n.jsxs("li",{className:"p-2 rounded bg-black/20 text-sm flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-mono text-xs",children:O.id}),n.jsxs("div",{children:[O.email,"  ",O.currency," ",(O.amountCents/100).toFixed(2)]}),n.jsxs("div",{className:"opacity-70",children:[O.status,"  ",new Date(O.requestedAt).toLocaleString()]})]}),n.jsx("div",{className:"flex gap-2",children:O.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",disabled:d,onClick:()=>Le(O.id,!0),children:"Approve"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:d,onClick:()=>Le(O.id,!1),children:"Reject"})]})})]},O.id)),N.length===0&&n.jsx("li",{className:"opacity-60",children:"No withdrawal requests."})]})]}),n.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[n.jsx("button",{className:"btn",disabled:d||M.status!=="scheduled",onClick:()=>me(M.id,prompt("Winner email?")||""),children:"Set Winner"}),M.prizeType==="cash"&&M.status==="completed"&&M.payoutStatus!=="paid"&&n.jsx("button",{className:"btn",disabled:d,onClick:()=>pe(M.id),children:"Mark Paid"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:d,onClick:()=>Me(M.id),children:"Delete"})]})]},M.id)),S.length===0&&n.jsx("li",{className:"opacity-60",children:"No tournaments."})]}),n.jsx("div",{className:"mt-3 flex justify-end",children:n.jsx("button",{className:"btn",disabled:d,onClick:Ne,children:"Reseed Weekly Giveaway"})})]})]})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"User Reports"}),n.jsxs("ul",{className:"space-y-2",children:[B.map(M=>n.jsx("li",{className:"p-2 rounded bg-black/20 text-sm",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-mono text-xs",children:M.id}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:M.reporter}),"  ",n.jsx("span",{className:"font-semibold",children:M.offender}),"  ",new Date(M.ts).toLocaleString()]}),n.jsxs("div",{className:"opacity-80",children:["Reason: ",M.reason]}),M.messageId&&n.jsxs("div",{className:"opacity-60 text-xs",children:["Message ID: ",M.messageId]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${M.status==="open"?"bg-amber-600":"bg-emerald-600"}`,children:M.status}),M.status==="open"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",disabled:d,onClick:async()=>{await fetch("/api/admin/reports/resolve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:M.id,action:"resolved",requesterEmail:e==null?void 0:e.email})}),await z()},children:"Resolve"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:d,onClick:async()=>{const O=prompt("Enter notes for action taken (e.g., warning, block):")||"";await fetch("/api/admin/reports/resolve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:M.id,action:"actioned",notes:O,requesterEmail:e==null?void 0:e.email})}),await z()},children:"Action"})]})]})]})},M.id)),B.length===0&&n.jsx("li",{className:"opacity-60",children:"No reports."})]})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Open Matches"}),n.jsxs("ul",{className:"space-y-1",children:[((a==null?void 0:a.matches)||[]).map(M=>n.jsxs("li",{className:"flex items-center justify-between p-2 rounded bg-black/20 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"font-mono text-xs",children:M.id}),n.jsx("span",{className:"opacity-80",children:M.creatorName}),n.jsxs("span",{className:"opacity-60",children:[M.game," ",M.mode==="firstto"?"FT":"BO"," ",M.value," ",M.game==="X01"?`/${M.startingScore}`:""]})]}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",disabled:d,onClick:()=>ke(M.id),children:"Remove"})]},M.id)),(!(a!=null&&a.matches)||a.matches.length===0)&&n.jsx("li",{className:"text-sm opacity-60",children:"No open matches."})]})]}),j&&n.jsxs("div",{className:"card",children:[n.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Email Templates"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Customize titles, intro lines, and button text. Previews open in a new tab or as a popup."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[n.jsx(Re,{kind:"reset",label:"Password reset"}),n.jsx(Re,{kind:"reminder",label:"Password reset reminder"}),n.jsx(Re,{kind:"confirm-email",label:"Confirm new email"}),n.jsx(Re,{kind:"changed",label:"Password changed notice"})]})]}),b.open&&n.jsxs("div",{className:"fixed inset-0 z-[1000]",onClick:()=>C({open:!1}),children:[n.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm"}),n.jsx("div",{className:"absolute inset-0 p-4 md:p-8 overflow-auto flex items-start md:items-center justify-center",children:n.jsxs("div",{className:"w-full max-w-3xl bg-[#0b1020] rounded-2xl border border-indigo-500/40 shadow-2xl",onClick:M=>M.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-indigo-500/20",children:[n.jsxs("div",{className:"font-semibold",children:["Preview: ",b.kind]}),n.jsx("button",{className:"btn",onClick:()=>C({open:!1}),children:"Close"})]}),n.jsx("div",{className:"p-0 bg-black/30",children:n.jsx("iframe",{title:"Email Preview",style:{width:"100%",height:"70vh",border:"0",background:"transparent"},srcDoc:b.html||""})}),n.jsx("div",{className:"px-4 py-3 border-t border-indigo-500/20 text-xs opacity-70",children:"Click outside this panel or press Esc to close."})]})})]})]}):n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Admin"}),n.jsx("div",{className:"text-sm opacity-80",children:"You dont have permission to manage admins."})]})}function lN({user:e}){const{favoriteDouble:t,callerEnabled:s,callerVoice:r,callerVolume:l,speakCheckoutOnly:a,avgMode:i,autoStartOffline:o,rememberLastOffline:c,reducedMotion:d,compactHeader:x,allowSpectate:S,cameraScale:y,cameraAspect:N,autoscoreProvider:w,autoscoreWsUrl:T,calibrationGuide:P,preferredCameraId:v,preferredCameraLabel:h,offlineLayout:b,setFavoriteDouble:C,setCallerEnabled:j,setCallerVoice:f,setCallerVolume:R,setSpeakCheckoutOnly:B,setAvgMode:ee,setAutoStartOffline:Y,setRememberLastOffline:$,setReducedMotion:Q,setCompactHeader:D,setAllowSpectate:z,setCameraScale:de,setCameraAspect:I,setAutoscoreProvider:G,setAutoscoreWsUrl:W,setCalibrationGuide:X,setPreferredCamera:Z,setOfflineLayout:ie}=Yn(),[J,me]=m.useState([{key:"first180",label:"First 180",unlocked:!1,icon:"",desc:"Score 180 in a match."},{key:"hundredGames",label:"100 Games Played",unlocked:!1,icon:"",desc:"Play 100 games."},{key:"tournamentWin",label:"Tournament Winner",unlocked:!1,icon:"",desc:"Win a tournament."},{key:"bestLeg",label:"Best Leg",unlocked:!1,icon:"",desc:"Finish a leg in 12 darts or less."},{key:"comeback",label:"Comeback",unlocked:!1,icon:"",desc:"Win after trailing by 3 legs."}]);m.useEffect(()=>{const O=(e==null?void 0:e.username)||"";O&&me(ze=>ze.map(Xe=>({...Xe,unlocked:!!localStorage.getItem(`ndn:achieve:${Xe.key}:${O}`)})))},[e==null?void 0:e.username]);const[pe,Me]=m.useState(!1),[Ne,Le]=m.useState(""),[ke,$e]=m.useState(""),[ue,xe]=m.useState(""),[Re,ct]=m.useState("");m.useEffect(()=>{const O=(e==null?void 0:e.username)||"";if(O)try{Le(localStorage.getItem(`ndn:bio:favPlayer:${O}`)||""),$e(localStorage.getItem(`ndn:bio:favTeam:${O}`)||""),xe(localStorage.getItem(`ndn:bio:favDarts:${O}`)||""),ct(localStorage.getItem(`ndn:bio:bio:${O}`)||"")}catch{}},[e==null?void 0:e.username]);const nt=()=>{const O=(e==null?void 0:e.username)||"";if(O)try{localStorage.setItem(`ndn:bio:favPlayer:${O}`,Ne),localStorage.setItem(`ndn:bio:favTeam:${O}`,ke),localStorage.setItem(`ndn:bio:favDarts:${O}`,ue),localStorage.setItem(`ndn:bio:bio:${O}`,Re),Me(!1)}catch{}},[Ft,M]=m.useState([]);return m.useEffect(()=>{const O=()=>{const ze=speechSynthesis.getVoices();M(ze.filter(Xe=>Xe.lang.startsWith("en")))};O(),speechSynthesis.onvoiceschanged=O},[]),n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-red-500/40 bg-red-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2 text-red-700",children:[n.jsx(eh,{className:"w-5 h-5"})," Account"]}),n.jsx("div",{className:"flex justify-center",children:n.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("ndn:logout")),className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Logout"})})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"font-semibold flex items-center gap-2",children:[n.jsx(eh,{className:"w-5 h-5 text-brand-400"})," Profile Bio"]}),pe?n.jsxs("button",{onClick:nt,className:"flex items-center gap-2 px-3 py-1 bg-green-500/20 hover:bg-green-500/30 rounded-lg text-green-400 text-sm transition-colors",children:[n.jsx(Lv,{className:"w-4 h-4"})," Save"]}):n.jsxs("button",{onClick:()=>Me(!0),className:"flex items-center gap-2 px-3 py-1 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-400 text-sm transition-colors",children:[n.jsx(Dv,{className:"w-4 h-4"})," Edit"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Favourite Player:"}),pe?n.jsx("input",{className:"input w-full",type:"text",value:Ne,onChange:O=>Le(O.target.value),placeholder:"e.g. Michael van Gerwen"}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[2.5rem] flex items-center",children:Ne||"Not set"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Favourite Football Team:"}),pe?n.jsx("input",{className:"input w-full",type:"text",value:ke,onChange:O=>$e(O.target.value),placeholder:"e.g. Manchester United"}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[2.5rem] flex items-center",children:ke||"Not set"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Favourite Darts:"}),pe?n.jsx("input",{className:"input w-full",type:"text",value:ue,onChange:O=>xe(O.target.value),placeholder:"e.g. Unicorn Phase 5, 24g"}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[2.5rem] flex items-center",children:ue||"Not set"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Short Bio / Quote:"}),pe?n.jsx("textarea",{className:"input w-full",value:Re,onChange:O=>ct(O.target.value),placeholder:"Write something about yourself...",rows:3}):n.jsx("div",{className:"px-3 py-2 bg-slate-800/50 rounded-lg text-slate-300 min-h-[4rem] flex items-start",children:Re||"No bio set"})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-green-500/40 bg-green-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(Cv,{className:"w-5 h-5 text-green-400"})," Game Preferences"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Favourite Double:"}),n.jsxs("select",{className:"input w-full",value:t,onChange:O=>C(O.target.value),children:[n.jsx("option",{value:"any",children:"Any Double"}),n.jsx("option",{value:"D20",children:"Double 20"}),n.jsx("option",{value:"D18",children:"Double 18"}),n.jsx("option",{value:"D16",children:"Double 16"}),n.jsx("option",{value:"D14",children:"Double 14"}),n.jsx("option",{value:"D12",children:"Double 12"}),n.jsx("option",{value:"D10",children:"Double 10"}),n.jsx("option",{value:"D8",children:"Double 8"}),n.jsx("option",{value:"D6",children:"Double 6"}),n.jsx("option",{value:"D4",children:"Double 4"}),n.jsx("option",{value:"D2",children:"Double 2"}),n.jsx("option",{value:"D1",children:"Double 1"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Average Display Mode:"}),n.jsxs("select",{className:"input w-full",value:i,onChange:O=>ee(O.target.value),children:[n.jsx("option",{value:"all-time",children:"All Time Average"}),n.jsx("option",{value:"24h",children:"24 Hour Average"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"autoStartOffline",checked:o,onChange:O=>Y(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"autoStartOffline",className:"text-sm",children:"Auto-start offline games"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"rememberLastOffline",checked:c,onChange:O=>$(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"rememberLastOffline",className:"text-sm",children:"Remember last offline game settings"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Offline Game Layout:"}),n.jsxs("select",{className:"input w-full",value:b||"classic",onChange:O=>ie(O.target.value),children:[n.jsx("option",{value:"classic",children:"Classic Layout"}),n.jsx("option",{value:"modern",children:"Modern Layout"})]})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-purple-500/40 bg-purple-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(Av,{className:"w-5 h-5 text-purple-400"})," Audio & Voice"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"callerEnabled",checked:s,onChange:O=>j(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"callerEnabled",className:"text-sm font-medium",children:"Enable Voice Caller"})]}),s&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Voice:"}),n.jsx("select",{className:"input w-full",value:r,onChange:O=>f(O.target.value),children:Ft.map(O=>n.jsxs("option",{value:O.name,children:[O.name," (",O.lang,")"]},O.name))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 text-sm font-medium",children:["Volume: ",Math.round(l*100),"%"]}),n.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:l,onChange:O=>R(parseFloat(O.target.value)),className:"w-full"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"speakCheckoutOnly",checked:a,onChange:O=>B(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"speakCheckoutOnly",className:"text-sm",children:"Only announce checkouts"})]})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-blue-500/40 bg-blue-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(Mp,{className:"w-5 h-5 text-blue-400"})," Camera & Vision"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 text-sm font-medium",children:["Camera Scale: ",y.toFixed(2),"x"]}),n.jsx("input",{type:"range",min:"0.5",max:"1.25",step:"0.05",value:y,onChange:O=>de(parseFloat(O.target.value)),className:"w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Camera Aspect Ratio:"}),n.jsxs("select",{className:"input w-full",value:N||"wide",onChange:O=>I(O.target.value),children:[n.jsx("option",{value:"wide",children:"Wide (16:9)"}),n.jsx("option",{value:"square",children:"Square (1:1)"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"calibrationGuide",checked:P,onChange:O=>X(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"calibrationGuide",className:"text-sm",children:"Show calibration guide"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Autoscore Provider:"}),n.jsxs("select",{className:"input w-full",value:w||"built-in",onChange:O=>G(O.target.value),children:[n.jsx("option",{value:"built-in",children:"Built-in Vision"}),n.jsx("option",{value:"external-ws",children:"External WebSocket"})]})]}),w==="external-ws"&&n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 text-sm font-medium",children:"External WebSocket URL:"}),n.jsx("input",{className:"input w-full",type:"url",value:T||"",onChange:O=>W(O.target.value),placeholder:"ws://localhost:8080"})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-orange-500/40 bg-orange-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(Lp,{className:"w-5 h-5 text-orange-400"})," UI & Accessibility"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"reducedMotion",checked:d,onChange:O=>Q(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"reducedMotion",className:"text-sm",children:"Reduce motion/animations"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"compactHeader",checked:x,onChange:O=>D(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"compactHeader",className:"text-sm",children:"Compact header layout"})]})]})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-pink-500/40 bg-pink-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2",children:[n.jsx(Iv,{className:"w-5 h-5 text-pink-400"})," Online & Social"]}),n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"checkbox",id:"allowSpectate",checked:S,onChange:O=>z(O.target.checked),className:"w-4 h-4"}),n.jsx("label",{htmlFor:"allowSpectate",className:"text-sm",children:"Allow others to spectate my games"})]})})]})}),n.jsx("div",{className:"card",children:n.jsxs("div",{className:"p-3 rounded-xl border border-yellow-500/40 bg-yellow-500/10",children:[n.jsxs("div",{className:"font-semibold mb-4 flex items-center gap-2 text-yellow-700",children:[n.jsx(tm,{className:"w-5 h-5"})," Achievements & Badges"]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:J.map(O=>n.jsxs("div",{className:`flex flex-col items-center p-3 rounded-xl border ${O.unlocked?"border-emerald-400 bg-emerald-500/10":"border-slate-400 bg-slate-700/10"}`,children:[n.jsx("div",{className:"text-3xl mb-2",children:O.icon}),n.jsx("div",{className:`font-bold mb-1 text-center ${O.unlocked?"text-emerald-400":"text-slate-400"}`,children:O.label}),n.jsx("div",{className:"text-xs text-slate-300 text-center mb-2",children:O.desc}),!O.unlocked&&n.jsx("div",{className:"text-xs text-amber-400 font-medium",children:" Locked"}),O.unlocked&&n.jsx("div",{className:"text-xs text-emerald-400 font-medium",children:" Unlocked!"})]},O.key))})]})})]})}const ml={};function aN({onAuth:e}){const[t,s]=m.useState("signin"),[r,l]=m.useState(""),[a,i]=m.useState(""),[o,c]=m.useState(""),[d,x]=m.useState(""),[S,y]=m.useState(""),[N,w]=m.useState(!1),T=(ml==null?void 0:ml.VITE_API_URL)||"";async function P(C){if(C.preventDefault(),y(""),!a||!o){y("Username and password required.");return}try{const j=await fetch(`${T}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:o})}),f=await j.json();j.ok&&(f!=null&&f.user)&&(f!=null&&f.token)?(localStorage.setItem("authToken",f.token),e(f.user)):y((f==null?void 0:f.error)||"Invalid username or password.")}catch{y("Network error.")}}async function v(C){if(C.preventDefault(),y(""),!r||!a||!o){y("Email, username, and password required.");return}try{const j=await fetch(`${T}/api/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,username:a,password:o})}),f=await j.json();j.ok&&(f!=null&&f.user)&&(f!=null&&f.token)?(localStorage.setItem("authToken",f.token),e(f.user)):y((f==null?void 0:f.error)||"Signup failed.")}catch{y("Network error.")}}async function h(C){if(C.preventDefault(),y(""),!r||!r.includes("@")){y("Enter your email address.");return}try{const f=await(await fetch(`${T}/api/auth/send-reset`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})})).json();if(!(f!=null&&f.ok))throw new Error((f==null?void 0:f.error)||"Failed to send reset email");y("Password reset link sent to your email.")}catch(j){y((j==null?void 0:j.message)||"Failed to send reset email")}}async function b(C){if(C.preventDefault(),y(""),!r||!r.includes("@")){y("Enter your email address.");return}try{const f=await(await fetch(`${T}/api/auth/send-username`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})})).json();if(!(f!=null&&f.ok))throw new Error((f==null?void 0:f.error)||"Failed to send username email");y("Your username has been emailed to you.")}catch(j){y((j==null?void 0:j.message)||"Failed to send username email")}}return n.jsxs("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[n.jsx("div",{className:"background-animated"}),n.jsxs("div",{className:"relative z-10 w-full max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-6 p-4",children:[n.jsxs("form",{className:"card w-full space-y-4",onSubmit:t==="signin"?P:t==="signup"?v:h,children:[n.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 mb-2 text-center",children:[n.jsx("h1",{className:"logo text-center",children:"NINE-DART-NATION "}),n.jsx("span",{className:"badge",children:"Welcome"})]}),n.jsx("h2",{className:"text-2xl font-bold",children:t==="signin"?"Sign In":t==="signup"?"Create Account":"Reset Password"}),(t==="signup"||t==="reset")&&n.jsx("input",{className:"input w-full",type:"email",placeholder:"Email",value:r,onChange:C=>l(C.target.value),required:!0}),t!=="reset"&&n.jsx("input",{className:"input w-full",type:"text",placeholder:"Username",value:a,onChange:C=>i(C.target.value),required:!0}),t!=="reset"&&n.jsxs("div",{className:"relative",children:[n.jsx("input",{className:"input w-full pr-10",type:N?"text":"password",placeholder:"Password",value:o,onChange:C=>c(C.target.value),autoComplete:"current-password",required:!0,onFocus:()=>w(!1),onBlur:()=>w(!1)}),n.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white",tabIndex:-1,onMouseDown:C=>{C.preventDefault(),w(!0)},onMouseUp:C=>{C.preventDefault(),w(!1)},onMouseLeave:()=>w(!1),onTouchStart:C=>{C.preventDefault(),w(!0)},onTouchEnd:C=>{C.preventDefault(),w(!1)},"aria-label":"Toggle password visibility",children:N?n.jsx(kv,{className:"w-5 h-5"}):n.jsx(Lp,{className:"w-5 h-5"})})]}),t==="signup"&&n.jsx("input",{className:"input w-full",type:"text",placeholder:"Password Reminder (optional)",value:d,onChange:C=>x(C.target.value)}),S&&n.jsx("div",{className:"text-red-400 font-semibold text-sm",children:S}),n.jsx("button",{className:"btn w-full",type:"submit",children:t==="signin"?"Sign In":t==="signup"?"Sign Up":"Send Reset Link"}),t==="reset"&&n.jsx("button",{className:"btn w-full mt-2 bg-white/10 hover:bg-white/20",type:"button",onClick:b,children:"Email me my username"}),n.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[n.jsx("button",{type:"button",className:"underline",onClick:()=>s(t==="signin"?"signup":"signin"),children:t==="signin"?"Need an account? Sign Up":"Already have an account? Sign In"}),n.jsx("button",{type:"button",className:"underline",onClick:()=>s("reset"),children:"Forgot password?"})]}),n.jsx("div",{className:"text-xs text-slate-200/80",children:"Tip: Use the admin demo credentials to explore admin features."})]}),n.jsxs("aside",{className:"card w-full",children:[n.jsx("h3",{className:"text-xl font-bold mb-3",children:"Whats inside"}),n.jsxs("ul",{className:"space-y-3",children:[n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(Jd,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Online & Friends"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Challenge friends, chat, and join leagues."})]})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(Sv,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Deep Stats"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Track 3-dart averages, best legs, and more."})]})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(to,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Game Modes"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Start with 3 free online games upon signup. After that, PREMIUM is required to play all games."})]})]}),n.jsxs("li",{className:"flex items-start gap-3",children:[n.jsx(Pv,{className:"w-5 h-5 text-indigo-300 mt-1"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Premium Perks"}),n.jsx("div",{className:"text-sm text-slate-200/90",children:"Polished UI, upcoming features, and early access."})]})]})]}),n.jsxs("a",{href:(ml==null?void 0:ml.VITE_DISCORD_INVITE_URL)||"https://discord.gg/8GtbZ6RU",target:"_blank",rel:"noopener noreferrer",className:"btn mt-4 flex items-center justify-center gap-2",children:[n.jsx(Kd,{className:"w-5 h-5"})," Join BullseyeDartsLeague"]})]})]})]})}const iN=m.createContext({theme:"default",setTheme:e=>{}}),hh="ndn_theme";function oN({children:e}){const[t,s]=m.useState("default");return m.useEffect(()=>{try{const r=localStorage.getItem(hh);r&&s(r)}catch{}},[]),m.useEffect(()=>{try{localStorage.setItem(hh,t)}catch{}},[t]),n.jsx(iN.Provider,{value:{theme:t,setTheme:s},children:n.jsx("div",{className:`theme-${t}`,children:e})})}const Qc={},Lx=m.createContext(null);function cN({children:e}){const[t,s]=m.useState(!1),[r,l]=m.useState("connecting"),a=m.useRef(null),i=m.useRef(new Set),o=m.useRef(!0),c=m.useRef(0),d=m.useRef(null),x=m.useRef(null),S=m.useRef(null),y=m.useRef(0),N=()=>{if(S.current)return S.current;const C=Qc==null?void 0:Qc.VITE_WS_URL;if(C&&C.length>0){const ee=C.endsWith("/ws")?C:C.replace(/\/$/,"")+"/ws";return S.current=[ee],S.current}const j=window.location.protocol==="https:"?"wss":"ws",f=window.location.hostname,B=[`${j}://${window.location.host}`+"/ws",`${j}://${f}/ws`,`${j}://${f}:8787/ws`,`${j}://${f}:3000/ws`];return S.current=Array.from(new Set(B)),S.current},w=()=>{const C=N();return y.current=(y.current+1)%C.length,C[y.current]},T=()=>{const C=N();return C[y.current]||C[0]},P=m.useCallback(()=>{if(a.current&&(a.current.readyState===WebSocket.OPEN||a.current.readyState===WebSocket.CONNECTING))return;l("connecting");const j=`${T()}`,f=new WebSocket(j);a.current=f,f.onopen=()=>{s(!0),l("connected"),c.current=0,x.current&&clearInterval(x.current),x.current=setInterval(()=>{var R,B;try{((R=a.current)==null?void 0:R.readyState)===WebSocket.OPEN&&((B=a.current)==null||B.send(JSON.stringify({type:"ping",t:Date.now()})))}catch{}},2e4)},f.onmessage=R=>{try{const B=JSON.parse(R.data);i.current.forEach(ee=>{try{ee(B)}catch{}})}catch{}},f.onerror=()=>{},f.onclose=()=>{if(s(!1),l("disconnected"),x.current&&(clearInterval(x.current),x.current=null),!o.current)return;const R=(c.current||0)+1;c.current=R,R%2===0&&w();const B=1e3*Math.pow(2,R-1),ee=Math.floor(Math.random()*1e3);let Y=Math.min(3e4,B+ee);R===1&&(Y=0),d.current&&clearTimeout(d.current),Y===0?P():d.current=setTimeout(P,Y)}},[]);m.useEffect(()=>{o.current=!0,P();const C=()=>{var f;o.current=!1;try{(f=a.current)==null||f.close()}catch{}};window.addEventListener("beforeunload",C);const j=()=>{document.visibilityState==="visible"&&(t||P())};return document.addEventListener("visibilitychange",j),window.addEventListener("online",P),()=>{var f;o.current=!1,d.current&&clearTimeout(d.current),x.current&&clearInterval(x.current);try{(f=a.current)==null||f.close()}catch{}document.removeEventListener("visibilitychange",j),window.removeEventListener("online",P),window.removeEventListener("beforeunload",C)}},[P]);const v=m.useCallback(C=>{try{a.current&&a.current.readyState===WebSocket.OPEN&&a.current.send(typeof C=="string"?C:JSON.stringify(C))}catch{}},[]),h=m.useCallback(C=>(i.current.add(C),()=>{i.current.delete(C)}),[]),b=m.useMemo(()=>({connected:t,status:r,send:v,addListener:h}),[t,r,v,h]);return n.jsx(Lx.Provider,{value:b,children:e})}function mm(){const e=m.useContext(Lx);if(!e)throw new Error("useWS must be used within WSProvider");return e}function dN({status:e,title:t,size:s=12}){const r=s;return e==="connecting"?n.jsx("span",{role:"img","aria-label":"Connecting",title:t||"Connecting",className:"inline-flex items-center justify-center",style:{width:r,height:r},children:n.jsxs("svg",{width:r,height:r,viewBox:"0 0 24 24",className:"animate-spin","aria-hidden":"true",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#A7F3D0",strokeWidth:"3",fill:"none",opacity:"0.35"}),n.jsx("path",{d:"M22 12a10 10 0 0 0-10-10",stroke:"#34D399",strokeWidth:"3",strokeLinecap:"round",fill:"none"})]})}):e==="connected"?n.jsx("span",{role:"img","aria-label":"Connected",title:t||"Connected",className:"inline-flex items-center justify-center",style:{width:r,height:r},children:n.jsx("svg",{width:r,height:r,viewBox:"0 0 24 24","aria-hidden":"true",children:n.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#34D399"})})}):n.jsx("span",{role:"img","aria-label":"Disconnected",title:t||"Not connected",className:"inline-flex items-center justify-center",style:{width:r,height:r},children:n.jsxs("svg",{width:r,height:r,viewBox:"0 0 24 24","aria-hidden":"true",children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"#F87171",opacity:"0.15"}),n.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"#F87171",strokeWidth:"2",fill:"none"}),n.jsx("rect",{x:"6",y:"11",width:"12",height:"2",rx:"1",fill:"#F87171"})]})})}const Px="ndn:blocked:v1";function uN(){try{const e=localStorage.getItem(Px);return e?JSON.parse(e):{}}catch{return{}}}function ph(e){try{localStorage.setItem(Px,JSON.stringify(e))}catch{}}const mN=Jl((e,t)=>({blocked:uN(),isBlocked:s=>!!t().blocked[(s||"").toLowerCase()],block:s=>e(r=>{const l={...r.blocked};return l[(s||"").toLowerCase()]=Date.now(),ph(l),{blocked:l}}),unblock:s=>e(r=>{const l={...r.blocked};return delete l[(s||"").toLowerCase()],ph(l),{blocked:l}}),all:()=>Object.keys(t().blocked)})),Xc={};function fN({user:e}){var Kr,fr,Jr,Fn,bs,Yr,Rs,qr,ta,Qr,na,Xr,sa,Zr,ra,hr,el,pr,la,aa,ia,oa,ca,ui,tl,mi,nl,fi,sl,hi;const t=(()=>{try{return mm()}catch{return null}})(),s=mN(),[r,l]=m.useState("room-1"),[a,i]=m.useState(!1),[o,c]=m.useState([]),[d,x]=m.useState(!1),[S,y]=m.useState(!1),N=m.useRef(null),[w,T]=m.useState(null),P=m.useRef(null),v=m.useRef(0),h=m.useRef(null),b=m.useRef(!0),C=m.useRef(0),j=m.useRef(!1),f=La(),R=lu(),{favoriteDouble:B,callerEnabled:ee,callerVoice:Y,callerVolume:$,speakCheckoutOnly:Q,allowSpectate:D,cameraScale:z,setCameraScale:de}=Yn(),[I,G]=m.useState(!1),[W,X]=m.useState([]),[Z,ie]=m.useState(0),[J,me]=m.useState(0),[pe,Me]=m.useState(0),[Ne,Le]=m.useState(0),[ke,$e]=m.useState(""),[ue,xe]=m.useState(0),[Re,ct]=m.useState(0),[nt,Ft]=m.useState(""),[M,O]=m.useState({}),[ze,Xe]=m.useState({}),[et,Mt]=m.useState({}),[St,Ze]=m.useState({}),[gt,dt]=m.useState({}),[yt,on]=m.useState({}),[qn,vt]=m.useState({}),[pn,xn]=m.useState({}),[Tt,ne]=m.useState(()=>ru()),[le,oe]=m.useState(0),[se,K]=m.useState(()=>{try{const u=navigator.userAgent||"";return/Android|iPhone|iPad|iPod|Mobile/i.test(u)}catch{return!1}}),[Oe,ve]=m.useState(null),We=m.useRef(null),A=m.useRef(null);function U(){var u,g;try{if(!A.current){const E=window.AudioContext||window.webkitAudioContext;E&&(A.current=new E)}(g=(u=A.current)==null?void 0:u.resume)==null||g.call(u).catch(()=>{})}catch{}}function ce(u,g,E=0,k=.05){const V=A.current;if(!V)return;const re=V.createOscillator(),ae=V.createGain();re.type="square",re.frequency.value=u,ae.gain.value=k,re.connect(ae),ae.connect(V.destination);const F=V.currentTime+E;re.start(F),re.stop(F+g/1e3)}function je(u){U(),A.current&&(u==="180"?(ce(880,110,0,.06),ce(1175,110,.06,.06),ce(1568,140,.12,.06)):(ce(659,140,0,.07),ce(784,140,.08,.07),ce(987,200,.16,.07)))}function ge(u,g){const E=Date.now(),k=We.current;k&&k.kind===u&&k.by===g&&E-k.ts<500||(We.current={kind:u,by:g,ts:E},ve({kind:u,by:g,turnIdx:f.currentPlayerIdx,ts:E}),je(u))}const[Ce,he]=m.useState(!1),[Pe,pt]=m.useState([]),[Ve,Lt]=m.useState("bestof"),[Vt,tn]=m.useState(5),[qe,Bn]=m.useState(501),[rt,xs]=m.useState(null),[gs,nn]=m.useState("");function cn(u){nn(u),setTimeout(()=>nn(""),4e3);try{Pt(u||"Stripe checkout failed",{type:"error"})}catch{}}const[Gt,Ms]=m.useState(null),[Ls,Qn]=m.useState(null),Pt=Ml(),[At,Rr]=m.useState("X01"),[Ee,Xn]=m.useState("X01"),[Zn,Or]=m.useState(!1),Ae=e!=null&&e.username&&!(e!=null&&e.fullAccess)?Rp(e.username):1/0,_e=!(e!=null&&e.fullAccess)&&Ae<=0,[He,kt]=m.useState("all"),[Ct,ut]=m.useState("all"),[mt,$t]=m.useState("all"),[qt,Br]=m.useState(!1),[es,_r]=m.useState(10),{H:Ur}=om(),Fr=e!=null&&e.username?Js(e.username):0,$r=lu(u=>u.unread),_n=(Pe||[]).filter(u=>!(He!=="all"&&u.mode!==He||Ct!=="all"&&Number(u.startingScore)!==Number(Ct)||mt!=="all"&&u.game!==mt||qt&&(!Fr||!u.creatorAvg||Math.abs(Number(u.creatorAvg)-Number(Fr))>es)));m.useEffect(()=>{const u=g=>{const E=(g==null?void 0:g.detail)||{};E.game&&Rr(E.game),(E.mode==="bestof"||E.mode==="firstto")&&Lt(E.mode),typeof E.value=="number"&&isFinite(E.value)&&tn(Math.max(1,Math.floor(E.value))),typeof E.start=="number"&&isFinite(E.start)&&Bn(Math.max(1,Math.floor(E.start))),he(!0)};return window.addEventListener("ndn:online-demo",u),()=>window.removeEventListener("ndn:online-demo",u)},[]),m.useEffect(()=>{const u=String((e==null?void 0:e.email)||"").toLowerCase();u&&fetch(`/api/friends/messages?email=${encodeURIComponent(u)}`).then(g=>g.json()).then(g=>{g!=null&&g.ok&&Array.isArray(g.messages)&&R.load(g.messages)}).catch(()=>{})},[e==null?void 0:e.email]),m.useEffect(()=>{const u=g=>{try{const E=(g==null?void 0:g.detail)||{},k=Number(E.start||501);f.newMatch([(e==null?void 0:e.username)||"You","Opponent"],k,r),f.addVisit(60,3),f.nextPlayer(),f.addVisit(85,3),f.nextPlayer(),f.addVisit(100,3),Xn("X01"),G(!0)}catch{}};return window.addEventListener("ndn:online-match-demo",u),()=>window.removeEventListener("ndn:online-match-demo",u)},[]),m.useEffect(()=>(b.current=!0,zr(),()=>{var u;b.current=!1,h.current&&clearTimeout(h.current);try{(u=P.current)==null||u.close()}catch{}}),[]),m.useEffect(()=>{R.setInGame(f.inProgress)},[f.inProgress]),m.useEffect(()=>{Oe&&f.currentPlayerIdx!==Oe.turnIdx&&ve(null)},[f.currentPlayerIdx,Oe==null?void 0:Oe.turnIdx]),m.useEffect(()=>{try{t&&t.connected?t.send({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:D}):P.current&&P.current.readyState===WebSocket.OPEN&&P.current.send(JSON.stringify({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:D}))}catch{}},[D,t==null?void 0:t.connected]),m.useEffect(()=>{const u=g=>{var k,V;const E=(k=g==null?void 0:g.detail)==null?void 0:k.roomId;E&&(l(E),t?t.send({type:"spectate",roomId:E}):(V=P.current)==null||V.send(JSON.stringify({type:"spectate",roomId:E})),G(!0),he(!1))};return window.addEventListener("ndn:spectate-room",u),()=>window.removeEventListener("ndn:spectate-room",u)},[t]);function zr(){if(t){t.connected&&(t.send({type:"join",roomId:r}),t.send({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:D}),t.send({type:"list-matches"}),i(!0));return}try{if(P.current&&(P.current.readyState===WebSocket.OPEN||P.current.readyState===WebSocket.CONNECTING))return}catch{}const u=Xc==null?void 0:Xc.VITE_WS_URL,g=window.location.protocol==="https:"?"wss":"ws",E=window.location.hostname,k=`${g}://${E}${window.location.port?"":":8787"}`,V=u&&typeof u=="string"&&u.length>0?u:k,re=new WebSocket(V);P.current=re,re.onopen=()=>{i(!0),v.current=0,j.current?Pt("Reconnected to lobby",{type:"success"}):(Pt("Connected to lobby",{type:"success"}),j.current=!0),re.send(JSON.stringify({type:"join",roomId:r})),re.send(JSON.stringify({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:D})),re.send(JSON.stringify({type:"list-matches"}))},re.onmessage=ae=>{var at;const F=JSON.parse(ae.data);if(F.type==="state"){f.importState(F.payload);const lt=Number(F.payload._dpIndex),it=Number(F.payload._dpHits);Number.isFinite(lt)&&Me(Math.max(0,lt)),Number.isFinite(it)&&Le(Math.max(0,it));const Qe=Number(F.payload._atcIndex),Ie=Number(F.payload._atcHits);Number.isFinite(Qe)&&xe(Math.max(0,Qe)),Number.isFinite(Ie)&&ct(Math.max(0,Ie));try{const we=F.payload._cricketById;we&&typeof we=="object"&&O(we)}catch{}try{const we=F.payload._shanghaiById;we&&typeof we=="object"&&Xe(we)}catch{}try{const we=F.payload._halveById;we&&typeof we=="object"&&Mt(we)}catch{}try{const we=F.payload._highlowById;we&&typeof we=="object"&&Ze(we)}catch{}try{const we=F.payload._killerById;we&&typeof we=="object"&&dt(we)}catch{}try{const we=F.payload._amCricketById;we&&typeof we=="object"&&on(we)}catch{}try{const we=F.payload._baseballById;we&&typeof we=="object"&&vt(we)}catch{}try{const we=F.payload._golfById;we&&typeof we=="object"&&xn(we)}catch{}try{const we=F.payload._tttState;we&&typeof we=="object"&&ne(we)}catch{}try{const we=Number(F.payload._turnDarts);Number.isFinite(we)&&oe(Math.max(0,we))}catch{}}else if(F.type==="joined")F.id&&T(F.id);else if(F.type==="presence"||F.type==="peer-joined")X(lt=>{const it=new Set(lt);return F.id&&it.add(F.id),Array.from(it)});else if(F.type==="chat"){const lt=!!(F.from&&w&&F.from===w),it=lt?(e==null?void 0:e.username)||"me":F.from||"peer",Qe=String(F.from||"");if(!lt&&Qe&&s.isBlocked(Qe))return;if(lt&&N.current&&String(F.message||"")===N.current.text){N.current=null;return}c(Ie=>[...Ie,{from:it,message:F.message,fromId:Qe||void 0}])}else if(F.type==="matches")pt(Array.isArray(F.matches)?F.matches:[]);else if(F.type==="invite")xs({matchId:F.matchId,fromId:F.fromId,fromName:F.fromName,calibrated:!!F.calibrated,boardPreview:F.boardPreview||null,game:F.game,mode:F.mode,value:F.value,startingScore:F.startingScore});else if(F.type==="match-start")l(F.roomId),re.send(JSON.stringify({type:"join",roomId:F.roomId})),G(!0),he(!1),(at=F.match)!=null&&at.game&&Xn(F.match.game),e!=null&&e.username&&!(e!=null&&e.fullAccess)&&th(e.username);else if(F.type==="declined")Pt("Invite declined",{type:"info"});else if(F.type==="error"){const lt=typeof F.message=="string"?F.message:"Action not allowed";if(nn(lt),F.code==="SPECTATE_NOT_ALLOWED")try{Pt("This player has spectating turned off.",{type:"error"})}catch{}F.code==="NOT_FOUND"&&Gt&&Qn({game:Gt.game,mode:Gt.mode,value:Gt.value,startingScore:Gt.startingScore}),setTimeout(()=>nn(""),3500)}else if(F.type==="friend-invite")confirm(`${F.fromName||F.fromEmail} invited you to play ${F.game||"X01"} (${F.mode==="firstto"?"First To":"Best Of"} ${F.value||1}${F.game==="X01"&&F.startingScore?` = ${F.startingScore}`:""}). Accept?`)?re.send(JSON.stringify({type:"start-friend-match",toEmail:F.fromEmail,game:F.game,mode:F.mode,value:F.value,startingScore:F.startingScore})):Pt("Invite declined",{type:"info"});else if(F.type==="friend-message")R.add({id:F.id||`${F.ts}-${F.from}`,from:F.from,message:F.message,ts:F.ts||Date.now()}),f.inProgress||Pt(`${F.from}: ${F.message}`,{type:"info"});else if(F.type==="celebration"){const lt=F.by||"Player",it=F.kind==="leg"?"leg":"180";ge(it,lt)}},re.onclose=()=>{if(i(!1),!b.current)return;const ae=(v.current||0)+1;v.current=ae;const F=Math.min(3e4,1e3*Math.pow(2,ae-1)),at=Date.now();at-C.current>4e3&&(Pt(`Disconnected. Reconnecting in ${Math.round(F/1e3)}s...`,{type:"error"}),C.current=at),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{zr()},F)}}function Hr(){var Ie,we,Os,pi,xi,gi;const u=f.players||[],g=f.currentPlayerIdx||0,E=u[g],k=(we=E==null?void 0:E.legs)==null?void 0:we[((Ie=E==null?void 0:E.legs)==null?void 0:Ie.length)-1],V=k?k.totalScoreRemaining:f.startingScore,re=(k==null?void 0:k.dartsThrown)||0,ae=k?k.totalScoreStart-k.totalScoreRemaining:0,F=re>0?ae/re*3:0,at=((pi=(Os=k==null?void 0:k.visits)==null?void 0:Os[k.visits.length-1])==null?void 0:pi.score)??0;let lt="";u.length===2?lt=`${((xi=u[0])==null?void 0:xi.legsWon)||0}-${((gi=u[1])==null?void 0:gi.legsWon)||0}`:u.length>2&&(lt=u.map(xr=>`${xr.name}:${xr.legsWon||0}`).join(" = "));const it=f.bestLegThisMatch,Qe=it?`${it.darts} darts${(()=>{const xr=u.find(rc=>rc.id===it.playerId);return xr?` (${xr.name})`:""})()}`:"";return n.jsxs("div",{className:"p-3 rounded-2xl bg-slate-900/40 border border-white/10 text-white text-sm",children:[n.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),n.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[n.jsx("div",{className:"opacity-80",children:"Current score"}),n.jsx("div",{className:"font-mono text-right",children:lt}),n.jsx("div",{className:"opacity-80",children:"Current thrower"}),n.jsx("div",{className:"text-right font-semibold",children:(E==null?void 0:E.name)||""}),n.jsx("div",{className:"opacity-80",children:"Score remaining"}),n.jsx("div",{className:"text-right font-mono",children:V}),n.jsx("div",{className:"opacity-80",children:"3-dart avg"}),n.jsx("div",{className:"text-right font-mono",children:F.toFixed(1)}),n.jsx("div",{className:"opacity-80",children:"Last score"}),n.jsx("div",{className:"text-right font-mono",children:at}),n.jsx("div",{className:"opacity-80",children:"Best leg"}),n.jsx("div",{className:"text-right",children:Qe})]})]})}m.useEffect(()=>{if(!t)return;i(t.connected);const u=t.addListener(g=>{var E;try{if(g.type==="state"){f.importState(g.payload);try{const k=Number(g.payload._dpIndex),V=Number(g.payload._dpHits);Number.isFinite(k)&&Me(Math.max(0,k)),Number.isFinite(V)&&Le(Math.max(0,V))}catch{}try{const k=Number(g.payload._atcIndex),V=Number(g.payload._atcHits);Number.isFinite(k)&&xe(Math.max(0,k)),Number.isFinite(V)&&ct(Math.max(0,V))}catch{}try{const k=g.payload._cricketById;k&&typeof k=="object"&&O(k)}catch{}try{const k=g.payload._shanghaiById;k&&typeof k=="object"&&Xe(k)}catch{}try{const k=g.payload._halveById;k&&typeof k=="object"&&Mt(k)}catch{}try{const k=g.payload._highlowById;k&&typeof k=="object"&&Ze(k)}catch{}try{const k=g.payload._killerById;k&&typeof k=="object"&&dt(k)}catch{}try{const k=g.payload._amCricketById;k&&typeof k=="object"&&on(k)}catch{}try{const k=g.payload._baseballById;k&&typeof k=="object"&&vt(k)}catch{}try{const k=g.payload._golfById;k&&typeof k=="object"&&xn(k)}catch{}try{const k=g.payload._tttState;k&&typeof k=="object"&&ne(k)}catch{}try{const k=Number(g.payload._turnDarts);Number.isFinite(k)&&oe(Math.max(0,k))}catch{}}else if(g.type==="joined")g.id&&T(g.id);else if(g.type==="presence"||g.type==="peer-joined")X(k=>Array.from(new Set([...k||[],g.id].filter(Boolean))));else if(g.type==="chat"){const k=!!(g.from&&w&&g.from===w),V=k?(e==null?void 0:e.username)||"me":g.from||"peer",re=String(g.from||"");if(!k&&re&&s.isBlocked(re))return;c(ae=>[...ae,{from:V,message:g.message,fromId:re||void 0}])}else if(g.type==="matches")pt(Array.isArray(g.matches)?g.matches:[]);else if(g.type==="invite")xs({matchId:g.matchId,fromId:g.fromId,fromName:g.fromName,calibrated:!!g.calibrated,boardPreview:g.boardPreview||null,game:g.game,mode:g.mode,value:g.value,startingScore:g.startingScore});else if(g.type==="match-start")l(g.roomId),t.send({type:"join",roomId:g.roomId}),G(!0),he(!1),(E=g.match)!=null&&E.game&&Xn(g.match.game),e!=null&&e.username&&!(e!=null&&e.fullAccess)&&th(e.username);else if(g.type==="declined")Pt("Invite declined",{type:"info"});else if(g.type==="error"){const k=typeof g.message=="string"?g.message:"Action not allowed";if(nn(k),g.code==="SPECTATE_NOT_ALLOWED")try{Pt("This player has spectating turned off.",{type:"error"})}catch{}g.code==="NOT_FOUND"&&Gt&&Qn({game:Gt.game,mode:Gt.mode,value:Gt.value,startingScore:Gt.startingScore}),setTimeout(()=>nn(""),3500)}else if(g.type==="friend-invite")confirm(`${g.fromName||g.fromEmail} invited you to play ${g.game||"X01"} (${g.mode==="firstto"?"First To":"Best Of"} ${g.value||1}${g.game==="X01"&&g.startingScore?` = ${g.startingScore}`:""}). Accept?`)?t.send({type:"start-friend-match",toEmail:g.fromEmail,game:g.game,mode:g.mode,value:g.value,startingScore:g.startingScore}):Pt("Invite declined",{type:"info"});else if(g.type==="friend-message")R.add({id:g.id||`${g.ts}-${g.from}`,from:g.from,message:g.message,ts:g.ts||Date.now()}),f.inProgress||Pt(`${g.from}: ${g.message}`,{type:"info"});else if(g.type==="celebration"){const k=g.by||"Player",V=g.kind==="leg"?"leg":"180";ge(V,k)}}catch{}});return t.connected&&(t.send({type:"join",roomId:r}),t.send({type:"presence",username:(e==null?void 0:e.username)||"guest",email:((e==null?void 0:e.email)||"").toLowerCase(),allowSpectate:D}),t.send({type:"list-matches"})),()=>{u()}},[t==null?void 0:t.connected]);function Ge(){if(t){t.send({type:"state",payload:{...f,_turnIdx:Z,_participants:W,_dpIndex:pe,_dpHits:Ne,_atcIndex:ue,_atcHits:Re,_cricketById:M,_shanghaiById:ze,_halveById:et,_highlowById:St,_killerById:gt,_amCricketById:yt,_baseballById:qn,_golfById:pn,_tttState:Tt,_turnDarts:le}});return}const u=P.current;!u||u.readyState!==WebSocket.OPEN||u.send(JSON.stringify({type:"state",payload:{...f,_turnIdx:Z,_participants:W,_dpIndex:pe,_dpHits:Ne,_atcIndex:ue,_atcHits:Re,_cricketById:M,_shanghaiById:ze,_halveById:et,_highlowById:St,_killerById:gt,_amCricketById:yt,_baseballById:qn,_golfById:pn,_tttState:Tt,_turnDarts:le}}))}function bt(u){const g=(e==null?void 0:e.username)||"me";if(c(k=>[...k,{from:g,message:u,fromId:w||"self"}]),N.current={text:u,ts:Date.now()},t){t.send({type:"chat",message:u});return}const E=P.current;!E||E.readyState!==WebSocket.OPEN||E.send(JSON.stringify({type:"chat",message:u}))}function Ps(u){var E;if(tu(u,pe)){const k=Ne+1,V=pe+1;Le(k),Me(V);try{if(k>=Dn.length){const re=((E=f.players[f.currentPlayerIdx])==null?void 0:E.name)||"Player";ge("leg",re),Le(0),Me(0)}}catch{}}Ge()}function ys(){const u=Math.max(0,Math.floor(J|0));Ps(u),me(0)}function ts(){const u=br(ke);u!=null&&(Ps(u),$e(""))}function ql(u,g,E){const k=Rt[ue];return k==null?!1:typeof E=="number"&&E>=1&&E<=20&&E===k&&(g==="SINGLE"||g==="DOUBLE"||g==="TRIPLE")?!0:k===25?g==="BULL"||u===25:k===50?g==="INNER_BULL"||u===50:u===k||u===k*2||u===k*3}function ur(u,g,E){var k;if(ql(u,g,E)){const V=Re+1,re=ue+1;ct(V),xe(re);try{if(V>=Rt.length){const ae=((k=f.players[f.currentPlayerIdx])==null?void 0:k.name)||"Player";ge("leg",ae),ct(0),xe(0)}}catch{}}Ge()}function Ql(){const u=Math.max(0,Math.floor(J|0));ur(u),me(0)}function Wr(){const u=br(nt);u!=null&&(ur(u),Ft(""))}function Ke(){const u=f.players[f.currentPlayerIdx];return(u==null?void 0:u.id)??String(f.currentPlayerIdx)}function ns(u){M[u]||O(g=>({...g,[u]:kr()}))}function ci(u){ze[u]||Xe(g=>({...g,[u]:Hs()}))}function ss(u){et[u]||Mt(g=>({...g,[u]:Ws()}))}function rs(u){St[u]||Ze(g=>({...g,[u]:Vs()}))}function As(u){if(!gt[u]){const g=new Set(Object.values(gt||{}).map(V=>V.number)),E=[];for(let V=1;V<=20;V++)g.has(V)||E.push(V);const k=E.length>0?E[Math.floor(Math.random()*E.length)]:20;dt(V=>({...V,[u]:wx(k,3)}))}}function di(u){yt[u]||on(g=>({...g,[u]:Ra()}))}function Cn(u){qn[u]||vt(g=>({...g,[u]:Pa()}))}function Un(u){pn[u]||xn(g=>({...g,[u]:Aa()}))}m.useEffect(()=>{oe(0)},[f.currentPlayerIdx,Ee]);function Vr(u,g){const E=f.players.filter(k=>k.id!==g);return E.length===0?!1:E.every(k=>{var V,re;return(((re=(V=M[k.id])==null?void 0:V.marks)==null?void 0:re[u])||0)>=3})}function En(u,g,E){const k=Ke();ns(k),O(re=>{const ae={...re},F={...ae[k]||kr()};return px(F,u,g,E,at=>Vr(at,k)),ae[k]=F,ae});const V=le+1;oe(V),V>=3&&(oe(0),f.nextPlayer()),Ge()}function ls(u,g,E){const k=Ke();ci(k),Xe(re=>{const ae={...re},F={...ae[k]||Hs()};return xx(F,u,g,E),ae[k]=F,ae});const V=le+1;oe(V),V>=3&&(Xe(re=>{const ae={...re},F={...ae[k]||Hs()};return gx(F),ae[k]=F,ae}),oe(0),f.nextPlayer()),Ge()}function gn(u,g,E){const k=Ke();ss(k),Mt(re=>{const ae={...re},F={...ae[k]||Ws()};return yx(F,u,g,E),ae[k]=F,ae});const V=le+1;oe(V),V>=3&&(Mt(re=>{const ae={...re},F={...ae[k]||Ws()};return vx(F),ae[k]=F,ae}),oe(0),f.nextPlayer()),Ge()}function Tn(u,g,E){const k=Ke();rs(k),Ze(re=>{const ae={...re},F={...ae[k]||Vs()};return bx(F,u,g,E),ae[k]=F,ae});const V=le+1;oe(V),V>=3&&(Ze(re=>{const ae={...re},F={...ae[k]||Vs()};return Nx(F),ae[k]=F,ae}),oe(0),f.nextPlayer()),Ge()}function Xl(u,g){const E=Ke();f.players.forEach(V=>As(V.id)),dt(V=>{var F;const re={};for(const[at,lt]of Object.entries(V))re[at]={...lt};nu(E,re,u,g);const ae=su(re);if(ae)try{ge("leg",((F=f.players.find(at=>at.id===ae))==null?void 0:F.name)||"Player")}catch{}return re});const k=le+1;oe(k),k>=3&&(oe(0),f.nextPlayer()),Ge()}function Zl(u,g,E){const k=Ke();di(k),on(re=>{const ae={...re},at={...ae[k]||Ra()};return Ex(at,u,g,E,it=>f.players.filter(Qe=>Qe.id!==k).every(Qe=>{var Ie,we;return(((we=(Ie=yt[Qe.id])==null?void 0:Ie.marks)==null?void 0:we[it])||0)>=3})),ae[k]=at,ae});const V=le+1;oe(V),V>=3&&(oe(0),f.nextPlayer()),Ge()}function as(u,g,E){const k=Ke();Cn(k),vt(re=>{const ae={...re},F={...ae[k]||Pa()};return jx(F,u,g,E),ae[k]=F,ae});const V=le+1;oe(V),V>=3&&(oe(0),f.nextPlayer()),Ge()}function mr(u,g,E){const k=Ke();Un(k),xn(re=>{const ae={...re},F={...ae[k]||Aa()};return kx(F,u,g,E),ae[k]=F,ae});const V=le+1;oe(V),V>=3&&(oe(0),f.nextPlayer()),Ge()}function ea(u,g,E,k){ne(re=>{const ae={...re,board:[...re.board]};return Cx(ae,u,g,E,k),ae});const V=le+1;oe(V),V>=3&&(oe(0),f.nextPlayer()),Ge()}function is(){try{window.dispatchEvent(new Event("ndn:open-manual"))}catch{}}function vs(u){const g=Math.max(0,u|0);f.addVisit(g,3),me(0);const E=f.players[f.currentPlayerIdx],k=E.legs[E.legs.length-1];try{g===180&&ge("180",(E==null?void 0:E.name)||"Player"),k&&k.totalScoreRemaining===0&&ge("leg",(E==null?void 0:E.name)||"Player")}catch{}if(k&&k.totalScoreRemaining===0?f.endLeg(g):f.nextPlayer(),ee){const V=k?k.totalScoreRemaining:f.startingScore;so((e==null?void 0:e.username)||"Player",g,Math.max(0,V),Y,{volume:$,checkoutOnly:Q})}e!=null&&e.username&&(E==null?void 0:E.name)===e.username&&Sr(e.username,3,g),Ge()}function Gr(u,g){var k;const E={type:"report",offenderId:u,reason:"Inappropriate language",message:g};try{t?t.send(E):(k=P.current)==null||k.send(JSON.stringify(E))}catch{}try{Pt("Report submitted",{type:"info"})}catch{}}async function os(){var u,g;try{const E=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1}),k=(u=E.getVideoTracks)==null?void 0:u.call(E)[0],V=document.createElement("video");V.srcObject=E,await V.play().catch(()=>{}),await new Promise(it=>setTimeout(it,120));const re=Math.min(320,V.videoWidth||320),ae=Math.max(1,Math.floor((V.videoHeight||180)*(re/Math.max(1,V.videoWidth||320)))),F=document.createElement("canvas");F.width=re,F.height=ae,F.getContext("2d").drawImage(V,0,0,re,ae);const lt=F.toDataURL("image/jpeg",.7);try{k&&k.stop()}catch{}try{(g=E.getTracks)==null||g.call(E).forEach(it=>it.stop())}catch{}return lt}catch{return null}}return n.jsxs("div",{className:"card flex flex-col min-h-[85vh] relative overflow-hidden",children:[n.jsx("h2",{className:"text-xl font-semibold mb-1",children:"Online Play"}),$r>0&&!f.inProgress&&n.jsxs("div",{className:"mb-3 text-sm px-3 py-2 rounded bg-amber-600/30 border border-amber-500/40",children:["You have ",$r," unread message",$r>1?"s":"",". Check the Friends tab."]}),n.jsx("div",{className:"relative",children:n.jsxs("div",{className:"rounded-2xl bg-white/5 backdrop-blur border border-white/10 p-2 flex items-center gap-2 overflow-x-auto no-scrollbar",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-xs opacity-70 shrink-0",children:"Room"}),n.jsx("input",{className:"input w-28",value:r,onChange:u=>l(u.target.value),placeholder:"room-1"})]}),a?n.jsx("span",{className:"text-[11px] px-2 py-1 rounded-full bg-emerald-600/20 text-emerald-200 border border-emerald-400/40 shrink-0",children:"Connected"}):n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 shrink-0",onClick:zr,children:"Connect"}),n.jsx("button",{className:"btn shrink-0",onClick:Ge,disabled:!a,children:"Sync"}),n.jsx("button",{className:"text-[11px] px-3 py-1 rounded-full bg-indigo-500/25 text-indigo-100 border border-indigo-400/40 hover:bg-indigo-500/40 shrink-0",title:"Open a simulated online match demo",onClick:()=>{try{window.dispatchEvent(new CustomEvent("ndn:online-match-demo",{detail:{game:"X01",start:501}}))}catch{}},children:"DEMO"}),a&&n.jsx("button",{className:"btn shrink-0",onClick:()=>G(!0),disabled:_e,title:_e?"Weekly free games used":"",children:"Open Match"})]})}),n.jsx("div",{className:`mt-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-end ${!a||_e?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,role:"button",title:a?_e?"Weekly free games used":"Create a new match":"Connect to the lobby first",onClick:()=>{var u;!a||_e||(he(!0),t?t.send({type:"list-matches"}):(u=P.current)==null||u.send(JSON.stringify({type:"list-matches"})))},children:n.jsx("button",{className:"btn",disabled:!a||_e,children:"Create Match +"})}),n.jsx("p",{className:"text-sm text-slate-600 mt-3",children:"Open this app on another device and join the same Room ID to sync scores."}),!(e!=null&&e.fullAccess)&&n.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Weekly free online games remaining: ",Ae===1/0?"":Ae]}),!(e!=null&&e.fullAccess)&&Ae!==1/0&&Ae<=0&&n.jsx("div",{className:"mt-2 p-2 rounded-lg bg-rose-700/30 border border-rose-600/40 text-rose-200 text-sm",children:"You've used your 3 free online games this week. PREMIUM required to continue."}),gs&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-rose-700/30 border border-rose-600/40 text-rose-200 text-sm font-semibold flex items-center gap-2",children:[n.jsx("span",{className:"material-icons text-rose-300",children:"error_outline"}),gs]}),Ls&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-indigo-700/30 border border-indigo-600/40 text-indigo-100 text-sm flex items-center justify-between gap-2",children:[n.jsx("div",{children:"That room is full or no longer available. Create a new clean room with the same settings?"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{var re,ae;const{game:u,mode:g,value:E,startingScore:k}=Ls,V=e!=null&&e.username?Js(e.username):0;t?(t.send({type:"create-match",game:u,mode:g,value:E,startingScore:k||501,creatorAvg:V}),t.send({type:"list-matches"})):((re=P.current)==null||re.send(JSON.stringify({type:"create-match",game:u,mode:g,value:E,startingScore:k||501,creatorAvg:V})),(ae=P.current)==null||ae.send(JSON.stringify({type:"list-matches"}))),Qn(null)},children:"Create New Match"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>Qn(null),children:"Dismiss"})]})]}),a&&n.jsxs("div",{className:"mt-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10 flex-1 overflow-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("div",{className:"font-semibold",children:"World Lobby"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"text-xs opacity-80",children:["Matches: ",_n.length]}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{var u;return t?t.send({type:"list-matches"}):(u=P.current)==null?void 0:u.send(JSON.stringify({type:"list-matches"}))},children:"Refresh"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",title:a?_e?"Weekly free games used":"Create a new match":"Connect to the lobby first",disabled:!a||_e,onClick:()=>{var u;!a||_e||(he(!0),t?t.send({type:"list-matches"}):(u=P.current)==null||u.send(JSON.stringify({type:"list-matches"})))},children:"Create Match +"})]})]}),n.jsxs("div",{className:"space-y-3 mb-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Mode"}),n.jsx(um,{tabs:[{key:"all",label:"All"},{key:"bestof",label:"Best of"},{key:"firstto",label:"First to"}],active:He,onChange:u=>kt(u)})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Game"}),n.jsxs("select",{className:"input w-full",value:mt,onChange:u=>$t(u.target.value),children:[n.jsx("option",{value:"all",children:"All"}),Wl.map(u=>n.jsx("option",{value:u,children:u},u))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Starting Score"}),n.jsxs("select",{className:"input w-full",value:Ct,onChange:u=>{const g=u.target.value;ut(g==="all"?"all":Number(g))},disabled:mt!=="all"&&mt!=="X01",children:[n.jsx("option",{value:"all",children:"All"}),n.jsx("option",{value:"301",children:"301"}),n.jsx("option",{value:"501",children:"501"}),n.jsx("option",{value:"701",children:"701"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs opacity-70 mb-1",children:"Opponent near my avg"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{id:"nearavg",type:"checkbox",className:"accent-purple-500",checked:qt,onChange:u=>Br(u.target.checked),disabled:!Fr}),n.jsx("label",{htmlFor:"nearavg",className:"cursor-pointer text-sm",children:"Near my average"}),n.jsx("input",{className:"input w-24",type:"number",min:5,max:40,step:1,value:es,onChange:u=>_r(parseInt(u.target.value||"10")),disabled:!qt})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex-1 max-w-sm",children:[n.jsx("label",{className:`block text-xs opacity-70 mb-1 ${qt?"":"opacity-40"}`,children:"Avg tolerance ()"}),n.jsx("input",{className:"w-full",type:"range",min:1,max:50,value:es,onChange:u=>_r(parseInt(u.target.value||"10")),disabled:!qt}),n.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[" ",es]})]}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{kt("all"),$t("all"),ut("all"),Br(!1),_r(10)},children:"Reset"})]})]}),_n.length===0?n.jsx("div",{className:"text-sm text-slate-300",children:"No games waiting. Create one!"}):n.jsx("div",{className:"space-y-2",children:_n.map(u=>n.jsxs("div",{className:"p-3 rounded-lg bg-black/20 flex items-center justify-between relative",children:[w&&u.creatorId===w&&n.jsx("button",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Close this match",onClick:()=>{var g;t?t.send({type:"cancel-match",matchId:u.id}):(g=P.current)==null||g.send(JSON.stringify({type:"cancel-match",matchId:u.id}))},"aria-label":"Close match",children:""}),n.jsxs("div",{className:"text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:u.creatorName}),"  ",u.game||"X01","  ",u.mode==="bestof"?`Best Of ${u.value}`:`First To ${u.value}`," ",u.game==="X01"?` X01 ${u.startingScore}`:""]}),u.requireCalibration&&n.jsx("div",{className:"text-[11px] inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-300 border border-emerald-600/30 mt-1",children:"Calibration required"}),u.creatorAvg?n.jsxs("div",{className:"text-xs opacity-70",children:["Creator avg: ",Number(u.creatorAvg).toFixed(1)]}):null,n.jsxs("div",{className:"text-xs opacity-70",children:["ID: ",u.id]})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("button",{className:"btn px-3 py-1 text-sm bg-rose-600 hover:bg-rose-700",disabled:_e||!(e!=null&&e.fullAccess)&&_s.includes(u.game)||!!u.requireCalibration&&!Ur,title:!(e!=null&&e.fullAccess)&&_s.includes(u.game)?"PREMIUM game":_e?"Weekly free games used":u.requireCalibration&&!Ur?"Calibration required":"",onClick:async()=>{var k;Ms({game:u.game,mode:u.mode,value:u.value,startingScore:u.startingScore});const g=!!Ur,E=await os();try{t?t.send({type:"join-match",matchId:u.id,calibrated:g,boardPreview:E}):(k=P.current)==null||k.send(JSON.stringify({type:"join-match",matchId:u.id,calibrated:g,boardPreview:E}))}catch(V){cn((V==null?void 0:V.message)||"Failed to create Stripe checkout session. Please try again later.")}},children:"Join Now!"})})]},u.id))})]}),!(e!=null&&e.fullAccess)&&Ae!==1/0&&Ae<=0&&n.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),n.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[n.jsx("div",{className:"text-3xl mb-2",children:""}),n.jsx("div",{className:"font-semibold",children:"Online play locked"}),n.jsx("div",{className:"text-sm text-slate-200/80",children:"Youve used your 3 free online games this week. Upgrade to PREMIUM to play all modes."}),n.jsxs("a",{href:"https://buy.stripe.com/test_00g7vQ8Qw2gQ0wA5kk",target:"_blank",rel:"noopener noreferrer",className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM = ",Up(Fp(),5)]})]})]}),I&&n.jsxs("div",{className:"fixed inset-0 z-50",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),n.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[n.jsxs("div",{className:"p-2 md:p-3 flex items-center justify-between",children:[n.jsx("div",{children:n.jsx("h3",{className:"text-xl md:text-2xl font-bold",children:"Online Match"})}),n.jsx("button",{className:"btn px-3 py-1",onClick:()=>G(!1),children:"Close"})]}),n.jsx("div",{className:"relative flex-1 overflow-hidden p-2 md:p-3",children:n.jsxs("div",{className:"card w-full h-full overflow-hidden relative p-2.5 md:p-3",children:[Oe&&n.jsxs("div",{className:"absolute inset-0 pointer-events-none flex items-start justify-center pt-8 z-20",children:[n.jsxs("div",{className:`px-4 py-2 rounded-full text-lg font-bold shadow ${Oe.kind==="leg"?"bg-indigo-500/20 border border-indigo-400/40 text-indigo-100":"bg-emerald-500/20 border border-emerald-400/40 text-emerald-100"}`,children:[Oe.kind==="leg"?" LEG WON  ":" ONE HUNDRED AND EIGHTY!  ",Oe.by]}),Oe.kind==="leg"&&n.jsxs(n.Fragment,{children:[n.jsx("style",{children:"@keyframes ndn-confetti-fall{0%{transform:translateY(-10%) rotate(0deg);opacity:1}100%{transform:translateY(120%) rotate(360deg);opacity:0}}"}),n.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(24)].map((u,g)=>{const E=Math.random()*100,k=Math.random()*.2,V=1.2+Math.random()*.8,re=6+Math.random()*6,ae=Math.floor(Math.random()*360);return n.jsx("span",{style:{position:"absolute",top:0,left:E+"%",width:re,height:re,background:`hsl(${ae} 90% 60%)`,borderRadius:2,animation:`ndn-confetti-fall ${V}s ease-out ${k}s forwards`}},g)})})]})]}),n.jsxs("div",{className:"mb-1.5 text-xs md:text-sm flex items-center justify-between gap-2",children:[n.jsxs("span",{children:["Participants: ",W.length||1]}),n.jsx("button",{className:"text-[11px] px-2 py-0.5 rounded-full bg-slate-700/50 hover:bg-slate-700 border border-slate-600",onClick:()=>K(u=>!u),title:se?"Switch to full multi-player view":"Switch to compact player-by-player view",children:se?"Full view":"Compact view"})]}),se?n.jsxs("div",{className:"mb-3",children:[(()=>{var at;const u=f.currentPlayerIdx,g=f.players[u];if(!g)return null;const E=g.legs[g.legs.length-1],k=E?E.totalScoreRemaining:f.startingScore,V=(e==null?void 0:e.username)&&g.name===e.username,re=E&&E.visits.length?E.visits[E.visits.length-1].score:0,ae=E?E.dartsThrown:0,F=ae>0?(((E==null?void 0:E.totalScoreStart)??f.startingScore)-k)/ae*3:0;return Ee==="X01"?n.jsxs("div",{className:`p-4 rounded-xl bg-brand-50 text-black ${u===f.currentPlayerIdx?"ring-2 ring-brand-400":""}`,children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:g.name}),n.jsx("span",{className:`px-2 py-0.5 rounded-full ${u===f.currentPlayerIdx?"bg-emerald-500/20 text-emerald-300":"bg-slate-500/20 text-slate-300"} text-xs font-bold`,children:u===f.currentPlayerIdx?"THROWING":"WAITING TO THROW"})]}),n.jsx("div",{className:"text-4xl font-extrabold",children:k}),n.jsxs("div",{className:"text-sm mt-1",children:["Last score: ",n.jsx("span",{className:"font-semibold",children:re})]}),n.jsxs("div",{className:"text-sm",children:["3-Dart Avg: ",n.jsx("span",{className:"font-semibold",children:F.toFixed(1)})]}),V&&u===f.currentPlayerIdx&&k<=170&&k>0&&n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-indigo-50 border border-indigo-200 text-indigo-900 text-sm",children:["Checkout suggestions (fav ",B,"): ",Lo(k,B).join("    ")||""]})]}):n.jsxs("div",{className:`p-4 rounded-xl bg-brand-50 text-black ${u===f.currentPlayerIdx?"ring-2 ring-brand-400":""}`,children:[n.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:g.name}),n.jsx("span",{className:`px-2 py-0.5 rounded-full ${u===f.currentPlayerIdx?"bg-emerald-500/20 text-emerald-300":"bg-slate-500/20 text-slate-300"} text-xs font-bold`,children:u===f.currentPlayerIdx?"THROWING":"WAITING TO THROW"})]}),n.jsx("div",{className:"text-sm opacity-80",children:Ee}),Ee==="Double Practice"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mt-1 text-xs flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:((at=Dn[pe])==null?void 0:at.label)||""})]}),n.jsxs("div",{className:"text-3xl font-extrabold",children:[Ne," / ",Dn.length]})]}),Ee==="Around the Clock"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mt-1 text-xs flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:Rt[ue]===25?"25 (Outer Bull)":Rt[ue]===50?"50 (Inner Bull)":Rt[ue]||""})]}),n.jsxs("div",{className:"text-3xl font-extrabold",children:[Re," / ",Rt.length]})]})]})})(),f.players.length>1&&n.jsxs("div",{className:"mt-2 text-xs text-slate-400",children:["Next up: ",(Kr=f.players[(f.currentPlayerIdx+1)%f.players.length])==null?void 0:Kr.name]})]}):n.jsx(n.Fragment,{children:n.jsx("div",{className:"mb-3 flex flex-wrap items-center gap-2",children:f.players.map((u,g)=>{var V,re,ae,F,at,lt,it,Qe;const E=u.legs[u.legs.length-1],k=E?E.totalScoreRemaining:f.startingScore;return n.jsxs("div",{className:`px-2 py-1 rounded bg-black/20 border border-slate-700/40 text-xs ${g===f.currentPlayerIdx?"ring-1 ring-brand-400":""}`,children:[n.jsx("span",{className:"font-semibold",children:u.name}),Ee==="X01"?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"opacity-70",children:" = "}),n.jsx("span",{className:"font-mono",children:k})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"opacity-70",children:" = "}),n.jsx("span",{className:"font-mono",children:Ee==="Double Practice"?`${Ne}/${Dn.length}`:Ee==="Around the Clock"?`${Re}/${Rt.length}`:Ee==="Cricket"?`${((V=M[u.id])==null?void 0:V.points)||0} pts`:Ee==="Shanghai"?`${((re=ze[u.id])==null?void 0:re.score)||0} pts = R${((ae=ze[u.id])==null?void 0:ae.round)||1}`:Ee==="Halve It"?`${((F=et[u.id])==null?void 0:F.score)||0} pts = S${(((at=et[u.id])==null?void 0:at.stage)||0)+1}`:Ee==="High-Low"?`${((lt=St[u.id])==null?void 0:lt.score)||0} pts = ${((it=St[u.id])==null?void 0:it.target)||"HIGH"}`:Ee==="Killer"?(()=>{const Ie=gt[u.id];return Ie?`#${Ie.number} = ${Ie.lives} ${Ie.isKiller?"= K":""}`:""})():Ee==="American Cricket"?`${((Qe=yt[u.id])==null?void 0:Qe.points)||0} pts`:Ee==="Baseball"?(()=>{const Ie=qn[u.id];return Ie?`R${Ie.score} = I${Ie.inning}`:""})():Ee==="Golf"?(()=>{const Ie=pn[u.id];return Ie?`S${Ie.strokes} = H${Ie.hole}`:""})():Ee==="Tic Tac Toe"?(()=>{const Ie=(Tt.board||[]).filter(Os=>Os==="X").length,we=(Tt.board||[]).filter(Os=>Os==="O").length;return`X${Ie}-O${we}`})():Ee})]})]},`strip-${u.id}`)})})}),se?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-autoscore"))}catch{}},children:"Autoscore"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-scoring"))}catch{}},children:"Scoring"}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:is,children:"Manual Correction"}),n.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[11px]",children:[n.jsx("span",{className:"opacity-70",children:"Cam size"}),n.jsx("button",{className:"btn px-2 py-0.5",onClick:()=>de(Math.max(.5,Math.round((z-.05)*100)/100)),children:""}),n.jsxs("span",{className:"w-8 text-center",children:[Math.round(z*100),"%"]}),n.jsx("button",{className:"btn px-2 py-0.5",onClick:()=>de(Math.min(1.25,Math.round((z+.05)*100)/100)),children:"+"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mt-2 items-start",children:[n.jsx("div",{className:"order-1",children:n.jsx(Hr,{})}),n.jsx("div",{className:"order-2",children:e!=null&&e.username&&((fr=f.players[f.currentPlayerIdx])==null?void 0:fr.name)===e.username?n.jsx("div",{className:"min-w-[260px] relative z-10",children:n.jsx(Po,{label:"Your Board",autoStart:!1})}):n.jsx("div",{className:"text-xs opacity-60",children:"Opponent's camera will appear here when supported"})})]}),n.jsxs("div",{className:"font-semibold",children:["Current: ",((Jr=f.players[f.currentPlayerIdx])==null?void 0:Jr.name)||""]}),Ee==="X01"&&(e!=null&&e.username)&&((Fn=f.players[f.currentPlayerIdx])==null?void 0:Fn.name)===e.username?n.jsxs(n.Fragment,{children:[n.jsx(Fe,{hideInlinePanels:!0,showToolbar:!1,onVisitCommitted:(u,g,E)=>{if(ee){const V=f.players[f.currentPlayerIdx],re=V==null?void 0:V.legs[V.legs.length-1],ae=re?re.totalScoreRemaining:f.startingScore;so((e==null?void 0:e.username)||"Player",u,Math.max(0,ae),Y,{volume:$,checkoutOnly:Q})}const k=f.players[f.currentPlayerIdx];e!=null&&e.username&&(k==null?void 0:k.name)===e.username&&Sr(e.username,g,u);try{u===180&&ge("180",(k==null?void 0:k.name)||"Player"),E&&ge("leg",(k==null?void 0:k.name)||"Player")}catch{}E||f.nextPlayer(),Ge()}}),n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>vs(J),children:"Submit Visit"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs bg-slate-700 hover:bg-slate-800",onClick:()=>{f.undoVisit(),Ge()},children:"Undo"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mt-1.5 text-xs",children:[n.jsx("span",{className:"opacity-70",children:"Quick:"}),[180,140,100,60].map(u=>n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>vs(u),children:u},u))]}),n.jsxs("div",{className:"mt-2 flex items-center gap-1.5 mb-2",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>x(!0),children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>y(!0),children:"Messages"})]})]}):Ee==="Double Practice"&&(e!=null&&e.username)&&((bs=f.players[f.currentPlayerIdx])==null?void 0:bs.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Double Practice  Hit doubles D1D20DBULL"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:((Yr=Dn[pe])==null?void 0:Yr.label)||""})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:[Ne," / ",Dn.length]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g)=>{(g==="DOUBLE"||g==="INNER_BULL")&&Ps(u)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&ys()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:ys,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[n.jsx("input",{className:"input w-40 text-sm",placeholder:"Manual (D16, 50, 25, T20)",value:ke,onChange:u=>$e(u.target.value),onKeyDown:u=>{u.key==="Enter"&&ts()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:ts,children:"Add"})]})]}):Ee==="Around the Clock"&&(e!=null&&e.username)&&((Rs=f.players[f.currentPlayerIdx])==null?void 0:Rs.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Around the Clock  Hit 120 then 25 (outer) and 50 (inner)"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:Rt[ue]===25?"25 (Outer Bull)":Rt[ue]===50?"50 (Inner Bull)":Rt[ue]||""})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:[Re," / ",Rt.length]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{ur(u,g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&Ql()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:Ql,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-1.5",children:[n.jsx("input",{className:"input w-40 text-sm",placeholder:"Manual (T20, D5, 25, 50)",value:nt,onChange:u=>Ft(u.target.value),onKeyDown:u=>{u.key==="Enter"&&Wr()}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:Wr,children:"Add"})]})]}):Ee==="Cricket"&&(e!=null&&e.username)&&((qr=f.players[f.currentPlayerIdx])==null?void 0:qr.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Cricket  Close 15-20 and Bull; overflow scores points"}),(()=>{const u=Ke();ns(u);const g=M[u]||kr();return n.jsx("div",{className:"mb-2 grid grid-cols-7 gap-1 text-center text-[11px]",children:ni.map(E=>{var k;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:E===25?"Bull":E}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((k=g.marks)==null?void 0:k[E])||0)," / 3"]})]},E)})})})(),n.jsxs("div",{className:"text-sm mb-2",children:["Points: ",n.jsx("span",{className:"font-semibold",children:((ta=M[Ke()])==null?void 0:ta.points)||0})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{En(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&(En(Math.max(0,J|0)),me(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{En(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="Shanghai"&&(e!=null&&e.username)&&((Qr=f.players[f.currentPlayerIdx])==null?void 0:Qr.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();ci(u);const g=ze[u]||Hs();return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Shanghai  Hit only the round's number; Single/Double/Triple score"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Round"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:g.round})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:["Score: ",g.score]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{ls(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&(ls(Math.max(0,J|0)),me(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{ls(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="Halve It"&&(e!=null&&e.username)&&((na=f.players[f.currentPlayerIdx])==null?void 0:na.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();ss(u);const g=et[u]||Ws(),E=Ao(g);return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Halve It  Hit the target each round or your score halves"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Stage"}),n.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[g.stage+1,"/",g.targets.length]})]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:(()=>{const k=E;return k?k.kind==="ANY_NUMBER"?"Any":k.kind==="BULL"?"Bull":k.kind==="DOUBLE"||k.kind==="TRIPLE"||k.kind==="NUMBER"?`${k.kind} ${k.num}`:"":""})()})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:["Score: ",g.score]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{gn(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&(gn(Math.max(0,J|0)),me(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{gn(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="High-Low"&&(e!=null&&e.username)&&((Xr=f.players[f.currentPlayerIdx])==null?void 0:Xr.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();rs(u);const g=St[u]||Vs();return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"High-Low  Alternate aiming for high then low segments"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Round"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:g.round})]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:g.target})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:["Score: ",g.score]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{Tn(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&(Tn(Math.max(0,J|0)),me(0))}}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{Tn(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="American Cricket"&&(e!=null&&e.username)&&((sa=f.players[f.currentPlayerIdx])==null?void 0:sa.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"American Cricket  Close 12-20 and Bull; overflow scores"}),(()=>{const u=Ke();di(u);const g=yt[u]||Ra();return n.jsx("div",{className:"mb-2 grid grid-cols-5 gap-1 text-center text-[11px]",children:sc.map(E=>{var k;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:E===25?"Bull":E}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((k=g.marks)==null?void 0:k[E])||0)," / 3"]})]},E)})})})(),n.jsxs("div",{className:"text-sm mb-2",children:["Points: ",n.jsx("span",{className:"font-semibold",children:((Zr=yt[Ke()])==null?void 0:Zr.points)||0})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{Zl(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})})]}):Ee==="Baseball"&&(e!=null&&e.username)&&((ra=f.players[f.currentPlayerIdx])==null?void 0:ra.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();Cn(u);const g=qn[u]||Pa();return n.jsxs("div",{className:"text-xs mb-1.5",children:["Baseball  Inning ",g.inning,"  Runs ",g.score]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{as(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})})]}):Ee==="Golf"&&(e!=null&&e.username)&&((hr=f.players[f.currentPlayerIdx])==null?void 0:hr.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();Un(u);const g=pn[u]||Aa();return n.jsxs("div",{className:"text-xs mb-1.5",children:["Golf  Hole ",g.hole," (target ",Sx[g.hole],")  Strokes ",g.strokes]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{mr(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})})]}):Ee==="Tic Tac Toe"&&(e!=null&&e.username)&&((el=f.players[f.currentPlayerIdx])==null?void 0:el.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Tic Tac Toe  Tap a cell to claim by hitting its target"}),n.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(u,g)=>g).map(u=>n.jsx("button",{className:`h-12 rounded-xl border ${Tt.board[u]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(Tt.finished||Tt.board[u])return;const g=dm[u],E=prompt(`Enter dart for cell ${u} (target ${g.type==="BULL"?"Bull":g.num}) e.g. 20/40/60 or 25/50`),k=Number(E||0),V=k%3===0?"TRIPLE":k%2===0?"DOUBLE":"SINGLE",re=g.type==="BULL"?null:g.num||null;ea(u,k,V,re)},children:Tt.board[u]||""},u))}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{}})})]}):e!=null&&e.username&&((pr=f.players[f.currentPlayerIdx])==null?void 0:pr.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsxs("div",{className:"text-xs mb-1.5",children:[Ee," (online)  manual turn entry"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("input",{className:"input w-24 text-sm",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{const u=Math.max(0,J|0);f.addVisit(u,3),me(0),f.nextPlayer(),Ge()},children:"Submit"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs bg-slate-700 hover:bg-slate-800",onClick:()=>{f.undoVisit(),Ge()},children:"Undo"})]})]}):n.jsx("div",{className:"p-4 rounded-xl bg-slate-800/30 border border-slate-700/40 text-center text-slate-300 font-semibold",children:"WAITING TO THROW"}),n.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>x(!0),children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>y(!0),children:"Messages"})]})]}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[n.jsx("div",{className:"space-y-1.5",children:n.jsx(Hr,{})}),n.jsxs("div",{className:"md:col-span-2 space-y-1.5",children:[n.jsxs("div",{className:"flex items-center gap-1.5 mt-2",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-autoscore"))}catch{}},children:"Autoscore"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{try{window.dispatchEvent(new Event("ndn:open-scoring"))}catch{}},children:"Scoring"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:is,children:"Manual Correction"}),n.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[n.jsx("span",{className:"opacity-70",children:"Cam"}),n.jsx("button",{className:"btn px-1 py-0.5",onClick:()=>de(Math.max(.5,Math.round((z-.05)*100)/100)),children:""}),n.jsxs("span",{className:"w-7 text-center",children:[Math.round(z*100),"%"]}),n.jsx("button",{className:"btn px-1 py-0.5",onClick:()=>de(Math.min(1.25,Math.round((z+.05)*100)/100)),children:"+"})]})]}),n.jsx("div",{className:"mt-2",children:e!=null&&e.username&&((la=f.players[f.currentPlayerIdx])==null?void 0:la.name)===e.username?n.jsx("div",{className:"w-full max-w-full",children:n.jsx(Po,{label:"Your Board",autoStart:!1})}):n.jsx("div",{className:"text-xs opacity-60",children:"Opponent's camera will appear here when supported"})}),n.jsxs("div",{className:"font-semibold text-sm md:text-base",children:["Current: ",((aa=f.players[f.currentPlayerIdx])==null?void 0:aa.name)||""]}),Ee==="X01"&&(e!=null&&e.username)&&((ia=f.players[f.currentPlayerIdx])==null?void 0:ia.name)===e.username?n.jsxs(n.Fragment,{children:[n.jsx(Fe,{hideInlinePanels:!0,showToolbar:!1,onVisitCommitted:(u,g,E)=>{if(ee){const V=f.players[f.currentPlayerIdx],re=V==null?void 0:V.legs[V.legs.length-1],ae=re?re.totalScoreRemaining:f.startingScore;so((e==null?void 0:e.username)||"Player",u,Math.max(0,ae),Y,{volume:$,checkoutOnly:Q})}const k=f.players[f.currentPlayerIdx];e!=null&&e.username&&(k==null?void 0:k.name)===e.username&&Sr(e.username,g,u);try{u===180&&ge("180",(k==null?void 0:k.name)||"Player"),E&&ge("leg",(k==null?void 0:k.name)||"Player")}catch{}E||f.nextPlayer(),Ge()}}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>vs(J),children:"Submit Visit (Manual)"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{f.undoVisit(),Ge()},children:"Undo"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2 text-sm",children:[n.jsx("span",{className:"opacity-70",children:"Quick:"}),[180,140,100,60].map(u=>n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>vs(u),children:u},u))]}),(()=>{var k,V;const u=f.players[f.currentPlayerIdx],g=(V=u==null?void 0:u.legs)==null?void 0:V[((k=u.legs)==null?void 0:k.length)-1],E=g?g.totalScoreRemaining:f.startingScore;return E>0&&E<=170?n.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-indigo-50 border border-indigo-200 text-indigo-900 text-sm",children:["Checkout suggestions (fav ",B,"): ",Lo(E,B).join("    ")||""]}):null})()]}):Ee==="Double Practice"&&(e!=null&&e.username)&&((oa=f.players[f.currentPlayerIdx])==null?void 0:oa.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-sm mb-2",children:"Double Practice  Hit doubles D1D20DBULL"}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Current target"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:((ca=Dn[pe])==null?void 0:ca.label)||""})]}),n.jsxs("div",{className:"text-2xl font-extrabold mb-2",children:[Ne," / ",Dn.length]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g)=>{(g==="DOUBLE"||g==="INNER_BULL")&&Ps(u)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0")),onKeyDown:u=>{u.key==="Enter"&&ys()}}),n.jsx("button",{className:"btn",onClick:ys,children:"Add Dart"})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[n.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:ke,onChange:u=>$e(u.target.value),onKeyDown:u=>{u.key==="Enter"&&ts()}}),n.jsx("button",{className:"btn",onClick:ts,children:"Add"})]})]}):Ee==="Cricket"&&(e!=null&&e.username)&&((ui=f.players[f.currentPlayerIdx])==null?void 0:ui.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsx("div",{className:"text-sm mb-2",children:"Cricket  Close 15-20 and Bull; overflow scores points"}),(()=>{const u=Ke();ns(u);const g=M[u]||kr();return n.jsx("div",{className:"mb-2 grid grid-cols-7 gap-1 text-center text-[11px]",children:ni.map(E=>{var k;return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[n.jsx("div",{className:"opacity-70",children:E===25?"Bull":E}),n.jsxs("div",{className:"font-semibold",children:[Math.min(3,((k=g.marks)==null?void 0:k[E])||0)," / 3"]})]},E)})})})(),n.jsxs("div",{className:"text-sm mb-2",children:["Points: ",n.jsx("span",{className:"font-semibold",children:((tl=M[Ke()])==null?void 0:tl.points)||0})]}),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{En(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{En(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="Shanghai"&&(e!=null&&e.username)&&((mi=f.players[f.currentPlayerIdx])==null?void 0:mi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();ci(u);const g=ze[u]||Hs();return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"text-sm mb-2",children:["Shanghai  Round ",g.round,"  Score ",g.score]})})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{ls(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{ls(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="Halve It"&&(e!=null&&e.username)&&((nl=f.players[f.currentPlayerIdx])==null?void 0:nl.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();ss(u);const g=et[u]||Ws(),E=Ao(g);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-sm mb-2",children:["Halve It  Stage ",g.stage+1,"/",g.targets.length,"  Score ",g.score]}),n.jsxs("div",{className:"text-sm",children:["Target: ",n.jsx("span",{className:"font-semibold",children:(()=>{const k=E;return k?k.kind==="ANY_NUMBER"?"Any":k.kind==="BULL"?"Bull":k.kind==="DOUBLE"||k.kind==="TRIPLE"||k.kind==="NUMBER"?`${k.kind} ${k.num}`:"":""})()})]})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{gn(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{gn(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="High-Low"&&(e!=null&&e.username)&&((fi=f.players[f.currentPlayerIdx])==null?void 0:fi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();rs(u);const g=St[u]||Vs();return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"text-sm mb-2",children:["High-Low  Round ",g.round,"  Target ",g.target,"  Score ",g.score]})})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 mb-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{Tn(u,g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{Tn(Math.max(0,J|0)),me(0)},children:"Add Dart"})]})]}):Ee==="Killer"&&(e!=null&&e.username)&&((sl=f.players[f.currentPlayerIdx])==null?void 0:sl.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[(()=>{const u=Ke();f.players.forEach(E=>As(E.id));const g=gt[u];return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs mb-1.5",children:"Killer  Hit your own double to become Killer; then remove others lives by hitting their doubles/triples."}),n.jsxs("div",{className:"mb-1 text-sm flex items-center justify-between",children:[n.jsx("span",{children:"Your number"}),n.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:(g==null?void 0:g.number)||""})]}),n.jsxs("div",{className:"text-sm",children:["Lives: ",n.jsx("span",{className:"font-semibold",children:(g==null?void 0:g.lives)??""})," ",g!=null&&g.isKiller?n.jsx("span",{className:"ml-2 text-emerald-300",children:"KILLER"}):null]}),n.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-3 gap-1 text-[11px]",children:f.players.map(E=>{const k=gt[E.id];return n.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50 flex items-center justify-between",children:[n.jsx("span",{className:"opacity-80 truncate",children:E.name}),n.jsx("span",{className:"font-mono",children:k?`#${k.number} = ${k.lives}${k.isKiller?" = K":""}`:""})]},E.id)})})]})})(),n.jsx("div",{className:"rounded-2xl overflow-hidden bg-black/60 border border-white/10 my-2",children:n.jsx(Fe,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:(u,g,E)=>{Xl(g==="MISS"?void 0:g,(E==null?void 0:E.sector)??null)}})}),n.jsx("div",{className:"text-xs opacity-70",children:"Tip: Only doubles/triples on the opponents numbers remove lives. To become Killer, hit your own double."})]}):e!=null&&e.username&&((hi=f.players[f.currentPlayerIdx])==null?void 0:hi.name)===e.username?n.jsxs("div",{className:"p-3 rounded-xl bg-black/20",children:[n.jsxs("div",{className:"text-sm mb-2",children:[Ee," (online)  manual turn entry"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{className:"input w-28",type:"number",min:0,value:J,onChange:u=>me(parseInt(u.target.value||"0"))}),n.jsx("button",{className:"btn",onClick:()=>{const u=Math.max(0,J|0);f.addVisit(u,3),me(0),f.nextPlayer(),Ge()},children:"Submit"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>{f.undoVisit(),Ge()},children:"Undo"})]})]}):n.jsx("div",{className:"p-4 rounded-xl bg-slate-800/30 border border-slate-700/40 text-center text-slate-300 font-semibold",children:"WAITING TO THROW"})]}),n.jsx("div",{className:"md:col-span-1",children:n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>x(!0),children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>y(!0),children:"Messages"})]})})]})]})})]})]}),Ce&&n.jsx("div",{className:"fixed inset-0 bg-black/70 z-50",children:n.jsx("div",{className:"w-full h-full flex items-stretch justify-stretch p-0",children:n.jsxs(qs,{storageKey:"ndn:modal:create-match",className:"w-full h-full rounded-none !border-0 !shadow-none relative",fullScreen:!0,children:[n.jsx("div",{className:"flex items-center justify-between mb-3 sticky top-0 bg-slate-900/80 backdrop-blur border-b border-slate-700 z-10 px-2 py-2",children:n.jsx("h3",{className:"text-xl font-bold",children:"Create Match"})}),n.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-2 md:gap-4 overflow-auto px-2",style:{maxHeight:"calc(100vh - 120px)"},children:[n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Game"}),n.jsx("select",{className:"input w-full",value:At,onChange:u=>Rr(u.target.value),children:Wl.map(u=>n.jsxs("option",{value:u,disabled:!(e!=null&&e.fullAccess)&&_s.includes(u),children:[u," ",!(e!=null&&e.fullAccess)&&_s.includes(u)?"(PREMIUM)":""]},u))})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Mode"}),n.jsxs("select",{className:"input w-full",value:Ve,onChange:u=>Lt(u.target.value),children:[n.jsx("option",{value:"bestof",children:"Best Of"}),n.jsx("option",{value:"firstto",children:"First To"})]})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Value"}),At==="X01"?n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"flex flex-wrap gap-1",children:[101,201,301,401,501].map(u=>n.jsx("button",{className:`btn px-2 py-1 text-xs ${Vt===u?"bg-purple-600 hover:bg-purple-700":""}`,onClick:()=>tn(u),children:u},u))}),n.jsx("input",{className:"input w-full",type:"number",min:1,value:Vt,onChange:u=>tn(parseInt(u.target.value||"1")),placeholder:"Or enter custom value"})]}):n.jsx("input",{className:"input w-full",type:"number",min:1,value:Vt,onChange:u=>tn(parseInt(u.target.value||"1"))}),n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Example: Best Of 5  first to 3"})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Starting Score"}),At==="X01"?n.jsx("select",{className:"input w-full",value:qe,onChange:u=>Bn(parseInt(u.target.value||"501")),children:[301,501,701].map(u=>n.jsx("option",{value:u,children:u},u))}):n.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Starting score applies to X01 only"})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-sm text-slate-300 mb-1",children:"Require Calibration"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{id:"calibreq",type:"checkbox",className:"accent-purple-500",checked:Zn,onChange:u=>Or(u.target.checked)}),n.jsx("label",{htmlFor:"calibreq",className:"text-sm opacity-80",children:"Players must be calibrated"})]})]}),n.jsx("div",{className:"col-span-1",children:n.jsxs("div",{className:"p-3 rounded-lg bg-black/20 border border-slate-700/40",children:[n.jsx("div",{className:"text-xs text-slate-300 uppercase tracking-wide mb-1",children:"Summary"}),n.jsxs("div",{className:"text-sm font-semibold",children:[At,"  ",Ve==="bestof"?`Best Of ${Vt}`:`First To ${Vt}`," ",At==="X01"?` ${qe}`:""]}),!(e!=null&&e.fullAccess)&&_s.includes(At)&&n.jsx("div",{className:"text-xs text-rose-300 mt-1",children:"PREMIUM required"})]})})]}),n.jsxs("div",{className:"sticky bottom-0 bg-slate-900/80 backdrop-blur border-t border-slate-700 z-10 px-2 py-2",children:[n.jsx("button",{className:"btn w-full",disabled:!(e!=null&&e.fullAccess)&&_s.includes(At),title:!(e!=null&&e.fullAccess)&&_s.includes(At)?"PREMIUM game":"",onClick:()=>{var g,E;const u=e!=null&&e.username?Js(e.username):0;t?(t.send({type:"create-match",game:At,mode:Ve,value:Vt,startingScore:qe,creatorAvg:u,requireCalibration:Zn}),he(!1),t.send({type:"list-matches"})):((g=P.current)==null||g.send(JSON.stringify({type:"create-match",game:At,mode:Ve,value:Vt,startingScore:qe,creatorAvg:u,requireCalibration:Zn})),he(!1),(E=P.current)==null||E.send(JSON.stringify({type:"list-matches"})))},children:"START GAME!"}),n.jsx("div",{className:"flex justify-center mt-2",children:n.jsx("button",{className:"btn px-2 py-1",onClick:()=>he(!1),children:"Close"})})]})]})})}),rt&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs(qs,{storageKey:"ndn:modal:invite",className:"w-full relative",defaultWidth:620,defaultHeight:420,minWidth:520,minHeight:320,maxWidth:1e3,maxHeight:800,children:[n.jsx("h3",{className:"text-xl font-bold mb-1",children:"Incoming Match Request"}),n.jsxs("div",{className:"text-sm mb-2",children:[n.jsx("span",{className:"font-semibold",children:rt.fromName})," wants to join your match.",n.jsx("span",{className:`ml-2 text-xs px-2 py-0.5 rounded ${rt.calibrated?"bg-emerald-500/20 text-emerald-300 border border-emerald-600/30":"bg-amber-500/20 text-amber-200 border border-amber-600/30"}`,children:rt.calibrated?"Calibrated":"Not calibrated"})]}),(rt.game||rt.mode)&&n.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[rt.game||"X01","  ",rt.mode==="firstto"?`First To ${rt.value}`:`Best Of ${rt.value}`," ",rt.game==="X01"&&rt.startingScore?` ${rt.startingScore}`:""]}),rt.boardPreview?n.jsx("div",{className:"mb-3",children:n.jsx("img",{src:rt.boardPreview,alt:"Board preview",className:"rounded-lg w-full max-h-64 object-contain bg-black/40 border border-slate-700"})}):n.jsx("div",{className:"mb-3 text-xs opacity-60",children:"No camera preview provided."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{var u;t?t.send({type:"invite-response",matchId:rt.matchId,accept:!0,toId:rt.fromId}):(u=P.current)==null||u.send(JSON.stringify({type:"invite-response",matchId:rt.matchId,accept:!0,toId:rt.fromId})),xs(null)},children:"Accept"}),n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>{var u;t?t.send({type:"invite-response",matchId:rt.matchId,accept:!1,toId:rt.fromId}):(u=P.current)==null||u.send(JSON.stringify({type:"invite-response",matchId:rt.matchId,accept:!1,toId:rt.fromId})),xs(null)},children:"Decline"})]})]})}),d&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:n.jsxs(qs,{storageKey:"ndn:modal:quick-chat",className:"w-full relative",defaultWidth:520,defaultHeight:280,minWidth:360,minHeight:220,maxWidth:900,maxHeight:700,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Quick Chat"}),n.jsx("button",{className:"btn px-2 py-1 text-sm",onClick:()=>x(!1),children:"Close"})]}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:["Good luck!","Good game!","Nice darts!","Well played!","Ready?"].map(u=>n.jsx("button",{className:"btn px-2 py-0.5 text-xs",onClick:()=>{bt(u),x(!1)},disabled:!a,children:u},u))})]})}),S&&n.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:n.jsxs(qs,{storageKey:"ndn:modal:messages",className:"w-full relative",defaultWidth:560,defaultHeight:360,minWidth:380,minHeight:260,maxWidth:1e3,maxHeight:800,children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Messages"}),n.jsx("button",{className:"btn px-2 py-1 text-sm",onClick:()=>y(!1),children:"Close"})]}),n.jsx(hN,{items:o.slice(-30).filter(u=>!s.isBlocked(String(u.fromId||""))).map((u,g)=>({key:String(g),from:u.from,id:String(u.fromId||u.from),text:u.message})),onDelete:u=>c(g=>g.filter((E,k)=>k!==u)),onReport:u=>{const E=o.slice(-30).filter(k=>!s.isBlocked(String(k.fromId||"")))[u];E&&Gr(null,E.message)},onBlock:u=>{const E=o.slice(-30).filter(k=>!s.isBlocked(String(k.fromId||"")))[u];if(E){try{s.block(String(E.fromId||E.from))}catch{}c(k=>k.filter(V=>String(V.fromId||V.from)!==String(E.fromId||E.from)));try{Pt(`${E.from} blocked`,{type:"info"})}catch{}}}})]})})]})}function hN({items:e,onDelete:t,onReport:s,onBlock:r}){const l=(()=>{try{const d=navigator.userAgent||"";return/Android|iPhone|iPad|iPod|Mobile/i.test(d)}catch{return!1}})(),[a,i]=m.useState(null),[o,c]=m.useState(null);return n.jsx("div",{className:"h-24 overflow-auto text-sm divide-y divide-slate-700/40",children:e.length===0?n.jsx("div",{className:"opacity-60 py-1",children:"No messages yet."}):e.map((d,x)=>{const S=Mx(d.text),y=Z1(d.text);return n.jsxs("div",{className:"relative group px-1 py-1 flex items-start gap-2",onTouchStart:l?N=>{const w=N.touches[0];i({x:w.clientX,y:w.clientY,i:x,t:Date.now()})}:void 0,onTouchMove:l?N=>{if(!a||a.i!==x)return;N.touches[0].clientX-a.x<-40&&c(x)}:void 0,onTouchEnd:l?()=>{const N=a?Date.now()-a.t:0;(o===x||N>600)&&(t(x),c(null)),i(null)}:void 0,children:[n.jsxs("span",{className:"text-slate-400 shrink-0",children:["[",d.from,"]"]}),n.jsx("span",{className:"text-white break-words whitespace-pre-wrap flex-1",children:S}),!l&&n.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1 ml-2",children:[n.jsx("button",{className:"w-5 h-5 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center",title:"Delete message","aria-label":"Delete message",onClick:()=>t(x),children:""}),r&&n.jsx("button",{className:"px-1.5 py-0.5 rounded bg-slate-700 hover:bg-slate-800 text-slate-100 text-[11px]",onClick:()=>r(x),title:"Block sender",children:"Block"}),n.jsx("button",{className:"px-1.5 py-0.5 rounded bg-amber-600/40 hover:bg-amber-600/60 text-amber-100 text-[11px]",onClick:()=>s(x),title:"Report message",children:"Report"})]}),y&&n.jsx("span",{className:"ml-2 text-[10px] px-1 rounded bg-rose-600/30 text-rose-200 border border-rose-600/40",children:"Filtered"})]},d.key)})})}function pN({user:e}){const{players:t,inProgress:s,startingScore:r,newMatch:l}=La(),[a,i]=m.useState("x01"),[o,c]=m.useState("Player 1, Player 2"),[d,x]=m.useState(501),[S,y]=m.useState([]),[N,w]=m.useState(""),[T,P]=m.useState(!1),[v,h]=m.useState(""),[b,C]=m.useState([]),[j,f]=m.useState(!1),R=String((e==null?void 0:e.email)||"").toLowerCase();m.useEffect(()=>{let $=!1;async function Q(){try{if(!R)return;const de=await(await fetch(`/api/friends/list?email=${encodeURIComponent(R)}`)).json().catch(()=>({friends:[]}));$||y(de.friends||[])}catch{}}Q();const D=setInterval(Q,2e4);return()=>{$=!0,clearInterval(D)}},[R]),m.useEffect(()=>{try{const $=R?`ndn:stats:opponent:${R}`:"ndn:stats:opponent",Q=localStorage.getItem($);Q&&w(Q)}catch{}},[R]),m.useEffect(()=>{try{const $=R?`ndn:stats:opponent:${R}`:"ndn:stats:opponent";N?localStorage.setItem($,N):localStorage.removeItem($)}catch{}},[N,R]);async function B($){if(h($),!$.trim()){C([]);return}f(!0);try{const D=await(await fetch(`/api/friends/search?q=${encodeURIComponent($)}`)).json().catch(()=>({results:[]}));C(D.results||[])}finally{f(!1)}}const ee=m.useMemo(()=>{const $=new Map;if(a==="x01")for(const D of t)for(const z of D.legs)for(const de of z.visits){const I=Math.max(0,Math.min(180,de.score));$.set(I,($.get(I)??0)+1)}const Q=Array.from($.entries()).sort((D,z)=>D[0]-z[0]);return Q.length===0&&a==="x01"?([0,26,41,60,81,100,120,140,160,180].forEach(D=>$.set(D,0)),Array.from($.entries()).sort((D,z)=>D[0]-z[0]).map(([D,z])=>({label:D,value:z}))):Q.map(([D,z])=>({label:D,value:z}))},[t,a]),Y=m.useMemo(()=>{const $=nm(Wl);return Wl.map(Q=>{const D=$[Q]||{played:0,won:0};return{label:Q,value:D.played,extra:D.won}})},[a]);return m.useEffect(()=>{const $=()=>i(Q=>Q);return window.addEventListener("ndn:stats-updated",$),()=>window.removeEventListener("ndn:stats-updated",$)},[]),n.jsxs("div",{className:"card",children:[n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Match Stats"}),n.jsx("span",{className:"text-xs opacity-70",children:"View"})]}),n.jsx(um,{tabs:[{key:"x01",label:"X01"},{key:"other",label:"Other Modes"}],active:a,onChange:$=>i($)})]}),t.length===0&&n.jsxs("div",{className:"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-2",children:"No match data yet"}),n.jsx("div",{className:"text-sm opacity-80 mb-2",children:"Start a quick X01 match to generate stats. Stats like Best/Worst 3-dart are finalized when you end the game."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-end",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-slate-300 mb-1",children:"Players (comma separated)"}),n.jsx("input",{className:"input w-full",value:o,onChange:$=>c($.target.value)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-slate-300 mb-1",children:"Starting Score"}),n.jsx("input",{className:"input w-full",type:"number",value:d,onChange:$=>x(parseInt($.target.value||"501"))})]}),n.jsx("div",{children:n.jsx("button",{className:"btn w-full",onClick:()=>{const $=o.split(",").map(Q=>Q.trim()).filter(Boolean);if(!$.length)return alert("Enter at least one player");l($,d)},children:"Start Match"})})]})]}),s&&n.jsx("div",{className:"mb-3 p-2 rounded-lg text-sm border border-amber-500/40 bg-amber-500/10 text-amber-200",children:"Note: Detailed leg stats are finalized at the end of the game."}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.map(($,Q)=>n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:Q===1&&!N?$.name||"Opponent":Q===1&&N?N:$.name}),Q===1&&n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[n.jsx("button",{className:"text-[11px] px-3 py-1 rounded-full bg-white/5 border border-white/10 hover:bg-white/10",onClick:()=>P(D=>!D),title:"Search user to compare",children:"Select Friend"}),S.slice(0,6).map(D=>{const z=D.username||D.email,de=N===z;return n.jsx("button",{className:`text-[11px] px-3 py-1 rounded-full border ${de?"bg-indigo-500/30 border-indigo-400/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>w(z),title:`Compare vs ${z}`,children:z},D.email)}),S.length===0&&n.jsx("button",{className:"text-[11px] px-3 py-1 rounded-full bg-white/5 border border-white/10",disabled:!0,children:"Find friends to compare"})]})]}),Q===1&&T&&n.jsxs("div",{className:"mb-2 p-2 rounded-lg bg-black/20 border border-white/10",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{className:"input flex-1 py-1",placeholder:"Search by name or email",value:v,onChange:D=>B(D.target.value)}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>B(v),disabled:j,children:"Search"})]}),n.jsxs("ul",{className:"max-h-40 overflow-auto space-y-1",children:[b.map(D=>{const z=D.username||D.email;return n.jsx("li",{children:n.jsx("button",{className:"w-full text-left px-2 py-1 rounded bg-white/5 hover:bg-white/10 border border-white/10 text-sm",onClick:()=>{w(z),P(!1)},children:z})},D.email)}),!b.length&&n.jsx("li",{className:"text-xs opacity-70",children:v.trim()?"No results":"Type to search"})]})]}),Q===1&&N?n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 3-Dart"}),n.jsx("div",{className:"font-semibold",children:st(yn(N).best3||0)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Worst 3-Dart"}),n.jsx("div",{className:"font-semibold",children:st(yn(N).worst3||0)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 9-Dart (fewest darts)"}),n.jsx("div",{className:"font-semibold",children:(()=>{const D=yn(N);return D.bestLegDarts?`${D.bestLegDarts} darts`:""})()})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best Checkout"}),n.jsx("div",{className:"font-semibold",children:yn(N).bestCheckout||""})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Averages (All-time vs Monthly)"}),n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["3-dart: ",st(Js(N)),"  ",st(Wc(N))]}),n.jsxs("span",{children:["First 9: ",st(Hc(N)),"  ",st(Vc(N))]})]})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"All-time snapshot"}),(()=>{const D=yn(N);return n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["Best 3-dart: ",st(D.best3||0)]}),n.jsxs("span",{children:["Worst 3-dart: ",st(D.worst3||0)]}),n.jsxs("span",{children:["Best leg: ",D.bestLegDarts||0," darts"]}),n.jsxs("span",{children:["Best checkout: ",D.bestCheckout||0]})]})})()]})]}):n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 3-Dart"}),n.jsx("div",{className:"font-semibold",children:st($.bestThreeDartAvg)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Worst 3-Dart"}),n.jsx("div",{className:"font-semibold",children:st($.worstThreeDartAvg)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 9-Dart (fewest darts)"}),n.jsx("div",{className:"font-semibold",children:$.bestNineDart?`${$.bestNineDart.darts} darts`:""})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best Checkout"}),n.jsx("div",{className:"font-semibold",children:$.bestCheckout??""})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Averages (All-time vs Monthly)"}),n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["3-dart: ",st(Js($.name)),"  ",st(Wc($.name))]}),n.jsxs("span",{children:["First 9: ",st(Hc($.name)),"  ",st(Vc($.name))]})]})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"All-time snapshot"}),(()=>{const D=yn($.name);return n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["Best 3-dart: ",st(D.best3||0)]}),n.jsxs("span",{children:["Worst 3-dart: ",st(D.worst3||0)]}),n.jsxs("span",{children:["Best leg: ",D.bestLegDarts||0," darts"]}),n.jsxs("span",{children:["Best checkout: ",D.bestCheckout||0]})]})})()]})]})]},$.id)),t.length<=1&&n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("div",{className:"font-semibold",children:"Opponent"}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[S.slice(0,6).map($=>{const Q=$.username||$.email,D=N===($.username||$.email);return n.jsx("button",{className:`text-[11px] px-3 py-1 rounded-full border ${D?"bg-indigo-500/30 border-indigo-400/50":"bg-white/5 border-white/10 hover:bg-white/10"}`,onClick:()=>w(Q),title:`Compare vs ${Q}`,children:Q},$.email)}),S.length===0&&n.jsx("span",{className:"text-xs opacity-70",children:"Add friends to compare stats."})]})]}),N?n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Comparing to"}),n.jsx("div",{className:"font-semibold",children:N})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 3-Dart"}),n.jsx("div",{className:"font-semibold",children:st(Js(N))})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Worst 3-Dart"}),n.jsx("div",{className:"font-semibold",children:st(yn(N).worst3||0)})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best 9-Dart (fewest darts)"}),n.jsx("div",{className:"font-semibold",children:(()=>{const $=yn(N);return $.bestLegDarts?`${$.bestLegDarts} darts`:""})()})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10",children:[n.jsx("div",{className:"text-slate-300",children:"Best Checkout"}),n.jsx("div",{className:"font-semibold",children:yn(N).bestCheckout||""})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"Averages (All-time vs Monthly)"}),n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["3-dart: ",st(Js(N)),"  ",st(Wc(N))]}),n.jsxs("span",{children:["First 9: ",st(Hc(N)),"  ",st(Vc(N))]})]})]}),n.jsxs("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 col-span-2",children:[n.jsx("div",{className:"text-slate-300",children:"All-time snapshot"}),(()=>{const $=yn(N);return n.jsxs("div",{className:"font-semibold flex flex-wrap gap-3 text-[13px]",children:[n.jsxs("span",{children:["Best 3-dart: ",st($.best3||0)]}),n.jsxs("span",{children:["Worst 3-dart: ",st($.worst3||0)]}),n.jsxs("span",{children:["Best leg: ",$.bestLegDarts||0," darts"]}),n.jsxs("span",{children:["Best checkout: ",$.bestCheckout||0]})]})})()]})]}):n.jsx("div",{className:"text-sm opacity-70",children:"Select a friend above to compare."})]})]}),n.jsxs("div",{className:"mt-6",children:[n.jsxs("div",{className:"mb-2 text-sm opacity-80",children:["Score Distribution (",a.toUpperCase(),"): Visits by scored points"]}),n.jsx("div",{className:"rounded-xl border border-indigo-500/40 bg-indigo-500/10 p-3",children:n.jsx(au,{data:ee,showValues:!1})})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("div",{className:"mb-2 text-sm opacity-80",children:"Other Modes: games played (bar height) with wins shown beneath each label"}),n.jsxs("div",{className:"rounded-xl border border-indigo-500/40 bg-indigo-500/10 p-3",children:[n.jsx(au,{data:Y.map($=>({label:$.label,value:$.value})),showValues:!1}),n.jsx("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 text-[11px] opacity-80",children:Y.map(($,Q)=>n.jsxs("div",{className:"flex items-center justify-between px-2 py-1 rounded-md bg-white/5 border border-white/10",children:[n.jsx("span",{className:"truncate mr-2",children:$.label}),n.jsxs("span",{className:"whitespace-nowrap",children:["Played ",$.value,"  Won ",$.extra]})]},Q))})]})]})]})}function xN({user:e}){const t=Ml(),s=(()=>{try{return mm()}catch{return null}})(),[r,l]=m.useState([]),[a,i]=m.useState(!1),[o,c]=m.useState(""),[d,x]=m.useState(null),[S,y]=m.useState(!1),[N,w]=m.useState({open:!1,t:null}),[T,P]=m.useState({open:!1,t:null}),[v,h]=m.useState({title:"Community X01 Tournament",game:"X01",mode:"bestof",value:3,description:"",startAt:new Date(Date.now()+2*60*60*1e3).toISOString().slice(0,16),checkinMinutes:15,capacity:8,startingScore:501}),b=(()=>{try{return"ontouchstart"in window||(navigator.maxTouchPoints||0)>0}catch{return!1}})();async function C(){try{const G=await(await fetch("/api/tournaments")).json();l(Array.isArray(G.tournaments)?G.tournaments:[])}catch{}}m.useEffect(()=>{C()},[]),m.useEffect(()=>{if(!s)return;const I=s.addListener(G=>{try{G.type==="tournaments"&&l(G.tournaments||[])}catch{}});return()=>{I()}},[s==null?void 0:s.connected]);const j=String((e==null?void 0:e.email)||"").toLowerCase();m.useEffect(()=>{let I=!1;async function G(){if(!j){x(null);return}try{const X=await(await fetch(`/api/subscription?email=${encodeURIComponent(j)}`)).json();I||((X==null?void 0:X.source)==="tournament"&&typeof X.expiresAt=="number"&&X.expiresAt>Date.now()?x(X.expiresAt):x(null))}catch{I||x(null)}}return G(),()=>{I=!0}},[j]);function f(I){var G;return!!((G=I.participants)!=null&&G.some(W=>W.email===j))}async function R(I){j&&P({open:!0,t:I})}async function B(){const I=T.t;if(!(!I||!j)){P({open:!1,t:null}),i(!0);try{let G=await fetch("/api/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I.id,requesterEmail:j})});if(!G.ok&&G.status===403&&String(j)==="daviesfamily108@gmail.com"&&(G=await fetch("/api/admin/tournaments/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I.id,requesterEmail:j})})),!G.ok){let W="Delete failed";try{const X=await G.json();X!=null&&X.error&&(W=`Delete failed: ${String(X.error)}`)}catch{}t(W,{type:"error"});return}t("Tournament deleted",{type:"success"}),await C()}finally{i(!1)}}}async function ee(I){if(j){i(!0);try{const G=await fetch("/api/tournaments/join",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I.id,email:j,username:e==null?void 0:e.username})});if(!G.ok){let W={};try{W=await G.json()}catch{}(W==null?void 0:W.error)==="WINNER_COOLDOWN"&&typeof W.until=="number"?(c(`You're a recent NDN tournament winner. You can re-enter after ${de(W.until)}.`),setTimeout(()=>c(""),6e3),t("Join blocked: winner cooldown active",{type:"error"})):W!=null&&W.error&&(c(String(W.error)),setTimeout(()=>c(""),3500),t(`Join failed: ${String(W.error)}`,{type:"error"}));return}t("Joined tournament",{type:"success"}),await C()}finally{i(!1)}}}async function Y(I){if(j){i(!0);try{const G=await fetch("/api/tournaments/leave",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournamentId:I.id,email:j})});if(!G.ok){let W={};try{W=await G.json()}catch{}W!=null&&W.error?t(`Leave failed: ${String(W.error)}`,{type:"error"}):G.status===404?t("Leave failed (endpoint not found). Restart the server to enable /api/tournaments/leave.",{type:"error"}):t("Leave failed. Please try again.",{type:"error"});return}t("Left tournament",{type:"success"}),l(W=>W.map(X=>X.id===I.id?{...X,participants:(X.participants||[]).filter(Z=>Z.email!==j)}:X)),await C()}finally{i(!1)}}}async function $(){i(!0);try{const I=new Date(v.startAt).getTime();await fetch("/api/tournaments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:v.title,game:v.game,mode:v.mode,value:Number(v.value),description:v.description,startAt:I,checkinMinutes:Number(v.checkinMinutes),capacity:Number(v.capacity),startingScore:v.game==="X01"?Number(v.startingScore||501):void 0,creatorEmail:e==null?void 0:e.email,creatorName:e==null?void 0:e.username})}),y(!1),t("Tournament created",{type:"success"}),await C()}finally{i(!1)}}m.useEffect(()=>{if(!S)return;const I=G=>{G.key==="Escape"&&y(!1)};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[S]);const Q=m.useMemo(()=>r.filter(I=>I.official),[r]),D=m.useMemo(()=>r.filter(I=>!I.official),[r]),z=m.useMemo(()=>Q.filter(G=>G.status==="scheduled").sort((G,W)=>G.startAt-W.startAt)[0]||null,[Q]);function de(I){return new Date(I).toLocaleString()}return n.jsxs("div",{className:"card",children:[n.jsx("div",{className:"flex items-center justify-between mb-3",children:n.jsx("h2",{className:"text-2xl font-bold",children:"Tournaments"})}),n.jsx("div",{className:"mb-3 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/40 flex items-center justify-end",children:n.jsx("button",{className:"btn",onClick:()=>y(!0),children:"Create Tournament +"})}),n.jsx("div",{className:"mb-2 text-sm font-semibold text-slate-300",children:"World Lobby"}),z&&n.jsx("div",{className:"mb-4 p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm uppercase tracking-wide text-indigo-300 font-semibold",children:"Weekly Official Tournament"}),n.jsx("div",{className:"font-bold",children:z.title}),n.jsxs("div",{className:"text-sm opacity-80",children:[z.game,z.game==="X01"&&z.startingScore?`/${z.startingScore}`:"","  ",z.mode==="firstto"?"First to":"Best of"," ",z.value,"  Starts ",de(z.startAt),"  Cap ",z.capacity,"  Joined ",z.participants.length]}),z.prize&&n.jsxs("div",{className:"text-xs mt-1",children:["Prize: ",z.prizeType==="cash"&&z.prizeAmount?`${z.currency||"USD"} ${z.prizeAmount}`:"1 month PREMIUM"]}),z.status!=="scheduled"&&n.jsxs("div",{className:"text-xs",children:["Status: ",z.status]}),d&&d>Date.now()&&n.jsxs("div",{className:"text-xs text-rose-300",children:["Recent winners can re-enter after ",de(d),"."]})]}),n.jsx("div",{className:"shrink-0",children:n.jsx("button",{className:`btn ${f(z)?"bg-emerald-600 hover:bg-emerald-600":""}`,title:f(z)?"Double-click to leave this tournament":z.official&&d&&d>Date.now()?`Recent winners can re-enter after ${de(d)}`:"",disabled:a||z.status!=="scheduled"||!f(z)&&(z.participants.length>=z.capacity||!!d&&d>Date.now()),onClick:()=>{f(z)?b&&w({open:!0,t:z}):ee(z)},onDoubleClick:()=>{!b&&f(z)&&w({open:!0,t:z})},"aria-label":f(z)?"Already Joined":"Join Now",children:f(z)?"Already Joined!":"Join Now"})})]})}),o&&n.jsx("div",{className:"mb-3 p-2 rounded-lg bg-amber-700/30 border border-amber-600/40 text-amber-200 text-sm",children:o}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("section",{children:[n.jsx("div",{className:"font-semibold mb-1",children:"Official"}),n.jsx("div",{className:"text-xs opacity-70 mb-2",children:d&&d>Date.now()?n.jsxs(n.Fragment,{children:["Youre a recent NDN tournament winner  to keep it fair, you can re-enter after ",de(d),"."]}):n.jsx(n.Fragment,{children:"Note: Weekly winners can re-enter once their prize month of PREMIUM ends."})}),n.jsxs("ul",{className:"space-y-2",children:[Q.map(I=>n.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsxs("div",{className:"font-semibold",children:[I.title," ",I.prize&&n.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 align-middle",children:[n.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-500 text-black",children:"Prize"}),n.jsx("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-full bg-slate-600 text-white text-[10px] leading-none cursor-help",title:I.prizeType==="cash"?"Official cash prize tournament  payout handled by admin.":"Weekly winners get 1 month of PREMIUM and can re-enter once their prize month ends.","aria-label":"Prize info",children:"i"})]})]}),n.jsxs("div",{className:"text-sm opacity-80",children:[I.game,I.game==="X01"&&I.startingScore?`/${I.startingScore}`:"","  ",I.mode==="firstto"?"First to":"Best of"," ",I.value,"  ",de(I.startAt),"  Cap ",I.capacity,"  Joined ",I.participants.length]}),I.prize&&n.jsxs("div",{className:"text-xs",children:["Prize: ",I.prizeType==="cash"&&I.prizeAmount?`${I.currency||"USD"} ${I.prizeAmount}`:"1 month PREMIUM",I.status==="completed"&&I.prizeType==="cash"&&I.payoutStatus&&n.jsx("span",{className:`ml-2 px-2 py-0.5 rounded ${I.payoutStatus==="paid"?"bg-emerald-600":"bg-amber-600"}`,children:I.payoutStatus==="paid"?"Paid":"Pending"})]}),I.status!=="scheduled"&&n.jsxs("div",{className:"text-xs",children:["Status: ",I.status]}),f(I)&&n.jsx("div",{className:"text-xs text-emerald-400 font-semibold",children:"Already Joined"}),I.official&&d&&d>Date.now()&&n.jsxs("div",{className:"text-xs text-rose-300",children:["Cooldown active until ",de(d),"."]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:`btn ${f(I)?"bg-emerald-600 hover:bg-emerald-600":""}`,title:f(I)?"Double-click to leave this tournament":I.official&&d&&d>Date.now()?`Recent winners can re-enter after ${de(d)}`:"",disabled:a||I.status!=="scheduled"||!f(I)&&(I.participants.length>=I.capacity||I.official&&!!d&&d>Date.now()),onClick:()=>{f(I)?b&&w({open:!0,t:I}):ee(I)},onDoubleClick:()=>{!b&&f(I)&&w({open:!0,t:I})},"aria-label":f(I)?"Already Joined":"Join Now",children:f(I)?"Already Joined!":"Join Now"}),I.status==="scheduled"&&j&&I.creatorEmail&&String(I.creatorEmail).toLowerCase()===j&&n.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Delete this tournament",onClick:()=>R(I),"aria-label":"Delete tournament",children:""})]})]},I.id)),Q.length===0&&n.jsx("li",{className:"text-sm opacity-60",children:"No official tournaments yet."})]})]}),n.jsxs("section",{children:[n.jsx("div",{className:"font-semibold mb-1",children:"Community"}),n.jsxs("ul",{className:"space-y-2",children:[D.map(I=>n.jsxs("li",{className:"p-3 rounded bg-black/10 flex items-center justify-between relative",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx("div",{className:"font-semibold",children:I.title}),n.jsxs("div",{className:"text-sm opacity-80",children:[I.game,I.game==="X01"&&I.startingScore?`/${I.startingScore}`:"","  ",I.mode==="firstto"?"First to":"Best of"," ",I.value,"  ",de(I.startAt),"  Cap ",I.capacity,"  Joined ",I.participants.length]}),I.description&&n.jsx("div",{className:"text-xs opacity-80",children:I.description}),f(I)&&n.jsx("div",{className:"text-xs text-emerald-400 font-semibold",children:"Already Joined"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"btn",title:f(I)?"Double-click to leave this tournament":"",disabled:a||I.status!=="scheduled"||!f(I)&&I.participants.length>=I.capacity,onClick:()=>{f(I)?b&&w({open:!0,t:I}):ee(I)},onDoubleClick:()=>{!b&&f(I)&&w({open:!0,t:I})},children:f(I)?"Already Joined":"Join Now"}),I.status==="scheduled"&&j&&I.creatorEmail&&String(I.creatorEmail).toLowerCase()===j&&n.jsx("button",{className:"w-6 h-6 rounded-full bg-rose-600 hover:bg-rose-700 text-white text-xs flex items-center justify-center shadow",title:"Delete this tournament",onClick:()=>R(I),"aria-label":"Delete tournament",children:""})]})]},I.id)),D.length===0&&n.jsx("li",{className:"text-sm opacity-60",children:"No community tournaments yet."})]})]})]}),S&&n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"card relative",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h3",{className:"text-xl font-semibold",children:"Create Tournament"}),n.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Close"})]}),n.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-2 md:gap-4 pr-1",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Title"}),n.jsx("input",{className:"input w-full",value:v.title,onChange:I=>h(G=>({...G,title:I.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Game"}),n.jsx("select",{className:"input w-full",value:v.game,onChange:I=>h(G=>({...G,game:I.target.value})),children:["X01","Around the Clock","Cricket","Halve It","Shanghai","High-Low","Killer"].map(I=>n.jsx("option",{value:I,children:I},I))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Mode"}),n.jsxs("select",{className:"input w-full",value:v.mode,onChange:I=>h(G=>({...G,mode:I.target.value})),children:[n.jsx("option",{value:"bestof",children:"Best of"}),n.jsx("option",{value:"firstto",children:"First to"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Number"}),n.jsx("input",{className:"input w-full",type:"number",min:1,value:v.value,onChange:I=>h(G=>({...G,value:Number(I.target.value)}))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Description"}),n.jsx("textarea",{className:"input w-full",rows:5,value:v.description,onChange:I=>h(G=>({...G,description:I.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Start time"}),n.jsx("input",{className:"input w-full",type:"datetime-local",value:v.startAt,onChange:I=>h(G=>({...G,startAt:I.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Check-in reminder (min)"}),n.jsx("input",{className:"input w-full",type:"number",min:0,value:v.checkinMinutes,onChange:I=>h(G=>({...G,checkinMinutes:Number(I.target.value)}))})]})]}),v.game==="X01"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"X01 Starting Score"}),n.jsx("select",{className:"input w-full",value:String(v.startingScore),onChange:I=>h(G=>({...G,startingScore:Number(I.target.value)})),children:[301,501,701].map(I=>n.jsx("option",{value:I,children:I},I))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Capacity"}),n.jsx("input",{className:"input w-full",type:"number",min:6,max:64,value:v.capacity,onChange:I=>h(G=>({...G,capacity:Number(I.target.value)}))})]}),n.jsx("div",{className:"text-xs opacity-70",children:"Note: community tournaments do not award prizes."}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{className:"btn",disabled:a,onClick:$,children:"Create"})})]})]})}),N.open&&N.t&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>w({open:!1,t:null})}),n.jsxs("div",{className:"relative card p-4 w-[360px] max-w-[90vw]",children:[n.jsx("div",{className:"text-lg font-semibold mb-2",children:"Leave tournament?"}),n.jsxs("div",{className:"text-sm opacity-80 mb-4",children:["Are you sure you want to remove yourself from ",N.t.title,"?"]}),n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700",onClick:()=>w({open:!1,t:null}),children:"Decline"}),n.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:async()=>{const I=N.t;w({open:!1,t:null}),await Y(I)},children:"Accept"})]})]})]}),T.open&&T.t&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsx("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xl font-semibold mb-4 text-white",children:"Delete Tournament"}),n.jsxs("div",{className:"text-slate-300 mb-6",children:["Are you sure you want to delete ",n.jsxs("span",{className:"font-semibold text-white",children:['"',T.t.title,'"']}),"?",n.jsx("br",{}),n.jsx("span",{className:"text-sm text-slate-400",children:"This action cannot be undone."})]}),n.jsxs("div",{className:"flex gap-3 justify-center",children:[n.jsx("button",{className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",onClick:()=>P({open:!1,t:null}),children:"Decline"}),n.jsx("button",{className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",onClick:B,children:"Continue"})]})]})})})]})}function gN({user:e}){const[t,s]=m.useState(null),[r,l]=m.useState(!0),[a,i]=m.useState(null);if(m.useEffect(()=>{(async()=>{try{const d=e!=null&&e.email?`?email=${encodeURIComponent(e.email)}`:"",x=await fetch("/api/subscription"+d);if(!x.ok)throw new Error("Failed to fetch subscription");const S=await x.json();s(S)}catch(d){i(d instanceof Error?d.message:"Something went wrong")}finally{l(!1)}})()},[e==null?void 0:e.email]),r)return n.jsx("div",{className:"card",children:n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500 mx-auto mb-4"}),n.jsx("p",{children:"Loading subscription..."})]})});if(a)return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-red-300 mb-2",children:"Subscription Error"}),n.jsx("p",{className:"mb-4 text-red-200",children:a}),n.jsx("button",{onClick:()=>window.location.reload(),className:"btn bg-red-600 hover:bg-red-700",children:"Retry"})]});const o=t==null?void 0:t.fullAccess;return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-indigo-300 mb-2",children:o?"PREMIUM Active":"Admin PREMIUM"}),o?n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"bg-green-500/20 border border-green-500/40 rounded-lg p-4 mb-4",children:[n.jsx("div",{className:"flex items-center gap-2 text-green-300 font-semibold mb-2",children:" PREMIUM Access Active"}),n.jsx("p",{className:"text-green-200 text-sm",children:"You have full access to all premium features!"}),(t==null?void 0:t.source)&&n.jsxs("p",{className:"text-green-200 text-xs mt-1",children:["Source: ",t.source,(t==null?void 0:t.expiresAt)&&` (expires: ${new Date(t.expiresAt).toLocaleDateString()})`]})]}),n.jsx("h3",{className:"text-lg font-semibold mb-2 text-indigo-200",children:"Your Benefits:"})]}):n.jsx("p",{className:"mb-2 text-indigo-200",children:"Unlock every game mode known to darts, advanced stats, and admin tools."}),n.jsxs("ul",{className:"mb-4",children:[n.jsx("li",{children:"All game modes (including paid/advanced)"}),n.jsx("li",{children:"Online play with all rules and variations"}),n.jsx("li",{children:"Advanced analytics and leaderboards"}),n.jsx("li",{children:"Admin tools for managing matches and users"})]}),!o&&n.jsx("button",{onClick:async()=>{try{const d=await(await fetch("/api/stripe/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})})).json();d.ok&&d.url?window.open(d.url,"_blank"):d.error==="STRIPE_NOT_CONFIGURED"?useToast()("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):useToast()("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{useToast()("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold shadow-lg hover:scale-105 transition",children:"Subscribe to PREMIUM"})]})}function yN({open:e,onClose:t,width:s=700,title:r,footer:l,children:a,side:i="right"}){return m.useEffect(()=>{function o(c){c.key==="Escape"&&t()}return e&&document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[e,t]),n.jsxs("div",{className:`fixed inset-0 z-50 ${e?"":"pointer-events-none"}`,"aria-hidden":!e,children:[n.jsx("div",{className:`absolute inset-0 bg-black/60 transition-opacity ${e?"opacity-100":"opacity-0"}`,onClick:t}),n.jsxs("div",{className:`absolute top-0 ${i==="right"?"right-0 border-l":"left-0 border-r"} h-full bg-slate-900 border-slate-700 shadow-2xl w-full sm:w-auto flex flex-col transition-transform duration-200 ${e?"translate-x-0":i==="right"?"translate-x-full":"-translate-x-full"}`,style:{width:typeof s=="number"?`${s}px`:s},role:"dialog","aria-modal":"true",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-700 sticky top-0 bg-slate-900 z-10",children:[n.jsx("div",{className:"text-lg font-semibold",children:r}),n.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:t,children:"Close"})]}),n.jsx("div",{className:"flex-1 overflow-auto p-4",children:a}),l&&n.jsx("div",{className:"px-4 py-3 border-t border-slate-700 sticky bottom-0 bg-slate-900 z-10",children:l})]})]})}function vN({user:e}){const t=_p(e==null?void 0:e.email),[s,r]=m.useState(null),[l,a]=m.useState(""),[i,o]=m.useState("");async function c(){try{const S=await fetch("/readyz");r(await S.json())}catch{}}if(m.useEffect(()=>{c();const S=setInterval(c,5e3);return()=>clearInterval(S)},[]),!t)return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Ops"}),n.jsx("div",{children:"Restricted"})]});async function d(S){o("");try{const y=await fetch("/api/admin/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:S,requesterEmail:e==null?void 0:e.email})}),N=await y.json();!y.ok||!(N!=null&&N.ok)?o((N==null?void 0:N.error)||"Failed"):o(`Maintenance ${S?"enabled":"disabled"}`)}catch{o("Network error")}}async function x(){o("");const S=l.trim();if(S)try{const y=await fetch("/api/admin/announce",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:S,requesterEmail:e==null?void 0:e.email})}),N=await y.json();!y.ok||!(N!=null&&N.ok)?o((N==null?void 0:N.error)||"Failed"):o("Announcement broadcasted"),a("")}catch{o("Network error")}}return n.jsxs("div",{className:"card",children:[n.jsx("h2",{className:"text-2xl font-bold text-brand-700 mb-2",children:"Ops"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Readiness"}),n.jsxs("div",{className:"text-sm",children:["HTTP: ",n.jsx("span",{className:`font-semibold ${s!=null&&s.ok?"text-emerald-300":"text-rose-300"}`,children:String(!!(s!=null&&s.ok))})]}),n.jsxs("div",{className:"text-sm",children:["WS: ",n.jsx("span",{className:`font-semibold ${s!=null&&s.ws?"text-emerald-300":"text-rose-300"}`,children:String(!!(s!=null&&s.ws))})]}),n.jsxs("div",{className:"text-sm",children:["Clients: ",n.jsx("span",{className:"font-semibold",children:(s==null?void 0:s.clients)??0})]}),n.jsxs("div",{className:"text-sm",children:["Rooms: ",n.jsx("span",{className:"font-semibold",children:(s==null?void 0:s.rooms)??0})]}),n.jsxs("div",{className:"text-sm",children:["Heap Used: ",n.jsxs("span",{className:"font-semibold",children:[s!=null&&s.mem?Math.round(s.mem.heapUsed/1024/1024):0," MB"]})]})]}),n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Maintenance"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"btn",onClick:()=>d(!0),children:"Enable"}),n.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>d(!1),children:"Disable"})]})]}),n.jsxs("div",{className:"p-3 rounded-xl border border-indigo-500/40 bg-indigo-500/10",children:[n.jsx("div",{className:"font-semibold mb-1",children:"Announcement"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{className:"input flex-1",placeholder:"Message to broadcast",value:l,onChange:S=>a(S.target.value)}),n.jsx("button",{className:"btn",onClick:x,children:"Send"})]})]})]}),i&&n.jsx("div",{className:"text-xs mt-2",children:i}),n.jsx("div",{className:"text-xs opacity-70 mt-2",children:"Note: For 1.5k+ concurrent users, deploy the server behind a reverse proxy (NGINX/Cloudflare), enable process clustering, and scale horizontally with sticky sessions for WebSockets."})]})}const Zc={};function bN(){const e=m.useRef(null),[t,s]=m.useState(""),[r,l]=m.useState(!1),[a,i]=m.useState(null),o=(()=>{try{return mm()}catch{return null}})(),[c,d]=m.useState("score"),[x,S]=m.useState(!1),[y,N]=m.useState(!1),[w,T]=m.useState(null),[P,v]=m.useState(0),{avgMode:h}=Yn();m.useEffect(()=>{const j=localStorage.getItem("authToken");if(j){const f=(Zc==null?void 0:Zc.VITE_API_URL)||"";fetch(`${f}/api/auth/me`,{headers:{Authorization:`Bearer ${j}`}}).then(R=>R.json()).then(R=>{R!=null&&R.user?T(R.user):localStorage.removeItem("authToken")}).catch(()=>{})}},[]),m.useEffect(()=>{const j=()=>{try{localStorage.removeItem("mockUser"),localStorage.removeItem("authToken")}catch{}T(null),d("score")};return window.addEventListener("ndn:logout",j),()=>window.removeEventListener("ndn:logout",j)},[]),m.useEffect(()=>{if(!(w!=null&&w.username))return;const j=()=>v(h==="24h"?bb(w.username):Js(w.username));j();const f=()=>j();return window.addEventListener("ndn:stats-updated",f),()=>window.removeEventListener("ndn:stats-updated",f)},[w==null?void 0:w.username,h]),m.useEffect(()=>{const j=()=>{const B=window.innerWidth,ee=window.matchMedia("(max-width: 768px)").matches,Y=window.matchMedia("(max-width: 1024px) and (min-width: 769px)").matches,$=/Mobi|Android|iPhone|iPad|iPod|Mobile|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent||""),Q=/iPad|Android(?=.*\bMobile\b)|Tablet|PlayBook|Silk/i.test(navigator.userAgent||""),D="ontouchstart"in window||navigator.maxTouchPoints>0,z=B<769,de=Y&&D||Q||B>=769&&B<=1024&&D,G=ee||$||z||B<769&&D||de;S(G)};j(),window.addEventListener("resize",j),window.addEventListener("orientationchange",j);const f=window.matchMedia("(max-width: 768px)"),R=window.matchMedia("(max-width: 1024px) and (min-width: 769px)");try{f.addEventListener("change",j),R.addEventListener("change",j)}catch{}return()=>{window.removeEventListener("resize",j),window.removeEventListener("orientationchange",j);try{f.removeEventListener("change",j),R.removeEventListener("change",j)}catch{}}},[]),m.useEffect(()=>{const j=()=>{try{localStorage.removeItem("ndn:avatar")}catch{}T(null),d("score")};return window.addEventListener("ndn:logout",j),()=>window.removeEventListener("ndn:logout",j)},[]),m.useEffect(()=>{const j=f=>{var R;try{const B=String(((R=f==null?void 0:f.detail)==null?void 0:R.username)||"").trim();if(!B)return;T(ee=>ee&&{...ee,username:B});try{const ee=((w==null?void 0:w.email)||"").toLowerCase();o&&B&&ee&&o.send({type:"presence",username:B,email:ee})}catch{}}catch{}};return window.addEventListener("ndn:username-changed",j),()=>window.removeEventListener("ndn:username-changed",j)},[o,w==null?void 0:w.email]),m.useEffect(()=>{const j=f=>{var R;try{const B=String(((R=f==null?void 0:f.detail)==null?void 0:R.tab)||"").trim();B&&["score","offline","online","stats","settings","admin","tournaments","friends"].includes(B)&&d(B)}catch{}};return window.addEventListener("ndn:change-tab",j),()=>window.removeEventListener("ndn:change-tab",j)},[]);async function b(j){try{const f=j!=null&&j.email?`?email=${encodeURIComponent(j.email)}`:"",R=await fetch("/api/subscription"+f);if(!R.ok)return;const B=await R.json();T({...j,fullAccess:!!(B!=null&&B.fullAccess)})}catch{}}if(!w)return n.jsx(aN,{onAuth:j=>{T(j),b(j)}});const C=`https://ui-avatars.com/api/?name=${encodeURIComponent(w.username||"NDN")}&background=8F43EE&color=fff&bold=true&rounded=true&size=64`;return n.jsx(oN,{children:n.jsxs("div",{ref:e,className:`${w!=null&&w.fullAccess?"premium-body":""} h-screen overflow-hidden p-1 xs:p-2 sm:p-3 md:p-4`,children:[n.jsx(nN,{}),n.jsxs("div",{className:"max-w-[1400px] mx-auto grid grid-cols-1 lg:grid-cols-[auto,1fr] gap-2 xs:gap-3 sm:gap-4 h-full overflow-hidden",children:[!x&&n.jsx("div",{className:"relative hidden lg:block",style:{width:240},children:n.jsx($p,{active:c,onChange:j=>{d(j)},user:w})}),n.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[n.jsx("div",{className:"pt-1 xs:pt-2",children:n.jsxs("header",{id:"ndn-header",className:"header glass flex-col xs:flex-col sm:flex-row gap-2 xs:gap-2 sm:gap-3",children:[n.jsx("div",{className:"flex items-center gap-2 order-1",children:n.jsx("h1",{className:"text-lg xs:text-xl sm:text-xl md:text-2xl font-bold text-brand-700 whitespace-nowrap cursor-pointer select-none",onClick:()=>{x&&d("score")},title:x?"Go Home":void 0,children:"NINE-DART-NATION "})}),n.jsxs("div",{className:"order-3 xs:order-3 sm:order-2 w-full sm:w-auto flex-1 flex flex-col items-center justify-center text-center sm:text-left !text-black",children:[n.jsxs("span",{className:"text-sm xs:text-base sm:text-base md:text-lg font-semibold flex items-center gap-2 max-w-full truncate !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:[n.jsx("span",{className:"hidden xs:inline !text-black",children:"Welcome,"}),n.jsx("img",{src:t||C,alt:"avatar",className:"w-5 h-5 xs:w-6 xs:h-6 sm:w-6 sm:h-6 md:w-7 md:h-7 rounded-full ring-2 ring-white/20"}),n.jsxs("span",{className:"truncate !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:[w.username,""]})]}),n.jsxs("span",{className:"hidden xs:inline text-xs xs:text-xs sm:text-xs md:text-sm !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:["All-time 3-dart avg: ",n.jsx("span",{className:"font-semibold !text-black",style:{color:"#000000",WebkitTextFillColor:"#000000"},children:P.toFixed(2)})]}),x&&n.jsx("button",{className:"btn px-3 py-1 xs:px-3 xs:py-1 sm:px-3 sm:py-1 mt-1 text-sm xs:text-sm","aria-label":"Open navigation",onClick:()=>N(!0),children:" Menu"})]}),n.jsxs("div",{className:"order-2 md:order-3 ml-0 md:ml-auto flex items-center gap-2 flex-wrap",children:[n.jsx("button",{className:"px-3 py-1 text-sm rounded-full bg-white/5 hover:bg-white/10 border border-white/10",onClick:()=>{const j=e.current;j&&(document.fullscreenElement?document.exitFullscreen().catch(()=>{}):j.requestFullscreen().catch(()=>{}))},title:r?"Exit Full Screen":"Enter Full Screen",children:r?"Exit Full Screen":"Full Screen"}),c==="online"&&n.jsx("button",{className:"text-[10px] md:text-xs px-3 py-1 rounded-full bg-indigo-500/25 text-indigo-100 border border-indigo-400/40 hover:bg-indigo-500/40",title:"Open a simulated online match",onClick:()=>{setTimeout(()=>{try{window.dispatchEvent(new CustomEvent("ndn:online-match-demo",{detail:{game:"X01",start:501}}))}catch{}},40)},children:"ONLINE DEMO"}),o?n.jsx("span",{className:"ml-0 md:ml-2",children:n.jsx(dN,{status:o.status})}):null,a!=null&&a.https?n.jsx("span",{className:"text-[10px] md:text-xs px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/40",title:`Phone HTTPS active on :${a.port}`,children:"HTTPS READY"}):n.jsx("span",{className:"text-[10px] md:text-xs px-3 py-1 rounded-full bg-slate-600/30 text-slate-300 border border-slate-400/30",title:"Enable HTTPS for iPhone camera pairing",children:"HTTP ONLY"})]})]})}),x&&n.jsx(NN,{open:y,onClose:()=>N(!1),active:c,onChange:j=>{d(j),N(!1)},user:w}),n.jsxs("main",{id:"ndn-main-scroll",className:"space-y-4 flex-1 overflow-y-auto pr-1",children:[c==="settings"&&n.jsx(ds,{children:n.jsx(lN,{user:w})}),c==="score"&&n.jsx(ds,{children:n.jsx(wb,{user:w})}),c==="online"&&n.jsx(ds,{children:n.jsx(fN,{user:w})}),c==="offline"&&n.jsx(ds,{children:n.jsx(q1,{user:w})}),c==="calibrate"&&n.jsx(ds,{children:n.jsx(D1,{})}),c==="friends"&&n.jsx(ds,{children:n.jsx(tN,{user:w})}),c==="stats"&&n.jsx(ds,{children:n.jsx(pN,{user:w})}),c==="tournaments"&&n.jsx(ds,{children:n.jsx(xN,{user:w})}),c==="admin"&&n.jsx(ds,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx(rN,{user:w}),n.jsx(vN,{user:w})]})}),c==="fullaccess"&&n.jsx(ds,{children:n.jsx(gN,{user:w})})]})]})]})]})})}function NN({open:e,onClose:t,active:s,onChange:r,user:l}){return n.jsx(yN,{open:e,onClose:t,width:320,side:"left",title:"Navigate",children:n.jsx("div",{className:"mt-2",children:n.jsx($p,{active:s,onChange:r,user:l,className:"flex relative static max-h-[80vh] w-full"})})})}function wN(e){return e.length>=10&&/\d/.test(e)&&/[^A-Za-z0-9]/.test(e)}function jN(){const[e,t]=m.useState(""),[s,r]=m.useState(""),[l,a]=m.useState(""),[i,o]=m.useState(""),[c,d]=m.useState("");m.useEffect(()=>{try{const y=new URLSearchParams(window.location.search).get("token")||"";t(y)}catch{}},[]);async function x(S){if(S.preventDefault(),o(""),d(""),!e){o("Missing or invalid reset token.");return}if(!s||s!==l){o("Passwords do not match.");return}if(!wN(s)){o("Password must be at least 10 chars and include a number and symbol.");return}try{const N=await(await fetch("/api/auth/confirm-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,newPassword:s})})).json();if(!(N!=null&&N.ok))throw new Error((N==null?void 0:N.error)||"Reset failed");d("Password changed. You can now sign in.")}catch(y){o((y==null?void 0:y.message)||"Reset failed")}}return n.jsxs("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[n.jsx("div",{className:"background-animated"}),n.jsx("div",{className:"relative z-10 w-full max-w-lg mx-auto p-4",children:n.jsxs("form",{className:"card w-full space-y-4",onSubmit:x,children:[n.jsx("div",{className:"flex flex-col items-center justify-center gap-2 mb-2 text-center",children:n.jsx("h1",{className:"logo text-center",children:"Reset your password"})}),!e&&n.jsx("div",{className:"text-red-400",children:"This reset link is missing a token. Please use the link from your email."}),n.jsx("input",{className:"input w-full",type:"password",placeholder:"New password",value:s,onChange:S=>r(S.target.value),required:!0}),n.jsx("input",{className:"input w-full",type:"password",placeholder:"Confirm password",value:l,onChange:S=>a(S.target.value),required:!0}),i&&n.jsx("div",{className:"text-red-400 font-semibold text-sm",children:i}),c&&n.jsx("div",{className:"text-emerald-400 font-semibold text-sm",children:c}),n.jsx("button",{className:"btn w-full",type:"submit",disabled:!e,children:"Change Password"}),n.jsx("a",{className:"underline text-sm text-center",href:"/",children:"Back to sign in"})]})})]})}class SN extends m.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,message:String((t==null?void 0:t.message)||t)}}componentDidCatch(t,s){console.error("[ErrorBoundary]",t,s)}render(){return this.state.hasError?n.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:n.jsxs("div",{className:"card max-w-lg w-full text-center",children:[n.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Something went wrong"}),n.jsx("p",{className:"opacity-80 mb-4",children:"Please refresh the page. If this persists, let us know."}),this.state.message&&n.jsx("pre",{className:"text-xs bg-black/40 rounded p-2 overflow-auto text-left",children:this.state.message}),n.jsx("button",{className:"btn mt-4",onClick:()=>window.location.reload(),children:"Reload"})]})}):this.props.children}}try{window.React=window.React||{}}catch{}ed.createRoot(document.getElementById("root")).render(n.jsx(m.StrictMode,{children:n.jsx(SN,{children:n.jsx(cN,{children:n.jsx(kN,{})})})}));function kN(){return window.location.pathname==="/reset"?n.jsx(jN,{}):n.jsx(bN,{})}
//# sourceMappingURL=index-DTm0WGve.js.map
