import{u as q,a as M,g as X,b as K,c as he,d as ue,j as e,e as ge,s as I,f as pe,h as be}from"./index-ALD5k1ur.js";import{r as a,b as J,C as fe,e as Y,o as Z,f as ve,j as we,p as je,q as Ne,s as ye,Z as ke,t as Ce,u as Se,T as Pe,v as Ee,w as Te,x as Ae,a as De,S as Oe,y as Ue,z as Ie,D as Re,F as Fe,h as Le,A as $e,m as Me}from"./ui-Cl5S-Tv0.js";import{f as k}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const R=({id:s,title:C,icon:S,children:E,color:b="indigo",isOpen:f,onToggle:r})=>{const v={indigo:"border-indigo-500/40 bg-indigo-500/10 text-indigo-100",green:"border-green-500/40 bg-green-500/10 text-green-100",yellow:"border-yellow-500/40 bg-yellow-500/10 text-yellow-100",blue:"border-blue-500/40 bg-blue-500/10 text-blue-100",purple:"border-purple-500/40 bg-purple-500/10 text-purple-100",orange:"border-orange-500/40 bg-orange-500/10 text-orange-100",red:"border-red-500/40 bg-red-500/10 text-red-100",cyan:"border-cyan-500/40 bg-cyan-500/10 text-cyan-100"};return e.jsxs("div",{className:`rounded-xl border ${v[b]} overflow-hidden`,children:[e.jsxs("button",{type:"button",onClick:()=>r(s),className:"w-full p-4 flex items-center justify-between hover:bg-white/5 active:bg-white/10 transition-colors cursor-pointer select-none text-left",children:[e.jsxs("div",{className:"flex items-center gap-3 font-semibold",children:[e.jsx(S,{className:"w-5 h-5"}),C]}),e.jsx("div",{children:f?e.jsx(Fe,{className:"w-5 h-5"}):e.jsx(Le,{className:"w-5 h-5"})})]}),f&&e.jsx("div",{className:"p-4 pt-0 border-t border-white/10",children:E})]})};function Be({user:s,onClose:C}){const[S,E]=a.useState([]),[b,f]=a.useState(!1),[r,v]=a.useState(""),[u,P]=a.useState(""),[m,F]=a.useState(""),[g,o]=a.useState(""),[i,h]=a.useState(""),[c,d]=a.useState(null),[w,T]=a.useState([{key:"first180",label:"First 180",unlocked:!1,icon:"ðŸ”¥",desc:"Score 180 in a match."},{key:"hundredGames",label:"100 Games",unlocked:!1,icon:"ðŸ†",desc:"Play 100 games."},{key:"tournamentWin",label:"Tournament Winner",unlocked:!1,icon:"ðŸ¥‡",desc:"Win a tournament."},{key:"bestLeg",label:"Best Leg",unlocked:!1,icon:"âš¡",desc:"Finish a leg in 12 darts or less."},{key:"comeback",label:"Comeback",unlocked:!1,icon:"ðŸ”¥",desc:"Win after trailing by 3 legs."},{key:"perfectGame",label:"Perfect Game",unlocked:!1,icon:"ðŸ’Ž",desc:"Win a match without missing a double."},{key:"streakMaster",label:"Streak Master",unlocked:!1,icon:"ðŸŒŸ",desc:"Win 5 matches in a row."},{key:"nightOwl",label:"Night Owl",unlocked:!1,icon:"ðŸ¦‰",desc:"Play a match after midnight."}]),[p,j]=a.useState(""),[A,N]=a.useState(!1),[z,V]=a.useState(""),[D,Q]=a.useState("overview"),{favoriteDouble:ee,setFavoriteDouble:te,callerEnabled:L,setCallerEnabled:se,callerVoice:ae,setCallerVoice:le,callerVolume:ie,setCallerVolume:ne,avgMode:oe,setAvgMode:re}=q(),G=a.useRef(null);a.useEffect(()=>{if(typeof window>"u"||!window.speechSynthesis)return;const t=window.speechSynthesis,l=()=>{try{const n=t.getVoices();E(n.filter(x=>(x.lang||"").toLowerCase().startsWith("en")))}catch{}};return l(),t.addEventListener?.("voiceschanged",l),()=>t.removeEventListener?.("voiceschanged",l)},[]);const ce=t=>{const l=t.target.files?.[0];if(!l)return;if(l.size>2*1024*1024){alert("Image size too large. Please choose an image under 2MB.");return}const n=new FileReader;n.onloadend=()=>{const x=n.result;h(x);const U=s?.username||"";U&&(localStorage.setItem(`ndn:bio:profilePhoto:${U}`,x),window.dispatchEvent(new CustomEvent("ndn:avatar-updated",{detail:{username:U,avatar:x}})),M("/api/user/avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar:x})}).catch(()=>{}))},n.readAsDataURL(l)};a.useEffect(()=>{const t=s?.username||"";if(t)try{v(localStorage.getItem(`ndn:bio:favPlayer:${t}`)||""),P(localStorage.getItem(`ndn:bio:favTeam:${t}`)||""),F(localStorage.getItem(`ndn:bio:favDarts:${t}`)||""),o(localStorage.getItem(`ndn:bio:bio:${t}`)||""),h(localStorage.getItem(`ndn:bio:profilePhoto:${t}`)||"")}catch{}},[s?.username]),a.useEffect(()=>{const t=s?.username||"";t&&T(l=>l.map(n=>({...n,unlocked:!!localStorage.getItem(`ndn:achieve:${n.key}:${t}`)})))},[s?.username]),a.useEffect(()=>{s?.email&&M(`/api/subscription?email=${encodeURIComponent(s.email)}`).then(t=>t.json()).then(d).catch(()=>{})},[s?.email]);const de=()=>{const t=s?.username||"";if(t)try{localStorage.setItem(`ndn:bio:favPlayer:${t}`,r),localStorage.setItem(`ndn:bio:favTeam:${t}`,u),localStorage.setItem(`ndn:bio:favDarts:${t}`,m),localStorage.setItem(`ndn:bio:bio:${t}`,g),localStorage.setItem(`ndn:bio:profilePhoto:${t}`,i),window.dispatchEvent(new CustomEvent("ndn:avatar-updated",{detail:{username:t,avatar:i}})),i&&M("/api/user/avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar:i})}).catch(()=>{}),f(!1)}catch{}},$=s?.username||"Player 1",y=X($),W=K($),me=he($),_=ue($),H=Object.values(_).reduce((t,l)=>t+(l.played||0),0),xe=Object.values(_).reduce((t,l)=>t+(l.won||0),0),O=t=>{Q(l=>l===t?null:t)};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 p-4",children:[e.jsxs("div",{className:"relative rounded-2xl bg-gradient-to-br from-indigo-600/30 to-purple-600/30 border border-white/20 p-6 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500/10 to-purple-500/10"}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row items-center gap-6",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center overflow-hidden border-4 border-white/20 shadow-xl relative",children:[i?e.jsx("img",{src:i,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx(J,{className:"w-12 h-12 sm:w-16 sm:h-16 text-white/80"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center cursor-pointer",onClick:()=>G.current?.click(),children:e.jsx(fe,{className:"w-8 h-8 text-white/80"})})]}),e.jsx("button",{className:"absolute bottom-0 right-0 bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-full shadow-lg border-2 border-slate-900 z-10 transition-transform hover:scale-110",onClick:()=>G.current?.click(),title:"Change Profile Photo",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("input",{type:"file",ref:G,className:"hidden",accept:"image/*",onChange:ce}),c?.status==="active"&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full p-1.5 shadow-lg z-20",children:e.jsx(Z,{className:"w-4 h-4 text-white"})})]}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white mb-1",children:s?.username||"Guest"}),e.jsx("p",{className:"text-white/60 text-sm mb-3",children:s?.email||""}),e.jsxs("div",{className:"flex flex-wrap justify-center sm:justify-start gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:k(W)}),e.jsx("div",{className:"text-xs text-white/60",children:"All-Time Avg"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:H}),e.jsx("div",{className:"text-xs text-white/60",children:"Games"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:y.num180s||0}),e.jsx("div",{className:"text-xs text-white/60",children:"180s"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:y.bestCheckout||0}),e.jsx("div",{className:"text-xs text-white/60",children:"High CO"})]})]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:c?.status==="active"?e.jsxs("span",{className:"px-3 py-1 rounded-full bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-sm font-semibold flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"})," Premium"]}):e.jsx("button",{onClick:()=>{window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:"premium"}}))},className:"px-3 py-1 rounded-full bg-gradient-to-r from-gray-600 to-gray-700 text-white text-sm font-semibold hover:from-yellow-500 hover:to-orange-500 transition-all",children:"Upgrade to Premium"})})]})]}),e.jsx(R,{id:"overview",title:"Profile Overview",icon:J,color:"indigo",isOpen:D==="overview",onToggle:O,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Edit Profile"}),b?e.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-3 py-1.5 bg-green-500/20 hover:bg-green-500/30 rounded-lg text-green-400 text-sm transition-colors",children:[e.jsx(ve,{className:"w-4 h-4"})," Save"]}):e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-400 text-sm transition-colors",children:[e.jsx(Y,{className:"w-4 h-4"})," Edit"]})]}),b?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Favourite Player"}),e.jsx("input",{className:"input w-full",value:r,onChange:t=>v(t.target.value),placeholder:"e.g., Michael van Gerwen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Favourite Team"}),e.jsx("input",{className:"input w-full",value:u,onChange:t=>P(t.target.value),placeholder:"e.g., Netherlands"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Favourite Darts"}),e.jsx("input",{className:"input w-full",value:m,onChange:t=>F(t.target.value),placeholder:"e.g., Target Bolide 22g"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Profile Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>{const l=t.target.files?.[0];if(l){const n=new FileReader;n.onload=()=>h(n.result),n.readAsDataURL(l)}},className:"text-xs text-slate-100"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Bio"}),e.jsx("textarea",{className:"input w-full h-20 resize-none",value:g,onChange:t=>o(t.target.value),placeholder:"Tell us about yourself..."})]})]}):e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[r&&e.jsxs("div",{children:[e.jsx("div",{className:"text-white/60 text-xs",children:"Favourite Player"}),e.jsx("div",{className:"font-medium",children:r})]}),u&&e.jsxs("div",{children:[e.jsx("div",{className:"text-white/60 text-xs",children:"Favourite Team"}),e.jsx("div",{className:"font-medium",children:u})]}),m&&e.jsxs("div",{children:[e.jsx("div",{className:"text-white/60 text-xs",children:"Favourite Darts"}),e.jsx("div",{className:"font-medium",children:m})]}),g&&e.jsxs("div",{className:"col-span-2 sm:col-span-4",children:[e.jsx("div",{className:"text-white/60 text-xs",children:"Bio"}),e.jsx("div",{className:"font-medium",children:g})]}),!r&&!u&&!m&&!g&&e.jsx("div",{className:"col-span-4 text-white/40 text-center py-4",children:"Click Edit to add your profile info"})]})]})}),e.jsxs(R,{id:"stats",title:"My Statistics",icon:we,color:"blue",isOpen:D==="stats",onToggle:O,children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(je,{className:"w-6 h-6 mx-auto mb-1 text-blue-400"}),e.jsx("div",{className:"text-lg font-bold",children:k(W)}),e.jsx("div",{className:"text-xs text-white/60",children:"All-Time Average"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(Ne,{className:"w-6 h-6 mx-auto mb-1 text-green-400"}),e.jsx("div",{className:"text-lg font-bold",children:k(me)}),e.jsx("div",{className:"text-xs text-white/60",children:"Rolling Average"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(ye,{className:"w-6 h-6 mx-auto mb-1 text-purple-400"}),e.jsx("div",{className:"text-lg font-bold",children:H}),e.jsx("div",{className:"text-xs text-white/60",children:"Games Played"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(ke,{className:"w-6 h-6 mx-auto mb-1 text-yellow-400"}),e.jsx("div",{className:"text-lg font-bold",children:y.num180s||0}),e.jsx("div",{className:"text-xs text-white/60",children:"180s Hit"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(Ce,{className:"w-6 h-6 mx-auto mb-1 text-orange-400"}),e.jsx("div",{className:"text-lg font-bold",children:y.bestCheckout||0}),e.jsx("div",{className:"text-xs text-white/60",children:"Highest Checkout"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(Se,{className:"w-6 h-6 mx-auto mb-1 text-cyan-400"}),e.jsx("div",{className:"text-lg font-bold",children:y.best3?.toFixed(1)||0}),e.jsx("div",{className:"text-xs text-white/60",children:"Best 3-Dart Avg"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(Pe,{className:"w-6 h-6 mx-auto mb-1 text-amber-400"}),e.jsx("div",{className:"text-lg font-bold",children:xe}),e.jsx("div",{className:"text-xs text-white/60",children:"Wins"})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[e.jsx(Ee,{className:"w-6 h-6 mx-auto mb-1 text-rose-400"}),e.jsx("div",{className:"text-lg font-bold",children:y.bestLegDarts||"-"}),e.jsx("div",{className:"text-xs text-white/60",children:"Best Leg (darts)"})]})]}),e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:"stats"}})),className:"mt-4 w-full py-2 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-400 text-sm transition-colors",children:"View Detailed Statistics â†’"})]}),e.jsx(R,{id:"achievements",title:"Achievements & Badges",icon:Te,color:"yellow",isOpen:D==="achievements",onToggle:O,children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:w.map(t=>e.jsxs("div",{className:`relative rounded-lg p-3 text-center transition-all ${t.unlocked?"bg-gradient-to-br from-yellow-500/20 to-orange-500/20 border border-yellow-500/40":"bg-white/5 border border-white/10 opacity-50"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:t.icon}),e.jsx("div",{className:"text-xs font-semibold",children:t.label}),e.jsx("div",{className:"text-[10px] text-white/60 mt-1",children:t.desc}),t.unlocked&&e.jsx("div",{className:"absolute top-1 right-1 text-green-400",children:e.jsx(Ae,{className:"w-3 h-3"})}),!t.unlocked&&e.jsx("div",{className:"absolute top-1 right-1 text-white/30",children:e.jsx(De,{className:"w-3 h-3"})})]},t.key))})}),e.jsx(R,{id:"preferences",title:"Game Preferences",icon:Oe,color:"purple",isOpen:D==="preferences",onToggle:O,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm",children:"Favourite Double"}),e.jsxs("select",{className:"input w-32",value:ee??"",onChange:t=>te(t.target.value),children:[e.jsx("option",{value:"",children:"None"}),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20].map(t=>e.jsxs("option",{value:String(t),children:["D",t]},t))]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm",children:"Average Display"}),e.jsxs("select",{className:"input w-40",value:oe,onChange:t=>re(t.target.value),children:[e.jsx("option",{value:"3-dart",children:"3-Dart Average"}),e.jsx("option",{value:"per-dart",children:"Per-Dart Average"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm",children:"Voice Caller"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:L,onChange:t=>se(t.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-xs text-white/60",children:L?"On":"Off"})]})]}),L&&e.jsxs("div",{className:"flex items-center justify-between pl-4",children:[e.jsx("label",{className:"text-sm text-white/60",children:"Volume"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:ie,onChange:t=>ne(Number(t.target.value)),className:"w-32"})]}),L&&e.jsxs("div",{className:"flex items-center justify-between pl-4 gap-3",children:[e.jsx("label",{className:"text-sm text-white/60",children:"Voice"}),e.jsxs("select",{className:"input flex-1 text-sm",value:ae||"",onChange:t=>le(t.target.value),children:[e.jsx("option",{value:"",children:"Default"}),S.map(t=>e.jsx("option",{value:t.voiceURI,children:t.name},t.voiceURI))]})]})]})}),e.jsx(R,{id:"account",title:"Account & Subscription",icon:Ue,color:"green",isOpen:D==="account",onToggle:O,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Subscription Status"}),e.jsx("div",{className:`text-sm ${c?.status==="active"?"text-green-400":"text-white/60"}`,children:c?.status==="active"?"Premium Active":"Free Plan"})]}),c?.status!=="active"&&e.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:"premium"}})),className:"px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg text-sm font-semibold hover:opacity-90 transition-opacity",children:"Upgrade"})]}),e.jsxs("div",{className:"p-3 bg-white/5 rounded-lg",children:[e.jsxs("div",{className:"font-medium mb-2",children:["Change Username",e.jsxs("span",{className:"text-xs text-white/60 ml-2",children:["(",s?.usernameChangeCount||0,"/2 free changes used)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"input flex-1",placeholder:"New username",value:p,onChange:t=>j(t.target.value),disabled:A}),e.jsx("button",{onClick:async()=>{if(p.trim()){N(!0),V("");try{const t=localStorage.getItem("authToken"),l=await M("/api/user/change-username",{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({email:s?.email,newUsername:p.trim()})});if(!l.ok){const n=await l.json();throw new Error(n.error||"Failed to change username")}j(""),window.location.reload()}catch(t){V(t.message)}finally{N(!1)}}},disabled:A||!p.trim(),className:"btn bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:A?"...":"Change"})]}),z&&e.jsx("div",{className:"text-red-400 text-xs mt-1",children:z})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("ndn:logout")),className:"flex-1 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"})," Logout"]}),e.jsxs("button",{onClick:()=>{const t={username:s?.username,stats:y,achievements:w.filter(U=>U.unlocked),bio:{favPlayer:r,favTeam:u,favDarts:m,bio:g},exportedAt:new Date().toISOString()},l=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(l),x=document.createElement("a");x.href=n,x.download=`ndn-profile-${s?.username||"guest"}.json`,x.click(),URL.revokeObjectURL(n)},className:"flex-1 py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"})," Export Data"]})]})]})}),C&&e.jsx("button",{onClick:C,className:"w-full py-3 bg-white/10 hover:bg-white/20 rounded-xl text-white font-medium transition-colors",children:"Close"})]})}function B(s){try{window.dispatchEvent(new CustomEvent("ndn:change-tab",{detail:{tab:s}}))}catch{}}const Ge=be();function He({user:s}){const[C,S]=a.useState(!1),[E,b]=a.useState(!1),[f,r]=a.useState(!1),[v,u]=a.useState(""),{lastOffline:P}=q(),m=ge(),[,F]=a.useState(0);a.useEffect(()=>{const o=()=>F(i=>i+1);return window.addEventListener("ndn:stats-updated",o),()=>window.removeEventListener("ndn:stats-updated",o)},[]);const g=()=>{pe()};return a.useEffect(()=>{const o=()=>r(!0);return window.addEventListener("ndn:open-profile",o),()=>window.removeEventListener("ndn:open-profile",o)},[]),a.useEffect(()=>{const o=["The fastest televised 9-darter took roughly 25 seconds!","A perfect leg (501) can be finished in nine darts.","Standard dartboards are made from compressed sisal fibers.","Doubles and trebles are the thin outer and middle rings.","Professional oche (throw line) distance is 7 ft 9Â¼ in (2.37 m).","â€œDartitisâ€ is a real condition affecting a playerâ€™s throwing motion.","Phil Taylor holds a record number of World Championship titles.","Checkout routes often end on a doubleâ€”classic â€œdouble-outâ€.","The highest 3-dart score is 180 (triple 20, triple 20, triple 20)."],i=Math.floor(Math.random()*o.length);u(o[i])},[]),e.jsxs("div",{className:`${s?.fullAccess?"premium-main":""} home-shell relative min-h-screen flex flex-col items-center justify-start overflow-hidden px-4 pb-20`,children:[e.jsxs("div",{className:"home-background","aria-hidden":!0,children:[e.jsx("div",{className:"home-background__gradient"}),e.jsx("div",{className:"home-background__pulse home-background__pulse--one"}),e.jsx("div",{className:"home-background__pulse home-background__pulse--two"})]}),e.jsxs("div",{className:"home-content relative z-10 w-full max-w-6xl mx-auto bg-white/10 backdrop-blur-lg rounded-2xl sm:rounded-3xl shadow-2xl p-4 sm:p-6 md:p-8 lg:p-10 flex flex-col",children:[e.jsxs("div",{className:"home-intro space-y-3 text-center flex flex-col items-center",children:[e.jsxs("div",{className:"home-brand-row flex w-full items-center justify-center gap-3 text-xs sm:text-sm uppercase tracking-[0.25em] text-white/80 font-semibold flex-wrap",children:[e.jsx("span",{className:"home-brand-tag",children:"Nine Dart Nation ðŸŽ¯"}),e.jsx("button",{onClick:g,className:"home-menu-button btn px-4 py-2 text-sm rounded-full bg-amber-400 text-slate-900 font-bold transition hover:scale-105 active:scale-95",children:"Notifications ðŸ””"})]}),e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 via-purple-400 to-blue-400 drop-shadow-xl leading-tight px-2",children:"Welcome to Nine Dart Nation ðŸŽ¯"}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl text-white/80 font-semibold px-2",children:"Your home for competitive darts, stats, and online play."}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-white/60 italic px-2",children:'"Where every dart counts and every player matters."'})]}),(()=>{const o=s?.username||"Player 1",i=K(o),h=`ndn:allTimeAvgSnapshot:${o}`;let c=0;try{const w=localStorage.getItem(h);if(w){const T=JSON.parse(w),p=Number(T?.value)||0;c=i-p,Number.isFinite(c)||(c=0)}}catch{}const d=Math.abs(c)>=.05?c:0;return i>0?e.jsx("div",{className:"w-full my-4 sm:my-6 px-2 sm:px-0",children:e.jsx("div",{className:"mx-auto max-w-full sm:max-w-sm rounded-2xl px-5 py-4 bg-white/10 border border-white/15 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase tracking-[0.25em] text-white/50 font-semibold mb-1",children:"All-Time 3-Dart Avg"}),e.jsx("div",{className:"text-3xl font-black text-white tracking-tight",children:i.toFixed(1)})]}),d!==0&&e.jsxs("div",{className:`flex items-center gap-1 text-sm font-semibold ${d>0?"text-emerald-300":"text-rose-300"}`,children:[d>0?e.jsx($e,{className:"w-5 h-5"}):e.jsx(Me,{className:"w-5 h-5"}),d>0?"+":"",d.toFixed(1)]})]})})}):null})(),v&&e.jsx("div",{className:"w-full my-4 sm:my-6 px-2 sm:px-0",children:e.jsxs("div",{className:"mx-auto max-w-full sm:max-w-xl rounded-full px-4 sm:px-5 py-3 text-center text-indigo-100 bg-gradient-to-r from-indigo-600/80 to-fuchsia-600/80 shadow-md",children:[e.jsx("span",{className:"font-semibold text-sm sm:text-base block sm:inline",children:"Did you know? ðŸ’¡"})," ",e.jsx("span",{className:"opacity-90 text-sm sm:text-base block sm:inline mt-1 sm:mt-0",children:v})]})}),e.jsxs("div",{className:"w-full max-w-4xl mx-auto mb-6 sm:mb-8",children:[e.jsxs("div",{className:"home-actions-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 sm:gap-4",children:[e.jsxs("button",{onClick:()=>{B("offline");try{window.dispatchEvent(new CustomEvent("ndn:offline-format",{detail:{formatType:"first",formatCount:Number(P?.firstTo)||1,startScore:Number(P?.x01Start)||501}}))}catch{}try{setTimeout(()=>{window.dispatchEvent(new CustomEvent("ndn:auto-start",{detail:{mode:P?.mode||"X01"}}))},50)}catch{}},className:"w-full px-5 py-4 rounded-2xl bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg touch-manipulation",children:[e.jsx("span",{"aria-hidden":!0,children:I("target")}),e.jsx("span",{children:"Start New Match âš”ï¸"})]}),e.jsxs("button",{onClick:()=>B("stats"),className:"w-full px-5 py-4 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg touch-manipulation",children:[e.jsx("span",{"aria-hidden":!0,children:I("info")}),e.jsx("span",{children:"View Stats ðŸ“Š"})]}),e.jsxs("button",{onClick:()=>B("online"),className:"w-full px-5 py-4 rounded-2xl bg-gradient-to-r from-green-500 to-blue-400 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg touch-manipulation",children:[e.jsx("span",{"aria-hidden":!0,children:I("ok")}),e.jsx("span",{children:"Join Online Match ðŸŽ¯"})]}),e.jsxs("button",{onClick:()=>r(!0),className:"w-full px-5 py-4 rounded-2xl bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg touch-manipulation",children:[e.jsx("span",{"aria-hidden":!0,children:I("bullet")}),e.jsx("span",{children:"Profile ðŸ‘¤"})]}),e.jsxs("button",{onClick:()=>{B("offline");try{window.dispatchEvent(new CustomEvent("ndn:auto-start",{detail:{mode:"Double Practice"}}))}catch{}},className:"w-full px-5 py-4 rounded-2xl bg-gradient-to-r from-pink-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-105 active:scale-95 transition-transform duration-150 flex items-center justify-center gap-2 text-base sm:text-lg touch-manipulation",children:[e.jsx("span",{"aria-hidden":!0,children:I("dash")}),e.jsx("span",{children:"Practice Doubles ðŸŽ¯"})]})]}),e.jsx("p",{className:"mt-3 text-center text-xs sm:text-sm text-white/60",children:"Tip: rotate your phone for more room â€” the buttons auto-reflow."})]}),(()=>{const o=s?.username||"Player 1",i=X(o),h=!!s?.fullAccess,c="grid grid-cols-[120px,1fr,1fr] sm:grid-cols-[160px,1fr,1fr]",d=({label:w,left:T,right:p,lock:j})=>e.jsxs("div",{className:`relative ${c} gap-2 items-center p-2 rounded-lg ${j?"bg-white/5 border border-white/10 overflow-hidden":"bg-indigo-500/10 border border-indigo-500/40"} mb-2`,children:[e.jsx("div",{className:"text-[12px] opacity-80 pl-2 text-left",children:w}),e.jsx("div",{className:`text-sm font-semibold text-center ${j?"opacity-50 blur-[0.5px]":""}`,children:T}),e.jsx("div",{className:`text-sm font-semibold text-center ${j?"opacity-50 blur-[0.5px]":""}`,children:p}),j&&e.jsx("button",{className:"absolute inset-0 flex items-center justify-center rounded-lg bg-slate-900/35 hover:bg-slate-900/45 transition",onClick:async()=>{try{const N=await(await fetch(`${Ge}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.email})})).json();N.ok&&N.url?window.location.href=N.url:N.error==="STRIPE_NOT_CONFIGURED"?m("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):m("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{m("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},title:"Unlock with PREMIUM",children:e.jsx("span",{className:"text-[12px] font-semibold",children:"Unlock PREMIUM âœ¨"})})]});return e.jsxs("div",{className:"w-full mt-2 rounded-2xl p-2 sm:p-3 bg-white/5 border border-white/10 overflow-x-auto",children:[e.jsxs("div",{className:`${c} gap-2 mb-2 px-1 items-center min-w-[280px] sm:min-w-0`,children:[e.jsx("div",{className:"text-[12px] opacity-0 select-none",children:"label"}),e.jsx("div",{className:"text-[12px] font-semibold text-center",children:"BEST"}),e.jsx("div",{className:"text-[12px] font-semibold text-center",children:"WORST"})]}),e.jsx(d,{label:"3-dart avg",left:k(i.best3||0),right:k(i.worst3||0)}),e.jsx(d,{label:"9-dart avg",left:k(i.bestFNAvg||0),right:k(i.worstFNAvg||0),lock:!h}),e.jsx(d,{label:"Leg (darts)",left:String(i.bestLegDarts||0),right:String(i.worstLegDarts||0),lock:!h}),e.jsx(d,{label:"Checkout",left:String(i.bestCheckout||0),right:"â€”",lock:!h})]})})(),e.jsx("button",{className:"mt-5 sm:mt-8 md:mt-10 px-6 sm:px-8 md:px-10 py-3 md:py-4 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold shadow-xl hover:scale-[1.02] active:scale-[0.98] transition-transform duration-150 text-base sm:text-lg md:text-xl touch-manipulation",onClick:()=>b(!0),children:"How to Play / Getting Started ðŸ“–"})]}),e.jsx("footer",{className:"w-full py-2 md:py-2 text-center text-white/80 text-xs md:text-sm font-medium absolute left-0 z-20 flex items-center justify-center gap-1 md:gap-2",style:{bottom:"calc(var(--ndn-bottomnav-h, 0px) + env(safe-area-inset-bottom, 0px))"},children:e.jsxs("button",{className:"flex items-center gap-1 md:gap-2 hover:text-white transition",onClick:()=>S(!0),children:[e.jsx("span",{children:"Â©"}),e.jsx("span",{style:{letterSpacing:"0.05em"},children:"NINEDARTNATION ðŸŽ¯"})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>S(!1),children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Legal Information âš–ï¸"}),e.jsxs("ul",{className:"list-disc pl-5 mb-2",children:[e.jsx("li",{children:"Terms & Conditions: All users must follow fair play and site rules."}),e.jsx("li",{children:"Privacy Policy: Your data is protected and never shared without consent."}),e.jsxs("li",{children:["Copyright Â© ",new Date().getFullYear()," NINEDARTNATION ðŸŽ¯. All rights reserved."]}),e.jsx("li",{children:"Contact: support@ninedartnation.com"})]}),e.jsx("p",{className:"text-sm text-purple-200",children:"For full legal details, please contact us or visit our legal page."})]})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative text-left bg-[#2d2250] text-white p-6 rounded-xl shadow-xl",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1 bg-purple-500 text-white font-bold",onClick:()=>b(!1),children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Getting Started ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 mb-2",children:[e.jsx("li",{children:"Choose a game mode and invite friends or play solo."}),e.jsx("li",{children:"Track your stats and progress in the Stats tab."}),e.jsx("li",{children:"Join the Bullseye Darts League for online competition."}),e.jsx("li",{children:"Upgrade to PREMIUM for advanced features and modes."}),e.jsx("li",{children:"Need help? Visit the Settings tab for support and tips."})]}),e.jsx("p",{className:"text-sm text-purple-200",children:'Ready to play? Hit "Start New Match" and let the darts fly! ðŸš€'})]})}),f&&e.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[e.jsx("button",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm","aria-label":"Close profile",onClick:()=>r(!1)}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-0 sm:p-4",children:e.jsxs("div",{className:"relative w-full h-full sm:h-auto sm:max-w-4xl bg-gradient-to-br from-slate-900 to-slate-800 sm:rounded-2xl shadow-2xl border-0 sm:border border-white/10 sm:max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{className:"sticky top-3 float-right mr-3 z-10 w-10 h-10 flex items-center justify-center rounded-full bg-rose-600 hover:bg-rose-700 text-white transition-colors","aria-label":"Close",onClick:()=>r(!1),children:"âœ•"}),e.jsx(Be,{user:s,onClose:()=>r(!1)})]})})]})]})}export{He as default};
//# sourceMappingURL=Home-aQbhbdrl.js.map
