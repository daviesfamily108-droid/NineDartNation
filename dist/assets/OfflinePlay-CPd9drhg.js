import{j as e,i as gt,r as br,b as al,u as il,k as ll,e as ol,l as cl,m as Xs,n as Yt,o as dr,p as Ys,M as dl,q as ur,t as si,R as bt,P as ni,C as E,G as pt,v as ul,w as ml,h as xl,x as hl,y as fl}from"./index-C1EyKbkA.js";import{r}from"./ui-DygUIHRq.js";import{S as bl}from"./ScoreNumberPad-D0oQ_td5.js";import{f as pl}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const vt=[...Array.from({length:20},(n,i)=>({label:`D${i+1}`,score:(i+1)*2})),{label:"DBULL",score:50,isBull:!0}];function ri(n,i){const o=vt[i];return!!o&&n===o.score}function qt(n){const i=n.trim().toUpperCase();if(!i)return null;if(i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL")return 50;if(i==="25"||i==="OBULL")return 25;const o=i.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!o)return null;const x=o[1]||"S",c=parseInt(o[2],10);return c<1||c>20?null:c*(x==="S"?1:x==="D"?2:3)}const ce=[...Array.from({length:20},(n,i)=>i+1),25,50],Nr=[20,19,18,17,16,15,25];function mr(){const n={};return Nr.forEach(i=>{n[i]=0}),{marks:n,points:0}}function gl(n,i,o,x,c=()=>!1){let m=null,b=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)m=25,b=o==="INNER_BULL"||i===50?2:1;else if(typeof x=="number"&&x>=15&&x<=20)m=x,o==="TRIPLE"?b=3:o==="DOUBLE"?b=2:b=1;else if(i){const U=[20,19,18,17,16,15];for(const O of U){if(i===O){m=O,b=1;break}if(i===O*2){m=O,b=2;break}if(i===O*3){m=O,b=3;break}}!m&&(i===25||i===50)&&(m=25,b=i===50?2:1)}if(!m)return 0;const B=n.marks[m],ye=Math.max(0,3-B),K=Math.min(ye,b),v=Math.max(0,b-K),te=B+K;n.marks[m]=te>3?3:te;let H=0;return v>0&&!c(m)&&(m===25?o==="INNER_BULL"?H+=50*v:H+=25*v:H+=m*v),n.points+=H,H}function vl(n){return Nr.every(i=>(n.marks[i]||0)>=3)}function xr(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function jl(n){return n.round}function Nl(n,i,o,x){if(n.finished)return 0;const c=jl(n);let m=0;return typeof x=="number"&&x===c?o==="TRIPLE"?(m=c*3,n.turnHits.triples++):o==="DOUBLE"?(m=c*2,n.turnHits.doubles++):o==="SINGLE"&&(m=c*1,n.turnHits.singles++):!x&&(i===c||i===c*2||i===c*3)&&(i===c*3?(m=c*3,n.turnHits.triples++):i===c*2?(m=c*2,n.turnHits.doubles++):i===c&&(m=c,n.turnHits.singles++)),n.score+=m,m}function yl(n){if(!n.finished){if(n.turnHits.singles>0&&n.turnHits.doubles>0&&n.turnHits.triples>0){n.shanghaiAchieved=!0,n.finished=!0;return}const i=n.round+1;i>20?n.finished=!0:n.round=i}n.turnHits={singles:0,doubles:0,triples:0}}function hr(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function pr(n){return n.targets[n.stage]||null}function wl(n,i,o,x){if(n.finished)return 0;const c=pr(n);if(!c)return 0;let m=0;switch(c.kind){case"NUMBER":{typeof x=="number"&&x===c.num?o==="TRIPLE"?m=c.num*3:o==="DOUBLE"?m=c.num*2:o==="SINGLE"&&(m=c.num):!x&&(i===c.num||i===c.num*2||i===c.num*3)&&(m=i),m>0&&(n.hitThisRound=!0);break}case"DOUBLE":{(o==="DOUBLE"&&x===c.num||i===c.num*2)&&(m=c.num*2,n.hitThisRound=!0);break}case"TRIPLE":{(o==="TRIPLE"&&x===c.num||i===c.num*3)&&(m=c.num*3,n.hitThisRound=!0);break}case"BULL":{(o==="BULL"||o==="INNER_BULL"||i===25||i===50)&&(m=o==="INNER_BULL"||i===50?50:25,n.hitThisRound=!0);break}case"ANY_NUMBER":{i>0&&(m=i,n.hitThisRound=!0);break}}return n.score+=m,m}function Sl(n){n.finished||(n.hitThisRound||(n.score=Math.floor(n.score/2)),n.hitThisRound=!1,n.stage+=1,n.stage>=n.targets.length&&(n.finished=!0))}function fr(){return{round:1,score:0,target:"HIGH",finished:!1}}function kl(n,i,o,x){if(n.finished)return 0;let c=0;if(n.target==="HIGH")if(o==="INNER_BULL")c=50;else if(typeof x=="number"){const b=x*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);x>=20&&(c=b)}else i>=40&&(c=i);else if(typeof x=="number"){const b=x*(o==="TRIPLE"?3:o==="DOUBLE"?2:1);x<=10&&(c=b)}else i>0&&i<=30&&(c=i);return n.score+=c,c}function Cl(n){if(!n.finished){if(n.round+=1,n.round>10){n.finished=!0;return}n.target=n.target==="HIGH"?"LOW":"HIGH"}}function Dl(n,i=3){return{number:n,lives:i,isKiller:!1,eliminated:!1}}function Al(n){const i=Array.from({length:20},(x,c)=>c+1),o={};for(const x of n){const c=Math.floor(Math.random()*i.length),m=i.splice(c,1)[0];o[x]=m}return o}function ai(n,i,o,x){const c=i[n];if(!c||!x||!o)return{becameKiller:!1};if(!c.isKiller&&o==="DOUBLE"&&x===c.number)return c.isKiller=!0,{becameKiller:!0};if(c.isKiller&&(o==="DOUBLE"||o==="TRIPLE")){const m=Object.keys(i).find(b=>b!==n&&!i[b].eliminated&&i[b].number===x);if(m){const b=i[m],B=o==="TRIPLE"?2:1;return b.lives=Math.max(0,b.lives-B),b.lives===0&&(b.eliminated=!0),{becameKiller:!1,victimId:m,livesRemoved:B}}}return{becameKiller:!1}}function ii(n){const i=Object.entries(n).filter(([,o])=>!o.eliminated&&o.lives>0);return i.length===1?i[0][0]:null}function li(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function Ml(n,i,o,x){if(n.finished)return 0;let c=0;if(typeof x=="number"&&x===n.inning?o==="TRIPLE"?c=3:o==="DOUBLE"?c=2:c=1:!x&&(i===n.inning||i===n.inning*2||i===n.inning*3)&&(c=i===n.inning*3?3:i===n.inning*2?2:1),n.score+=c,n.dartsThisInning+=1,n.dartsThisInning>=3){const m=n.inning+1;m>9?n.finished=!0:(n.inning=m,n.dartsThisInning=0)}return c}const Tl={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function oi(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function Ll(n,i,o,x){if(n.finished)return!1;const c=Tl[n.hole];if(n.dartsThisHole+=1,typeof x=="number"&&x===c&&(o==="SINGLE"||o==="DOUBLE"||o==="TRIPLE")||!x&&(i===c||i===c*2||i===c*3)){n.strokes+=n.dartsThisHole;const b=n.hole+1;return b>18?n.finished=!0:(n.hole=b,n.dartsThisHole=0),!0}if(n.dartsThisHole>=3){n.strokes+=3;const b=n.hole+1;b>18?n.finished=!0:(n.hole=b,n.dartsThisHole=0)}return!1}const bi={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function ci(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function El(n){const i=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[o,x,c]of i)if(n[o]&&n[o]===n[x]&&n[o]===n[c])return n[o];return n.every(o=>o)?"Draw":null}function Rl(n,i,o,x,c){if(n.finished||n.board[i])return!1;const m=bi[i];let b=!1;if(m.type==="BULL"?b=x==="BULL"||x==="INNER_BULL"||o===25||o===50:m.type==="NUM"&&typeof m.num=="number"&&(typeof c=="number"&&c===m.num||!c&&(o===m.num||o===m.num*2||o===m.num*3))&&(b=!0),!b)return!1;n.board[i]=n.turn;const B=El(n.board);return B?(n.finished=!0,n.winner=B,!0):(n.turn=n.turn==="X"?"O":"X",!0)}function gr(){return{targetIndex:0,darts:0,finished:!1}}const pi=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],qs=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function Pl(n){return pi[n.targetIndex]}function Qs(n,i,o){if(n.finished)return n;const x=Pl(n);if(!(o==="SINGLE"&&i===x||o==="DOUBLE"&&i===x||o==="TRIPLE"&&i===x||o==="INNER_BULL"&&x===25))return n;const m=n.targetIndex+1,b=m>=pi.length;return{targetIndex:m,darts:n.darts+1,finished:b}}function di(n,i){return Qs(n,i,"SINGLE")}function Il(){return gr()}function vr(n=50){return{score:0,darts:0,finished:!1,target:n}}const Bl=[5,10,15,20,25,50];function Fl(n){return Bl.includes(n)}function Zs(n,i,o){if(n.finished)return n;if(!Fl(i))return{...n,darts:n.darts+1};const x=n.score+i,c=x>=n.target;return{score:c?n.target:x,darts:n.darts+1,finished:c,target:n.target}}function ui(n,i){return Zs(n,i)}function Hl(n=50){return vr(n)}function jr(n=70){return{score:0,darts:0,finished:!1,target:n}}const Ul=[7,14,21];function Vl(n){return Ul.includes(n)}function Js(n,i,o){if(n.finished)return n;if(!Vl(i))return{...n,darts:n.darts+1};const x=n.score+i,c=x>=n.target;return{score:c?n.target:x,darts:n.darts+1,finished:c,target:n.target}}function mi(n,i){return Js(n,i)}function Ol(n=70){return jr(n)}const yr=[20,19,18,17,16,15,14,13,12,25];function xi(){const n={};return yr.forEach(i=>{n[i]=0}),{marks:n,points:0}}function $l(n,i,o,x,c=()=>!1){let m=null,b=0;if(o==="BULL"||o==="INNER_BULL"||i===25||i===50)m=25,b=o==="INNER_BULL"||i===50?2:1;else if(typeof x=="number"&&x>=12&&x<=20)m=x,o==="TRIPLE"?b=3:o==="DOUBLE"?b=2:b=1;else if(i){for(const U of[20,19,18,17,16,15,14,13,12]){if(i===U){m=U,b=1;break}if(i===U*2){m=U,b=2;break}if(i===U*3){m=U,b=3;break}}!m&&(i===25||i===50)&&(m=25,b=i===50?2:1)}if(!m)return 0;const B=n.marks[m],ye=Math.max(0,3-B),K=Math.min(ye,b),v=Math.max(0,b-K),te=B+K;n.marks[m]=te>3?3:te;let H=0;return v>0&&!c(m)&&(m===25?o==="INNER_BULL"?H+=50*v:H+=25*v:H+=m*v),n.points+=H,H}function _l(n){return yr.every(i=>(n.marks[i]||0)>=3)}function Kl({left:n,right:i,className:o="",sticky:x=!0}){return e.jsxs("div",{className:`${x?"sticky top-0":""} card relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm ${o}`,children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:[n," ðŸŽ¯"]}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:i})]})}const Wl=[{label:"1 min",minutes:1},{label:"3 min",minutes:3},{label:"5 min",minutes:5}];function Gl(n){const i=Math.max(0,Math.floor(n/1e3)),o=Math.floor(i/60).toString().padStart(2,"0"),x=(i%60).toString().padStart(2,"0");return{mm:o,ss:x,totalSeconds:i}}function zl({localPlayerName:n,onResume:i}){const o=gt(M=>M.paused),x=gt(M=>M.pauseEndsAt),c=gt(M=>M.pauseStartedAt),m=gt(M=>M.pauseInitiator),b=gt(M=>M.setPaused),[B,ye]=r.useState(Date.now());r.useEffect(()=>{if(!o||!x)return;const M=setInterval(()=>{const w=Date.now();ye(w),w>=x&&b(!1,null)},250);return()=>clearInterval(M)},[o,x,b]);const K=Math.max(0,(x??B)-B),te=Math.max(1,(x??B)-(c??B)),H=Math.max(0,Math.min(1,1-K/te)),U=Math.round(H*100),O=r.useMemo(()=>({background:`conic-gradient(rgba(251, 191, 36, 0.95) ${U}%, rgba(255, 255, 255, 0.08) ${U}%)`}),[U]);if(!o)return null;const Ke=!m||!n||m===n,Te=()=>{i?i():b(!1,null)},de=M=>{const w=Date.now()+M*6e4;b(!0,w,m)},X=!x,{mm:W,ss:Be}=X?{mm:"--",ss:"--"}:Gl(K);return br.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[1200] flex items-center justify-center",style:{pointerEvents:"all"},onKeyDown:M=>M.stopPropagation(),onKeyUp:M=>M.stopPropagation(),children:[e.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-2xl"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/[0.04] to-transparent"}),e.jsxs("div",{className:"relative w-full max-w-sm mx-4 rounded-3xl border border-white/15 bg-white/[0.08] shadow-2xl shadow-black/50 p-8 sm:p-10 backdrop-blur-xl",children:[e.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-br from-white/10 to-transparent pointer-events-none"}),e.jsxs("div",{className:"relative flex flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:"text-xs uppercase tracking-[0.35em] font-semibold text-amber-200/80",children:"Match Paused"}),m&&e.jsxs("div",{className:"text-sm text-amber-200/60",children:["Paused by"," ",e.jsx("span",{className:"font-semibold text-amber-100",children:m})]}),e.jsxs("div",{className:"relative flex items-center justify-center w-48 h-48 sm:w-56 sm:h-56",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border border-amber-300/30 shadow-inner",style:X?{background:"rgba(255, 255, 255, 0.08)"}:O}),e.jsx("div",{className:"absolute inset-3 rounded-full bg-slate-950/90 border border-white/10 flex items-center justify-center",children:e.jsxs("div",{className:"font-mono text-5xl sm:text-6xl font-black text-white tabular-nums",children:[W,e.jsx("span",{className:"text-amber-300/80",children:":"}),Be]})})]}),X?Ke?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.25em] text-amber-200/60",children:"Select pause duration"}),e.jsx("div",{className:"flex items-center gap-3",children:Wl.map(M=>e.jsx("button",{className:"px-5 py-2.5 rounded-2xl text-sm font-semibold bg-amber-500/20 hover:bg-amber-500/40 text-amber-100 border border-amber-400/30 shadow-lg transition active:scale-95",onClick:()=>de(M.minutes),children:M.label},M.minutes))}),e.jsx("button",{className:"mt-1 px-8 py-3 rounded-2xl text-sm font-semibold bg-emerald-600 hover:bg-emerald-500 text-white border border-emerald-400/40 shadow-lg shadow-emerald-500/20 transition active:scale-95",onClick:Te,children:"Resume"})]}):e.jsxs("div",{className:"text-xs text-amber-200/50 mt-1",children:["Waiting for"," ",e.jsx("span",{className:"font-semibold text-amber-100",children:m})," ","to select timerâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-[0.25em] text-amber-200/40",children:"Countdown"}),Ke?e.jsx("button",{className:"mt-1 px-8 py-3 rounded-2xl text-sm font-semibold bg-emerald-600 hover:bg-emerald-500 text-white border border-emerald-400/40 shadow-lg shadow-emerald-500/20 transition active:scale-95",onClick:Te,children:"Resume"}):e.jsxs("div",{className:"text-xs text-amber-200/50 mt-1",children:["Only"," ",e.jsx("span",{className:"font-semibold text-amber-100",children:m})," ","can resume"]})]})]})]})]}),document.body)}function ee(n){return(i,o)=>{n(i)}}function Xl(n){const{match:i,commitManualVisitTotal:o,endTurn:x}=n;return{addVisit:(c,m=3,b)=>{if(o){o(c);return}try{i.addVisit(c,m,b)}catch{i.addVisit(c,m)}},undoVisit:()=>{i.undoVisit()},nextPlayer:()=>{if(x)try{x(0)}catch{i.nextPlayer()}else i.nextPlayer()},endLeg:c=>{typeof c=="number"?i.endLeg(c):i.endLeg(0)},endGame:()=>{i.endGame()}}}function Ze(n,i,o,x,c,m,b,B,ye,K,v,te,H,U,O,Ke,Te,de,X,W,Be,M,w,ue,We,d,Je){return r.useMemo(()=>{const y=[];if(n==="X01"){let me=0,T=0,Fe=0;if(de&&de.length>0){for(const F of de)F.dartsThrown&&F.totalScored&&(T+=F.dartsThrown,Fe+=F.totalScored);T>0&&(me=Fe/T*3)}const G=(te??0)>0?B??0:K??null??(m??0);if(y.push({name:"You",isCurrentTurn:!!X,legsWon:x||0,score:typeof i=="number"?i:typeof Be=="number"?Be:0,lastScore:G,avg:me,checkoutRate:O&&O>0?Math.round((U||0)/O*100):0,bestLeg:de&&de.length>0?`${Math.min(...de.map(F=>F.doubleDarts+(F.checkoutDarts||0)))||0} darts`:"â€”",matchAvg:me,allTimeAvg:al("You")||0}),W&&W!=="None"){const $=(H??0)>0?ye??0:v??null??(b??0);y.push({name:`${W} AI`,isCurrentTurn:!X,legsWon:c||0,score:typeof o=="number"?o:typeof Be=="number"?Be:0,lastScore:$,avg:void 0,checkoutRate:Te&&Te>0?Math.round((Ke||0)/Te*100):0,bestLeg:"â€”"})}}return n==="Cricket"&&(y.push({name:"You",isCurrentTurn:!!X,closed:M?.marks||{},points:M?.points||0}),W&&W!=="None"&&y.push({name:`${W} AI`,isCurrentTurn:!X,closed:{},points:0})),n==="Shanghai"&&(y.push({name:"You",isCurrentTurn:!!X,round:w?.round||1,target:w?.target||1,score:w?.score||0}),W&&W!=="None"&&y.push({name:`${W} AI`,isCurrentTurn:!X,round:w?.round||1,target:w?.target||1,score:0})),n==="Killer"&&ue&&ue.length>0&&ue.forEach((me,T)=>{const Fe=We?.[me.id];y.push({name:me.name,isCurrentTurn:T===Je,number:d?.[me.id],lives:Fe?.lives||0,eliminated:Fe?.eliminated||!1})}),y},[n,i,o,x,c,m,b,B,ye,K,v,te,H,U,O,Ke,Te,de,X,W,M,w,ue,We,d,Je])}const hi=r.memo(E),fi=["Easy","Medium","Hardened"],Yl=6500;function Me(n,i,o){return Math.max(i,Math.min(o,n))}function ql(n,i){let o=0;if(i==="Easy"){const x=[22,26,41,45,60];o=x[Math.floor(Math.random()*x.length)]}else i==="Medium"?o=Math.round(Me(60+(Math.random()*30-15),30,100)):o=Math.round(Me(80+(Math.random()*20-10),50,120));return n<=0?0:o>n?[100,85,81,60,57,45,41,26,22,20,1].find(c=>c<=n)??0:o}function Ql({onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:n,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const Zl=xl();function Do({user:n}){const{offlineLayout:i,favoriteDouble:o,callerEnabled:x,callerVoice:c,callerVolume:m,speakCheckoutOnly:b,rememberLastOffline:B,setLastOffline:ye,autoStartOffline:K,cameraEnabled:v,textSize:te,boxSize:H,autoscoreProvider:U,autoCommitMode:O="wait-for-clear",matchType:Ke="singles",setMatchType:Te,teamAName:de="Team A",setTeamAName:X,teamBName:W="Team B",setTeamBName:Be}=il(),M=U==="manual",w=v&&!M,ue=i==="classic"?"classic":"modern",We=v&&!M&&O!=="immediate",[d,Je]=r.useState("X01"),[y,me]=r.useState(501),[T,Fe]=r.useState("None"),[wr,en]=r.useState(!1),[jt,et]=r.useState(!1),[xe,G]=r.useState(y),[F,Nt]=r.useState(y),[gi,tn]=r.useState(!1),[sn,$]=r.useState(!1),[yt,Sr]=r.useState(1),[he,Qt]=r.useState(0),V=ll(),[vi,kr]=r.useState(!1),Cr=r.useRef(!1),[fe,Zt]=r.useState(0),[Jt,Y]=r.useState(null),[es,Dr]=r.useState(1),[ts,Ar]=r.useState(1),[Le,Mr]=r.useState([]),[Tr,ji]=r.useState(2e3),Ge=ol(),[tt,st]=r.useState(!1),[Lr,we]=r.useState(!1),[nn,ss]=r.useState(!1),[wt,nt]=r.useState({player:!1,opponent:!1}),ns=gt(t=>t.setPaused);r.useEffect(()=>{const t=()=>{st(!1),et(!1),we(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[St,Ni]=r.useState(!1),[kt,yi]=r.useState(!1),[rs,Er]=r.useState(1),[Jl,Rr]=r.useState(!1),[be,Ct]=r.useState(!0),[rn,wi]=r.useState(()=>typeof window<"u"&&window.innerWidth<768),[eo,Si]=r.useState(!1);r.useEffect(()=>{if(typeof window>"u")return;const t=()=>wi(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),r.useEffect(()=>{rn||Si(!1)},[rn]),r.useEffect(()=>{const t=()=>ut(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[D,S]=r.useState(0),[ze,an]=r.useState(0),[Dt,ln]=r.useState(0),[pe,Pr]=r.useState(0),[as,Ir]=r.useState(0),[At,on]=r.useState(mr()),[is,ls]=r.useState(xr()),[Ee,os]=r.useState(hr()),[He,cs]=r.useState(fr()),[to,se]=r.useState(0),[ds,Br]=r.useState(1),[cn,dn]=r.useState(27),[so,Fr]=r.useState(0),[ki,un]=r.useState(0),[Hr,Ur]=r.useState(!1),[us,Vr]=r.useState(1),[mn,Or]=r.useState(0),[no,$r]=r.useState(0),Ci=8,[ms,_r]=r.useState(1),[xn,Kr]=r.useState(0),[ro,Wr]=r.useState(0),Di=10,[xs,Gr]=r.useState(1),[hn,zr]=r.useState(0),[ao,Xr]=r.useState(0),Ai=10,[Mt,fn]=r.useState(170),[Yr,qr]=r.useState(0),[hs,Qr]=r.useState(0),[fs,Zr]=r.useState(0),[Tt,bn]=r.useState(121),[Jr,ea]=r.useState(0),[bs,ta]=r.useState(0),[ps,sa]=r.useState(0),[Re,pn]=r.useState(20),[Lt,gn]=r.useState(0),[na,vn]=r.useState(0),[Xe,Mi]=r.useState(30),[ra,jn]=r.useState(!1),[Et,aa]=r.useState(li()),[Rt,ia]=r.useState(oi()),[Se,la]=r.useState(ci()),[Nn,oa]=r.useState(xi()),[I,yn]=r.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[Pt,It]=r.useState({}),[gs,wn]=r.useState({}),[ca,Sn]=r.useState(!1),[ke,rt]=r.useState(0),[io,at]=r.useState(0),[it,Bt]=r.useState(null),[Ti,Pe]=r.useState(""),[vs,lo]=r.useState(gr()),[ne,lt]=r.useState(gr()),[Ce,oo]=r.useState(vr(50)),[ge,Ft]=r.useState(vr(50)),[De,co]=r.useState(jr(70)),[ve,Ht]=r.useState(jr(70)),[da,ot]=r.useState(0),[kn,Ye]=r.useState(0),[je,q]=r.useState(0),[Cn,Ut]=r.useState(y),[qe,re]=r.useState(0),[Dn,Ue]=r.useState(null),[js,Q]=r.useState(0),Ns=r.useRef(0),Li=r.useRef(0),ae=r.useRef(xe),z=r.useRef(je),ie=r.useRef(qe),ct=r.useRef(Cn),le=r.useRef(js);r.useEffect(()=>{ae.current=xe},[xe]),r.useEffect(()=>{z.current=je},[je]),r.useEffect(()=>{ie.current=qe},[qe]),r.useEffect(()=>{ct.current=Cn},[Cn]),r.useEffect(()=>{le.current=js},[js]);const[Ei,Vt]=r.useState(0);r.useRef(null);const[ua,An]=r.useState(0),[Mn,Tn]=r.useState(0),[Ln,dt]=r.useState(0),[En,Ve]=r.useState(0),[Rn,Ot]=r.useState(null),[Pn,$t]=r.useState(0),[ys,_t]=r.useState(0),[ma,ws]=r.useState(0),[Ss,xa]=r.useState(0),[ha,fa]=r.useState(0),[In,Kt]=r.useState(0),[Bn,ba]=r.useState(0),[pa,ks]=r.useState(0),[ga,va]=r.useState(0),[ja,Cs]=r.useState(0),[Ri,Ds]=r.useState(0),[Pi,As]=r.useState(0),[Na,Fn]=r.useState(0),[Ii,Hn]=r.useState(0),[Bi,Un]=r.useState(0),[Fi,Ms]=r.useState(0),[Hi,ya]=r.useState(0),[Ts,Ls]=r.useState(null),[Ui,Oe]=r.useState(!1),[Vi,Vn]=r.useState(!1),[Z,J]=r.useState(""),[uo,mo]=r.useState(""),[xo,ho]=r.useState(""),[fo,bo]=r.useState(""),[po,wa]=r.useState(""),[go,Sa]=r.useState(""),[Es,ka]=r.useState(null),[Oi,ut]=r.useState(!1),[On,$n]=r.useState(!1),[$i,Ca]=r.useState({}),[vo,Rs]=r.useState(!1),Qe=r.useRef(null),_n=r.useRef(null),Ae=r.useCallback(()=>{const t=_n.current;t&&(clearTimeout(t),_n.current=null)},[]),_i=r.useCallback(t=>{if(t>0&&t<=60){const s=cl(t,o);Ls({remaining:t,routes:s}),Oe(!0)}else Ls(null),Oe(!1)},[o]),Ps=r.useCallback(()=>{try{Xs({type:"quit"})}catch{}st(!1),et(!1),we(!1),ss(!1),nt({player:!1,opponent:!1})},[]);r.useEffect(()=>{nn&&wt.player&&wt.opponent&&Ps()},[Ps,wt,nn]);const Da=r.useCallback(t=>{if(!x)return;const s=Yt(n,"Player");try{dr(s,t.visitTotal,Math.max(t.remaining,0),c,{volume:m,checkoutOnly:b})}catch{}},[x,c,m,b,n]),Aa=r.useCallback((t,s)=>{Rs(!1);const{visitTotal:a,darts:l,preRemaining:u,remaining:p,doubleAttempts:g,finished:N,doubleWindow:f,highestCheckout:h}=t;N?(G(0),ae.current=0,typeof h=="number"&&h>0&&Ms(j=>Math.max(j,h))):(G(p),ae.current=p),Ue(a),a===180?Cs(j=>j+1):a>=140?Ds(j=>j+1):a>=100&&As(j=>j+1),f&&g>0&&(_t(j=>j+g),N&&ws(j=>j+1)),t.announced||Da(t);try{Ys.getState().recordVisit("offline-x01",l,a,{preRemaining:u,postRemaining:N?0:p,finish:N,bust:!1})}catch{}try{V.addVisit(a,l,{visitTotal:a}),N&&V.endLeg(u)}catch{}N&&(Y("player"),$(!0)),Xt(N?0:p),re(0),ie.current=0,q(0),z.current=0,Q(0),le.current=0},[Xt,Ms,Y,G,Ue,re,q,Q,$,Cs,Ds,As,_t,ws,Da]),mt=r.useCallback(t=>{const s=Qe.current;s&&(Qe.current=null,Ae(),Aa(s,t))},[Ae,Aa]);r.useCallback(t=>{Qe.current={...t,announced:!1},Rs(!0),Ae(),_n.current=setTimeout(()=>mt("timeout"),Yl)},[Ae,mt]),r.useEffect(()=>{if(!We)return;const t=()=>mt("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[We,mt]),r.useEffect(()=>{We||mt("timeout")},[We,mt]),r.useEffect(()=>()=>Ae(),[Ae]),r.useEffect(()=>{if(je===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}Ns.current=0}Li.current=je},[je]);const A=Yt(n,"Player 1"),Is=T==="None"?"Player 2":T,Bs=Ze("X01",xe,F,he,fe,kn,Mn,qe,Ln,Dn,Rn,je,En,ma,ys,ha,Ss,Le,be,T,y),Ma=Ze("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,At),Kn=Ze("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,be,T,void 0,At,is),Wn=Ze("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,I,Pt,gs,ke),Gn=Ze("Scam"),zn=Ze("Fives"),Xn=Ze("Sevens"),Yn=r.useMemo(()=>{switch(d){case"Cricket":return Ma;case"Shanghai":return Kn;case"Killer":return Wn;case"Scam":return Gn;case"Fives":return zn;case"Sevens":return Xn;default:return Bs}},[d,Ma,Kn,Wn,Gn,zn,Xn,Bs]),Ki=d==="X01"?`${he}-${fe}`:void 0,Fs=r.useMemo(()=>{const t=Bs||[],s=je>0?qe:Dn??kn,a=En>0?Ln:Rn??Mn;return t.length===0?{name:be?A:Is,isCurrentTurn:!0,legsWon:be?he:fe,score:be?xe:F,lastScore:be?s:a}:t.find(l=>l.isCurrentTurn)??t[0]},[Bs,be,A,Is,he,fe,xe,F,je,qe,Dn,kn,Ln,Rn,Mn,En]),Ta=r.useMemo(()=>{if(!Fs)return[];const{matchAvg:t,allTimeAvg:s,...a}=Fs;return[{...a,matchAvg:void 0,allTimeAvg:void 0}]},[Fs]);Fs?.name;const La=be?xe:F,Hs=V.players?.[V.currentPlayerIdx];let Ea=0,Ra=0;if(Hs&&Hs.legs&&Hs.legs.length>0){for(const t of Hs.legs)if(Array.isArray(t.visits))for(const s of t.visits)Ea+=s.score||0,Ra+=s.darts||0}const Wi=Ea+(qe||0),Pa=Ra+(je||0),Ia=Pa>0?Wi/Pa*3:0,qn=r.useMemo(()=>{if(Yn.length>0)return Yn;switch(d){case"Double Practice":return[{name:A,isCurrentTurn:!0,target:vt[ze]?.label||"â€”",hits:Dt,totalNeeded:vt.length}];case"Around the Clock":return[{name:A,isCurrentTurn:!0,target:ce[pe]===25?"25 (Outer Bull)":ce[pe]===50?"50 (Inner Bull)":ce[pe]||"â€”",hits:as,totalNeeded:ce.length}];case"Treble Practice":return[{name:A,isCurrentTurn:!0,target:`T${Re}`,hits:Lt,totalNeeded:Xe}];case"Count-Up":return[{name:A,isCurrentTurn:!0,score:mn,round:us}];case"High Score":return[{name:A,isCurrentTurn:!0,score:xn,round:ms}];case"Low Score":return[{name:A,isCurrentTurn:!0,score:hn,round:xs}];case"Checkout 170":return[{name:A,isCurrentTurn:!0,remaining:Mt,attempts:hs,successes:fs}];case"Checkout 121":return[{name:A,isCurrentTurn:!0,remaining:Tt,attempts:bs,successes:ps}];case"Bob's 27":return[{name:A,isCurrentTurn:!0,target:ds,score:cn}];case"Baseball":return[{name:A,isCurrentTurn:!0,inning:Et.inning,score:Et.score}];case"Golf":return[{name:A,isCurrentTurn:!0,hole:Rt.hole,strokes:Rt.strokes}];case"Tic Tac Toe":return[{name:A,isCurrentTurn:!0,turn:Se.turn,winner:Se.winner}];case"Scam":return[{name:A,isCurrentTurn:!0,target:qs[ne.targetIndex]||"â€”",darts:ne.darts,finished:ne.finished}];case"Fives":return[{name:A,isCurrentTurn:!0,score:Ce.score,target:Ce.target,darts:Ce.darts}];case"Sevens":return[{name:A,isCurrentTurn:!0,score:De.score,target:De.target,darts:De.darts}];case"High-Low":return[{name:A,isCurrentTurn:!0,round:He.round,target:He.target,score:He.score}];case"Halve It":return[{name:A,isCurrentTurn:!0,round:Ee.stage+1,target:(()=>{const t=pr(Ee);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})(),score:Ee.score}];default:return Ta}},[Yn,d,A,ze,Dt,pe,as,Re,Lt,Xe,mn,us,xn,ms,hn,xs,Mt,hs,fs,Tt,bs,ps,ds,cn,Et,Rt,Se,ne,Ce,De,He,Ee,Ta]),Wt=r.useMemo(()=>{if(d==="X01")return{primaryLabel:"Current score",primaryValue:La,secondaryLabel:"3-dart avg",secondaryValue:Ia.toFixed(1),secondaryClass:"text-emerald-300"};const t=qn[0],s=t?.score??t?.points??t?.lives??t?.remaining??0;let a="Target",l=t?.target??t?.round??"â€”";return d==="Cricket"||d==="American Cricket"?(a="Points",l=t?.points??0):d==="Killer"?(a="Lives",l=t?.lives??0):d==="Checkout 170"||d==="Checkout 121"?(a="Remaining",l=t?.remaining??0):d==="Baseball"?(a="Inning",l=t?.inning??1):d==="Golf"?(a="Hole",l=t?.hole??1):(d==="Scam"||d==="Fives"||d==="Sevens")&&(a="Target",l=t?.target??"â€”"),{primaryLabel:"Score",primaryValue:s,secondaryLabel:a,secondaryValue:l,secondaryClass:"text-white"}},[d,La,Ia,qn]),$e=r.useCallback(t=>Math.max(0,Math.min(99,Math.round(t||0))).toString(),[]),L=r.useCallback((t,s=1)=>{!t||s<=0||Ca(a=>({...a,[t]:(a[t]||0)+s}))},[]),P=r.useCallback(t=>{t&&Ca(s=>s[t]===void 0?s:{...s,[t]:0})},[]);$i[d];const Ba=r.useCallback(()=>{Qe.current&&(Qe.current=null),Ae(),Rs(!1)},[Ae]);r.useCallback(t=>{const s=Me(t,0,y);Ba(),G(s),ae.current=s;const a=s===0?y:s;Ut(a),ct.current=a,re(0),ie.current=0,q(0),z.current=0,Q(0),le.current=0,Ue(null),Ye(0),S(0),Ns.current=0,s===0?(Y("player"),$(!0)):(Y(null),$(!1))},[Ba,G,y,Ut,re,q,Q,Ue,Ye,S,Y,$]);const Fa=r.useCallback((t,s)=>{t==="player"?(Qt(s),wa("")):(Zt(s),Sa("")),Y(null),$(!1)},[Zt,Sa,wa,Y,Qt,$]),Gi=r.useCallback(()=>{ka(t=>t&&(t.stage===1?{...t,stage:2}:(Fa(t.target,t.value),null)))},[Fa]),Gt=r.useCallback(()=>{ka(null)},[]);r.useEffect(()=>{if(!Es)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),Gt())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[Gt,Es]);const Qn=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(te),xt=r.useRef(null),ht=r.useRef(null),Zn=r.useRef(null),[Ie,zt]=r.useState("first"),[ft,Jn]=r.useState(1),zi=r.useRef(null);r.useEffect(()=>{const t=Math.max(1,Math.floor(Number(ft)||1)),s=Ie==="first"?t:Math.max(1,Math.ceil(t/2));Sr(s)},[Ie,ft]),r.useEffect(()=>{if(!kt){Er(1),Rr(!1);return}const t=()=>{const l=xt.current,u=ht.current;if(!l||!u)return;const p=Zn.current?Zn.current.getBoundingClientRect().height:0,g=Math.max(0,l.clientHeight-p-6),N=Math.max(0,l.clientWidth-8),f=u.getBoundingClientRect(),h=rs||1,j=f.height/h,k=f.width/h,R=g>0?g/j:1,C=N>0?N/k:1,zs=Math.min(1,Math.max(.5,Math.min(R,C))),Ne=j*zs,rl=g>0&&Ne-g>1;Rr(rl),Er(zs)};t();const s=window.ResizeObserver,a=s?new s(()=>t()):null;return a&&xt.current&&a.observe(xt.current),a&&ht.current&&a.observe(ht.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{a&&xt.current&&a.unobserve(xt.current)}catch{}try{a&&ht.current&&a.unobserve(ht.current)}catch{}}},[kt,rs]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.mode;a&&(Je(a),_e())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),r.useEffect(()=>{const t=s=>{const a=s?.detail?.formatType,l=s?.detail?.formatCount,u=s?.detail?.startScore;(a==="first"||a==="best")&&zt(a),typeof l=="number"&&isFinite(l)&&Jn(Math.max(1,Math.floor(l))),typeof u=="number"&&isFinite(u)&&me(Math.max(1,Math.floor(u)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),r.useEffect(()=>{if(!K)return;const t=setTimeout(()=>_e(),50);return()=>clearTimeout(t)},[K]),r.useEffect(()=>{if(!tt||be||T==="None"||Ei<=0)return;let t,s=performance.now();const a=l=>{const u=l-s;s=l,Vt(p=>{const g=p-u;if(g<=0){let N=0,f=0,h=F;for(Ve(0);N<3&&h>0;){const j=ql(h,T),k=Me(j-N*20,0,Math.min(60,h)),R=h-k;if(Tn(k),An(Ne=>Ne+1),ba(Ne=>Ne+1),R<0){h=F,dt(0),$t(0),f=0,Ot(0),Ve(0);break}f+=k,dt(Ne=>Ne+k),va(Ne=>Ne+k);const C=h,zs=R;if(C>50&&zs<=50?$t(1):C<=50&&$t(Ne=>Ne+1),h=R,N+=1,Ve(N),h===0)break}if(Nt(h),h===0){f===180?Fn(k=>k+1):f>=140?Hn(k=>k+1):f>=100&&Un(k=>k+1);const j=F;j<=170&&ya(k=>Math.max(k,j)),F<=50&&(xa(k=>k+(Pn>0?Pn:1)),fa(k=>k+1)),Ot(f),dt(0),$t(0),Ve(0),Y("ai"),$(!0)}return h>0&&N>=3&&(f===180?Fn(j=>j+1):f>=140?Hn(j=>j+1):f>=100&&Un(j=>j+1),Ot(f),dt(0),$t(0),Ve(0)),Ve(0),Ct(!0),0}return g}),t=requestAnimationFrame(a)};return t=requestAnimationFrame(a),()=>cancelAnimationFrame(t)},[tt,be,T,F]),r.useEffect(()=>{V.inProgress&&(Cr.current||(kr(!0),Cr.current=!0))},[V.inProgress]);function _e(){et(!0),G(y),ae.current=y,Nt(y),tn(!1),st(!0),Ct(!0),S(0),ot(0),Ye(0),q(0),z.current=0,Ut(y),re(0),Ue(null),Q(0),Vt(0),An(0),Tn(0),dt(0),Ve(0),Ot(null),Y(null),Qt(0),Zt(0),Mr([]),gn(0),vn(0),jn(!1),Kt(0),ba(0),ks(0),va(0),Cs(0),Ds(0),As(0),Fn(0),Hn(0),Un(0),Ms(0),ya(0),_t(0),ws(0),xa(0),fa(0),P("X01");const t=Math.max(1,Math.floor(Number(ft)||1));if(Sr(Ie==="first"?t:Math.max(1,Math.ceil(t/2))),B)try{ye({mode:d,x01Start:y,firstTo:yt,aiLevel:T})}catch{}const s=Yt(n,"You"),a=T!=="None"?`AI (${T})`:"Opponent",l=T!=="None"?[s,a]:[s];V.newMatch(l,y,`offline-${Date.now()}`)}function Xi(){G(y),ae.current=y,Nt(y),tn(!1),Ls(null),Oe(!1),st(!0),Ct(!0),S(0),ot(0),Ye(0),q(0),z.current=0,Ut(y),re(0),ct.current=y,ie.current=0,Ue(null),Q(0),le.current=0,le.current=0,Vt(0),An(0),Tn(0),dt(0),Ve(0),Ot(null),Y(null)}function Xt(t){_i(t),q(0),z.current=0,Ut(t===0?y:t),ct.current=t===0?y:t,Q(0),le.current=0,T!=="None"?(Ct(!1),Vt(Tr)):(Vt(0),Ct(!0))}function _(t){if(!Number.isFinite(t))return!1;const s=ct.current,a=ae.current,l=z.current,u=ie.current,p=l>0||u>0;p&&(G(s),ae.current=s,q(0),z.current=0,re(0),ie.current=0,Q(0),le.current=0,Ye(0),S(0),ot(C=>Math.max(0,C-l)),Kt(C=>Math.max(0,C-l)),ks(C=>Math.max(0,C-u)),Ns.current=0);const g=p?s:a,N=g<=170?170:180,f=Me(Math.round(t),0,N),h=g-f,j=Me(Math.round(ts||0),0,3),k=Me(Math.round(es||0),0,3),R=h===0?j:3;if(L("X01",R),ot(C=>C+R),Kt(C=>C+R),q(R),z.current=R,re(f),ie.current=f,Ue(f),f===180?Cs(C=>C+1):f>=140?Ds(C=>C+1):f>=100&&As(C=>C+1),h<0){if(x)try{dr(A,0,Math.max(s,0),c,{volume:m,checkoutOnly:b})}catch{}try{Ys.getState().recordVisit("offline-x01",R,0,{preRemaining:g,postRemaining:s,bust:!0,finish:!1})}catch{}G(s),ae.current=s,Ue(0),re(0),ie.current=0,q(0),z.current=0,Q(0),le.current=0;try{V.addVisit(0,R)}catch{}return Xt(s),!0}if(G(h),ae.current=h,ks(C=>C+f),x)try{dr(A,f,Math.max(h,0),c,{volume:m,checkoutOnly:b})}catch{}if(h===0?(_t(C=>C+k),ws(C=>C+1),Q(k),le.current=k):g<=50&&_t(C=>C+3),h===0){g<=170&&Ms(C=>Math.max(C,g)),Ls(null),Oe(!1);try{Ys.getState().recordVisit("offline-x01",R,f,{preRemaining:g,postRemaining:0,finish:!0,bust:!1})}catch{}try{V.addVisit(f,R),V.endLeg(g)}catch{}return Y("player"),$(!0),q(0),z.current=0,re(0),ie.current=0,Q(0),le.current=0,!0}try{Ys.getState().recordVisit("offline-x01",R,f,{preRemaining:g,postRemaining:h,finish:!1,bust:!1})}catch{}try{V.addVisit(f,R)}catch{}return Xt(h),re(0),ie.current=0,q(0),z.current=0,Q(0),le.current=0,!0}const oe=Xl({match:V,commitManualVisitTotal:_,endTurn:Xt}),[er,tr]=r.useState(""),Ha=t=>{tr(t)},Yi=t=>t===50?{ring:"INNER_BULL",sector:25}:t===25?{ring:"BULL",sector:25}:t>=1&&t<=20?{ring:"SINGLE",sector:t}:{ring:void 0,sector:null},qi=t=>{const{ring:s,sector:a}=Yi(t);switch(d){case"Double Practice":nr(t);return;case"Around the Clock":Ks(t,s,a);return;case"Cricket":Ws(t,s,a);return;case"Shanghai":Gs(t,s,a);return;case"Halve It":lr(t,s,a);return;case"High-Low":or(t,s,a);return;case"Bob's 27":rr(t,s,a);return;case"Count-Up":Us(t);return;case"High Score":Vs(t);return;case"Low Score":Os(t);return;case"Checkout 170":ar(t,s);return;case"Checkout 121":ir(t,s);return;case"Treble Practice":_s(t,s,a);return;case"Baseball":Ga(t,s,a);return;case"Golf":za(t,s,a);return;case"American Cricket":Xa(t,s,a);return;case"Scam":lt(Qs(ne,t,s));return;case"Fives":setFives(Zs(Ce,t));return;case"Sevens":setSevens(Js(De,t));return;default:Ge("Use manual controls for this mode.",{type:"info",timeout:2e3})}},sr=()=>{const t=parseInt(er,10);if(isNaN(t)||t<0){alert("Enter a valid number");return}if(d!=="X01"){const l=Me(Math.round(t),0,999);qi(l),tr("");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=ae.current<=170?170:180,a=Me(Math.round(t),0,s);t>s&&Ge(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),_(a)&&tr("")},Ua=r.useCallback(()=>{Qe.current&&(Qe.current=null,Ae(),Rs(!1));const t=z.current,s=ie.current,a=ct.current;t===0&&s===0||(G(a),ae.current=a,q(0),z.current=0,re(0),ie.current=0,Q(0),le.current=0,Ye(0),S(0),ot(l=>Math.max(0,l-t)),Kt(l=>Math.max(0,l-t)),ks(l=>Math.max(0,l-s)),Ns.current=0)},[Ae]);r.useEffect(()=>{const t=s=>{const a=s?.detail;!a||a?.source==="offline-play"||Ua()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[Ua]);function nr(t){L("Double Practice");const s=Me(Math.round(t||0),0,60);if(Ye(s),ot(a=>a+1),Kt(a=>a+1),ri(s,ze)){const a=Dt+1;ln(a),an(l=>Math.min(20,l+1)),a>=21&&(Y("player"),$(!0))}S(0)}function Va(){nr(Number(D))}function Oa(){const t=qt(Z);if(t==null){alert("Enter like D16, 50, 25, T20");return}nr(t),J("")}function rr(t,s,a){if(Hr)return!1;L("Bob's 27");const l=ds,u=s==="DOUBLE"&&a===l||!s&&t===l*2;return u&&un(p=>p+1),Fr(p=>{const g=p+1;if(g>=3){const N=ki+(u?1:0);N>0?dn(h=>h+N*l*2):dn(h=>h-l*2);const f=l+1;return Br(f),un(0),f>20&&Ur(!0),0}return g}),!0}function $a(){rr(Math.max(0,D|0)),S(0)}function _a(){Br(1),dn(27),Fr(0),un(0),Ur(!1),P("Bob's 27")}function Us(t){return L("Count-Up"),Or(s=>s+Math.max(0,t|0)),$r(s=>{const a=s+1;return a>=3?(Vr(l=>l+1),0):a}),!0}function Vs(t){return L("High Score"),Kr(s=>s+Math.max(0,t|0)),Wr(s=>{const a=s+1;return a>=3?(_r(l=>l+1),0):a}),!0}function Os(t){return L("Low Score"),zr(s=>s+Math.max(0,t|0)),Xr(s=>{const a=s+1;return a>=3?(Gr(l=>l+1),0):a}),!0}function Ka(t,s,a,l,u,p,g,N){const f=t-g;if(!(f<0))if(f===0){if(N==="DOUBLE"||N==="INNER_BULL"){p(h=>h+1),u(h=>h+1),l(()=>0),s(t);return}s(f)}else s(f);l(h=>{const j=h+1;return j>=3?(u(k=>k+1),0):j})}function ar(t,s){return L("Checkout 170"),Ka(Mt,fn,Yr,qr,Qr,Zr,t,s),Yr+1>=3&&fn(170),!0}function ir(t,s){return L("Checkout 121"),Ka(Tt,bn,Jr,ea,ta,sa,t,s),Jr+1>=3&&bn(121),!0}function $s(t){const s=qt(Z);if(s==null){alert("Enter like T20, D16, 25, 50");return}const a=Z.trim().toUpperCase(),l=a.startsWith("D")||a==="50"||a==="BULL"||a==="DBULL"||a==="IBULL"||a.includes("INNER");t?ar(s,l?"DOUBLE":void 0):ir(s,l?"DOUBLE":void 0),J("")}function Qi(){fn(170),qr(0),Qr(0),Zr(0),P("Checkout 170")}function Zi(){bn(121),ea(0),ta(0),sa(0),P("Checkout 121")}function _s(t,s,a){return ra?!1:(L("Treble Practice"),(s==="TRIPLE"&&a===Re||!s&&t===Re*3)&&gn(u=>u+1),vn(u=>{const p=u+1;if(p%3===0&&[20,19,18].includes(Re)){const g=["T20","T19","T18"],N=g.indexOf(`T${Re}`),f=g[(N+1)%g.length];pn(Number(f.replace("T","")))}return Xe>0&&p>=Xe&&jn(!0),p}),!0)}function Wa(){gn(0),vn(0),jn(!1),P("Treble Practice")}function Ga(t,s,a){return L("Baseball"),aa(l=>{const u={...l};return Ml(u,t,s,a),u}),!0}function Ji(){aa(li()),P("Baseball")}function za(t,s,a){return L("Golf"),ia(l=>{const u={...l};return Ll(u,t,s,a),u}),!0}function el(){ia(oi()),P("Golf")}function tl(t,s,a,l){return L("Tic Tac Toe"),la(u=>{const p={...u,board:[...u.board]};return Rl(p,t,s,a,l),p}),!0}function sl(){la(ci()),P("Tic Tac Toe")}function Xa(t,s,a){return L("American Cricket"),oa(l=>{const u={...l,marks:{...l.marks}};return $l(u,t,s,a,()=>!1),u}),!0}function Ya(){oa(xi()),P("American Cricket")}function Ks(t,s,a){L("Around the Clock");const l=ce[pe];let u=!1;if(typeof a=="number"&&a===l&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(u=!0),l===25&&(s==="BULL"||t===25)&&(u=!0),l===50&&(s==="INNER_BULL"||t===50)&&(u=!0),u||(t===l||t===l*2||t===l*3)&&(u=!0),u){const p=as+1;return Ir(p),Pr(g=>g+1),!0}return!0}function qa(){Ks(Math.max(0,D|0)),S(0)}function Qa(){const t=qt(Z);if(t==null){alert("Enter like T20, D5, 25, 50");return}Ks(t),J("")}function Ws(t,s,a){return L("Cricket"),on(l=>{const u={...l,marks:{...l.marks}};return gl(u,t,s,a,()=>!1),u}),se(l=>{const u=l+1;return u>=3?0:u}),!0}function Za(){Ws(Math.max(0,D|0)),S(0)}function Gs(t,s,a){return L("Shanghai"),ls(l=>{const u={...l,turnHits:{...l.turnHits}};return Nl(u,t,s,a),u}),se(l=>{const u=l+1;return u>=3?(ls(p=>{const g={...p,turnHits:{...p.turnHits}};return yl(g),g}),0):u}),!0}function Ja(){Gs(Math.max(0,D|0)),S(0)}function lr(t,s,a){return L("Halve It"),os(l=>{const u={...l,targets:[...l.targets]};return wl(u,t,s,a),u}),se(l=>{const u=l+1;return u>=3?(os(p=>{const g={...p,targets:[...p.targets]};return Sl(g),g}),0):u}),!0}function ei(){lr(Math.max(0,D|0)),S(0)}function or(t,s,a){return L("High-Low"),cs(l=>{const u={...l};return kl(u,t,s,a),u}),se(l=>{const u=l+1;return u>=3?(cs(p=>{const g={...p};return Cl(g),g}),0):u}),!0}function ti(){or(Math.max(0,D|0)),S(0)}function nl(){const t=Jt??"player",s=t==="player"?js||void 0:Pn||void 0,a=1,l=t==="player"?da:ua;Mr([...Le,{winner:t,doubleDarts:es,checkoutDarts:ts,winnerDarts:l,doublesAtt:s,doublesHit:a}]),$(!1);let u=he,p=fe;if(Jt==="player"?u+=1:Jt==="ai"&&(p+=1),Qt(u),Zt(p),Y(null),u>=yt||p>=yt){try{fl(d,t==="player")}catch{}try{V.endGame()}catch{}st(!1),et(!1),G(y),Nt(y),Vn(!0);return}Xi()}const cr=!ur.includes(d)&&!(n?.fullAccess||n?.admin);return e.jsxs("div",{className:"card ndn-game-shell ndn-page flex flex-col min-h-0 relative overflow-hidden md:overflow-hidden overflow-y-auto",children:[vi&&e.jsx(dl,{players:V.players||[],user:n,onDone:()=>kr(!1)}),!tt&&!jt&&e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h2",{className:"text-2xl font-bold ndn-section-title",children:"Offline Mode ðŸŽ®"})}),e.jsxs("div",{className:"ndn-shell-body",children:[!tt&&!jt&&e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:d,onChange:t=>Je(t.target.value),children:[ur.map(t=>e.jsx("option",{value:t,children:t},t)),si.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t," ",n?.fullAccess||n?.admin?"":"(Premium)"]},t))]}),d==="Treble Practice"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:Xe,onChange:t=>Mi(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."}),v&&!rn&&e.jsx("div",{className:"hidden md:block w-[360px] p-3 min-w-0",children:e.jsx("div",{"data-testid":"offline-camera-pane",className:"rounded-2xl overflow-hidden bg-black/70 p-2",style:{willChange:"transform, opacity"},children:e.jsx(hi,{scoringMode:"x01",showToolbar:w,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:ee(_),onAutoDart:(t,s,a)=>{}})})})]}),!n?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),d==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:y,onChange:t=>me(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:T,onChange:t=>Fe(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),fi.map(t=>e.jsx("option",{value:t,children:t},t))]}),T!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:Tr/1e3,onChange:t=>ji(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>en(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),d==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!tt&&!jt&&e.jsx("button",{className:"btn",disabled:cr,title:cr?"PREMIUM required for this mode":"",onClick:_e,children:"Start Match ðŸš€"}),tt&&e.jsx("div",{className:`fixed inset-0 z-[1000] bg-slate-950/90 backdrop-blur-sm ${St?"":"flex items-center justify-center p-3 sm:p-4"}`,children:e.jsx(bt,{storageKey:"ndn:modal:offline-match:v2",frameClassName:"relative",frameFullScreenClassName:"relative ndn-modal-full",className:`${St?"w-full h-full ndn-modal-tight":""} relative flex flex-col overflow-hidden`,fullScreen:St,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex h-full",children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 pl-2 sm:pl-3",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{xt.current=t},children:[ue!=="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:t=>{Zn.current=t},children:e.jsx(Kl,{className:"w-full",left:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[d,d==="X01"?` / ${y}`:""]}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",yt," Â· Legs ",he,"-",fe]}),e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs bg-white/10 text-white/70 border-white/20",children:"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:kt?"Actual Size":"Fit All",onClick:()=>yi(t=>!t),children:kt?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:St?"Restore":"Maximize",onClick:()=>Ni(t=>!t),children:St?"Restore":"Maximize"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{_e()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>we(!0),children:"Quit"})]})})}),Lr&&e.jsx(ni,{onClose:()=>we(!1),onQuit:()=>{if(T==="None"){we(!1),nt({player:!0,opponent:!1}),ss(!0);return}Ps()},onPause:()=>{try{ns(!0,null,A),Xs({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:A})}catch{}we(!1)}})]}),nn&&e.jsx("div",{className:"fixed inset-0 z-[170] flex items-center justify-center bg-black/70 p-4",children:e.jsxs(bt,{storageKey:"ndn:modal:offline-quit-confirm",className:"w-full relative",defaultWidth:460,defaultHeight:320,minWidth:360,minHeight:260,maxWidth:720,maxHeight:520,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Confirm Quit (Both Players)"}),e.jsx("p",{className:"text-sm text-slate-200 mb-4",children:"Both players must accept to end the match. If either player wants to continue, the match will keep going."}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("button",{className:`btn w-full ${wt.player?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>nt(t=>({...t,player:!0})),children:[Yt(n,"Player 1")," Accepts"]}),e.jsxs("button",{className:`btn w-full ${wt.opponent?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>nt(t=>({...t,opponent:!0})),children:[T==="None"?"Opponent":`${T} AI`," Accepts"]}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 w-full",onClick:()=>{nt({player:!1,opponent:!1}),ss(!1)},children:"Continue Match"})]})]})}),d==="X01"&&Ui&&Ts&&e.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center bg-black/70 p-4",onClick:()=>Oe(!1),children:e.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl",onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key==="Escape")&&(t.preventDefault(),Oe(!1))},tabIndex:-1,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-emerald-200/70",children:"Checkout box"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-100",children:[Ts.remaining," left"]})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>Oe(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${es===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Dr(t),children:$e(t)},`double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ts===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Ar(t),children:$e(t)},`checkout-${t}`))})]}),Ts.routes.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-emerald-200/80 mb-1",children:"Suggested checkout"}),e.jsx("div",{className:"space-y-1",children:Ts.routes.map(t=>e.jsx("div",{className:"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold",children:t},t))})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>Oe(!1),children:"Enter"})})]})]})}),e.jsxs("div",{ref:t=>{ht.current=t},className:"will-change-transform",style:kt?{transform:`scale(${rs})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,rs))}em`}:void 0,children:[ue!=="modern"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:d==="X01"?"X01 Match âš”ï¸":`${d} âš”ï¸`}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",d]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",y]}),e.jsxs("div",{ref:zi,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=xe!==y||F!==y||je>0,s=`pill ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${s} ${Ie==="first"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||zt("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${s} ${Ie==="best"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||zt("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:ft,onChange:a=>Jn(Math.max(1,Math.floor(Number(a.target.value)||1))),disabled:t,title:Ie==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",he,"â€“",fe]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`input input-compact font-bold ${Qn}`,value:Ke,onChange:t=>Te(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${Qn} w-[7.5rem]`,value:de,onChange:t=>X(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${Qn} w-[7.5rem]`,value:W,onChange:t=>Be(t.target.value),placeholder:"Team B"})]})]})]}),ue!=="modern"&&d!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[d==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:vt[ze]?.label||"â€”"})]})}),d==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:ce[pe]===25?"25 (Outer Bull)":ce[pe]===50?"50 (Inner Bull)":ce[pe]||"â€”"})]})}),d==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:Nr.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,At.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:At.points})]}),vl(At)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{on(mr()),se(0),P("Cricket")},children:"Reset"})]})]}),d==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:is.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",is.score]}),is.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{ls(xr()),se(0),P("Shanghai")},children:"Reset"})]})]}),d==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[Ee.stage+1,"/",Ee.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=pr(Ee);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ee.score]}),Ee.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{os(hr()),se(0),P("Halve It")},children:"Reset"})]})]}),d==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",He.round," Â· Target ",He.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",He.score]}),He.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{cs(fr()),se(0),P("High-Low")},children:"Reset"})]})]}),d==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",ds]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",cn]}),Hr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:_a,children:"Reset"})]})]}),d==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",us,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",mn]})]}),d==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",ms,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",xn]})]}),d==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",xs,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",hn]})]}),d==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Mt}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",hs," Â· Successes:"," ",fs]})]}),d==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Tt}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",bs," Â· Successes:"," ",ps]})]}),d==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",Re]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",Lt]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${Re===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>pn(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:Re,onChange:t=>pn(parseInt(t.target.value,10)),children:Array.from({length:20},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Wa,children:"Reset"})]})]})}),d==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Et.inning}),e.jsxs("div",{className:"text-sm",children:["Score:"," ",e.jsx("span",{className:"font-semibold",children:Et.score})]})]}),d==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Rt.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes:"," ",e.jsx("span",{className:"font-semibold",children:Rt.strokes})]})]}),d==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Se.turn}),Se.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",Se.winner||"â€”"]})]}),d==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:qs[vs.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[vs.targetIndex+1,"/",qs.length]})]}),vs.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",vs.darts," darts!"]})]}),d==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Ce.score,"/",Ce.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Ce.darts})]}),Ce.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Ce.target,"!"]})]}),d==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[De.score,"/",De.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:De.darts})]}),De.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",De.target,"!"]})]}),d==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:yr.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,Nn.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:Nn.points})]}),_l(Nn)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Ya,children:"Reset"})]})]}),d==="Killer"&&e.jsx(e.Fragment,{children:ca?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:I[ke]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:it?`${I.find(t=>t.id===it)?.name||"Winner"} Wins`:Ti||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):ue==="modern"?e.jsxs("div",{className:"space-y-3 mb-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap py-1",children:[e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-rose-600/20 text-rose-200 border border-rose-400/30 hover:bg-rose-600/40 transition-colors",onClick:()=>we(!0),children:"Quit"}),e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-amber-600/20 text-amber-200 border border-amber-400/30 hover:bg-amber-600/40 transition-colors",onClick:()=>{try{ns(!0,null,A),Xs({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:A})}catch{}Ge("Match paused â€” select duration on overlay",{type:"info",timeout:2500})},children:"Pause"}),e.jsx("button",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-slate-600/20 text-slate-200 border border-slate-400/30 hover:bg-slate-600/40 transition-colors",onClick:()=>_e(),children:"Restart"}),e.jsx("button",{className:`px-3 py-1 rounded-full text-xs font-semibold border transition-colors ${On?"bg-indigo-600/40 text-indigo-100 border-indigo-400/50":"bg-indigo-600/20 text-indigo-200 border-indigo-400/30 hover:bg-indigo-600/40"}`,onClick:()=>$n(t=>!t),children:On?"Close Setup â–²":"New Match â–¼"})]}),On&&e.jsxs("div",{className:"rounded-2xl bg-slate-900/80 border border-white/10 p-3 space-y-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Match Setup"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Game Mode"}),e.jsxs("select",{className:"input w-full text-sm",value:d,onChange:t=>Je(t.target.value),children:[ur.map(t=>e.jsx("option",{value:t,children:t},t)),si.map(t=>e.jsxs("option",{value:t,disabled:!(n?.fullAccess||n?.admin),children:[t,n?.fullAccess||n?.admin?"":" (Premium)"]},t))]})]}),d==="X01"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Starting Score"}),e.jsx("input",{className:"input w-full text-sm",type:"number",min:1,max:1001,value:y,onChange:t=>me(Number(t.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"Format"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-xs border ${Ie==="first"?"bg-white/20 border-white/30":"bg-transparent border-white/10 opacity-60"}`,onClick:()=>zt("first"),children:"First to"}),e.jsx("button",{type:"button",className:`px-2 py-0.5 rounded-full text-xs border ${Ie==="best"?"bg-white/20 border-white/30":"bg-transparent border-white/10 opacity-60"}`,onClick:()=>zt("best"),children:"Best of"}),e.jsx("input",{className:"input w-14 text-center text-sm",type:"number",min:1,step:1,value:ft,onChange:t=>Jn(Math.max(1,Math.floor(Number(t.target.value)||1)))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-white/60 mb-1 block",children:"AI Opponent"}),e.jsxs("select",{className:"input w-full text-sm",value:T,onChange:t=>Fe(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),fi.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>{$n(!1),_e()},children:"Start New Match ðŸš€"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>$n(!1),children:"Cancel"})]})]}),Lr&&e.jsx(ni,{onClose:()=>we(!1),onQuit:()=>{if(T==="None"){we(!1),nt({player:!0,opponent:!1}),ss(!0);return}Ps()},onPause:()=>{try{ns(!0,null,A),Xs({type:"pause",pauseStartedAt:Date.now(),pauseInitiator:A})}catch{}we(!1)}})]}):null,ue!=="modern"?e.jsxs("div",{className:"space-y-2",children:[d==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:vt[ze]?.label||"â€”"})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&ri(t,ze)){const l=Dt+1,u=ze+1;return ln(l),an(u),l>=vt.length&&setTimeout(()=>{ln(0),an(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Va()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Va,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:Z,onChange:t=>J(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Oa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Oa,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",Dt," of 21"]})]}),d==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:ce[pe]===25?"25 (Outer Bull)":ce[pe]===50?"50 (Inner Bull)":ce[pe]||"â€”"})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ks(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&qa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:qa,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:Z,onChange:t=>J(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Qa()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Qa,children:"Add"})]}),as>=ce.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{Ir(0),Pr(0),P("Around the Clock")},children:"Reset"})]})]}),d==="Cricket"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ws(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Za()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Za,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{on(mr()),se(0),P("Cricket")},children:"Reset"})]})]}),d==="Shanghai"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Gs(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&Ja()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:Ja,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ls(xr()),se(0),P("Shanghai")},children:"Reset"})]})]}),d==="Halve It"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>lr(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&ei()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ei,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{os(hr()),se(0),P("Halve It")},children:"Reset"})]})]}),d==="High-Low"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>or(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&ti()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ti,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{cs(fr()),se(0),P("High-Low")},children:"Reset"})]})]}),d==="Bob's 27"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>rr(t,s==="MISS"?void 0:s,a?.sector??null),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&$a()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:$a,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:_a,children:"Reset"})]})]}),d==="Count-Up"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:t=>Us(t),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Us(D),S(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Us(D),S(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Vr(1),Or(0),$r(0),P("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",us,"/",Ci]})]}),d==="High Score"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:t=>Vs(t),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Vs(D),S(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Vs(D),S(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{_r(1),Kr(0),Wr(0),P("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",ms,"/",Di]})]}),d==="Low Score"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:t=>Os(t),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Os(D),S(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Os(D),S(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Gr(1),zr(0),Xr(0),P("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",xs,"/",Ai]})]}),d==="Checkout 170"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s)=>ar(t,s==="MISS"?void 0:s),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:Z,onChange:t=>J(t.target.value),onKeyDown:t=>{t.key==="Enter"&&$s(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>$s(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Qi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Mt," Â· Attempts: ",hs," ","Â· Successes: ",fs]})]}),d==="Checkout 121"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s)=>ir(t,s==="MISS"?void 0:s),onAddVisit:ee(_),onEndLeg:t=>oe.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:Z,onChange:t=>J(t.target.value),onKeyDown:t=>{t.key==="Enter"&&$s(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>$s(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Zi,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",Tt," Â· Attempts: ",bs," ","Â· Successes: ",ps]})]}),d==="Treble Practice"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>_s(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:Z,onChange:t=>J(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=qt(Z);s!=null&&_s(s,void 0,void 0),J("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=qt(Z);t!=null&&_s(t,void 0,void 0),J("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",Lt," Â· Misses:"," ",Math.max(0,na-Lt)," Â· Darts:"," ",na,Xe>0?`/${Xe}`:""]}),ra&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:Wa,children:"Reset"})]})]}),d==="Baseball"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Ga(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ji,children:"Reset"})})]}),d==="Golf"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>za(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:el,children:"Reset"})})]}),d==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${Se.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(Se.finished||Se.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),a=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",l=t,u=bi[l],p=u.type==="BULL"?null:u.num||null;tl(l,s,a,p)},children:Se.board[t]||""},t))}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:sl,children:"Reset"})})]}),d==="American Cricket"&&e.jsxs(e.Fragment,{children:[v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>Xa(t,s==="MISS"?void 0:s,a?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ya,children:"Reset"})})]}),d==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:qs[ne.targetIndex]})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{const l=s==="MISS"?void 0:s;return L("Scam"),lt(Qs(ne,t,l)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(L("Scam"),lt(di(ne,D)),S(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{L("Scam"),lt(di(ne,D)),S(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{lt(Il()),P("Scam")},children:"Reset"})]}),ne.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",ne.darts," darts!"]})]}),d==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[ge.score,"/",ge.target]})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(L("Fives"),Ft(Zs(ge,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(L("Fives"),Ft(ui(ge,D)),S(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{L("Fives"),Ft(ui(ge,D)),S(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ft(Hl(ge.target)),P("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",ge.darts]}),ge.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",ge.target," in"," ",ge.darts," darts!"]})]}),d==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[ve.score,"/",ve.target]})]}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>(L("Sevens"),Ht(Js(ve,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:D,onChange:t=>S(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(L("Sevens"),Ht(mi(ve,D)),S(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{L("Sevens"),Ht(mi(ve,D)),S(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{Ht(Ol(ve.target)),P("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",ve.darts]}),ve.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",ve.target," in"," ",ve.darts," darts!"]})]}),d==="Killer"&&e.jsx(e.Fragment,{children:ca?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:I.map(t=>{const s=Pt[t.id],a=gs[t.id];return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"font-semibold",children:t.name}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-sm",children:["Number:"," ",e.jsx("span",{className:"font-semibold",children:a})]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsx("span",{className:"font-semibold",children:s?.lives??0})]})]},t.id)})}),v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(it)return!1;const l=s==="MISS"?void 0:s,u=a?.sector??null,p=I[ke];return p?(It(g=>{const N={};Object.keys(g).forEach(j=>N[j]={...g[j]});const f=ai(p.id,N,l,u);if(f.becameKiller)Pe(`${p.name} became a Killer`);else if(f.victimId){const j=I.find(k=>k.id===f.victimId);Pe(`${p.name} hit ${j?.name}'s ${gs[f.victimId]} (${f.livesRemoved} life${(f.livesRemoved||0)>1?"s":""})`)}else Pe("No effect");const h=ii(N);return h&&Bt(h),N}),at(g=>{const N=g+1;if(N>=3){let f=ke;for(let h=1;h<=I.length;h++){const j=(ke+h)%I.length,k=I[j].id,R=Pt[k];if(R&&!R.eliminated&&R.lives>0){f=j;break}}return rt(f),0}return N}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:Z,onChange:t=>J(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(it)return;const a=Z.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!a){J("");return}const l=a[1]||"S",u=parseInt(a[2],10),p=l==="D"?"DOUBLE":l==="T"?"TRIPLE":"SINGLE",g=I[ke];It(N=>{const f={};Object.keys(N).forEach(k=>f[k]={...N[k]});const h=ai(g.id,f,p,u);if(h.becameKiller)Pe(`${g.name} became a Killer`);else if(h.victimId){const k=I.find(R=>R.id===h.victimId);Pe(`${g.name} hit ${k?.name}'s ${gs[h.victimId]} (${h.livesRemoved} life${(h.livesRemoved||0)>1?"s":""})`)}else Pe("No effect");const j=ii(f);return j&&Bt(j),f}),J(""),at(N=>{const f=N+1;if(f>=3){let h=ke;for(let j=1;j<=I.length;j++){const k=(ke+j)%I.length,R=I[k].id,C=Pt[R];if(C&&!C.eliminated&&C.lives>0){h=k;break}}return rt(h),0}return f})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=ke;for(let s=1;s<=I.length;s++){const a=(ke+s)%I.length,l=I[a].id,u=Pt[l];if(u&&!u.eliminated&&u.lives>0){t=a;break}}rt(t),at(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{It({}),wn({}),Sn(!1),rt(0),at(0),Bt(null),Pe("")},children:"Reset"})]}),it&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",I.find(t=>t.id===it)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{It({}),wn({}),Sn(!1),rt(0),at(0),Bt(null),Pe("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:I.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:a=>{const l=a.target.value;yn(u=>u.map((p,g)=>g===s?{...p,name:l}:p))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>yn(a=>a.filter((l,u)=>u!==s)),disabled:I.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>yn(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(I.length<2){alert("Need at least 2 players");return}const t=I.map(l=>l.id),s=Al(t),a={};t.forEach(l=>{a[l]=Dl(s[l])}),wn(s),It(a),rt(0),at(0),Bt(null),Pe("Assigned numbers"),Sn(!0)},children:"Assign Numbers & Start"})]})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-2",children:"Visit total"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:d==="X01"?xe<=170?170:180:999,placeholder:d==="X01"?"0â€“180":"0â€“999",value:er,onChange:t=>Ha(t.target.value),onKeyDown:t=>{t.key==="Enter"&&sr()}}),e.jsx("button",{className:"btn px-4 py-1 text-sm",onClick:sr,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(bl,{value:er,onChange:Ha,onSubmit:sr,helperText:"Tap numbers then Enter to commit the visit total."})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:Wt.primaryLabel}),e.jsx("div",{className:"text-lg font-bold text-white",children:Wt.primaryValue})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:Wt.secondaryLabel}),e.jsx("div",{className:`text-lg font-bold ${Wt.secondaryClass}`,children:Wt.secondaryValue})]})]})}),e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Game"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[d,d==="X01"?` / ${y}`:""]})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Format"}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[Ie==="first"?"First to":"Best of"," ",ft," Â· ",he,"-",fe]})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(pt,{gameMode:d,players:qn,matchScore:Ki})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!v&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),v?e.jsx("div",{className:"bg-black aspect-video max-h-[420px]",children:e.jsx(hi,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!1,disableDetection:!0})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Tap numbers then Enter to commit a 3-dart visit."})]}),e.jsx("div",{className:"flex flex-col gap-3 min-h-0 flex-1 text-[14px]",children:e.jsx("div",{className:"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"}})}),d==="Cricket"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Ws(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),d==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(pt,{gameMode:"Shanghai",players:Kn})}),d==="Shanghai"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Gs(t,s==="MISS"?void 0:s,a?.sector??null),!0}})}),d==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(pt,{gameMode:"Killer",players:Wn})}),d==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(pt,{gameMode:"Scam",players:Gn})}),d==="Scam"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return lt(Qs(ne,t,s)),!0}})}),d==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(pt,{gameMode:"Fives",players:zn})}),d==="Fives"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Ft(Zs(ge,t)),!0}})}),d==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(pt,{gameMode:"Sevens",players:Xn})}),d==="Sevens"&&v&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(E,{scoringMode:"custom",showToolbar:w,immediateAutoCommit:!0,onAutoDart:(t,s,a)=>{if(t>0)return Ht(Js(ve,t)),!0}})})]}),e.jsx("div",{className:"h-1"})]})]})})})}),wr&&e.jsx(Ql,{onClose:()=>en(!1)}),cr&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${Zl}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&Ge("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?Ge("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):Ge("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{Ge("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",ul(ml(),5)]})]})]}),Oi&&typeof document<"u"?br.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>ut(!1),children:e.jsx(bt,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>ut(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>ut(!1),children:"Close"})]}),e.jsx(hl,{fill:!0,user:n,playerScore:xe,aiScore:F,x01Score:y,inMatch:jt,showWinPopup:sn,pendingLegWinner:Jt,playerDartsThrown:da,aiDartsThrown:ua,totalPlayerDarts:In,totalAiDarts:Bn,totalPlayerPoints:pa,totalAiPoints:ga,player180s:ja,player140s:Ri,player100s:Pi,ai180s:Na,ai140s:Ii,ai100s:Bi,playerHighestCheckout:Fi,aiHighestCheckout:Hi,onClose:()=>ut(!1),onOpen:()=>ut(!0),layout:ue})]})})}),document.body):null,Es&&typeof document<"u"?br.createPortal((()=>{const{target:t,value:s,stage:a}=Es,l=t==="player"?A:Is,u=t==="player"?he:fe;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:Gt,children:e.jsx(bt,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:Gt,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",a," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:a===1?e.jsxs(e.Fragment,{children:["Set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",l,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:u})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:Gt,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:Gi,children:"Yes"})]})]})})})})(),document.body):null,sn&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]",children:e.jsxs(bt,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:pl(V.players?.[V.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${es===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Dr(t),children:$e(t)},`win-double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ts===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Ar(t),children:$e(t)},`win-checkout-${t}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:nl,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{$(!1),_e()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{$(!1),st(!1),et(!1)},children:"Back to Menu"})]})]})}),Vi&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(bt,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[d," Â· ",y," start Â· First to ",yt]}),(()=>{const t=In>0?pa/In*3:0,s=(()=>{const f=Le.filter(h=>h.winner==="player"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),a=(()=>{const f=Le.filter(h=>h.winner==="player"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),l=ys>0?Math.round(ma/ys*100):0,u=Bn>0?ga/Bn*3:0,p=(()=>{const f=Le.filter(h=>h.winner==="ai"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.min(...f)} darts`:"â€”"})(),g=(()=>{const f=Le.filter(h=>h.winner==="ai"&&typeof h.winnerDarts=="number").map(h=>h.winnerDarts);return f.length?`${Math.max(...f)} darts`:"â€”"})(),N=Ss>0?Math.round(ha/Ss*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:Yt(n,"You")}),e.jsx("div",{className:"text-3xl font-extrabold",children:he}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:ys})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[l,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:s})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:a})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:ja})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[he," â€“ ",fe]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:T==="None"?"Opponent":`${T} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:fe}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:u.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:Ss})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[N,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:g})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:Na})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Le.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":T==="None"?"Opp":"AI"," ","Â· Dbl ",$e(t.doubleDarts)," Â· CO"," ",$e(t.checkoutDarts||0)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>Vn(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{Vn(!1),_e()},children:"Rematch"})]})]})}),Le.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:Le.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",$e(t.doubleDarts),", Checkout darts: ",$e(t.checkoutDarts||0)]},s))})]})]}),e.jsx(zl,{localPlayerName:A,onResume:()=>{ns(!1,null)}})]})}export{Do as default};
//# sourceMappingURL=OfflinePlay-CPd9drhg.js.map
