import{F as z,u as Be,r as Ee,j as e,H as Re,I as Ae,i as re,M as xe}from"./index-B97WPlz_.js";import{r as a,R as W,T as Pe,I as Ie,Z as Le,U as fe,p as De,v as Fe,h as pe}from"./ui-CUvqdgED.js";import{G as Oe}from"./GameCalibrationStatus-DoahRUzL.js";import{l as Ue}from"./inPlayDemo-DoeNMe7M.js";import"./vendor-D3F3s8fL.js";function $e({open:i,onClose:f,onCreate:j}){const[u]=a.useState(()=>document.createElement("div")),[p,k]=a.useState("X01"),[l,b]=a.useState("bestof"),[T,x]=a.useState(3),C=a.useRef(null),[m,B]=a.useState(0),[S,F]=a.useState(()=>z(p)?.[0]),E=Be().username||"Anonymous";a.useLayoutEffect(()=>(u.className="ndn-create-match-portal",document.body.appendChild(u),()=>{try{u&&u.remove()}catch{}}),[u]),a.useLayoutEffect(()=>{function n(h){h.key==="Escape"&&f()}return i&&document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[i,f]);const v=()=>{j({createdBy:E,game:p,modeType:l,legs:T,avgChoice:m,startingScore:S}),f()};return!i||!u?null:Ee.createPortal(e.jsxs("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4",children:[e.jsx("button",{"aria-label":"Close dialog",className:"absolute inset-0 w-full h-full bg-transparent",onClick:f}),e.jsxs("div",{className:"card rounded-xl p-6 max-w-lg w-full relative text-white",role:"dialog",children:[e.jsx("button",{"aria-label":"Close",className:"absolute top-3 right-3 text-rose-400 font-bold",onClick:f,children:"âœ•"}),e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Create Match ðŸŽ¯"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-80",children:"Created By ðŸŽ¯"}),e.jsxs("div",{className:"mt-1 p-2 bg-white/5 rounded text-white",children:[E," ðŸŽ¯"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-game",children:"Match Name (Game) ðŸŽ¯"}),e.jsx("select",{id:"match-game",className:"w-full p-2 border border-white/10 bg-white/5 rounded text-white",value:p,onChange:n=>{const h=n.target.value;k(h);const R=z(h);F(R?.[0])},onPointerDown:n=>{n.stopPropagation()},onMouseDown:n=>{n.stopPropagation()},onTouchStart:n=>{n.stopPropagation?.()},children:Re.map(n=>e.jsx("option",{value:n,children:n},n))})]}),z(p).length>0?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-start",children:`${p} Starting Score ðŸŽ¯`}),e.jsx("select",{id:"match-start",className:"ml-2 p-2 border border-white/10 bg-white/5 rounded text-white w-full",value:S,onChange:n=>F(Number(n.target.value)),onPointerDown:n=>{n.stopPropagation()},onMouseDown:n=>{n.stopPropagation()},onTouchStart:n=>{n.stopPropagation?.()},children:z(p).map(n=>e.jsx("option",{value:n,children:n},n))})]}):null,e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-80",children:"Mode ðŸŽ¯"}),e.jsxs("div",{className:"flex gap-2 mt-1 justify-center",children:[e.jsxs("label",{className:`btn ${l==="bestof"?"btn-primary":"btn-ghost"}`,children:[e.jsx("input",{type:"radio",name:"mode",value:"bestof",checked:l==="bestof",onChange:()=>{b("bestof"),x(n=>{const h=Math.max(1,n||3);return h%2===1?h:h+1}),setTimeout(()=>C.current?.focus(),0)},className:"sr-only"})," ","Best Of ðŸŽ¯"]}),e.jsxs("label",{className:`btn ${l==="firstto"?"btn-primary":"btn-ghost"}`,children:[e.jsx("input",{type:"radio",name:"mode",value:"firstto",checked:l==="firstto",onChange:()=>{b("firstto"),x(n=>Math.max(1,n||3)),setTimeout(()=>C.current?.focus(),0)},className:"sr-only"})," ","First To ðŸŽ¯"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-legs",children:l==="bestof"?"Best Of ðŸŽ¯":"First To ðŸŽ¯"}),e.jsx("input",{id:"match-legs",type:"number",min:1,value:T,onChange:n=>x(Math.max(1,Number(n.target.value||1))),ref:C,className:"w-full p-2 border border-white/10 bg-white/5 rounded text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm opacity-80",htmlFor:"match-avg",children:"Average Choice (Â±) ðŸŽ¯"}),e.jsx("input",{id:"match-avg",type:"number",value:m,onChange:n=>B(Number(n.target.value||0)),className:"w-full p-2 border border-white/10 bg-white/5 rounded text-white"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{className:"btn btn-primary",onClick:v,children:"Create Match ðŸŽ¯"})})]})]}),u)}function We({user:i}){const f=i?.username||"You",[j,u]=a.useState(0),[p,k]=a.useState(()=>[{id:1,name:"room-1",matches:[]}]),l=(()=>{try{return Ae()}catch{return null}})(),[b,T]=a.useState([]),x=re(t=>t.inProgress),C=re(t=>t.players),[m,B]=a.useState(!1),S=a.useRef(null),F=String(i?.email||"").toLowerCase()==="daviesfamily108@gmail.com";a.useEffect(()=>{if(!m)return;function t(s){try{if(!S.current)return;S.current.contains(s.target)||B(!1)}catch{}}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[m]);const[E,v]=a.useState(!1),n=W.useRef(!1);a.useEffect(()=>{x&&(n.current||(n.current=!0,v(!0)))},[x]),a.useEffect(()=>{x||(n.current=!1)},[x]),a.useEffect(()=>{if(l?.connected&&i?.username)try{l.send({type:"presence",username:i.username,email:i.email||""})}catch{}},[l?.connected,i]),a.useEffect(()=>{const t=()=>{try{re.getState().endGame()}catch{}};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[h,R]=a.useState(!1),[o,A]=a.useState(null),ne=W.useRef(null),[Ge,be]=a.useState(null),[ge,le]=a.useState({}),[Y,X]=a.useState(30),O=a.useRef([]);a.useEffect(()=>{O.current=b||[]},[b]);const Z=W.useRef(!1),[g,U]=a.useState(null),[H,$]=a.useState({}),[oe,G]=a.useState(!1),[K,ie]=a.useState(null),[ce,V]=a.useState(null),[de,me]=a.useState(null),[ee,_]=a.useState(!1),[P,je]=a.useState(""),[I,ve]=a.useState("all"),[L,we]=a.useState("all"),[J,ye]=a.useState("newest"),[w,q]=a.useState(1),te=16,D=p[j],Q=999,se=W.useCallback(t=>{if(!t)return t;const s=t.modeType||t.mode||"",r=t.legs??t.value??t.bestOf??t.sets??t.games??1,c=t.createdBy||t.creatorName||t.creator||t.host||"",d=t.createdAt||t.ts||Date.now();return{...t,modeType:s,mode:s||t.mode,legs:r,value:typeof t.value=="number"?t.value:r,createdBy:c,creatorName:t.creatorName||c,createdAt:d}},[]),M=a.useMemo(()=>(t=[])=>(t||[]).map(se).filter(s=>!(s?.isTest||s?.test||s?.migrated||s?.isMigration||s?.migration||s?.seeded||typeof s?.createdBy=="string"&&s.createdBy.toLowerCase().includes("test")||typeof s?.creatorName=="string"&&s.creatorName.toLowerCase().includes("test")||typeof s?.createdBy=="string"&&/^(alice-|host-|demo|dummy|sample)/i.test(s.createdBy)||typeof s?.creatorName=="string"&&/^(alice-|host-|demo|dummy|sample)/i.test(s.creatorName)||!(s?.game&&s?.modeType&&s?.legs))),[se]),y=a.useMemo(()=>{let t=M(D?.matches||[]);if((t?.length||0)===0&&(b?.length||0)>0&&(t=M(b)),(t?.length||0)===0&&(O.current?.length||0)>0&&(t=M(O.current)),P.trim()){const s=P.toLowerCase();t=t.filter(r=>(r.game||"").toLowerCase().includes(s)||(r.createdBy||r.creatorName||"").toLowerCase().includes(s)||(r.id||"").toLowerCase().includes(s))}return I!=="all"&&(t=t.filter(s=>(s.game||"").toLowerCase()===I)),L!=="all"&&(t=t.filter(s=>{const r=(s.modeType||"").replace("_","").toLowerCase(),c=L.replace("_","").toLowerCase();return r.includes(c)})),t=(t||[]).slice(),t.sort((s,r)=>{const c=s.createdAt||0,d=r.createdAt||0;return J==="newest"?d-c:c-d}),t.slice(0,Q)},[D,b,M,P,I,L,J,Q]);a.useEffect(()=>{q(1)},[P,I,L,J,j]);const N=Math.ceil(y.length/te),Ne=y.slice((w-1)*te,w*te),Ce=()=>{y.length>0&&he(y[0])},Se=t=>{const s={id:`m-${Date.now()}`,createdBy:t.createdBy||f,game:t.game,modeType:t.modeType,legs:t.legs,startingScore:t.startingScore,createdAt:Date.now()};l?.connected||k(r=>r.map((c,d)=>d===j?{...c,matches:[s,...c.matches]}:c));try{l?.connected&&(i?.username&&l.send({type:"presence",username:i.username,email:i.email||""}),l.send({type:"create-match",game:t.game,mode:t.modeType,value:t.legs,startingScore:t.startingScore,creatorAvg:t.avgChoice||0}))}catch{}},Me=()=>{T([]),k(t=>{const s=t.length+1,r=[...t,{id:s,name:`room-${s}`,matches:[]}];return u(r.length-1),r})};a.useEffect(()=>l?(l.connected&&l.send({type:"list-matches"}),l.addListener(s=>{try{if(s?.type==="joined"&&s.id&&be(s.id),s?.type==="presence")try{s.id&&le(r=>({...r,[s.id]:s.username||s.name||s.id}))}catch{}if(s?.type==="matches"){const r=M(s.matches||[]);T(r),O.current=r,k(c=>c.map((d,ae)=>ae===j?{...d,matches:r}:d))}if(s?.type==="match-prestart"){const r=se(s.match||null);r&&(r.prestartEndsAt=s.prestartEndsAt);try{r?.creatorId&&r?.creatorName&&le(d=>({...d,[r.creatorId]:r.creatorName}))}catch{}Z.current=!0,A(r);const c=s.prestartEndsAt||Date.now();X(Math.max(0,Math.ceil(((c||Date.now())-Date.now())/1e3))),setTimeout(()=>{Z.current=!1},0),U(null),$({}),G(!1),ie(null),V(null)}if(s?.type==="match-start"&&o&&s.roomId===o.id&&(A(null),U(null),$({})),s?.type==="prestart-choice-notify"){const{roomId:r,playerId:c,choice:d}=s;if(!r||!d)return;$(ae=>({...ae||{},[c]:d}))}s?.type==="prestart-bull"&&(G(!0),_(!1),me(null)),s?.type==="prestart-bull-winner"&&(V(s.winnerId||null),G(!1),_(!1)),s?.type==="prestart-bull-tie"&&(V(null),G(!1),_(!1))}catch{}})):void 0,[l,g,M,j]),a.useEffect(()=>{if(!o||Z.current||o.prestartEndsAt)return;X(30),U(null),$({});const t=setInterval(()=>X(s=>Math.max(0,s-1)),1e3);return()=>clearInterval(t)},[o]),a.useEffect(()=>{o&&setTimeout(()=>ne.current?.focus(),0)},[o]);const ke=()=>{v(!0);try{l?.connected&&o?.id&&l.send({type:"invite-response",matchId:o.id,accept:!0,toId:o.creatorId})}catch{}A(null)},he=t=>{A(t),v(!0);try{l?.connected&&(i?.username&&l.send({type:"presence",username:i.username,email:i.email||""}),l.send({type:"join-match",matchId:t.id,calibrated:!0}))}catch{}},ue=t=>{U(t);try{l?.connected&&o?.id&&l.send({type:"prestart-choice",roomId:o.id,choice:t})}catch{}},Te=()=>{Ue({players:[f,"Opponent"],startingScore:501,roomId:"online-demo",visits:[{score:60},{score:85},{score:100}]})};return e.jsx("div",{className:"flex-1 min-h-0 ndn-page",style:{position:"relative",marginTop:0},children:e.jsxs("div",{className:"card ndn-game-shell relative overflow-hidden md:overflow-hidden overflow-y-auto h-full flex flex-col",children:[E&&e.jsx(xe,{players:C||[],user:i,onDone:()=>v(!1),onRequestClose:()=>v(!1)}),e.jsx("h2",{className:"text-3xl font-bold text-black dark:text-white mb-4 ndn-section-title",children:"Online Lobby ðŸŒ"}),e.jsx("div",{className:"ndn-shell-body flex-1 overflow-hidden p-3 pb-0",children:e.jsxs("div",{className:"h-full flex flex-col gap-3",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-slate-900/50 border border-slate-800/50 flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("div",{className:"text-sm text-white/70",children:"Room"}),e.jsxs("div",{className:"px-3 py-1.5 bg-slate-800/60 rounded-lg border border-slate-700/50 text-white/90 font-medium",children:["Room (",D?.id,")"]}),e.jsx("button",{className:"btn btn-ghost btn-sm rounded-lg",onClick:Me,children:"New Room"})]}),e.jsxs("div",{className:"shrink-0 flex items-center gap-2",children:[e.jsxs("button",{className:"btn btn-sm bg-indigo-600 hover:bg-indigo-500 text-white border-none shadow-sm flex items-center gap-2 rounded-lg",onClick:()=>R(!0),disabled:(D?.matches?.length||0)>=Q,children:[e.jsx(Pe,{className:"w-4 h-4"}),"Create Match +"]}),F&&e.jsx("button",{className:"btn btn-sm btn-ghost rounded-lg",onClick:Te,children:"Demo In-Play"}),(D?.matches?.length||0)>=Q&&e.jsx("div",{className:"text-xs text-rose-400",children:"Room full â€” create a new room"})]})]}),!x&&e.jsx("div",{className:"p-4 rounded-lg bg-slate-900/50 border border-slate-800/50 flex flex-col gap-3",children:e.jsxs("div",{className:"ndn-filterbar",children:[e.jsxs("div",{className:"flex-1 min-w-[240px] relative",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/40"}),e.jsx("input",{type:"text",placeholder:"Search matches, players...",className:"w-full pl-9 pr-3 py-2 rounded-lg bg-slate-950/80 border border-slate-700/50 text-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500/40 transition-all",value:P,onChange:t=>je(t.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("select",{className:"input input-compact cursor-pointer font-semibold bg-slate-950/80 border border-slate-700/50 rounded-lg",value:I,onChange:t=>ve(t.target.value),children:[e.jsx("option",{value:"all",children:"All Games"}),e.jsx("option",{value:"x01",children:"X01"}),e.jsx("option",{value:"cricket",children:"Cricket"}),e.jsx("option",{value:"bermuda",children:"Bermuda"}),e.jsx("option",{value:"gotcha",children:"Gotcha"})]}),e.jsxs("select",{className:"input input-compact cursor-pointer font-semibold bg-slate-950/80 border border-slate-700/50 rounded-lg",value:L,onChange:t=>we(t.target.value),children:[e.jsx("option",{value:"all",children:"All Modes"}),e.jsx("option",{value:"first_to",children:"First To"}),e.jsx("option",{value:"best_of",children:"Best Of"})]}),e.jsxs("select",{className:"input input-compact cursor-pointer font-semibold bg-slate-950/80 border border-slate-700/50 rounded-lg",value:J,onChange:t=>ye(t.target.value),children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all border ${m?"bg-red-600 text-white border-red-500":"bg-slate-950/80 border-slate-700/50 text-white/80 hover:bg-slate-900"}`,onClick:()=>B(t=>!t),"aria-pressed":m,title:"Toggle focus mode: hide small details and show focused view",children:m?"Exit Focus":"Focus Mode"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{className:"btn btn-sm bg-indigo-600 hover:bg-indigo-500 text-white border-none shadow-sm flex items-center gap-2 px-4 rounded-lg",onClick:Ce,disabled:y.length===0,children:[e.jsx(Le,{className:"w-4 h-4 fill-current"}),"Quick Join"]})})]})}),e.jsxs("div",{className:"flex-1 overflow-auto flex flex-col",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-indigo-400"}),"Active Matches ï¿½ï¸"]}),e.jsx("div",{className:"flex-1 p-4 rounded-lg border border-slate-800/50 bg-slate-900/30 flex flex-col",children:e.jsxs("div",{className:"flex-1 overflow-auto",children:[(y.length||0)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center opacity-60",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mb-4",children:e.jsx(De,{className:"w-8 h-8 text-white/20"})}),e.jsx("p",{className:"text-lg font-medium mb-1",children:"No matches found"}),e.jsx("p",{className:"text-sm max-w-xs mx-auto",children:"Create a new match to get started or try adjusting your filters."})]}):null,(y.length||0)!==0&&e.jsxs("div",{className:"relative",children:[m&&e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto bg-red-600/95 text-white px-6 py-3 rounded-none shadow-lg text-lg font-bold transform transition-all duration-200 ease-out",children:e.jsx("button",{onClick:()=>B(!1),className:"w-full text-center",children:"FOCUS MODE â€” Click to exit"})})}),e.jsx("div",{ref:S,className:`ndn-card-grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 max-h-[28rem] overflow-auto p-1 ${m?"opacity-90":""}`,"data-testid":"matches-grid",children:Ne.map(t=>e.jsxs("div",{className:"group relative p-4 rounded-lg border border-slate-700/30 bg-slate-950/40 hover:border-indigo-500/50 hover:bg-slate-900/50 transition-all duration-150 shadow-sm hover:shadow-[0_8px_24px_-12px_rgba(99,102,241,0.4)] flex flex-col gap-3 min-h-[6.5rem]","data-testid":`match-${t.id}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[!m&&e.jsx("div",{className:"w-9 h-9 rounded-full bg-indigo-500/10 flex items-center justify-center border border-indigo-500/20 group-hover:border-indigo-500/40 transition-colors text-xs font-bold",children:t.createdBy?(t.createdBy||"U").substring(0,2).toUpperCase():(t.creatorName||"U").substring(0,2).toUpperCase()}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-bold text-white group-hover:text-indigo-300 transition-colors truncate",children:t.game}),e.jsxs("div",{className:"text-xs text-white/50 flex items-center gap-1",children:[e.jsx(Fe,{className:"w-3 h-3"}),new Date(t.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]})}),t.roomName&&e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-none bg-slate-950 border border-slate-850 text-white/70",children:t.roomName})]}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-white/70 bg-transparent border-t border-slate-850 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded-none bg-white/5 text-xs font-medium border border-slate-850",children:t.modeType==="bestof"?"Best Of":"First To"}),e.jsx("span",{className:"font-mono text-indigo-300",children:t.legs}),e.jsx("span",{children:"legs"}),t.startingScore&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-1 h-1 rounded-full bg-white/20"}),e.jsx("span",{className:"font-mono text-amber-300",children:t.startingScore})]})]}),!m&&e.jsxs("div",{className:"text-xs text-white/40 flex items-center gap-1 mt-1",children:[e.jsx(fe,{className:"w-3 h-3"}),"Created by:"," ",e.jsx("span",{className:"text-white/60",children:t.createdBy||t.creatorName||"Unknown"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto pt-2 border-t border-white/5",children:[e.jsx("div",{className:"flex items-center gap-2 min-w-0",children:!m&&e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-[10px] font-bold text-white",children:(t.createdBy||t.creatorName||"U").substring(0,2).toUpperCase()}),e.jsx("span",{className:"text-xs text-white/60 truncate max-w-[120px]",children:t.createdBy||t.creatorName})]})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{className:"btn btn-sm bg-indigo-600 hover:bg-indigo-500 text-white border-none shadow-sm px-4 rounded-none",onClick:()=>he(t),children:"Join"})})]})]},t.id))})]}),N>1&&e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 pt-2 border-t border-white/5",children:[e.jsxs("button",{className:"btn btn-sm btn-ghost text-white/60 hover:text-white disabled:opacity-30",disabled:w===1,onClick:()=>q(t=>Math.max(1,t-1)),children:[e.jsx(pe,{className:"w-4 h-4 rotate-90"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,N)},(t,s)=>{let r=s+1;return N>5&&(w>3&&(r=w-2+s),r>N&&(r=N-4+s)),e.jsx("button",{className:`w-8 h-8 rounded-none text-xs font-bold transition-all border border-slate-850 ${w===r?"bg-indigo-600 text-white shadow-sm":"bg-slate-950 text-white/70 hover:bg-slate-900"}`,onClick:()=>q(r),children:r},r)})}),e.jsxs("button",{className:"btn btn-sm btn-ghost text-white/60 hover:text-white disabled:opacity-30",disabled:w===N,onClick:()=>q(t=>Math.min(N,t+1)),children:["Next",e.jsx(pe,{className:"w-4 h-4 -rotate-90"})]})]})]})})]})]})}),e.jsx($e,{open:h,onClose:()=>R(!1),onCreate:t=>{Se(t),R(!1)}}),o&&e.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"join-heading",tabIndex:-1,className:"fixed inset-0 z-60 flex items-center justify-center bg-black/60 p-4",children:e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full",children:[e.jsx("div",{id:"join-heading",className:"text-lg font-bold mb-2",children:"Join Match âš”ï¸"}),e.jsxs("div",{className:"mb-3",children:[o.game," - ",o.modeType," Â· ",o.legs," legs"]}),e.jsxs("div",{className:"text-sm opacity-80 mb-3",children:["Created by ",o.createdBy]}),e.jsx("div",{className:"mb-3",children:e.jsx(Oe,{gameMode:o.game,compact:!0})}),o.startingScore&&e.jsxs("div",{className:"mb-3",children:["Starting score:"," ",e.jsx("span",{className:"font-mono",children:o.startingScore})]}),e.jsx(xe,{open:E,players:C,user:i,onRequestClose:()=>{},onDone:()=>{}}),e.jsxs("div",{className:"mb-3",children:["Timer: ",e.jsxs("span",{className:"font-mono",children:[Y,"s"]})]}),(Y<=15||o?.prestartEndsAt)&&e.jsxs("div",{className:"mb-3",children:["Choose:"," ",e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`btn ${g==="bull"?"btn-primary":"btn-ghost"}`,onClick:()=>ue("bull"),children:"Bull Up"}),e.jsx("button",{className:`btn ${g==="skip"?"btn-primary":"btn-ghost"}`,onClick:()=>ue("skip"),children:"Skip"})]}),e.jsx("div",{className:"text-xs opacity-70 mt-2",children:g?`You chose: ${g}`:"Please choose Bull Up or Skip before accepting"}),Object.keys(H).length>0&&e.jsx("div",{className:"text-xs opacity-70 mt-2",role:"status","aria-live":"polite",children:Object.entries(H).map(([t,s])=>e.jsxs("div",{children:[ge[t]||t," chose: ",s]},t))}),g==="skip"&&e.jsx("div",{className:"text-xs opacity-70 mt-2",children:"Skip requires both players to click Skip. Waiting for other playerâ€¦"}),g==="skip"&&Object.values(H).some(t=>t==="skip")&&e.jsx("div",{className:"text-sm font-semibold mt-2",children:"Both players skipped â€” Left player throws first"}),oe&&e.jsxs("div",{className:"text-xs opacity-70 mt-2",children:["Bull Up active â€”",ee?` you threw ${de??50}`:" throw to win the bull!"]}),oe&&!ee&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("input",{className:"input input-sm","aria-label":"bull-throw",type:"number",min:0,max:50,value:K??50,onChange:t=>ie(Math.max(0,Math.min(50,Number(t.target.value||0))))}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{try{l?.connected&&o?.id&&l.send({type:"prestart-bull-throw",roomId:o.id,score:K??50})}catch{}me(K??50),_(!0)},children:"Throw Bull"})]}),ee&&e.jsxs("div",{className:"text-sm font-semibold mt-2 animate-pulse",children:["You threw: ",de??50]}),ce&&e.jsxs("div",{className:"text-sm font-semibold mt-2",children:["Bull winner: ",ce]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{ref:ne,"aria-label":"Accept invitation",className:"btn btn-primary",onClick:ke,disabled:Y<=15&&!g,children:"Accept"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>{A(null)},children:"Cancel"})]})]})})]})})}export{We as default};
//# sourceMappingURL=OnlinePlay.clean-D5dp3geY.js.map
