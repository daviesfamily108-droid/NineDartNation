{"version":3,"file":"Scoreboard-DmIPdRdM.js","sources":["../../src/components/MatchControls.tsx","../../src/components/Scoreboard.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Undo2 } from \"lucide-react\";\nimport ScoreNumberPad from \"./ui/ScoreNumberPad.js\";\n\ninterface MatchControlsProps {\n  inProgress?: boolean;\n  startingScore?: number;\n  pendingEntries?: Array<any>;\n  onAddVisit: (score: number, darts: number) => void;\n  onUndo?: () => void;\n  onEndLeg?: (score?: number, darts?: number, meta?: any) => void;\n  onNextPlayer?: () => void;\n  onEndGame?: () => void;\n  showDartsSelect?: boolean;\n  showCheckoutSelectors?: boolean;\n  showActionButtons?: boolean;\n  showQuickButtons?: boolean;\n  showUndo?: boolean;\n  showVisitInputRow?: boolean;\n  showHelperText?: boolean;\n  showNumberPadLabel?: boolean;\n  quickButtons?: number[];\n}\n\nexport default function MatchControls({\n  inProgress = true,\n  startingScore: _startingScore = 501,\n  pendingEntries: _pendingEntries = [],\n  onAddVisit,\n  onUndo,\n  onEndLeg,\n  onNextPlayer,\n  onEndGame,\n  showDartsSelect = true,\n  showCheckoutSelectors = true,\n  showActionButtons = true,\n  showQuickButtons = true,\n  showUndo = true,\n  showVisitInputRow = true,\n  showHelperText = true,\n  showNumberPadLabel = true,\n  quickButtons = [180, 140, 100, 60],\n}: MatchControlsProps) {\n  const [scoreInput, setScoreInput] = useState<string>(\"0\");\n  const [darts, setDarts] = useState<number>(3);\n  const [checkoutDarts, setCheckoutDarts] = useState<number>(3);\n  const [doubleDarts, setDoubleDarts] = useState<number>(1);\n  const parsedScore = Number(scoreInput || 0);\n  const safeScore = Number.isFinite(parsedScore) ? parsedScore : 0;\n  const commitScore = () => {\n    onAddVisit(Math.max(0, safeScore), darts);\n    setScoreInput(\"0\");\n  };\n\n  if (!inProgress) {\n    return <p className=\"text-slate-600\">No game in progress.</p>;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      {showVisitInputRow && (\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <input\n            className=\"input w-32\"\n            type=\"number\"\n            value={scoreInput}\n            onChange={(e) => setScoreInput(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                commitScore();\n              }\n            }}\n            placeholder=\"Score\"\n          />\n          {showDartsSelect && (\n            <select\n              className=\"input\"\n              value={darts}\n              onChange={(e) => setDarts(parseInt(e.target.value))}\n            >\n              <option value={1}>1 dart</option>\n              <option value={2}>2 darts</option>\n              <option value={3}>3 darts</option>\n            </select>\n          )}\n          <button className=\"btn\" onClick={commitScore}>\n            Add Visit âž•\n          </button>\n          {showUndo && (\n            <button\n              className=\"px-3 py-2 rounded-xl border border-slate-200\"\n              onClick={() => onUndo && onUndo()}\n              title=\"Undo\"\n            >\n              <Undo2 className=\"w-4 h-4\" />\n            </button>\n          )}\n        </div>\n      )}\n      {showQuickButtons && quickButtons && quickButtons.length > 0 && (\n        <div className=\"flex flex-wrap items-center gap-2 mt-2 text-xs\">\n          <span className=\"opacity-70\">Quick:</span>\n          {quickButtons.map((v) => (\n            <button\n              key={String(v)}\n              className=\"btn px-2 py-0.5 text-xs\"\n              onClick={() => onAddVisit(v, 3)}\n            >\n              {v}\n            </button>\n          ))}\n        </div>\n      )}\n      <ScoreNumberPad\n        value={scoreInput}\n        onChange={setScoreInput}\n        onSubmit={commitScore}\n        label={showNumberPadLabel ? \"Number pad\" : undefined}\n        helperText={\n          showHelperText ? \"Tap numbers then press Enter to submit.\" : undefined\n        }\n      />\n      {showActionButtons && (\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <button\n            className=\"btn\"\n            onClick={() => {\n              onEndLeg &&\n                onEndLeg(Math.max(0, safeScore), checkoutDarts, {\n                  doubleDarts,\n                });\n              setScoreInput(\"0\");\n            }}\n          >\n            End Leg (Checkout {safeScore || 0}) ï¿½\n          </button>\n          <button\n            className=\"btn bg-slate-700 hover:bg-slate-800\"\n            onClick={() => onNextPlayer && onNextPlayer()}\n          >\n            Next Player ðŸ‘¤\n          </button>\n          <button\n            className=\"btn bg-emerald-600 hover:bg-emerald-700\"\n            onClick={() => {\n              onEndGame && onEndGame();\n            }}\n          >\n            End Game ï¿½\n          </button>\n        </div>\n      )}\n      {showCheckoutSelectors && (\n        <div className=\"grid gap-3 text-sm\">\n          <div>\n            <div className=\"text-xs text-white/60 mb-1\">\n              Darts used at double\n            </div>\n            <div className=\"flex flex-wrap gap-2\">\n              {[0, 1, 2, 3].map((n) => (\n                <button\n                  key={`double-${n}`}\n                  className={`btn px-3 py-1 text-sm ${doubleDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                  onClick={() => setDoubleDarts(n)}\n                >\n                  {n}\n                </button>\n              ))}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-white/60 mb-1\">Darts at checkout</div>\n            <div className=\"flex flex-wrap gap-2\">\n              {[0, 1, 2, 3].map((n) => (\n                <button\n                  key={`checkout-${n}`}\n                  className={`btn px-3 py-1 text-sm ${checkoutDarts === n ? \"bg-brand-600\" : \"btn--ghost\"}`}\n                  onClick={() => setCheckoutDarts(n)}\n                >\n                  {n}\n                </button>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useMatch } from \"../store/match.js\";\nimport { formatAvg } from \"../utils/stats.js\";\n// Icons not used directly in Scoreboard; MatchControls has its own icons\nimport MatchControls from \"./MatchControls.js\";\nimport { usePendingVisit } from \"../store/pendingVisit.js\";\nimport type { UnifiedMatchActions } from \"../logic/matchActions.js\";\nimport ResizableModal from \"./ui/ResizableModal.js\";\n\nexport default function Scoreboard({\n  matchActions,\n}: { matchActions?: UnifiedMatchActions } = {}) {\n  const {\n    players,\n    currentPlayerIdx,\n    addVisit,\n    undoVisit,\n    endLeg,\n    nextPlayer,\n    endGame,\n    inProgress,\n    startingScore,\n    bestLegThisMatch,\n  } = useMatch();\n  const pendingEntries = usePendingVisit((s) => s.entries);\n\n  // Prefer authoritative per-dart entries from the most recent committed visit\n  // (already stored in match state) when available. Fallback to the pendingVisit\n  // store for the in-progress turn.\n  const getLastCommittedEntriesForPlayer = (playerIdx: number) => {\n    try {\n      const p = players[playerIdx];\n      const leg = p?.legs?.[p.legs.length - 1];\n      const lastVisit = leg?.visits?.[leg.visits.length - 1] as any;\n      const entries = lastVisit?.entries;\n      return Array.isArray(entries) ? (entries as any[]) : null;\n    } catch {\n      return null;\n    }\n  };\n\n  function handleEndGame() {\n    try {\n      const summary = {\n        ts: Date.now(),\n        players: players.map((p) => {\n          const totals = p.legs.reduce(\n            (acc, L) => {\n              acc.points += L.totalScoreStart - L.totalScoreRemaining;\n              const legDarts = (L.visits || []).reduce(\n                (a, v) => a + (v.darts || 0),\n                0,\n              );\n              acc.darts += legDarts;\n              return acc;\n            },\n            { points: 0, darts: 0 },\n          );\n          const dartsThrown = totals.darts;\n          const avg = dartsThrown > 0 ? (totals.points / dartsThrown) * 3 : 0;\n          return {\n            id: p.id,\n            name: p.name,\n            legsWon: p.legsWon,\n            dartsThrown,\n            avg: Math.round(avg * 100) / 100,\n          };\n        }),\n        winner: players.reduce(\n          (best, p) => (p.legsWon > (best?.legsWon || 0) ? p : best),\n          players[0],\n        )?.name,\n      };\n      try {\n        localStorage.setItem(\"ndn_last_match\", JSON.stringify(summary));\n      } catch {}\n    } catch (err) {}\n    // Stats persistence is now handled inside match.endGame (store-level)\n    (matchActions?.endGame ?? endGame)();\n  }\n\n  return (\n    <ResizableModal\n      storageKey=\"ndn:modal:scoreboard\"\n      className=\"ndn-modal w-full h-full relative\"\n      defaultWidth={1100}\n      defaultHeight={720}\n      minWidth={720}\n      minHeight={480}\n      maxWidth={1600}\n      maxHeight={1200}\n      initialFitHeight\n    >\n      <div className=\"flex-1 min-h-0 overflow-y-auto p-3\">\n        <div className=\"ndn-hscroll\">\n          <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-3\">\n            <div className=\"col-span-2 card\">\n              <h2 className=\"text-lg font-semibold mb-3\">Score Input</h2>\n              {inProgress ? (\n                <MatchControls\n                  inProgress={inProgress}\n                  startingScore={startingScore}\n                  pendingEntries={pendingEntries}\n                  onAddVisit={(score, darts) => {\n                    // Compute remaining before we update store, to decide auto-advance\n                    const p = players[currentPlayerIdx];\n                    const leg = p.legs[p.legs.length - 1];\n                    const prevRemaining = leg\n                      ? leg.totalScoreRemaining\n                      : startingScore;\n                    const numericScore = typeof score === \"number\" ? score : 0;\n                    let newRemaining = prevRemaining - numericScore;\n                    if (!Number.isFinite(newRemaining) || newRemaining < 0)\n                      newRemaining = 0;\n                    // Call provided matchActions.addVisit if available, otherwise the store's addVisit\n                    // Call provided matchActions.addVisit if available, otherwise the store's addVisit\n                    if (matchActions?.addVisit) {\n                      matchActions.addVisit(score, darts);\n                    } else {\n                      addVisit(score, darts);\n                    }\n                    if (newRemaining === 0) {\n                      if (matchActions?.endLeg) {\n                        matchActions.endLeg(score);\n                      } else {\n                        endLeg(score);\n                      }\n                    } else {\n                      (matchActions?.nextPlayer ?? nextPlayer)();\n                    }\n                  }}\n                  onUndo={() => (matchActions?.undoVisit ?? undoVisit)()}\n                  onEndLeg={(score, darts, meta) => {\n                    const numericScore = typeof score === \"number\" ? score : 0;\n                    const finalDarts =\n                      typeof darts === \"number\" ? Math.max(0, darts) : 0;\n                    if (matchActions?.addVisit) {\n                      matchActions.addVisit(numericScore, finalDarts, {\n                        visitTotal: numericScore,\n                        doubleWindowDarts: meta?.doubleDarts ?? 0,\n                      });\n                    } else {\n                      addVisit(numericScore, finalDarts, {\n                        visitTotal: numericScore,\n                        doubleWindowDarts: meta?.doubleDarts ?? 0,\n                      });\n                    }\n                    (matchActions?.endLeg ?? endLeg)(numericScore);\n                  }}\n                  onNextPlayer={() =>\n                    (matchActions?.nextPlayer ?? nextPlayer)()\n                  }\n                  onEndGame={handleEndGame}\n                  quickButtons={[180, 140, 100, 60]}\n                />\n              ) : (\n                <p className=\"text-slate-600\">No game in progress.</p>\n              )}\n\n              <div className=\"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {players.map((p, idx) => {\n                  const currentLeg = p.legs[p.legs.length - 1];\n                  const remaining = currentLeg\n                    ? currentLeg.totalScoreRemaining\n                    : startingScore;\n                  // TV-style 3-dart avg across the entire match (all legs): sum(points)/sum(darts)*3\n                  const totals = p.legs.reduce(\n                    (acc, L) => {\n                      acc.points += L.totalScoreStart - L.totalScoreRemaining;\n                      const legDarts = (L.visits || []).reduce(\n                        (a, v) => a + (v.darts || 0),\n                        0,\n                      );\n                      acc.darts += legDarts;\n                      return acc;\n                    },\n                    { points: 0, darts: 0 },\n                  );\n                  const dartsThrown = totals.darts;\n                  const avg =\n                    dartsThrown > 0 ? (totals.points / dartsThrown) * 3 : 0;\n\n                  return (\n                    <div\n                      key={p.id}\n                      className={`card glass transition-shadow transition-all duration-150 ease-out ${idx === currentPlayerIdx ? \"ring-2 ring-brand-400\" : \"\"}`}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <h3 className=\"text-base font-semibold\">{p.name}</h3>\n                        <span className=\"badge w-32 justify-center\">\n                          Legs Won: {p.legsWon}\n                        </span>\n                      </div>\n                      <div className=\"mt-2 grid grid-cols-3 gap-2 text-center\">\n                        <div className=\"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile\">\n                          <div className=\"text-xs text-slate-500\">\n                            Remaining\n                          </div>\n                          <div\n                            className={`flex items-center justify-center gap-2 mt-1 h-3 w-full`}\n                            aria-hidden\n                          >\n                            {[0, 1, 2].map((i) => {\n                              // Only active/current player's pendingEntries matter; other players get translucent placeholders\n                              const committed =\n                                getLastCommittedEntriesForPlayer(idx);\n                              const e =\n                                idx === currentPlayerIdx\n                                  ? ((pendingEntries[i] as any) ?? null)\n                                  : ((committed?.[i] as any) ?? null);\n                              // IMPORTANT:\n                              // A MISS is a real dart and should still render as a recorded entry.\n                              // Previously, we treated value===0 as \"not a hit\" and rendered it as pending,\n                              // which made it look like dart 3 never arrived (\"zero mapping\").\n                              const isPending = e == null;\n                              const isHit =\n                                e != null &&\n                                (typeof e.ring === \"string\"\n                                  ? e.ring !== \"MISS\"\n                                  : typeof e.value === \"number\"\n                                    ? e.value > 0\n                                    : true);\n                              const color = isPending\n                                ? \"bg-gray-400/60\"\n                                : isHit\n                                  ? \"bg-emerald-400\"\n                                  : \"bg-rose-500\";\n                              const active =\n                                idx === currentPlayerIdx && !isPending;\n                              const classes = `visit-dot ${active ? \"active\" : \"inactive\"} ${color}`;\n                              return <span key={i} className={classes} />;\n                            })}\n                          </div>\n                          <div className=\"text-2xl font-bold\">{remaining}</div>\n                          <div className=\"h-1 w-full bg-white/10 rounded-full mt-2 overflow-hidden\">\n                            <div\n                              className=\"h-full bg-emerald-400/70 transition-all duration-200 ease-out\"\n                              style={{\n                                width: `${Math.max(0, Math.min(100, (1 - remaining / startingScore) * 100))}%`,\n                              }}\n                            />\n                          </div>\n                        </div>\n                        <div className=\"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile\">\n                          <div className=\"text-xs text-slate-500\">Darts</div>\n                          <div className=\"text-xl font-bold\">{dartsThrown}</div>\n                        </div>\n                        <div className=\"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center\">\n                          <div className=\"text-xs text-slate-500\">\n                            3-Dart Avg (Live)\n                          </div>\n                          <div className=\"text-xl font-bold\">\n                            {formatAvg(p.currentThreeDartAvg ?? 0)}\n                          </div>\n                        </div>\n                        <div className=\"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center\">\n                          <div className=\"text-xs text-slate-500\">\n                            3-Dart Avg (Match)\n                          </div>\n                          <div className=\"text-xl font-bold\">\n                            {formatAvg(avg)}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n\n              {bestLegThisMatch && (\n                <div className=\"mt-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200\">\n                  <strong>Best Leg (this match):</strong> Player{\" \"}\n                  {\n                    players.find((p) => p.id === bestLegThisMatch.playerId)\n                      ?.name\n                  }{\" \"}\n                  in {bestLegThisMatch.darts} darts\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </ResizableModal>\n  );\n}\n"],"names":["MatchControls","inProgress","_startingScore","_pendingEntries","onAddVisit","onUndo","onEndLeg","onNextPlayer","onEndGame","showDartsSelect","showCheckoutSelectors","showActionButtons","showQuickButtons","showUndo","showVisitInputRow","showHelperText","showNumberPadLabel","quickButtons","scoreInput","setScoreInput","useState","darts","setDarts","checkoutDarts","setCheckoutDarts","doubleDarts","setDoubleDarts","parsedScore","safeScore","commitScore","jsxs","jsx","e","Undo2","v","ScoreNumberPad","n","Scoreboard","matchActions","players","currentPlayerIdx","addVisit","undoVisit","endLeg","nextPlayer","endGame","startingScore","bestLegThisMatch","useMatch","pendingEntries","usePendingVisit","s","getLastCommittedEntriesForPlayer","playerIdx","p","leg","entries","handleEndGame","summary","totals","acc","L","legDarts","a","dartsThrown","avg","best","ResizableModal","score","newRemaining","meta","numericScore","finalDarts","idx","currentLeg","remaining","i","committed","isPending","isHit","classes","formatAvg"],"mappings":"+NAwBA,SAAwBA,EAAc,CACpC,WAAAC,EAAa,GACb,cAAeC,EAAiB,IAChC,eAAgBC,EAAkB,CAAA,EAClC,WAAAC,EACA,OAAAC,EACA,SAAAC,EACA,aAAAC,EACA,UAAAC,EACA,gBAAAC,EAAkB,GAClB,sBAAAC,EAAwB,GACxB,kBAAAC,EAAoB,GACpB,iBAAAC,EAAmB,GACnB,SAAAC,EAAW,GACX,kBAAAC,EAAoB,GACpB,eAAAC,EAAiB,GACjB,mBAAAC,EAAqB,GACrB,aAAAC,EAAe,CAAC,IAAK,IAAK,IAAK,EAAE,CACnC,EAAuB,CACrB,KAAM,CAACC,EAAYC,CAAa,EAAIC,EAAAA,SAAiB,GAAG,EAClD,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAiB,CAAC,EACtC,CAACG,EAAeC,CAAgB,EAAIJ,EAAAA,SAAiB,CAAC,EACtD,CAACK,EAAaC,CAAc,EAAIN,EAAAA,SAAiB,CAAC,EAClDO,EAAc,OAAOT,GAAc,CAAC,EACpCU,EAAY,OAAO,SAASD,CAAW,EAAIA,EAAc,EACzDE,EAAc,IAAM,CACxBzB,EAAW,KAAK,IAAI,EAAGwB,CAAS,EAAGP,CAAK,EACxCF,EAAc,GAAG,CACnB,EAEA,OAAKlB,EAKH6B,EAAAA,KAAC,MAAA,CAAI,UAAU,YACZ,SAAA,CAAAhB,GACCgB,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACC,UAAU,aACV,KAAK,SACL,MAAOb,EACP,SAAWc,GAAMb,EAAca,EAAE,OAAO,KAAK,EAC7C,UAAYA,GAAM,CACZA,EAAE,MAAQ,UACZA,EAAE,eAAA,EACFH,EAAA,EAEJ,EACA,YAAY,OAAA,CAAA,EAEbpB,GACCqB,EAAAA,KAAC,SAAA,CACC,UAAU,QACV,MAAOT,EACP,SAAWW,GAAMV,EAAS,SAASU,EAAE,OAAO,KAAK,CAAC,EAElD,SAAA,CAAAD,EAAAA,IAAC,SAAA,CAAO,MAAO,EAAG,SAAA,SAAM,EACxBA,EAAAA,IAAC,SAAA,CAAO,MAAO,EAAG,SAAA,UAAO,EACzBA,EAAAA,IAAC,SAAA,CAAO,MAAO,EAAG,SAAA,SAAA,CAAO,CAAA,CAAA,CAAA,QAG5B,SAAA,CAAO,UAAU,MAAM,QAASF,EAAa,SAAA,cAE9C,EACChB,GACCkB,EAAAA,IAAC,SAAA,CACC,UAAU,+CACV,QAAS,IAAM1B,GAAUA,EAAA,EACzB,MAAM,OAEN,SAAA0B,EAAAA,IAACE,EAAA,CAAM,UAAU,SAAA,CAAU,CAAA,CAAA,CAC7B,EAEJ,EAEDrB,GAAoBK,GAAgBA,EAAa,OAAS,GACzDa,OAAC,MAAA,CAAI,UAAU,iDACb,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,aAAa,SAAA,SAAM,EAClCd,EAAa,IAAKiB,GACjBH,EAAAA,IAAC,SAAA,CAEC,UAAU,0BACV,QAAS,IAAM3B,EAAW8B,EAAG,CAAC,EAE7B,SAAAA,CAAA,EAJI,OAAOA,CAAC,CAAA,CAMhB,CAAA,EACH,EAEFH,EAAAA,IAACI,EAAA,CACC,MAAOjB,EACP,SAAUC,EACV,SAAUU,EACV,MAAOb,EAAqB,aAAe,OAC3C,WACED,EAAiB,0CAA4C,MAAA,CAAA,EAGhEJ,GACCmB,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,UAAU,MACV,QAAS,IAAM,CACbxB,GACEA,EAAS,KAAK,IAAI,EAAGsB,CAAS,EAAGL,EAAe,CAC9C,YAAAE,CAAA,CACD,EACHN,EAAc,GAAG,CACnB,EACD,SAAA,CAAA,qBACoBS,GAAa,EAAE,KAAA,CAAA,CAAA,EAEpCG,EAAAA,IAAC,SAAA,CACC,UAAU,sCACV,QAAS,IAAMxB,GAAgBA,EAAA,EAChC,SAAA,gBAAA,CAAA,EAGDwB,EAAAA,IAAC,SAAA,CACC,UAAU,0CACV,QAAS,IAAM,CACbvB,GAAaA,EAAA,CACf,EACD,SAAA,YAAA,CAAA,CAED,EACF,EAEDE,GACCoB,EAAAA,KAAC,MAAA,CAAI,UAAU,qBACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,6BAA6B,SAAA,uBAE5C,EACAA,EAAAA,IAAC,MAAA,CAAI,UAAU,uBACZ,SAAA,CAAC,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKK,GACjBL,EAAAA,IAAC,SAAA,CAEC,UAAW,yBAAyBN,IAAgBW,EAAI,eAAiB,YAAY,GACrF,QAAS,IAAMV,EAAeU,CAAC,EAE9B,SAAAA,CAAA,EAJI,UAAUA,CAAC,EAAA,CAMnB,CAAA,CACH,CAAA,EACF,SACC,MAAA,CACC,SAAA,CAAAL,EAAAA,IAAC,MAAA,CAAI,UAAU,6BAA6B,SAAA,oBAAiB,EAC7DA,EAAAA,IAAC,MAAA,CAAI,UAAU,uBACZ,SAAA,CAAC,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKK,GACjBL,EAAAA,IAAC,SAAA,CAEC,UAAW,yBAAyBR,IAAkBa,EAAI,eAAiB,YAAY,GACvF,QAAS,IAAMZ,EAAiBY,CAAC,EAEhC,SAAAA,CAAA,EAJI,YAAYA,CAAC,EAAA,CAMrB,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAEJ,EApIOL,EAAAA,IAAC,IAAA,CAAE,UAAU,iBAAiB,SAAA,uBAAoB,CAsI7D,CCrLA,SAAwBM,EAAW,CACjC,aAAAC,CACF,EAA4C,GAAI,CAC9C,KAAM,CACJ,QAAAC,EACA,iBAAAC,EACA,SAAAC,EACA,UAAAC,EACA,OAAAC,EACA,WAAAC,EACA,QAAAC,EACA,WAAA5C,EACA,cAAA6C,EACA,iBAAAC,CAAA,EACEC,EAAA,EACEC,EAAiBC,EAAiBC,GAAMA,EAAE,OAAO,EAKjDC,EAAoCC,GAAsB,CAC9D,GAAI,CACF,MAAMC,EAAIf,EAAQc,CAAS,EACrBE,EAAMD,GAAG,OAAOA,EAAE,KAAK,OAAS,CAAC,EAEjCE,EADYD,GAAK,SAASA,EAAI,OAAO,OAAS,CAAC,GAC1B,QAC3B,OAAO,MAAM,QAAQC,CAAO,EAAKA,EAAoB,IACvD,MAAQ,CACN,OAAO,IACT,CACF,EAEA,SAASC,GAAgB,CACvB,GAAI,CACF,MAAMC,EAAU,CACd,GAAI,KAAK,IAAA,EACT,QAASnB,EAAQ,IAAKe,GAAM,CAC1B,MAAMK,EAASL,EAAE,KAAK,OACpB,CAACM,EAAKC,IAAM,CACVD,EAAI,QAAUC,EAAE,gBAAkBA,EAAE,oBACpC,MAAMC,GAAYD,EAAE,QAAU,CAAA,GAAI,OAChC,CAACE,EAAG7B,IAAM6B,GAAK7B,EAAE,OAAS,GAC1B,CAAA,EAEF,OAAA0B,EAAI,OAASE,EACNF,CACT,EACA,CAAE,OAAQ,EAAG,MAAO,CAAA,CAAE,EAElBI,EAAcL,EAAO,MACrBM,EAAMD,EAAc,EAAKL,EAAO,OAASK,EAAe,EAAI,EAClE,MAAO,CACL,GAAIV,EAAE,GACN,KAAMA,EAAE,KACR,QAASA,EAAE,QACX,YAAAU,EACA,IAAK,KAAK,MAAMC,EAAM,GAAG,EAAI,GAAA,CAEjC,CAAC,EACD,OAAQ1B,EAAQ,OACd,CAAC2B,EAAMZ,IAAOA,EAAE,SAAWY,GAAM,SAAW,GAAKZ,EAAIY,EACrD3B,EAAQ,CAAC,CAAA,GACR,IAAA,EAEL,GAAI,CACF,aAAa,QAAQ,iBAAkB,KAAK,UAAUmB,CAAO,CAAC,CAChE,MAAQ,CAAC,CACX,MAAc,CAAC,EAEdpB,GAAc,SAAWO,GAAA,CAC5B,CAEA,OACEd,EAAAA,IAACoC,EAAA,CACC,WAAW,uBACX,UAAU,mCACV,aAAc,KACd,cAAe,IACf,SAAU,IACV,UAAW,IACX,SAAU,KACV,UAAW,KACX,iBAAgB,GAEhB,SAAApC,EAAAA,IAAC,MAAA,CAAI,UAAU,qCACb,eAAC,MAAA,CAAI,UAAU,cACb,SAAAA,EAAAA,IAAC,OAAI,UAAU,wCACb,SAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,kBACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,6BAA6B,SAAA,cAAW,EACrD9B,EACC8B,EAAAA,IAAC/B,EAAA,CACC,WAAAC,EACA,cAAA6C,EACA,eAAAG,EACA,WAAY,CAACmB,EAAO/C,IAAU,CAE5B,MAAMiC,EAAIf,EAAQC,CAAgB,EAC5Be,EAAMD,EAAE,KAAKA,EAAE,KAAK,OAAS,CAAC,EAKpC,IAAIe,GAJkBd,EAClBA,EAAI,oBACJT,IACiB,OAAOsB,GAAU,SAAWA,EAAQ,IAErD,CAAC,OAAO,SAASC,CAAY,GAAKA,EAAe,KACnDA,EAAe,GAGb/B,GAAc,SAChBA,EAAa,SAAS8B,EAAO/C,CAAK,EAElCoB,EAAS2B,EAAO/C,CAAK,EAEnBgD,IAAiB,EACf/B,GAAc,OAChBA,EAAa,OAAO8B,CAAK,EAEzBzB,EAAOyB,CAAK,GAGb9B,GAAc,YAAcM,GAAA,CAEjC,EACA,OAAQ,KAAON,GAAc,WAAaI,GAAA,EAC1C,SAAU,CAAC0B,EAAO/C,EAAOiD,IAAS,CAChC,MAAMC,EAAe,OAAOH,GAAU,SAAWA,EAAQ,EACnDI,EACJ,OAAOnD,GAAU,SAAW,KAAK,IAAI,EAAGA,CAAK,EAAI,EAC/CiB,GAAc,SAChBA,EAAa,SAASiC,EAAcC,EAAY,CAC9C,WAAYD,EACZ,kBAAmBD,GAAM,aAAe,CAAA,CACzC,EAED7B,EAAS8B,EAAcC,EAAY,CACjC,WAAYD,EACZ,kBAAmBD,GAAM,aAAe,CAAA,CACzC,GAEFhC,GAAc,QAAUK,GAAQ4B,CAAY,CAC/C,EACA,aAAc,KACXjC,GAAc,YAAcM,GAAA,EAE/B,UAAWa,EACX,aAAc,CAAC,IAAK,IAAK,IAAK,EAAE,CAAA,CAAA,EAGlC1B,EAAAA,IAAC,IAAA,CAAE,UAAU,iBAAiB,SAAA,uBAAoB,EAGpDA,MAAC,OAAI,UAAU,6CACZ,WAAQ,IAAI,CAACuB,EAAGmB,IAAQ,CACvB,MAAMC,EAAapB,EAAE,KAAKA,EAAE,KAAK,OAAS,CAAC,EACrCqB,EAAYD,EACdA,EAAW,oBACX5B,EAEEa,EAASL,EAAE,KAAK,OACpB,CAACM,EAAKC,IAAM,CACVD,EAAI,QAAUC,EAAE,gBAAkBA,EAAE,oBACpC,MAAMC,GAAYD,EAAE,QAAU,CAAA,GAAI,OAChC,CAACE,EAAG7B,IAAM6B,GAAK7B,EAAE,OAAS,GAC1B,CAAA,EAEF,OAAA0B,EAAI,OAASE,EACNF,CACT,EACA,CAAE,OAAQ,EAAG,MAAO,CAAA,CAAE,EAElBI,EAAcL,EAAO,MACrBM,EACJD,EAAc,EAAKL,EAAO,OAASK,EAAe,EAAI,EAExD,OACElC,EAAAA,KAAC,MAAA,CAEC,UAAW,qEAAqE2C,IAAQjC,EAAmB,wBAA0B,EAAE,GAEvI,SAAA,CAAAV,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,0BAA2B,SAAAuB,EAAE,KAAK,EAChDxB,EAAAA,KAAC,OAAA,CAAK,UAAU,4BAA4B,SAAA,CAAA,aAC/BwB,EAAE,OAAA,CAAA,CACf,CAAA,EACF,EACAxB,EAAAA,KAAC,MAAA,CAAI,UAAU,0CACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,gEACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,yBAAyB,SAAA,YAExC,EACAA,EAAAA,IAAC,MAAA,CACC,UAAW,yDACX,cAAW,GAEV,UAAC,EAAG,EAAG,CAAC,EAAE,IAAK6C,GAAM,CAEpB,MAAMC,EACJzB,EAAiCqB,CAAG,EAChCzC,EACJyC,IAAQjC,EACFS,EAAe2B,CAAC,GAAa,KAC7BC,IAAYD,CAAC,GAAa,KAK5BE,EAAY9C,GAAK,KACjB+C,EACJ/C,GAAK,OACJ,OAAOA,EAAE,MAAS,SACfA,EAAE,OAAS,OACX,OAAOA,EAAE,OAAU,SACjBA,EAAE,MAAQ,EACV,IAQFgD,EAAU,aADdP,IAAQjC,GAAoB,CAACsC,EACO,SAAW,UAAU,IAP7CA,EACV,iBACAC,EACE,iBACA,aAG8D,GACpE,OAAOhD,EAAAA,IAAC,OAAA,CAAa,UAAWiD,CAAA,EAAdJ,CAAuB,CAC3C,CAAC,CAAA,CAAA,EAEH7C,EAAAA,IAAC,MAAA,CAAI,UAAU,qBAAsB,SAAA4C,EAAU,EAC/C5C,EAAAA,IAAC,MAAA,CAAI,UAAU,2DACb,SAAAA,EAAAA,IAAC,MAAA,CACC,UAAU,gEACV,MAAO,CACL,MAAO,GAAG,KAAK,IAAI,EAAG,KAAK,IAAI,KAAM,EAAI4C,EAAY7B,GAAiB,GAAG,CAAC,CAAC,GAAA,CAC7E,CAAA,CACF,CACF,CAAA,EACF,EACAhB,EAAAA,KAAC,MAAA,CAAI,UAAU,gEACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,yBAAyB,SAAA,QAAK,EAC7CA,EAAAA,IAAC,MAAA,CAAI,UAAU,oBAAqB,SAAAiC,CAAA,CAAY,CAAA,EAClD,EACAlC,EAAAA,KAAC,MAAA,CAAI,UAAU,6FACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,yBAAyB,SAAA,oBAExC,EACAA,MAAC,OAAI,UAAU,oBACZ,WAAUuB,EAAE,qBAAuB,CAAC,CAAA,CACvC,CAAA,EACF,EACAxB,EAAAA,KAAC,MAAA,CAAI,UAAU,6FACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,yBAAyB,SAAA,qBAExC,QACC,MAAA,CAAI,UAAU,oBACZ,SAAAkD,EAAUhB,CAAG,CAAA,CAChB,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EA/EKX,EAAE,EAAA,CAkFb,CAAC,CAAA,CACH,EAECP,GACCjB,EAAAA,KAAC,MAAA,CAAI,UAAU,8DACb,SAAA,CAAAC,EAAAA,IAAC,UAAO,SAAA,wBAAA,CAAsB,EAAS,UAAQ,IAE7CQ,EAAQ,KAAMe,GAAMA,EAAE,KAAOP,EAAiB,QAAQ,GAClD,KACJ,IAAI,MACFA,EAAiB,MAAM,QAAA,CAAA,CAC7B,CAAA,EAEJ,CAAA,CACF,EACF,CAAA,CACF,CAAA,CAAA,CAGN"}