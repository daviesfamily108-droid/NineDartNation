import{j as e,u as Pl,i as Il,e as Hl,k as wt,l as ji,m as cn,n as St,o as dn,p as Xs,q as Ze,M as Bl,r as Ni,t as yi,v as Fl,R as kt,P as $l,G as Ne,C as T,w as Ul,x as Ol,h as Vl,y as Kl,z as _l}from"./index-CMUmc1rS.js";import{r as n}from"./ui-DygUIHRq.js";import{M as Wl,S as wi}from"./MatchControls-C038Tlq5.js";import{f as Si}from"./stats-X3jz_E9o.js";import"./vendor-D3F3s8fL.js";const Ct=[...Array.from({length:20},(a,l)=>({label:`D${l+1}`,score:(l+1)*2})),{label:"DBULL",score:50,isBull:!0}];function ki(a,l){const m=Ct[l];return!!m&&a===m.score}function Zt(a){const l=a.trim().toUpperCase();if(!l)return null;if(l==="50"||l==="BULL"||l==="DBULL"||l==="IBULL")return 50;if(l==="25"||l==="OBULL")return 25;const m=l.match(/^(S|D|T)?\s*(\d{1,2})$/);if(!m)return null;const f=m[1]||"S",d=parseInt(m[2],10);return d<1||d>20?null:d*(f==="S"?1:f==="D"?2:3)}const me=[...Array.from({length:20},(a,l)=>l+1),25,50],Dn=[20,19,18,17,16,15,25];function mn(){const a={};return Dn.forEach(l=>{a[l]=0}),{marks:a,points:0}}function Gl(a,l,m,f,d=()=>!1){let x=null,j=0;if(m==="BULL"||m==="INNER_BULL"||l===25||l===50)x=25,j=m==="INNER_BULL"||l===50?2:1;else if(typeof f=="number"&&f>=15&&f<=20)x=f,m==="TRIPLE"?j=3:m==="DOUBLE"?j=2:j=1;else if(l){const be=[20,19,18,17,16,15];for(const ue of be){if(l===ue){x=ue,j=1;break}if(l===ue*2){x=ue,j=2;break}if(l===ue*3){x=ue,j=3;break}}!x&&(l===25||l===50)&&(x=25,j=l===50?2:1)}if(!x)return 0;const Q=a.marks[x],Dt=Math.max(0,3-Q),De=Math.min(Dt,j),Z=Math.max(0,j-De),Me=Q+De;a.marks[x]=Me>3?3:Me;let _=0;return Z>0&&!d(x)&&(x===25?m==="INNER_BULL"?_+=50*Z:_+=25*Z:_+=x*Z),a.points+=_,_}function zl(a){return Dn.every(l=>(a.marks[l]||0)>=3)}function un(){return{round:1,score:0,finished:!1,shanghaiAchieved:!1,turnHits:{singles:0,doubles:0,triples:0}}}function Xl(a){return a.round}function Yl(a,l,m,f){if(a.finished)return 0;const d=Xl(a);let x=0;return typeof f=="number"&&f===d?m==="TRIPLE"?(x=d*3,a.turnHits.triples++):m==="DOUBLE"?(x=d*2,a.turnHits.doubles++):m==="SINGLE"&&(x=d*1,a.turnHits.singles++):!f&&(l===d||l===d*2||l===d*3)&&(l===d*3?(x=d*3,a.turnHits.triples++):l===d*2?(x=d*2,a.turnHits.doubles++):l===d&&(x=d,a.turnHits.singles++)),a.score+=x,x}function ql(a){if(!a.finished){if(a.turnHits.singles>0&&a.turnHits.doubles>0&&a.turnHits.triples>0){a.shanghaiAchieved=!0,a.finished=!0;return}const l=a.round+1;l>20?a.finished=!0:a.round=l}a.turnHits={singles:0,doubles:0,triples:0}}function xn(){return{stage:0,targets:[{kind:"NUMBER",num:20},{kind:"DOUBLE",num:16},{kind:"TRIPLE",num:14},{kind:"NUMBER",num:19},{kind:"BULL"},{kind:"ANY_NUMBER"}],score:0,finished:!1,hitThisRound:!1}}function Li(a){return a.targets[a.stage]||null}function Ql(a,l,m,f){if(a.finished)return 0;const d=Li(a);if(!d)return 0;let x=0;switch(d.kind){case"NUMBER":{typeof f=="number"&&f===d.num?m==="TRIPLE"?x=d.num*3:m==="DOUBLE"?x=d.num*2:m==="SINGLE"&&(x=d.num):!f&&(l===d.num||l===d.num*2||l===d.num*3)&&(x=l),x>0&&(a.hitThisRound=!0);break}case"DOUBLE":{(m==="DOUBLE"&&f===d.num||l===d.num*2)&&(x=d.num*2,a.hitThisRound=!0);break}case"TRIPLE":{(m==="TRIPLE"&&f===d.num||l===d.num*3)&&(x=d.num*3,a.hitThisRound=!0);break}case"BULL":{(m==="BULL"||m==="INNER_BULL"||l===25||l===50)&&(x=m==="INNER_BULL"||l===50?50:25,a.hitThisRound=!0);break}case"ANY_NUMBER":{l>0&&(x=l,a.hitThisRound=!0);break}}return a.score+=x,x}function Zl(a){a.finished||(a.hitThisRound||(a.score=Math.floor(a.score/2)),a.hitThisRound=!1,a.stage+=1,a.stage>=a.targets.length&&(a.finished=!0))}function hn(){return{round:1,score:0,target:"HIGH",finished:!1}}function Jl(a,l,m,f){if(a.finished)return 0;let d=0;if(a.target==="HIGH")if(m==="INNER_BULL")d=50;else if(typeof f=="number"){const j=f*(m==="TRIPLE"?3:m==="DOUBLE"?2:1);f>=20&&(d=j)}else l>=40&&(d=l);else if(typeof f=="number"){const j=f*(m==="TRIPLE"?3:m==="DOUBLE"?2:1);f<=10&&(d=j)}else l>0&&l<=30&&(d=l);return a.score+=d,d}function eo(a){if(!a.finished){if(a.round+=1,a.round>10){a.finished=!0;return}a.target=a.target==="HIGH"?"LOW":"HIGH"}}function to(a,l=3){return{number:a,lives:l,isKiller:!1,eliminated:!1}}function so(a){const l=Array.from({length:20},(f,d)=>d+1),m={};for(const f of a){const d=Math.floor(Math.random()*l.length),x=l.splice(d,1)[0];m[f]=x}return m}function fn(a,l,m,f){const d=l[a];if(!d||!f||!m)return{becameKiller:!1};if(!d.isKiller&&m==="DOUBLE"&&f===d.number)return d.isKiller=!0,{becameKiller:!0};if(d.isKiller&&m==="DOUBLE"&&f===d.number)return d.lives=Math.max(0,d.lives-1),d.lives===0&&(d.eliminated=!0),{becameKiller:!1,victimId:a,livesRemoved:1};if(d.isKiller&&(m==="DOUBLE"||m==="TRIPLE")){const x=Object.keys(l).find(j=>j!==a&&!l[j].eliminated&&l[j].number===f);if(x){const j=l[x],Q=m==="TRIPLE"?2:1;return j.lives=Math.max(0,j.lives-Q),j.lives===0&&(j.eliminated=!0),{becameKiller:!1,victimId:x,livesRemoved:Q}}}return{becameKiller:!1}}function bn(a){const l=Object.entries(a).filter(([,m])=>!m.eliminated&&m.lives>0);return l.length===1?l[0][0]:null}function Ci(){return{inning:1,score:0,dartsThisInning:0,finished:!1}}function ao(a,l,m,f){if(a.finished)return 0;let d=0;if(typeof f=="number"&&f===a.inning?m==="TRIPLE"?d=3:m==="DOUBLE"?d=2:d=1:!f&&(l===a.inning||l===a.inning*2||l===a.inning*3)&&(d=l===a.inning*3?3:l===a.inning*2?2:1),a.score+=d,a.dartsThisInning+=1,a.dartsThisInning>=3){const x=a.inning+1;x>9?a.finished=!0:(a.inning=x,a.dartsThisInning=0)}return d}const no={1:5,2:20,3:1,4:18,5:4,6:13,7:6,8:10,9:15,10:2,11:17,12:3,13:19,14:7,15:16,16:8,17:11,18:14};function Di(){return{hole:1,strokes:0,dartsThisHole:0,finished:!1}}function ro(a,l,m,f){if(a.finished)return!1;const d=no[a.hole];if(a.dartsThisHole+=1,typeof f=="number"&&f===d&&(m==="SINGLE"||m==="DOUBLE"||m==="TRIPLE")||!f&&(l===d||l===d*2||l===d*3)){a.strokes+=a.dartsThisHole;const j=a.hole+1;return j>18?a.finished=!0:(a.hole=j,a.dartsThisHole=0),!0}if(a.dartsThisHole>=3){a.strokes+=3;const j=a.hole+1;j>18?a.finished=!0:(a.hole=j,a.dartsThisHole=0)}return!1}const Ei={0:{type:"NUM",num:20},1:{type:"NUM",num:19},2:{type:"NUM",num:18},3:{type:"NUM",num:17},4:{type:"BULL"},5:{type:"NUM",num:16},6:{type:"NUM",num:15},7:{type:"NUM",num:14},8:{type:"NUM",num:13}};function Mi(){return{board:Array(9).fill(null),turn:"X",finished:!1,winner:null}}function io(a){const l=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[m,f,d]of l)if(a[m]&&a[m]===a[f]&&a[m]===a[d])return a[m];return a.every(m=>m)?"Draw":null}function lo(a,l,m,f,d){if(a.finished||a.board[l])return!1;const x=Ei[l];let j=!1;if(x.type==="BULL"?j=f==="BULL"||f==="INNER_BULL"||m===25||m===50:x.type==="NUM"&&typeof x.num=="number"&&(typeof d=="number"&&d===x.num||!d&&(m===x.num||m===x.num*2||m===x.num*3))&&(j=!0),!j)return!1;a.board[l]=a.turn;const Q=io(a.board);return Q?(a.finished=!0,a.winner=Q,!0):(a.turn=a.turn==="X"?"O":"X",!0)}function Nn(){return{targetIndex:0,darts:0,finished:!1}}const Ri=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25],pn=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","Bull"];function oo(a){return Ri[a.targetIndex]}function yn(a,l,m){if(a.finished)return a;const f=oo(a);if(!(m==="SINGLE"&&l===f||m==="DOUBLE"&&l===f||m==="TRIPLE"&&l===f||m==="INNER_BULL"&&f===25))return a;const x=a.targetIndex+1,j=x>=Ri.length;return{targetIndex:x,darts:a.darts+1,finished:j}}function gn(a,l){return yn(a,l,"SINGLE")}function co(){return Nn()}function wn(a=50){return{score:0,darts:0,finished:!1,target:a}}const mo=[5,10,15,20,25,50];function uo(a){return mo.includes(a)}function Sn(a,l,m){if(a.finished)return a;if(!uo(l))return{...a,darts:a.darts+1};const f=a.score+l,d=f>=a.target;return{score:d?a.target:f,darts:a.darts+1,finished:d,target:a.target}}function vn(a,l){return Sn(a,l)}function xo(a=50){return wn(a)}function kn(a=70){return{score:0,darts:0,finished:!1,target:a}}const ho=[7,14,21];function fo(a){return ho.includes(a)}function Cn(a,l,m){if(a.finished)return a;if(!fo(l))return{...a,darts:a.darts+1};const f=a.score+l,d=f>=a.target;return{score:d?a.target:f,darts:a.darts+1,finished:d,target:a.target}}function jn(a,l){return Cn(a,l)}function bo(a=70){return kn(a)}const Mn=[20,19,18,17,16,15,14,13,12,25];function Ai(){const a={};return Mn.forEach(l=>{a[l]=0}),{marks:a,points:0}}function po(a,l,m,f,d=()=>!1){let x=null,j=0;if(m==="BULL"||m==="INNER_BULL"||l===25||l===50)x=25,j=m==="INNER_BULL"||l===50?2:1;else if(typeof f=="number"&&f>=12&&f<=20)x=f,m==="TRIPLE"?j=3:m==="DOUBLE"?j=2:j=1;else if(l){for(const be of[20,19,18,17,16,15,14,13,12]){if(l===be){x=be,j=1;break}if(l===be*2){x=be,j=2;break}if(l===be*3){x=be,j=3;break}}!x&&(l===25||l===50)&&(x=25,j=l===50?2:1)}if(!x)return 0;const Q=a.marks[x],Dt=Math.max(0,3-Q),De=Math.min(Dt,j),Z=Math.max(0,j-De),Me=Q+De;a.marks[x]=Me>3?3:Me;let _=0;return Z>0&&!d(x)&&(x===25?m==="INNER_BULL"?_+=50*Z:_+=25*Z:_+=x*Z),a.points+=_,_}function go(a){return Mn.every(l=>(a.marks[l]||0)>=3)}function vo({left:a,right:l,className:m="",sticky:f=!0}){return e.jsxs("div",{className:`${f?"sticky top-0":""} card relative overflow-hidden flex items-center justify-between gap-2 mb-2 px-2 sm:px-3 py-2 rounded-xl bg-white/10 border border-white/10 z-10 backdrop-blur-sm ${m}`,children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-slate-900/30 via-slate-900/10 to-transparent"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm leading-none flex-wrap",children:[a," ðŸŽ¯"]}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:l})]})}function K(a){return(l,m)=>{a(l)}}function jo(a){const{match:l,commitManualVisitTotal:m,endTurn:f}=a;return{addVisit:(d,x=3,j)=>{if(m){m(d);return}try{l.addVisit(d,x,j)}catch{l.addVisit(d,x)}},undoVisit:()=>{l.undoVisit()},nextPlayer:()=>{if(f)try{f(0)}catch{l.nextPlayer()}else l.nextPlayer()},endLeg:d=>{typeof d=="number"?l.endLeg(d):l.endLeg(0)},endGame:()=>{l.endGame()}}}const Ti=n.memo(T),No=["Easy","Medium","Hardened"],yo=6500;function ye(a,l,m){return Math.max(l,Math.min(m,a))}function wo(a,l){let m=0;if(l==="Easy"){const f=[22,26,41,45,60];m=f[Math.floor(Math.random()*f.length)]}else l==="Medium"?m=Math.round(ye(60+(Math.random()*30-15),30,100)):m=Math.round(ye(80+(Math.random()*20-10),50,120));return a<=0?0:m>a?[100,85,81,60,57,45,41,26,22,20,1].find(d=>d<=a)??0:m}function So({onClose:a}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"card max-w-lg w-full relative",children:[e.jsx("button",{className:"absolute top-2 right-2 btn px-2 py-1",onClick:a,children:"Close âœ•"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"X01 Rules & Regulations ðŸ“–"}),e.jsxs("ul",{className:"list-disc pl-5 text-left mb-2",children:[e.jsx("li",{children:"Double In: Start scoring only after hitting a double."}),e.jsx("li",{children:"Double Out: Finish the game by hitting a double to reach exactly zero."}),e.jsx("li",{children:"Best Of: Play a set number of legs, winner is first to reach majority."}),e.jsx("li",{children:"First To: Play until a player reaches a set number of legs."}),e.jsx("li",{children:"No Cheating: All scores must be valid, no manual score changes mid-leg."}),e.jsx("li",{children:"Competitive Standard: Follow latest WDF/PDC rules for match play."})]}),e.jsx("p",{className:"text-sm text-slate-600",children:"For full details, see official darts governing body rules."})]})})}const ko=Vl();function Yo({user:a}){const{offlineLayout:l,favoriteDouble:m,callerEnabled:f,callerVoice:d,callerVolume:x,speakCheckoutOnly:j,rememberLastOffline:Q,setLastOffline:Dt,autoStartOffline:De,cameraScale:Z,setCameraScale:Me,cameraAspect:_="wide",setCameraAspect:be,cameraFitMode:ue="fill",setCameraFitMode:Ys,cameraEnabled:S,textSize:qs,boxSize:An,autoscoreProvider:Pi,autoCommitMode:Ii="wait-for-clear",matchType:Hi="singles",setMatchType:Bi,teamAName:Fi="Team A",setTeamAName:$i,teamBName:Ui="Team B",setTeamBName:Oi}=Pl(),Qs=Pi==="manual",L=S&&!Qs,Jt=S&&!Qs&&Ii!=="immediate",[r,Tn]=n.useState("X01"),[y,Ln]=n.useState(501),[M,Vi]=n.useState("None"),[Ki,En]=n.useState(!1),[$e,Je]=n.useState(!1),[B,re]=n.useState(y),[O,Mt]=n.useState(y),[Co,Rn]=n.useState(!1),[Pn,W]=n.useState(!1),[At,In]=n.useState(1),[I,es]=n.useState(0),H=Il(),[_i,Hn]=n.useState(!1),Bn=n.useRef(!1),[F,ts]=n.useState(0),[ss,G]=n.useState(null),[as,Fn]=n.useState(1),[ns,$n]=n.useState(1),[xe,Un]=n.useState([]),[On,Wi]=n.useState(2e3),Ue=Hl(),[Tt,Oe]=n.useState(!1),[Gi,Lt]=n.useState(!1),[Zs,Vn]=n.useState(!1),[Et,rs]=n.useState({player:!1,opponent:!1}),Ve=wt(t=>t.setPaused),we=wt(t=>t.paused),J=wt(t=>t.pauseEndsAt),[zi,Kn]=n.useState(!1),[et,Xi]=n.useState(Date.now());n.useEffect(()=>{if(!we||!J)return;const t=setInterval(()=>Xi(Date.now()),500);return()=>clearInterval(t)},[we,J]),n.useEffect(()=>{we&&J&&Date.now()>=J&&Ve(!1,null)},[we,J,et,Ve]),n.useEffect(()=>($e?document.documentElement.setAttribute("data-ndn-ingame","true"):document.documentElement.removeAttribute("data-ndn-ingame"),()=>{document.documentElement.removeAttribute("data-ndn-ingame")}),[$e]),n.useEffect(()=>{const t=()=>{Oe(!1),Je(!1),Lt(!1)};try{window.addEventListener("ndn:match-quit",t)}catch{}return()=>{try{window.removeEventListener("ndn:match-quit",t)}catch{}}},[]);const[Do,Yi]=n.useState(!0),[Rt,_n]=n.useState(!1);n.useEffect(()=>{Yi(!0),_n(!1)},[l]),n.useEffect(()=>{ue!=="fit"&&Ys("fit")},[ue,Ys]);const[is,Wn]=n.useState(1),[Mo,Gn]=n.useState(!1),[P,Pt]=n.useState(!0),[Ae,qi]=n.useState(()=>typeof window<"u"&&window.innerWidth<768),[It,tt]=n.useState(!1);n.useEffect(()=>{if(!It)return;const t=s=>{s.key==="Escape"&&tt(!1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[It]);const Js=n.useRef({startY:0,curY:0,active:!1}),zn=n.useRef(null),Qi=n.useCallback(t=>{Js.current={startY:t.clientY,curY:t.clientY,active:!0},zn.current?.setPointerCapture(t.pointerId)},[]),Zi=n.useCallback(t=>{const s=Js.current;s.active&&(s.curY=t.clientY)},[]),Xn=n.useCallback(()=>{const t=Js.current;if(!t.active)return;t.active=!1,t.curY-t.startY>70&&tt(!1)},[]);n.useEffect(()=>{if(typeof window>"u")return;const t=()=>qi(window.innerWidth<768);return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),n.useEffect(()=>{Ae||tt(!1)},[Ae]),n.useEffect(()=>{const t=()=>pt(!0);return window.addEventListener("ndn:open-camera-manager",t),()=>window.removeEventListener("ndn:open-camera-manager",t)},[]);const[D,w]=n.useState(0),[st,ea]=n.useState(0),[ls,ta]=n.useState(0),[pe,Yn]=n.useState(0),[sa,qn]=n.useState(0),[Te,aa]=n.useState(mn()),[Ke,os]=n.useState(un()),[Le,cs]=n.useState(xn()),[_e,ds]=n.useState(hn()),[Ao,ie]=n.useState(0),[na,Qn]=n.useState(1),[Zn,ra]=n.useState(27),[To,Jn]=n.useState(0),[er,ia]=n.useState(0),[tr,sr]=n.useState(!1),[ms,ar]=n.useState(1),[nr,rr]=n.useState(0),[Lo,ir]=n.useState(0),la=8,[us,lr]=n.useState(1),[or,cr]=n.useState(0),[Eo,dr]=n.useState(0),oa=10,[xs,mr]=n.useState(1),[ur,xr]=n.useState(0),[Ro,hr]=n.useState(0),ca=10,[hs,da]=n.useState(170),[ma,fr]=n.useState(0),[ua,br]=n.useState(0),[pr,gr]=n.useState(0),[fs,xa]=n.useState(121),[ha,vr]=n.useState(0),[fa,jr]=n.useState(0),[Nr,yr]=n.useState(0),[Se,ba]=n.useState(20),[bs,pa]=n.useState(0),[ga,va]=n.useState(0),[Ht,Ji]=n.useState(30),[wr,ja]=n.useState(!1),[Bt,Sr]=n.useState(Ci()),[Ft,kr]=n.useState(Di()),[Ee,Cr]=n.useState(Mi()),[at,Dr]=n.useState(Ai()),[C,Na]=n.useState([{id:"p1",name:"Player 1"},{id:"p2",name:"Player 2"}]),[We,nt]=n.useState({}),[$t,ya]=n.useState({}),[Mr,wa]=n.useState(!1),[$,Re]=n.useState(0),[el,Pe]=n.useState(0),[he,rt]=n.useState(null),[tl,z]=n.useState(""),[ps,Po]=n.useState(Nn()),[ge,it]=n.useState(Nn()),[Ut,Io]=n.useState(wn(50)),[X,lt]=n.useState(wn(50)),[Ot,Ho]=n.useState(kn(70)),[Y,ot]=n.useState(kn(70)),[gs,ct]=n.useState(0),[Ge,ze]=n.useState(0),[V,ee]=n.useState(0),[Sa,Vt]=n.useState(y),[ve,le]=n.useState(0),[dt,Ie]=n.useState(null),[vs,te]=n.useState(0),js=n.useRef(0),sl=n.useRef(0),oe=n.useRef(B),q=n.useRef(V),ce=n.useRef(ve),mt=n.useRef(Sa),de=n.useRef(vs);n.useEffect(()=>{oe.current=B},[B]),n.useEffect(()=>{q.current=V},[V]),n.useEffect(()=>{ce.current=ve},[ve]),n.useEffect(()=>{mt.current=Sa},[Sa]),n.useEffect(()=>{de.current=vs},[vs]);const[al,Kt]=n.useState(0);n.useRef(null);const[Ns,ka]=n.useState(0),[Xe,ys]=n.useState(0),[ut,Ye]=n.useState(0),[xt,ke]=n.useState(0),[ht,ft]=n.useState(null),[Ca,bt]=n.useState(0),[_t,Wt]=n.useState(0),[Da,ws]=n.useState(0),[Gt,Ar]=n.useState(0),[Ma,Tr]=n.useState(0),[zt,Xt]=n.useState(0),[Yt,Lr]=n.useState(0),[Aa,Ss]=n.useState(0),[Ta,Er]=n.useState(0),[Rr,ks]=n.useState(0),[nl,Cs]=n.useState(0),[rl,Ds]=n.useState(0),[Pr,La]=n.useState(0),[il,Ea]=n.useState(0),[ll,Ra]=n.useState(0),[ol,Ms]=n.useState(0),[cl,Ir]=n.useState(0),[As,Ts]=n.useState(null),[dl,He]=n.useState(!1),[ml,Pa]=n.useState(!1),[se,ae]=n.useState(""),[Bo,Fo]=n.useState(""),[$o,Uo]=n.useState(""),[Hr,Br]=n.useState(""),[Fr,Ia]=n.useState(""),[$r,Ha]=n.useState(""),[Ls,Ba]=n.useState(null),[ul,pt]=n.useState(!1),[xl,Ur]=n.useState({}),[Oo,Es]=n.useState(!1),qe=n.useRef(null),Fa=n.useRef(null),je=n.useCallback(()=>{const t=Fa.current;t&&(clearTimeout(t),Fa.current=null)},[]),hl=n.useCallback(t=>{if(t>0&&t<=60){const s=ji(t,m);Ts({remaining:t,routes:s}),He(!0)}else Ts(null),He(!1)},[m]),$a=n.useCallback(()=>{try{cn({type:"quit"})}catch{}Oe(!1),Je(!1),Lt(!1),Vn(!1),rs({player:!1,opponent:!1})},[]);n.useEffect(()=>{Zs&&Et.player&&Et.opponent&&$a()},[$a,Et,Zs]);const Or=n.useCallback(t=>{if(!f)return;const s=St(a,"Player");try{dn(s,t.visitTotal,Math.max(t.remaining,0),d,{volume:x,checkoutOnly:j})}catch{}},[f,d,x,j,a]),Vr=n.useCallback((t,s)=>{Es(!1);const{visitTotal:i,darts:o,preRemaining:c,remaining:b,doubleAttempts:p,finished:g,doubleWindow:h,highestCheckout:u}=t;g?(re(0),oe.current=0,typeof u=="number"&&u>0&&Ms(v=>Math.max(v,u))):(re(b),oe.current=b),Ie(i),i===180?ks(v=>v+1):i>=140?Cs(v=>v+1):i>=100&&Ds(v=>v+1),h&&p>0&&(Wt(v=>v+p),g&&ws(v=>v+1)),t.announced||Or(t);try{Xs.getState().recordVisit("offline-x01",o,i,{preRemaining:c,postRemaining:g?0:b,finish:g,bust:!1})}catch{}try{H.addVisit(i,o,{visitTotal:i}),g&&H.endLeg(c)}catch{}g&&(G("player"),W(!0)),Qt(g?0:b),le(0),ce.current=0,ee(0),q.current=0,te(0),de.current=0},[Qt,Ms,G,re,Ie,le,ee,te,W,ks,Cs,Ds,Wt,ws,Or]),gt=n.useCallback(t=>{const s=qe.current;s&&(qe.current=null,je(),Vr(s,t))},[je,Vr]);n.useCallback(t=>{qe.current={...t,announced:!1},Es(!0),je(),Fa.current=setTimeout(()=>gt("timeout"),yo)},[je,gt]),n.useEffect(()=>{if(!Jt)return;const t=()=>gt("event");return window.addEventListener("ndn:darts-cleared",t),()=>window.removeEventListener("ndn:darts-cleared",t)},[Jt,gt]),n.useEffect(()=>{Jt||gt("timeout")},[Jt,gt]),n.useEffect(()=>()=>je(),[je]),n.useEffect(()=>{if(V===0){try{window.dispatchEvent(new CustomEvent("ndn:darts-cleared",{detail:{source:"offline-play",ts:Date.now()}}))}catch{}js.current=0}sl.current=V},[V]);const Ce=St(a,"Player 1"),Qe=M==="None"?"Player 2":M,fl=P?Ce:Qe,bl=P?I:F,pl=P?F:I,Rs=Ze("X01",B,O,I,F,Ge,Xe,ve,ut,dt,ht,V,xt,Da,_t,Ma,Gt,xe,P,M,y),Kr=Ze("Cricket",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Te),Ua=Ze("Shanghai",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,P,M,void 0,Te,Ke),Oa=Ze("Killer",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,C,We,$t,$),Va=Ze("Scam"),Ka=Ze("Fives"),_a=Ze("Sevens"),_r=n.useMemo(()=>{switch(r){case"Cricket":return Kr;case"Shanghai":return Ua;case"Killer":return Oa;case"Scam":return Va;case"Fives":return Ka;case"Sevens":return _a;default:return Rs}},[r,Kr,Ua,Oa,Va,Ka,_a,Rs]),Wa=r==="X01"?`${I}-${F}`:void 0,Ps=n.useMemo(()=>{const t=Rs||[],s=V>0?ve:dt??Ge,i=xt>0?ut:ht??Xe;return t.length===0?{name:P?Ce:Qe,isCurrentTurn:!0,legsWon:P?I:F,score:P?B:O,lastScore:P?s:i}:t.find(o=>o.isCurrentTurn)??t[0]},[Rs,P,Ce,Qe,I,F,B,O,V,ve,dt,Ge,ut,ht,Xe,xt]),Ga=n.useMemo(()=>{if(!Ps)return[];const{matchAvg:t,allTimeAvg:s,...i}=Ps;return[{...i,matchAvg:void 0,allTimeAvg:void 0}]},[Ps]),gl=P?Qe:Ce,vl=Ps?.name??(P?Ce:Qe),Is=P?B:O,Wr=P?V>0?ve:dt??Ge:xt>0?ut:ht??Xe,Hs=H.players?.[H.currentPlayerIdx];let Gr=0,zr=0;if(Hs&&Hs.legs&&Hs.legs.length>0){for(const t of Hs.legs)if(Array.isArray(t.visits))for(const s of t.visits)Gr+=s.score||0,zr+=s.darts||0}const jl=Gr+(ve||0),Xr=zr+(V||0),Yr=Xr>0?jl/Xr*3:0,Be=n.useCallback(t=>Math.max(0,Math.min(99,Math.round(t||0))).toString(),[]),A=n.useCallback((t,s=1)=>{!t||s<=0||Ur(i=>({...i,[t]:(i[t]||0)+s}))},[]),R=n.useCallback(t=>{t&&Ur(s=>s[t]===void 0?s:{...s,[t]:0})},[]);xl[r];const Nl=t=>{if(!t.trim())return null;const s=Number(t);return Number.isFinite(s)?ye(Math.round(s),0,y):null},yl=t=>{if(!t.trim())return null;const s=Number(t);return Number.isFinite(s)?Math.max(0,Math.round(s)):null},qr=n.useCallback(()=>{qe.current&&(qe.current=null),je(),Es(!1)},[je]);n.useCallback(t=>{const s=ye(t,0,y);qr(),re(s),oe.current=s;const i=s===0?y:s;Vt(i),mt.current=i,le(0),ce.current=0,ee(0),q.current=0,te(0),de.current=0,Ie(null),ze(0),w(0),js.current=0,s===0?(G("player"),W(!0)):(G(null),W(!1))},[qr,re,y,Vt,le,ee,te,Ie,ze,w,G,W]);const Qr=t=>{const i=Nl(Hr);if(i===null){Ue(`Enter a number between 0 and ${y}`,{type:"error",timeout:2500});return}Mt(i),Ye(0),ke(0),ft(null),bt(0),ys(0),Br(""),G(null),W(!1)},Zr=n.useCallback((t,s)=>{t==="player"?(es(s),Ia("")):(ts(s),Ha("")),G(null),W(!1)},[ts,Ha,Ia,G,es,W]),Bs=t=>{const i=yl(t==="player"?Fr:$r);if(i===null){Ue("Enter a non-negative whole number for legs",{type:"error",timeout:2500});return}Ba({target:t,value:i,stage:1})},wl=n.useCallback(()=>{Ba(t=>t&&(t.stage===1?{...t,stage:2}:(Zr(t.target,t.value),null)))},[Zr]),qt=n.useCallback(()=>{Ba(null)},[]);n.useEffect(()=>{if(!Ls)return;const t=s=>{s.key==="Escape"&&(s.preventDefault(),qt())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[qt,Ls]);const Fe=(t=>{switch(t){case"small":return"px-1.5 py-0.5 text-xs";case"large":return"px-3 py-1 text-sm";default:return"px-2 py-0.5 text-sm"}})(qs),vt=n.useRef(null),jt=n.useRef(null),za=n.useRef(null),[Nt,Xa]=n.useState("first"),[Fs,Jr]=n.useState(1),Sl=n.useRef(null);n.useEffect(()=>{const t=Math.max(1,Math.floor(Number(Fs)||1)),s=Nt==="first"?t:Math.max(1,Math.ceil(t/2));In(s)},[Nt,Fs]),n.useEffect(()=>{if(!Rt){Wn(1),Gn(!1);return}const t=()=>{const o=vt.current,c=jt.current;if(!o||!c)return;const b=za.current?za.current.getBoundingClientRect().height:0,p=Math.max(0,o.clientHeight-b-6),g=Math.max(0,o.clientWidth-8),h=c.getBoundingClientRect(),u=is||1,v=h.height/u,N=h.width/u,E=p>0?p/v:1,k=g>0?g/N:1,zs=Math.min(1,Math.max(.5,Math.min(E,k))),fe=v*zs,Rl=p>0&&fe-p>1;Gn(Rl),Wn(zs)};t();const s=window.ResizeObserver,i=s?new s(()=>t()):null;return i&&vt.current&&i.observe(vt.current),i&&jt.current&&i.observe(jt.current),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t);try{i&&vt.current&&i.unobserve(vt.current)}catch{}try{i&&jt.current&&i.unobserve(jt.current)}catch{}}},[Rt,is]),n.useEffect(()=>{const t=s=>{const i=s?.detail?.mode;i&&(Tn(i),yt())};return window.addEventListener("ndn:auto-start",t),()=>window.removeEventListener("ndn:auto-start",t)},[]),n.useEffect(()=>{const t=s=>{const i=s?.detail?.formatType,o=s?.detail?.formatCount,c=s?.detail?.startScore;(i==="first"||i==="best")&&Xa(i),typeof o=="number"&&isFinite(o)&&Jr(Math.max(1,Math.floor(o))),typeof c=="number"&&isFinite(c)&&Ln(Math.max(1,Math.floor(c)))};return window.addEventListener("ndn:offline-format",t),()=>window.removeEventListener("ndn:offline-format",t)},[]),n.useEffect(()=>{if(!De)return;const t=setTimeout(()=>yt(),50);return()=>clearTimeout(t)},[De]),n.useEffect(()=>{if(!Tt||P||M==="None"||al<=0)return;let t,s=performance.now();const i=o=>{const c=o-s;s=o,Kt(b=>{const p=b-c;if(p<=0){let g=0,h=0,u=O;for(ke(0);g<3&&u>0;){const v=wo(u,M),N=ye(v-g*20,0,Math.min(60,u)),E=u-N;if(ys(N),ka(fe=>fe+1),Lr(fe=>fe+1),E<0){u=O,Ye(0),bt(0),h=0,ft(0),ke(0);break}h+=N,Ye(fe=>fe+N),Er(fe=>fe+N);const k=u,zs=E;if(k>50&&zs<=50?bt(1):k<=50&&bt(fe=>fe+1),u=E,g+=1,ke(g),u===0)break}if(Mt(u),u===0){h===180?La(N=>N+1):h>=140?Ea(N=>N+1):h>=100&&Ra(N=>N+1);const v=O;v<=170&&Ir(N=>Math.max(N,v)),O<=50&&(Ar(N=>N+(Ca>0?Ca:1)),Tr(N=>N+1)),ft(h),Ye(0),bt(0),ke(0),G("ai"),W(!0)}return u>0&&g>=3&&(h===180?La(v=>v+1):h>=140?Ea(v=>v+1):h>=100&&Ra(v=>v+1),ft(h),Ye(0),bt(0),ke(0)),ke(0),Pt(!0),0}return p}),t=requestAnimationFrame(i)};return t=requestAnimationFrame(i),()=>cancelAnimationFrame(t)},[Tt,P,M,O]),n.useEffect(()=>{H.inProgress&&(Bn.current||(Hn(!0),Bn.current=!0))},[H.inProgress]);function yt(){Je(!0),re(y),oe.current=y,Mt(y),Rn(!1),Oe(!0),Pt(!0),w(0),ct(0),ze(0),ee(0),q.current=0,Vt(y),le(0),Ie(null),te(0),Kt(0),ka(0),ys(0),Ye(0),ke(0),ft(null),G(null),es(0),ts(0),Un([]),pa(0),va(0),ja(!1),Xt(0),Lr(0),Ss(0),Er(0),ks(0),Cs(0),Ds(0),La(0),Ea(0),Ra(0),Ms(0),Ir(0),Wt(0),ws(0),Ar(0),Tr(0),R("X01");const t=Math.max(1,Math.floor(Number(Fs)||1));if(In(Nt==="first"?t:Math.max(1,Math.ceil(t/2))),Q)try{Dt({mode:r,x01Start:y,firstTo:At,aiLevel:M})}catch{}const s=St(a,"You"),i=M!=="None"?`AI (${M})`:"Opponent",o=[s,i];H.newMatch(o,y,`offline-${Date.now()}`);try{const c=document.documentElement;c?.requestFullscreen?c.requestFullscreen():document.body?.requestFullscreen&&document.body.requestFullscreen()}catch{}}function kl(){re(y),oe.current=y,Mt(y),Rn(!1),Ts(null),He(!1),Oe(!0),Pt(!0),w(0),ct(0),ze(0),ee(0),q.current=0,Vt(y),le(0),mt.current=y,ce.current=0,Ie(null),te(0),de.current=0,de.current=0,Kt(0),ka(0),ys(0),Ye(0),ke(0),ft(null),G(null)}function Qt(t){hl(t),ee(0),q.current=0,Vt(t===0?y:t),mt.current=t===0?y:t,te(0),de.current=0,M!=="None"?(Pt(!1),Kt(On)):(Kt(0),Pt(!0))}function U(t){if(!Number.isFinite(t))return!1;const s=mt.current,i=oe.current,o=q.current,c=ce.current,b=o>0||c>0;b&&(re(s),oe.current=s,ee(0),q.current=0,le(0),ce.current=0,te(0),de.current=0,ze(0),w(0),ct(k=>Math.max(0,k-o)),Xt(k=>Math.max(0,k-o)),Ss(k=>Math.max(0,k-c)),js.current=0);const p=b?s:i,g=p<=170?170:180,h=ye(Math.round(t),0,g),u=p-h,v=ye(Math.round(ns||0),0,3),N=ye(Math.round(as||0),0,3),E=u===0?v:3;if(A("X01",E),ct(k=>k+E),Xt(k=>k+E),ee(E),q.current=E,le(h),ce.current=h,Ie(h),h===180?ks(k=>k+1):h>=140?Cs(k=>k+1):h>=100&&Ds(k=>k+1),u<0){if(f)try{dn(Ce,0,Math.max(s,0),d,{volume:x,checkoutOnly:j})}catch{}try{Xs.getState().recordVisit("offline-x01",E,0,{preRemaining:p,postRemaining:s,bust:!0,finish:!1})}catch{}re(s),oe.current=s,Ie(0),le(0),ce.current=0,ee(0),q.current=0,te(0),de.current=0;try{H.addVisit(0,E)}catch{}return Qt(s),!0}if(re(u),oe.current=u,Ss(k=>k+h),f)try{dn(Ce,h,Math.max(u,0),d,{volume:x,checkoutOnly:j})}catch{}if(u===0?(Wt(k=>k+N),ws(k=>k+1),te(N),de.current=N):p<=50&&Wt(k=>k+3),u===0){p<=170&&Ms(k=>Math.max(k,p)),Ts(null),He(!1);try{Xs.getState().recordVisit("offline-x01",E,h,{preRemaining:p,postRemaining:0,finish:!0,bust:!1})}catch{}try{H.addVisit(h,E),H.endLeg(p)}catch{}return G("player"),W(!0),ee(0),q.current=0,le(0),ce.current=0,te(0),de.current=0,!0}try{Xs.getState().recordVisit("offline-x01",E,h,{preRemaining:p,postRemaining:u,finish:!1,bust:!1})}catch{}try{H.addVisit(h,E)}catch{}return Qt(u),le(0),ce.current=0,ee(0),q.current=0,te(0),de.current=0,!0}const ne=jo({match:H,commitManualVisitTotal:U,endTurn:Qt}),[Ya,ei]=n.useState(""),[qa,Qa]=n.useState(""),ti=n.useRef(null),si=t=>{ei(t)},Za=()=>{const t=parseInt(Ya,10);if(isNaN(t)||t<0||t>180){alert("Enter a number 0-180 for visit total");return}if(t>180){alert("Enter a number 0-180 for visit total");return}const s=oe.current<=170?170:180,i=ye(Math.round(t),0,s);t>s&&Ue(`Visit totals cannot exceed ${s}.`,{type:"info",timeout:2200}),U(i)&&ei("")},ai=n.useCallback(()=>{qe.current&&(qe.current=null,je(),Es(!1));const t=q.current,s=ce.current,i=mt.current;t===0&&s===0||(re(i),oe.current=i,ee(0),q.current=0,le(0),ce.current=0,te(0),de.current=0,ze(0),w(0),ct(o=>Math.max(0,o-t)),Xt(o=>Math.max(0,o-t)),Ss(o=>Math.max(0,o-s)),js.current=0)},[je]);n.useEffect(()=>{const t=s=>{const i=s?.detail;!i||i?.source==="offline-play"||ai()};return window.addEventListener("ndn:clear-visit-request",t),()=>window.removeEventListener("ndn:clear-visit-request",t)},[ai]);function Ja(t){A("Double Practice");const s=ye(Math.round(t||0),0,60);if(ze(s),ct(i=>i+1),Xt(i=>i+1),ki(s,st)){const i=ls+1;ta(i),ea(o=>Math.min(20,o+1)),i>=21&&(G("player"),W(!0))}w(0)}function ni(){Ja(Number(D))}function ri(){const t=Zt(se);if(t==null){alert("Enter like D16, 50, 25, T20");return}Ja(t),ae("")}function en(t,s,i){if(tr)return!1;A("Bob's 27");const o=na,c=s==="DOUBLE"&&i===o||!s&&t===o*2;return c&&ia(b=>b+1),Jn(b=>{const p=b+1;if(p>=3){const g=er+(c?1:0);g>0?ra(u=>u+g*o*2):ra(u=>u-o*2);const h=o+1;return Qn(h),ia(0),h>20&&sr(!0),0}return p}),!0}function ii(){en(Math.max(0,D|0)),w(0)}function li(){Qn(1),ra(27),Jn(0),ia(0),sr(!1),R("Bob's 27")}function $s(t){return A("Count-Up"),rr(s=>s+Math.max(0,t|0)),ir(s=>{const i=s+1;return i>=3?(ar(o=>o+1),0):i}),!0}function Us(t){return A("High Score"),cr(s=>s+Math.max(0,t|0)),dr(s=>{const i=s+1;return i>=3?(lr(o=>o+1),0):i}),!0}function Os(t){return A("Low Score"),xr(s=>s+Math.max(0,t|0)),hr(s=>{const i=s+1;return i>=3?(mr(o=>o+1),0):i}),!0}function oi(t,s,i,o,c,b,p,g,h=1){const u=t-p;if(!(u<0))if(u===0){if(g==="DOUBLE"||g==="INNER_BULL"){b(v=>v+1),c(v=>v+1),o(()=>0),s(t);return}s(u)}else s(u);o(v=>{const N=v+h;return N>=3?(c(E=>E+1),N%3):N})}function tn(t,s,i=1){return A("Checkout 170"),oi(hs,da,ma,fr,br,gr,t,s,i),ma+1>=3&&da(170),!0}function sn(t,s,i=1){return A("Checkout 121"),oi(fs,xa,ha,vr,jr,yr,t,s,i),ha+1>=3&&xa(121),!0}function Vs(t){const s=Zt(se);if(s==null){alert("Enter like T20, D16, 25, 50");return}const i=se.trim().toUpperCase(),o=i.startsWith("D")||i==="50"||i==="BULL"||i==="DBULL"||i==="IBULL"||i.includes("INNER");t?tn(s,o?"DOUBLE":void 0):sn(s,o?"DOUBLE":void 0),ae("")}function Cl(){da(170),fr(0),br(0),gr(0),R("Checkout 170")}function Dl(){xa(121),vr(0),jr(0),yr(0),R("Checkout 121")}function Ks(t,s,i){return wr?!1:(A("Treble Practice"),(s==="TRIPLE"&&i===Se||!s&&t===Se*3)&&pa(c=>c+1),va(c=>{const b=c+1;if(b%3===0&&[20,19,18].includes(Se)){const p=["T20","T19","T18"],g=p.indexOf(`T${Se}`),h=p[(g+1)%p.length];ba(Number(h.replace("T","")))}return Ht>0&&b>=Ht&&ja(!0),b}),!0)}function ci(){pa(0),va(0),ja(!1),R("Treble Practice")}function di(t,s,i){return A("Baseball"),Sr(o=>{const c={...o};return ao(c,t,s,i),c}),!0}function Ml(){Sr(Ci()),R("Baseball")}function mi(t,s,i){return A("Golf"),kr(o=>{const c={...o};return ro(c,t,s,i),c}),!0}function Al(){kr(Di()),R("Golf")}function Tl(t,s,i,o){return A("Tic Tac Toe"),Cr(c=>{const b={...c,board:[...c.board]};return lo(b,t,s,i,o),b}),!0}function Ll(){Cr(Mi()),R("Tic Tac Toe")}function ui(t,s,i){return A("American Cricket"),Dr(o=>{const c={...o,marks:{...o.marks}};return po(c,t,s,i,()=>!1),c}),!0}function xi(){Dr(Ai()),R("American Cricket")}function _s(t,s,i){A("Around the Clock");const o=me[pe];let c=!1;if(typeof i=="number"&&i===o&&(s==="SINGLE"||s==="DOUBLE"||s==="TRIPLE")&&(c=!0),o===25&&(s==="BULL"||t===25)&&(c=!0),o===50&&(s==="INNER_BULL"||t===50)&&(c=!0),c||(t===o||t===o*2||t===o*3)&&(c=!0),c){const b=sa+1;return qn(b),Yn(p=>p+1),!0}return!0}function hi(){_s(Math.max(0,D|0)),w(0)}function fi(){const t=Zt(se);if(t==null){alert("Enter like T20, D5, 25, 50");return}_s(t),ae("")}function Ws(t,s,i){return A("Cricket"),aa(o=>{const c={...o,marks:{...o.marks}};return Gl(c,t,s,i,()=>!1),c}),ie(o=>{const c=o+1;return c>=3?0:c}),!0}function bi(){Ws(Math.max(0,D|0)),w(0)}function Gs(t,s,i){return A("Shanghai"),os(o=>{const c={...o,turnHits:{...o.turnHits}};return Yl(c,t,s,i),c}),ie(o=>{const c=o+1;return c>=3?(os(b=>{const p={...b,turnHits:{...b.turnHits}};return ql(p),p}),0):c}),!0}function pi(){Gs(Math.max(0,D|0)),w(0)}function an(t,s,i){return A("Halve It"),cs(o=>{const c={...o,targets:[...o.targets]};return Ql(c,t,s,i),c}),ie(o=>{const c=o+1;return c>=3?(cs(b=>{const p={...b,targets:[...b.targets]};return Zl(p),p}),0):c}),!0}function gi(){an(Math.max(0,D|0)),w(0)}function nn(t,s,i){return A("High-Low"),ds(o=>{const c={...o};return Jl(c,t,s,i),c}),ie(o=>{const c=o+1;return c>=3?(ds(b=>{const p={...b};return eo(p),p}),0):c}),!0}function vi(){nn(Math.max(0,D|0)),w(0)}function El(){const t=ss??"player",s=t==="player"?vs||void 0:Ca||void 0,i=1,o=t==="player"?gs:Ns;Un([...xe,{winner:t,doubleDarts:as,checkoutDarts:ns,winnerDarts:o,doublesAtt:s,doublesHit:i}]),W(!1);let c=I,b=F;if(ss==="player"?c+=1:ss==="ai"&&(b+=1),es(c),ts(b),G(null),c>=At||b>=At){try{_l(r,t==="player")}catch{}try{H.endGame()}catch{}Oe(!1),Je(!1),re(y),Mt(y),Pa(!0);return}kl()}const rn=!["Killer","Tic Tac Toe"].includes(r);n.useEffect(()=>{Ae||!rn||!Tt||ti.current?.focus()},[Ae,rn,Tt,r]);const ln=()=>{const t=Number(qa);if(!Number.isFinite(t))return;const s=Math.max(0,Math.round(t));switch(r){case"Double Practice":Ja(s);break;case"Around the Clock":_s(s);break;case"Cricket":Ws(s);break;case"Shanghai":Gs(s);break;case"Halve It":an(s);break;case"High-Low":nn(s);break;case"Bob's 27":en(s);break;case"Count-Up":$s(s);break;case"High Score":Us(s);break;case"Low Score":Os(s);break;case"Checkout 170":tn(s,void 0,3);break;case"Checkout 121":sn(s,void 0,3);break;case"Treble Practice":Ks(s);break;case"Baseball":di(s);break;case"Golf":mi(s);break;case"American Cricket":ui(s);break;case"Scam":A("Scam"),it(gn(ge,s));break;case"Fives":A("Fives"),lt(vn(X,s));break;case"Sevens":A("Sevens"),ot(jn(Y,s));break;default:return}Qa("")},on=!yi.includes(r)&&!(a?.fullAccess||a?.admin);return e.jsxs("div",{className:`${$e?"":"card "}ndn-game-shell ndn-page relative overflow-hidden md:overflow-hidden overflow-y-auto${$e?" ndn-ingame-active":""}`,children:[_i&&e.jsx(Bl,{players:H.players||[],user:a,onDone:()=>Hn(!1)}),!$e&&e.jsxs("h2",{className:"text-3xl font-bold text-brand-700 mb-4 ndn-section-title",children:["Offline Mode ðŸŽ¯"," ",l==="classic"?e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-white/10 border border-white/10 align-middle",children:"Classic layout"}):e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 align-middle",children:"Modern layout"})]}),e.jsxs("div",{className:"ndn-shell-body",children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:r,onChange:t=>Tn(t.target.value),children:[yi.map(t=>e.jsx("option",{value:t,children:t},t)),Fl.map(t=>e.jsxs("option",{value:t,disabled:!(a?.fullAccess||a?.admin),children:[t," ",a?.fullAccess||a?.admin?"":"(Premium)"]},t))]}),r==="Treble Practice"?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsx("label",{className:"font-semibold",children:"Throws per game"}),e.jsx("input",{className:"input w-full",type:"number",min:3,step:3,value:Ht,onChange:t=>Ji(Math.max(3,Math.floor(Number(t.target.value)||30)))})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-slate-300",children:"Target cycles T20â†’T19â†’T18 every 3 darts. Game ends after the selected number of throws."})]}):null,!a?.fullAccess&&e.jsxs("div",{className:"mt-2 p-2 rounded-lg bg-slate-800/40 border border-slate-700/40 text-slate-200 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”’"}),e.jsx("span",{children:"Only X01 and Double Practice are free. Advanced modes (Killer, Cricket, Shanghai, etc.) require PREMIUM."})]}),r==="X01"&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-semibold mt-2",children:"Enter starting score (1-1001):"}),e.jsx("input",{className:"input w-full",type:"number",min:1,max:1001,value:y,onChange:t=>Ln(Number(t.target.value))}),e.jsx("label",{className:"font-semibold mt-2",children:"Play against AI bot?"}),e.jsxs("select",{onPointerDown:t=>{t.stopPropagation()},onMouseDown:t=>{t.stopPropagation()},onTouchStart:t=>{t.stopPropagation?.()},className:"input w-full",value:M,onChange:t=>Vi(t.target.value),children:[e.jsx("option",{value:"None",children:"None"}),No.map(t=>e.jsx("option",{value:t,children:t},t))]}),M!=="None"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 items-end mt-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"font-semibold",children:"AI throw delay (seconds)"}),e.jsx("input",{className:"input w-full",type:"number",min:.5,max:10,step:.5,value:On/1e3,onChange:t=>Wi(Math.round(Number(t.target.value)*1e3))})]}),e.jsx("div",{className:"text-sm text-slate-300",children:"Controls how long the AI waits before its visit."})]}),e.jsx("button",{className:"btn mt-2",onClick:()=>En(!0),children:"X01 Rules & Regulations! ðŸ“–"})]}),r==="Double Practice"&&e.jsx("div",{className:"mt-2 text-brand-600",children:"Hit doubles D1 â†’ D20 â†’ DBULL in as few darts as possible. AI and X01 settings don't apply."})]}),!$e&&e.jsx("button",{className:"btn",disabled:on,title:on?"PREMIUM required for this mode":"",onClick:yt,children:"Start Match ðŸš€"}),Tt&&e.jsx("div",{className:"absolute inset-0 z-[1000]",children:e.jsxs(kt,{storageKey:"ndn:modal:offline-match",className:"w-full h-full ndn-modal-tight relative flex flex-col overflow-hidden",fullScreen:!0,defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:[we&&J&&(()=>{const t=Math.max(0,J-et),s=Math.floor(t/6e4).toString().padStart(2,"0"),i=Math.floor(t%6e4/1e3).toString().padStart(2,"0"),o=wt.getState().pauseStartedAt??et,c=Math.max(1,J-o),b=Math.max(0,Math.min(100,Math.round((1-t/c)*100)));return e.jsx("div",{className:"absolute inset-0 z-[200] backdrop-blur-sm bg-black/60 flex items-center justify-center pointer-events-auto",children:e.jsx("div",{className:"rounded-3xl border border-amber-400/30 bg-slate-900/95 p-8 text-white shadow-2xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-amber-500/20 text-3xl",children:"â¸"}),e.jsx("div",{className:"text-lg font-bold text-amber-100",children:"Match Paused"}),e.jsxs("div",{className:"text-4xl font-extrabold tabular-nums tracking-wider text-amber-100",children:[s,":",i]}),e.jsx("div",{className:"w-full h-2 rounded-full bg-white/10 overflow-hidden",children:e.jsx("div",{className:"h-2 rounded-full bg-amber-400 transition-all duration-500",style:{width:`${b}%`}})}),e.jsx("div",{className:"text-xs text-amber-200/60",children:"Resuming automatically when timer expires"}),e.jsx("button",{type:"button",className:"btn bg-emerald-600 hover:bg-emerald-700 px-6 py-2 text-sm font-semibold",onClick:()=>Ve(!1,null),children:"â–¶ Resume Match"})]})})})})(),e.jsx("div",{className:"h-full min-h-0 flex flex-col",children:e.jsxs("div",{className:"min-h-0 overflow-x-hidden pt-2 pb-2 pr-0 -ml-2 sm:-ml-3",style:{overflowY:"auto",willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch",contain:"layout style"},ref:t=>{vt.current=t},children:[e.jsx("div",{ref:t=>{za.current=t},children:e.jsx(vo,{className:"w-full",left:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden xs:inline px-2 py-0.5 rounded-full bg-indigo-500/20 text-indigo-200 border border-indigo-400/30 text-[10px] sm:text-xs",children:"Game Mode"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[r,r==="X01"?` / ${y}`:""]}),e.jsxs("span",{className:"opacity-80 whitespace-nowrap",children:["First to ",At," Â· Legs ",I,"-",F]}),e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full border text-[10px] sm:text-xs ${l==="modern"?"bg-emerald-500/15 text-emerald-200 border-emerald-400/30":"bg-white/10 text-white/70 border-white/20"}`,children:l==="modern"?"Modern layout":"Classic layout"})]}),right:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{try{Oe(!1),Je(!1)}catch{}try{wt.getState().setPaused(!1,null)}catch{}},title:"Return to Offline setup",children:"Return"}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",title:Rt?"Actual Size":"Fit All",onClick:()=>_n(t=>!t),children:Rt?"Actual Size":"Fit All"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{yt()},children:"Restart"}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 px-3 py-1 text-sm",onClick:()=>Lt(!0),children:"Quit"})]})})}),Gi&&e.jsx($l,{onClose:()=>Lt(!1),onQuit:()=>{$a()},onPause:t=>{const s=Date.now()+t*60*1e3;try{Ve(!0,s),cn({type:"pause",pauseEndsAt:s,pauseStartedAt:Date.now()})}catch{}Lt(!1)}}),Zs&&e.jsx("div",{className:"fixed inset-0 z-[170] flex items-center justify-center bg-black/70 p-4",children:e.jsxs(kt,{storageKey:"ndn:modal:offline-quit-confirm",className:"w-full relative",defaultWidth:460,defaultHeight:320,minWidth:360,minHeight:260,maxWidth:720,maxHeight:520,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Confirm Quit (Both Players)"}),e.jsx("p",{className:"text-sm text-slate-200 mb-4",children:"Both players must accept to end the match. If either player wants to continue, the match will keep going."}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("button",{className:`btn w-full ${Et.player?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>rs(t=>({...t,player:!0})),children:[St(a,"Player 1")," Accepts"]}),e.jsxs("button",{className:`btn w-full ${Et.opponent?"bg-emerald-600 hover:bg-emerald-700":"bg-slate-700 hover:bg-slate-800"}`,onClick:()=>rs(t=>({...t,opponent:!0})),children:[M==="None"?"Opponent":`${M} AI`," Accepts"]}),e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 w-full",onClick:()=>{rs({player:!1,opponent:!1}),Vn(!1)},children:"Continue Match"})]})]})}),r==="X01"&&dl&&As&&e.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center bg-black/70 p-4",onClick:()=>He(!1),children:e.jsxs("div",{className:"w-full max-w-xl rounded-3xl border border-emerald-400/40 bg-slate-900/95 p-4 text-white shadow-2xl",onClick:t=>t.stopPropagation(),onKeyDown:t=>{(t.key==="Enter"||t.key==="Escape")&&(t.preventDefault(),He(!1))},tabIndex:-1,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-emerald-200/70",children:"Checkout box"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-100",children:[As.remaining," left"]})]}),e.jsx("button",{className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>He(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${as===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Fn(t),children:Be(t)},`double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ns===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>$n(t),children:Be(t)},`checkout-${t}`))})]}),As.routes.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-emerald-200/80 mb-1",children:"Suggested checkout"}),e.jsx("div",{className:"space-y-1",children:As.routes.map(t=>e.jsx("div",{className:"rounded-lg border border-emerald-400/30 bg-emerald-500/10 px-3 py-2 text-sm font-semibold",children:t},t))})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-4 py-1 text-sm",onClick:()=>He(!1),children:"Enter"})})]})]})}),e.jsxs("div",{ref:t=>{jt.current=t},className:"will-change-transform",style:Rt?{transform:`scale(${is})`,transformOrigin:"top left",width:"100%",fontSize:`${Math.max(.8,Math.min(1,is))}em`}:void 0,children:[e.jsx("h3",{className:"text-xl font-bold mb-2 mt-1 leading-tight",children:r==="X01"?"X01 Match âš”ï¸":`${r} âš”ï¸`}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Mode: ",r]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Start: ",y]}),e.jsxs("div",{ref:Sl,className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[e.jsx("span",{children:"Format:"}),(()=>{const t=B!==y||O!==y||V>0,s=`pill ${t?"opacity-50 cursor-not-allowed":"cursor-pointer"} `;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",className:`${s} ${Nt==="first"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Xa("first")},title:"First to N",children:"First to"}),e.jsx("button",{type:"button",className:`${s} ${Nt==="best"?"pill--filled":"pill--ghost"}`,onClick:()=>{t||Xa("best")},title:"Best of N (wins = ceil(N/2)",children:"Best of"})]}),e.jsx("input",{className:`input w-16 text-center ${t?"opacity-50":""}`,type:"number",min:1,step:1,value:Fs,onChange:i=>Jr(Math.max(1,Math.floor(Number(i.target.value)||1))),disabled:t,title:Nt==="first"?"First to N":"Best of N (wins = ceil(N/2))"})]})})()]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:["Legs: ",I,"â€“",F]}),e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px] flex-wrap",children:[e.jsx("span",{className:"opacity-70",children:"Match"}),e.jsxs("select",{className:`input input-compact font-bold ${Fe}`,value:Hi,onChange:t=>Bi(t.target.value),children:[e.jsx("option",{value:"singles",children:"Singles"}),e.jsx("option",{value:"doubles",children:"Doubles"})]}),e.jsx("input",{className:`input ${Fe} w-[7.5rem]`,value:Fi,onChange:t=>$i(t.target.value),placeholder:"Team A"}),e.jsx("span",{className:"opacity-50",children:"vs"}),e.jsx("input",{className:`input ${Fe} w-[7.5rem]`,value:Ui,onChange:t=>Oi(t.target.value),placeholder:"Team B"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2 relative",children:[we?e.jsxs("button",{type:"button",className:"inline-flex items-center gap-1.5 rounded-full border border-emerald-400/40 bg-emerald-500/15 px-3 py-1 text-xs font-semibold text-emerald-100 hover:bg-emerald-500/25 transition",onClick:()=>Ve(!1,null),children:[e.jsx("span",{children:"â–¶"}),e.jsx("span",{children:"Resume"})]}):e.jsxs("button",{type:"button",className:"inline-flex items-center gap-1.5 rounded-full border border-amber-400/40 bg-amber-500/15 px-3 py-1 text-xs font-semibold text-amber-100 hover:bg-amber-500/25 transition",onClick:()=>Kn(t=>!t),children:[e.jsx("span",{children:"â¸"}),e.jsx("span",{children:"Pause"})]}),we&&J&&(()=>{const t=Math.max(0,J-et),s=Math.floor(t/6e4).toString().padStart(2,"0"),i=Math.floor(t%6e4/1e3).toString().padStart(2,"0");return e.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full border border-amber-400/30 bg-amber-600/90 px-3 py-1 text-xs font-bold text-black tabular-nums tracking-wide",children:["â± ",s,":",i]})})(),zi&&!we&&e.jsxs("div",{className:"absolute left-0 top-full mt-1 z-50 rounded-lg border border-slate-600 bg-slate-800 shadow-lg p-2 flex flex-col gap-1 min-w-[140px]",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide text-slate-400 px-2 mb-1",children:"Pause for"}),[1,2,3,4,5].map(t=>e.jsxs("button",{type:"button",className:"w-full text-left rounded px-3 py-1.5 text-sm hover:bg-slate-700 transition",onClick:()=>{const s=Date.now()+t*60*1e3;Ve(!0,s);try{cn({type:"pause",pauseEndsAt:s,pauseStartedAt:Date.now()})}catch{}Kn(!1)},children:[t," minute",t>1?"s":""]},t))]})]}),we&&J&&(()=>{const t=Math.max(0,J-et),s=Math.floor(t/6e4).toString().padStart(2,"0"),i=Math.floor(t%6e4/1e3).toString().padStart(2,"0"),o=wt.getState().pauseStartedAt??et,c=Math.max(1,J-o),b=Math.max(0,Math.min(100,Math.round((1-t/c)*100)));return e.jsxs("div",{className:"mb-3 rounded-2xl border border-amber-400/30 bg-amber-500/10 p-4 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-amber-500/20 text-lg",children:"â¸"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-amber-100",children:"Match Paused"}),e.jsx("div",{className:"text-xs text-amber-200/80",children:"Resuming automatically when timer expires"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold tabular-nums tracking-wider text-amber-100",children:[s,":",i]}),e.jsx("div",{className:"text-[10px] text-amber-200/60 uppercase tracking-wide",children:"remaining"})]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-white/10",children:e.jsx("div",{className:"h-2 rounded-full bg-amber-400 transition-all duration-500",style:{width:`${b}%`}})}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{type:"button",className:"btn px-3 py-1 text-xs bg-emerald-600 hover:bg-emerald-700",onClick:()=>Ve(!1,null),children:"â–¶ Resume now"})})]})})(),r!=="X01"?e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full mb-2",children:[r==="Double Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:Ct[st]?.label||"â€”"})]})}),r==="Around the Clock"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"Current Target"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:me[pe]===25?"25 (Outer Bull)":me[pe]===50?"50 (Inner Bull)":me[pe]||"â€”"})]})}),r==="Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Cricket â€” Close 20â€“15 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-[11px] mb-2",children:Dn.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,Te.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:Te.points})]}),zl(Te)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{aa(mn()),ie(0),R("Cricket")},children:"Reset"})]})]}),r==="Shanghai"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Round"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:Ke.round})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Ke.score]}),Ke.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{os(un()),ie(0),R("Shanghai")},children:"Reset"})]})]}),r==="Halve It"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Stage"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 text-xs font-semibold",children:[Le.stage+1,"/",Le.targets.length]})]}),e.jsxs("div",{className:"text-sm",children:["Target:"," ",e.jsx("span",{className:"font-semibold",children:(()=>{const t=Li(Le);return t?t.kind==="ANY_NUMBER"?"Any":t.kind==="BULL"?"Bull":t.kind==="DOUBLE"||t.kind==="TRIPLE"||t.kind==="NUMBER"?`${t.kind} ${t.num}`:"â€”":"â€”"})()})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Le.score]}),Le.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{cs(xn()),ie(0),R("Halve It")},children:"Reset"})]})]}),r==="High-Low"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",_e.round," Â· Target ",_e.target]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",_e.score]}),_e.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{ds(hn()),ie(0),R("High-Low")},children:"Reset"})]})]}),r==="Bob's 27"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Target"}),e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-semibold",children:["D",na]})]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",Zn]}),tr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:li,children:"Reset"})]})]}),r==="Count-Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",ms,"/8"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",nr]})]}),r==="High Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",us,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",or]})]}),r==="Low Score"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Round ",xs,"/10"]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Score: ",ur]})]}),r==="Checkout 170"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:hs}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",ua," Â· Successes:"," ",pr]})]}),r==="Checkout 121"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Remaining"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:fs}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Attempts: ",fa," Â· Successes:"," ",Nr]})]}),r==="Treble Practice"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-slate-600",children:["Treble Target: T",Se]}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:["Hits: ",bs]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("label",{className:"text-sm",children:"Target"}),e.jsx("div",{className:"inline-flex items-center gap-1",children:[20,19,18].map(t=>e.jsxs("button",{className:`btn px-2 py-0.5 text-xs ${Se===t?"bg-emerald-600/30 border border-emerald-400/30":""}`,onClick:()=>ba(t),children:["T",t]},`tpick-header-${t}`))}),e.jsx("span",{className:"opacity-60 text-xs",children:"or"}),e.jsx("select",{className:"input w-24",value:Se,onChange:t=>ba(parseInt(t.target.value,10)),children:Array.from({length:20},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ci,children:"Reset"})]})]})}),r==="Baseball"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Inning"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Bt.inning}),e.jsxs("div",{className:"text-sm",children:["Score:"," ",e.jsx("span",{className:"font-semibold",children:Bt.score})]})]}),r==="Golf"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Hole"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Ft.hole}),e.jsxs("div",{className:"text-sm",children:["Strokes:"," ",e.jsx("span",{className:"font-semibold",children:Ft.strokes})]})]}),r==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Turn"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:Ee.turn}),Ee.finished&&e.jsxs("div",{className:"mt-1 text-xs",children:["Winner: ",Ee.winner||"â€”"]})]}),r==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Target"}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:pn[ps.targetIndex]}),e.jsxs("div",{className:"text-sm",children:["Progress:"," ",e.jsxs("span",{className:"font-semibold",children:[ps.targetIndex+1,"/",pn.length]})]}),ps.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["ðŸŽ‰ Finished in ",ps.darts," darts!"]})]}),r==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Ut.score,"/",Ut.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Ut.darts})]}),Ut.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Ut.target,"!"]})]}),r==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Score"}),e.jsxs("div",{className:"text-3xl font-extrabold tracking-tight",children:[Ot.score,"/",Ot.target]}),e.jsxs("div",{className:"text-sm",children:["Darts:"," ",e.jsx("span",{className:"font-semibold",children:Ot.darts})]}),Ot.finished&&e.jsxs("div",{className:"mt-1 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200",children:["âœ“ Reached ",Ot.target,"!"]})]}),r==="American Cricket"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Close 20â€“12 and Bull; overflow scores points"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 text-center text-[11px] mb-2",children:Mn.map(t=>e.jsxs("div",{className:"p-1 rounded bg-slate-800/50 border border-slate-700/50",children:[e.jsx("div",{className:"opacity-70",children:t===25?"Bull":t}),e.jsxs("div",{className:"font-semibold",children:[Math.min(3,at.marks?.[t]||0)," / 3"]})]},t))}),e.jsxs("div",{className:"text-sm",children:["Points:"," ",e.jsx("span",{className:"font-semibold",children:at.points})]}),go(at)&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:xi,children:"Reset"})]})]}),r==="Killer"&&e.jsx(e.Fragment,{children:Mr?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{children:"Turn"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:C[$]?.name||"â€”"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:he?`${C.find(t=>t.id===he)?.name||"Winner"} Wins`:tl||"Ready"})]}):e.jsx("div",{className:"text-xs text-slate-600",children:"Setup players and assign numbers"})})]}):l==="modern"?e.jsxs("div",{className:"space-y-3 mb-2",children:[Qs?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:"Manual scoring active"}),e.jsx("div",{className:"text-xs opacity-70",children:"Camera previews are disabled. Use the manual entry controls below to record your turn."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center flex-wrap gap-1.5 mt-1",children:e.jsxs("div",{className:"ml-auto flex items-center gap-1 text-[10px]",children:[e.jsx("span",{className:"opacity-70",children:"Cam"}),e.jsx("button",{className:`btn ${Fe}`,onClick:()=>Me(Math.max(.5,Math.round((Z-.05)*100)/100)),children:"âˆ’"}),e.jsxs("span",{className:`btn ${Fe} min-w-[2.5rem] text-center`,children:[Math.round(Z*100),"%"]}),e.jsx("button",{className:`btn ${Fe}`,onClick:()=>Me(Math.min(1.25,Math.round((Z+.05)*100)/100)),children:"+"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${Fe}`,title:"Toggle fit/fill",onClick:()=>Ys(ue==="fill"?"fit":"fill"),children:ue==="fill"?"Fill":"Fit"}),e.jsx("span",{className:"opacity-50",children:"|"}),e.jsx("button",{className:`btn ${Fe}`,title:"Toggle camera aspect",onClick:()=>be(_==="square"?"wide":"square"),children:_==="square"?"Square":"Wide"})]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:gap-4 lg:grid lg:grid-cols-[minmax(0,1fr)_380px] lg:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-2.5",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:r==="X01"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{"data-testid":"offline-current-shooter",className:"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Current Shooter"}),e.jsxs("div",{className:"mt-1 flex items-center gap-4",children:[e.jsx("div",{className:"text-xl font-semibold text-white",children:vl}),e.jsx("div",{className:"ml-auto text-sm text-slate-300",children:"3-Dart Avg (Live)"})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm text-white/80",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Remaining"}),e.jsx("div",{className:"font-mono text-lg text-white",children:Is})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Last Dart"}),e.jsx("div",{className:"font-mono text-lg text-white",children:Wr||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Match Legs"}),e.jsxs("div",{className:"font-semibold text-white",children:[I,"-",F]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"Next Up"}),e.jsx("div",{className:"font-medium text-white",children:gl})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{"data-testid":"offline-live-avg",className:"rounded-xl bg-slate-900/60 border border-white/10 p-3 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"mt-1 text-lg font-semibold",children:Si(H.players?.[H.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{"data-testid":"offline-player-stats",className:"rounded-lg border p-3 bg-slate-900/50 border-white/10 text-white/80",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/40",children:"You"}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("div",{children:["Legs Won:"," ",e.jsx("span",{className:"font-semibold",children:I})]}),e.jsxs("div",{children:["Score:"," ",e.jsx("span",{className:"font-mono",children:Is})]}),e.jsxs("div",{children:["Last Score:"," ",e.jsx("span",{className:"font-mono",children:Wr||0})]})]})]})]})]}):e.jsxs("div",{className:"md:col-span-2 rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Scoreboard"}),e.jsx("div",{className:"mt-3",children:e.jsx(Ne,{gameMode:r,players:_r,matchScore:Wa})})]})}),r==="X01"&&e.jsxs("div",{className:"rounded-2xl bg-slate-900/60 border border-white/10 p-4 text-slate-100 shadow-lg backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Manual Scoreboard Override"}),e.jsxs("p",{className:"mt-1 text-xs text-white/40",children:["Adjust the live totals if a dart was misread. Values are clamped between 0 and ",y,"."]}),e.jsxs("div",{className:"mt-2.5 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:Ce}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Commit Visit"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:e.jsx(Wl,{inProgress:!0,startingScore:y,onAddVisit:K(U),quickButtons:[180,140,100,60],onNextPlayer:()=>ne?.nextPlayer(),onEndLeg:()=>{},onUndo:()=>{},showDartsSelect:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:Fr,onChange:t=>Ia(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Bs("player")},placeholder:`${I}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Bs("player"),children:"Set"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-white",children:Qe}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Three Dart Edit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,max:y,value:Hr,onChange:t=>Br(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Qr()},placeholder:`${O}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Qr(),children:"Set"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-white/50",children:"Legs Override"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-20 bg-white/5 border border-white/10 text-white placeholder-white/40 focus:border-emerald-400/60 focus:ring-emerald-500/40",type:"number",min:0,value:$r,onChange:t=>Ha(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Bs("ai")},placeholder:`${F}`}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Bs("ai"),children:"Set"})]})]})]})]})]})]}),e.jsxs("div",{className:"hidden lg:flex lg:flex-col lg:gap-3 min-w-0",children:[e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black border border-white/10",children:S?e.jsx(T,{scoringMode:r==="X01"?"x01":"custom",showToolbar:L,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:K(U),onAutoDart:()=>{}}):e.jsx("div",{className:"p-4 text-sm text-slate-200 text-center",children:"Camera disabled"})}),e.jsx(Ne,{gameMode:r,players:Ga,matchScore:`${I}-${F}`})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(Ne,{gameMode:r,players:Ga,matchScore:`${I}-${F}`})}),Ae&&S&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 md:hidden",children:[e.jsx("button",{className:"btn rounded-full border border-white/20 bg-white/10 px-4 py-2 text-sm text-white",onClick:()=>tt(t=>!t),children:It?"Hide Camera":"Show Camera"}),e.jsx("span",{className:"text-xs text-white/60",children:It?"Swipe down / tap outside to close":"Opens as a bottom drawer"})]})]})]}),Ae&&S&&It&&e.jsxs("div",{className:"fixed inset-0 z-[120] md:hidden",children:[e.jsx("button",{type:"button",className:"absolute inset-0 bg-black/55",onClick:()=>tt(!1),"aria-label":"Close camera drawer"}),e.jsx("div",{className:"absolute left-0 right-0 bottom-0",children:e.jsx("div",{className:"mx-auto w-full max-w-[520px]",children:e.jsxs("div",{ref:zn,className:"rounded-t-[26px] border-t border-l border-r border-white/10 bg-slate-950/95 shadow-2xl overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",onPointerDown:Qi,onPointerMove:Zi,onPointerUp:Xn,onPointerCancel:Xn,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-10 rounded-full bg-white/20"}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"Board Camera"})]}),e.jsx("button",{type:"button",className:"btn btn--ghost px-3 py-1 text-sm",onClick:()=>tt(!1),children:"Close"})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"relative w-full overflow-hidden rounded-2xl bg-black border border-white/10",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(T,{scoringMode:"x01",showToolbar:L,immediateAutoCommit:!0,cameraAutoCommit:"camera",onAddVisit:K(U),onAutoDart:(t,s,i)=>{}})}),e.jsx("div",{className:"pt-[56.25%]"})]}),e.jsxs("div",{className:"mt-3 text-xs text-white/70 flex items-center justify-between",children:[e.jsx("span",{children:fl}),e.jsxs("span",{children:["Legs ",bl," Â· Opp ",pl]})]})]})]})})})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2 items-stretch min-w-0",children:e.jsxs("div",{className:"flex items-stretch justify-center md:px-3 min-w-0",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs text-slate-600 flex items-center justify-between",children:[e.jsx("span",{className:"opacity-80",children:"You Remain"}),P?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:B}),e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70",style:{width:`${Math.max(0,Math.min(100,(1-B/y)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart:"," ",e.jsx("span",{className:"font-semibold",children:Ge})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score:"," ",e.jsx("span",{className:"font-semibold",children:V>0?ve:dt??Ge})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg:"," ",e.jsx("span",{className:"font-semibold",children:zt>0?(Aa/zt*3).toFixed(1):"0.0"})]}),e.jsxs("div",{className:"text-xs opacity-70 flex items-center gap-2",children:[e.jsxs("span",{children:["Darts thrown: ",gs]}),e.jsx("span",{className:"inline-flex items-center gap-1","aria-label":"Visit darts",children:[0,1,2].map(t=>e.jsx("span",{className:`w-2 h-2 rounded-full ${t<V?"bg-emerald-400":"bg-white/20"}`},t))})]}),e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles:"," ",e.jsxs("span",{className:"font-semibold",children:["Att ",_t," Â· Hit ",Da]})]}),B<=170&&B>0&&(()=>{const s=ji(B,m)[0]||"â€”";return e.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 border border-white/10 text-white text-sm",children:[e.jsx("span",{className:"opacity-70",children:"Checkout"}),e.jsx("span",{className:"font-semibold",children:s})]})})()]}),e.jsxs("div",{className:`mt-2 ${An==="small"?"p-2":An==="large"?"p-4":"p-3"} rounded-2xl bg-slate-900/40 border border-white/10 text-white ${qs==="small"?"text-xs":qs==="large"?"text-base":"text-sm"}`,children:[e.jsx("div",{className:"font-semibold mb-2",children:"Match Summary"}),(()=>{const t=P?St(a,"You"):M==="None"?"â€”":`${M} AI`,s=P?B:M==="None"?0:O,i=P?V>0?ve:dt??Ge:xt>0?ut:ht??Xe,o=P?gs:Ns,c=y-(P?B:M==="None"?y:O),b=o>0?c/o*3:0,p=`${I}-${F}`,g=xe.length>0?`${Math.min(...xe.map(h=>h.doubleDarts+(h.checkoutDarts||0)))||0} darts`:"â€”";return e.jsxs("div",{className:"grid grid-cols-2 gap-y-1",children:[e.jsx("div",{className:"opacity-80",children:"Current score"}),e.jsx("div",{className:"font-mono text-right",children:p}),e.jsx("div",{className:"opacity-80",children:"Current thrower"}),e.jsx("div",{className:"text-right font-semibold text-lg",children:t}),e.jsx("div",{className:"opacity-80",children:"Score remaining"}),e.jsx("div",{className:"text-right font-mono font-bold text-xl",children:s}),e.jsx("div",{className:"opacity-80",children:"3-dart avg"}),e.jsx("div",{className:"text-right font-mono",children:b.toFixed(1)}),e.jsx("div",{className:"opacity-80",children:"Last score"}),e.jsx("div",{className:"text-right font-mono",children:i}),e.jsx("div",{className:"opacity-80",children:"Best leg"}),e.jsx("div",{className:"text-right",children:g})]})})()]}),e.jsxs("div",{className:"p-3 rounded-2xl glass text-white border border-white/10 min-w-0 flex flex-col h-full",children:[e.jsxs("div",{className:"text-xs flex items-center justify-between opacity-80",children:[e.jsxs("span",{children:[M==="None"?"Opponent":`${M} AI`," Remain"]}),P?e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-slate-500/20 text-slate-200 text-xs font-bold",children:"WAITING TO THROW"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 text-xs font-bold",children:"THROWING"})]}),e.jsx("div",{className:"text-3xl font-extrabold tracking-tight",children:M!=="None"?O:"N/A"}),M!=="None"&&e.jsx("div",{className:"h-1.5 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-fuchsia-400/70",style:{width:`${Math.max(0,Math.min(100,(1-O/y)*100))}%`}})}),e.jsxs("div",{className:"text-sm mt-1 opacity-90",children:["Last dart:"," ",e.jsx("span",{className:"font-semibold",children:M==="None"?0:Xe})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["Last score:"," ",e.jsx("span",{className:"font-semibold",children:M==="None"?"â€”":xt>0?ut:ht??Xe})]}),e.jsxs("div",{className:"text-sm opacity-90",children:["3-Dart Avg:"," ",e.jsx("span",{className:"font-semibold",children:M!=="None"?Yt>0?(Ta/Yt*3).toFixed(1):"0.0":"â€”"})]}),M!=="None"&&e.jsxs("div",{className:"text-xs opacity-70",children:["Darts thrown: ",Ns]}),M!=="None"&&e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:["Doubles:"," ",e.jsxs("span",{className:"font-semibold",children:["Att ",Gt," Â· Hit ",Ma]})]})]})]})}),r!=="X01"?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:r==="Double Practice"?"Double Practice":r==="Around the Clock"?"Around the Clock":r==="Cricket"?"Cricket":r==="Shanghai"?`Shanghai â€” Round ${Ke.round}`:r==="Halve It"?`Halve It â€” Round ${Le.stage+1}`:r==="High-Low"?`High-Low â€” Round ${_e.round}`:r==="Bob's 27"?`Bob's 27 â€” D${na}`:r==="Count-Up"?`Count-Up â€” Round ${ms}/${la}`:r==="High Score"?`High Score â€” Round ${us}/${oa}`:r==="Low Score"?`Low Score â€” Round ${xs}/${ca}`:r==="Checkout 170"?"Checkout 170":r==="Checkout 121"?"Checkout 121":r==="Treble Practice"?`Treble Practice â€” T${Se}`:r==="Baseball"?`Baseball â€” Inning ${Bt.inning}`:r==="Golf"?`Golf â€” Hole ${Ft.hole}`:r==="Tic Tac Toe"?"Tic Tac Toe":r==="American Cricket"?"American Cricket":r==="Killer"?"Killer":r==="Scam"?"Scam":r==="Fives"?"Fives":r==="Sevens"?"Sevens":"Your Turn"}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[r==="Double Practice"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:Ct[st]?.label||"â€”"})]}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,onAutoDart:(t,s)=>{if((s==="DOUBLE"||s==="INNER_BULL")&&ki(t,st)){const o=ls+1,c=st+1;return ta(o),ea(c),o>=Ct.length&&setTimeout(()=>{ta(0),ea(0)},250),!0}return!1},immediateAutoCommit:!0,onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,max:60,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&ni()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ni,children:"Add Dart"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (D16, 50, 25, T20)",value:se,onChange:t=>ae(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ri()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ri,children:"Add"})]})]}),e.jsxs("div",{className:"text-xs text-slate-300",children:["Progress: ",ls," of 21"]})]}),r==="Around the Clock"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:me[pe]===25?"25 (Outer Bull)":me[pe]===50?"50 (Inner Bull)":me[pe]||"â€”"})]}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>_s(t,s==="MISS"?void 0:s,i?.sector??null),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&hi()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:hi,children:"Add Dart"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-44",placeholder:"Manual (T20, D5, 25, 50)",value:se,onChange:t=>ae(t.target.value),onKeyDown:t=>{t.key==="Enter"&&fi()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:fi,children:"Add"})]}),sa>=me.length&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{qn(0),Yn(0),R("Around the Clock")},children:"Reset"})]})]}),r==="Cricket"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>Ws(t,s==="MISS"?void 0:s,i?.sector??null),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&bi()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:bi,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{aa(mn()),ie(0),R("Cricket")},children:"Reset"})]})]}),r==="Shanghai"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>Gs(t,s==="MISS"?void 0:s,i?.sector??null),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&pi()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:pi,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{os(un()),ie(0),R("Shanghai")},children:"Reset"})]})]}),r==="Halve It"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>an(t,s==="MISS"?void 0:s,i?.sector??null),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&gi()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:gi,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{cs(xn()),ie(0),R("Halve It")},children:"Reset"})]})]}),r==="High-Low"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>nn(t,s==="MISS"?void 0:s,i?.sector??null),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&vi()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:vi,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ds(hn()),ie(0),R("High-Low")},children:"Reset"})]})]}),r==="Bob's 27"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>en(t,s==="MISS"?void 0:s,i?.sector??null),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&ii()}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ii,children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:li,children:"Reset"})]})]}),r==="Count-Up"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:t=>$s(t),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&($s(D),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{$s(D),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ar(1),rr(0),ir(0),R("Count-Up")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",ms,"/",la]})]}),r==="High Score"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:t=>Us(t),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Us(D),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Us(D),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{lr(1),cr(0),dr(0),R("High Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",us,"/",oa]})]}),r==="Low Score"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:t=>Os(t),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:0,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(Os(D),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{Os(D),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{mr(1),xr(0),hr(0),R("Low Score")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Round ",xs,"/",ca]})]}),r==="Checkout 170"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s)=>tn(t,s==="MISS"?void 0:s),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:se,onChange:t=>ae(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Vs(!0)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Vs(!0),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Cl,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",hs," Â· Attempts: ",ua," ","Â· Successes: ",pr]})]}),r==="Checkout 121"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s)=>sn(t,s==="MISS"?void 0:s),onAddVisit:K(U),onEndLeg:t=>ne.endLeg(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (D16, T20)",value:se,onChange:t=>ae(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Vs(!1)}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>Vs(!1),children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Dl,children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Remaining: ",fs," Â· Attempts: ",fa," ","Â· Successes: ",Nr]})]}),r==="Treble Practice"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>Ks(t,s==="MISS"?void 0:s,i?.sector??null)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"text",placeholder:"Manual (T20)",value:se,onChange:t=>ae(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){const s=Zt(se);s!=null&&Ks(s,void 0,void 0),ae("")}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{const t=Zt(se);t!=null&&Ks(t,void 0,void 0),ae("")},children:"Add Dart"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Hits: ",bs," Â· Misses:"," ",Math.max(0,ga-bs)," Â· Darts:"," ",ga,Ht>0?`/${Ht}`:""]}),wr&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Completed!"," ",e.jsx("button",{className:"ml-2 underline",onClick:ci,children:"Reset"})]})]}),r==="Baseball"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>di(t,s==="MISS"?void 0:s,i?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ml,children:"Reset"})})]}),r==="Golf"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>mi(t,s==="MISS"?void 0:s,i?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Al,children:"Reset"})})]}),r==="Tic Tac Toe"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-3 gap-1 mb-2",children:Array.from({length:9},(t,s)=>s).map(t=>e.jsx("button",{className:`h-16 rounded-xl border ${Ee.board[t]?"bg-emerald-500/20 border-emerald-400/30":"bg-slate-800/50 border-slate-700/50"}`,onClick:()=>{if(Ee.finished||Ee.board[t])return;const s=Number(prompt("Enter dart score for this cell (e.g., 20, 40, 60; 25 or 50 for center)")||0),i=s%3===0?"TRIPLE":s%2===0?"DOUBLE":"SINGLE",o=t,c=Ei[o],b=c.type==="BULL"?null:c.num||null;Tl(o,s,i,b)},children:Ee.board[t]||""},t))}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{}})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:Ll,children:"Reset"})})]}),r==="American Cricket"&&e.jsxs(e.Fragment,{children:[S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>ui(t,s==="MISS"?void 0:s,i?.sector??null)})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:xi,children:"Reset"})})]}),r==="Scam"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Target:"," ",e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:pn[ge.targetIndex]})]}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{const o=s==="MISS"?void 0:s;return A("Scam"),it(yn(ge,t,o)),!0}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:1,max:25,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(A("Scam"),it(gn(ge,D)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{A("Scam"),it(gn(ge,D)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{it(co()),R("Scam")},children:"Reset"})]}),ge.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["ðŸŽ‰ Finished in ",ge.darts," darts!"]})]}),r==="Fives"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[X.score,"/",X.target]})]}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>(A("Fives"),lt(Sn(X,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:5,max:50,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(A("Fives"),lt(vn(X,D)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{A("Fives"),lt(vn(X,D)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{lt(xo(X.target)),R("Fives")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 5, 10, 15, 20, 25, 50 Â· Darts:"," ",X.darts]}),X.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",X.target," in"," ",X.darts," darts!"]})]}),r==="Sevens"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"font-semibold",children:["Score:"," ",e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-white/10 border border-white/10",children:[Y.score,"/",Y.target]})]}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>(A("Sevens"),ot(Cn(Y,t)),!0)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-24",type:"number",min:7,max:21,value:D,onChange:t=>w(Number(t.target.value||0)),onKeyDown:t=>{t.key==="Enter"&&(A("Sevens"),ot(jn(Y,D)),w(0))}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{A("Sevens"),ot(jn(Y,D)),w(0)},children:"Add Dart"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{ot(bo(Y.target)),R("Sevens")},children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Valid scores: 7, 14, 21 Â· Darts:"," ",Y.darts]}),Y.finished&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["âœ“ Reached ",Y.target," in"," ",Y.darts," darts!"]})]}),r==="Killer"&&e.jsx(e.Fragment,{children:Mr?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-60",children:"Turn:"}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-200 font-bold",children:C[$]?.name||"â€”"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"opacity-60",children:"Dart"}),e.jsxs("span",{className:"font-mono font-bold",children:[el+1,"/3"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:C.map(t=>{const s=We[t.id],i=$t[t.id],o=t.id===C[$]?.id;return e.jsxs("div",{className:`p-2 rounded-xl border ${s?.eliminated?"opacity-50 border-red-500/40 bg-red-500/10":o?"border-emerald-400/50 bg-emerald-500/10 ring-1 ring-emerald-400/30":"border-slate-700/50 bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"font-semibold",children:[t.name,o&&e.jsx("span",{className:"ml-1 text-emerald-300",children:"â—€"})]}),e.jsx("div",{className:`text-[10px] px-1.5 py-0.5 rounded ${s?.isKiller?"bg-purple-500/20 text-purple-200 border border-purple-400/30":"bg-slate-600/30 text-slate-300"}`,children:s?.isKiller?"ðŸ—¡ Killer":"Not Killer"})]}),e.jsxs("div",{className:"mt-1 text-lg font-extrabold tracking-tight",children:["D",i]}),e.jsxs("div",{className:"text-sm",children:["Lives:"," ",e.jsxs("span",{className:"font-semibold",children:["â¤ï¸".repeat(s?.lives??0),(s?.lives??0)===0&&"ðŸ’€"]})]}),!s?.eliminated&&!he&&e.jsxs("div",{className:"mt-2 flex items-center gap-1.5",children:[e.jsxs("button",{className:"px-2.5 py-1 rounded-full text-[11px] font-semibold bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 hover:bg-emerald-500/30 transition-colors disabled:opacity-40",disabled:!!he,onClick:()=>{if(he)return;const c=C[$];c&&(nt(b=>{const p={};Object.keys(b).forEach(u=>p[u]={...b[u]});const g=fn(c.id,p,"DOUBLE",i);if(g.becameKiller)z(`${c.name} became a Killer!`);else if(g.victimId)if(g.victimId===c.id)z(`${c.name} hit own D${i}! Lost a life`);else{const u=C.find(v=>v.id===g.victimId);z(`${c.name} hit ${u?.name}'s D${$t[g.victimId]} (-${g.livesRemoved} life)`)}else z("No effect");const h=bn(p);return h&&rt(h),p}),Pe(b=>{const p=b+1;if(p>=3){let g=$;for(let h=1;h<=C.length;h++){const u=($+h)%C.length,v=C[u].id,N=We[v];if(N&&!N.eliminated&&N.lives>0){g=u;break}}return Re(g),0}return p}))},children:["Hit D",i]}),e.jsx("button",{className:"px-2.5 py-1 rounded-full text-[11px] font-semibold bg-slate-600/30 text-slate-300 border border-slate-500/30 hover:bg-slate-600/40 transition-colors disabled:opacity-40",disabled:!!he,onClick:()=>{he||(z("Miss â€” no effect"),Pe(c=>{const b=c+1;if(b>=3){let p=$;for(let g=1;g<=C.length;g++){const h=($+g)%C.length,u=C[h].id,v=We[u];if(v&&!v.eliminated&&v.lives>0){p=h;break}}return Re(p),0}return b}))},children:"Miss"})]})]},t.id)})}),S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{if(he)return!1;const o=s==="MISS"?void 0:s,c=i?.sector??null,b=C[$];return b?(nt(p=>{const g={};Object.keys(p).forEach(v=>g[v]={...p[v]});const h=fn(b.id,g,o,c);if(h.becameKiller)z(`${b.name} became a Killer`);else if(h.victimId){const v=C.find(N=>N.id===h.victimId);z(`${b.name} hit ${v?.name}'s ${$t[h.victimId]} (${h.livesRemoved} life${(h.livesRemoved||0)>1?"s":""})`)}else z("No effect");const u=bn(g);return u&&rt(u),g}),Pe(p=>{const g=p+1;if(g>=3){let h=$;for(let u=1;u<=C.length;u++){const v=($+u)%C.length,N=C[v].id,E=We[N];if(E&&!E.eliminated&&E.lives>0){h=v;break}}return Re(h),0}return g}),!0):!1}})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-40",placeholder:"Manual (D16, T5)",value:se,onChange:t=>ae(t.target.value),onKeyDown:t=>{if(t.key==="Enter"){if(he)return;const i=se.trim().toUpperCase().match(/^(S|D|T)?\s*(\d{1,2})$/);if(!i){ae("");return}const o=i[1]||"S",c=parseInt(i[2],10),b=o==="D"?"DOUBLE":o==="T"?"TRIPLE":"SINGLE",p=C[$];nt(g=>{const h={};Object.keys(g).forEach(N=>h[N]={...g[N]});const u=fn(p.id,h,b,c);if(u.becameKiller)z(`${p.name} became a Killer`);else if(u.victimId){const N=C.find(E=>E.id===u.victimId);z(`${p.name} hit ${N?.name}'s ${$t[u.victimId]} (${u.livesRemoved} life${(u.livesRemoved||0)>1?"s":""})`)}else z("No effect");const v=bn(h);return v&&rt(v),h}),ae(""),Pe(g=>{const h=g+1;if(h>=3){let u=$;for(let v=1;v<=C.length;v++){const N=($+v)%C.length,E=C[N].id,k=We[E];if(k&&!k.eliminated&&k.lives>0){u=N;break}}return Re(u),0}return h})}}}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:()=>{let t=$;for(let s=1;s<=C.length;s++){const i=($+s)%C.length,o=C[i].id,c=We[o];if(c&&!c.eliminated&&c.lives>0){t=i;break}}Re(t),Pe(0)},children:"Next Player"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 px-3 py-1 text-sm",onClick:()=>{nt({}),ya({}),wa(!1),Re(0),Pe(0),rt(null),z("")},children:"Reset"})]}),he&&e.jsxs("div",{className:"mt-2 text-xs px-2 py-1 rounded bg-emerald-500/20 text-emerald-200 border border-emerald-400/30 inline-block",children:["Winner:"," ",C.find(t=>t.id===he)?.name," ",e.jsx("button",{className:"ml-2 underline",onClick:()=>{nt({}),ya({}),wa(!1),Re(0),Pe(0),rt(null),z("")},children:"Play Again"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Players"}),e.jsx("div",{className:"space-y-1",children:C.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input",value:t.name,onChange:i=>{const o=i.target.value;Na(c=>c.map((b,p)=>p===s?{...b,name:o}:b))}}),e.jsx("button",{className:"btn px-2 py-1",onClick:()=>Na(i=>i.filter((o,c)=>c!==s)),disabled:C.length<=2,children:"Remove"})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"btn px-2 py-1",onClick:()=>Na(t=>{const s=`p${t.length+1}`;return[...t,{id:s,name:`Player ${t.length+1}`}]}),children:"Add Player"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 px-3 py-1",onClick:()=>{if(C.length<2){alert("Need at least 2 players");return}const t=C.map(o=>o.id),s=so(t),i={};t.forEach(o=>{i[o]=to(s[o])}),ya(s),nt(i),Re(0),Pe(0),rt(null),z("Assigned numbers"),wa(!0)},children:"Assign Numbers & Start"})]})]})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:r==="Double Practice"||r==="Around the Clock"?"Target":r==="Cricket"?"Marks":r==="Shanghai"||r==="Halve It"||r==="High-Low"||r==="Bob's 27"||r==="Count-Up"||r==="High Score"||r==="Low Score"?"Score":r==="Checkout 121"||r==="Checkout 170"?"Remaining":r==="Treble Practice"?"Target":r==="Baseball"?"Score":r==="Golf"?"Strokes":r==="Tic Tac Toe"?"Board":r==="American Cricket"?"Points":r==="Killer"?"Lives":r==="Scam"?"Progress":r==="Fives"||r==="Sevens"?"Score":"Current"}),e.jsx("div",{className:"text-lg font-bold text-white",children:r==="Double Practice"?Ct[st]?.label||"Done":r==="Around the Clock"?me[pe]===25?"Bull":me[pe]===50?"D-Bull":me[pe]||"Done":r==="Cricket"?Te.marks?Object.values(Te.marks).reduce((t,s)=>t+s,0):0:r==="Shanghai"?Ke.score:r==="Halve It"?Le.score:r==="High-Low"?_e.score:r==="Bob's 27"?Zn:r==="Count-Up"?nr:r==="High Score"?or:r==="Low Score"?ur:r==="Checkout 121"?fs:r==="Checkout 170"?hs:r==="Treble Practice"?`T${Se}`:r==="Baseball"?Bt.score:r==="Golf"?Ft.strokes:r==="Tic Tac Toe"?"â€”":r==="American Cricket"?at.points??0:r==="Killer"?"â€”":r==="Scam"?`${ge.targetIndex}/21`:r==="Fives"?X.score:r==="Sevens"?Y.score:Is})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:r==="Double Practice"?"Hits":r==="Around the Clock"?"Progress":r==="Cricket"?"Points":r==="Shanghai"||r==="Halve It"||r==="High-Low"?"Round":r==="Bob's 27"?"Doubles hit":r==="Count-Up"||r==="High Score"||r==="Low Score"?"Round":r==="Checkout 121"||r==="Checkout 170"?"Darts left":r==="Treble Practice"?"Hits":r==="Baseball"?"Inning":r==="Golf"?"Hole":r==="Tic Tac Toe"?"Turn":r==="American Cricket"?"Marks":r==="Killer"?"Players":r==="Scam"?"Darts":r==="Fives"||r==="Sevens"?"Target":"3-dart avg"}),e.jsx("div",{className:"text-lg font-bold text-emerald-300",children:r==="Double Practice"?`${ls}/${Ct.length}`:r==="Around the Clock"?`${sa}/${me.length}`:r==="Cricket"?Te.points:r==="Shanghai"?`${Ke.round}/7`:r==="Halve It"?`${Le.stage+1}`:r==="High-Low"?`${_e.round}`:r==="Bob's 27"?er:r==="Count-Up"?`${ms}/${la}`:r==="High Score"?`${us}/${oa}`:r==="Low Score"?`${xs}/${ca}`:r==="Checkout 121"?Math.max(0,6-fa*3-ha):r==="Checkout 170"?Math.max(0,6-ua*3-ma):r==="Treble Practice"?`${bs} / ${ga}`:r==="Baseball"?`${Bt.inning}/9`:r==="Golf"?`${Ft.hole}/18`:r==="Tic Tac Toe"?Ee.turn:r==="American Cricket"?at.marks?Object.values(at.marks).reduce((t,s)=>t+s,0):0:r==="Killer"?C.length:r==="Scam"?ge.darts:r==="Fives"?X.target:r==="Sevens"?Y.target:Yr.toFixed(1)})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(Ne,{gameMode:r,players:_r,matchScore:Wa}),rn&&e.jsxs("div",{className:"mt-3 rounded-xl border border-white/10 bg-black/20 p-3",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Quick score"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{ref:ti,className:"input w-24 text-center",type:"number",inputMode:"numeric",value:qa,onChange:t=>Qa(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ln()},readOnly:Ae}),e.jsx("button",{className:"btn px-3 py-1 text-sm",onClick:ln,children:"Add"})]}),e.jsx(wi,{className:"mt-2 scale-90 origin-top-left",value:qa,onChange:Qa,onSubmit:ln,label:"",helperText:Ae?"Tap the pad to enter the score.":"Type numbers or tap the pad, then Enter."})]}),"n                               "]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!S&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),S?e.jsx("div",{className:"bg-black aspect-video max-h-[30vh] md:max-h-[420px]",children:e.jsx(Ti,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:()=>!1})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"font-semibold",children:"Your Turn"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col-reverse md:grid md:grid-cols-12 gap-4 items-start",children:[e.jsx("div",{className:"col-span-12 md:col-span-4 space-y-3",children:e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-4 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-2",children:"Visit total"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{className:"input w-28",type:"number",min:0,max:B<=170?170:180,placeholder:"0â€“180",value:Ya,onChange:t=>si(t.target.value),onKeyDown:t=>{t.key==="Enter"&&Za()}}),e.jsx("button",{className:"btn px-4 py-1 text-sm",onClick:Za,title:"Commit a full 3-dart total like 93",children:"Commit Visit"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(wi,{value:Ya,onChange:si,onSubmit:Za,helperText:"Tap numbers then Enter to commit the visit total."})})]})}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-3",children:[e.jsx("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"Current score"}),e.jsx("div",{className:"text-lg font-bold text-white",children:Is})]}),e.jsxs("div",{className:"rounded-lg bg-black/30 px-2 py-1",children:[e.jsx("div",{className:"uppercase tracking-wide text-white/50",children:"3-dart avg"}),e.jsx("div",{className:"text-lg font-bold text-emerald-300",children:Yr.toFixed(1)})]})]})}),e.jsxs("div",{className:"rounded-2xl bg-slate-900/70 border border-white/10 p-2 text-slate-100 shadow-lg",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Scoreboard"}),e.jsx(Ne,{gameMode:r,players:Ga,matchScore:Wa})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4",children:e.jsxs("div",{className:"relative rounded-2xl bg-black/60 border border-white/10 overflow-hidden shadow-lg",children:[e.jsxs("div",{className:"absolute inset-x-0 top-0 z-10 flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide text-white/70 bg-black/40 backdrop-blur-sm",children:[e.jsx("span",{children:"Board camera"}),!S&&e.jsx("span",{className:"text-amber-300 font-semibold",children:"Camera disabled"})]}),S?e.jsx("div",{className:"bg-black aspect-video max-h-[30vh] md:max-h-[420px]",children:e.jsx(Ti,{scoringMode:"custom",showToolbar:!1,immediateAutoCommit:!0,onAutoDart:()=>!1})}):e.jsx("div",{className:"p-4 text-sm text-slate-200/80",children:"Enable the camera to keep the board visible while you score."})]})})]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Tip: Tap numbers then Enter to commit a 3-dart visit."})]}),e.jsx("div",{className:"flex flex-col gap-3 min-h-0 flex-1 text-[14px]",children:e.jsx("div",{className:"min-w-0 flex flex-col gap-2 overflow-y-auto pr-2 text-sm",style:{willChange:"scroll-position",transform:"translateZ(0)",WebkitOverflowScrolling:"touch"}})}),r==="Cricket"&&S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{if(t>0)return Ws(t,s==="MISS"?void 0:s,i?.sector??null),!0}})}),r==="Shanghai"&&e.jsx(e.Fragment,{children:e.jsx(Ne,{gameMode:"Shanghai",players:Ua})}),r==="Shanghai"&&S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{if(t>0)return Gs(t,s==="MISS"?void 0:s,i?.sector??null),!0}})}),r==="Killer"&&e.jsx(e.Fragment,{children:e.jsx(Ne,{gameMode:"Killer",players:Oa})}),r==="Scam"&&e.jsx(e.Fragment,{children:e.jsx(Ne,{gameMode:"Scam",players:Va})}),r==="Scam"&&S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{if(t>0)return it(yn(ge,t,s)),!0}})}),r==="Fives"&&e.jsx(e.Fragment,{children:e.jsx(Ne,{gameMode:"Fives",players:Ka})}),r==="Fives"&&S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{if(t>0)return lt(Sn(X,t)),!0}})}),r==="Sevens"&&e.jsx(e.Fragment,{children:e.jsx(Ne,{gameMode:"Sevens",players:_a})}),r==="Sevens"&&S&&e.jsx("div",{className:"rounded-2xl overflow-hidden bg-black",children:e.jsx(T,{scoringMode:"custom",showToolbar:L,immediateAutoCommit:!0,onAutoDart:(t,s,i)=>{if(t>0)return ot(Cn(Y,t)),!0}})})]}),e.jsx("div",{className:"h-1"})]})]})})]})}),Ki&&e.jsx(So,{onClose:()=>En(!1)}),on&&e.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-slate-900/40"}),e.jsxs("div",{className:"relative z-10 p-4 rounded-xl bg-black/60 border border-slate-700 text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ”’"}),e.jsx("div",{className:"font-semibold",children:"Premium mode locked"}),e.jsx("div",{className:"text-sm text-slate-200/80",children:"Upgrade to PREMIUM to play modes like Killer, Cricket, Shanghai, and more."}),e.jsxs("button",{onClick:async()=>{try{const s=await(await fetch(`${ko}/api/stripe/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a?.email})})).json();s.ok&&s.url?(window.location.href=s.url,s.development&&Ue("Opened Stripe test checkout (development mode)",{type:"info",timeout:3e3})):s.error==="STRIPE_NOT_CONFIGURED"?Ue("Premium purchases are not available in this development environment. Please visit the production site to upgrade.",{type:"error",timeout:4e3}):Ue("Failed to create checkout session. Please try again.",{type:"error",timeout:4e3})}catch{Ue("Error creating checkout. Please try again.",{type:"error",timeout:4e3})}},className:"btn mt-3 bg-gradient-to-r from-indigo-500 to-fuchsia-600 text-white font-bold",children:["Upgrade to PREMIUM Â·"," ",Ul(Ol(),5)]})]})]}),ul&&typeof document<"u"?Ni.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[200] flex items-center justify-center p-4",onClick:()=>pt(!1),children:e.jsx(kt,{storageKey:"ndn:modal:offline-camera-manager",className:"relative",defaultWidth:640,defaultHeight:520,minWidth:480,minHeight:420,maxWidth:1200,maxHeight:900,initialFitHeight:!0,onClose:()=>pt(!1),children:e.jsxs("div",{className:"space-y-3",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50",children:"Camera Devices"}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Manage Offline Camera Feeds"})]}),e.jsx("button",{className:"btn bg-slate-800 hover:bg-slate-700 text-white",onClick:()=>pt(!1),children:"Close"})]}),e.jsx(Kl,{fill:!0,user:a,playerScore:B,aiScore:O,x01Score:y,inMatch:$e,showWinPopup:Pn,pendingLegWinner:ss,playerDartsThrown:gs,aiDartsThrown:Ns,totalPlayerDarts:zt,totalAiDarts:Yt,totalPlayerPoints:Aa,totalAiPoints:Ta,player180s:Rr,player140s:nl,player100s:rl,ai180s:Pr,ai140s:il,ai100s:ll,playerHighestCheckout:ol,aiHighestCheckout:cl,onClose:()=>pt(!1),onOpen:()=>pt(!0),layout:l})]})})}),document.body):null,Ls&&typeof document<"u"?Ni.createPortal((()=>{const{target:t,value:s,stage:i}=Ls,o=t==="player"?Ce:Qe,c=t==="player"?I:F;return e.jsx("div",{className:"fixed inset-0 bg-black/75 z-[240] flex items-center justify-center p-4",onClick:qt,children:e.jsx(kt,{storageKey:"ndn:modal:offline-leg-override",className:"relative",defaultWidth:360,defaultHeight:240,minWidth:280,minHeight:200,maxWidth:420,maxHeight:360,initialFitHeight:!0,onClose:qt,children:e.jsxs("div",{className:"space-y-3 max-w-[18rem] mx-auto",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs uppercase tracking-wide text-white/50",children:["Step ",i," of 2"]}),e.jsx("div",{className:"text-xl font-semibold text-white mt-1",children:"Override legs?"})]}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:i===1?e.jsxs(e.Fragment,{children:["Set ",o,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),"? Confirm to continue."]}):e.jsxs(e.Fragment,{children:["Final confirmation: set ",o,"'s legs to"," ",e.jsx("span",{className:"font-semibold text-white",children:s}),". Select"," ",e.jsx("span",{className:"font-semibold text-emerald-200",children:"Yes"})," ","to apply immediately."]})}),e.jsxs("div",{className:"rounded-xl bg-black/40 border border-white/10 p-3 text-sm",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide text-white/50 mb-1",children:"Current legs"}),e.jsx("div",{className:"text-base font-semibold text-white",children:c})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{className:"btn bg-rose-600 hover:bg-rose-700 text-white",onClick:qt,children:"No"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 text-white",onClick:wl,children:"Yes"})]})]})})})})(),document.body):null,Pn&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-[99999]",children:e.jsxs(kt,{storageKey:"ndn:modal:offline-win",className:"w-full relative",defaultWidth:420,defaultHeight:360,minWidth:360,minHeight:300,maxWidth:800,maxHeight:700,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Leg Won!"}),e.jsxs("div",{className:"mb-2 text-sm text-slate-200",children:["Average:"," ",e.jsx("span",{className:"font-mono",children:Si(H.players?.[H.currentPlayerIdx]?.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts used at double"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${as===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>Fn(t),children:Be(t)},`win-double-${t}`))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-white/60 mb-1",children:"Darts at checkout"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2,3].map(t=>e.jsx("button",{className:`btn px-3 py-1 text-sm ${ns===t?"bg-brand-600":"btn--ghost"}`,onClick:()=>$n(t),children:Be(t)},`win-checkout-${t}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 mt-2",children:[e.jsx("button",{className:"btn w-full",onClick:El,children:"Submit"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700 w-full",onClick:()=>{W(!1),yt()},children:"Rematch"}),e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800 w-full",onClick:()=>{W(!1),Oe(!1),Je(!1)},children:"Back to Menu"})]})]})}),ml&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",children:e.jsxs(kt,{storageKey:"ndn:modal:offline-summary",className:"w-full relative",defaultWidth:820,defaultHeight:520,minWidth:600,minHeight:400,maxWidth:1400,maxHeight:1e3,initialFitHeight:!0,children:[e.jsx("h3",{className:"text-xl font-extrabold mb-2",children:"Match Summary"}),e.jsxs("div",{className:"text-xs opacity-80 mb-3",children:[r," Â· ",y," start Â· First to ",At]}),(()=>{const t=zt>0?Aa/zt*3:0,s=(()=>{const h=xe.filter(u=>u.winner==="player"&&typeof u.winnerDarts=="number").map(u=>u.winnerDarts);return h.length?`${Math.min(...h)} darts`:"â€”"})(),i=(()=>{const h=xe.filter(u=>u.winner==="player"&&typeof u.winnerDarts=="number").map(u=>u.winnerDarts);return h.length?`${Math.max(...h)} darts`:"â€”"})(),o=_t>0?Math.round(Da/_t*100):0,c=Yt>0?Ta/Yt*3:0,b=(()=>{const h=xe.filter(u=>u.winner==="ai"&&typeof u.winnerDarts=="number").map(u=>u.winnerDarts);return h.length?`${Math.min(...h)} darts`:"â€”"})(),p=(()=>{const h=xe.filter(u=>u.winner==="ai"&&typeof u.winnerDarts=="number").map(u=>u.winnerDarts);return h.length?`${Math.max(...h)} darts`:"â€”"})(),g=Gt>0?Math.round(Ma/Gt*100):0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:St(a,"You")}),e.jsx("div",{className:"text-3xl font-extrabold",children:I}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:t.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:_t})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[o,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:s})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:i})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:Rr})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center justify-center",children:e.jsxs("div",{className:"text-4xl font-black",children:[I," â€“ ",F]})}),e.jsxs("div",{className:"p-3 rounded-2xl glass border border-white/10",children:[e.jsx("div",{className:"text-sm font-semibold mb-1",children:M==="None"?"Opponent":`${M} AI`}),e.jsx("div",{className:"text-3xl font-extrabold",children:F}),e.jsx("div",{className:"text-xs opacity-80",children:"Legs Won"}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Final 3DA"}),e.jsx("div",{className:"font-semibold",children:c.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Darts At Double"}),e.jsx("div",{className:"font-semibold",children:Gt})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Double %"}),e.jsxs("div",{className:"font-semibold",children:[g,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Best Dart Leg"}),e.jsx("div",{className:"font-semibold",children:b})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"Worst Dart Leg"}),e.jsx("div",{className:"font-semibold",children:p})]}),e.jsxs("div",{children:[e.jsx("span",{className:"opacity-70",children:"180's Hit"}),e.jsx("div",{className:"font-semibold",children:Pr})]})]})]})]})})(),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Legs Timeline"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.map((t,s)=>e.jsxs("div",{className:`px-3 py-1 rounded-full border text-xs ${t.winner==="player"?"bg-emerald-500/15 border-emerald-400/30":"bg-fuchsia-500/15 border-fuchsia-400/30"}`,children:["Leg ",s+1,":"," ",t.winner==="player"?"You":M==="None"?"Opp":"AI"," ","Â· Dbl ",Be(t.doubleDarts)," Â· CO"," ",Be(t.checkoutDarts||0)]},s))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx("button",{className:"btn bg-slate-700 hover:bg-slate-800",onClick:()=>Pa(!1),children:"Close"}),e.jsx("button",{className:"btn bg-emerald-600 hover:bg-emerald-700",onClick:()=>{Pa(!1),yt()},children:"Rematch"})]})]})}),xe.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Leg Stats"}),e.jsx("ul",{children:xe.map((t,s)=>e.jsxs("li",{children:["Leg ",s+1,": Double darts: ",Be(t.doubleDarts),", Checkout darts: ",Be(t.checkoutDarts||0)]},s))})]})]})]})}export{Yo as default};
//# sourceMappingURL=OfflinePlay-BBrJK-7v.js.map
