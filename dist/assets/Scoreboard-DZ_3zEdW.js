import{i as W,a4 as D,j as e,R as V,a5 as L}from"./index-DHjJuWW-.js";import{f as y}from"./stats-X3jz_E9o.js";import{M as T}from"./MatchControls-Dnm6_0ku.js";import"./vendor-D3F3s8fL.js";import"./ui-C3zlW9wh.js";function F({matchActions:n}={}){const{players:c,currentPlayerIdx:x,addVisit:w,undoVisit:S,endLeg:f,nextPlayer:j,endGame:R,inProgress:b,startingScore:h,bestLegThisMatch:v}=W(),N=D(t=>t.entries);function M(){try{const t={ts:Date.now(),players:c.map(s=>{const r=s.legs.reduce((d,a)=>{d.points+=a.totalScoreStart-a.totalScoreRemaining;const o=(a.visits||[]).reduce((i,m)=>i+(m.darts||0),0);return d.darts+=o,d},{points:0,darts:0}),l=r.darts,g=l>0?r.points/l*3:0;return{id:s.id,name:s.name,legsWon:s.legsWon,dartsThrown:l,avg:Math.round(g*100)/100}}),winner:c.reduce((s,r)=>r.legsWon>(s?.legsWon||0)?r:s,c[0])?.name};try{localStorage.setItem("ndn_last_match",JSON.stringify(t))}catch{}}catch{}L(c),(n?.endGame??R)()}return e.jsx(V,{storageKey:"ndn:modal:scoreboard",className:"w-full h-full relative",defaultWidth:1100,defaultHeight:720,minWidth:720,minHeight:480,maxWidth:1600,maxHeight:1200,initialFitHeight:!0,children:e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-3",children:e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-3",children:e.jsxs("div",{className:"col-span-2 card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Score Input"}),b?e.jsx(T,{inProgress:b,startingScore:h,pendingEntries:N,onAddVisit:(t,s)=>{const r=c[x],l=r.legs[r.legs.length-1];let a=(l?l.totalScoreRemaining:h)-(typeof t=="number"?t:0);(!Number.isFinite(a)||a<0)&&(a=0),n?.addVisit?n.addVisit(t,s):w(t,s),a===0?n?.endLeg?n.endLeg(t):f(t):(n?.nextPlayer??j)()},onUndo:()=>(n?.undoVisit??S)(),onEndLeg:t=>{(n?.endLeg??f)(t??0)},onNextPlayer:()=>(n?.nextPlayer??j)(),onEndGame:M,quickButtons:[180,140,100,60]}):e.jsx("p",{className:"text-slate-600",children:"No game in progress."}),e.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:c.map((t,s)=>{const r=t.legs[t.legs.length-1],l=r?r.totalScoreRemaining:h,g=t.legs.reduce((o,i)=>{o.points+=i.totalScoreStart-i.totalScoreRemaining;const m=(i.visits||[]).reduce((u,p)=>u+(p.darts||0),0);return o.darts+=m,o},{points:0,darts:0}),d=g.darts,a=d>0?g.points/d*3:0;return e.jsxs("div",{className:`card glass transition-shadow transition-all duration-150 ease-out ${s===x?"ring-2 ring-brand-400":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold",children:t.name}),e.jsxs("span",{className:"badge w-32 justify-center",children:["Legs Won: ",t.legsWon]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remaining"}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-1 h-3 w-full","aria-hidden":!0,children:[0,1,2].map(o=>{const i=s===x?N[o]:null,m=!i,u=!!i&&(typeof i.value=="number"?i.value>0:!0),P=`visit-dot ${s===x&&!m&&u?"active":"inactive"} ${m?"bg-gray-400/60":u?"bg-emerald-400":"bg-rose-500"}`;return e.jsx("span",{className:P},o)})}),e.jsx("div",{className:"text-2xl font-bold",children:l}),e.jsx("div",{className:"h-1 w-full bg-white/10 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-400/70 transition-all duration-200 ease-out",style:{width:`${Math.max(0,Math.min(100,(1-l/h)*100))}%`}})})]}),e.jsxs("div",{className:"p-2 rounded-xl bg-white/10 border border-white/10 metric-tile",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Darts"}),e.jsx("div",{className:"text-xl font-bold",children:d})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg (Live)"}),e.jsx("div",{className:"text-xl font-bold",children:y(t.currentThreeDartAvg??0)})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-white/10 border border-white/10 metric-tile flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"3-Dart Avg (Match)"}),e.jsx("div",{className:"text-xl font-bold",children:y(a)})]})]})]},t.id)})}),v&&e.jsxs("div",{className:"mt-4 p-3 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsx("strong",{children:"Best Leg (this match):"})," Player"," ",c.find(t=>t.id===v.playerId)?.name," ","in ",v.darts," darts"]})]})})})})}export{F as default};
//# sourceMappingURL=Scoreboard-DZ_3zEdW.js.map
