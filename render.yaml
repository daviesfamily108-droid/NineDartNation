services:
  - type: web
    name: nine-dart-nation-api
    env: node
    buildCommand: |
      # Install server deps
      cd server && npm ci
      # Build frontend bundle(s). We try root first, then app/ if present.
      npm ci && npm run build || true
      if [ -d app ]; then
        cd app && npm ci && npm run build || true
        cd ..
      fi
    startCommand: cd server && npm start
    healthCheckPath: /readyz
    autoDeploy: true
    plan: free
    envVars:
      - key: LOG_LEVEL
        value: info
      # Add these in the Render dashboard or here if you prefer
      # - key: SMTP_HOST
      #   sync: false
      # - key: SMTP_PORT
      #   sync: false
      # - key: SMTP_USER
      #   sync: false
      # - key: SMTP_PASS
      #   sync: false
      # - key: SMTP_FROM
      #   sync: false
      # - key: STRIPE_SECRET_KEY
      #   sync: false
      # - key: STRIPE_PRICE_ID_USERNAME_CHANGE
      #   sync: false
      # - key: STRIPE_PRICE_ID_SUBSCRIPTION
      #   sync: false
      # - key: STRIPE_WEBHOOK_SECRET
      #   sync: false
